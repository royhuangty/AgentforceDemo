"use strict";(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[9517],{7780:(e,s,a)=>{a.r(s),a.d(s,{default:()=>r});var t=a(5908),n=a(257);const o={computed:{...(0,t.mapState)(["fieldMapData","fieldSetData","savedSFDCRecord","baseObject","dataSource"])},methods:{...(0,t.mapMutations)(["loadingToggle","setSavedC2CData"]),sendSaveInfoSFDC(e){return new Promise(((s,a)=>{let t;try{t=JSON.stringify(e)}catch(s){return console.warn("Can't parse json settings for save",e),void a(new Error(this.$Labels.Common_Refresh_And_Try_Again))}(new n.Z).setAction("maps.DataLayers.doSaveV2").setErrorHandler((e=>{console.warn(e),a(new Error(this.$Labels.Common_Refresh_And_Try_Again))})).invoke([t],(e=>{const{success:t=!1,data:n={}}=e;t?s(n):e.securityError?a(new Error(e.message)):(console.warn(this.$Labels.Common_Refresh_And_Try_Again),a(new Error(this.$Labels.Common_Refresh_And_Try_Again)))}),{escape:!1})}))},saveDataLayer(){this.loadingToggle(!0);const e=this.buildSaveInfo();this.sendSaveInfoSFDC(e).then((e=>{e.maps__Settings__c=JSON.parse(e.maps__Settings__c),e.ready=!0,this.$emit("udpateToast",{type:"success",message:this.$Labels.Layers_Territory_Changes_Saved}),this.setSavedC2CData(e)})).catch((e=>{let s=this.$Labels.Common_Refresh_And_Try_Again_Contact_Admin;s="string"==typeof e?e:e.message||this.$Labels.Common_Refresh_And_Try_Again_Contact_Admin,this.$emit("udpateToast",{type:"error",message:s})})).finally((()=>{this.loadingToggle(!1)}))},buildSaveInfo(){const e={...this.savedSFDCRecord},{apiName:s,label:a}=this.baseObject,t={objAPIName:a,objLabel:s,fields:this.fieldMapData,recordTypes:[],fieldSetOptions:[]},n=this.fieldSetData||[];for(let e=0;e<n.length;e++){const s=n[e];s.value&&(t.fieldSetOptions.push({FieldSetAPIName:s.value,IsSystemDefault:s.systemDefault||!1,RecordTypeId:s.id,RecordTypeName:s.name}),t.recordTypes.push({id:s.id,label:s.name}))}const o={...e.maps__Settings__c}||{};o.C2C||(o.C2C={});const{C2C:r}=o;r[a]=t;const i={maps__Type__c:this.dataSource.id,maps__Settings__c:JSON.stringify(o)};return e.Id&&(i.Id=e.Id),i}}},r=(0,a(1900).Z)(o,(function(){var e=this,s=e._self._c;return s("div",[s("button",{staticClass:"slds-button slds-button_brand",on:{click:e.saveDataLayer}},[e._v("\n        "+e._s(e.$Labels.MA_Save)+"\n    ")])])}),[],!1,null,null,null).exports}}]);