(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[637],{8355:(e,t,s)=>{e.exports=s.p+"images/beb4089c3583201862ab1c68f94e5a23.svg"},3928:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var i=s(3088),a=s(2646);const{MAToastMessages:l}=window,r={components:{Spinner:a.$j,TextInput:a.oi,Checkbox:a.XZ,Tooltip:a.u,Button:a.zx},data:()=>({isLoading:!1,alertSettings:{email:"",isStored:!1,options:{Stop:{label:"Receive All Stop Alerts",value:"Stop",tooltip:"Select this box to receive an email alerts each time a Stop event is captured.",enabled:!1},Speeding:{label:"Receive All Speeding Alerts",value:"Speeding",tooltip:"Select this box to receive an email alerts each time a Speeding event is captured.",enabled:!1},HardBraking:{label:"Receive All Hard Braking Alerts",value:"HardBraking",tooltip:"Select this box to receive an email alerts each time a Hard Braking event is captured.",enabled:!1},HardAcceleration:{label:"Receive All Hard Acceleration Alerts",value:"HardAcceleration",tooltip:"Select this box to receive an email alerts each time a Hard Acceleration event is captured.",enabled:!1},DeviceBatteryOn:{label:"Receive All Battery Alerts",value:"DeviceBatteryOn",tooltip:"Select this box to receive an email alerts each time a Device Battery event is captured.",enabled:!1},SpeedThreshold:{label:"Receive All Speed Threshold Alerts",value:"SpeedThreshold",tooltip:"Select this box to receive an email alerts each time a Speed Threshold event is captured.",enabled:!1}}}}),computed:{},created(){this.getAlertSettings()},methods:{async getAlertSettings(){this.isLoading=!0;try{const{success:e,alertvals:t}=await(0,i.wX)("maps.LiveRemoteFunctions.RetrieveAlertSettings",[]);e?Object.keys(t).forEach((e=>{"email"===e?(this.alertSettings.email=t[e],this.alertSettings.isStored=!0):this.alertSettings.options[e].enabled=t[e]})):this.$root.$emit("toast",{message:"No email address has been set to receive Live Telematics Alerts.",state:"warning",duration:6e3})}catch(e){l.showError({position:"toast-top-right",message:`Error: ${e}.`,timeOut:8e3}),console.error(e)}finally{this.isLoading=!1}},async saveAlertSettings(e){this.isLoading=!0;try{const t={};let s=0;if(e)this.alertSettings.email="",Object.values(this.alertSettings.options).forEach((e=>{t[e.value]=!1}));else{if(null==this.alertSettings.email||""===this.alertSettings.email.trim())return l.showError({position:"toast-top-right",message:"Error",subMessage:"Email address not provided.",timeOut:8e3}),null;if(!/\S+@\S+\.\S+/.test(this.alertSettings.email))return l.showError({position:"toast-top-right",message:"Error",subMessage:"Invalid email address.",timeOut:8e3}),null;if(Object.values(this.alertSettings.options).forEach((e=>{t[e.value]=e.enabled,!0===e.enabled&&(s+=1)})),!(s>0))return l.showError({position:"toast-top-right",message:"Error",subMessage:"You must select at least one option to receive email alerts.",timeOut:8e3}),null}const a=[this.alertSettings.email,JSON.stringify(t)],{success:r,message:o}=await(0,i.wX)("maps.LiveRemoteFunctions.saveAlertSettings",[a]);r?(l.showSuccess({position:"toast-top-right",message:"Success",subMessage:e?"Telematics email alerts have been stopped.":`Telematics email alerts will be sent to ${this.alertSettings.email}`,timeOut:8e3}),e&&(this.alertSettings.isStored=!1),await this.getAlertSettings()):l.showError({position:"toast-top-right",message:"Error",subMessage:o,timeOut:8e3})}catch(e){l.showError({position:"toast-top-right",message:`Error: ${e}.`,timeOut:8e3}),console.error(e)}finally{this.isLoading=!1}return null}}},o=(0,s(1900).Z)(r,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"slds-m-around--medium",attrs:{id:"app"}},[e.isLoading?t("Spinner"):e._e(),e._v(" "),t("div",[t("div",{staticClass:"slds-section__title slds-theme--shade"},[t("div",{staticClass:"slds-media__figure slds-m-right_x-small"},[t("Icon",{staticStyle:{"background-color":"transparent"},attrs:{category:"custom",name:"custom109",iconClass:"slds-icon-text-default",assistiveText:"Batch Job Scheduling"}})],1),e._v(" "),t("span",{staticClass:"section-header-title slds-truncate"},[e._v("Telematics Email Alerts")])]),e._v(" "),t("div",{staticClass:"slds-container_small"},[t("div",{staticClass:"slds-p-around_medium"},[t("h3",{staticClass:"slds-text-heading_small"},[e._v("Email Address Registration")]),e._v(" "),t("div",{staticClass:"slds-grid"},[t("TextInput",{staticClass:"slds-input-has-icon slds-input-has-icon_right",attrs:{id:"email-input",required:!0,type:"text",labels:{name:"Enter an email address to receive notifications when events are captured."}},model:{value:e.alertSettings.email,callback:function(t){e.$set(e.alertSettings,"email",t)},expression:"alertSettings.email"}},[e.alertSettings.isStored?t("Button",{staticClass:"slds-button slds-button_icon slds-input__icon slds-input__icon_right",attrs:{slot:"extendInput",theme:"border",title:"Clear Email Address"},on:{click:function(t){return e.saveAlertSettings(!0)}},slot:"extendInput"},[t("Icon",{attrs:{src:s(8355),iconClass:["slds-button__icon","slds-icon-text-light"],assistiveText:"Clear Email Address"}})],1):e._e()],1)],1)]),e._v(" "),t("div",{staticClass:"slds-p-around_medium"},e._l(Object.values(e.alertSettings.options),(function(s,i){return t("div",{key:i,staticClass:"slds-grid"},[t("Checkbox",{attrs:{id:`checkbox-${s.value}`,noSlide:!0,labels:{name:s.label}},model:{value:s.enabled,callback:function(t){e.$set(s,"enabled",t)},expression:"option.enabled"}}),e._v(" "),t("Tooltip",{attrs:{text:s.tooltip,assistiveText:s.tooltip}})],1)})),0)]),e._v(" "),t("div",{staticClass:"slds-p-left_x-small slds-p-top_x-small slds-grid"},[t("button",{staticClass:"slds-button slds-button--destructive",attrs:{id:"remove-saved-key",type:"button",disabled:!e.alertSettings.isStored},on:{click:function(t){return e.saveAlertSettings(!0)}}},[e._v("\n                Stop Alerts\n            ")]),e._v(" "),t("button",{staticClass:"slds-button slds-button--success slds-button--brand",attrs:{id:"alertsavebtn",type:"button"},on:{click:function(t){return e.saveAlertSettings(!1)}}},[e._v("\n                Save Settings\n            ")])])])],1)}),[],!1,null,null,null).exports}}]);