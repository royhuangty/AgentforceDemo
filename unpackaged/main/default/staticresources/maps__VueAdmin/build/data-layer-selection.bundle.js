"use strict";(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[4485],{8719:(e,t,s)=>{s.d(t,{K:()=>n,x:()=>c});var a=s(5735),l=s.n(a),i=s(257),o=s(5658);const{MASystem:r}=window,n=async({sobject:e="",permissionsToCheck:t={isAccessible:!0},updateProgress:s=(()=>{}),includeDedicatedLookupOptions:a=!1})=>(async({sobject:e="",permissionsToCheck:t={isAccessible:!0},fieldIndex:s,progressCallback:a=(()=>{}),includeDedicatedLookupOptions:n=!1})=>{const{success:c=!1,data:d={},message:_}=await(0,o.wX)("RemoteFunctions.GetGlobalDescribeFields",[e,t,s,n],{escape:!1,buffer:!1});if(c){const{hasMore:s=!1,index:o,availableFields:n=[],totalSize:c=0}=d;if(s){let s=n;return await(async(e="",t={isAccessible:!0},s,a=(()=>{}))=>new Promise((o=>{let n=[];const c={status:"Running Batch",total:0,complete:0,success:0,failure:0},d=l()(((e,t)=>{const{object:s,limits:l,index:o}=e;((e="",t={isAccessible:!0},s)=>new Promise(((a,l)=>{(new i.Z).setAction("maps.RemoteFunctions.GetGlobalDescribeFields").setErrorHandler((e=>{l(new Error(e))})).invoke([e,t,s],(e=>{const{success:t=!1,data:s=[]}=e;t?a(s):(console.warn(r.Labels.Common_Refresh_And_Try_Again),l(new Error(r.Labels.Common_Refresh_And_Try_Again)))}),{escape:!1,buffer:!1,timeout:45e3})})))(s,l,o).then((e=>{const{hasMore:t=!1,availableFields:a=[]}=e,i=e.index;t&&d.push({object:s,limits:l,index:i}),n=[...n,...a],c.success+=a.length})).catch((e=>{console.warn("schema error",e),c.failure++})).finally((()=>{c.complete++,a(c),t()}))}),1);d.push({object:e,limits:t,index:s}),d.drain=()=>{const e=n.sort(((e,t)=>e.label>t.label?1:-1));o(e)}})))(e,t,o,(e=>{e.total=c,a(e)})).then((e=>{s=[...s,...e]})),s}return n}throw console.warn(r.Labels.Common_Refresh_And_Try_Again),new Error(_)})({sobject:e,permissionsToCheck:t,fieldIndex:0,updateProgress:e=>{s(e)},includeDedicatedLookupOptions:a}),c=async(e={},t=!1,s=(()=>{}))=>{const a=e.hideExtraObjects||!1;let o;return await(async(e=!1,t=!0,s={},a=0,o=(()=>{}))=>new Promise(((n,c)=>{const d=a;(new i.Z).setAction("maps.RemoteFunctions.GetGlobalDescribeObjects").setErrorHandler((e=>{c(new Error(e))})).invoke([e,s,t,d],(async a=>{const{success:d=!1,data:_={}}=a;if(d){const{hasMore:a=!1,index:c,availableObjects:d=[],totalSize:p=0}=_;if(a){let a=d;await((e=!1,t=!0,s={},a=0,o=(()=>{}))=>new Promise((n=>{const c={status:"Running Batch",total:0,complete:0,success:0,failure:0};let d=[];const _=l()(((e,t)=>{const{removeExtra:s,limitedSet:a,limits:l,index:n}=e;((e=!1,t=!0,s={},a=0)=>new Promise(((l,o)=>{(new i.Z).setAction("maps.RemoteFunctions.GetGlobalDescribeObjects").setErrorHandler((e=>{o(new Error(e))})).invoke([e,s,t,a],(e=>{const{success:t=!1,data:s={}}=e;t?l(s):(console.warn(r.Labels.Common_Refresh_And_Try_Again),o(new Error(r.Labels.Common_Refresh_And_Try_Again)))}),{escape:!1,buffer:!1})})))(s,a,l,n).then((e=>{const{hasMore:t=!1,availableObjects:i=[]}=e,o=e.index;t&&_.push({removeExtra:s,limitedSet:a,limits:l,index:o}),d=[...d,...i],c.success+=i.length})).catch((e=>{c.failure++,console.warn("schema error",e)})).finally((()=>{c.complete++,o(c),t()}))}),1);_.push({removeExtra:e,limitedSet:t,limits:s,index:a}),_.drain=()=>{const e=d.sort(((e,t)=>e.name>t.name?1:-1));n(e)}})))(e,t,s,c,(e=>{e.total=p,o(e)})).then((e=>{a=[...a,...e]})),n(a)}else n(d)}else console.warn(r.Labels.Common_Refresh_And_Try_Again),c(new Error(r.Labels.Common_Refresh_And_Try_Again))}),{escape:!1,buffer:!1})})))(a,t,e,0,(e=>{s(e)})).then((e=>{o=e})),o}},7075:(e,t,s)=>{s.r(t),s.d(t,{default:()=>c});var a=s(2646),l=s(8719),i=s(257),o=s(5658),r=s(5908);const n={components:{Picklist:a.Gp},data:()=>({allSFDCObjects:!1,localBaseObjectApi:""}),computed:{...(0,r.mapState)(["availableSFDCObject","baseObject"])},watch:{allSFDCObjects(){this.getAvailableObjects()},localBaseObjectApi(e){e||this.store__updateBaseObject({name:"",label:""})}},async created(){await this.getAvailableObjects(),this.localBaseObjectApi="Lead",this.setBaseObject({name:"Lead",label:"Lead"})},methods:{...(0,r.mapMutations)({store__updateAvailableObjects:"updateAvailableObjects",store__updateBaseObject:"updateBaseObject",store__updateSFDCMetaData:"updateSFDCMetaData",store__loadingToggle:"loadingToggle"}),async getAvailableObjects(){this.store__loadingToggle(!0);try{const e={isAccessible:!0,isQueryable:!0,hideExtraObjects:!0},t=!this.allSFDCObjects,s=await(0,l.x)(e,t);this.store__updateAvailableObjects(s),this.store__loadingToggle(!1)}catch(e){this.$emit("udpateToast",{type:"error",message:this.$Labels.DataLayer_Cant_Get_Objects}),this.store__loadingToggle(!1)}},setBaseObject(e){this.store__updateBaseObject(e),this.store__loadingToggle(!0),this.getBaseObjectMetaData().then((e=>{this.store__updateSFDCMetaData(e)})).catch((()=>{this.$emit("udpateToast",{type:"error",message:(0,o.N4)(this.$Labels.DataLayer_Cant_Get_Object_Metadata,[e.label])})})).finally((()=>{this.store__loadingToggle(!1)}))},getBaseObjectMetaData(){return new Promise(((e,t)=>{const s={action:"get_object_metadata",objectAPIName:this.localBaseObjectApi};(new i.Z).setAction("maps.AdminAJAXResources.AdminStartUpAction").setErrorHandler((e=>{console.warn(e),t(new Error(this.$Labels.Common_Refresh_And_Try_Again))})).invoke([s],(s=>{const{success:a=!1,data:l={}}=s;a?e(l):(console.warn(this.$Labels.Common_Refresh_And_Try_Again),t(new Error(this.$Labels.Common_Refresh_And_Try_Again)))}),{escape:!1,buffer:!1})}))}}},c=(0,s(1900).Z)(n,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"slds-p-bottom_x-small"},[t("div",{staticClass:"slds-box graybox"},[t("div",{staticClass:"sectionTitle"},[e._v("\n            "+e._s(e.$Labels.MapsSetting_Select_Salesforce_Object)+"\n        ")]),e._v(" "),t("Picklist",{staticClass:"selectWrapper slds-p-vertical_x-small",attrs:{options:e.availableSFDCObject,detach:!0,hasNoneOption:!1,labels:{name:e.$Labels.MA_OBJECT},idKey:"label",titleKey:"name",filterable:""},on:{"selected-option":e.setBaseObject},model:{value:e.localBaseObjectApi,callback:function(t){e.localBaseObjectApi=t},expression:"localBaseObjectApi"}}),e._v(" "),t("div",{staticClass:"slds-form-element__control"},[t("span",{staticClass:"slds-checkbox"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.allSFDCObjects,expression:"allSFDCObjects"}],attrs:{id:"viewAll-2",type:"checkbox",name:"options"},domProps:{checked:Array.isArray(e.allSFDCObjects)?e._i(e.allSFDCObjects,null)>-1:e.allSFDCObjects},on:{change:function(t){var s=e.allSFDCObjects,a=t.target,l=!!a.checked;if(Array.isArray(s)){var i=e._i(s,null);a.checked?i<0&&(e.allSFDCObjects=s.concat([null])):i>-1&&(e.allSFDCObjects=s.slice(0,i).concat(s.slice(i+1)))}else e.allSFDCObjects=l}}}),e._v(" "),t("label",{staticClass:"slds-checkbox__label",attrs:{for:"viewAll-2"}},[t("span",{staticClass:"slds-checkbox_faux"}),e._v(" "),t("span",{staticClass:"slds-form-element__label"},[e._v(e._s(e.$Labels.MapsSetting_View_All_Salesforce_Objects))])])])])],1)])}),[],!1,null,null,null).exports},5404:(e,t,s)=>{s.r(t),s.d(t,{default:()=>r});var a=s(2646),l=s(257),i=s(5908);const o={components:{Picklist:a.Gp},data:()=>({sourceError:!1,previousSource:"",localDataSource:""}),computed:{...(0,i.mapState)(["dataSources","dataLayerMap","dataSource"])},watch:{localDataSource(e){e||(this.previousSource="",this.store__resetDataLayerSetup())}},created(){this.getDataLayerSources()},methods:{...(0,i.mapActions)({store__getDataLayerSourceData:"getDataLayerSourceData"}),...(0,i.mapMutations)({store__updateDataSource:"updateDataSource",store__updateDataSources:"updateDataSources",store__updateDataSourceFields:"updateDataSourceFields",store__resetDataLayerSetup:"resetDataLayerSetup",store__setSavedC2CData:"setSavedC2CData",store__loadingToggle:"loadingToggle"}),getDataLayerSources(){this.sourceError=!1,this.store__loadingToggle(!0),this.store__getDataLayerSourceData({layer:null,fields:!1}).then((e=>{const{sources:t=[]}=e;this.store__updateDataSources(t)})).catch((()=>{this.$emit("udpateToast",{type:"error",message:this.$Labels.DataLayer_Cant_Get_Data_Layer}),this.sourceError=!0})).finally((()=>{this.store__loadingToggle(!1)}))},setDataSource(e){const{previousSource:t}=this,s=e.id;t!==s&&(this.store__resetDataLayerSetup(),this.$nextTick((()=>{this.store__updateDataSource(e),this.store__loadingToggle(!0),this.getSavedSFDCData(s).finally((()=>{this.getSelectedDataLayerSourceData(s),this.store__loadingToggle(!1)})),this.previousSource=s||""})))},getSelectedDataLayerSourceData(e){this.store__loadingToggle(!0),this.store__getDataLayerSourceData({source:e,fields:!0}).then((e=>{const{sources:t=[]}=e,[s={}]=t,{fields:a=[]}=s;this.store__updateDataSourceFields(a)})).catch((()=>{this.$emit("udpateToast",{type:"error",message:this.$Labels.DataLayer_Cant_Get_Source_Data}),this.sourceError=!0})).finally((()=>{this.store__loadingToggle(!1)}))},getSavedSFDCData(e){return new Promise(((t,s)=>{(new l.Z).setAction("maps.DataLayers.getDataV2").setErrorHandler((()=>{s(new Error(this.$Labels.Common_Refresh_And_Try_Again))})).invoke([e],(e=>{const{success:a=!1,data:l=[]}=e;if(a){const[e={}]=l,s=this.updateDataInformation(e);this.store__setSavedC2CData(s),t()}else s(new Error(this.$Labels.Common_Refresh_And_Try_Again))}),{escape:!1,buffer:!1})}))},updateDataInformation(e){const t=e.maps__Type__c||"";e.maps__Type__c="dbusa-v1"===t?"business":"dmp-v1"===t?"property":t;const s=e.maps__Settings__c||"{}";let a={};try{a=JSON.parse(s)}catch(e){console.warn("Unable to parse saved settings",s)}return e.maps__Settings__c=a,e.ready=!0,e}}},r=(0,s(1900).Z)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"slds-p-bottom_x-small"},[t("div",{staticClass:"slds-box graybox"},[t("div",{staticClass:"sectionTitle"},[e._v("\n            "+e._s(e.$Labels.MapsSetting_Select_Data_Layer)+"\n        ")]),e._v(" "),t("Picklist",{staticClass:"selectWrapper slds-p-vertical_x-small",attrs:{options:e.dataSources,doDetach:!0,idKey:"id",titleKey:"label",filterable:""},on:{"selected-option":e.setDataSource},model:{value:e.localDataSource,callback:function(t){e.localDataSource=t},expression:"localDataSource"}}),e._v(" "),e.sourceError?t("div",[t("button",{staticClass:"slds-button slds-button_icon slds-button_icon-brand",on:{click:e.getDataLayerSources}},[t("span",{staticClass:"slds-button__icon ma-icon ma-icon-refresh"})])]):e._e()],1)])}),[],!1,null,null,null).exports},5179:(e,t,s)=>{s.r(t),s.d(t,{default:()=>o});var a=s(2646),l=s(5908);const i={components:{Picklist:a.Gp},data:()=>({dataFields:[],fieldOptions:{string:[],number:[],decimal:[],date:[],currency:[],boolean:[]},fieldMap:{}}),computed:{...(0,l.mapState)(["sfdcMetaData","dataSource","baseObject","savedSFDCRecord"]),savedC2CData(){const e=this.savedSFDCRecord.maps__Settings__c||{},{C2C:t={}}=e;return t},dataLayerFields(){const{fields:e=[]}=this.dataSource;return e}},watch:{fieldMap(e){this.store__updateFieldMapData(e)}},created(){this.buildFieldMappings(),this.setFieldTypeOptions()},methods:{...(0,l.mapMutations)({store__updateFieldMapData:"updateFieldMapData"}),buildFieldMappings(){const{apiName:e=""}=this.baseObject;let t={};const s=Object.keys(this.savedC2CData);for(let a=0;a<s.length;a++){const l=String(s[a]);if(l.toLowerCase()===e.toLowerCase()){t=this.savedC2CData[l];break}}const{fields:a={}}=t;this.fieldMap=a;const l=[];for(let e=0;e<this.dataLayerFields.length;e++){const t=this.dataLayerFields[e],s={id:t.id,label:t.label,type:t.filter_as,value:""};a[t.id]&&(s.value=a[t.id]),l.push(s)}this.dataFields=l},setFieldTypeOptions(){const{fields:e={}}=this.sfdcMetaData;let t=[];const s=Object.keys(e);for(let a=0;a<s.length;a++){const l=s[a],i=e[l];"numberFields"===l?(this.fieldOptions.number=i,this.fieldOptions.decimal=i):"dateFields"===l?this.fieldOptions.date=i:"currencyFields"===l?this.fieldOptions.currency=i:"booleanFields"===l?this.fieldOptions.boolean=i:"emailFields"!==l&&"phoneFields"!==l&&"websiteFields"!==l&&"textFields"!==l||(t=[...t,...i])}this.fieldOptions.string=t.sort(this.compareStrings)},compareStrings(e,t){const s=e.label.toLowerCase(),a=t.label.toLowerCase();let l=0;return s<a?l=-1:s>a&&(l=1),l},updateFieldMap(e){const{id:t,value:s}=e;s?this.fieldMap[t]=s:delete this.fieldMap[t]}}},o=(0,s(1900).Z)(i,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"slds-p-bottom_x-small"},[t("div",{staticClass:"slds-box graybox"},[t("div",[t("div",{staticClass:"sectionTitle"},[e._v("\n                "+e._s(e.$Labels.MapsSetting_Field_Mappings)+"\n            ")]),e._v(" "),t("div",{staticClass:"scrollArea"},e._l(e.dataFields,(function(s,a){return t("div",{key:a},[t("div",{staticClass:"selectWrapper slds-p-vertical_x-small",attrs:{datatype:s.type}},[t("Picklist",{attrs:{options:e.fieldOptions[s.type],labels:{name:s.label},detach:!0,idKey:"value",titleKey:"label",filterable:""},on:{changed:function(t){return e.updateFieldMap(s)}},model:{value:s.value,callback:function(t){e.$set(s,"value",t)},expression:"field.value"}})],1)])})),0)])])])}),[],!1,null,null,null).exports},4569:(e,t,s)=>{s.r(t),s.d(t,{default:()=>r});var a=s(5908);const l={components:{Picklist:s(2646).Gp},props:{rowKey:{type:String,default:""},fieldSet:{type:Object,default:()=>{}}},data:()=>({sfdcFieldSets:[]}),computed:{...(0,a.mapState)(["sfdcMetaData"])},created(){const e=this.sfdcMetaData||{};this.sfdcFieldSets=e.fieldSets||[];try{const[e]=this.sfdcFieldSets;""===this.localVal&&(this.localVal=e.value,this.fieldSet.value=e.value)}catch(e){}}};var i=s(1900);const o={components:{FieldSetRow:(0,i.Z)(l,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"slds-p-top_xx-small selectWrapper"},[t("Picklist",{attrs:{options:e.sfdcFieldSets,labels:{name:e.fieldSet.name},hasNoneOption:!1,detach:!0,idKey:"value",titleKey:"label",filterable:""},model:{value:e.fieldSet.value,callback:function(t){e.$set(e.fieldSet,"value",t)},expression:"fieldSet.value"}})],1)}),[],!1,null,null,null).exports},props:{fieldSetValid:{type:Boolean,default:!1}},data:()=>({currentC2CData:{fields:{},objAPIName:"",objLabel:"",recordTypes:[]},localFieldSetInfo:[]}),computed:{...(0,a.mapState)(["sfdcMetaData","baseObject","savedSFDCRecord","fieldSetData"]),recordTypes(){const{recordTypes:e=[]}=this.sfdcMetaData;return e},fieldSets(){const{fieldSets:e=[]}=this.sfdcMetaData;return e},savedC2CData(){const e=this.savedSFDCRecord.maps__Settings__c||{},{C2C:t={}}=e;return t},hasFieldSets(){return this.fieldSets.length>0}},watch:{hasFieldSets(e){this.$emit("update:fieldSetValid",e)},localFieldSetInfo(e){this.store__updateFieldSetData(e)}},created(){this.buildFieldSetData(),this.$emit("update:fieldSetValid",this.hasFieldSets)},methods:{...(0,a.mapMutations)({store__updateFieldSetData:"updateFieldSetData"}),buildFieldSetData(){const{apiName:e=""}=this.baseObject;let t={fieldSetOptions:[],fields:{},objAPIName:"",objLabel:"",recordTypes:[]};const s=Object.keys(this.savedC2CData);for(let a=0;a<s.length;a++){const l=String(s[a]);if(l.toLowerCase()===e.toLowerCase()){t=this.savedC2CData[l];break}}this.currentC2CData=t;const{fieldSetOptions:a=[]}=t,l=a.reduce(((e,t)=>(e[t.RecordTypeId]=t,e)),{}),i=[];for(let e=0;e<this.recordTypes.length;e++){const t=this.recordTypes[e],s={id:t.id,name:t.name,value:"",systemDefault:t.systemDefault||!1};l[t.id]&&(s.value=l[t.id].FieldSetAPIName),i.push(s)}this.localFieldSetInfo=i}}},r=(0,i.Z)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"slds-p-bottom_x-small"},[e.hasFieldSets?t("div",{staticClass:"slds-box graybox"},[t("div",{staticClass:"sectionTitle"},[e._v("\n            "+e._s(e.$Labels.MapsSetting_Field_Set_Mapping)+"\n        ")]),e._v(" "),e._l(e.localFieldSetInfo,(function(e){return t("FieldSetRow",{key:e.id,attrs:{rowKey:e.id,fieldSet:e}})}))],2):t("div",[t("div",{staticClass:"slds-notify_container slds-is-relative"},[t("div",{staticClass:"slds-notify slds-notify_toast slds-theme_warning"},[t("span",{staticClass:"slds-assistive-text"},[e._v(e._s(e.$Labels.MapsSetting_warning))]),e._v(" "),t("span",{staticClass:"slds-icon_container ma-icon ma-icon-warning slds-m-right_small slds-no-flex",staticStyle:{"font-size":"24px"}}),e._v(" "),t("div",{staticClass:"slds-notify__content"},[t("h2",{staticClass:"slds-text-heading_small"},[e._v("\n                        "+e._s(e.$Labels.MapsSetting_No_Field_Sets_Warning)+"\n                    ")]),e._v(" "),t("p",[e._v(e._s(e.$Labels.MapsSetting_No_Field_Sets_Assistance)+" "),t("a",{attrs:{href:"https://help.salesforce.com/s/articleView?id=sf.salesforce_maps_support.htm&type=5"}},[e._v(e._s(e.$Labels.Maps_Support))])])])])])])])}),[],!1,null,null,null).exports}}]);