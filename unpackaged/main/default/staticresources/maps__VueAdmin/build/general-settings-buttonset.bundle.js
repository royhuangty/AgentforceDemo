"use strict";(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[1714],{9353:(t,o,e)=>{e.r(o),e.d(o,{default:()=>v});var a=e(2646),s=e(5908),n=e(257);const{MARemoting:i,MASystem:{Labels:l}}=window,c={TooltipLayout:[{Label:l.MA_Actions,Columns:[[{Label:"Add to Trip",Type:"Standard Action"},{Label:"Take Me There",Type:"Standard Action"}],[{Label:"Set Proximity Center",Type:"Standard Action"},{Label:"Add to Schedule",Type:"Standard Action"}],[{Label:"Remove Marker",Type:"Standard Action"},{Label:"Check In",Type:"Standard Action"}]]},{Label:l.MapsSetting_ButtonSet_Admin,Columns:[[{Label:"Set Verified Location",Type:"Standard Action"}],[{Label:"Clear Coordinates",Type:"Standard Action"}],[{Label:"Change Owner",Type:"Standard Action"}]]},{Label:l.MA_ACTIVITIES,Columns:[[{Label:"Log a Call",Type:"Standard Action"}],[{Label:"Send Email",Type:"Standard Action"}],[{Label:"New Event",Type:"Standard Action"},{Label:"Add to Campaign",Type:"Standard Action"}]]}],MyPositionLayout:[{Label:l.MA_Actions,Columns:[[{Label:"Add to Trip",Type:"Standard Action"}],[{Label:"Set Proximity Center",Type:"Standard Action"}]]}],PoiLayout:[{Label:l.MA_Actions,Columns:[[{Label:"Add to Trip",Type:"Standard Action"}],[{Label:"Take Me There",Type:"Standard Action"}]]}],MassActionLayout:[{Label:l.MA_Actions,Buttons:[{Label:"Add to Campaign",Type:"Standard Action"},{Label:"Change Owner",Type:"Standard Action"},{Label:"Update Field",Type:"Standard Action"},{Label:"Clear Coordinates",Type:"Standard Action"},{Label:"Remove Marker",Type:"Standard Action"},{Label:"Add to Trip",Type:"Standard Action"},{Label:"Add to Schedule",Type:"Standard Action"}]},{Label:l.MA_ACTIVITIES,Buttons:[{Label:"Log a Call",Type:"Standard Action"},{Label:"Send Email",Type:"Standard Action"},{Label:"New Task",Type:"Standard Action"},{Label:"New Event",Type:"Standard Action"}]},{Label:l.MA_Chatter,Buttons:[{Label:"Follow",Type:"Standard Action"},{Label:"Unfollow",Type:"Standard Action"}]}],DataLayerLayout:[{Label:l.MA_Actions,Columns:[[{Label:"Add to Trip",Type:"Standard Action"}],[{Label:"Set Proximity Center",Type:"Standard Action"},{Label:l.MA_STREET_VIEW,Type:"Standard Action"}],[{Label:"Create Record",Type:"Standard Action"}]]}],ArcGISLayerLayout:[{Label:l.MA_Actions,Columns:[[{Label:"Add to Trip",Type:"Standard Action"}],[{Label:"Set Proximity Center",Type:"Standard Action"},{Label:l.MA_STREET_VIEW,Type:"Standard Action"}],[{Label:"Create Record",Type:"Standard Action"}],[{Label:"Set Reference Point",Type:"Standard Action"}]]}],FavoriteMarkerLayout:[{Label:l.MA_Actions,Columns:[[{Label:"Add to Trip",Type:"Standard Action"},{Label:"Set Proximity Center",Type:"Standard Action"}],[{Label:"Remove Marker",Type:"Standard Action"},{Label:"Set Verified Location",Type:"Standard Action"}],[{Label:"Set Reference Point",Type:"Standard Action"}]]}]};class r{static getDefaultSet(t=""){return c[t]}static getSavedButtonSet(t=""){return new Promise((o=>{const e={action:"get_buttonset_info",buttonSetId:t};(new n.Z).setAction(i.AdminStartUpAction).setErrorHandler((t=>{console.warn("Unable to get button set info, falling back to defaults",t);const e=r.getAllDefaultButtons();o(e)})).invoke([e],(e=>{const{success:a=!1,results:s={}}=e;if(a)if(s.length>0){const[t]=s;let e,a,n,i,l,r,u;try{e=JSON.parse(t.maps__TooltipLayout__c)}catch(t){e=c.TooltipLayout}try{a=JSON.parse(t.maps__MyPositionLayout__c)}catch(t){a=c.MyPositionLayout}try{n=JSON.parse(t.maps__POILayout__c)}catch(t){n=c.PoiLayout}try{i=JSON.parse(t.maps__MassActionLayout__c)}catch(t){i=c.MassActionLayout}try{l=JSON.parse(t.maps__DataLayerLayout__c)}catch(t){l=c.DataLayerLayout}try{r=JSON.parse(t.maps__FavoriteMarkerLayout__c)}catch(t){r=c.FavoriteMarkerLayout}try{u=JSON.parse(t.maps__ArcGISLayerLayout__c)}catch(t){u=c.ArcGISLayerLayout}o({tooltipLayout:e,myPositionLayout:a,poiLayout:n,massActionLayout:i,dataLayerLayout:l,ArcGISLayerLayout:u,FavoriteMarkerLayout:r})}else{console.warn("No button set info found for id, falling back to defaults",t);const e=r.getAllDefaultButtons();o(e)}}),{escape:!1,buffer:!1})}))}static getAllDefaultButtons(){return{tooltipLayout:c.TooltipLayout,myPositionLayout:c.MyPositionLayout,poiLayout:c.PoiLayout,massActionLayout:c.MassActionLayout,dataLayerLayout:c.DataLayerLayout,ArcGISLayerLayout:c.ArcGISLayerLayout,FavoriteMarkerLayout:c.FavoriteMarkerLayout}}}const u={props:{button:{type:Object,required:!0}}};var d=e(1900);const p=(0,d.Z)(u,(function(){var t=this,o=t._self._c;return o("div",{staticClass:"buttonset-button"},[o("div",{staticClass:"actionbutton",class:t.button.Layouts,attrs:{"data-type":t.button.Type,"data-action":t.button.dataAction}},[o("span",{staticClass:"buttonText",attrs:{title:t.button.Label}},[t._v(t._s(t._f("decode")(t.button.Label)))])]),t._v(" "),t._m(0)])}),[function(){var t=this._self._c;return t("div",{staticClass:"button-dropzone"},[t("div",{staticClass:"button-dropzone-handle ui-droppable"})])}],!1,null,null,null).exports,b={components:{ButtonPill:p},props:{buttonSet:{type:Array,required:!0},sectionTitle:{type:String,default:"Section"},type:{type:String,default:""}},data:()=>({doShow:!0,columns:[0,1,2]}),computed:{dropType(){let t="";switch(this.type){case"poi":t="POI";break;case"myposition":t="MyPosition";break;case"tooltip":t="Tooltip"}return t},showIcon(){return"ma-icon-"+(this.doShow?"chevrondown":"chevronright")}},methods:{toggleSection(){this.doShow=!this.doShow}}},_=(0,d.Z)(b,(function(){var t=this,o=t._self._c;return o("div",{staticClass:"slds-card slds-card_boundary"},[o("div",{staticClass:"slds-card__header slds-grid"},[o("header",{staticClass:"slds-media slds-media_center slds-has-flexi-truncate"},[o("div",{staticClass:"slds-media__body"},[o("h2",{staticClass:"slds-p-top_small slds-card__header-title",staticStyle:{cursor:"pointer"},on:{click:t.toggleSection}},[o("span",{staticClass:"ma-icon",class:t.showIcon,staticStyle:{color:"#7b7b7b","font-size":"12px","vertical-align":"top"},attrs:{title:t.$Labels.MapsSetting_Show_Or_Hide}}),t._v("\n                    "+t._s(t._f("decode")(t.sectionTitle))+"\n                ")])])])]),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.doShow,expression:"doShow"}],staticClass:"layout-wrapper slds-card__body slds-card__body_inner button-style",class:`layout-${t.type}-wrapper`},[o("div",{staticClass:"layout layout-marker",class:`layout-${t.type} js-layout-${t.type}`,attrs:{"data-layout":t.dropType}},[o("div",{staticClass:"section-dropzone"}),t._v(" "),t._l(t.buttonSet,(function(e,a){return o("div",{key:a,staticClass:"buttonset-section"},[o("div",{staticClass:"buttonset-section-header"},[o("div",{staticClass:"buttonset-section-name editable slds-text-title_caps slds-border_bottom slds-m-vertical_xx-small"},[t._v("\n                        "+t._s(t._f("decode")(e.Label))+"\n                    ")])]),t._v(" "),o("div",{staticClass:"buttonset-section-columns"},t._l(t.columns,(function(a){return o("div",{key:a,staticClass:"buttoncolumn"},[t._m(0,!0),t._v(" "),t._l(e.Columns[a],(function(t,e){return o("ButtonPill",{key:e,attrs:{button:t}})}))],2)})),0),t._v(" "),o("div",{staticClass:"section-dropzone"})])}))],2)])])}),[function(){var t=this._self._c;return t("div",{staticClass:"button-dropzone"},[t("div",{staticClass:"button-dropzone-handle"})])}],!1,null,null,null).exports,y={props:{buttonSet:{type:Array,required:!0}},data:()=>({doShow:!0}),computed:{showIcon(){return"ma-icon-"+(this.doShow?"chevrondown":"chevronright")}},methods:{toggleSection(){this.doShow=!this.doShow}}},h=(0,d.Z)(y,(function(){var t=this,o=t._self._c;return o("div",{staticClass:"slds-m-left_small slds-card slds-card_boundary"},[o("div",{staticClass:"slds-card__header slds-grid"},[o("header",{staticClass:"slds-media slds-media_center slds-has-flexi-truncate"},[o("div",{staticClass:"slds-media__body"},[o("h2",{staticClass:"slds-p-top_small slds-card__header-title",staticStyle:{cursor:"pointer"},on:{click:t.toggleSection}},[o("span",{staticClass:"ma-icon",class:t.showIcon,staticStyle:{color:"#7b7b7b","font-size":"12px","vertical-align":"top"},attrs:{title:t.$Labels.MapsSetting_Show_Or_Hide}}),t._v("\n                    "+t._s(t.$Labels.MA_Mass_Action_Layout)+"\n                ")])])])]),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.doShow,expression:"doShow"}],staticClass:"layout-massaction-wrapper layout-wrapper slds-card__body slds-card__body_inner"},[o("div",{staticClass:"layout-massaction js-layout-massaction layout",attrs:{"data-layout":"Mass"}},[o("div",{staticClass:"section-dropzone"}),t._v(" "),t._l(t.buttonSet,(function(e,a){return o("div",{key:a,staticClass:"buttonset-section"},[o("div",{staticClass:"buttonset-section-header ui-draggable"},[o("div",{staticClass:"buttonset-section-name editable slds-text-title_caps"},[t._v("\n                        "+t._s(t._f("decode")(e.Label))+"\n                    ")])]),t._v(" "),o("div",{staticClass:"buttonset-section-columns"},[t._m(0,!0),t._v(" "),t._l(e.Buttons,(function(e,a){return o("div",{key:a,staticClass:"buttonset-button ui-draggable"},[o("div",{staticClass:"actionbutton",class:e.Layouts,attrs:{"data-type":e.Type,"data-action":e.dataAction}},[o("span",{staticClass:"ma-icon ma-icon-chevronright"}),t._v(" "+t._s(t._f("decode")(e.Label))+"\n                        ")]),t._v(" "),t._m(1,!0)])}))],2),t._v(" "),o("div",{staticClass:"section-dropzone"})])}))],2)])])}),[function(){var t=this._self._c;return t("div",{staticClass:"button-dropzone"},[t("div",{staticClass:"button-dropzone-handle"})])},function(){var t=this._self._c;return t("div",{staticClass:"button-dropzone"},[t("div",{staticClass:"button-dropzone-handle"})])}],!1,null,null,null).exports,{$:m}=window,S={components:{Picklist:a.Gp,TextInput:a.oi,ButtonPill:p,ButtonSetLayoutDropZone:_,MassActionDropZone:h,Spinner:a.$j},data:()=>({isLoading:!1,buttonSet:"new",buttonSetInfo:{Id:"",Name:"",maps__MassActionLayout__c:"[]",maps__MyPositionLayout__c:"[]",maps__POILayout__c:"[]",maps__TooltipLayout__c:"[]"},availableButtons:[],tooltipSections:[],showFilter:!1,buttonFilter:"",doRenderDropzones:!0}),computed:{...(0,s.mapGetters)({settings__buttonSets:"buttonSets"}),combinedButtons(){return[{Id:"new",Name:`--${this.$Labels.MA_Create}--`},...this.settings__buttonSets]},showExtendedSaveButtons(){return""!==this.buttonSetInfo.Id}},created(){this.settings__getButtonSetInfo().then((()=>{})).catch((()=>{this.$root.$emit("toast",{state:"warning",message:this.$Labels.No_Access_To_Some_Features_Error})})),this.setDefaultButtonInfo(),this.$bus.$on("refresh-available-buttons",this.refreshAvailableButtons)},mounted(){this.refreshAvailableButtons()},methods:{rerenderDropzones(){this.doRenderDropzones=!1,this.$nextTick((()=>{this.doRenderDropzones=!0}))},...(0,s.mapActions)({settings__getButtonSetInfo:"getButtonSetInfo",settings__saveButtonSetInfo:"saveButtonSetInfo",settings__deleteButtonSet:"deleteButtonSet"}),attachAvailableButtonsListeners(){try{m(".layout-availablebuttons .actionbutton").draggable("destroy")}catch(t){}m(".layout-availablebuttons .actionbutton").draggable({opacity:.7,helper:"clone",start(){const t=m(this);let o=!1;try{"Custom Action"===t.attr("data-type")&&"Iframe"===window.MAActionFramework.customActions[t.attr("data-action")].Action&&(o=!0)}catch(t){}t.hasClass("Tooltip")&&m(".layout-tooltip-wrapper").addClass("canDrop"),t.hasClass("Mass")&&!1===o&&m(".layout-massaction-wrapper").addClass("canDrop"),t.hasClass("POI")&&m(".layout-poi-wrapper").addClass("canDrop"),t.hasClass("MyPosition")&&m(".layout-myposition-wrapper").addClass("canDrop"),m(".actionbutton").each(((o,e)=>{m(e).attr("data-action")===t.attr("data-action")&&m(e).css("background","#D3A7A7")}))},stop(){m(".layout-wrapper").removeClass("canDrop"),m(".actionbutton").each(((t,o)=>{m(o).css("background","white")}))}});try{m(".layout-availablebuttons").droppable("destroy")}catch(t){}m(".layout-availablebuttons").droppable({accept:".buttonset-button, .buttonset-section-header",tolerance:"fit",hoverClass:"hovering",drop(t,o){o.draggable.is(".buttonset-button")?o.draggable.remove():o.draggable.is(".buttonset-section-header")&&o.draggable.closest(".buttonset-section").remove()}}),setTimeout((()=>{this.ButtonSet_AddHandlers()}),1e3)},resetFilter(){this.buttonFilter=""},setDefaultButtonInfo(){const t=r.getAllDefaultButtons();this.buttonSetInfo={Id:"",Name:"",maps__MassActionLayout__c:[],maps__MyPositionLayout__c:[],maps__POILayout__c:[],maps__TooltipLayout__c:[]},this.$nextTick((()=>{this.buttonSetInfo={Id:"",Name:"",maps__MassActionLayout__c:this.extendMassActionButtonInfo(t.massActionLayout)||[],maps__MyPositionLayout__c:this.extendActionButtonInfo(t.myPositionLayout)||[],maps__POILayout__c:this.extendActionButtonInfo(t.poiLayout)||[],maps__TooltipLayout__c:this.extendActionButtonInfo(t.tooltipLayout)||[]}}))},extendActionButtonInfo(t){const{standardActions:o={},customActions:e={}}=window.MAActionFramework,a=JSON.parse(JSON.stringify(t));return a.forEach((t=>{const{Columns:a=[]}=t;a.forEach((t=>{t.forEach((t=>{let a;"Standard Action"===t.Type||"Blank"===t.Type?a=o[t.Label]:void 0!==e[t.Label]?a=e[t.Label]:(a={Layouts:[],Label:"Deleted"},t.Label="deleted");const{Modes:s=[]}=a;Array.isArray(s)&&s.length>0&&(t.Modes=s,t.dataAction=t.Label,t.Label=a.Label,t.Layouts=a.Layouts)}))}))})),a},extendMassActionButtonInfo(t){const{standardActions:o={},customActions:e={}}=window.MAActionFramework,a=JSON.parse(JSON.stringify(t));return a.forEach((t=>{const{Buttons:a=[]}=t;a.forEach((t=>{let a;a="Standard Action"===t.Type?o[t.Label]:e[t.Label];const{Modes:s=[]}=a;Array.isArray(s)&&s.length>0&&(t.Modes=s,t.dataAction=t.Label,t.Label=a.Label,t.Layouts=a.Layouts)}))})),a},updateButtonSetInfo(){const t=this.buttonSet;if("new"===t)this.setDefaultButtonInfo();else{const o=this.settings__buttonSets.find((o=>o.Id===t));if("string"==typeof o.maps__MassActionLayout__c)try{const t=JSON.parse(o.maps__MassActionLayout__c);o.maps__MassActionLayout__c=this.extendMassActionButtonInfo(t)}catch(t){o.maps__MassActionLayout__c=[]}if("string"==typeof o.maps__MyPositionLayout__c)try{const t=JSON.parse(o.maps__MyPositionLayout__c);o.maps__MyPositionLayout__c=this.extendActionButtonInfo(t)}catch(t){o.maps__MyPositionLayout__c=[]}if("string"==typeof o.maps__POILayout__c)try{const t=JSON.parse(o.maps__POILayout__c);o.maps__POILayout__c=this.extendActionButtonInfo(t)}catch(t){o.maps__POILayout__c=[]}if("string"==typeof o.maps__TooltipLayout__c)try{const t=JSON.parse(o.maps__TooltipLayout__c);o.maps__TooltipLayout__c=this.extendActionButtonInfo(t)}catch(t){o.maps__TooltipLayout__c=[]}this.buttonSetInfo={Id:"",Name:"",maps__MassActionLayout__c:[],maps__MyPositionLayout__c:[],maps__POILayout__c:[],maps__TooltipLayout__c:[],...o}}setTimeout((()=>{this.ButtonSet_AddHandlers()}),1e3)},refreshAvailableButtons(){this.availableButtons=[];const{standardActions:t={},customActions:o={}}=window.MAActionFramework;Object.keys(t).filter((t=>"Blank Space"!==t)).forEach((o=>{const e=t[o],{Modes:a=[]}=e;if(Array.isArray(a)&&a.length>0){const t=window.MAActionFramework.getAction(e.Type,o)||{};t.dataAction=o,this.availableButtons.push(t)}})),Object.keys(o).forEach((t=>{const e=o[t],{Modes:a=[]}=e;if(Array.isArray(a)&&a.length>0){const o=window.MAActionFramework.getAction(e.Type,t)||{};o.dataAction=t,this.availableButtons.push(o)}})),setTimeout((()=>{this.attachAvailableButtonsListeners()}),1e3)},ButtonSet_AddHandlers(){const t=this;try{m(".layout .buttonset-button").draggable("destroy")}catch(t){}m(".layout .buttonset-button").draggable({opacity:.7,helper:"clone"});try{m(".layout .buttonset-section-header").draggable("destroy")}catch(t){}m(".layout .buttonset-section-header").draggable({opacity:.7,helper:"clone"}),m(".layout .buttonset-section-name.editable").click((t=>{const o=m(t.target);o.removeClass("editable").addClass("editing").html(m('<input type="text" />').val(m(t.target).text())).find("input").focus().select().blur((()=>{o.removeClass("editing").addClass("editable").text(o.find("input").val())}))}));try{m(".layout > .section-dropzone").droppable("destroy")}catch(t){}m(".layout > .section-dropzone").droppable({accept(t){let o=!1;return t.is('.actionbutton[data-type="Section"]')?o=!0:t.is(".buttonset-section-header")&&(o=t.closest(".layout").get(0)===m(this).closest(".layout").get(0)),o},tolerance:"touch",hoverClass:"hovering",drop:t.ButtonSet_InsertSection});try{m(".layout .buttonset-section .section-dropzone").droppable("destroy")}catch(t){}m(".layout .buttonset-section .section-dropzone").droppable({accept(t){let o=!1;return t.is('.actionbutton[data-type="Section"]')?o=!0:t.is(".buttonset-section-header")&&(o=t.closest(".layout").get(0)===m(this).closest(".layout").get(0)),o},tolerance:"touch",hoverClass:"hovering",drop:t.ButtonSet_InsertSectionAfterSection});try{m(".layout-marker .buttoncolumn > .button-dropzone .button-dropzone-handle, .js-layout-massaction .buttonset-section-columns > .button-dropzone .button-dropzone-handle").droppable("destroy")}catch(t){}m(".layout-marker .buttoncolumn > .button-dropzone .button-dropzone-handle, .js-layout-massaction .buttonset-section-columns > .button-dropzone .button-dropzone-handle").droppable({accept(t){let o=!1;if(m(".actionbutton",t).length){t=m(".actionbutton",t);const e=m(this).closest(".layout").attr("data-layout");o=t.is(`.actionbutton.${e}[data-type="Standard Action"], .actionbutton.${e}[data-type="Custom Action"]`)}else if(t.is('.actionbutton[data-type="Blank"], .buttonset-button'))o=!0;else{const e=m(this).closest(".layout").attr("data-layout");o=t.is(`.actionbutton.${e}[data-type="Standard Action"], .actionbutton.${e}[data-type="Custom Action"]`)}return o},tolerance:"touch",hoverClass:"hovering",drop:t.ButtonSet_InsertButton,over:t.ButtonSet_OverButton,out:t.ButtonSet_OutButton});try{m(".layout-marker .buttoncolumn .buttonset-button .button-dropzone-handle, .js-layout-massaction .buttonset-button .button-dropzone-handle").droppable("destroy")}catch(t){}m(".layout-marker .buttoncolumn .buttonset-button .button-dropzone-handle, .js-layout-massaction .buttonset-button .button-dropzone-handle").droppable({accept(t){if(m(".actionbutton",t).length){t=m(".actionbutton",t);const o=m(this).closest(".layout").attr("data-layout");return t.is(`.actionbutton.${o}[data-type="Standard Action"], .actionbutton.${o}[data-type="Custom Action"]`)}if(t.is('.actionbutton[data-type="Blank"], .buttonset-button'))return!0;const o=m(this).closest(".layout").attr("data-layout");return t.is(`.actionbutton.${o}[data-type="Standard Action"], .actionbutton.${o}[data-type="Custom Action"]`)},tolerance:"touch",hoverClass:"hovering",drop:t.ButtonSet_InsertButtonAfterButton,over:t.ButtonSet_OverButton,out:t.ButtonSet_OutButton})},ButtonSet_InsertSection(t,o){const{target:e}=t,a=this;if(o.draggable.is(".buttonset-section-header")){if(m.contains(o.draggable.closest(".buttonset-section").get(0),e))return void m(e).removeClass("hovering");m(e).after(o.draggable.closest(".buttonset-section"))}else{const t=m(".templates .buttonset-section").clone();m(e).closest(".layout").is(".js-layout-massaction")&&t.find(".buttonset-section-columns").html('<div class="button-dropzone"><div class="button-dropzone-handle"></div></div>'),m(e).after(t),t.on("click",".buttonset-section-name.editable",(t=>{const o=m(t.target);o.removeClass("editable").addClass("editing").html(m('<input type="text" />').val(m(t.target).text())).find("input").focus().select().blur((()=>{o.removeClass("editing").addClass("editable").text(o.find("input").val())}))})),t.find(".buttonset-section-header").draggable({opacity:.7,helper:"clone"}),t.find(".section-dropzone").droppable({accept(t){let o=!1;return t.is('.actionbutton[data-type="Section"]')?o=!0:t.is(".buttonset-section-header")&&(o=t.closest(".layout").get(0)===m(e).closest(".layout").get(0)),o},tolerance:"touch",hoverClass:"hovering",drop:a.ButtonSet_InsertSectionAfterSection}),t.find(".button-dropzone-handle").droppable({accept(t){if(t.is('.actionbutton[data-type="Blank"], .buttonset-button'))return!0;const o=m(e).closest(".layout").attr("data-layout");return t.is(`.actionbutton.${o}[data-type="Standard Action"], .actionbutton.${o}[data-type="Custom Action"]`)},tolerance:"touch",hoverClass:"hovering",drop:a.ButtonSet_InsertButton,over:a.ButtonSet_OverButton,out:a.ButtonSet_OutButton})}},ButtonSet_InsertSectionAfterSection(t,o){const e=this,{target:a}=t;if(o.draggable.is(".buttonset-section-header")){if(m.contains(o.draggable.closest(".buttonset-section").get(0),a))return void m(a).removeClass("hovering");m(a).closest(".buttonset-section").after(o.draggable.closest(".buttonset-section"))}else{const t=m(".templates .buttonset-section").clone();m(a).closest(".layout").is(".js-layout-massaction")&&t.find(".buttonset-section-columns").html('<div class="button-dropzone"><div class="button-dropzone-handle"></div></div>'),m(a).closest(".buttonset-section").after(t),t.on("click",".buttonset-section-name.editable",(t=>{const o=m(t.target);o.removeClass("editable").addClass("editing").html(m('<input type="text" />').val(m(t.target).text())).find("input").focus().select().blur((()=>{o.removeClass("editing").addClass("editable").text(o.find("input").val())}))})),t.find(".buttonset-section-header").draggable({opacity:.7,helper:"clone"}),t.find(".section-dropzone").droppable({accept(t){let o=!1;return t.is('.actionbutton[data-type="Section"]')?o=!0:t.is(".buttonset-section-header")&&(o=t.closest(".layout").get(0)===m(a).closest(".layout").get(0)),o},tolerance:"touch",hoverClass:"hovering",drop:e.ButtonSet_InsertSectionAfterSection}),t.find(".button-dropzone-handle").droppable({accept(t){let o=!1;if(t.is('.actionbutton[data-type="Blank"], .buttonset-button'))o=!0;else{const e=m(a).closest(".layout").attr("data-layout");o=t.is(`.actionbutton.${e}[data-type="Standard Action"], .actionbutton.${e}[data-type="Custom Action"]`)}return o},tolerance:"touch",hoverClass:"hovering",drop:e.ButtonSet_InsertButton,over:e.ButtonSet_OverButton,out:e.ButtonSet_OutButton})}},ButtonSet_InsertButton(t,o){const e=this,{target:a}=t;let s;if(o.draggable.is(".buttonset-button")){if(m.contains(o.draggable.get(0),a))return void m(a).closest(".button-dropzone").removeClass("hovering");s=o.draggable}else if(s=m(".templates .buttonset-button").clone().prepend(o.draggable.clone()),m(a).closest(".layout").is(".js-layout-massaction")){const t=e.htmlEncode(s.text());s.find(".actionbutton").html(`<span class="ma-icon ma-icon-chevronright"></span> ${t}`)}m(a).closest(".button-dropzone").removeClass("hovering").after(s).next().find(".button-dropzone-handle").droppable({accept(t){if(t.is('.actionbutton[data-type="Blank"], .buttonset-button'))return!0;const o=m(a).closest(".layout").attr("data-layout");return t.is(`.actionbutton.${o}[data-type="Standard Action"], .actionbutton.${o}[data-type="Custom Action"]`)},tolerance:"touch",hoverClass:"hovering",drop:e.ButtonSet_InsertButtonAfterButton,over:e.ButtonSet_OverButton,out:e.ButtonSet_OutButton}),s.draggable({opacity:.7,helper:"clone"})},htmlEncode(t){return t=this.htmlDecode(t),String(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},htmlDecode(t){let o=t;if("string"==typeof t)if("object"==typeof document){const e=document.createElement("textarea");e.innerHTML=t,o=e.value}else o=String(t).replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">");return o},ButtonSet_InsertButtonAfterButton(t,o){const e=this,{target:a}=t;let s;if(o.draggable.is(".buttonset-button")){if(m.contains(o.draggable.get(0),a))return void m(a).closest(".button-dropzone").removeClass("hovering");s=o.draggable}else if(s=m(".templates .buttonset-button").clone().prepend(o.draggable.clone()),m(a).closest(".layout").is(".js-layout-massaction")){const t=e.htmlEncode(s.text());s.find(".actionbutton").html(`<span class="ma-icon ma-icon-chevronright"></span> ${t}`)}s.draggable({opacity:.7,helper:"clone",start(){const t=m(".actionbutton",this);let o=!1;try{"Custom Action"===t.attr("data-type")&&"Iframe"===window.MAActionFramework.customActions[t.attr("data-action")].Action&&(o=!0)}catch(t){}t.hasClass("Tooltip")&&m(".layout-tooltip-wrapper").addClass("canDrop"),t.hasClass("Mass")&&!1===o&&m(".layout-massaction-wrapper").addClass("canDrop"),t.hasClass("POI")&&m(".layout-poi-wrapper").addClass("canDrop"),t.hasClass("MyPosition")&&m(".layout-myposition-wrapper").addClass("canDrop"),m("#button-layouts .actionbutton").each(((o,e)=>{m(e).attr("data-action")===t.attr("data-action")&&m(e).css("background","#D3A7A7")}))},stop(){m(".layout-wrapper").removeClass("canDrop"),m(".actionbutton").each(((t,o)=>{m(o).css("background","white")}))}}),m(a).closest(".button-dropzone").removeClass("hovering").closest(".buttonset-button").after(s).next().find(".button-dropzone-handle").droppable({accept(t){if(m(".actionbutton",t).length){t=m(".actionbutton",t);const o=m(this).closest(".layout").attr("data-layout");return t.is(`.actionbutton.${o}[data-type="Standard Action"], .actionbutton.${o}[data-type="Custom Action"]`)}if(t.is('.actionbutton[data-type="Blank"], .buttonset-button'))return!0;const o=m(a).closest(".layout").attr("data-layout");return t.is(`.actionbutton.${o}[data-type="Standard Action"], .actionbutton.${o}[data-type="Custom Action"]`)},tolerance:"touch",hoverClass:"hovering",drop:e.ButtonSet_InsertButtonAfterButton,over:e.ButtonSet_OverButton,out:e.ButtonSet_OutButton})},ButtonSet_OverButton(t){const{target:o}=t;m(o).closest(".button-dropzone").addClass("hovering")},ButtonSet_OutButton(t){const{target:o}=t;m(o).closest(".button-dropzone").removeClass("hovering")},ButtonSet_BuildLayout(t){const o=[];return t.find(".buttonset-section").each(((e,a)=>{if(t.is(".js-layout-massaction")){const t={Label:m(a).find(".buttonset-section-name").text().trim()||this.$Labels.MA_Mass_Action_Layout,Buttons:[]};o.push(t),m(a).find(".buttonset-section-columns .buttonset-button").each(((o,e)=>{t.Buttons.push({Label:m(e).find(".actionbutton").attr("data-action"),Type:m(e).find(".actionbutton").attr("data-type")})}))}else{const t={Label:m(a).find(".buttonset-section-name").text(),Columns:[]};o.push(t),m(a).find(".buttonset-section-columns .buttoncolumn").each(((o,e)=>{const a=[];t.Columns.push(a),m(e).find(".buttonset-button").each(((t,o)=>{a.push({Label:m(o).find(".actionbutton").attr("data-action"),Type:m(o).find(".actionbutton").attr("data-type")})}))}))}})),o},ButtonSet_Save(t){if(""===this.buttonSetInfo.Name)return void window.MAToastMessages.showError({message:this.$Labels.Almost_There,subMessage:this.$Labels.MapsSetting_Enter_Button_Set_Name,timeOut:1e4,closeButton:!0});this.isLoading=!0;const o={Name:this.buttonSetInfo.Name,maps__TooltipLayout__c:JSON.stringify(this.ButtonSet_BuildLayout(m(".js-layout-tooltip"))),maps__MyPositionLayout__c:JSON.stringify(this.ButtonSet_BuildLayout(m(".js-layout-myposition"))),maps__POILayout__c:JSON.stringify(this.ButtonSet_BuildLayout(m(".js-layout-poi"))),maps__MassActionLayout__c:JSON.stringify(this.ButtonSet_BuildLayout(m(".js-layout-massaction")))};t||""===this.buttonSetInfo.Id||(o.Id=this.buttonSetInfo.Id);const e={action:"save_buttonset",serializedButtonSet:JSON.stringify(o)};this.settings__saveButtonSetInfo(e).then((t=>{const o=t.Id;this.buttonSetInfo={},this.buttonSetInfo.maps__MassActionLayout__c=[],this.buttonSetInfo.maps__MyPositionLayout__c=[],this.buttonSetInfo.maps__POILayout__c=[],this.buttonSetInfo.maps__TooltipLayout__c=[],this.rerenderDropzones(),this.settings__getButtonSetInfo().then((()=>{this.buttonSet=o,this.updateButtonSetInfo(),setTimeout((()=>{this.ButtonSet_AddHandlers(),this.resetFilter()}),1e3)})).catch((()=>{this.$root.$emit("toast",{state:"warning",message:this.$Labels.No_Access_To_Some_Features_Error})})),window.MAToastMessages.showSuccess({message:this.$Labels.MA_Saved})})).catch((t=>{window.MAToastMessages.showError({message:this.$Labels.MapsSetting_Changes_Were_Not_Saved,subMessage:t.message,timeOut:1e4,closeButton:!0})})).finally((()=>{this.isLoading=!1}))},ButtonSet_Delete(){this.isLoading=!0,this.settings__deleteButtonSet(this.buttonSetInfo.Id).then((()=>{this.buttonSet="new",this.updateButtonSetInfo(),setTimeout((()=>{this.ButtonSet_AddHandlers(),this.resetFilter()}),1e3),window.MAToastMessages.showSuccess({message:this.$Labels.MA_Saved})})).catch((t=>{console.warn(t),window.MAToastMessages.showError({message:this.$Labels.Almost_There,subMessage:t.message,timeOut:1e4,closeButton:!0})})).finally((()=>{this.isLoading=!1}))},filterButtons(){let t=!1;""===this.buttonFilter&&(t=!0),m(".layout-availablebuttons .actionbutton").each(((o,e)=>{let a=m(e).find(".buttonText").text();a=a.toLowerCase();const s=this.buttonFilter.toLowerCase();t||-1!==a.indexOf(s)?m(e).show():-1===a.indexOf(s)&&m(e).hide()}))}}},v=(0,d.Z)(S,(function(){var t=this,o=t._self._c;return o("div",{attrs:{id:"TopTabs-ButtonSets"}},[t.isLoading?o("Spinner"):t._e(),t._v(" "),o("div",{staticClass:"slds-grid"},[o("div",{staticClass:"slds-col slds-size_1-of-1 slds-medium-size_1-of-3"},[o("Picklist",{staticClass:"slds-p-vertical_xx-small",attrs:{options:t.combinedButtons,detach:!1,labels:{name:t.$Labels.Maps_Button_Set},idKey:"Id",titleKey:"Name",filterable:""},on:{"selected-option":t.updateButtonSetInfo},model:{value:t.buttonSet,callback:function(o){t.buttonSet=o},expression:"buttonSet"}})],1)]),t._v(" "),o("div",{staticClass:"slds-section slds-m-bottom_large slds-is-open basicinfo"},[o("div",{staticClass:"slds-section__content section__content"},[o("div",{staticClass:"slds-grid"},[o("div",{staticClass:"slds-col slds-size_1-of-1 slds-medium-size_1-of-3"},[o("TextInput",{staticClass:"slds-form-element slds-m-bottom_small",attrs:{required:!0,labels:{name:t.$Labels.MA_Name}},model:{value:t.buttonSetInfo.Name,callback:function(o){t.$set(t.buttonSetInfo,"Name",o)},expression:"buttonSetInfo.Name"}})],1)])])]),t._v(" "),o("div",{staticClass:"slds-section slds-m-bottom_large slds-is-open basicinfo layout"},[o("div",{staticClass:"slds-section__title slds-theme--shade"},[o("span",{staticClass:"section-header-title slds-p-horizontal--small slds-truncate"},[t._v(t._s(t.$Labels.MA_Layout))])]),t._v(" "),o("div",{staticClass:"slds-section__content section__content"},[o("div",{staticClass:"slds-grid"},[o("div",{staticClass:"slds-col slds-size_1-of-1 slds-large-size_3-of-4"},[o("div",{staticClass:"slds-card slds-card_boundary"},[o("div",{staticClass:"slds-card__header slds-grid"},[o("header",{staticClass:"slds-media slds-media_center slds-has-flexi-truncate"},[o("div",{staticClass:"slds-media__body"},[o("h2",{staticClass:"slds-card__header-title"},[t._v("\n                                        "+t._s(t._f("decode")(t.$Labels.MA_Available_Buttons))+"\n                                        "),t.showFilter?t._e():o("span",{staticClass:"ma-icon ma-icon-filterlist",staticStyle:{color:"rgb(123, 123, 123)","font-size":"12px","vertical-align":"top",cursor:"pointer"},attrs:{title:"Filter buttons based on a search term"},on:{click:function(o){t.showFilter=!0}}}),t._v(" "),t.showFilter?o("span",[o("TextInput",{staticClass:"slds-form-element slds-m-bottom_small",attrs:{placeholder:"Filter Buttons...",labels:{placeholder:"Filter Buttons..."}},on:{changed:t.filterButtons},model:{value:t.buttonFilter,callback:function(o){t.buttonFilter=o},expression:"buttonFilter"}})],1):t._e()])])])]),t._v(" "),o("div",{staticClass:"slds-card__body slds-card__body_inner"},[o("div",{staticClass:"layout-availablebuttons slds-pill_container slds-grid slds-wrap"},t._l(t.availableButtons,(function(t,e){return o("ButtonPill",{key:e,attrs:{button:t}})})),1)])]),t._v(" "),t.doRenderDropzones?o("table",{staticClass:"button-layouts-label slds-m-top_small",staticStyle:{"z-index":"1"},attrs:{id:"button-layouts"}},[o("tr",[o("td",[o("ButtonSetLayoutDropZone",{attrs:{buttonSet:t.buttonSetInfo.maps__TooltipLayout__c,sectionTitle:t.$Labels.MA_Tooltip_Layout,type:"tooltip"}}),t._v(" "),o("ButtonSetLayoutDropZone",{staticClass:"slds-m-top_small",attrs:{buttonSet:t.buttonSetInfo.maps__MyPositionLayout__c,sectionTitle:t.$Labels.MapsSetting_MyPosition,type:"myposition"}}),t._v(" "),o("ButtonSetLayoutDropZone",{staticClass:"slds-m-top_small",attrs:{buttonSet:t.buttonSetInfo.maps__POILayout__c,sectionTitle:t.$Labels.MapsSetting_ButtonSet_POI_Header,type:"poi"}})],1),t._v(" "),o("td",{staticStyle:{width:"375px"}},[o("MassActionDropZone",{attrs:{buttonSet:t.buttonSetInfo.maps__MassActionLayout__c}})],1)])]):t._e()])])])]),t._v(" "),o("div",{staticClass:"buttons"},[o("input",{staticClass:"buttonset-savebtn MAbutton button-blue slds-button slds-button_brand",attrs:{type:"button",value:t.$Labels.MA_Save},on:{click:function(o){return t.ButtonSet_Save()}}}),t._v(" "),o("input",{directives:[{name:"show",rawName:"v-show",value:t.showExtendedSaveButtons,expression:"showExtendedSaveButtons"}],staticClass:"buttonset-saveasbtn MAbutton button-blue slds-button slds-button_brand",attrs:{type:"button",value:t.$Labels.MA_SaveAs},on:{click:function(o){return t.ButtonSet_Save(!0)}}}),t._v(" "),o("input",{directives:[{name:"show",rawName:"v-show",value:t.showExtendedSaveButtons,expression:"showExtendedSaveButtons"}],staticClass:"buttonset-deletebtn MAbutton button-red slds-button slds-button_destructive",attrs:{type:"button",value:t.$Labels.MA_Delete},on:{click:function(o){return t.ButtonSet_Delete()}}}),t._v(" "),o("span",{staticClass:"msgs",staticStyle:{color:"red","font-size":"10px",display:"none"}})]),t._v(" "),o("div",{staticClass:"templates",staticStyle:{display:"none"}},[o("div",{staticClass:"buttonset-section"},[o("div",{staticClass:"buttonset-section-header"},[o("div",{staticClass:"buttonset-section-name editable"},[t._v("\n                    "+t._s(t.$Labels.MA_New_Section)+"\n                ")])]),t._v(" "),t._m(0),t._v(" "),o("div",{staticClass:"section-dropzone"})]),t._v(" "),t._m(1)])],1)}),[function(){var t=this,o=t._self._c;return o("div",{staticClass:"buttonset-section-columns"},[o("div",{staticClass:"buttoncolumn"},[o("div",{staticClass:"button-dropzone"},[o("div",{staticClass:"button-dropzone-handle"})])]),t._v(" "),o("div",{staticClass:"buttoncolumn"},[o("div",{staticClass:"button-dropzone"},[o("div",{staticClass:"button-dropzone-handle"})])]),t._v(" "),o("div",{staticClass:"buttoncolumn"},[o("div",{staticClass:"button-dropzone"},[o("div",{staticClass:"button-dropzone-handle"})])])])},function(){var t=this._self._c;return t("div",{staticClass:"buttonset-button"},[t("div",{staticClass:"button-dropzone"},[t("div",{staticClass:"button-dropzone-handle"})])])}],!1,null,"d6b9797c",null).exports}}]);