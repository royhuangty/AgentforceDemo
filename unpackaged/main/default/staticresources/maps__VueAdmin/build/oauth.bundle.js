"use strict";(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[2199],{1262:(t,s,e)=>{e.r(s),e.d(s,{default:()=>h});var r=e(2646),o=e(257),i=e(5658);class a{static handleRemoteActionError(t){Error((0,i.N4)(window.MASystem.Labels.MapsSettings_Remote_Action_Exception,[t]))}static getOauthUser(){return new Promise(((t,s)=>{(new o.Z).setAction("maps.OAuth.getOauthUser").setErrorHandler((()=>{s(new Error(window.MASystem.Labels.OAuth_Could_Not_Auth_User))})).invoke([],(e=>{e.securityError?s(new Error(e.error)):e?t(e):s(new Error(window.MASystem.Labels.OAuth_Could_Not_Auth_User))}),{buffer:!1})}))}static setOauthUser(){return new Promise(((t,s)=>{(new o.Z).setAction("maps.OAuth.setOauthUser").setErrorHandler((()=>{s(new Error(window.MASystem.Labels.OAuth_Could_Not_Auth_User))})).invoke([],(e=>{e.securityError?s(new Error(e.error)):e?t(e):s(new Error(window.MASystem.Labels.OAuth_Could_Not_Auth_User))}),{buffer:!1})}))}static revokeOauthUser(){return new Promise(((t,s)=>{(new o.Z).setAction("maps.OAuth.revokeOauthUser").setErrorHandler((()=>{s(new Error(window.MASystem.Labels.OAuth_Could_Not_Remove_Auth))})).invoke([],(e=>{e.securityError?s(new Error(e.error)):e?t(e):s(new Error(window.MASystem.Labels.OAuth_Could_Not_Remove_Auth))}),{buffer:!1})}))}}const{MAToastMessages:n}=window,u={components:{Spinner:r.$j,SetupAssistantItem:r.P6},data:()=>({authExists:!1,authorizedTerritoryUser:"",isLoading:!1,hasError:!1}),computed:{isAuthorized:{get(){return this.authExists},set(t){this.authExists=t,this.authExists||(this.authorizedTerritoryUser="")}}},created(){this.loadAuthorizationInformation()},methods:{authorize(){this.isLoading=!0,a.setOauthUser().then((t=>{const s=window.htmlDecode(t.authUrl);window.open(s),setTimeout((()=>{this.loadAuthorizationInformation()}),5e3)})).catch((t=>{console.warn(t),this.isLoading=!1,this.hasError=!0,window.MAToastMessages.showError({message:t.message,closeButton:!0,timeOut:0})}))},deauthorize(){this.isLoading=!0,a.revokeOauthUser().then((t=>{t.success?(n.showSuccess({message:this.$Labels.OAuth_Auth_Removed}),this.loadAuthorizationInformation()):n.showError({message:this.$Labels.MA_Error,subMessage:this.$Labels.OAuth_Could_Not_Remove_Auth,timeOut:0,extendedTimeOut:0,closeButton:!0})})).catch((t=>{console.warn(t),this.isLoading=!1,this.hasError=!0,window.MAToastMessages.showError({message:t.message,closeButton:!0,timeOut:0})})).finally((()=>{this.isLoading=!1}))},loadAuthorizationInformation(){this.isLoading=!0,a.getOauthUser().then((t=>{this.isAuthorized=t.authExists,this.isAuthorized&&(this.authorizedTerritoryUser=t.authUserName),this.isLoading=!1})).catch((t=>{console.warn(t),this.isLoading=!1,this.hasError=!0,window.MAToastMessages.showError({message:t.message,closeButton:!0,timeOut:0})}))}}},h=(0,e(1900).Z)(u,(function(){var t=this,s=t._self._c;return s("div",[t.isLoading?s("Spinner"):t._e(),t._v(" "),s("div",{staticClass:"slds-section slds-is-open"},[s("div",{staticClass:"slds-section__content"},[s("ol",{staticClass:"slds-setup-assistant"},[s("SetupAssistantItem",{attrs:{stepProgress:!1,heading:t.$Labels.OAuth_SF_Maps_Authorization,description:t.$Labels.OAuth_SF_Maps_Authorization_Description}},[s("div",{attrs:{slot:"content"},slot:"content"},[t.isAuthorized?s("div",{staticClass:"slds-grid slds-grid_vertical-align-end slds-grid_vertical",attrs:{id:"currentAuthInfo"}},[s("div",[s("button",{staticClass:"slds-button slds-button_text-destructive",attrs:{id:"deauthorizeTerritoryUser"},on:{click:t.deauthorize}},[t._v("\n                                    "+t._s(t.$Labels.OAuth_Deauthorize_Button)+"\n                                ")])]),t._v(" "),s("div",{staticClass:"slds-text-align_right slds-text-color_weak slds-p-top_medium"},[s("div",[t._v("\n                                    "+t._s(t.$Labels.OAuth_Current_Authorized_User)+"\n                                ")]),t._v(" "),s("div",{staticClass:"slds-m-bottom_small",attrs:{id:"currentAuthName"}},[t._v("\n                                    "+t._s(t.authorizedTerritoryUser)+"\n                                ")])])]):s("div",[s("div",{attrs:{id:"authorizeTerritory"}},[s("button",{staticClass:"slds-button slds-button_neutral",attrs:{id:"authorizeTerritoryIO",disabled:t.hasError},on:{click:t.authorize}},[t._v("\n                                    "+t._s(t.$Labels.OAuth_Authorize_Button)+"\n                                ")])])])])])],1)])])],1)}),[],!1,null,null,null).exports}}]);