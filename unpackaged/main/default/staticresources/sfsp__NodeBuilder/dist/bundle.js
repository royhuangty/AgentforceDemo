var W5=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var bme=W5((Sme,rb)=>{function k2(e,t){const s=Object.create(null),n=e.split(",");for(let r=0;r<n.length;r++)s[n[r]]=!0;return t?r=>!!s[r.toLowerCase()]:r=>!!s[r]}function br(e){if(dn(e)){const t={};for(let s=0;s<e.length;s++){const n=e[s],r=Ni(n)?K5(n):br(n);if(r)for(const a in r)t[a]=r[a]}return t}else{if(Ni(e))return e;if(Yr(e))return e}}const Y5=/;(?![^(]*\))/g,Z5=/:([^]+)/,X5=/\/\*.*?\*\//gs;function K5(e){const t={};return e.replace(X5,"").split(Y5).forEach(s=>{if(s){const n=s.split(Z5);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function $t(e){let t="";if(Ni(e))t=e;else if(dn(e))for(let s=0;s<e.length;s++){const n=$t(e[s]);n&&(t+=n+" ")}else if(Yr(e))for(const s in e)e[s]&&(t+=s+" ");return t.trim()}function kp(e){if(!e)return null;let{class:t,style:s}=e;return t&&!Ni(t)&&(e.class=$t(t)),s&&(e.style=br(s)),e}const J5="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Q5=k2(J5);function EM(e){return!!e||e===""}function eO(e,t){if(e.length!==t.length)return!1;let s=!0;for(let n=0;s&&n<e.length;n++)s=ib(e[n],t[n]);return s}function ib(e,t){if(e===t)return!0;let s=NI(e),n=NI(t);if(s||n)return s&&n?e.getTime()===t.getTime():!1;if(s=ov(e),n=ov(t),s||n)return e===t;if(s=dn(e),n=dn(t),s||n)return s&&n?eO(e,t):!1;if(s=Yr(e),n=Yr(t),s||n){if(!s||!n)return!1;const r=Object.keys(e).length,a=Object.keys(t).length;if(r!==a)return!1;for(const o in e){const d=e.hasOwnProperty(o),p=t.hasOwnProperty(o);if(d&&!p||!d&&p||!ib(e[o],t[o]))return!1}}return String(e)===String(t)}const Pe=e=>Ni(e)?e:e==null?"":dn(e)||Yr(e)&&(e.toString===$M||!Bn(e.toString))?JSON.stringify(e,kM,2):String(e),kM=(e,t)=>t&&t.__v_isRef?kM(e,t.value):rg(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((s,[n,r])=>(s[`${n} =>`]=r,s),{})}:PM(t)?{[`Set(${t.size})`]:[...t.values()]}:Yr(t)&&!dn(t)&&!OM(t)?String(t):t,di={},ng=[],vu=()=>{},tO=()=>!1,sO=/^on[^a-z]/,jb=e=>sO.test(e),P2=e=>e.startsWith("onUpdate:"),Do=Object.assign,R2=(e,t)=>{const s=e.indexOf(t);s>-1&&e.splice(s,1)},nO=Object.prototype.hasOwnProperty,dr=(e,t)=>nO.call(e,t),dn=Array.isArray,rg=e=>jv(e)==="[object Map]",PM=e=>jv(e)==="[object Set]",NI=e=>jv(e)==="[object Date]",Bn=e=>typeof e=="function",Ni=e=>typeof e=="string",ov=e=>typeof e=="symbol",Yr=e=>e!==null&&typeof e=="object",RM=e=>Yr(e)&&Bn(e.then)&&Bn(e.catch),$M=Object.prototype.toString,jv=e=>$M.call(e),rO=e=>jv(e).slice(8,-1),OM=e=>jv(e)==="[object Object]",$2=e=>Ni(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,D1=k2(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),qb=e=>{const t=Object.create(null);return s=>t[s]||(t[s]=e(s))},iO=/-(\w)/g,ud=qb(e=>e.replace(iO,(t,s)=>s?s.toUpperCase():"")),oO=/\B([A-Z])/g,Mm=qb(e=>e.replace(oO,"-$1").toLowerCase()),Hb=qb(e=>e.charAt(0).toUpperCase()+e.slice(1)),B1=qb(e=>e?`on${Hb(e)}`:""),av=(e,t)=>!Object.is(e,t),F1=(e,t)=>{for(let s=0;s<e.length;s++)e[s](t)},ob=(e,t,s)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:s})},mS=e=>{const t=parseFloat(e);return isNaN(t)?e:t},aO=e=>{const t=Ni(e)?Number(e):NaN;return isNaN(t)?e:t};let DI;const lO=()=>DI||(DI=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let Rl;class LM{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Rl,!t&&Rl&&(this.index=(Rl.scopes||(Rl.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const s=Rl;try{return Rl=this,t()}finally{Rl=s}}}on(){Rl=this}off(){Rl=this.parent}stop(t){if(this._active){let s,n;for(s=0,n=this.effects.length;s<n;s++)this.effects[s].stop();for(s=0,n=this.cleanups.length;s<n;s++)this.cleanups[s]();if(this.scopes)for(s=0,n=this.scopes.length;s<n;s++)this.scopes[s].stop(!0);if(!this.detached&&this.parent&&!t){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0,this._active=!1}}}function NM(e){return new LM(e)}function cO(e,t=Rl){t&&t.active&&t.effects.push(e)}function DM(){return Rl}function uO(e){Rl&&Rl.cleanups.push(e)}const O2=e=>{const t=new Set(e);return t.w=0,t.n=0,t},BM=e=>(e.w&qp)>0,FM=e=>(e.n&qp)>0,dO=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=qp},hO=e=>{const{deps:t}=e;if(t.length){let s=0;for(let n=0;n<t.length;n++){const r=t[n];BM(r)&&!FM(r)?r.delete(e):t[s++]=r,r.w&=~qp,r.n&=~qp}t.length=s}},ab=new WeakMap;let Vy=0,qp=1;const _S=30;let fu;const um=Symbol(""),gS=Symbol("");class L2{constructor(t,s=null,n){this.fn=t,this.scheduler=s,this.active=!0,this.deps=[],this.parent=void 0,cO(this,n)}run(){if(!this.active)return this.fn();let t=fu,s=Dp;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=fu,fu=this,Dp=!0,qp=1<<++Vy,Vy<=_S?dO(this):BI(this),this.fn()}finally{Vy<=_S&&hO(this),qp=1<<--Vy,fu=this.parent,Dp=s,this.parent=void 0,this.deferStop&&this.stop()}}stop(){fu===this?this.deferStop=!0:this.active&&(BI(this),this.onStop&&this.onStop(),this.active=!1)}}function BI(e){const{deps:t}=e;if(t.length){for(let s=0;s<t.length;s++)t[s].delete(e);t.length=0}}let Dp=!0;const zM=[];function Og(){zM.push(Dp),Dp=!1}function Lg(){const e=zM.pop();Dp=e===void 0?!0:e}function ul(e,t,s){if(Dp&&fu){let n=ab.get(e);n||ab.set(e,n=new Map);let r=n.get(s);r||n.set(s,r=O2()),UM(r)}}function UM(e,t){let s=!1;Vy<=_S?FM(e)||(e.n|=qp,s=!BM(e)):s=!e.has(fu),s&&(e.add(fu),fu.deps.push(e))}function gh(e,t,s,n,r,a){const o=ab.get(e);if(!o)return;let d=[];if(t==="clear")d=[...o.values()];else if(s==="length"&&dn(e)){const p=Number(n);o.forEach((y,v)=>{(v==="length"||v>=p)&&d.push(y)})}else switch(s!==void 0&&d.push(o.get(s)),t){case"add":dn(e)?$2(s)&&d.push(o.get("length")):(d.push(o.get(um)),rg(e)&&d.push(o.get(gS)));break;case"delete":dn(e)||(d.push(o.get(um)),rg(e)&&d.push(o.get(gS)));break;case"set":rg(e)&&d.push(o.get(um));break}if(d.length===1)d[0]&&yS(d[0]);else{const p=[];for(const y of d)y&&p.push(...y);yS(O2(p))}}function yS(e,t){const s=dn(e)?e:[...e];for(const n of s)n.computed&&FI(n);for(const n of s)n.computed||FI(n)}function FI(e,t){(e!==fu||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}function pO(e,t){var s;return(s=ab.get(e))===null||s===void 0?void 0:s.get(t)}const fO=k2("__proto__,__v_isRef,__isVue"),VM=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(ov)),mO=N2(),_O=N2(!1,!0),gO=N2(!0),zI=yO();function yO(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...s){const n=ar(this);for(let a=0,o=this.length;a<o;a++)ul(n,"get",a+"");const r=n[t](...s);return r===-1||r===!1?n[t](...s.map(ar)):r}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...s){Og();const n=ar(this)[t].apply(this,s);return Lg(),n}}),e}function vO(e){const t=ar(this);return ul(t,"has",e),t.hasOwnProperty(e)}function N2(e=!1,t=!1){return function(n,r,a){if(r==="__v_isReactive")return!e;if(r==="__v_isReadonly")return e;if(r==="__v_isShallow")return t;if(r==="__v_raw"&&a===(e?t?LO:WM:t?GM:HM).get(n))return n;const o=dn(n);if(!e){if(o&&dr(zI,r))return Reflect.get(zI,r,a);if(r==="hasOwnProperty")return vO}const d=Reflect.get(n,r,a);return(ov(r)?VM.has(r):fO(r))||(e||ul(n,"get",r),t)?d:yi(d)?o&&$2(r)?d:d.value:Yr(d)?e?YM(d):Em(d):d}}const bO=jM(),xO=jM(!0);function jM(e=!1){return function(s,n,r,a){let o=s[n];if(Sm(o)&&yi(o)&&!yi(r))return!1;if(!e&&(!lb(r)&&!Sm(r)&&(o=ar(o),r=ar(r)),!dn(s)&&yi(o)&&!yi(r)))return o.value=r,!0;const d=dn(s)&&$2(n)?Number(n)<s.length:dr(s,n),p=Reflect.set(s,n,r,a);return s===ar(a)&&(d?av(r,o)&&gh(s,"set",n,r):gh(s,"add",n,r)),p}}function wO(e,t){const s=dr(e,t);e[t];const n=Reflect.deleteProperty(e,t);return n&&s&&gh(e,"delete",t,void 0),n}function SO(e,t){const s=Reflect.has(e,t);return(!ov(t)||!VM.has(t))&&ul(e,"has",t),s}function CO(e){return ul(e,"iterate",dn(e)?"length":um),Reflect.ownKeys(e)}const qM={get:mO,set:bO,deleteProperty:wO,has:SO,ownKeys:CO},IO={get:gO,set(e,t){return!0},deleteProperty(e,t){return!0}},TO=Do({},qM,{get:_O,set:xO}),D2=e=>e,Gb=e=>Reflect.getPrototypeOf(e);function y1(e,t,s=!1,n=!1){e=e.__v_raw;const r=ar(e),a=ar(t);s||(t!==a&&ul(r,"get",t),ul(r,"get",a));const{has:o}=Gb(r),d=n?D2:s?z2:lv;if(o.call(r,t))return d(e.get(t));if(o.call(r,a))return d(e.get(a));e!==r&&e.get(t)}function v1(e,t=!1){const s=this.__v_raw,n=ar(s),r=ar(e);return t||(e!==r&&ul(n,"has",e),ul(n,"has",r)),e===r?s.has(e):s.has(e)||s.has(r)}function b1(e,t=!1){return e=e.__v_raw,!t&&ul(ar(e),"iterate",um),Reflect.get(e,"size",e)}function UI(e){e=ar(e);const t=ar(this);return Gb(t).has.call(t,e)||(t.add(e),gh(t,"add",e,e)),this}function VI(e,t){t=ar(t);const s=ar(this),{has:n,get:r}=Gb(s);let a=n.call(s,e);a||(e=ar(e),a=n.call(s,e));const o=r.call(s,e);return s.set(e,t),a?av(t,o)&&gh(s,"set",e,t):gh(s,"add",e,t),this}function jI(e){const t=ar(this),{has:s,get:n}=Gb(t);let r=s.call(t,e);r||(e=ar(e),r=s.call(t,e)),n&&n.call(t,e);const a=t.delete(e);return r&&gh(t,"delete",e,void 0),a}function qI(){const e=ar(this),t=e.size!==0,s=e.clear();return t&&gh(e,"clear",void 0,void 0),s}function x1(e,t){return function(n,r){const a=this,o=a.__v_raw,d=ar(o),p=t?D2:e?z2:lv;return!e&&ul(d,"iterate",um),o.forEach((y,v)=>n.call(r,p(y),p(v),a))}}function w1(e,t,s){return function(...n){const r=this.__v_raw,a=ar(r),o=rg(a),d=e==="entries"||e===Symbol.iterator&&o,p=e==="keys"&&o,y=r[e](...n),v=s?D2:t?z2:lv;return!t&&ul(a,"iterate",p?gS:um),{next(){const{value:C,done:I}=y.next();return I?{value:C,done:I}:{value:d?[v(C[0]),v(C[1])]:v(C),done:I}},[Symbol.iterator](){return this}}}}function bp(e){return function(...t){return e==="delete"?!1:this}}function AO(){const e={get(a){return y1(this,a)},get size(){return b1(this)},has:v1,add:UI,set:VI,delete:jI,clear:qI,forEach:x1(!1,!1)},t={get(a){return y1(this,a,!1,!0)},get size(){return b1(this)},has:v1,add:UI,set:VI,delete:jI,clear:qI,forEach:x1(!1,!0)},s={get(a){return y1(this,a,!0)},get size(){return b1(this,!0)},has(a){return v1.call(this,a,!0)},add:bp("add"),set:bp("set"),delete:bp("delete"),clear:bp("clear"),forEach:x1(!0,!1)},n={get(a){return y1(this,a,!0,!0)},get size(){return b1(this,!0)},has(a){return v1.call(this,a,!0)},add:bp("add"),set:bp("set"),delete:bp("delete"),clear:bp("clear"),forEach:x1(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(a=>{e[a]=w1(a,!1,!1),s[a]=w1(a,!0,!1),t[a]=w1(a,!1,!0),n[a]=w1(a,!0,!0)}),[e,s,t,n]}const[MO,EO,kO,PO]=AO();function B2(e,t){const s=t?e?PO:kO:e?EO:MO;return(n,r,a)=>r==="__v_isReactive"?!e:r==="__v_isReadonly"?e:r==="__v_raw"?n:Reflect.get(dr(s,r)&&r in n?s:n,r,a)}const RO={get:B2(!1,!1)},$O={get:B2(!1,!0)},OO={get:B2(!0,!1)},HM=new WeakMap,GM=new WeakMap,WM=new WeakMap,LO=new WeakMap;function NO(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function DO(e){return e.__v_skip||!Object.isExtensible(e)?0:NO(rO(e))}function Em(e){return Sm(e)?e:F2(e,!1,qM,RO,HM)}function BO(e){return F2(e,!1,TO,$O,GM)}function YM(e){return F2(e,!0,IO,OO,WM)}function F2(e,t,s,n,r){if(!Yr(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const a=r.get(e);if(a)return a;const o=DO(e);if(o===0)return e;const d=new Proxy(e,o===2?n:s);return r.set(e,d),d}function hh(e){return Sm(e)?hh(e.__v_raw):!!(e&&e.__v_isReactive)}function Sm(e){return!!(e&&e.__v_isReadonly)}function lb(e){return!!(e&&e.__v_isShallow)}function ZM(e){return hh(e)||Sm(e)}function ar(e){const t=e&&e.__v_raw;return t?ar(t):e}function fg(e){return ob(e,"__v_skip",!0),e}const lv=e=>Yr(e)?Em(e):e,z2=e=>Yr(e)?YM(e):e;function XM(e){Dp&&fu&&(e=ar(e),UM(e.dep||(e.dep=O2())))}function KM(e,t){e=ar(e);const s=e.dep;s&&yS(s)}function yi(e){return!!(e&&e.__v_isRef===!0)}function Nl(e){return FO(e,!1)}function FO(e,t){return yi(e)?e:new zO(e,t)}class zO{constructor(t,s){this.__v_isShallow=s,this.dep=void 0,this.__v_isRef=!0,this._rawValue=s?t:ar(t),this._value=s?t:lv(t)}get value(){return XM(this),this._value}set value(t){const s=this.__v_isShallow||lb(t)||Sm(t);t=s?t:ar(t),av(t,this._rawValue)&&(this._rawValue=t,this._value=s?t:lv(t),KM(this))}}function ir(e){return yi(e)?e.value:e}const UO={get:(e,t,s)=>ir(Reflect.get(e,t,s)),set:(e,t,s,n)=>{const r=e[t];return yi(r)&&!yi(s)?(r.value=s,!0):Reflect.set(e,t,s,n)}};function JM(e){return hh(e)?e:new Proxy(e,UO)}function VO(e){const t=dn(e)?new Array(e.length):{};for(const s in e)t[s]=qO(e,s);return t}class jO{constructor(t,s,n){this._object=t,this._key=s,this._defaultValue=n,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return pO(ar(this._object),this._key)}}function qO(e,t,s){const n=e[t];return yi(n)?n:new jO(e,t,s)}var QM;class HO{constructor(t,s,n,r){this._setter=s,this.dep=void 0,this.__v_isRef=!0,this[QM]=!1,this._dirty=!0,this.effect=new L2(t,()=>{this._dirty||(this._dirty=!0,KM(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=n}get value(){const t=ar(this);return XM(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}QM="__v_isReadonly";function GO(e,t,s=!1){let n,r;const a=Bn(e);return a?(n=e,r=vu):(n=e.get,r=e.set),new HO(n,r,a||!r,s)}function Bp(e,t,s,n){let r;try{r=n?e(...n):e()}catch(a){Wb(a,t,s)}return r}function Ec(e,t,s,n){if(Bn(e)){const a=Bp(e,t,s,n);return a&&RM(a)&&a.catch(o=>{Wb(o,t,s)}),a}const r=[];for(let a=0;a<e.length;a++)r.push(Ec(e[a],t,s,n));return r}function Wb(e,t,s,n=!0){const r=t?t.vnode:null;if(t){let a=t.parent;const o=t.proxy,d=s;for(;a;){const y=a.ec;if(y){for(let v=0;v<y.length;v++)if(y[v](e,o,d)===!1)return}a=a.parent}const p=t.appContext.config.errorHandler;if(p){Bp(p,null,10,[e,o,d]);return}}WO(e,s,r,n)}function WO(e,t,s,n=!0){console.error(e)}let cv=!1,vS=!1;const _a=[];let Ju=0;const ig=[];let nh=null,Qf=0;const eE=Promise.resolve();let U2=null;function cb(e){const t=U2||eE;return e?t.then(this?e.bind(this):e):t}function YO(e){let t=Ju+1,s=_a.length;for(;t<s;){const n=t+s>>>1;uv(_a[n])<e?t=n+1:s=n}return t}function V2(e){(!_a.length||!_a.includes(e,cv&&e.allowRecurse?Ju+1:Ju))&&(e.id==null?_a.push(e):_a.splice(YO(e.id),0,e),tE())}function tE(){!cv&&!vS&&(vS=!0,U2=eE.then(nE))}function ZO(e){const t=_a.indexOf(e);t>Ju&&_a.splice(t,1)}function XO(e){dn(e)?ig.push(...e):(!nh||!nh.includes(e,e.allowRecurse?Qf+1:Qf))&&ig.push(e),tE()}function HI(e,t=cv?Ju+1:0){for(;t<_a.length;t++){const s=_a[t];s&&s.pre&&(_a.splice(t,1),t--,s())}}function sE(e){if(ig.length){const t=[...new Set(ig)];if(ig.length=0,nh){nh.push(...t);return}for(nh=t,nh.sort((s,n)=>uv(s)-uv(n)),Qf=0;Qf<nh.length;Qf++)nh[Qf]();nh=null,Qf=0}}const uv=e=>e.id==null?1/0:e.id,KO=(e,t)=>{const s=uv(e)-uv(t);if(s===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return s};function nE(e){vS=!1,cv=!0,_a.sort(KO);const t=vu;try{for(Ju=0;Ju<_a.length;Ju++){const s=_a[Ju];s&&s.active!==!1&&Bp(s,null,14)}}finally{Ju=0,_a.length=0,sE(),cv=!1,U2=null,(_a.length||ig.length)&&nE()}}function JO(e,t,...s){if(e.isUnmounted)return;const n=e.vnode.props||di;let r=s;const a=t.startsWith("update:"),o=a&&t.slice(7);if(o&&o in n){const v=`${o==="modelValue"?"model":o}Modifiers`,{number:C,trim:I}=n[v]||di;I&&(r=s.map(O=>Ni(O)?O.trim():O)),C&&(r=s.map(mS))}let d,p=n[d=B1(t)]||n[d=B1(ud(t))];!p&&a&&(p=n[d=B1(Mm(t))]),p&&Ec(p,e,6,r);const y=n[d+"Once"];if(y){if(!e.emitted)e.emitted={};else if(e.emitted[d])return;e.emitted[d]=!0,Ec(y,e,6,r)}}function rE(e,t,s=!1){const n=t.emitsCache,r=n.get(e);if(r!==void 0)return r;const a=e.emits;let o={},d=!1;if(!Bn(e)){const p=y=>{const v=rE(y,t,!0);v&&(d=!0,Do(o,v))};!s&&t.mixins.length&&t.mixins.forEach(p),e.extends&&p(e.extends),e.mixins&&e.mixins.forEach(p)}return!a&&!d?(Yr(e)&&n.set(e,null),null):(dn(a)?a.forEach(p=>o[p]=null):Do(o,a),Yr(e)&&n.set(e,o),o)}function Yb(e,t){return!e||!jb(t)?!1:(t=t.slice(2).replace(/Once$/,""),dr(e,t[0].toLowerCase()+t.slice(1))||dr(e,Mm(t))||dr(e,t))}let Zo=null,Zb=null;function ub(e){const t=Zo;return Zo=e,Zb=e&&e.type.__scopeId||null,t}function Nr(e){Zb=e}function Dr(){Zb=null}function je(e,t=Zo,s){if(!t||e._n)return e;const n=(...r)=>{n._d&&tT(-1);const a=ub(t);let o;try{o=e(...r)}finally{ub(a),n._d&&tT(1)}return o};return n._n=!0,n._c=!0,n._d=!0,n}function Nw(e){const{type:t,vnode:s,proxy:n,withProxy:r,props:a,propsOptions:[o],slots:d,attrs:p,emit:y,render:v,renderCache:C,data:I,setupState:O,ctx:A,inheritAttrs:P}=e;let q,ce;const re=ub(e);try{if(s.shapeFlag&4){const Ce=r||n;q=Xu(v.call(Ce,Ce,C,a,O,I,A)),ce=p}else{const Ce=t;q=Xu(Ce.length>1?Ce(a,{attrs:p,slots:d,emit:y}):Ce(a,null)),ce=t.props?p:QO(p)}}catch(Ce){Xy.length=0,Wb(Ce,e,1),q=de(kc)}let W=q;if(ce&&P!==!1){const Ce=Object.keys(ce),{shapeFlag:te}=W;Ce.length&&te&7&&(o&&Ce.some(P2)&&(ce=eL(ce,o)),W=Hp(W,ce))}return s.dirs&&(W=Hp(W),W.dirs=W.dirs?W.dirs.concat(s.dirs):s.dirs),s.transition&&(W.transition=s.transition),q=W,ub(re),q}const QO=e=>{let t;for(const s in e)(s==="class"||s==="style"||jb(s))&&((t||(t={}))[s]=e[s]);return t},eL=(e,t)=>{const s={};for(const n in e)(!P2(n)||!(n.slice(9)in t))&&(s[n]=e[n]);return s};function tL(e,t,s){const{props:n,children:r,component:a}=e,{props:o,children:d,patchFlag:p}=t,y=a.emitsOptions;if(t.dirs||t.transition)return!0;if(s&&p>=0){if(p&1024)return!0;if(p&16)return n?GI(n,o,y):!!o;if(p&8){const v=t.dynamicProps;for(let C=0;C<v.length;C++){const I=v[C];if(o[I]!==n[I]&&!Yb(y,I))return!0}}}else return(r||d)&&(!d||!d.$stable)?!0:n===o?!1:n?o?GI(n,o,y):!0:!!o;return!1}function GI(e,t,s){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let r=0;r<n.length;r++){const a=n[r];if(t[a]!==e[a]&&!Yb(s,a))return!0}return!1}function sL({vnode:e,parent:t},s){for(;t&&t.subTree===e;)(e=t.vnode).el=s,t=t.parent}const nL=e=>e.__isSuspense;function rL(e,t){t&&t.pendingBranch?dn(e)?t.effects.push(...e):t.effects.push(e):XO(e)}function bS(e,t){if(Ki){let s=Ki.provides;const n=Ki.parent&&Ki.parent.provides;n===s&&(s=Ki.provides=Object.create(n)),s[e]=t}}function dm(e,t,s=!1){const n=Ki||Zo;if(n){const r=n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(r&&e in r)return r[e];if(arguments.length>1)return s&&Bn(t)?t.call(n.proxy):t}}function iL(e,t){return j2(e,null,{flush:"post"})}const S1={};function ph(e,t,s){return j2(e,t,s)}function j2(e,t,{immediate:s,deep:n,flush:r,onTrack:a,onTrigger:o}=di){const d=DM()===(Ki==null?void 0:Ki.scope)?Ki:null;let p,y=!1,v=!1;if(yi(e)?(p=()=>e.value,y=lb(e)):hh(e)?(p=()=>e,n=!0):dn(e)?(v=!0,y=e.some(W=>hh(W)||lb(W)),p=()=>e.map(W=>{if(yi(W))return W.value;if(hh(W))return rm(W);if(Bn(W))return Bp(W,d,2)})):Bn(e)?t?p=()=>Bp(e,d,2):p=()=>{if(!(d&&d.isUnmounted))return C&&C(),Ec(e,d,3,[I])}:p=vu,t&&n){const W=p;p=()=>rm(W())}let C,I=W=>{C=ce.onStop=()=>{Bp(W,d,4)}},O;if(fv)if(I=vu,t?s&&Ec(t,d,3,[p(),v?[]:void 0,I]):p(),r==="sync"){const W=GL();O=W.__watcherHandles||(W.__watcherHandles=[])}else return vu;let A=v?new Array(e.length).fill(S1):S1;const P=()=>{if(!!ce.active)if(t){const W=ce.run();(n||y||(v?W.some((Ce,te)=>av(Ce,A[te])):av(W,A)))&&(C&&C(),Ec(t,d,3,[W,A===S1?void 0:v&&A[0]===S1?[]:A,I]),A=W)}else ce.run()};P.allowRecurse=!!t;let q;r==="sync"?q=P:r==="post"?q=()=>tl(P,d&&d.suspense):(P.pre=!0,d&&(P.id=d.uid),q=()=>V2(P));const ce=new L2(p,q);t?s?P():A=ce.run():r==="post"?tl(ce.run.bind(ce),d&&d.suspense):ce.run();const re=()=>{ce.stop(),d&&d.scope&&R2(d.scope.effects,ce)};return O&&O.push(re),re}function oL(e,t,s){const n=this.proxy,r=Ni(e)?e.includes(".")?iE(n,e):()=>n[e]:e.bind(n,n);let a;Bn(t)?a=t:(a=t.handler,s=t);const o=Ki;_g(this);const d=j2(r,a.bind(n),s);return o?_g(o):hm(),d}function iE(e,t){const s=t.split(".");return()=>{let n=e;for(let r=0;r<s.length&&n;r++)n=n[s[r]];return n}}function rm(e,t){if(!Yr(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),yi(e))rm(e.value,t);else if(dn(e))for(let s=0;s<e.length;s++)rm(e[s],t);else if(PM(e)||rg(e))e.forEach(s=>{rm(s,t)});else if(OM(e))for(const s in e)rm(e[s],t);return e}function oE(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return H2(()=>{e.isMounted=!0}),G2(()=>{e.isUnmounting=!0}),e}const xc=[Function,Array],aL={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:xc,onEnter:xc,onAfterEnter:xc,onEnterCancelled:xc,onBeforeLeave:xc,onLeave:xc,onAfterLeave:xc,onLeaveCancelled:xc,onBeforeAppear:xc,onAppear:xc,onAfterAppear:xc,onAppearCancelled:xc},setup(e,{slots:t}){const s=qv(),n=oE();let r;return()=>{const a=t.default&&q2(t.default(),!0);if(!a||!a.length)return;let o=a[0];if(a.length>1){for(const P of a)if(P.type!==kc){o=P;break}}const d=ar(e),{mode:p}=d;if(n.isLeaving)return Dw(o);const y=WI(o);if(!y)return Dw(o);const v=dv(y,d,n,s);hv(y,v);const C=s.subTree,I=C&&WI(C);let O=!1;const{getTransitionKey:A}=y.type;if(A){const P=A();r===void 0?r=P:P!==r&&(r=P,O=!0)}if(I&&I.type!==kc&&(!em(y,I)||O)){const P=dv(I,d,n,s);if(hv(I,P),p==="out-in")return n.isLeaving=!0,P.afterLeave=()=>{n.isLeaving=!1,s.update.active!==!1&&s.update()},Dw(o);p==="in-out"&&y.type!==kc&&(P.delayLeave=(q,ce,re)=>{const W=lE(n,I);W[String(I.key)]=I,q._leaveCb=()=>{ce(),q._leaveCb=void 0,delete v.delayedLeave},v.delayedLeave=re})}return o}}},aE=aL;function lE(e,t){const{leavingVNodes:s}=e;let n=s.get(t.type);return n||(n=Object.create(null),s.set(t.type,n)),n}function dv(e,t,s,n){const{appear:r,mode:a,persisted:o=!1,onBeforeEnter:d,onEnter:p,onAfterEnter:y,onEnterCancelled:v,onBeforeLeave:C,onLeave:I,onAfterLeave:O,onLeaveCancelled:A,onBeforeAppear:P,onAppear:q,onAfterAppear:ce,onAppearCancelled:re}=t,W=String(e.key),Ce=lE(s,e),te=(ee,ne)=>{ee&&Ec(ee,n,9,ne)},oe=(ee,ne)=>{const Se=ne[1];te(ee,ne),dn(ee)?ee.every(Ue=>Ue.length<=1)&&Se():ee.length<=1&&Se()},ve={mode:a,persisted:o,beforeEnter(ee){let ne=d;if(!s.isMounted)if(r)ne=P||d;else return;ee._leaveCb&&ee._leaveCb(!0);const Se=Ce[W];Se&&em(e,Se)&&Se.el._leaveCb&&Se.el._leaveCb(),te(ne,[ee])},enter(ee){let ne=p,Se=y,Ue=v;if(!s.isMounted)if(r)ne=q||p,Se=ce||y,Ue=re||v;else return;let Qe=!1;const Me=ee._enterCb=vt=>{Qe||(Qe=!0,vt?te(Ue,[ee]):te(Se,[ee]),ve.delayedLeave&&ve.delayedLeave(),ee._enterCb=void 0)};ne?oe(ne,[ee,Me]):Me()},leave(ee,ne){const Se=String(e.key);if(ee._enterCb&&ee._enterCb(!0),s.isUnmounting)return ne();te(C,[ee]);let Ue=!1;const Qe=ee._leaveCb=Me=>{Ue||(Ue=!0,ne(),Me?te(A,[ee]):te(O,[ee]),ee._leaveCb=void 0,Ce[Se]===e&&delete Ce[Se])};Ce[Se]=e,I?oe(I,[ee,Qe]):Qe()},clone(ee){return dv(ee,t,s,n)}};return ve}function Dw(e){if(Xb(e))return e=Hp(e),e.children=null,e}function WI(e){return Xb(e)?e.children?e.children[0]:void 0:e}function hv(e,t){e.shapeFlag&6&&e.component?hv(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function q2(e,t=!1,s){let n=[],r=0;for(let a=0;a<e.length;a++){let o=e[a];const d=s==null?o.key:String(s)+String(o.key!=null?o.key:a);o.type===Lt?(o.patchFlag&128&&r++,n=n.concat(q2(o.children,t,d))):(t||o.type!==kc)&&n.push(d!=null?Hp(o,{key:d}):o)}if(r>1)for(let a=0;a<n.length;a++)n[a].patchFlag=-2;return n}const Wy=e=>!!e.type.__asyncLoader,Xb=e=>e.type.__isKeepAlive;function lL(e,t){cE(e,"a",t)}function cL(e,t){cE(e,"da",t)}function cE(e,t,s=Ki){const n=e.__wdc||(e.__wdc=()=>{let r=s;for(;r;){if(r.isDeactivated)return;r=r.parent}return e()});if(Kb(t,n,s),s){let r=s.parent;for(;r&&r.parent;)Xb(r.parent.vnode)&&uL(n,t,s,r),r=r.parent}}function uL(e,t,s,n){const r=Kb(t,e,n,!0);W2(()=>{R2(n[t],r)},s)}function Kb(e,t,s=Ki,n=!1){if(s){const r=s[e]||(s[e]=[]),a=t.__weh||(t.__weh=(...o)=>{if(s.isUnmounted)return;Og(),_g(s);const d=Ec(t,s,e,o);return hm(),Lg(),d});return n?r.unshift(a):r.push(a),a}}const Ch=e=>(t,s=Ki)=>(!fv||e==="sp")&&Kb(e,(...n)=>t(...n),s),uE=Ch("bm"),H2=Ch("m"),dL=Ch("bu"),dE=Ch("u"),G2=Ch("bum"),W2=Ch("um"),hL=Ch("sp"),pL=Ch("rtg"),fL=Ch("rtc");function mL(e,t=Ki){Kb("ec",e,t)}function Mn(e,t){const s=Zo;if(s===null)return e;const n=tx(s)||s.proxy,r=e.dirs||(e.dirs=[]);for(let a=0;a<t.length;a++){let[o,d,p,y=di]=t[a];o&&(Bn(o)&&(o={mounted:o,updated:o}),o.deep&&rm(d),r.push({dir:o,instance:n,value:d,oldValue:void 0,arg:p,modifiers:y}))}return e}function qf(e,t,s,n){const r=e.dirs,a=t&&t.dirs;for(let o=0;o<r.length;o++){const d=r[o];a&&(d.oldValue=a[o].value);let p=d.dir[n];p&&(Og(),Ec(p,s,8,[e.el,d,e,t]),Lg())}}const Y2="components",_L="directives";function pe(e,t){return Z2(Y2,e,!0,t)||e}const hE=Symbol();function pE(e){return Ni(e)?Z2(Y2,e,!1)||e:e||hE}function mg(e){return Z2(_L,e)}function Z2(e,t,s=!0,n=!1){const r=Zo||Ki;if(r){const a=r.type;if(e===Y2){const d=jL(a,!1);if(d&&(d===t||d===ud(t)||d===Hb(ud(t))))return a}const o=YI(r[e]||a[e],t)||YI(r.appContext[e],t);return!o&&n?a:o}}function YI(e,t){return e&&(e[t]||e[ud(t)]||e[Hb(ud(t))])}function As(e,t,s,n){let r;const a=s&&s[n];if(dn(e)||Ni(e)){r=new Array(e.length);for(let o=0,d=e.length;o<d;o++)r[o]=t(e[o],o,void 0,a&&a[o])}else if(typeof e=="number"){r=new Array(e);for(let o=0;o<e;o++)r[o]=t(o+1,o,void 0,a&&a[o])}else if(Yr(e))if(e[Symbol.iterator])r=Array.from(e,(o,d)=>t(o,d,void 0,a&&a[d]));else{const o=Object.keys(e);r=new Array(o.length);for(let d=0,p=o.length;d<p;d++){const y=o[d];r[d]=t(e[y],y,d,a&&a[d])}}else r=[];return s&&(s[n]=r),r}function js(e,t,s={},n,r){if(Zo.isCE||Zo.parent&&Wy(Zo.parent)&&Zo.parent.isCE)return t!=="default"&&(s.name=t),de("slot",s,n&&n());let a=e[t];a&&a._c&&(a._d=!1),L();const o=a&&fE(a(s)),d=Ge(Lt,{key:s.key||o&&o.key||`_${t}`},o||(n?n():[]),o&&e._===1?64:-2);return!r&&d.scopeId&&(d.slotScopeIds=[d.scopeId+"-s"]),a&&a._c&&(a._d=!0),d}function fE(e){return e.some(t=>hb(t)?!(t.type===kc||t.type===Lt&&!fE(t.children)):!0)?e:null}function id(e,t){const s={};for(const n in e)s[t&&/[A-Z]/.test(n)?`on:${n}`:B1(n)]=e[n];return s}const xS=e=>e?IE(e)?tx(e)||e.proxy:xS(e.parent):null,Yy=Do(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>xS(e.parent),$root:e=>xS(e.root),$emit:e=>e.emit,$options:e=>X2(e),$forceUpdate:e=>e.f||(e.f=()=>V2(e.update)),$nextTick:e=>e.n||(e.n=cb.bind(e.proxy)),$watch:e=>oL.bind(e)}),Bw=(e,t)=>e!==di&&!e.__isScriptSetup&&dr(e,t),gL={get({_:e},t){const{ctx:s,setupState:n,data:r,props:a,accessCache:o,type:d,appContext:p}=e;let y;if(t[0]!=="$"){const O=o[t];if(O!==void 0)switch(O){case 1:return n[t];case 2:return r[t];case 4:return s[t];case 3:return a[t]}else{if(Bw(n,t))return o[t]=1,n[t];if(r!==di&&dr(r,t))return o[t]=2,r[t];if((y=e.propsOptions[0])&&dr(y,t))return o[t]=3,a[t];if(s!==di&&dr(s,t))return o[t]=4,s[t];wS&&(o[t]=0)}}const v=Yy[t];let C,I;if(v)return t==="$attrs"&&ul(e,"get",t),v(e);if((C=d.__cssModules)&&(C=C[t]))return C;if(s!==di&&dr(s,t))return o[t]=4,s[t];if(I=p.config.globalProperties,dr(I,t))return I[t]},set({_:e},t,s){const{data:n,setupState:r,ctx:a}=e;return Bw(r,t)?(r[t]=s,!0):n!==di&&dr(n,t)?(n[t]=s,!0):dr(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(a[t]=s,!0)},has({_:{data:e,setupState:t,accessCache:s,ctx:n,appContext:r,propsOptions:a}},o){let d;return!!s[o]||e!==di&&dr(e,o)||Bw(t,o)||(d=a[0])&&dr(d,o)||dr(n,o)||dr(Yy,o)||dr(r.config.globalProperties,o)},defineProperty(e,t,s){return s.get!=null?e._.accessCache[t]=0:dr(s,"value")&&this.set(e,t,s.value,null),Reflect.defineProperty(e,t,s)}};let wS=!0;function yL(e){const t=X2(e),s=e.proxy,n=e.ctx;wS=!1,t.beforeCreate&&ZI(t.beforeCreate,e,"bc");const{data:r,computed:a,methods:o,watch:d,provide:p,inject:y,created:v,beforeMount:C,mounted:I,beforeUpdate:O,updated:A,activated:P,deactivated:q,beforeDestroy:ce,beforeUnmount:re,destroyed:W,unmounted:Ce,render:te,renderTracked:oe,renderTriggered:ve,errorCaptured:ee,serverPrefetch:ne,expose:Se,inheritAttrs:Ue,components:Qe,directives:Me,filters:vt}=t;if(y&&vL(y,n,null,e.appContext.config.unwrapInjectedRef),o)for(const _t in o){const F=o[_t];Bn(F)&&(n[_t]=F.bind(s))}if(r){const _t=r.call(s,s);Yr(_t)&&(e.data=Em(_t))}if(wS=!0,a)for(const _t in a){const F=a[_t],j=Bn(F)?F.bind(s,s):Bn(F.get)?F.get.bind(s,s):vu,G=!Bn(F)&&Bn(F.set)?F.set.bind(s):vu,Y=ri({get:j,set:G});Object.defineProperty(n,_t,{enumerable:!0,configurable:!0,get:()=>Y.value,set:J=>Y.value=J})}if(d)for(const _t in d)mE(d[_t],n,s,_t);if(p){const _t=Bn(p)?p.call(s):p;Reflect.ownKeys(_t).forEach(F=>{bS(F,_t[F])})}v&&ZI(v,e,"c");function Rt(_t,F){dn(F)?F.forEach(j=>_t(j.bind(s))):F&&_t(F.bind(s))}if(Rt(uE,C),Rt(H2,I),Rt(dL,O),Rt(dE,A),Rt(lL,P),Rt(cL,q),Rt(mL,ee),Rt(fL,oe),Rt(pL,ve),Rt(G2,re),Rt(W2,Ce),Rt(hL,ne),dn(Se))if(Se.length){const _t=e.exposed||(e.exposed={});Se.forEach(F=>{Object.defineProperty(_t,F,{get:()=>s[F],set:j=>s[F]=j})})}else e.exposed||(e.exposed={});te&&e.render===vu&&(e.render=te),Ue!=null&&(e.inheritAttrs=Ue),Qe&&(e.components=Qe),Me&&(e.directives=Me)}function vL(e,t,s=vu,n=!1){dn(e)&&(e=SS(e));for(const r in e){const a=e[r];let o;Yr(a)?"default"in a?o=dm(a.from||r,a.default,!0):o=dm(a.from||r):o=dm(a),yi(o)&&n?Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:()=>o.value,set:d=>o.value=d}):t[r]=o}}function ZI(e,t,s){Ec(dn(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,s)}function mE(e,t,s,n){const r=n.includes(".")?iE(s,n):()=>s[n];if(Ni(e)){const a=t[e];Bn(a)&&ph(r,a)}else if(Bn(e))ph(r,e.bind(s));else if(Yr(e))if(dn(e))e.forEach(a=>mE(a,t,s,n));else{const a=Bn(e.handler)?e.handler.bind(s):t[e.handler];Bn(a)&&ph(r,a,e)}}function X2(e){const t=e.type,{mixins:s,extends:n}=t,{mixins:r,optionsCache:a,config:{optionMergeStrategies:o}}=e.appContext,d=a.get(t);let p;return d?p=d:!r.length&&!s&&!n?p=t:(p={},r.length&&r.forEach(y=>db(p,y,o,!0)),db(p,t,o)),Yr(t)&&a.set(t,p),p}function db(e,t,s,n=!1){const{mixins:r,extends:a}=t;a&&db(e,a,s,!0),r&&r.forEach(o=>db(e,o,s,!0));for(const o in t)if(!(n&&o==="expose")){const d=bL[o]||s&&s[o];e[o]=d?d(e[o],t[o]):t[o]}return e}const bL={data:XI,props:Xf,emits:Xf,methods:Xf,computed:Xf,beforeCreate:Ba,created:Ba,beforeMount:Ba,mounted:Ba,beforeUpdate:Ba,updated:Ba,beforeDestroy:Ba,beforeUnmount:Ba,destroyed:Ba,unmounted:Ba,activated:Ba,deactivated:Ba,errorCaptured:Ba,serverPrefetch:Ba,components:Xf,directives:Xf,watch:wL,provide:XI,inject:xL};function XI(e,t){return t?e?function(){return Do(Bn(e)?e.call(this,this):e,Bn(t)?t.call(this,this):t)}:t:e}function xL(e,t){return Xf(SS(e),SS(t))}function SS(e){if(dn(e)){const t={};for(let s=0;s<e.length;s++)t[e[s]]=e[s];return t}return e}function Ba(e,t){return e?[...new Set([].concat(e,t))]:t}function Xf(e,t){return e?Do(Do(Object.create(null),e),t):t}function wL(e,t){if(!e)return t;if(!t)return e;const s=Do(Object.create(null),e);for(const n in t)s[n]=Ba(e[n],t[n]);return s}function SL(e,t,s,n=!1){const r={},a={};ob(a,Qb,1),e.propsDefaults=Object.create(null),_E(e,t,r,a);for(const o in e.propsOptions[0])o in r||(r[o]=void 0);s?e.props=n?r:BO(r):e.type.props?e.props=r:e.props=a,e.attrs=a}function CL(e,t,s,n){const{props:r,attrs:a,vnode:{patchFlag:o}}=e,d=ar(r),[p]=e.propsOptions;let y=!1;if((n||o>0)&&!(o&16)){if(o&8){const v=e.vnode.dynamicProps;for(let C=0;C<v.length;C++){let I=v[C];if(Yb(e.emitsOptions,I))continue;const O=t[I];if(p)if(dr(a,I))O!==a[I]&&(a[I]=O,y=!0);else{const A=ud(I);r[A]=CS(p,d,A,O,e,!1)}else O!==a[I]&&(a[I]=O,y=!0)}}}else{_E(e,t,r,a)&&(y=!0);let v;for(const C in d)(!t||!dr(t,C)&&((v=Mm(C))===C||!dr(t,v)))&&(p?s&&(s[C]!==void 0||s[v]!==void 0)&&(r[C]=CS(p,d,C,void 0,e,!0)):delete r[C]);if(a!==d)for(const C in a)(!t||!dr(t,C)&&!0)&&(delete a[C],y=!0)}y&&gh(e,"set","$attrs")}function _E(e,t,s,n){const[r,a]=e.propsOptions;let o=!1,d;if(t)for(let p in t){if(D1(p))continue;const y=t[p];let v;r&&dr(r,v=ud(p))?!a||!a.includes(v)?s[v]=y:(d||(d={}))[v]=y:Yb(e.emitsOptions,p)||(!(p in n)||y!==n[p])&&(n[p]=y,o=!0)}if(a){const p=ar(s),y=d||di;for(let v=0;v<a.length;v++){const C=a[v];s[C]=CS(r,p,C,y[C],e,!dr(y,C))}}return o}function CS(e,t,s,n,r,a){const o=e[s];if(o!=null){const d=dr(o,"default");if(d&&n===void 0){const p=o.default;if(o.type!==Function&&Bn(p)){const{propsDefaults:y}=r;s in y?n=y[s]:(_g(r),n=y[s]=p.call(null,t),hm())}else n=p}o[0]&&(a&&!d?n=!1:o[1]&&(n===""||n===Mm(s))&&(n=!0))}return n}function gE(e,t,s=!1){const n=t.propsCache,r=n.get(e);if(r)return r;const a=e.props,o={},d=[];let p=!1;if(!Bn(e)){const v=C=>{p=!0;const[I,O]=gE(C,t,!0);Do(o,I),O&&d.push(...O)};!s&&t.mixins.length&&t.mixins.forEach(v),e.extends&&v(e.extends),e.mixins&&e.mixins.forEach(v)}if(!a&&!p)return Yr(e)&&n.set(e,ng),ng;if(dn(a))for(let v=0;v<a.length;v++){const C=ud(a[v]);KI(C)&&(o[C]=di)}else if(a)for(const v in a){const C=ud(v);if(KI(C)){const I=a[v],O=o[C]=dn(I)||Bn(I)?{type:I}:Object.assign({},I);if(O){const A=eT(Boolean,O.type),P=eT(String,O.type);O[0]=A>-1,O[1]=P<0||A<P,(A>-1||dr(O,"default"))&&d.push(C)}}}const y=[o,d];return Yr(e)&&n.set(e,y),y}function KI(e){return e[0]!=="$"}function JI(e){const t=e&&e.toString().match(/^\s*(function|class) (\w+)/);return t?t[2]:e===null?"null":""}function QI(e,t){return JI(e)===JI(t)}function eT(e,t){return dn(t)?t.findIndex(s=>QI(s,e)):Bn(t)&&QI(t,e)?0:-1}const yE=e=>e[0]==="_"||e==="$stable",K2=e=>dn(e)?e.map(Xu):[Xu(e)],IL=(e,t,s)=>{if(t._n)return t;const n=je((...r)=>K2(t(...r)),s);return n._c=!1,n},vE=(e,t,s)=>{const n=e._ctx;for(const r in e){if(yE(r))continue;const a=e[r];if(Bn(a))t[r]=IL(r,a,n);else if(a!=null){const o=K2(a);t[r]=()=>o}}},bE=(e,t)=>{const s=K2(t);e.slots.default=()=>s},TL=(e,t)=>{if(e.vnode.shapeFlag&32){const s=t._;s?(e.slots=ar(t),ob(t,"_",s)):vE(t,e.slots={})}else e.slots={},t&&bE(e,t);ob(e.slots,Qb,1)},AL=(e,t,s)=>{const{vnode:n,slots:r}=e;let a=!0,o=di;if(n.shapeFlag&32){const d=t._;d?s&&d===1?a=!1:(Do(r,t),!s&&d===1&&delete r._):(a=!t.$stable,vE(t,r)),o=t}else t&&(bE(e,t),o={default:1});if(a)for(const d in r)!yE(d)&&!(d in o)&&delete r[d]};function xE(){return{app:null,config:{isNativeTag:tO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let ML=0;function EL(e,t){return function(n,r=null){Bn(n)||(n=Object.assign({},n)),r!=null&&!Yr(r)&&(r=null);const a=xE(),o=new Set;let d=!1;const p=a.app={_uid:ML++,_component:n,_props:r,_container:null,_context:a,_instance:null,version:WL,get config(){return a.config},set config(y){},use(y,...v){return o.has(y)||(y&&Bn(y.install)?(o.add(y),y.install(p,...v)):Bn(y)&&(o.add(y),y(p,...v))),p},mixin(y){return a.mixins.includes(y)||a.mixins.push(y),p},component(y,v){return v?(a.components[y]=v,p):a.components[y]},directive(y,v){return v?(a.directives[y]=v,p):a.directives[y]},mount(y,v,C){if(!d){const I=de(n,r);return I.appContext=a,v&&t?t(I,y):e(I,y,C),d=!0,p._container=y,y.__vue_app__=p,tx(I.component)||I.component.proxy}},unmount(){d&&(e(null,p._container),delete p._container.__vue_app__)},provide(y,v){return a.provides[y]=v,p}};return p}}function IS(e,t,s,n,r=!1){if(dn(e)){e.forEach((I,O)=>IS(I,t&&(dn(t)?t[O]:t),s,n,r));return}if(Wy(n)&&!r)return;const a=n.shapeFlag&4?tx(n.component)||n.component.proxy:n.el,o=r?null:a,{i:d,r:p}=e,y=t&&t.r,v=d.refs===di?d.refs={}:d.refs,C=d.setupState;if(y!=null&&y!==p&&(Ni(y)?(v[y]=null,dr(C,y)&&(C[y]=null)):yi(y)&&(y.value=null)),Bn(p))Bp(p,d,12,[o,v]);else{const I=Ni(p),O=yi(p);if(I||O){const A=()=>{if(e.f){const P=I?dr(C,p)?C[p]:v[p]:p.value;r?dn(P)&&R2(P,a):dn(P)?P.includes(a)||P.push(a):I?(v[p]=[a],dr(C,p)&&(C[p]=v[p])):(p.value=[a],e.k&&(v[e.k]=p.value))}else I?(v[p]=o,dr(C,p)&&(C[p]=o)):O&&(p.value=o,e.k&&(v[e.k]=o))};o?(A.id=-1,tl(A,s)):A()}}}const tl=rL;function kL(e){return PL(e)}function PL(e,t){const s=lO();s.__VUE__=!0;const{insert:n,remove:r,patchProp:a,createElement:o,createText:d,createComment:p,setText:y,setElementText:v,parentNode:C,nextSibling:I,setScopeId:O=vu,insertStaticContent:A}=e,P=(fe,ye,Je,at=null,it=null,Et=null,jt=!1,Nt=null,St=!!ye.dynamicChildren)=>{if(fe===ye)return;fe&&!em(fe,ye)&&(at=qe(fe),J(fe,it,Et,!0),fe=null),ye.patchFlag===-2&&(St=!1,ye.dynamicChildren=null);const{type:Ct,ref:Bt,shapeFlag:Kt}=ye;switch(Ct){case Jb:q(fe,ye,Je,at);break;case kc:ce(fe,ye,Je,at);break;case Zy:fe==null&&re(ye,Je,at,jt);break;case Lt:Qe(fe,ye,Je,at,it,Et,jt,Nt,St);break;default:Kt&1?te(fe,ye,Je,at,it,Et,jt,Nt,St):Kt&6?Me(fe,ye,Je,at,it,Et,jt,Nt,St):(Kt&64||Kt&128)&&Ct.process(fe,ye,Je,at,it,Et,jt,Nt,St,We)}Bt!=null&&it&&IS(Bt,fe&&fe.ref,Et,ye||fe,!ye)},q=(fe,ye,Je,at)=>{if(fe==null)n(ye.el=d(ye.children),Je,at);else{const it=ye.el=fe.el;ye.children!==fe.children&&y(it,ye.children)}},ce=(fe,ye,Je,at)=>{fe==null?n(ye.el=p(ye.children||""),Je,at):ye.el=fe.el},re=(fe,ye,Je,at)=>{[fe.el,fe.anchor]=A(fe.children,ye,Je,at,fe.el,fe.anchor)},W=({el:fe,anchor:ye},Je,at)=>{let it;for(;fe&&fe!==ye;)it=I(fe),n(fe,Je,at),fe=it;n(ye,Je,at)},Ce=({el:fe,anchor:ye})=>{let Je;for(;fe&&fe!==ye;)Je=I(fe),r(fe),fe=Je;r(ye)},te=(fe,ye,Je,at,it,Et,jt,Nt,St)=>{jt=jt||ye.type==="svg",fe==null?oe(ye,Je,at,it,Et,jt,Nt,St):ne(fe,ye,it,Et,jt,Nt,St)},oe=(fe,ye,Je,at,it,Et,jt,Nt)=>{let St,Ct;const{type:Bt,props:Kt,shapeFlag:ys,transition:ts,dirs:Us}=fe;if(St=fe.el=o(fe.type,Et,Kt&&Kt.is,Kt),ys&8?v(St,fe.children):ys&16&&ee(fe.children,St,null,at,it,Et&&Bt!=="foreignObject",jt,Nt),Us&&qf(fe,null,at,"created"),ve(St,fe,fe.scopeId,jt,at),Kt){for(const B in Kt)B!=="value"&&!D1(B)&&a(St,B,null,Kt[B],Et,fe.children,at,it,ke);"value"in Kt&&a(St,"value",null,Kt.value),(Ct=Kt.onVnodeBeforeMount)&&Wu(Ct,at,fe)}Us&&qf(fe,null,at,"beforeMount");const ue=(!it||it&&!it.pendingBranch)&&ts&&!ts.persisted;ue&&ts.beforeEnter(St),n(St,ye,Je),((Ct=Kt&&Kt.onVnodeMounted)||ue||Us)&&tl(()=>{Ct&&Wu(Ct,at,fe),ue&&ts.enter(St),Us&&qf(fe,null,at,"mounted")},it)},ve=(fe,ye,Je,at,it)=>{if(Je&&O(fe,Je),at)for(let Et=0;Et<at.length;Et++)O(fe,at[Et]);if(it){let Et=it.subTree;if(ye===Et){const jt=it.vnode;ve(fe,jt,jt.scopeId,jt.slotScopeIds,it.parent)}}},ee=(fe,ye,Je,at,it,Et,jt,Nt,St=0)=>{for(let Ct=St;Ct<fe.length;Ct++){const Bt=fe[Ct]=Nt?Ip(fe[Ct]):Xu(fe[Ct]);P(null,Bt,ye,Je,at,it,Et,jt,Nt)}},ne=(fe,ye,Je,at,it,Et,jt)=>{const Nt=ye.el=fe.el;let{patchFlag:St,dynamicChildren:Ct,dirs:Bt}=ye;St|=fe.patchFlag&16;const Kt=fe.props||di,ys=ye.props||di;let ts;Je&&Hf(Je,!1),(ts=ys.onVnodeBeforeUpdate)&&Wu(ts,Je,ye,fe),Bt&&qf(ye,fe,Je,"beforeUpdate"),Je&&Hf(Je,!0);const Us=it&&ye.type!=="foreignObject";if(Ct?Se(fe.dynamicChildren,Ct,Nt,Je,at,Us,Et):jt||F(fe,ye,Nt,null,Je,at,Us,Et,!1),St>0){if(St&16)Ue(Nt,ye,Kt,ys,Je,at,it);else if(St&2&&Kt.class!==ys.class&&a(Nt,"class",null,ys.class,it),St&4&&a(Nt,"style",Kt.style,ys.style,it),St&8){const ue=ye.dynamicProps;for(let B=0;B<ue.length;B++){const U=ue[B],Re=Kt[U],nt=ys[U];(nt!==Re||U==="value")&&a(Nt,U,Re,nt,it,fe.children,Je,at,ke)}}St&1&&fe.children!==ye.children&&v(Nt,ye.children)}else!jt&&Ct==null&&Ue(Nt,ye,Kt,ys,Je,at,it);((ts=ys.onVnodeUpdated)||Bt)&&tl(()=>{ts&&Wu(ts,Je,ye,fe),Bt&&qf(ye,fe,Je,"updated")},at)},Se=(fe,ye,Je,at,it,Et,jt)=>{for(let Nt=0;Nt<ye.length;Nt++){const St=fe[Nt],Ct=ye[Nt],Bt=St.el&&(St.type===Lt||!em(St,Ct)||St.shapeFlag&70)?C(St.el):Je;P(St,Ct,Bt,null,at,it,Et,jt,!0)}},Ue=(fe,ye,Je,at,it,Et,jt)=>{if(Je!==at){if(Je!==di)for(const Nt in Je)!D1(Nt)&&!(Nt in at)&&a(fe,Nt,Je[Nt],null,jt,ye.children,it,Et,ke);for(const Nt in at){if(D1(Nt))continue;const St=at[Nt],Ct=Je[Nt];St!==Ct&&Nt!=="value"&&a(fe,Nt,Ct,St,jt,ye.children,it,Et,ke)}"value"in at&&a(fe,"value",Je.value,at.value)}},Qe=(fe,ye,Je,at,it,Et,jt,Nt,St)=>{const Ct=ye.el=fe?fe.el:d(""),Bt=ye.anchor=fe?fe.anchor:d("");let{patchFlag:Kt,dynamicChildren:ys,slotScopeIds:ts}=ye;ts&&(Nt=Nt?Nt.concat(ts):ts),fe==null?(n(Ct,Je,at),n(Bt,Je,at),ee(ye.children,Je,Bt,it,Et,jt,Nt,St)):Kt>0&&Kt&64&&ys&&fe.dynamicChildren?(Se(fe.dynamicChildren,ys,Je,it,Et,jt,Nt),(ye.key!=null||it&&ye===it.subTree)&&wE(fe,ye,!0)):F(fe,ye,Je,Bt,it,Et,jt,Nt,St)},Me=(fe,ye,Je,at,it,Et,jt,Nt,St)=>{ye.slotScopeIds=Nt,fe==null?ye.shapeFlag&512?it.ctx.activate(ye,Je,at,jt,St):vt(ye,Je,at,it,Et,jt,St):Ut(fe,ye,St)},vt=(fe,ye,Je,at,it,Et,jt)=>{const Nt=fe.component=BL(fe,at,it);if(Xb(fe)&&(Nt.ctx.renderer=We),FL(Nt),Nt.asyncDep){if(it&&it.registerDep(Nt,Rt),!fe.el){const St=Nt.subTree=de(kc);ce(null,St,ye,Je)}return}Rt(Nt,fe,ye,Je,it,Et,jt)},Ut=(fe,ye,Je)=>{const at=ye.component=fe.component;if(tL(fe,ye,Je))if(at.asyncDep&&!at.asyncResolved){_t(at,ye,Je);return}else at.next=ye,ZO(at.update),at.update();else ye.el=fe.el,at.vnode=ye},Rt=(fe,ye,Je,at,it,Et,jt)=>{const Nt=()=>{if(fe.isMounted){let{next:Bt,bu:Kt,u:ys,parent:ts,vnode:Us}=fe,ue=Bt,B;Hf(fe,!1),Bt?(Bt.el=Us.el,_t(fe,Bt,jt)):Bt=Us,Kt&&F1(Kt),(B=Bt.props&&Bt.props.onVnodeBeforeUpdate)&&Wu(B,ts,Bt,Us),Hf(fe,!0);const U=Nw(fe),Re=fe.subTree;fe.subTree=U,P(Re,U,C(Re.el),qe(Re),fe,it,Et),Bt.el=U.el,ue===null&&sL(fe,U.el),ys&&tl(ys,it),(B=Bt.props&&Bt.props.onVnodeUpdated)&&tl(()=>Wu(B,ts,Bt,Us),it)}else{let Bt;const{el:Kt,props:ys}=ye,{bm:ts,m:Us,parent:ue}=fe,B=Wy(ye);if(Hf(fe,!1),ts&&F1(ts),!B&&(Bt=ys&&ys.onVnodeBeforeMount)&&Wu(Bt,ue,ye),Hf(fe,!0),Kt&&rt){const U=()=>{fe.subTree=Nw(fe),rt(Kt,fe.subTree,fe,it,null)};B?ye.type.__asyncLoader().then(()=>!fe.isUnmounted&&U()):U()}else{const U=fe.subTree=Nw(fe);P(null,U,Je,at,fe,it,Et),ye.el=U.el}if(Us&&tl(Us,it),!B&&(Bt=ys&&ys.onVnodeMounted)){const U=ye;tl(()=>Wu(Bt,ue,U),it)}(ye.shapeFlag&256||ue&&Wy(ue.vnode)&&ue.vnode.shapeFlag&256)&&fe.a&&tl(fe.a,it),fe.isMounted=!0,ye=Je=at=null}},St=fe.effect=new L2(Nt,()=>V2(Ct),fe.scope),Ct=fe.update=()=>St.run();Ct.id=fe.uid,Hf(fe,!0),Ct()},_t=(fe,ye,Je)=>{ye.component=fe;const at=fe.vnode.props;fe.vnode=ye,fe.next=null,CL(fe,ye.props,at,Je),AL(fe,ye.children,Je),Og(),HI(),Lg()},F=(fe,ye,Je,at,it,Et,jt,Nt,St=!1)=>{const Ct=fe&&fe.children,Bt=fe?fe.shapeFlag:0,Kt=ye.children,{patchFlag:ys,shapeFlag:ts}=ye;if(ys>0){if(ys&128){G(Ct,Kt,Je,at,it,Et,jt,Nt,St);return}else if(ys&256){j(Ct,Kt,Je,at,it,Et,jt,Nt,St);return}}ts&8?(Bt&16&&ke(Ct,it,Et),Kt!==Ct&&v(Je,Kt)):Bt&16?ts&16?G(Ct,Kt,Je,at,it,Et,jt,Nt,St):ke(Ct,it,Et,!0):(Bt&8&&v(Je,""),ts&16&&ee(Kt,Je,at,it,Et,jt,Nt,St))},j=(fe,ye,Je,at,it,Et,jt,Nt,St)=>{fe=fe||ng,ye=ye||ng;const Ct=fe.length,Bt=ye.length,Kt=Math.min(Ct,Bt);let ys;for(ys=0;ys<Kt;ys++){const ts=ye[ys]=St?Ip(ye[ys]):Xu(ye[ys]);P(fe[ys],ts,Je,null,it,Et,jt,Nt,St)}Ct>Bt?ke(fe,it,Et,!0,!1,Kt):ee(ye,Je,at,it,Et,jt,Nt,St,Kt)},G=(fe,ye,Je,at,it,Et,jt,Nt,St)=>{let Ct=0;const Bt=ye.length;let Kt=fe.length-1,ys=Bt-1;for(;Ct<=Kt&&Ct<=ys;){const ts=fe[Ct],Us=ye[Ct]=St?Ip(ye[Ct]):Xu(ye[Ct]);if(em(ts,Us))P(ts,Us,Je,null,it,Et,jt,Nt,St);else break;Ct++}for(;Ct<=Kt&&Ct<=ys;){const ts=fe[Kt],Us=ye[ys]=St?Ip(ye[ys]):Xu(ye[ys]);if(em(ts,Us))P(ts,Us,Je,null,it,Et,jt,Nt,St);else break;Kt--,ys--}if(Ct>Kt){if(Ct<=ys){const ts=ys+1,Us=ts<Bt?ye[ts].el:at;for(;Ct<=ys;)P(null,ye[Ct]=St?Ip(ye[Ct]):Xu(ye[Ct]),Je,Us,it,Et,jt,Nt,St),Ct++}}else if(Ct>ys)for(;Ct<=Kt;)J(fe[Ct],it,Et,!0),Ct++;else{const ts=Ct,Us=Ct,ue=new Map;for(Ct=Us;Ct<=ys;Ct++){const tn=ye[Ct]=St?Ip(ye[Ct]):Xu(ye[Ct]);tn.key!=null&&ue.set(tn.key,Ct)}let B,U=0;const Re=ys-Us+1;let nt=!1,gt=0;const kt=new Array(Re);for(Ct=0;Ct<Re;Ct++)kt[Ct]=0;for(Ct=ts;Ct<=Kt;Ct++){const tn=fe[Ct];if(U>=Re){J(tn,it,Et,!0);continue}let nn;if(tn.key!=null)nn=ue.get(tn.key);else for(B=Us;B<=ys;B++)if(kt[B-Us]===0&&em(tn,ye[B])){nn=B;break}nn===void 0?J(tn,it,Et,!0):(kt[nn-Us]=Ct+1,nn>=gt?gt=nn:nt=!0,P(tn,ye[nn],Je,null,it,Et,jt,Nt,St),U++)}const Ds=nt?RL(kt):ng;for(B=Ds.length-1,Ct=Re-1;Ct>=0;Ct--){const tn=Us+Ct,nn=ye[tn],qn=tn+1<Bt?ye[tn+1].el:at;kt[Ct]===0?P(null,nn,Je,qn,it,Et,jt,Nt,St):nt&&(B<0||Ct!==Ds[B]?Y(nn,Je,qn,2):B--)}}},Y=(fe,ye,Je,at,it=null)=>{const{el:Et,type:jt,transition:Nt,children:St,shapeFlag:Ct}=fe;if(Ct&6){Y(fe.component.subTree,ye,Je,at);return}if(Ct&128){fe.suspense.move(ye,Je,at);return}if(Ct&64){jt.move(fe,ye,Je,We);return}if(jt===Lt){n(Et,ye,Je);for(let Kt=0;Kt<St.length;Kt++)Y(St[Kt],ye,Je,at);n(fe.anchor,ye,Je);return}if(jt===Zy){W(fe,ye,Je);return}if(at!==2&&Ct&1&&Nt)if(at===0)Nt.beforeEnter(Et),n(Et,ye,Je),tl(()=>Nt.enter(Et),it);else{const{leave:Kt,delayLeave:ys,afterLeave:ts}=Nt,Us=()=>n(Et,ye,Je),ue=()=>{Kt(Et,()=>{Us(),ts&&ts()})};ys?ys(Et,Us,ue):ue()}else n(Et,ye,Je)},J=(fe,ye,Je,at=!1,it=!1)=>{const{type:Et,props:jt,ref:Nt,children:St,dynamicChildren:Ct,shapeFlag:Bt,patchFlag:Kt,dirs:ys}=fe;if(Nt!=null&&IS(Nt,null,Je,fe,!0),Bt&256){ye.ctx.deactivate(fe);return}const ts=Bt&1&&ys,Us=!Wy(fe);let ue;if(Us&&(ue=jt&&jt.onVnodeBeforeUnmount)&&Wu(ue,ye,fe),Bt&6)Ne(fe.component,Je,at);else{if(Bt&128){fe.suspense.unmount(Je,at);return}ts&&qf(fe,null,ye,"beforeUnmount"),Bt&64?fe.type.remove(fe,ye,Je,it,We,at):Ct&&(Et!==Lt||Kt>0&&Kt&64)?ke(Ct,ye,Je,!1,!0):(Et===Lt&&Kt&384||!it&&Bt&16)&&ke(St,ye,Je),at&&he(fe)}(Us&&(ue=jt&&jt.onVnodeUnmounted)||ts)&&tl(()=>{ue&&Wu(ue,ye,fe),ts&&qf(fe,null,ye,"unmounted")},Je)},he=fe=>{const{type:ye,el:Je,anchor:at,transition:it}=fe;if(ye===Lt){be(Je,at);return}if(ye===Zy){Ce(fe);return}const Et=()=>{r(Je),it&&!it.persisted&&it.afterLeave&&it.afterLeave()};if(fe.shapeFlag&1&&it&&!it.persisted){const{leave:jt,delayLeave:Nt}=it,St=()=>jt(Je,Et);Nt?Nt(fe.el,Et,St):St()}else Et()},be=(fe,ye)=>{let Je;for(;fe!==ye;)Je=I(fe),r(fe),fe=Je;r(ye)},Ne=(fe,ye,Je)=>{const{bum:at,scope:it,update:Et,subTree:jt,um:Nt}=fe;at&&F1(at),it.stop(),Et&&(Et.active=!1,J(jt,fe,ye,Je)),Nt&&tl(Nt,ye),tl(()=>{fe.isUnmounted=!0},ye),ye&&ye.pendingBranch&&!ye.isUnmounted&&fe.asyncDep&&!fe.asyncResolved&&fe.suspenseId===ye.pendingId&&(ye.deps--,ye.deps===0&&ye.resolve())},ke=(fe,ye,Je,at=!1,it=!1,Et=0)=>{for(let jt=Et;jt<fe.length;jt++)J(fe[jt],ye,Je,at,it)},qe=fe=>fe.shapeFlag&6?qe(fe.component.subTree):fe.shapeFlag&128?fe.suspense.next():I(fe.anchor||fe.el),ct=(fe,ye,Je)=>{fe==null?ye._vnode&&J(ye._vnode,null,null,!0):P(ye._vnode||null,fe,ye,null,null,null,Je),HI(),sE(),ye._vnode=fe},We={p:P,um:J,m:Y,r:he,mt:vt,mc:ee,pc:F,pbc:Se,n:qe,o:e};let ht,rt;return t&&([ht,rt]=t(We)),{render:ct,hydrate:ht,createApp:EL(ct,ht)}}function Hf({effect:e,update:t},s){e.allowRecurse=t.allowRecurse=s}function wE(e,t,s=!1){const n=e.children,r=t.children;if(dn(n)&&dn(r))for(let a=0;a<n.length;a++){const o=n[a];let d=r[a];d.shapeFlag&1&&!d.dynamicChildren&&((d.patchFlag<=0||d.patchFlag===32)&&(d=r[a]=Ip(r[a]),d.el=o.el),s||wE(o,d)),d.type===Jb&&(d.el=o.el)}}function RL(e){const t=e.slice(),s=[0];let n,r,a,o,d;const p=e.length;for(n=0;n<p;n++){const y=e[n];if(y!==0){if(r=s[s.length-1],e[r]<y){t[n]=r,s.push(n);continue}for(a=0,o=s.length-1;a<o;)d=a+o>>1,e[s[d]]<y?a=d+1:o=d;y<e[s[a]]&&(a>0&&(t[n]=s[a-1]),s[a]=n)}}for(a=s.length,o=s[a-1];a-- >0;)s[a]=o,o=t[o];return s}const $L=e=>e.__isTeleport,Lt=Symbol(void 0),Jb=Symbol(void 0),kc=Symbol(void 0),Zy=Symbol(void 0),Xy=[];let _u=null;function L(e=!1){Xy.push(_u=e?null:[])}function OL(){Xy.pop(),_u=Xy[Xy.length-1]||null}let pv=1;function tT(e){pv+=e}function SE(e){return e.dynamicChildren=pv>0?_u||ng:null,OL(),pv>0&&_u&&_u.push(e),e}function X(e,t,s,n,r,a){return SE(k(e,t,s,n,r,a,!0))}function Ge(e,t,s,n,r){return SE(de(e,t,s,n,r,!0))}function hb(e){return e?e.__v_isVNode===!0:!1}function em(e,t){return e.type===t.type&&e.key===t.key}const Qb="__vInternal",CE=({key:e})=>e!=null?e:null,z1=({ref:e,ref_key:t,ref_for:s})=>e!=null?Ni(e)||yi(e)||Bn(e)?{i:Zo,r:e,k:t,f:!!s}:e:null;function k(e,t=null,s=null,n=0,r=null,a=e===Lt?0:1,o=!1,d=!1){const p={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&CE(t),ref:t&&z1(t),scopeId:Zb,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:n,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:Zo};return d?(J2(p,s),a&128&&e.normalize(p)):s&&(p.shapeFlag|=Ni(s)?8:16),pv>0&&!o&&_u&&(p.patchFlag>0||a&6)&&p.patchFlag!==32&&_u.push(p),p}const de=LL;function LL(e,t=null,s=null,n=0,r=null,a=!1){if((!e||e===hE)&&(e=kc),hb(e)){const d=Hp(e,t,!0);return s&&J2(d,s),pv>0&&!a&&_u&&(d.shapeFlag&6?_u[_u.indexOf(e)]=d:_u.push(d)),d.patchFlag|=-2,d}if(qL(e)&&(e=e.__vccOpts),t){t=im(t);let{class:d,style:p}=t;d&&!Ni(d)&&(t.class=$t(d)),Yr(p)&&(ZM(p)&&!dn(p)&&(p=Do({},p)),t.style=br(p))}const o=Ni(e)?1:nL(e)?128:$L(e)?64:Yr(e)?4:Bn(e)?2:0;return k(e,t,s,n,r,o,a,!0)}function im(e){return e?ZM(e)||Qb in e?Do({},e):e:null}function Hp(e,t,s=!1){const{props:n,ref:r,patchFlag:a,children:o}=e,d=t?Ji(n||{},t):n;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:d,key:d&&CE(d),ref:t&&t.ref?s&&r?dn(r)?r.concat(z1(t)):[r,z1(t)]:z1(t):r,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Lt?a===-1?16:a|16:a,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Hp(e.ssContent),ssFallback:e.ssFallback&&Hp(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce}}function es(e=" ",t=0){return de(Jb,null,e,t)}function ex(e,t){const s=de(Zy,null,e);return s.staticCount=t,s}function $e(e="",t=!1){return t?(L(),Ge(kc,null,e)):de(kc,null,e)}function Xu(e){return e==null||typeof e=="boolean"?de(kc):dn(e)?de(Lt,null,e.slice()):typeof e=="object"?Ip(e):de(Jb,null,String(e))}function Ip(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Hp(e)}function J2(e,t){let s=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(dn(t))s=16;else if(typeof t=="object")if(n&65){const r=t.default;r&&(r._c&&(r._d=!1),J2(e,r()),r._c&&(r._d=!0));return}else{s=32;const r=t._;!r&&!(Qb in t)?t._ctx=Zo:r===3&&Zo&&(Zo.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else Bn(t)?(t={default:t,_ctx:Zo},s=32):(t=String(t),n&64?(s=16,t=[es(t)]):s=8);e.children=t,e.shapeFlag|=s}function Ji(...e){const t={};for(let s=0;s<e.length;s++){const n=e[s];for(const r in n)if(r==="class")t.class!==n.class&&(t.class=$t([t.class,n.class]));else if(r==="style")t.style=br([t.style,n.style]);else if(jb(r)){const a=t[r],o=n[r];o&&a!==o&&!(dn(a)&&a.includes(o))&&(t[r]=a?[].concat(a,o):o)}else r!==""&&(t[r]=n[r])}return t}function Wu(e,t,s,n=null){Ec(e,t,7,[s,n])}const NL=xE();let DL=0;function BL(e,t,s){const n=e.type,r=(t?t.appContext:e.appContext)||NL,a={uid:DL++,vnode:e,type:n,parent:t,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new LM(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:gE(n,r),emitsOptions:rE(n,r),emit:null,emitted:null,propsDefaults:di,inheritAttrs:n.inheritAttrs,ctx:di,data:di,props:di,attrs:di,slots:di,refs:di,setupState:di,setupContext:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=JO.bind(null,a),e.ce&&e.ce(a),a}let Ki=null;const qv=()=>Ki||Zo,_g=e=>{Ki=e,e.scope.on()},hm=()=>{Ki&&Ki.scope.off(),Ki=null};function IE(e){return e.vnode.shapeFlag&4}let fv=!1;function FL(e,t=!1){fv=t;const{props:s,children:n}=e.vnode,r=IE(e);SL(e,s,r,t),TL(e,n);const a=r?zL(e,t):void 0;return fv=!1,a}function zL(e,t){const s=e.type;e.accessCache=Object.create(null),e.proxy=fg(new Proxy(e.ctx,gL));const{setup:n}=s;if(n){const r=e.setupContext=n.length>1?VL(e):null;_g(e),Og();const a=Bp(n,e,0,[e.props,r]);if(Lg(),hm(),RM(a)){if(a.then(hm,hm),t)return a.then(o=>{sT(e,o,t)}).catch(o=>{Wb(o,e,0)});e.asyncDep=a}else sT(e,a,t)}else TE(e,t)}function sT(e,t,s){Bn(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Yr(t)&&(e.setupState=JM(t)),TE(e,s)}let nT;function TE(e,t,s){const n=e.type;if(!e.render){if(!t&&nT&&!n.render){const r=n.template||X2(e).template;if(r){const{isCustomElement:a,compilerOptions:o}=e.appContext.config,{delimiters:d,compilerOptions:p}=n,y=Do(Do({isCustomElement:a,delimiters:d},o),p);n.render=nT(r,y)}}e.render=n.render||vu}_g(e),Og(),yL(e),Lg(),hm()}function UL(e){return new Proxy(e.attrs,{get(t,s){return ul(e,"get","$attrs"),t[s]}})}function VL(e){const t=n=>{e.exposed=n||{}};let s;return{get attrs(){return s||(s=UL(e))},slots:e.slots,emit:e.emit,expose:t}}function tx(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(JM(fg(e.exposed)),{get(t,s){if(s in t)return t[s];if(s in Yy)return Yy[s](e)},has(t,s){return s in t||s in Yy}}))}function jL(e,t=!0){return Bn(e)?e.displayName||e.name:e.name||t&&e.__name}function qL(e){return Bn(e)&&"__vccOpts"in e}const ri=(e,t)=>GO(e,t,fv);function An(e,t,s){const n=arguments.length;return n===2?Yr(t)&&!dn(t)?hb(t)?de(e,null,[t]):de(e,t):de(e,null,t):(n>3?s=Array.prototype.slice.call(arguments,2):n===3&&hb(s)&&(s=[s]),de(e,t,s))}const HL=Symbol(""),GL=()=>dm(HL),WL="3.2.47",YL="http://www.w3.org/2000/svg",tm=typeof document<"u"?document:null,rT=tm&&tm.createElement("template"),ZL={insert:(e,t,s)=>{t.insertBefore(e,s||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,s,n)=>{const r=t?tm.createElementNS(YL,e):tm.createElement(e,s?{is:s}:void 0);return e==="select"&&n&&n.multiple!=null&&r.setAttribute("multiple",n.multiple),r},createText:e=>tm.createTextNode(e),createComment:e=>tm.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>tm.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,s,n,r,a){const o=s?s.previousSibling:t.lastChild;if(r&&(r===a||r.nextSibling))for(;t.insertBefore(r.cloneNode(!0),s),!(r===a||!(r=r.nextSibling)););else{rT.innerHTML=n?`<svg>${e}</svg>`:e;const d=rT.content;if(n){const p=d.firstChild;for(;p.firstChild;)d.appendChild(p.firstChild);d.removeChild(p)}t.insertBefore(d,s)}return[o?o.nextSibling:t.firstChild,s?s.previousSibling:t.lastChild]}};function XL(e,t,s){const n=e._vtc;n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):s?e.setAttribute("class",t):e.className=t}function KL(e,t,s){const n=e.style,r=Ni(s);if(s&&!r){if(t&&!Ni(t))for(const a in t)s[a]==null&&TS(n,a,"");for(const a in s)TS(n,a,s[a])}else{const a=n.display;r?t!==s&&(n.cssText=s):t&&e.removeAttribute("style"),"_vod"in e&&(n.display=a)}}const iT=/\s*!important$/;function TS(e,t,s){if(dn(s))s.forEach(n=>TS(e,t,n));else if(s==null&&(s=""),t.startsWith("--"))e.setProperty(t,s);else{const n=JL(e,t);iT.test(s)?e.setProperty(Mm(n),s.replace(iT,""),"important"):e[n]=s}}const oT=["Webkit","Moz","ms"],Fw={};function JL(e,t){const s=Fw[t];if(s)return s;let n=ud(t);if(n!=="filter"&&n in e)return Fw[t]=n;n=Hb(n);for(let r=0;r<oT.length;r++){const a=oT[r]+n;if(a in e)return Fw[t]=a}return t}const aT="http://www.w3.org/1999/xlink";function QL(e,t,s,n,r){if(n&&t.startsWith("xlink:"))s==null?e.removeAttributeNS(aT,t.slice(6,t.length)):e.setAttributeNS(aT,t,s);else{const a=Q5(t);s==null||a&&!EM(s)?e.removeAttribute(t):e.setAttribute(t,a?"":s)}}function eN(e,t,s,n,r,a,o){if(t==="innerHTML"||t==="textContent"){n&&o(n,r,a),e[t]=s==null?"":s;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=s;const p=s==null?"":s;(e.value!==p||e.tagName==="OPTION")&&(e.value=p),s==null&&e.removeAttribute(t);return}let d=!1;if(s===""||s==null){const p=typeof e[t];p==="boolean"?s=EM(s):s==null&&p==="string"?(s="",d=!0):p==="number"&&(s=0,d=!0)}try{e[t]=s}catch{}d&&e.removeAttribute(t)}function sm(e,t,s,n){e.addEventListener(t,s,n)}function tN(e,t,s,n){e.removeEventListener(t,s,n)}function sN(e,t,s,n,r=null){const a=e._vei||(e._vei={}),o=a[t];if(n&&o)o.value=n;else{const[d,p]=nN(t);if(n){const y=a[t]=oN(n,r);sm(e,d,y,p)}else o&&(tN(e,d,o,p),a[t]=void 0)}}const lT=/(?:Once|Passive|Capture)$/;function nN(e){let t;if(lT.test(e)){t={};let n;for(;n=e.match(lT);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Mm(e.slice(2)),t]}let zw=0;const rN=Promise.resolve(),iN=()=>zw||(rN.then(()=>zw=0),zw=Date.now());function oN(e,t){const s=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=s.attached)return;Ec(aN(n,s.value),t,5,[n])};return s.value=e,s.attached=iN(),s}function aN(e,t){if(dn(t)){const s=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{s.call(e),e._stopped=!0},t.map(n=>r=>!r._stopped&&n&&n(r))}else return t}const cT=/^on[a-z]/,lN=(e,t,s,n,r=!1,a,o,d,p)=>{t==="class"?XL(e,n,r):t==="style"?KL(e,s,n):jb(t)?P2(t)||sN(e,t,s,n,o):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):cN(e,t,n,r))?eN(e,t,n,a,o,d,p):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),QL(e,t,n,r))};function cN(e,t,s,n){return n?!!(t==="innerHTML"||t==="textContent"||t in e&&cT.test(t)&&Bn(s)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||cT.test(t)&&Ni(s)?!1:t in e}function AE(e){const t=qv();if(!t)return;const s=t.ut=(r=e(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach(a=>MS(a,r))},n=()=>{const r=e(t.proxy);AS(t.subTree,r),s(r)};iL(n),H2(()=>{const r=new MutationObserver(n);r.observe(t.subTree.el.parentNode,{childList:!0}),W2(()=>r.disconnect())})}function AS(e,t){if(e.shapeFlag&128){const s=e.suspense;e=s.activeBranch,s.pendingBranch&&!s.isHydrating&&s.effects.push(()=>{AS(s.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)MS(e.el,t);else if(e.type===Lt)e.children.forEach(s=>AS(s,t));else if(e.type===Zy){let{el:s,anchor:n}=e;for(;s&&(MS(s,t),s!==n);)s=s.nextSibling}}function MS(e,t){if(e.nodeType===1){const s=e.style;for(const n in t)s.setProperty(`--${n}`,t[n])}}const xp="transition",Ry="animation",Pp=(e,{slots:t})=>An(aE,EE(e),t);Pp.displayName="Transition";const ME={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},uN=Pp.props=Do({},aE.props,ME),Gf=(e,t=[])=>{dn(e)?e.forEach(s=>s(...t)):e&&e(...t)},uT=e=>e?dn(e)?e.some(t=>t.length>1):e.length>1:!1;function EE(e){const t={};for(const Qe in e)Qe in ME||(t[Qe]=e[Qe]);if(e.css===!1)return t;const{name:s="v",type:n,duration:r,enterFromClass:a=`${s}-enter-from`,enterActiveClass:o=`${s}-enter-active`,enterToClass:d=`${s}-enter-to`,appearFromClass:p=a,appearActiveClass:y=o,appearToClass:v=d,leaveFromClass:C=`${s}-leave-from`,leaveActiveClass:I=`${s}-leave-active`,leaveToClass:O=`${s}-leave-to`}=e,A=dN(r),P=A&&A[0],q=A&&A[1],{onBeforeEnter:ce,onEnter:re,onEnterCancelled:W,onLeave:Ce,onLeaveCancelled:te,onBeforeAppear:oe=ce,onAppear:ve=re,onAppearCancelled:ee=W}=t,ne=(Qe,Me,vt)=>{Sp(Qe,Me?v:d),Sp(Qe,Me?y:o),vt&&vt()},Se=(Qe,Me)=>{Qe._isLeaving=!1,Sp(Qe,C),Sp(Qe,O),Sp(Qe,I),Me&&Me()},Ue=Qe=>(Me,vt)=>{const Ut=Qe?ve:re,Rt=()=>ne(Me,Qe,vt);Gf(Ut,[Me,Rt]),dT(()=>{Sp(Me,Qe?p:a),sh(Me,Qe?v:d),uT(Ut)||hT(Me,n,P,Rt)})};return Do(t,{onBeforeEnter(Qe){Gf(ce,[Qe]),sh(Qe,a),sh(Qe,o)},onBeforeAppear(Qe){Gf(oe,[Qe]),sh(Qe,p),sh(Qe,y)},onEnter:Ue(!1),onAppear:Ue(!0),onLeave(Qe,Me){Qe._isLeaving=!0;const vt=()=>Se(Qe,Me);sh(Qe,C),PE(),sh(Qe,I),dT(()=>{!Qe._isLeaving||(Sp(Qe,C),sh(Qe,O),uT(Ce)||hT(Qe,n,q,vt))}),Gf(Ce,[Qe,vt])},onEnterCancelled(Qe){ne(Qe,!1),Gf(W,[Qe])},onAppearCancelled(Qe){ne(Qe,!0),Gf(ee,[Qe])},onLeaveCancelled(Qe){Se(Qe),Gf(te,[Qe])}})}function dN(e){if(e==null)return null;if(Yr(e))return[Uw(e.enter),Uw(e.leave)];{const t=Uw(e);return[t,t]}}function Uw(e){return aO(e)}function sh(e,t){t.split(/\s+/).forEach(s=>s&&e.classList.add(s)),(e._vtc||(e._vtc=new Set)).add(t)}function Sp(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.remove(n));const{_vtc:s}=e;s&&(s.delete(t),s.size||(e._vtc=void 0))}function dT(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let hN=0;function hT(e,t,s,n){const r=e._endId=++hN,a=()=>{r===e._endId&&n()};if(s)return setTimeout(a,s);const{type:o,timeout:d,propCount:p}=kE(e,t);if(!o)return n();const y=o+"end";let v=0;const C=()=>{e.removeEventListener(y,I),a()},I=O=>{O.target===e&&++v>=p&&C()};setTimeout(()=>{v<p&&C()},d+1),e.addEventListener(y,I)}function kE(e,t){const s=window.getComputedStyle(e),n=A=>(s[A]||"").split(", "),r=n(`${xp}Delay`),a=n(`${xp}Duration`),o=pT(r,a),d=n(`${Ry}Delay`),p=n(`${Ry}Duration`),y=pT(d,p);let v=null,C=0,I=0;t===xp?o>0&&(v=xp,C=o,I=a.length):t===Ry?y>0&&(v=Ry,C=y,I=p.length):(C=Math.max(o,y),v=C>0?o>y?xp:Ry:null,I=v?v===xp?a.length:p.length:0);const O=v===xp&&/\b(transform|all)(,|$)/.test(n(`${xp}Property`).toString());return{type:v,timeout:C,propCount:I,hasTransform:O}}function pT(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((s,n)=>fT(s)+fT(e[n])))}function fT(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function PE(){return document.body.offsetHeight}const RE=new WeakMap,$E=new WeakMap,OE={name:"TransitionGroup",props:Do({},uN,{tag:String,moveClass:String}),setup(e,{slots:t}){const s=qv(),n=oE();let r,a;return dE(()=>{if(!r.length)return;const o=e.moveClass||`${e.name||"v"}-move`;if(!yN(r[0].el,s.vnode.el,o))return;r.forEach(mN),r.forEach(_N);const d=r.filter(gN);PE(),d.forEach(p=>{const y=p.el,v=y.style;sh(y,o),v.transform=v.webkitTransform=v.transitionDuration="";const C=y._moveCb=I=>{I&&I.target!==y||(!I||/transform$/.test(I.propertyName))&&(y.removeEventListener("transitionend",C),y._moveCb=null,Sp(y,o))};y.addEventListener("transitionend",C)})}),()=>{const o=ar(e),d=EE(o);let p=o.tag||Lt;r=a,a=t.default?q2(t.default()):[];for(let y=0;y<a.length;y++){const v=a[y];v.key!=null&&hv(v,dv(v,d,n,s))}if(r)for(let y=0;y<r.length;y++){const v=r[y];hv(v,dv(v,d,n,s)),RE.set(v,v.el.getBoundingClientRect())}return de(p,null,a)}}},pN=e=>delete e.mode;OE.props;const fN=OE;function mN(e){const t=e.el;t._moveCb&&t._moveCb(),t._enterCb&&t._enterCb()}function _N(e){$E.set(e,e.el.getBoundingClientRect())}function gN(e){const t=RE.get(e),s=$E.get(e),n=t.left-s.left,r=t.top-s.top;if(n||r){const a=e.el.style;return a.transform=a.webkitTransform=`translate(${n}px,${r}px)`,a.transitionDuration="0s",e}}function yN(e,t,s){const n=e.cloneNode();e._vtc&&e._vtc.forEach(o=>{o.split(/\s+/).forEach(d=>d&&n.classList.remove(d))}),s.split(/\s+/).forEach(o=>o&&n.classList.add(o)),n.style.display="none";const r=t.nodeType===1?t:t.parentNode;r.appendChild(n);const{hasTransform:a}=kE(n);return r.removeChild(n),a}const pb=e=>{const t=e.props["onUpdate:modelValue"]||!1;return dn(t)?s=>F1(t,s):t};function vN(e){e.target.composing=!0}function mT(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Tp={created(e,{modifiers:{lazy:t,trim:s,number:n}},r){e._assign=pb(r);const a=n||r.props&&r.props.type==="number";sm(e,t?"change":"input",o=>{if(o.target.composing)return;let d=e.value;s&&(d=d.trim()),a&&(d=mS(d)),e._assign(d)}),s&&sm(e,"change",()=>{e.value=e.value.trim()}),t||(sm(e,"compositionstart",vN),sm(e,"compositionend",mT),sm(e,"change",mT))},mounted(e,{value:t}){e.value=t==null?"":t},beforeUpdate(e,{value:t,modifiers:{lazy:s,trim:n,number:r}},a){if(e._assign=pb(a),e.composing||document.activeElement===e&&e.type!=="range"&&(s||n&&e.value.trim()===t||(r||e.type==="number")&&mS(e.value)===t))return;const o=t==null?"":t;e.value!==o&&(e.value=o)}},Ng={created(e,{value:t},s){e.checked=ib(t,s.props.value),e._assign=pb(s),sm(e,"change",()=>{e._assign(bN(e))})},beforeUpdate(e,{value:t,oldValue:s},n){e._assign=pb(n),t!==s&&(e.checked=ib(t,n.props.value))}};function bN(e){return"_value"in e?e._value:e.value}const xN=["ctrl","shift","alt","meta"],wN={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>xN.some(s=>e[`${s}Key`]&&!t.includes(s))},Os=(e,t)=>(s,...n)=>{for(let r=0;r<t.length;r++){const a=wN[t[r]];if(a&&a(s,t))return}return e(s,...n)},SN={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Zs=(e,t)=>s=>{if(!("key"in s))return;const n=Mm(s.key);if(t.some(r=>r===n||SN[r]===n))return e(s)},Ai={beforeMount(e,{value:t},{transition:s}){e._vod=e.style.display==="none"?"":e.style.display,s&&t?s.beforeEnter(e):$y(e,t)},mounted(e,{value:t},{transition:s}){s&&t&&s.enter(e)},updated(e,{value:t,oldValue:s},{transition:n}){!t!=!s&&(n?t?(n.beforeEnter(e),$y(e,!0),n.enter(e)):n.leave(e,()=>{$y(e,!1)}):$y(e,t))},beforeUnmount(e,{value:t}){$y(e,t)}};function $y(e,t){e.style.display=t?e._vod:"none"}const CN=Do({patchProp:lN},ZL);let _T;function IN(){return _T||(_T=kL(CN))}const TN=(...e)=>{const t=IN().createApp(...e),{mount:s}=t;return t.mount=n=>{const r=AN(n);if(!r)return;const a=t._component;!Bn(a)&&!a.render&&!a.template&&(a.template=r.innerHTML),r.innerHTML="";const o=s(r,!1,r instanceof SVGElement);return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},t};function AN(e){return Ni(e)?document.querySelector(e):e}var MN=!1;/*!
  * pinia v2.0.32
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */let LE;const sx=e=>LE=e,NE=Symbol();function ES(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var Ky;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Ky||(Ky={}));function EN(){const e=NM(!0),t=e.run(()=>Nl({}));let s=[],n=[];const r=fg({install(a){sx(r),r._a=a,a.provide(NE,r),a.config.globalProperties.$pinia=r,n.forEach(o=>s.push(o)),n=[]},use(a){return!this._a&&!MN?n.push(a):s.push(a),this},_p:s,_a:null,_e:e,_s:new Map,state:t});return r}const DE=()=>{};function gT(e,t,s,n=DE){e.push(t);const r=()=>{const a=e.indexOf(t);a>-1&&(e.splice(a,1),n())};return!s&&DM()&&uO(r),r}function z_(e,...t){e.slice().forEach(s=>{s(...t)})}function kS(e,t){e instanceof Map&&t instanceof Map&&t.forEach((s,n)=>e.set(n,s)),e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const s in t){if(!t.hasOwnProperty(s))continue;const n=t[s],r=e[s];ES(r)&&ES(n)&&e.hasOwnProperty(s)&&!yi(n)&&!hh(n)?e[s]=kS(r,n):e[s]=n}return e}const kN=Symbol();function PN(e){return!ES(e)||!e.hasOwnProperty(kN)}const{assign:Ap}=Object;function RN(e){return!!(yi(e)&&e.effect)}function $N(e,t,s,n){const{state:r,actions:a,getters:o}=t,d=s.state.value[e];let p;function y(){d||(s.state.value[e]=r?r():{});const v=VO(s.state.value[e]);return Ap(v,a,Object.keys(o||{}).reduce((C,I)=>(C[I]=fg(ri(()=>{sx(s);const O=s._s.get(e);return o[I].call(O,O)})),C),{}))}return p=BE(e,y,t,s,n,!0),p.$reset=function(){const C=r?r():{};this.$patch(I=>{Ap(I,C)})},p}function BE(e,t,s={},n,r,a){let o;const d=Ap({actions:{}},s),p={deep:!0};let y,v,C=fg([]),I=fg([]),O;const A=n.state.value[e];!a&&!A&&(n.state.value[e]={}),Nl({});let P;function q(ve){let ee;y=v=!1,typeof ve=="function"?(ve(n.state.value[e]),ee={type:Ky.patchFunction,storeId:e,events:O}):(kS(n.state.value[e],ve),ee={type:Ky.patchObject,payload:ve,storeId:e,events:O});const ne=P=Symbol();cb().then(()=>{P===ne&&(y=!0)}),v=!0,z_(C,ee,n.state.value[e])}const ce=DE;function re(){o.stop(),C=[],I=[],n._s.delete(e)}function W(ve,ee){return function(){sx(n);const ne=Array.from(arguments),Se=[],Ue=[];function Qe(Ut){Se.push(Ut)}function Me(Ut){Ue.push(Ut)}z_(I,{args:ne,name:ve,store:te,after:Qe,onError:Me});let vt;try{vt=ee.apply(this&&this.$id===e?this:te,ne)}catch(Ut){throw z_(Ue,Ut),Ut}return vt instanceof Promise?vt.then(Ut=>(z_(Se,Ut),Ut)).catch(Ut=>(z_(Ue,Ut),Promise.reject(Ut))):(z_(Se,vt),vt)}}const Ce={_p:n,$id:e,$onAction:gT.bind(null,I),$patch:q,$reset:ce,$subscribe(ve,ee={}){const ne=gT(C,ve,ee.detached,()=>Se()),Se=o.run(()=>ph(()=>n.state.value[e],Ue=>{(ee.flush==="sync"?v:y)&&ve({storeId:e,type:Ky.direct,events:O},Ue)},Ap({},p,ee)));return ne},$dispose:re},te=Em(Ce);n._s.set(e,te);const oe=n._e.run(()=>(o=NM(),o.run(()=>t())));for(const ve in oe){const ee=oe[ve];if(yi(ee)&&!RN(ee)||hh(ee))a||(A&&PN(ee)&&(yi(ee)?ee.value=A[ve]:kS(ee,A[ve])),n.state.value[e][ve]=ee);else if(typeof ee=="function"){const ne=W(ve,ee);oe[ve]=ne,d.actions[ve]=ee}}return Ap(te,oe),Ap(ar(te),oe),Object.defineProperty(te,"$state",{get:()=>n.state.value[e],set:ve=>{q(ee=>{Ap(ee,ve)})}}),n._p.forEach(ve=>{Ap(te,o.run(()=>ve({store:te,app:n._a,pinia:n,options:d})))}),A&&a&&s.hydrate&&s.hydrate(te.$state,A),y=!0,v=!0,te}function ON(e,t,s){let n,r;const a=typeof t=="function";typeof e=="string"?(n=e,r=a?s:t):(r=e,n=e.id);function o(d,p){const y=qv();return d=d||y&&dm(NE,null),d&&sx(d),d=LE,d._s.has(n)||(a?BE(n,t,r,d):$N(n,r,d)),d._s.get(n)}return o.$id=n,o}const yT={name:"IconSettings",render(){return this.$slots.default?this.$slots.default()[0]:null},props:{iconPath:String,actionSpritePath:String,customSpritePath:String,doctypeSpritePath:String,standardSpritePath:String,utilitySpritePath:String},provide(){return{$__getIconSettings:()=>this.$props}}},LN={install:(e,t)=>{e.config.globalProperties.$__getGlobalLabels=()=>t}};var Qu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function NN(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Q2(e){var t=e.default;if(typeof t=="function"){var s=function(){return t.apply(this,arguments)};s.prototype=t.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(s,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}),s}var FE={},nx={};nx.byteLength=FN;nx.toByteArray=UN;nx.fromByteArray=qN;var ed=[],Sc=[],DN=typeof Uint8Array<"u"?Uint8Array:Array,Vw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var U_=0,BN=Vw.length;U_<BN;++U_)ed[U_]=Vw[U_],Sc[Vw.charCodeAt(U_)]=U_;Sc["-".charCodeAt(0)]=62;Sc["_".charCodeAt(0)]=63;function zE(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var s=e.indexOf("=");s===-1&&(s=t);var n=s===t?0:4-s%4;return[s,n]}function FN(e){var t=zE(e),s=t[0],n=t[1];return(s+n)*3/4-n}function zN(e,t,s){return(t+s)*3/4-s}function UN(e){var t,s=zE(e),n=s[0],r=s[1],a=new DN(zN(e,n,r)),o=0,d=r>0?n-4:n,p;for(p=0;p<d;p+=4)t=Sc[e.charCodeAt(p)]<<18|Sc[e.charCodeAt(p+1)]<<12|Sc[e.charCodeAt(p+2)]<<6|Sc[e.charCodeAt(p+3)],a[o++]=t>>16&255,a[o++]=t>>8&255,a[o++]=t&255;return r===2&&(t=Sc[e.charCodeAt(p)]<<2|Sc[e.charCodeAt(p+1)]>>4,a[o++]=t&255),r===1&&(t=Sc[e.charCodeAt(p)]<<10|Sc[e.charCodeAt(p+1)]<<4|Sc[e.charCodeAt(p+2)]>>2,a[o++]=t>>8&255,a[o++]=t&255),a}function VN(e){return ed[e>>18&63]+ed[e>>12&63]+ed[e>>6&63]+ed[e&63]}function jN(e,t,s){for(var n,r=[],a=t;a<s;a+=3)n=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(e[a+2]&255),r.push(VN(n));return r.join("")}function qN(e){for(var t,s=e.length,n=s%3,r=[],a=16383,o=0,d=s-n;o<d;o+=a)r.push(jN(e,o,o+a>d?d:o+a));return n===1?(t=e[s-1],r.push(ed[t>>2]+ed[t<<4&63]+"==")):n===2&&(t=(e[s-2]<<8)+e[s-1],r.push(ed[t>>10]+ed[t>>4&63]+ed[t<<2&63]+"=")),r.join("")}var eC={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */eC.read=function(e,t,s,n,r){var a,o,d=r*8-n-1,p=(1<<d)-1,y=p>>1,v=-7,C=s?r-1:0,I=s?-1:1,O=e[t+C];for(C+=I,a=O&(1<<-v)-1,O>>=-v,v+=d;v>0;a=a*256+e[t+C],C+=I,v-=8);for(o=a&(1<<-v)-1,a>>=-v,v+=n;v>0;o=o*256+e[t+C],C+=I,v-=8);if(a===0)a=1-y;else{if(a===p)return o?NaN:(O?-1:1)*(1/0);o=o+Math.pow(2,n),a=a-y}return(O?-1:1)*o*Math.pow(2,a-n)};eC.write=function(e,t,s,n,r,a){var o,d,p,y=a*8-r-1,v=(1<<y)-1,C=v>>1,I=r===23?Math.pow(2,-24)-Math.pow(2,-77):0,O=n?0:a-1,A=n?1:-1,P=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(d=isNaN(t)?1:0,o=v):(o=Math.floor(Math.log(t)/Math.LN2),t*(p=Math.pow(2,-o))<1&&(o--,p*=2),o+C>=1?t+=I/p:t+=I*Math.pow(2,1-C),t*p>=2&&(o++,p/=2),o+C>=v?(d=0,o=v):o+C>=1?(d=(t*p-1)*Math.pow(2,r),o=o+C):(d=t*Math.pow(2,C-1)*Math.pow(2,r),o=0));r>=8;e[s+O]=d&255,O+=A,d/=256,r-=8);for(o=o<<r|d,y+=r;y>0;e[s+O]=o&255,O+=A,o/=256,y-=8);e[s+O-A]|=P*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(e){const t=nx,s=eC,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=d,e.SlowBuffer=re,e.INSPECT_MAX_BYTES=50;const r=2147483647;e.kMaxLength=r,d.TYPED_ARRAY_SUPPORT=a(),!d.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function a(){try{const ue=new Uint8Array(1),B={foo:function(){return 42}};return Object.setPrototypeOf(B,Uint8Array.prototype),Object.setPrototypeOf(ue,B),ue.foo()===42}catch{return!1}}Object.defineProperty(d.prototype,"parent",{enumerable:!0,get:function(){if(!!d.isBuffer(this))return this.buffer}}),Object.defineProperty(d.prototype,"offset",{enumerable:!0,get:function(){if(!!d.isBuffer(this))return this.byteOffset}});function o(ue){if(ue>r)throw new RangeError('The value "'+ue+'" is invalid for option "size"');const B=new Uint8Array(ue);return Object.setPrototypeOf(B,d.prototype),B}function d(ue,B,U){if(typeof ue=="number"){if(typeof B=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return C(ue)}return p(ue,B,U)}d.poolSize=8192;function p(ue,B,U){if(typeof ue=="string")return I(ue,B);if(ArrayBuffer.isView(ue))return A(ue);if(ue==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ue);if(Bt(ue,ArrayBuffer)||ue&&Bt(ue.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Bt(ue,SharedArrayBuffer)||ue&&Bt(ue.buffer,SharedArrayBuffer)))return P(ue,B,U);if(typeof ue=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const Re=ue.valueOf&&ue.valueOf();if(Re!=null&&Re!==ue)return d.from(Re,B,U);const nt=q(ue);if(nt)return nt;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof ue[Symbol.toPrimitive]=="function")return d.from(ue[Symbol.toPrimitive]("string"),B,U);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ue)}d.from=function(ue,B,U){return p(ue,B,U)},Object.setPrototypeOf(d.prototype,Uint8Array.prototype),Object.setPrototypeOf(d,Uint8Array);function y(ue){if(typeof ue!="number")throw new TypeError('"size" argument must be of type number');if(ue<0)throw new RangeError('The value "'+ue+'" is invalid for option "size"')}function v(ue,B,U){return y(ue),ue<=0?o(ue):B!==void 0?typeof U=="string"?o(ue).fill(B,U):o(ue).fill(B):o(ue)}d.alloc=function(ue,B,U){return v(ue,B,U)};function C(ue){return y(ue),o(ue<0?0:ce(ue)|0)}d.allocUnsafe=function(ue){return C(ue)},d.allocUnsafeSlow=function(ue){return C(ue)};function I(ue,B){if((typeof B!="string"||B==="")&&(B="utf8"),!d.isEncoding(B))throw new TypeError("Unknown encoding: "+B);const U=W(ue,B)|0;let Re=o(U);const nt=Re.write(ue,B);return nt!==U&&(Re=Re.slice(0,nt)),Re}function O(ue){const B=ue.length<0?0:ce(ue.length)|0,U=o(B);for(let Re=0;Re<B;Re+=1)U[Re]=ue[Re]&255;return U}function A(ue){if(Bt(ue,Uint8Array)){const B=new Uint8Array(ue);return P(B.buffer,B.byteOffset,B.byteLength)}return O(ue)}function P(ue,B,U){if(B<0||ue.byteLength<B)throw new RangeError('"offset" is outside of buffer bounds');if(ue.byteLength<B+(U||0))throw new RangeError('"length" is outside of buffer bounds');let Re;return B===void 0&&U===void 0?Re=new Uint8Array(ue):U===void 0?Re=new Uint8Array(ue,B):Re=new Uint8Array(ue,B,U),Object.setPrototypeOf(Re,d.prototype),Re}function q(ue){if(d.isBuffer(ue)){const B=ce(ue.length)|0,U=o(B);return U.length===0||ue.copy(U,0,0,B),U}if(ue.length!==void 0)return typeof ue.length!="number"||Kt(ue.length)?o(0):O(ue);if(ue.type==="Buffer"&&Array.isArray(ue.data))return O(ue.data)}function ce(ue){if(ue>=r)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return ue|0}function re(ue){return+ue!=ue&&(ue=0),d.alloc(+ue)}d.isBuffer=function(B){return B!=null&&B._isBuffer===!0&&B!==d.prototype},d.compare=function(B,U){if(Bt(B,Uint8Array)&&(B=d.from(B,B.offset,B.byteLength)),Bt(U,Uint8Array)&&(U=d.from(U,U.offset,U.byteLength)),!d.isBuffer(B)||!d.isBuffer(U))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(B===U)return 0;let Re=B.length,nt=U.length;for(let gt=0,kt=Math.min(Re,nt);gt<kt;++gt)if(B[gt]!==U[gt]){Re=B[gt],nt=U[gt];break}return Re<nt?-1:nt<Re?1:0},d.isEncoding=function(B){switch(String(B).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(B,U){if(!Array.isArray(B))throw new TypeError('"list" argument must be an Array of Buffers');if(B.length===0)return d.alloc(0);let Re;if(U===void 0)for(U=0,Re=0;Re<B.length;++Re)U+=B[Re].length;const nt=d.allocUnsafe(U);let gt=0;for(Re=0;Re<B.length;++Re){let kt=B[Re];if(Bt(kt,Uint8Array))gt+kt.length>nt.length?(d.isBuffer(kt)||(kt=d.from(kt)),kt.copy(nt,gt)):Uint8Array.prototype.set.call(nt,kt,gt);else if(d.isBuffer(kt))kt.copy(nt,gt);else throw new TypeError('"list" argument must be an Array of Buffers');gt+=kt.length}return nt};function W(ue,B){if(d.isBuffer(ue))return ue.length;if(ArrayBuffer.isView(ue)||Bt(ue,ArrayBuffer))return ue.byteLength;if(typeof ue!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof ue);const U=ue.length,Re=arguments.length>2&&arguments[2]===!0;if(!Re&&U===0)return 0;let nt=!1;for(;;)switch(B){case"ascii":case"latin1":case"binary":return U;case"utf8":case"utf-8":return Et(ue).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U*2;case"hex":return U>>>1;case"base64":return St(ue).length;default:if(nt)return Re?-1:Et(ue).length;B=(""+B).toLowerCase(),nt=!0}}d.byteLength=W;function Ce(ue,B,U){let Re=!1;if((B===void 0||B<0)&&(B=0),B>this.length||((U===void 0||U>this.length)&&(U=this.length),U<=0)||(U>>>=0,B>>>=0,U<=B))return"";for(ue||(ue="utf8");;)switch(ue){case"hex":return j(this,B,U);case"utf8":case"utf-8":return vt(this,B,U);case"ascii":return _t(this,B,U);case"latin1":case"binary":return F(this,B,U);case"base64":return Me(this,B,U);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,B,U);default:if(Re)throw new TypeError("Unknown encoding: "+ue);ue=(ue+"").toLowerCase(),Re=!0}}d.prototype._isBuffer=!0;function te(ue,B,U){const Re=ue[B];ue[B]=ue[U],ue[U]=Re}d.prototype.swap16=function(){const B=this.length;if(B%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let U=0;U<B;U+=2)te(this,U,U+1);return this},d.prototype.swap32=function(){const B=this.length;if(B%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let U=0;U<B;U+=4)te(this,U,U+3),te(this,U+1,U+2);return this},d.prototype.swap64=function(){const B=this.length;if(B%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let U=0;U<B;U+=8)te(this,U,U+7),te(this,U+1,U+6),te(this,U+2,U+5),te(this,U+3,U+4);return this},d.prototype.toString=function(){const B=this.length;return B===0?"":arguments.length===0?vt(this,0,B):Ce.apply(this,arguments)},d.prototype.toLocaleString=d.prototype.toString,d.prototype.equals=function(B){if(!d.isBuffer(B))throw new TypeError("Argument must be a Buffer");return this===B?!0:d.compare(this,B)===0},d.prototype.inspect=function(){let B="";const U=e.INSPECT_MAX_BYTES;return B=this.toString("hex",0,U).replace(/(.{2})/g,"$1 ").trim(),this.length>U&&(B+=" ... "),"<Buffer "+B+">"},n&&(d.prototype[n]=d.prototype.inspect),d.prototype.compare=function(B,U,Re,nt,gt){if(Bt(B,Uint8Array)&&(B=d.from(B,B.offset,B.byteLength)),!d.isBuffer(B))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof B);if(U===void 0&&(U=0),Re===void 0&&(Re=B?B.length:0),nt===void 0&&(nt=0),gt===void 0&&(gt=this.length),U<0||Re>B.length||nt<0||gt>this.length)throw new RangeError("out of range index");if(nt>=gt&&U>=Re)return 0;if(nt>=gt)return-1;if(U>=Re)return 1;if(U>>>=0,Re>>>=0,nt>>>=0,gt>>>=0,this===B)return 0;let kt=gt-nt,Ds=Re-U;const tn=Math.min(kt,Ds),nn=this.slice(nt,gt),qn=B.slice(U,Re);for(let Kn=0;Kn<tn;++Kn)if(nn[Kn]!==qn[Kn]){kt=nn[Kn],Ds=qn[Kn];break}return kt<Ds?-1:Ds<kt?1:0};function oe(ue,B,U,Re,nt){if(ue.length===0)return-1;if(typeof U=="string"?(Re=U,U=0):U>2147483647?U=2147483647:U<-2147483648&&(U=-2147483648),U=+U,Kt(U)&&(U=nt?0:ue.length-1),U<0&&(U=ue.length+U),U>=ue.length){if(nt)return-1;U=ue.length-1}else if(U<0)if(nt)U=0;else return-1;if(typeof B=="string"&&(B=d.from(B,Re)),d.isBuffer(B))return B.length===0?-1:ve(ue,B,U,Re,nt);if(typeof B=="number")return B=B&255,typeof Uint8Array.prototype.indexOf=="function"?nt?Uint8Array.prototype.indexOf.call(ue,B,U):Uint8Array.prototype.lastIndexOf.call(ue,B,U):ve(ue,[B],U,Re,nt);throw new TypeError("val must be string, number or Buffer")}function ve(ue,B,U,Re,nt){let gt=1,kt=ue.length,Ds=B.length;if(Re!==void 0&&(Re=String(Re).toLowerCase(),Re==="ucs2"||Re==="ucs-2"||Re==="utf16le"||Re==="utf-16le")){if(ue.length<2||B.length<2)return-1;gt=2,kt/=2,Ds/=2,U/=2}function tn(qn,Kn){return gt===1?qn[Kn]:qn.readUInt16BE(Kn*gt)}let nn;if(nt){let qn=-1;for(nn=U;nn<kt;nn++)if(tn(ue,nn)===tn(B,qn===-1?0:nn-qn)){if(qn===-1&&(qn=nn),nn-qn+1===Ds)return qn*gt}else qn!==-1&&(nn-=nn-qn),qn=-1}else for(U+Ds>kt&&(U=kt-Ds),nn=U;nn>=0;nn--){let qn=!0;for(let Kn=0;Kn<Ds;Kn++)if(tn(ue,nn+Kn)!==tn(B,Kn)){qn=!1;break}if(qn)return nn}return-1}d.prototype.includes=function(B,U,Re){return this.indexOf(B,U,Re)!==-1},d.prototype.indexOf=function(B,U,Re){return oe(this,B,U,Re,!0)},d.prototype.lastIndexOf=function(B,U,Re){return oe(this,B,U,Re,!1)};function ee(ue,B,U,Re){U=Number(U)||0;const nt=ue.length-U;Re?(Re=Number(Re),Re>nt&&(Re=nt)):Re=nt;const gt=B.length;Re>gt/2&&(Re=gt/2);let kt;for(kt=0;kt<Re;++kt){const Ds=parseInt(B.substr(kt*2,2),16);if(Kt(Ds))return kt;ue[U+kt]=Ds}return kt}function ne(ue,B,U,Re){return Ct(Et(B,ue.length-U),ue,U,Re)}function Se(ue,B,U,Re){return Ct(jt(B),ue,U,Re)}function Ue(ue,B,U,Re){return Ct(St(B),ue,U,Re)}function Qe(ue,B,U,Re){return Ct(Nt(B,ue.length-U),ue,U,Re)}d.prototype.write=function(B,U,Re,nt){if(U===void 0)nt="utf8",Re=this.length,U=0;else if(Re===void 0&&typeof U=="string")nt=U,Re=this.length,U=0;else if(isFinite(U))U=U>>>0,isFinite(Re)?(Re=Re>>>0,nt===void 0&&(nt="utf8")):(nt=Re,Re=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const gt=this.length-U;if((Re===void 0||Re>gt)&&(Re=gt),B.length>0&&(Re<0||U<0)||U>this.length)throw new RangeError("Attempt to write outside buffer bounds");nt||(nt="utf8");let kt=!1;for(;;)switch(nt){case"hex":return ee(this,B,U,Re);case"utf8":case"utf-8":return ne(this,B,U,Re);case"ascii":case"latin1":case"binary":return Se(this,B,U,Re);case"base64":return Ue(this,B,U,Re);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Qe(this,B,U,Re);default:if(kt)throw new TypeError("Unknown encoding: "+nt);nt=(""+nt).toLowerCase(),kt=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Me(ue,B,U){return B===0&&U===ue.length?t.fromByteArray(ue):t.fromByteArray(ue.slice(B,U))}function vt(ue,B,U){U=Math.min(ue.length,U);const Re=[];let nt=B;for(;nt<U;){const gt=ue[nt];let kt=null,Ds=gt>239?4:gt>223?3:gt>191?2:1;if(nt+Ds<=U){let tn,nn,qn,Kn;switch(Ds){case 1:gt<128&&(kt=gt);break;case 2:tn=ue[nt+1],(tn&192)===128&&(Kn=(gt&31)<<6|tn&63,Kn>127&&(kt=Kn));break;case 3:tn=ue[nt+1],nn=ue[nt+2],(tn&192)===128&&(nn&192)===128&&(Kn=(gt&15)<<12|(tn&63)<<6|nn&63,Kn>2047&&(Kn<55296||Kn>57343)&&(kt=Kn));break;case 4:tn=ue[nt+1],nn=ue[nt+2],qn=ue[nt+3],(tn&192)===128&&(nn&192)===128&&(qn&192)===128&&(Kn=(gt&15)<<18|(tn&63)<<12|(nn&63)<<6|qn&63,Kn>65535&&Kn<1114112&&(kt=Kn))}}kt===null?(kt=65533,Ds=1):kt>65535&&(kt-=65536,Re.push(kt>>>10&1023|55296),kt=56320|kt&1023),Re.push(kt),nt+=Ds}return Rt(Re)}const Ut=4096;function Rt(ue){const B=ue.length;if(B<=Ut)return String.fromCharCode.apply(String,ue);let U="",Re=0;for(;Re<B;)U+=String.fromCharCode.apply(String,ue.slice(Re,Re+=Ut));return U}function _t(ue,B,U){let Re="";U=Math.min(ue.length,U);for(let nt=B;nt<U;++nt)Re+=String.fromCharCode(ue[nt]&127);return Re}function F(ue,B,U){let Re="";U=Math.min(ue.length,U);for(let nt=B;nt<U;++nt)Re+=String.fromCharCode(ue[nt]);return Re}function j(ue,B,U){const Re=ue.length;(!B||B<0)&&(B=0),(!U||U<0||U>Re)&&(U=Re);let nt="";for(let gt=B;gt<U;++gt)nt+=ys[ue[gt]];return nt}function G(ue,B,U){const Re=ue.slice(B,U);let nt="";for(let gt=0;gt<Re.length-1;gt+=2)nt+=String.fromCharCode(Re[gt]+Re[gt+1]*256);return nt}d.prototype.slice=function(B,U){const Re=this.length;B=~~B,U=U===void 0?Re:~~U,B<0?(B+=Re,B<0&&(B=0)):B>Re&&(B=Re),U<0?(U+=Re,U<0&&(U=0)):U>Re&&(U=Re),U<B&&(U=B);const nt=this.subarray(B,U);return Object.setPrototypeOf(nt,d.prototype),nt};function Y(ue,B,U){if(ue%1!==0||ue<0)throw new RangeError("offset is not uint");if(ue+B>U)throw new RangeError("Trying to access beyond buffer length")}d.prototype.readUintLE=d.prototype.readUIntLE=function(B,U,Re){B=B>>>0,U=U>>>0,Re||Y(B,U,this.length);let nt=this[B],gt=1,kt=0;for(;++kt<U&&(gt*=256);)nt+=this[B+kt]*gt;return nt},d.prototype.readUintBE=d.prototype.readUIntBE=function(B,U,Re){B=B>>>0,U=U>>>0,Re||Y(B,U,this.length);let nt=this[B+--U],gt=1;for(;U>0&&(gt*=256);)nt+=this[B+--U]*gt;return nt},d.prototype.readUint8=d.prototype.readUInt8=function(B,U){return B=B>>>0,U||Y(B,1,this.length),this[B]},d.prototype.readUint16LE=d.prototype.readUInt16LE=function(B,U){return B=B>>>0,U||Y(B,2,this.length),this[B]|this[B+1]<<8},d.prototype.readUint16BE=d.prototype.readUInt16BE=function(B,U){return B=B>>>0,U||Y(B,2,this.length),this[B]<<8|this[B+1]},d.prototype.readUint32LE=d.prototype.readUInt32LE=function(B,U){return B=B>>>0,U||Y(B,4,this.length),(this[B]|this[B+1]<<8|this[B+2]<<16)+this[B+3]*16777216},d.prototype.readUint32BE=d.prototype.readUInt32BE=function(B,U){return B=B>>>0,U||Y(B,4,this.length),this[B]*16777216+(this[B+1]<<16|this[B+2]<<8|this[B+3])},d.prototype.readBigUInt64LE=ts(function(B){B=B>>>0,ye(B,"offset");const U=this[B],Re=this[B+7];(U===void 0||Re===void 0)&&Je(B,this.length-8);const nt=U+this[++B]*2**8+this[++B]*2**16+this[++B]*2**24,gt=this[++B]+this[++B]*2**8+this[++B]*2**16+Re*2**24;return BigInt(nt)+(BigInt(gt)<<BigInt(32))}),d.prototype.readBigUInt64BE=ts(function(B){B=B>>>0,ye(B,"offset");const U=this[B],Re=this[B+7];(U===void 0||Re===void 0)&&Je(B,this.length-8);const nt=U*2**24+this[++B]*2**16+this[++B]*2**8+this[++B],gt=this[++B]*2**24+this[++B]*2**16+this[++B]*2**8+Re;return(BigInt(nt)<<BigInt(32))+BigInt(gt)}),d.prototype.readIntLE=function(B,U,Re){B=B>>>0,U=U>>>0,Re||Y(B,U,this.length);let nt=this[B],gt=1,kt=0;for(;++kt<U&&(gt*=256);)nt+=this[B+kt]*gt;return gt*=128,nt>=gt&&(nt-=Math.pow(2,8*U)),nt},d.prototype.readIntBE=function(B,U,Re){B=B>>>0,U=U>>>0,Re||Y(B,U,this.length);let nt=U,gt=1,kt=this[B+--nt];for(;nt>0&&(gt*=256);)kt+=this[B+--nt]*gt;return gt*=128,kt>=gt&&(kt-=Math.pow(2,8*U)),kt},d.prototype.readInt8=function(B,U){return B=B>>>0,U||Y(B,1,this.length),this[B]&128?(255-this[B]+1)*-1:this[B]},d.prototype.readInt16LE=function(B,U){B=B>>>0,U||Y(B,2,this.length);const Re=this[B]|this[B+1]<<8;return Re&32768?Re|4294901760:Re},d.prototype.readInt16BE=function(B,U){B=B>>>0,U||Y(B,2,this.length);const Re=this[B+1]|this[B]<<8;return Re&32768?Re|4294901760:Re},d.prototype.readInt32LE=function(B,U){return B=B>>>0,U||Y(B,4,this.length),this[B]|this[B+1]<<8|this[B+2]<<16|this[B+3]<<24},d.prototype.readInt32BE=function(B,U){return B=B>>>0,U||Y(B,4,this.length),this[B]<<24|this[B+1]<<16|this[B+2]<<8|this[B+3]},d.prototype.readBigInt64LE=ts(function(B){B=B>>>0,ye(B,"offset");const U=this[B],Re=this[B+7];(U===void 0||Re===void 0)&&Je(B,this.length-8);const nt=this[B+4]+this[B+5]*2**8+this[B+6]*2**16+(Re<<24);return(BigInt(nt)<<BigInt(32))+BigInt(U+this[++B]*2**8+this[++B]*2**16+this[++B]*2**24)}),d.prototype.readBigInt64BE=ts(function(B){B=B>>>0,ye(B,"offset");const U=this[B],Re=this[B+7];(U===void 0||Re===void 0)&&Je(B,this.length-8);const nt=(U<<24)+this[++B]*2**16+this[++B]*2**8+this[++B];return(BigInt(nt)<<BigInt(32))+BigInt(this[++B]*2**24+this[++B]*2**16+this[++B]*2**8+Re)}),d.prototype.readFloatLE=function(B,U){return B=B>>>0,U||Y(B,4,this.length),s.read(this,B,!0,23,4)},d.prototype.readFloatBE=function(B,U){return B=B>>>0,U||Y(B,4,this.length),s.read(this,B,!1,23,4)},d.prototype.readDoubleLE=function(B,U){return B=B>>>0,U||Y(B,8,this.length),s.read(this,B,!0,52,8)},d.prototype.readDoubleBE=function(B,U){return B=B>>>0,U||Y(B,8,this.length),s.read(this,B,!1,52,8)};function J(ue,B,U,Re,nt,gt){if(!d.isBuffer(ue))throw new TypeError('"buffer" argument must be a Buffer instance');if(B>nt||B<gt)throw new RangeError('"value" argument is out of bounds');if(U+Re>ue.length)throw new RangeError("Index out of range")}d.prototype.writeUintLE=d.prototype.writeUIntLE=function(B,U,Re,nt){if(B=+B,U=U>>>0,Re=Re>>>0,!nt){const Ds=Math.pow(2,8*Re)-1;J(this,B,U,Re,Ds,0)}let gt=1,kt=0;for(this[U]=B&255;++kt<Re&&(gt*=256);)this[U+kt]=B/gt&255;return U+Re},d.prototype.writeUintBE=d.prototype.writeUIntBE=function(B,U,Re,nt){if(B=+B,U=U>>>0,Re=Re>>>0,!nt){const Ds=Math.pow(2,8*Re)-1;J(this,B,U,Re,Ds,0)}let gt=Re-1,kt=1;for(this[U+gt]=B&255;--gt>=0&&(kt*=256);)this[U+gt]=B/kt&255;return U+Re},d.prototype.writeUint8=d.prototype.writeUInt8=function(B,U,Re){return B=+B,U=U>>>0,Re||J(this,B,U,1,255,0),this[U]=B&255,U+1},d.prototype.writeUint16LE=d.prototype.writeUInt16LE=function(B,U,Re){return B=+B,U=U>>>0,Re||J(this,B,U,2,65535,0),this[U]=B&255,this[U+1]=B>>>8,U+2},d.prototype.writeUint16BE=d.prototype.writeUInt16BE=function(B,U,Re){return B=+B,U=U>>>0,Re||J(this,B,U,2,65535,0),this[U]=B>>>8,this[U+1]=B&255,U+2},d.prototype.writeUint32LE=d.prototype.writeUInt32LE=function(B,U,Re){return B=+B,U=U>>>0,Re||J(this,B,U,4,4294967295,0),this[U+3]=B>>>24,this[U+2]=B>>>16,this[U+1]=B>>>8,this[U]=B&255,U+4},d.prototype.writeUint32BE=d.prototype.writeUInt32BE=function(B,U,Re){return B=+B,U=U>>>0,Re||J(this,B,U,4,4294967295,0),this[U]=B>>>24,this[U+1]=B>>>16,this[U+2]=B>>>8,this[U+3]=B&255,U+4};function he(ue,B,U,Re,nt){fe(B,Re,nt,ue,U,7);let gt=Number(B&BigInt(4294967295));ue[U++]=gt,gt=gt>>8,ue[U++]=gt,gt=gt>>8,ue[U++]=gt,gt=gt>>8,ue[U++]=gt;let kt=Number(B>>BigInt(32)&BigInt(4294967295));return ue[U++]=kt,kt=kt>>8,ue[U++]=kt,kt=kt>>8,ue[U++]=kt,kt=kt>>8,ue[U++]=kt,U}function be(ue,B,U,Re,nt){fe(B,Re,nt,ue,U,7);let gt=Number(B&BigInt(4294967295));ue[U+7]=gt,gt=gt>>8,ue[U+6]=gt,gt=gt>>8,ue[U+5]=gt,gt=gt>>8,ue[U+4]=gt;let kt=Number(B>>BigInt(32)&BigInt(4294967295));return ue[U+3]=kt,kt=kt>>8,ue[U+2]=kt,kt=kt>>8,ue[U+1]=kt,kt=kt>>8,ue[U]=kt,U+8}d.prototype.writeBigUInt64LE=ts(function(B,U=0){return he(this,B,U,BigInt(0),BigInt("0xffffffffffffffff"))}),d.prototype.writeBigUInt64BE=ts(function(B,U=0){return be(this,B,U,BigInt(0),BigInt("0xffffffffffffffff"))}),d.prototype.writeIntLE=function(B,U,Re,nt){if(B=+B,U=U>>>0,!nt){const tn=Math.pow(2,8*Re-1);J(this,B,U,Re,tn-1,-tn)}let gt=0,kt=1,Ds=0;for(this[U]=B&255;++gt<Re&&(kt*=256);)B<0&&Ds===0&&this[U+gt-1]!==0&&(Ds=1),this[U+gt]=(B/kt>>0)-Ds&255;return U+Re},d.prototype.writeIntBE=function(B,U,Re,nt){if(B=+B,U=U>>>0,!nt){const tn=Math.pow(2,8*Re-1);J(this,B,U,Re,tn-1,-tn)}let gt=Re-1,kt=1,Ds=0;for(this[U+gt]=B&255;--gt>=0&&(kt*=256);)B<0&&Ds===0&&this[U+gt+1]!==0&&(Ds=1),this[U+gt]=(B/kt>>0)-Ds&255;return U+Re},d.prototype.writeInt8=function(B,U,Re){return B=+B,U=U>>>0,Re||J(this,B,U,1,127,-128),B<0&&(B=255+B+1),this[U]=B&255,U+1},d.prototype.writeInt16LE=function(B,U,Re){return B=+B,U=U>>>0,Re||J(this,B,U,2,32767,-32768),this[U]=B&255,this[U+1]=B>>>8,U+2},d.prototype.writeInt16BE=function(B,U,Re){return B=+B,U=U>>>0,Re||J(this,B,U,2,32767,-32768),this[U]=B>>>8,this[U+1]=B&255,U+2},d.prototype.writeInt32LE=function(B,U,Re){return B=+B,U=U>>>0,Re||J(this,B,U,4,2147483647,-2147483648),this[U]=B&255,this[U+1]=B>>>8,this[U+2]=B>>>16,this[U+3]=B>>>24,U+4},d.prototype.writeInt32BE=function(B,U,Re){return B=+B,U=U>>>0,Re||J(this,B,U,4,2147483647,-2147483648),B<0&&(B=4294967295+B+1),this[U]=B>>>24,this[U+1]=B>>>16,this[U+2]=B>>>8,this[U+3]=B&255,U+4},d.prototype.writeBigInt64LE=ts(function(B,U=0){return he(this,B,U,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),d.prototype.writeBigInt64BE=ts(function(B,U=0){return be(this,B,U,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Ne(ue,B,U,Re,nt,gt){if(U+Re>ue.length)throw new RangeError("Index out of range");if(U<0)throw new RangeError("Index out of range")}function ke(ue,B,U,Re,nt){return B=+B,U=U>>>0,nt||Ne(ue,B,U,4),s.write(ue,B,U,Re,23,4),U+4}d.prototype.writeFloatLE=function(B,U,Re){return ke(this,B,U,!0,Re)},d.prototype.writeFloatBE=function(B,U,Re){return ke(this,B,U,!1,Re)};function qe(ue,B,U,Re,nt){return B=+B,U=U>>>0,nt||Ne(ue,B,U,8),s.write(ue,B,U,Re,52,8),U+8}d.prototype.writeDoubleLE=function(B,U,Re){return qe(this,B,U,!0,Re)},d.prototype.writeDoubleBE=function(B,U,Re){return qe(this,B,U,!1,Re)},d.prototype.copy=function(B,U,Re,nt){if(!d.isBuffer(B))throw new TypeError("argument should be a Buffer");if(Re||(Re=0),!nt&&nt!==0&&(nt=this.length),U>=B.length&&(U=B.length),U||(U=0),nt>0&&nt<Re&&(nt=Re),nt===Re||B.length===0||this.length===0)return 0;if(U<0)throw new RangeError("targetStart out of bounds");if(Re<0||Re>=this.length)throw new RangeError("Index out of range");if(nt<0)throw new RangeError("sourceEnd out of bounds");nt>this.length&&(nt=this.length),B.length-U<nt-Re&&(nt=B.length-U+Re);const gt=nt-Re;return this===B&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(U,Re,nt):Uint8Array.prototype.set.call(B,this.subarray(Re,nt),U),gt},d.prototype.fill=function(B,U,Re,nt){if(typeof B=="string"){if(typeof U=="string"?(nt=U,U=0,Re=this.length):typeof Re=="string"&&(nt=Re,Re=this.length),nt!==void 0&&typeof nt!="string")throw new TypeError("encoding must be a string");if(typeof nt=="string"&&!d.isEncoding(nt))throw new TypeError("Unknown encoding: "+nt);if(B.length===1){const kt=B.charCodeAt(0);(nt==="utf8"&&kt<128||nt==="latin1")&&(B=kt)}}else typeof B=="number"?B=B&255:typeof B=="boolean"&&(B=Number(B));if(U<0||this.length<U||this.length<Re)throw new RangeError("Out of range index");if(Re<=U)return this;U=U>>>0,Re=Re===void 0?this.length:Re>>>0,B||(B=0);let gt;if(typeof B=="number")for(gt=U;gt<Re;++gt)this[gt]=B;else{const kt=d.isBuffer(B)?B:d.from(B,nt),Ds=kt.length;if(Ds===0)throw new TypeError('The value "'+B+'" is invalid for argument "value"');for(gt=0;gt<Re-U;++gt)this[gt+U]=kt[gt%Ds]}return this};const ct={};function We(ue,B,U){ct[ue]=class extends U{constructor(){super(),Object.defineProperty(this,"message",{value:B.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${ue}]`,this.stack,delete this.name}get code(){return ue}set code(nt){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:nt,writable:!0})}toString(){return`${this.name} [${ue}]: ${this.message}`}}}We("ERR_BUFFER_OUT_OF_BOUNDS",function(ue){return ue?`${ue} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),We("ERR_INVALID_ARG_TYPE",function(ue,B){return`The "${ue}" argument must be of type number. Received type ${typeof B}`},TypeError),We("ERR_OUT_OF_RANGE",function(ue,B,U){let Re=`The value of "${ue}" is out of range.`,nt=U;return Number.isInteger(U)&&Math.abs(U)>2**32?nt=ht(String(U)):typeof U=="bigint"&&(nt=String(U),(U>BigInt(2)**BigInt(32)||U<-(BigInt(2)**BigInt(32)))&&(nt=ht(nt)),nt+="n"),Re+=` It must be ${B}. Received ${nt}`,Re},RangeError);function ht(ue){let B="",U=ue.length;const Re=ue[0]==="-"?1:0;for(;U>=Re+4;U-=3)B=`_${ue.slice(U-3,U)}${B}`;return`${ue.slice(0,U)}${B}`}function rt(ue,B,U){ye(B,"offset"),(ue[B]===void 0||ue[B+U]===void 0)&&Je(B,ue.length-(U+1))}function fe(ue,B,U,Re,nt,gt){if(ue>U||ue<B){const kt=typeof B=="bigint"?"n":"";let Ds;throw gt>3?B===0||B===BigInt(0)?Ds=`>= 0${kt} and < 2${kt} ** ${(gt+1)*8}${kt}`:Ds=`>= -(2${kt} ** ${(gt+1)*8-1}${kt}) and < 2 ** ${(gt+1)*8-1}${kt}`:Ds=`>= ${B}${kt} and <= ${U}${kt}`,new ct.ERR_OUT_OF_RANGE("value",Ds,ue)}rt(Re,nt,gt)}function ye(ue,B){if(typeof ue!="number")throw new ct.ERR_INVALID_ARG_TYPE(B,"number",ue)}function Je(ue,B,U){throw Math.floor(ue)!==ue?(ye(ue,U),new ct.ERR_OUT_OF_RANGE(U||"offset","an integer",ue)):B<0?new ct.ERR_BUFFER_OUT_OF_BOUNDS:new ct.ERR_OUT_OF_RANGE(U||"offset",`>= ${U?1:0} and <= ${B}`,ue)}const at=/[^+/0-9A-Za-z-_]/g;function it(ue){if(ue=ue.split("=")[0],ue=ue.trim().replace(at,""),ue.length<2)return"";for(;ue.length%4!==0;)ue=ue+"=";return ue}function Et(ue,B){B=B||1/0;let U;const Re=ue.length;let nt=null;const gt=[];for(let kt=0;kt<Re;++kt){if(U=ue.charCodeAt(kt),U>55295&&U<57344){if(!nt){if(U>56319){(B-=3)>-1&&gt.push(239,191,189);continue}else if(kt+1===Re){(B-=3)>-1&&gt.push(239,191,189);continue}nt=U;continue}if(U<56320){(B-=3)>-1&&gt.push(239,191,189),nt=U;continue}U=(nt-55296<<10|U-56320)+65536}else nt&&(B-=3)>-1&&gt.push(239,191,189);if(nt=null,U<128){if((B-=1)<0)break;gt.push(U)}else if(U<2048){if((B-=2)<0)break;gt.push(U>>6|192,U&63|128)}else if(U<65536){if((B-=3)<0)break;gt.push(U>>12|224,U>>6&63|128,U&63|128)}else if(U<1114112){if((B-=4)<0)break;gt.push(U>>18|240,U>>12&63|128,U>>6&63|128,U&63|128)}else throw new Error("Invalid code point")}return gt}function jt(ue){const B=[];for(let U=0;U<ue.length;++U)B.push(ue.charCodeAt(U)&255);return B}function Nt(ue,B){let U,Re,nt;const gt=[];for(let kt=0;kt<ue.length&&!((B-=2)<0);++kt)U=ue.charCodeAt(kt),Re=U>>8,nt=U%256,gt.push(nt),gt.push(Re);return gt}function St(ue){return t.toByteArray(it(ue))}function Ct(ue,B,U,Re){let nt;for(nt=0;nt<Re&&!(nt+U>=B.length||nt>=ue.length);++nt)B[nt+U]=ue[nt];return nt}function Bt(ue,B){return ue instanceof B||ue!=null&&ue.constructor!=null&&ue.constructor.name!=null&&ue.constructor.name===B.name}function Kt(ue){return ue!==ue}const ys=function(){const ue="0123456789abcdef",B=new Array(256);for(let U=0;U<16;++U){const Re=U*16;for(let nt=0;nt<16;++nt)B[Re+nt]=ue[U]+ue[nt]}return B}();function ts(ue){return typeof BigInt>"u"?Us:ue}function Us(){throw new Error("BigInt not supported")}})(FE);const UE=6371e3,VE=Math.PI/180,HN=Math.PI*3,vT=Math.PI*2,om=e=>e*VE,bT=e=>e/VE,tC=(e,t,s=Math.random)=>{const n=Math.sin(om(e.latitude)),r=Math.cos(om(e.latitude)),a=s()*vT,o=Math.sin(a),d=Math.cos(a),p=t/UE,y=Math.sin(p),v=Math.cos(p);let C,I;return C=Math.asin(n*v+r*y*d),I=om(e.longitude)+Math.atan2(o*y*r,v-n*Math.sin(C)),I=(I+HN)%vT-Math.PI,{latitude:bT(C),longitude:bT(I)}},GN=(e,t,s=Math.random)=>tC(e,Math.sqrt(s())*t,s),WN=(e,t,s,n=Math.random)=>{if(t>=s)throw new Error(`innerRadius (${t}) should be smaller than outerRadius (${s})`);const r=s-t;return tC(e,t+Math.sqrt(n())*r,n)},jE=(e,t)=>{const s={latitude:om(e.latitude),longitude:om(e.longitude)},n={latitude:om(t.latitude),longitude:om(t.longitude)},r={latitude:Math.sin((n.latitude-s.latitude)/2),longitude:Math.sin((n.longitude-s.longitude)/2)},a=r.latitude*r.latitude+r.longitude*r.longitude*Math.cos(s.latitude)*Math.cos(n.latitude),o=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return UE*o},YN=jE;var ZN={distance:jE,haversine:YN,randomCircumferencePoint:tC,randomCirclePoint:GN,randomAnnulusPoint:WN};function qE(e,t){return function(){return e.apply(t,arguments)}}const{toString:HE}=Object.prototype,{getPrototypeOf:sC}=Object,nC=(e=>t=>{const s=HE.call(t);return e[s]||(e[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),Ih=e=>(e=e.toLowerCase(),t=>nC(t)===e),rx=e=>t=>typeof t===e,{isArray:Dg}=Array,mv=rx("undefined");function XN(e){return e!==null&&!mv(e)&&e.constructor!==null&&!mv(e.constructor)&&Gp(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const GE=Ih("ArrayBuffer");function KN(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&GE(e.buffer),t}const JN=rx("string"),Gp=rx("function"),WE=rx("number"),rC=e=>e!==null&&typeof e=="object",QN=e=>e===!0||e===!1,U1=e=>{if(nC(e)!=="object")return!1;const t=sC(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},e3=Ih("Date"),t3=Ih("File"),s3=Ih("Blob"),n3=Ih("FileList"),r3=e=>rC(e)&&Gp(e.pipe),i3=e=>{const t="[object FormData]";return e&&(typeof FormData=="function"&&e instanceof FormData||HE.call(e)===t||Gp(e.toString)&&e.toString()===t)},o3=Ih("URLSearchParams"),a3=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Hv(e,t,{allOwnKeys:s=!1}={}){if(e===null||typeof e>"u")return;let n,r;if(typeof e!="object"&&(e=[e]),Dg(e))for(n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else{const a=s?Object.getOwnPropertyNames(e):Object.keys(e),o=a.length;let d;for(n=0;n<o;n++)d=a[n],t.call(null,e[d],d,e)}}function YE(e,t){t=t.toLowerCase();const s=Object.keys(e);let n=s.length,r;for(;n-- >0;)if(r=s[n],t===r.toLowerCase())return r;return null}const ZE=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),XE=e=>!mv(e)&&e!==ZE;function PS(){const{caseless:e}=XE(this)&&this||{},t={},s=(n,r)=>{const a=e&&YE(t,r)||r;U1(t[a])&&U1(n)?t[a]=PS(t[a],n):U1(n)?t[a]=PS({},n):Dg(n)?t[a]=n.slice():t[a]=n};for(let n=0,r=arguments.length;n<r;n++)arguments[n]&&Hv(arguments[n],s);return t}const l3=(e,t,s,{allOwnKeys:n}={})=>(Hv(t,(r,a)=>{s&&Gp(r)?e[a]=qE(r,s):e[a]=r},{allOwnKeys:n}),e),c3=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),u3=(e,t,s,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),s&&Object.assign(e.prototype,s)},d3=(e,t,s,n)=>{let r,a,o;const d={};if(t=t||{},e==null)return t;do{for(r=Object.getOwnPropertyNames(e),a=r.length;a-- >0;)o=r[a],(!n||n(o,e,t))&&!d[o]&&(t[o]=e[o],d[o]=!0);e=s!==!1&&sC(e)}while(e&&(!s||s(e,t))&&e!==Object.prototype);return t},h3=(e,t,s)=>{e=String(e),(s===void 0||s>e.length)&&(s=e.length),s-=t.length;const n=e.indexOf(t,s);return n!==-1&&n===s},p3=e=>{if(!e)return null;if(Dg(e))return e;let t=e.length;if(!WE(t))return null;const s=new Array(t);for(;t-- >0;)s[t]=e[t];return s},f3=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&sC(Uint8Array)),m3=(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let r;for(;(r=n.next())&&!r.done;){const a=r.value;t.call(e,a[0],a[1])}},_3=(e,t)=>{let s;const n=[];for(;(s=e.exec(t))!==null;)n.push(s);return n},g3=Ih("HTMLFormElement"),y3=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,n,r){return n.toUpperCase()+r}),xT=(({hasOwnProperty:e})=>(t,s)=>e.call(t,s))(Object.prototype),v3=Ih("RegExp"),KE=(e,t)=>{const s=Object.getOwnPropertyDescriptors(e),n={};Hv(s,(r,a)=>{t(r,a,e)!==!1&&(n[a]=r)}),Object.defineProperties(e,n)},b3=e=>{KE(e,(t,s)=>{if(Gp(e)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const n=e[s];if(!!Gp(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},x3=(e,t)=>{const s={},n=r=>{r.forEach(a=>{s[a]=!0})};return Dg(e)?n(e):n(String(e).split(t)),s},w3=()=>{},S3=(e,t)=>(e=+e,Number.isFinite(e)?e:t),jw="abcdefghijklmnopqrstuvwxyz",wT="0123456789",JE={DIGIT:wT,ALPHA:jw,ALPHA_DIGIT:jw+jw.toUpperCase()+wT},C3=(e=16,t=JE.ALPHA_DIGIT)=>{let s="";const{length:n}=t;for(;e--;)s+=t[Math.random()*n|0];return s};function I3(e){return!!(e&&Gp(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const T3=e=>{const t=new Array(10),s=(n,r)=>{if(rC(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[r]=n;const a=Dg(n)?[]:{};return Hv(n,(o,d)=>{const p=s(o,r+1);!mv(p)&&(a[d]=p)}),t[r]=void 0,a}}return n};return s(e,0)},qt={isArray:Dg,isArrayBuffer:GE,isBuffer:XN,isFormData:i3,isArrayBufferView:KN,isString:JN,isNumber:WE,isBoolean:QN,isObject:rC,isPlainObject:U1,isUndefined:mv,isDate:e3,isFile:t3,isBlob:s3,isRegExp:v3,isFunction:Gp,isStream:r3,isURLSearchParams:o3,isTypedArray:f3,isFileList:n3,forEach:Hv,merge:PS,extend:l3,trim:a3,stripBOM:c3,inherits:u3,toFlatObject:d3,kindOf:nC,kindOfTest:Ih,endsWith:h3,toArray:p3,forEachEntry:m3,matchAll:_3,isHTMLForm:g3,hasOwnProperty:xT,hasOwnProp:xT,reduceDescriptors:KE,freezeMethods:b3,toObjectSet:x3,toCamelCase:y3,noop:w3,toFiniteNumber:S3,findKey:YE,global:ZE,isContextDefined:XE,ALPHABET:JE,generateString:C3,isSpecCompliantForm:I3,toJSONObject:T3};function hr(e,t,s,n,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),s&&(this.config=s),n&&(this.request=n),r&&(this.response=r)}qt.inherits(hr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:qt.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const QE=hr.prototype,ek={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{ek[e]={value:e}});Object.defineProperties(hr,ek);Object.defineProperty(QE,"isAxiosError",{value:!0});hr.from=(e,t,s,n,r,a)=>{const o=Object.create(QE);return qt.toFlatObject(e,o,function(p){return p!==Error.prototype},d=>d!=="isAxiosError"),hr.call(o,e.message,t,s,n,r),o.cause=e,o.name=e.name,a&&Object.assign(o,a),o};const A3=null;function RS(e){return qt.isPlainObject(e)||qt.isArray(e)}function tk(e){return qt.endsWith(e,"[]")?e.slice(0,-2):e}function ST(e,t,s){return e?e.concat(t).map(function(r,a){return r=tk(r),!s&&a?"["+r+"]":r}).join(s?".":""):t}function M3(e){return qt.isArray(e)&&!e.some(RS)}const E3=qt.toFlatObject(qt,{},null,function(t){return/^is[A-Z]/.test(t)});function ix(e,t,s){if(!qt.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,s=qt.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(P,q){return!qt.isUndefined(q[P])});const n=s.metaTokens,r=s.visitor||v,a=s.dots,o=s.indexes,p=(s.Blob||typeof Blob<"u"&&Blob)&&qt.isSpecCompliantForm(t);if(!qt.isFunction(r))throw new TypeError("visitor must be a function");function y(A){if(A===null)return"";if(qt.isDate(A))return A.toISOString();if(!p&&qt.isBlob(A))throw new hr("Blob is not supported. Use a Buffer instead.");return qt.isArrayBuffer(A)||qt.isTypedArray(A)?p&&typeof Blob=="function"?new Blob([A]):Buffer.from(A):A}function v(A,P,q){let ce=A;if(A&&!q&&typeof A=="object"){if(qt.endsWith(P,"{}"))P=n?P:P.slice(0,-2),A=JSON.stringify(A);else if(qt.isArray(A)&&M3(A)||(qt.isFileList(A)||qt.endsWith(P,"[]"))&&(ce=qt.toArray(A)))return P=tk(P),ce.forEach(function(W,Ce){!(qt.isUndefined(W)||W===null)&&t.append(o===!0?ST([P],Ce,a):o===null?P:P+"[]",y(W))}),!1}return RS(A)?!0:(t.append(ST(q,P,a),y(A)),!1)}const C=[],I=Object.assign(E3,{defaultVisitor:v,convertValue:y,isVisitable:RS});function O(A,P){if(!qt.isUndefined(A)){if(C.indexOf(A)!==-1)throw Error("Circular reference detected in "+P.join("."));C.push(A),qt.forEach(A,function(ce,re){(!(qt.isUndefined(ce)||ce===null)&&r.call(t,ce,qt.isString(re)?re.trim():re,P,I))===!0&&O(ce,P?P.concat(re):[re])}),C.pop()}}if(!qt.isObject(e))throw new TypeError("data must be an object");return O(e),t}function CT(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function iC(e,t){this._pairs=[],e&&ix(e,this,t)}const sk=iC.prototype;sk.append=function(t,s){this._pairs.push([t,s])};sk.toString=function(t){const s=t?function(n){return t.call(this,n,CT)}:CT;return this._pairs.map(function(r){return s(r[0])+"="+s(r[1])},"").join("&")};function k3(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function nk(e,t,s){if(!t)return e;const n=s&&s.encode||k3,r=s&&s.serialize;let a;if(r?a=r(t,s):a=qt.isURLSearchParams(t)?t.toString():new iC(t,s).toString(n),a){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class P3{constructor(){this.handlers=[]}use(t,s,n){return this.handlers.push({fulfilled:t,rejected:s,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){qt.forEach(this.handlers,function(n){n!==null&&t(n)})}}const IT=P3,rk={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},R3=typeof URLSearchParams<"u"?URLSearchParams:iC,$3=typeof FormData<"u"?FormData:null,O3=typeof Blob<"u"?Blob:null,L3=(()=>{let e;return typeof navigator<"u"&&((e=navigator.product)==="ReactNative"||e==="NativeScript"||e==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),N3=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),nd={isBrowser:!0,classes:{URLSearchParams:R3,FormData:$3,Blob:O3},isStandardBrowserEnv:L3,isStandardBrowserWebWorkerEnv:N3,protocols:["http","https","file","blob","url","data"]};function D3(e,t){return ix(e,new nd.classes.URLSearchParams,Object.assign({visitor:function(s,n,r,a){return nd.isNode&&qt.isBuffer(s)?(this.append(n,s.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},t))}function B3(e){return qt.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function F3(e){const t={},s=Object.keys(e);let n;const r=s.length;let a;for(n=0;n<r;n++)a=s[n],t[a]=e[a];return t}function ik(e){function t(s,n,r,a){let o=s[a++];const d=Number.isFinite(+o),p=a>=s.length;return o=!o&&qt.isArray(r)?r.length:o,p?(qt.hasOwnProp(r,o)?r[o]=[r[o],n]:r[o]=n,!d):((!r[o]||!qt.isObject(r[o]))&&(r[o]=[]),t(s,n,r[o],a)&&qt.isArray(r[o])&&(r[o]=F3(r[o])),!d)}if(qt.isFormData(e)&&qt.isFunction(e.entries)){const s={};return qt.forEachEntry(e,(n,r)=>{t(B3(n),r,s,0)}),s}return null}const z3={"Content-Type":void 0};function U3(e,t,s){if(qt.isString(e))try{return(t||JSON.parse)(e),qt.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(s||JSON.stringify)(e)}const ox={transitional:rk,adapter:["xhr","http"],transformRequest:[function(t,s){const n=s.getContentType()||"",r=n.indexOf("application/json")>-1,a=qt.isObject(t);if(a&&qt.isHTMLForm(t)&&(t=new FormData(t)),qt.isFormData(t))return r&&r?JSON.stringify(ik(t)):t;if(qt.isArrayBuffer(t)||qt.isBuffer(t)||qt.isStream(t)||qt.isFile(t)||qt.isBlob(t))return t;if(qt.isArrayBufferView(t))return t.buffer;if(qt.isURLSearchParams(t))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let d;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return D3(t,this.formSerializer).toString();if((d=qt.isFileList(t))||n.indexOf("multipart/form-data")>-1){const p=this.env&&this.env.FormData;return ix(d?{"files[]":t}:t,p&&new p,this.formSerializer)}}return a||r?(s.setContentType("application/json",!1),U3(t)):t}],transformResponse:[function(t){const s=this.transitional||ox.transitional,n=s&&s.forcedJSONParsing,r=this.responseType==="json";if(t&&qt.isString(t)&&(n&&!this.responseType||r)){const o=!(s&&s.silentJSONParsing)&&r;try{return JSON.parse(t)}catch(d){if(o)throw d.name==="SyntaxError"?hr.from(d,hr.ERR_BAD_RESPONSE,this,null,this.response):d}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:nd.classes.FormData,Blob:nd.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};qt.forEach(["delete","get","head"],function(t){ox.headers[t]={}});qt.forEach(["post","put","patch"],function(t){ox.headers[t]=qt.merge(z3)});const oC=ox,V3=qt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),j3=e=>{const t={};let s,n,r;return e&&e.split(`
`).forEach(function(o){r=o.indexOf(":"),s=o.substring(0,r).trim().toLowerCase(),n=o.substring(r+1).trim(),!(!s||t[s]&&V3[s])&&(s==="set-cookie"?t[s]?t[s].push(n):t[s]=[n]:t[s]=t[s]?t[s]+", "+n:n)}),t},TT=Symbol("internals");function Oy(e){return e&&String(e).trim().toLowerCase()}function V1(e){return e===!1||e==null?e:qt.isArray(e)?e.map(V1):String(e)}function q3(e){const t=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=s.exec(e);)t[n[1]]=n[2];return t}function H3(e){return/^[-_a-zA-Z]+$/.test(e.trim())}function qw(e,t,s,n,r){if(qt.isFunction(n))return n.call(this,t,s);if(r&&(t=s),!!qt.isString(t)){if(qt.isString(n))return t.indexOf(n)!==-1;if(qt.isRegExp(n))return n.test(t)}}function G3(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,s,n)=>s.toUpperCase()+n)}function W3(e,t){const s=qt.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+s,{value:function(r,a,o){return this[n].call(this,t,r,a,o)},configurable:!0})})}class ax{constructor(t){t&&this.set(t)}set(t,s,n){const r=this;function a(d,p,y){const v=Oy(p);if(!v)throw new Error("header name must be a non-empty string");const C=qt.findKey(r,v);(!C||r[C]===void 0||y===!0||y===void 0&&r[C]!==!1)&&(r[C||p]=V1(d))}const o=(d,p)=>qt.forEach(d,(y,v)=>a(y,v,p));return qt.isPlainObject(t)||t instanceof this.constructor?o(t,s):qt.isString(t)&&(t=t.trim())&&!H3(t)?o(j3(t),s):t!=null&&a(s,t,n),this}get(t,s){if(t=Oy(t),t){const n=qt.findKey(this,t);if(n){const r=this[n];if(!s)return r;if(s===!0)return q3(r);if(qt.isFunction(s))return s.call(this,r,n);if(qt.isRegExp(s))return s.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,s){if(t=Oy(t),t){const n=qt.findKey(this,t);return!!(n&&this[n]!==void 0&&(!s||qw(this,this[n],n,s)))}return!1}delete(t,s){const n=this;let r=!1;function a(o){if(o=Oy(o),o){const d=qt.findKey(n,o);d&&(!s||qw(n,n[d],d,s))&&(delete n[d],r=!0)}}return qt.isArray(t)?t.forEach(a):a(t),r}clear(t){const s=Object.keys(this);let n=s.length,r=!1;for(;n--;){const a=s[n];(!t||qw(this,this[a],a,t,!0))&&(delete this[a],r=!0)}return r}normalize(t){const s=this,n={};return qt.forEach(this,(r,a)=>{const o=qt.findKey(n,a);if(o){s[o]=V1(r),delete s[a];return}const d=t?G3(a):String(a).trim();d!==a&&delete s[a],s[d]=V1(r),n[d]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const s=Object.create(null);return qt.forEach(this,(n,r)=>{n!=null&&n!==!1&&(s[r]=t&&qt.isArray(n)?n.join(", "):n)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,s])=>t+": "+s).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...s){const n=new this(t);return s.forEach(r=>n.set(r)),n}static accessor(t){const n=(this[TT]=this[TT]={accessors:{}}).accessors,r=this.prototype;function a(o){const d=Oy(o);n[d]||(W3(r,o),n[d]=!0)}return qt.isArray(t)?t.forEach(a):a(t),this}}ax.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);qt.freezeMethods(ax.prototype);qt.freezeMethods(ax);const fh=ax;function Hw(e,t){const s=this||oC,n=t||s,r=fh.from(n.headers);let a=n.data;return qt.forEach(e,function(d){a=d.call(s,a,r.normalize(),t?t.status:void 0)}),r.normalize(),a}function ok(e){return!!(e&&e.__CANCEL__)}function Gv(e,t,s){hr.call(this,e==null?"canceled":e,hr.ERR_CANCELED,t,s),this.name="CanceledError"}qt.inherits(Gv,hr,{__CANCEL__:!0});function Y3(e,t,s){const n=s.config.validateStatus;!s.status||!n||n(s.status)?e(s):t(new hr("Request failed with status code "+s.status,[hr.ERR_BAD_REQUEST,hr.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}const Z3=nd.isStandardBrowserEnv?function(){return{write:function(s,n,r,a,o,d){const p=[];p.push(s+"="+encodeURIComponent(n)),qt.isNumber(r)&&p.push("expires="+new Date(r).toGMTString()),qt.isString(a)&&p.push("path="+a),qt.isString(o)&&p.push("domain="+o),d===!0&&p.push("secure"),document.cookie=p.join("; ")},read:function(s){const n=document.cookie.match(new RegExp("(^|;\\s*)("+s+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove:function(s){this.write(s,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function X3(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function K3(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}function ak(e,t){return e&&!X3(t)?K3(e,t):t}const J3=nd.isStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),s=document.createElement("a");let n;function r(a){let o=a;return t&&(s.setAttribute("href",o),o=s.href),s.setAttribute("href",o),{href:s.href,protocol:s.protocol?s.protocol.replace(/:$/,""):"",host:s.host,search:s.search?s.search.replace(/^\?/,""):"",hash:s.hash?s.hash.replace(/^#/,""):"",hostname:s.hostname,port:s.port,pathname:s.pathname.charAt(0)==="/"?s.pathname:"/"+s.pathname}}return n=r(window.location.href),function(o){const d=qt.isString(o)?r(o):o;return d.protocol===n.protocol&&d.host===n.host}}():function(){return function(){return!0}}();function Q3(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function e4(e,t){e=e||10;const s=new Array(e),n=new Array(e);let r=0,a=0,o;return t=t!==void 0?t:1e3,function(p){const y=Date.now(),v=n[a];o||(o=y),s[r]=p,n[r]=y;let C=a,I=0;for(;C!==r;)I+=s[C++],C=C%e;if(r=(r+1)%e,r===a&&(a=(a+1)%e),y-o<t)return;const O=v&&y-v;return O?Math.round(I*1e3/O):void 0}}function AT(e,t){let s=0;const n=e4(50,250);return r=>{const a=r.loaded,o=r.lengthComputable?r.total:void 0,d=a-s,p=n(d),y=a<=o;s=a;const v={loaded:a,total:o,progress:o?a/o:void 0,bytes:d,rate:p||void 0,estimated:p&&o&&y?(o-a)/p:void 0,event:r};v[t?"download":"upload"]=!0,e(v)}}const t4=typeof XMLHttpRequest<"u",s4=t4&&function(e){return new Promise(function(s,n){let r=e.data;const a=fh.from(e.headers).normalize(),o=e.responseType;let d;function p(){e.cancelToken&&e.cancelToken.unsubscribe(d),e.signal&&e.signal.removeEventListener("abort",d)}qt.isFormData(r)&&(nd.isStandardBrowserEnv||nd.isStandardBrowserWebWorkerEnv)&&a.setContentType(!1);let y=new XMLHttpRequest;if(e.auth){const O=e.auth.username||"",A=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";a.set("Authorization","Basic "+btoa(O+":"+A))}const v=ak(e.baseURL,e.url);y.open(e.method.toUpperCase(),nk(v,e.params,e.paramsSerializer),!0),y.timeout=e.timeout;function C(){if(!y)return;const O=fh.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),P={data:!o||o==="text"||o==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:O,config:e,request:y};Y3(function(ce){s(ce),p()},function(ce){n(ce),p()},P),y=null}if("onloadend"in y?y.onloadend=C:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(C)},y.onabort=function(){!y||(n(new hr("Request aborted",hr.ECONNABORTED,e,y)),y=null)},y.onerror=function(){n(new hr("Network Error",hr.ERR_NETWORK,e,y)),y=null},y.ontimeout=function(){let A=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const P=e.transitional||rk;e.timeoutErrorMessage&&(A=e.timeoutErrorMessage),n(new hr(A,P.clarifyTimeoutError?hr.ETIMEDOUT:hr.ECONNABORTED,e,y)),y=null},nd.isStandardBrowserEnv){const O=(e.withCredentials||J3(v))&&e.xsrfCookieName&&Z3.read(e.xsrfCookieName);O&&a.set(e.xsrfHeaderName,O)}r===void 0&&a.setContentType(null),"setRequestHeader"in y&&qt.forEach(a.toJSON(),function(A,P){y.setRequestHeader(P,A)}),qt.isUndefined(e.withCredentials)||(y.withCredentials=!!e.withCredentials),o&&o!=="json"&&(y.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&y.addEventListener("progress",AT(e.onDownloadProgress,!0)),typeof e.onUploadProgress=="function"&&y.upload&&y.upload.addEventListener("progress",AT(e.onUploadProgress)),(e.cancelToken||e.signal)&&(d=O=>{!y||(n(!O||O.type?new Gv(null,e,y):O),y.abort(),y=null)},e.cancelToken&&e.cancelToken.subscribe(d),e.signal&&(e.signal.aborted?d():e.signal.addEventListener("abort",d)));const I=Q3(v);if(I&&nd.protocols.indexOf(I)===-1){n(new hr("Unsupported protocol "+I+":",hr.ERR_BAD_REQUEST,e));return}y.send(r||null)})},j1={http:A3,xhr:s4};qt.forEach(j1,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const n4={getAdapter:e=>{e=qt.isArray(e)?e:[e];const{length:t}=e;let s,n;for(let r=0;r<t&&(s=e[r],!(n=qt.isString(s)?j1[s.toLowerCase()]:s));r++);if(!n)throw n===!1?new hr(`Adapter ${s} is not supported by the environment`,"ERR_NOT_SUPPORT"):new Error(qt.hasOwnProp(j1,s)?`Adapter '${s}' is not available in the build`:`Unknown adapter '${s}'`);if(!qt.isFunction(n))throw new TypeError("adapter is not a function");return n},adapters:j1};function Gw(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Gv(null,e)}function MT(e){return Gw(e),e.headers=fh.from(e.headers),e.data=Hw.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),n4.getAdapter(e.adapter||oC.adapter)(e).then(function(n){return Gw(e),n.data=Hw.call(e,e.transformResponse,n),n.headers=fh.from(n.headers),n},function(n){return ok(n)||(Gw(e),n&&n.response&&(n.response.data=Hw.call(e,e.transformResponse,n.response),n.response.headers=fh.from(n.response.headers))),Promise.reject(n)})}const ET=e=>e instanceof fh?e.toJSON():e;function gg(e,t){t=t||{};const s={};function n(y,v,C){return qt.isPlainObject(y)&&qt.isPlainObject(v)?qt.merge.call({caseless:C},y,v):qt.isPlainObject(v)?qt.merge({},v):qt.isArray(v)?v.slice():v}function r(y,v,C){if(qt.isUndefined(v)){if(!qt.isUndefined(y))return n(void 0,y,C)}else return n(y,v,C)}function a(y,v){if(!qt.isUndefined(v))return n(void 0,v)}function o(y,v){if(qt.isUndefined(v)){if(!qt.isUndefined(y))return n(void 0,y)}else return n(void 0,v)}function d(y,v,C){if(C in t)return n(y,v);if(C in e)return n(void 0,y)}const p={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:d,headers:(y,v)=>r(ET(y),ET(v),!0)};return qt.forEach(Object.keys(e).concat(Object.keys(t)),function(v){const C=p[v]||r,I=C(e[v],t[v],v);qt.isUndefined(I)&&C!==d||(s[v]=I)}),s}const lk="1.3.4",aC={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{aC[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const kT={};aC.transitional=function(t,s,n){function r(a,o){return"[Axios v"+lk+"] Transitional option '"+a+"'"+o+(n?". "+n:"")}return(a,o,d)=>{if(t===!1)throw new hr(r(o," has been removed"+(s?" in "+s:"")),hr.ERR_DEPRECATED);return s&&!kT[o]&&(kT[o]=!0,console.warn(r(o," has been deprecated since v"+s+" and will be removed in the near future"))),t?t(a,o,d):!0}};function r4(e,t,s){if(typeof e!="object")throw new hr("options must be an object",hr.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let r=n.length;for(;r-- >0;){const a=n[r],o=t[a];if(o){const d=e[a],p=d===void 0||o(d,a,e);if(p!==!0)throw new hr("option "+a+" must be "+p,hr.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new hr("Unknown option "+a,hr.ERR_BAD_OPTION)}}const $S={assertOptions:r4,validators:aC},wp=$S.validators;class fb{constructor(t){this.defaults=t,this.interceptors={request:new IT,response:new IT}}request(t,s){typeof t=="string"?(s=s||{},s.url=t):s=t||{},s=gg(this.defaults,s);const{transitional:n,paramsSerializer:r,headers:a}=s;n!==void 0&&$S.assertOptions(n,{silentJSONParsing:wp.transitional(wp.boolean),forcedJSONParsing:wp.transitional(wp.boolean),clarifyTimeoutError:wp.transitional(wp.boolean)},!1),r!==void 0&&$S.assertOptions(r,{encode:wp.function,serialize:wp.function},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let o;o=a&&qt.merge(a.common,a[s.method]),o&&qt.forEach(["delete","get","head","post","put","patch","common"],A=>{delete a[A]}),s.headers=fh.concat(o,a);const d=[];let p=!0;this.interceptors.request.forEach(function(P){typeof P.runWhen=="function"&&P.runWhen(s)===!1||(p=p&&P.synchronous,d.unshift(P.fulfilled,P.rejected))});const y=[];this.interceptors.response.forEach(function(P){y.push(P.fulfilled,P.rejected)});let v,C=0,I;if(!p){const A=[MT.bind(this),void 0];for(A.unshift.apply(A,d),A.push.apply(A,y),I=A.length,v=Promise.resolve(s);C<I;)v=v.then(A[C++],A[C++]);return v}I=d.length;let O=s;for(C=0;C<I;){const A=d[C++],P=d[C++];try{O=A(O)}catch(q){P.call(this,q);break}}try{v=MT.call(this,O)}catch(A){return Promise.reject(A)}for(C=0,I=y.length;C<I;)v=v.then(y[C++],y[C++]);return v}getUri(t){t=gg(this.defaults,t);const s=ak(t.baseURL,t.url);return nk(s,t.params,t.paramsSerializer)}}qt.forEach(["delete","get","head","options"],function(t){fb.prototype[t]=function(s,n){return this.request(gg(n||{},{method:t,url:s,data:(n||{}).data}))}});qt.forEach(["post","put","patch"],function(t){function s(n){return function(a,o,d){return this.request(gg(d||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:o}))}}fb.prototype[t]=s(),fb.prototype[t+"Form"]=s(!0)});const q1=fb;class lC{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(a){s=a});const n=this;this.promise.then(r=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](r);n._listeners=null}),this.promise.then=r=>{let a;const o=new Promise(d=>{n.subscribe(d),a=d}).then(r);return o.cancel=function(){n.unsubscribe(a)},o},t(function(a,o,d){n.reason||(n.reason=new Gv(a,o,d),s(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const s=this._listeners.indexOf(t);s!==-1&&this._listeners.splice(s,1)}static source(){let t;return{token:new lC(function(r){t=r}),cancel:t}}}const i4=lC;function o4(e){return function(s){return e.apply(null,s)}}function a4(e){return qt.isObject(e)&&e.isAxiosError===!0}const OS={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(OS).forEach(([e,t])=>{OS[t]=e});const l4=OS;function ck(e){const t=new q1(e),s=qE(q1.prototype.request,t);return qt.extend(s,q1.prototype,t,{allOwnKeys:!0}),qt.extend(s,t,null,{allOwnKeys:!0}),s.create=function(r){return ck(gg(e,r))},s}const So=ck(oC);So.Axios=q1;So.CanceledError=Gv;So.CancelToken=i4;So.isCancel=ok;So.VERSION=lk;So.toFormData=ix;So.AxiosError=hr;So.Cancel=So.CanceledError;So.all=function(t){return Promise.all(t)};So.spread=o4;So.isAxiosError=a4;So.mergeConfig=gg;So.AxiosHeaders=fh;So.formToJSON=e=>ik(qt.isHTMLForm(e)?new FormData(e):e);So.HttpStatusCode=l4;So.default=So;const ui=So,PT=function(){this.keys=new Map,this.childCount=0,this.end=!1,this.setEnd=function(){this.end=!0},this.isEnd=function(){return this.end}},c4=function(){this.root=new PT,this.add=function(e,t=this.root){if(e.length===0){t.setEnd();return}return t.childCount++,t.keys.has(e[0])?this.add(e.substr(1),t.keys.get(e[0])):(t.keys.set(e[0],new PT),this.add(e.substr(1),t.keys.get(e[0])))},this.countChildren=function(e){let t=this.findNode(e);return t===!1?-1:t.childCount},this.isWord=function(e){let t=this.root;for(;e.length>1;){if(!t.keys.has(e[0]))return!1;t=t.keys.get(e[0]),e=e.substr(1)}return!!(t.keys.has(e)&&t.keys.get(e).isEnd())},this.findNode=e=>{let t=this.root;for(;e.length>1;){if(!t.keys.has(e[0]))return!1;t=t.keys.get(e[0]),e=e.substr(1)}return t.keys.get(e)?t.keys.get(e):!1},this.prefixMatchingWords=e=>{const t=new Array;let s=this.findNode(e);if(!s)return t;if(s.childCount===0)return[e];const n=function(r,a){if(r.keys.size!=0){for(const o of r.keys.keys())n(r.keys.get(o),a.concat(o));r.isEnd()&&t.push(a)}else a.length>0&&t.push(a)};return n(s,new String),t.length>0?t.map(r=>`${e}${r}`):[]},this.countDirectChildren=function(e){let t=this.root;for(;e.length>1;){if(!t.keys.has(e[0]))return!1;t=t.keys.get(e[0]),e=e.substr(1)}return t.keys.has(e)?t.keys.get(e).isEnd()?0:t.keys.get(e).keys.size:!1},this.print=function(){const e=new Array,t=function(s,n){if(s.keys.size!=0){for(const r of s.keys.keys())t(s.keys.get(r),n.concat(r));s.isEnd()&&e.push(n)}else n.length>0&&e.push(n)};return t(this.root,new String),e.length>0?e:mo}},Ww={Trie:c4},Vn=()=>{function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return`${e()}${e()}-${e()}-${e()}-${e()}-${e()}${e()}${e()}`},u4=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),uk=(e,t)=>{const s=[];return t.forEach(n=>{u4(e,n)||s.push(n)}),s},d4={Circle:{label:"Circle",marker:"\u25CF",svg:`
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52" width="1.0rem" height="1.0rem">
                <circle r="24" cy="26" cx="26" style="fill:#706e6b;stroke:#706e6b;stroke-width:3.847;stroke-linejoin:round;fill-opacity:1;stroke-opacity:1"/>
            </svg>
        `},Square:{label:"Square",marker:"\u25A0",svg:`
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52" width="1.0rem" height="1.0rem">
                <path style="fill:#706e6b;fill-opacity:1;stroke:#706e6b;stroke-width:3.77953;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="M1.889765 1.889765h48v48h-48z"/>
            </svg>
        `},Pyramid:{label:"Pyramid",marker:"\u25B2",svg:`
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52" width="1.0rem" height="1.0rem">
                <path  d="M52 52 25 0 0 52Z" style="fill:#706e6b;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;fill-opacity:1"/>
            </svg>
        `},Triangle:{label:"Triangle",marker:"\u25BC",svg:`
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52" width="1.0rem" height="1.0rem">
                <path d="m0 0 27 52L52 0Z" style="fill:#706e6b;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"/>
            </svg>
        `},Diamond:{label:"Diamond",marker:"\u25C6",svg:`
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52" width="1.0rem" height="1.0rem">
                <path d="M26 0 0 26l26 26 26-26Z" style="fill:#706e6b;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;fill-opacity:1"/>
            </svg>
        `},Star:{label:"Star",marker:"\u2605",svg:`
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52" width="1.0rem" height="1.0rem">
                <path transform="matrix(1.04945 0 0 1.10341 -.23623862 1.1584795)" d="m25.000001 0 7.347315 14.887288 16.429097 2.387288-11.888207 11.588136 2.806425 16.362713L25 37.5l-14.694632 7.725424 2.806426-16.362712L1.2235873 17.274575l16.4290967-2.387287Z" style="fill:#706e6b;fill-rule:evenodd;stroke:#706e6b;stroke-width:.929286;stroke-opacity:1;fill-opacity:1"/>
            </svg>
        `},Parallelogram:{label:"Parallelogram",marker:"\u25B0",svg:`
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52" width="1.0rem" height="1.0rem">
                <path d="M52-2.6e-7H10L0 51.999999h43z" style="fill:#706e6b;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"/>
            </svg>
        `},Rectangle:{label:"Rectangle",marker:"\u25AC",svg:`
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52" width="1.0rem" height="1.0rem">
                <path d="M52 10H0v32h52z" style="fill:#706e6b;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"/>
            </svg>
        `},Box:{label:"Box",marker:"\u25AE",svg:`
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52" width="1.0rem" height="1.0rem">
                <path d="M43 0 10-2.6e-7V52l33-.000001z" style="fill:#706e6b;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"/>
            </svg>
        `}},h4=Object.freeze(Object.defineProperty({__proto__:null,Symbols:d4},Symbol.toStringTag,{value:"Module"}));function p4({Buffer:e,Papa:t}={}){const s={toSaql(p,y){const v=p.sfsp__SalesNodeRuleItems__r.map(C=>n.toSaql({field:C.sfsp__Field__c,operator:C.sfsp__Operator__c,value:C.sfsp__Value__c,dataType:y._referenceFields.find(I=>I.id===C.sfsp__Field__c).dataType==="Numeric"?"Numeric":"Text"}));return n.mergeBooleanFilter(p.sfsp__BooleanFilter__c,v)}},n={mergeBooleanFilter(p,y){p=p.toLowerCase().replaceAll(" and "," && ").replaceAll(" or "," || ");let v="",C="";for(let I=0;I<p.length;I++){const O=p[I];if(/[0-9]/.test(O)){C+=O;continue}C&&(v+=y[parseInt(C)-1],C=""),v+=O}return C&&(v+=y[parseInt(C)-1]),v},toSaql(p){const{field:y,operator:v,value:C="",dataType:I}=p;if(I==="Text"){let O=C.split(",");switch(O=O.map(A=>A.trimStart()),v){case"==":return O.length>1?O.some(A=>!A)?`(${y} in ["${O.join('","')}"] || ${y} is null)`:`${y} in ["${O.join('","')}"]`:C?`${y} == "${C}"`:`(${y} == "" || ${y} is null)`;case"!=":return O.length>1?O.some(A=>!A)?`(${y} not in ["${O.join('","')}"] && ${y} is not null)`:`${y} not in ["${O.join('","')}"]`:C?`${y} != "${C}"`:`(${y} != "" && ${y} is not null)`;case"like":return O.length>1?`(${O.map(A=>`${y} like "%${A}%"`).join(" || ")})`:`${y} like "%${C}%"`;case"startsWith":return O.length>1?`(${O.map(A=>`${y} like "${A}%"`).join(" || ")})`:`${y} like "${C}%"`;case"doesnotcontain":return O.length>1?`(${O.map(A=>`!(${y} matches "${A}")`).join(" && ")})`:`!(${y} matches "${C}")`;default:return`${y} ${v} "${C}"`}}else switch(v){case"between":const[O,A]=C.split(",");return`(${y} >= ${O} && ${y} <= ${A})`;default:return`${y} ${v} ${C}`}}},r={defaults:()=>({sobjectType:"sfsp__SalesNode__c",Name:"",sfsp__SalesNodes__r:[],sfsp__SalesNodeRules__r:[],sfsp__RuleLogics__c:""}),getDataSetCountSaql({datasetId:p,versionId:y}){return`
                -- load records
                q = load "${p}/${y}";
    
                -- results
                results = group q by all;
                results = foreach results generate count() as count;
            `},generateHierarchySaql({node:p,nodeMap:y,dataSource:v,fields:C=[]}){return p._parentId?`
                -- ${p.Name}
                ${p.Id} = filter ${p._parentId} by ${this.generateRules({node:p,nodeMap:y,dataSource:v,uniqueIdField:v._referenceFields.find(I=>I.isId).id})};
                ${p.sfsp__SalesNodes__r.map(I=>this.generateHierarchySaql({node:I,nodeMap:y,dataSource:v,fields:C})).join("")}`:`
                    ------------------------------------
                    -- Records
                    ------------------------------------
                    q = load "${v._dataset.id}/${v._dataset.currentVersionId}";
    
                    ------------------------------------
                    -- Filters
                    ------------------------------------
    
                    -- all org
                    all_org = group q by all;
                    ${p.sfsp__SalesNodes__r.map(I=>this.generateHierarchySaql({node:I,nodeMap:y,dataSource:v,fields:C})).join("")}
    
                    ------------------------------------
                    -- Projections
                    ------------------------------------
                    ${Object.keys(y).map(I=>`
                        ${I} = group ${I} by all;
                        ${I} = foreach ${I} generate ${[`"${I}" as __NodeId`,"count() as __Records",...C.map(O=>`sum(${O}) as ${O}`)].join(", ")};
                    `).join("")}
    
                    ------------------------------------
                    -- Results
                    ------------------------------------
                    ${Object.keys(y).length>1?`results = union ${Object.keys(y).join(", ")};`:`results = limit ${Object.keys(y)[0]} 1;`}
                `.replace(/^ */gm,"")},generateNodeFilterSaql({node:p,nodeMap:y,dataSource:v,descendantFilters:C=[],isBurndown:I=!1}){return C.push(this.generateRules({node:p,nodeMap:y,dataSource:v,uniqueIdField:v._referenceFields.find(O=>O.isId).id,isBurndown:I})),p._parentId?this.generateNodeFilterSaql({node:y[p._parentId],nodeMap:y,dataSource:v,descendantFilters:C}):`
                    -- load records
                    q = load "${v._dataset.id}/${v._dataset.currentVersionId}";
    
                    -- filters
                    results = filter q by (${C.join(") && (")});
                `},generateRules({node:p,nodeMap:y,dataSource:v,uniqueIdField:C,isBurndown:I}){const O=I?p.sfsp__SalesNodes__r:[];if(p.sfsp__SalesNodeRules__r.length===0&&O.length===0)return`${C} ${p.Id==="all_org"?"is not null":"is null"}`;const A=[];if(p.sfsp__SalesNodeRules__r.length){const P=this.getRuleLogic({node:p}),q=n.mergeBooleanFilter(P,p.sfsp__SalesNodeRules__r.map(ce=>s.toSaql(ce,v)));A.push(`(${q})`)}if(O.length){const P=O.map(q=>`(${this.generateRules({node:q,nodeMap:y,dataSource:v,uniqueIdField:C})})`);A.push(`!(${P.join(" || ")})`)}return A.join(" && ")},getRuleLogic({node:p}){const y=p.sfsp__RuleLogics__c;return y||(p.sfsp__SalesNodeRules__r.length===0?"":Array(p.sfsp__SalesNodeRules__r.length).fill().map((v,C)=>C+1).join(" or "))},setRuleLogic({node:p,logic:y}){p.sfsp__RuleLogics__c=y},async buildNodeMap({nodeId:p}){const y={all_org:{...SPM.Utils.Segment.Node.defaults(),Id:"all_org",Name:"All Org"}},v=async I=>{let[O]=await SPM.Utils.Apex.invoke("Query",[`
                    SELECT
                        Id,
                        Name,
                        sfsp__SalesPlan__c,
                        sfsp__Parent__c,
                        ${Array(5).fill().map((A,P)=>{const q=Array(P+1).fill().map(()=>"sfsp__Parent__r").join(".");return`
                                ${q}.Name,
                                ${q}.sfsp__Parent__c,
                                ${q}.sfsp__RuleLogics__c,
                            `}).join("")}
                        sfsp__RuleLogics__c
                    FROM sfsp__SalesNode__c
                    WHERE Id = '${I}'
                `]);for(;O;)y[O.Id]={...SPM.Utils.Segment.Node.defaults(),...O,_parentId:O.sfsp__Parent__c||"all_org"},O.sfsp__Parent__c&&!O.sfsp__Parent__r&&await v(O.sfsp__Parent__c),O=O.sfsp__Parent__r};return await v(p),(await SPM.Utils.Apex.invoke("Query",[`
                SELECT
                    Id, Name, sfsp__SalesNode__c, sfsp__FilterLogic__c, sfsp__BooleanFilter__c,
                    (
                        SELECT Id, sfsp__SalesNodeRule__r.sfsp__SalesNode__c, sfsp__Field__c, sfsp__Operator__c, sfsp__Value__c
                        FROM sfsp__SalesNodeRuleItems__r
                        ORDER BY sfsp__SortOrder__c
                    )
                FROM sfsp__SalesNodeRule__c
                WHERE sfsp__SalesNode__c IN ('${Object.keys(y).filter(I=>I!=="all_org").join("','")}')
                ORDER BY sfsp__SortOrder__c
            `])).forEach(I=>y[I.sfsp__SalesNode__c].sfsp__SalesNodeRules__r.push(I)),y},isAncestor({node:p,ancestor:y,nodeMap:v}){for(;p=v[p._parentId];)if(p===y)return!0;return!1},getDescendants({nodes:p}){if(p.length===0)return[];const y=p.reduce((v,C)=>v.concat(C.sfsp__SalesNodes__r||[]),[]);return[...p,...r.getDescendants({nodes:y})]},compare({node:p,compareNode:y,breadcrumbs:v=[]}){const C=[],I={};return p.sfsp__SalesNodes__r.forEach(O=>{const A=y.sfsp__SalesNodes__r.findIndex(P=>P.Name===O.Name);if(A!==-1){const P=y.sfsp__SalesNodes__r.splice(A,1)[0];I[O.Id]=P;const q=r.compare({node:O,compareNode:P,breadcrumbs:[...v,O]});C.push(...q.diff),Object.assign(I,q.map)}else C.push({node:O,label:[...v,O].map(({Name:P})=>P).join(" -> "),reason:"Target Not Found"})}),y.sfsp__SalesNodes__r.forEach(O=>{C.push({node:O,label:[...v,O].map(({Name:A})=>A).join(" -> "),reason:"Source Not Found"})}),{diff:C,map:I}},async getRecordCount({segmentId:p,dataSource:y,nodeMap:v}){var I;v=v||await r.buildNodeMap({segmentId:p});const{results:C}=await SPM.Utils.Rest.invoke("RunSaql",{query:`
                ${r.generateNodeFilterSaql({node:v[nodeId],nodeMap:v,dataSource:y})}
    
                -- results
                results = group results by all;
                results = foreach results generate count() as count;
            `.replace(/^ */gm,"")});return((I=C==null?void 0:C.records[0])==null?void 0:I.count)||0},async resetStampedDataSource(p){await SPM.Utils.CRM.upsert({records:[{Id:p,sfsp__StampDataSourceId__c:""}]})},async buildDataSource({planId:p}){const[y]=await SPM.Utils.Apex.invoke("Query",[`
                SELECT Id, Name, sfsp__SourceId__c, sfsp__ReferenceFields__c
                FROM sfsp__SalesDataSource__c
                WHERE Id IN (SELECT sfsp__SalesDataSource__c FROM sfsp__SalesPlan__c WHERE Id = '${p}')
            `]);return y._referenceFields=JSON.parse(y.sfsp__ReferenceFields__c),y._dataset=await SPM.Utils.Rest.invoke("GetDataset",{id:y.sfsp__SourceId__c}),y},async getRecords({segmentId:p,dataSource:y,nodeMap:v,uniqueIds:C=[],limit:I=1,offset:O}){v=v||await this.buildNodeMap({segmentId:p}),C.length>0&&(I=C.length);const{results:A}=await SPM.Utils.Rest.invoke("RunSaql",{query:`
                    ${r.generateNodeFilterSaql({node:v[p],nodeMap:v,dataSource:y,uniqueIds:C})}

                    -- results
                    results = foreach results generate ${y._referenceFields.map(P=>`${P.id} as ${P.id}`).join(", ")};
                    ${O?`results = offset results ${O};`:""}
                    results = limit results ${I};
                `.replace(/^ */gm,"")});return A.records}},a={async getNumericScaleData({dataSource:p}){const y=new Map;return(await SPM.Utils.Rest.invoke("GetDatasetMetadata",{url:p._dataset.currentVersionUrl})).measures.forEach(C=>{y.set(C.fullyQualifiedName,C.format.decimalDigits)}),y},generateCsvMetadata({segmentId:p,dataSource:y,scaleDataMap:v,datasetName:C,datasetLabel:I}){const O=[];return y._referenceFields.forEach(P=>{const q={fullyQualifiedName:P.id,name:P.id,label:P.label,isUniqueId:!1,type:P.dataType,isSystemField:!1,isMultiValue:!1,description:""};P.dataType==="Numeric"&&(q.precision=18,q.scale=v.get(P.id)||0,q.defaultValue=0),O.push(q)}),{fileFormat:{charsetName:"UTF-8",fieldsDelimitedBy:",",fieldsEnclosedBy:'"',fieldsEscapedBy:"",linesTerminatedBy:`\r
`,numberOfLinesToIgnore:0},objects:[{connector:"SalesPlanningCSVConnector",fullyQualifiedName:"SegmentData",label:"Segment Data",name:"SegmentData",description:"",fields:O}]}},async waitDataflowJobComplete({jobId:p,retries:y=5}){let v=1e4;for(;y>0;){const C=await SPM.Utils.Rest.invoke("GetCurrentDataflowJob",{id:p});if(!["Failure","Warning","Success"].includes(C.status))await SPM.Utils.Async.wait(v),v*=2,y--;else{if(["Success","Warning"].includes(C.status))return!0;if(["Failure"].includes(C.status))return!1}}return!1},async stampDataSource({segmentId:p,dataSource:y,planName:v,planId:C,segmentName:I}){var Rt;const O=await r.buildNodeMap({nodeId:p}),A=await a.getNumericScaleData({dataSource:y}),P=C+"_"+p,q=(v+" - "+I).slice(0,80),ce=a.generateCsvMetadata({segmentId:p,dataSource:y,scaleDataMap:A}),re=await SPM.Utils.Apex.invoke("Query",[`
                SELECT
                    Id
                    FROM Folder
                    WHERE Type = 'Insights' AND Name = '${y._dataset.folder.label}'
            `]);SPM.Utils.Splunk.sendLog({logName:"spmStampingJob",logPayload:{planId:C,segmentId:p,origDatasetName:y._dataset.name,stampDatasetName:q,jobName:"Stamp Records"}});const W=performance.now(),Ce=await SPM.Utils.Rest.invoke("CreateExternalDataJob",{metadata:e.from(JSON.stringify(ce,0,4)).toString("base64"),alias:P,label:q,app:(Rt=re[0])==null?void 0:Rt.Id,operation:"Overwrite"});if(!Ce.success)throw Ce.errors[0]||"";const te=5e4;let oe=0,ve=[],ee={},ne=[],Se=[],Ue=0,Qe=0,Me=!0;const vt=y._referenceFields.find(_t=>_t.isId).id,Ut=`
                ${r.generateNodeFilterSaql({node:O[p],nodeMap:O,dataSource:y})}
    
                -- results
                results = foreach results generate ${y._referenceFields.map(_t=>`${_t.id} as ${_t.id}`).join(", ")};
                results = order results by ${y._referenceFields.find(_t=>_t.isId).id};
            `;for(;Me;){ee={},ne=[];const _t=Ut+`
                results = offset results ${Qe};
                results = limit results ${te};
                `,F=performance.now(),{results:j}=await SPM.Utils.Rest.invoke("RunSaql",{query:_t.replace(/^ */gm,"")}),G=performance.now();if(j.records.length===0){Me=!1;continue}oe++,j.records.forEach(ke=>{ee[ke[vt]]=ke}),Se=[];const Y=Object.values(ee);for(;Y.length;)Se.push(Y.splice(0,1e6).map(ke=>ce.objects[0].fields.map(qe=>ke[qe.name]||(qe.type==="Text"?"":0))));const J=t.unparse(Se[0]),he=9e6;t.parse(J,{chunkSize:he,chunk(ke,qe){ne.unshift(t.unparse(ke.data))}});const be=performance.now();await SPM.Utils.Async.forEachParallel(ne,async ke=>{const ct=e.from(`${ke}\r
`).toString("base64");Ue+=1;const We=await SPM.Utils.Rest.invoke("UploadCsvPart",{parentId:Ce.id,csvPart:ct,partNumber:Ue});if(!We.success)throw We.errors[0]||""},5);const Ne=performance.now();ve.push({numRows:j.records.length,downloadTime:G-F,uploadTime:Ne-be}),Qe+=j.records.length}return await SPM.Utils.Rest.invoke("StartExternalDataJob",{parentId:Ce.id}),SPM.Utils.Splunk.sendLog({logName:"spmStampingJob",logPayload:{planId:C,segmentId:p,origDataset:{id:y._dataset.id,name:y._dataset.name,numRows:y._dataset.currentVersionTotalRowCount,numColumns:ce.objects[0].fields.length},stampDataset:{name:q,numRows:Qe,numColumns:ce.objects[0].fields.length},jobRunTime:Math.round(performance.now()-W),numBatches:oe,batchStats:ve,crmaJobId:Ce.id,status:"SUCCESS"}}),{jobId:Ce.id,datasetLabel:q,numRecords:Qe,numFields:ce.objects[0].fields.length}},async fetchStampJobResults(p,y,v,C){if(!await a.waitDataflowJobComplete({jobId:p})){SPM.$store.toast({state:"error",message:`${errorToastMessage}`,duration:null});return}if(y){const O=await SPM.Utils.Rest.invoke("GetDataset",{id:y});try{O.label!==v&&await SPM.Utils.Rest.invoke("PatchDataset",{id:y,metadata:{label:v}})}catch{}}else{const O=await SPM.Utils.Rest.invoke("GetDatasets",{alias:v.replaceAll("'","%5C%27")});if(!(O!=null&&O.length)){SPM.$store.toast({state:"error",message:`${errorToastMessage}`,duration:null});return}const A=O[0];await SPM.Utils.CRM.upsert({records:[{Id:C,sfsp__StampDataSourceId__c:A.id}]})}}},o={async fetchRelatedDataSets(){let p=[];const y=await SPM.Utils.Apex.invoke("Query",[`SELECT Id, sfsp__AssetType__c, sfsp__AssetId__c FROM sfsp__SalesNodeExternalAsset__c WHERE sfsp__SalesNode__c = '${SPM.$store.segment.Id}'`]);try{p=await SPM.Utils.Apex.invoke("Query",[`
                    SELECT
                        Id,
                        Name,
                        maps__Config__c,
                        (SELECT Id, Name, CreatedById, CreatedBy.Name, CreatedDate FROM maps__Alignments__r WHERE maps__Status__c != 'Deleted')
                    FROM maps__TPDataSet__c
                    WHERE Id IN ('${y.filter(C=>C.sfsp__AssetType__c==="Territory Plan").map(C=>C.sfsp__AssetId__c).join("','")}') AND maps__Status__c != 'Deleted'
                `])}catch{}const v=p.filter(C=>JSON.parse(C.maps__Config__c).dataSources.find(I=>I.type==="Segment Data Source"&&I.segmentId===SPM.$store.segment.Id));return SPM.$store.$patch(C=>C.TPDataSets=v),v||[]},async fetchRelatedAlignments(){const p=[];return(await o.fetchRelatedDataSets()).forEach(v=>{(v==null?void 0:v.maps__Alignments__r)&&JSON.parse(v.maps__Config__c).dataSources.find(C=>C.type==="Segment Data Source"&&C.segmentId===SPM.$store.segment.Id)&&p.push(...v==null?void 0:v.maps__Alignments__r)}),SPM.$store.$patch(v=>v.TPAlignments=p),p}};return{Rule:s,Filter:n,Node:r,ExternalData:a,TPDataSet:o,TerritoryStampUtils:{parsedStampDetails(p,y){return p.map(v=>{const C=JSON.parse(v.sfsp__HierarchyReferenceData__c),I={};Object.keys(C).forEach(A=>{const P=y.find(q=>q.type==="Territory"&&q.id===A);I[A]="",P.dataType==="Number"?I[A]=C[A].SUM:P.dataType==="String"&&(I[A]=C[A].VALUE)});const O=y.reduce((A,P)=>{const q=I[P.id];return q===void 0?P.dataType==="Number"?A[P.label]=0:A[P.label]="":A[P.label]=q,A},{});return{...v,data:O}})},hierarchicalStampDetails(p){const y=new Map;p.forEach(O=>{O.children=[],y.set(O.Id,O)});const v=[];y.forEach(O=>{if(O.sfsp__Parent__c){const A=y.get(O.sfsp__Parent__c);A&&A.children.push(O)}else v.push(O)});const C=[],I=(O,A)=>{O.forEach(P=>{P.indent=A,C.push(P),I(P.children,A+1)})};return I(v,0),C}}}}const f4=(e=[])=>{const t=e.split(".");return{field:t[t.length-1],lookups:t.splice(0,t.length-1)}},m4=(e,t={})=>{const{field:s,lookups:n=[]}=f4(e),r=n.reduce((a,o)=>a==null?void 0:a[o],t);return r==null?void 0:r[s]};function dk({Buffer:e,Papa:t,randomLocation:s}={}){const n={async invoke(F,j=[],{cls:G="SPMRemoteActions"}={}){const Y=window.performance.now(),he=await new Promise(be=>{const Ne=[`sfsp.${G}.${F}`,...j,(ke,qe)=>be({data:ke,event:qe})];Visualforce.remoting.Manager.invokeAction(...Ne,{buffer:!1,escape:!1,timeout:12e4})});if(he.event.status)return F==="Query"&&SPM.Utils.Splunk.sendLog({logName:"spmAPEX",logPayload:{query:j[0],returnCount:he.data.length,executionTime:window.performance.now()-Y}}),he.data;throw{type:"RemoteActionException",error:he.event}}},r={async invoke(){const[F,j={}]=arguments,G={Authorization:`Bearer ${SPM.SessionId}`},Y=new SPM.Utils.DeferredPromise,J=await this.Actions[F](G,j);return Y.resolve(J),SPM.Utils.Debug&&Y.then(he=>{console.groupCollapsed(F),[j,he].forEach(be=>console.log(be)),console.groupEnd()}).catch(he=>{console.groupCollapsed(F),[j,he].forEach(be=>console.log(be)),console.groupEnd()}),Y},Actions:{async Query(F,{query:j}){const G=window.performance.now(),Y=[];let{data:J}=await ui({method:"GET",url:"/services/data/v53.0/query",params:{q:j},headers:F});for(Y.push(...J.records);J.nextRecordsUrl;)J=(await ui({method:"GET",url:J.nextRecordsUrl,headers:F})).data,Y.push(...J.records);return Y.forEach(he=>{Object.keys(he).forEach(be=>{var Ne;(Ne=he[be])!=null&&Ne.records&&(he[be]=he[be].records)})}),SPM.Utils.Splunk.sendLog({logName:"spmREST",logPayload:{query:j,returnCount:Y.length,executionTime:window.performance.now()-G}}),Y},async Insert(F,{records:j}){if(j.length===0)return[];const{data:G}=await ui({method:"POST",url:"/services/data/v53.0/composite/sobjects",data:{allOrNone:!0,records:j},headers:F});return G},async Delete(F,{ids:j}){const G=[];for(;j.length;)G.push(j.splice(0,1e3));await p.forEachParallel(G,async Y=>{await ui({method:"DELETE",url:"/services/data/v53.0/composite/sobjects",params:{ids:Y.join(",")},headers:F})},5)},async tpRest(F,{action:j,data:G}){const{data:Y}=await ui({method:"POST",url:`/services/apexrest/maps/TPRest/${j}`,data:G,headers:F});return Y.data},async ToolingQuery(F,j){const{data:G}=await ui({method:"GET",url:`/services/data/v53.0/tooling/query/?q=${j}`,headers:F});return G},async ToolingSObject(F,{sObject:j}){const{data:G}=await ui({method:"GET",url:`/services/data/v53.0/tooling/sobjects/${j}/describe`,headers:F});return G},async ToolingSObjectPatch(F,{url:j,metadata:G}){const{data:Y}=await ui({method:"PATCH",url:j,data:G,headers:F});return Y},async SObjects(F){const{data:j}=await ui({method:"GET",url:"/services/data/v53.0/sobjects",headers:F});return j},async SObject(F,{sObject:j}){const{data:G}=await ui({method:"GET",url:`/services/data/v53.0/sobjects/${j}/describe`,headers:F});return G},async RunSaql(F,{query:j}){var J,he;const G=window.performance.now();let Y;try{const{data:be}=await ui({method:"POST",url:"/services/data/v53.0/wave/query",data:{query:j},headers:F});return Y=be,be}catch(be){return SPM.$store.toast({message:be.response.data[0].message,duration:5e3,state:"error"}),{records:[]}}finally{SPM.Utils.Splunk.sendLog({logName:"spmSAQL",logPayload:{query:j,returnCount:((he=(J=Y==null?void 0:Y.results)==null?void 0:J.records)==null?void 0:he.length)||0,executionTime:window.performance.now()-G}})}},async GetDataflows(F,{alias:j}){const{data:G}=await ui({method:"GET",url:`/services/data/v53.0/wave/dataflows?hasCurrentOnly&q=${j}`,headers:F});return G.dataflows||[]},async UpdateDataflow(F,{dataflowId:j,definition:G}){const{data:Y}=await ui({method:"PATCH",url:`/services/data/v50.0/wave/dataflows/${j}`,data:{definition:G},headers:F});return Y},async RunDataflow(F,{dataflowId:j}){const{data:G}=await ui({method:"POST",url:"/services/data/v53.0/wave/dataflowjobs",data:{dataflowId:j,command:"Start"},headers:F});return G},async GetDatasets(F,{alias:j,hasCurrentOnly:G=!0}){const{data:Y}=await ui({method:"GET",url:`/services/data/v53.0/wave/datasets?hasCurrentOnly=${G}&q=${j}&filterGroup=Supplemental`,headers:F});return Y.datasets||[]},async GetDataset(F,{id:j}){const{data:G}=await ui({method:"GET",url:`/services/data/v53.0/wave/datasets/${j}?t=${Date.now()}`,headers:F});return G},async PatchDataset(F,{id:j,metadata:G}){await ui({method:"PATCH",url:`/services/data/v53.0/wave/datasets/${j}`,data:G,headers:F})},async GetDatasetMetadata(F,{url:j}){const{data:G}=await ui({method:"GET",url:`${j}/xmds/main`,headers:F});return G},async GetCurrentDataflowJob(F,{id:j}){const{data:G}=await ui({method:"GET",url:"/services/data/v53.0/wave/dataflowjobs/",headers:F});return G.dataflowJobs.filter(Y=>Y.label.includes(j)),G.dataflowJobs.sort((Y,J)=>new Date(J.createdDate)-new Date(Y.createdDate)),G.dataflowJobs[0]},async CreateExternalDataJob(F,{metadata:j,alias:G,label:Y,app:J,operation:he}){const{data:be}=await ui({method:"POST",url:"/services/data/v56.0/sobjects/InsightsExternalData",data:{Format:"Csv",LicenseType:SPM.isScratch?"EinsteinAnalytics":"Sonic",EdgemartAlias:G,EdgemartLabel:Y||G,EdgemartContainer:J||"",Operation:he,Action:"None",NotificationSent:"Always",MetadataJson:j},headers:F});return be},async UploadCsvPart(F,{parentId:j,csvPart:G,partNumber:Y}){const{data:J}=await ui({method:"POST",url:"/services/data/v56.0/sobjects/InsightsExternalDataPart",data:{DataFile:G,InsightsExternalDataId:j,PartNumber:Y},headers:F});return J},async StartExternalDataJob(F,{parentId:j}){const{data:G}=await ui({method:"PATCH",url:`/services/data/v56.0/sobjects/InsightsExternalData/${j}`,data:{Action:"Process"},headers:F});return G},async UploadAutoAssignmentData(F,{scus:j,mapping:G}){const Y=await n.invoke("GetAutoAssignmentUploadUrl",[]),J={records:j,mapping:G||{"Unique Id":"Id",Assignment:"Assignment",Boundaries:"Boundaries",Locked:"Locked",Latitude:"Latitude",Longitude:"Longitude",Weight:"Weight",Volume:"Volume"}};return await ui({method:"PUT",url:Y.externalDataUrl,headers:{"Content-Type":"application/json"},data:J}),Y.requestId},async MoveDatasetToSharedFolder(F,{datasetId:j}){let G=await n.invoke("MoveDatasetToSharedFolder",[j]);if(!G.success){const J={folder:{id:(await n.invoke("Query",["SELECT Id FROM Folder where Type = 'Insights' AND DeveloperName = 'Sales_Planning'"]))[0].Id}};({data:G}=await ui({method:"PATCH",url:`/services/data/v56.0/wave/datasets/${j}`,headers:F,data:J}))}return G}}},a={async get({url:F}){return await ui({method:"GET",url:F})}},o={MasterDetailRelationships:{sfsp__SalesNodeRuleItem__c:{sfsp__SalesNodeRule__c:!0}},upsert:async({records:F,onProgress:j=()=>{}})=>{const G=[],Y=[];F.forEach(be=>(be.Id?Y:G).push(be));const J=[];for(;G.length;)J.push({type:"InsertSObjects",records:G.splice(0,1e3)});for(;Y.length;)J.push({type:"UpdateSObjects",records:Y.splice(0,1e3)});let he=0;await p.forEachParallel(J,async be=>{const Ne=be.records.map(qe=>Object.keys(qe).reduce((ct,We)=>{var at,it;const ht=We.startsWith("_"),rt=We==="sobjectType"&&qe.Id,fe=We.endsWith("__r"),ye=be.type==="UpdateSObjects"&&((it=(at=o.MasterDetailRelationships)==null?void 0:at[qe.sobjectType])==null?void 0:it[We]),Je=["CreatedBy","CreatedById","CreatedDate"].includes(We);return!ht&&!rt&&!fe&&!ye&&!Je&&(ct[We]=qe[We]),ct},{})),ke=await n.invoke(be.type,[Ne,!0]);be.type==="InsertSObjects"&&ke.forEach((qe,ct)=>be.records[ct].Id=qe.Id),he+=be.records.length,j(Math.floor(100*he/F.length))},5)},delete:async({records:F,onProgress:j=()=>{}})=>{const G=F.map(he=>he.Id).sort(),Y=[];for(;G.length;)Y.push(G.splice(0,1e3));let J=0;await p.forEachParallel(Y,async he=>{await n.invoke("DeleteIds",[he,!0]),J+=he.length,j(Math.floor(100*J/F.length))},5)}},d={async checkDatasets(F,j,G=()=>{}){var ct,We,ht;const Y=[],J=async({recordsDataset:rt,assignmentsDataset:fe})=>{let ye=!0;await SPM.Utils.Async.forEachParallel([rt,fe],async Je=>{if(Je.folder.name!=="Sales_Planning")try{(await SPM.Utils.Rest.invoke("MoveDatasetToSharedFolder",{datasetId:Je.id})).folder&&(Je.folder={name:"Sales_Planning"})}catch{ye=!1}}),ye||Y.push({showOnce:!0,state:"warning",message:"This plan cannot be shared. Please see your admin about adding a Sales Planning app if you need to share with others."}),rt.dataflowStatus="",fe.dataflowStatus="",Object.assign(ke,{recordsDataset:rt,assignmentsDataset:fe,totalCount:rt.currentVersionTotalRowCount,assignmentCount:ke.assignmentCount||0}),Ne&&Object.assign(Ne,{status:"Success"}),ke.asyncJob.status="Success",G()},he=async(rt,fe=5)=>{const{dataflowJobs:ye}=await SPM.Utils.Apex.invoke("GetDataflowJobs",[SPM.$store.plan.Id,rt.id]),Je=ye.find(it=>{var Et;return(Et=it==null?void 0:it.label)==null?void 0:Et.startsWith(`${SPM.$store.plan.Id}_${rt.id}_Assignments`)}),at=ye.find(it=>{var Et;return(Et=it==null?void 0:it.label)==null?void 0:Et.startsWith(`${SPM.$store.plan.Id}_${rt.id}_Records`)});if(!at||!Je){const it=await SPM.Utils.AssignmentObject.loadDatasets({assignmentObjectId:rt.id,planId:SPM.$store.plan.Id});return it?(await J({recordsDataset:it.recordsDataset,assignmentsDataset:it.assignmentsDataset}),0):(await p.wait(1e4),fe)}else{if(rt.recordsDataset.dataflowStatus=at.status,rt.assignmentsDataset.dataflowStatus=Je.status,!["Failure","Warning","Success"].includes(at.status)||!["Failure","Warning","Success"].includes(Je.status))return await p.wait(1e4),fe;if(["Success","Warning"].includes(at.status)&&["Success","Warning"].includes(Je.status)){const it=await SPM.Utils.AssignmentObject.loadDatasets({assignmentObjectId:rt.id,planId:SPM.$store.plan.Id});if(it)return await J({recordsDataset:it.recordsDataset,assignmentsDataset:it.assignmentsDataset}),["create","update"].includes(j==null?void 0:j.type)&&(Y.push(at.status==="Warning"?{message:`Assignment Object "${rt.label}" was created with some warnings.`,duration:null,state:"warning",subMessage:`${SPM.orgDomainUrl}/analytics/dataManager`}:{message:`Assignment Object "${rt.label}" was ${(j==null?void 0:j.type)==="create"?"created":"updated"}.`,duration:3e3,state:"success"}),rt.asyncJob.type==="Refresh Assignment Object"&&await SPM.Utils.AssignmentObject.updateReferenceFields({assignmentObject:rt})),0;if(fe-1===1)try{await Promise.allSettled([SPM.Utils.Apex.invoke("MoveDatasetToSharedFolderByAlias",[`${SPM.$store.plan.Id}_${ke.id}_Records`]),SPM.Utils.Apex.invoke("MoveDatasetToSharedFolderByAlias",[`${SPM.$store.plan.Id}_${ke.id}_Assignments`])])}catch{}return await p.wait(1e4),fe-1}else if(["Failure"].includes(at.status)||["Failure"].includes(Je.status)){const it=await SPM.Utils.AssignmentObject.loadDatasets({assignmentObjectId:rt.id,planId:SPM.$store.plan.Id});return it&&await J({recordsDataset:it.recordsDataset,assignmentsDataset:it.assignmentsDataset}),Y.push({message:`Assignment Object "${rt.label}" dataflow had a failure ${(j==null?void 0:j.type)==="create"?"creating":j.type==="update"?"updating":"loading"}.`,duration:null,state:"error",subMessage:`Records: ${at.message}, Assignments: ${Je.message}`}),0}}},be=async rt=>{const fe=(await SPM.Utils.AssignmentObject.getSalesAsyncJobs({objectId:rt.id,statusFilter:["Queued","Running","Waiting","Failure"]}))[0]||!1;if(!!fe&&(SPM.$store.$patch(ye=>{const Je=SPM.$store.salesAsyncJobs.find(it=>it.Id===fe.Id);Je&&Object.assign(Je,fe);const at=ye.assignmentObjects.find(it=>it.id===rt.id);at.recordsDataset&&fe.sfsp__Status__c==="Waiting"&&(o.upsert({records:[{Id:fe.Id,sfsp__Status__c:"Success"}]}),fe.sfsp__Status__c="Success"),Object.assign(at.asyncJob,{id:fe.Id,type:fe.sfsp__Type__c,status:fe.sfsp__Status__c,details:fe.sfsp__Details__c}),ye.hasChanged=!0}),!["Success","Warning"].includes(fe.sfsp__Status__c)))return["Failure"].includes(fe.sfsp__Status__c)?fe:(await p.wait(5e3),await be(rt))},Ne=SPM.$store.salesAsyncJobs.find(rt=>rt.sfsp__SalesAssignmentObject__c===F.Id),ke=SPM.$store.assignmentObjects.find(rt=>rt.id===F.Id);if(!ke){const rt=SPM.$store.salesAsyncJobs.findIndex(fe=>fe.Id===Ne.Id);rt>-1&&SPM.$store.salesAsyncJobs.splice(rt,1),j.type==="delete"&&(G(),Y.push({message:`Assignment Object "${j.assignmentObject.sfsp__Label__c}" was deleted.`,duration:3e3,state:"success"}));return}let qe=null;try{qe=await SPM.Utils.AssignmentObject.loadDatasets({assignmentObjectId:F.Id,planId:SPM.$store.plan.Id})}catch(rt){(((ct=rt.response)==null?void 0:ct.data[0].errorCode)||null)==="FUNCTIONALITY_NOT_ENABLED"&&Y.push({showOnce:!0,state:"warning",message:"Some features may not work properly. Please contact your admin to ensure you are properly licensed.",duration:null})}if(qe&&await J({recordsDataset:qe.recordsDataset,assignmentsDataset:qe.assignmentsDataset}),Ne){const rt=await be(ke);if(rt)SPM.$store.toast({message:`Can\u2019t ${j.type==="create"?"create":"update"} the ${j.assignmentObject.sfsp__Label__c} assignment object. Try again or contact Salesforce Customer Support.`,duration:null,state:"error"});else{let fe=await he(ke,5);for(;fe!==0;)fe=await he(ke,fe),await p.wait(2e3)}if(rt||["Warning","Success"].includes(ke.asyncJob.status)){Ne.sfsp__Splunk__c&&SPM.Utils.Splunk.sendLog(JSON.parse(Ne.sfsp__Splunk__c));try{await SPM.Utils.CRM.delete({records:[{Id:Ne.Id}]})}catch{}const fe=SPM.$store.salesAsyncJobs.findIndex(ye=>ye.Id===Ne.Id);fe>-1&&SPM.$store.salesAsyncJobs.splice(fe,1)}}if(!((We=ke==null?void 0:ke.recordsDataset)!=null&&We.dimensions)||!((ht=ke==null?void 0:ke.assignmentsDataset)!=null&&ht.dimensions))try{const rt=await Promise.allSettled([SPM.Utils.Apex.invoke("MoveDatasetToSharedFolderByAlias",[`${SPM.$store.plan.Id}_${ke.id}_Records`]),SPM.Utils.Apex.invoke("MoveDatasetToSharedFolderByAlias",[`${SPM.$store.plan.Id}_${ke.id}_Assignments`])]);await he(ke,1),rt.some(fe=>fe.status==="rejected")&&Y.push({state:"error",message:`Unable to load ${ke.label}. Please contact your admin to ensure Sales Planning is properly configured.`,duration:null})}catch{Y.push({state:"error",message:`Unable to load ${ke.label}. Please contact your admin to ensure Sales Planning is properly configured.`,duration:null})}Y.forEach(rt=>{(SPM.$store.showOnLoadToasts||!rt.showOnce)&&SPM.$store.toast(rt)}),SPM.$store.showOnLoadToasts=!1}},p={forEach:async(F,j)=>{for(let G=0;G<F.length;G++)await j(F[G],G,F)},forEachParallel:(F,j,G)=>(F=F.map(Y=>Y),Promise.all(G?Array(G).fill().map(()=>(async()=>{for(let Y;Y=F.shift();)await j(Y)})()):F.map((Y,J)=>(async()=>j(Y,J,F))()))),forEachBulk:async(F,j,G)=>{let Y=0;for(;Y<F.length;){const J=Math.min(Y+G,F.length);for(let he=Y;he<J;he++)j(F[he]);Y+=G,await p.wait(1)}},wrapper:F=>(j,G)=>{F().then(j).catch(Y=>G(Y))},wait(F,j=async()=>{}){return new Promise((G,Y)=>setTimeout(()=>{j().then(J=>G(J)).catch(Y)},F))}},y={on(F,j,G){F.$onAction(async({name:Y,args:J,after:he})=>{Y==="emit"&&J[0]===j&&he(G)})}},v={get(F={},j,G=""){return j.replace(/\[/g,".").replace(/]/g,"").split(".").filter(Boolean).every(J=>(F=F[J],F!=null))?F:G},compare(F,j,G){const Y=F[G],J=j[G];return Y>J?1:Y<J?-1:0},shallowCompare(F,j){return Object.keys(F).length===Object.keys(j).length&&Object.keys(F).every(G=>j.hasOwnProperty(G)&&F[G]===j[G])}},C={move(F,j,G){F.splice(G,0,F.splice(j,1)[0])},splice(F,j){if(F.length===0)return[];const G=[];F.length-1;for(let Y=F.length-1;Y>=0;Y--)j(F[Y])&&G.push(F.splice(Y,1)[0]);return G}},I={inspect({node:F,nodeCount:j=1,depth:G=1}){var J;let Y=G;return(J=F==null?void 0:F.children)==null||J.forEach(he=>{const be=this.inspect({node:he,depth:G+1});j+=be.nodeCount,Y=Math.max(Y,be.maxDepth)}),{nodeCount:j,maxDepth:Y}}},O={RuleItem:{ETMOperators:{equals:"==",notEqual:"!=",lessThan:"<",lessOrEqual:"<=",greaterThan:">",greaterOrEqual:">=",contains:"like",notContain:"doesnotcontain",startsWith:"startsWith"},fromFilter(F){const j=typeof F.value=="object";return{sobjectType:"sfsp__SalesNodeRuleItem__c",sfsp__Field__c:F.key,sfsp__Operator__c:j?"between":"==",sfsp__Value__c:j?`${F.value.from},${F.value.to}`:F.value}},fromRecordFilter(F){return{sobjectType:"sfsp__SalesNodeRuleItem__c",sfsp__Field__c:F.field,sfsp__Operator__c:F.operator,sfsp__Value__c:F.value}}},fromFilterSet(F,j,G=1){const Y=[],J=[],he=F[0].slice(0,F[0].length-1),be=F.map(ke=>ke.slice(-1)[0]);if(he.length&&(Y.push(he.map((ke,qe)=>G+qe+J.length).join(" and ")),J.push(...he.map(ke=>O.RuleItem.fromFilter(ke)))),typeof be[0].value=="object"){const ke=be.map((qe,ct)=>G+ct+J.length);Y.push(`(${ke.join(" or ")})`),J.push(...be.map(qe=>SPM.Utils.Rule.RuleItem.fromFilter(qe)))}else Y.push(String(G+J.length)),J.push({sobjectType:"sfsp__SalesNodeRuleItem__c",sfsp__Field__c:be[0].key,sfsp__Operator__c:"==",sfsp__Value__c:be.map(ke=>ke.value).join(",")});return{sobjectType:"sfsp__SalesNodeRule__c",sfsp__BooleanFilter__c:Y.join(" and "),sfsp__SalesNodeRuleItems__r:J.map((ke,qe)=>({...ke,sfsp__SortOrder__c:qe+1}))}},fromBoundaries({boundaries:F,boundaryObject:j}){const G=SPM.$store.containerSets[j.containerSetId];let Y=G.containers;j.includesPoints||(Y=Object.keys(Y).filter(Ne=>!Y[Ne].parent).reduce((Ne,ke)=>(Ne[ke]=Y[ke],Ne),{}));const J="startsWith";F=SPM.Utils.Rule.simplifyValues(Object.values(Y).map(Ne=>Ne.name),F);const he=[];let be="";return F.forEach(Ne=>{be.length+Ne.length+1>=1e3&&(he.push(be.slice(0,be.length-1)),be=""),be+=`${Ne},`}),be&&he.push(be.slice(0,be.length-1)),{sobjectType:"sfsp__SalesNodeRule__c",Name:G.label,sfsp__SalesNodeBoundary__c:j.id,sfsp__SortOrder__c:1,sfsp__FilterLogic__c:"any",sfsp__BooleanFilter__c:Array(he.length).fill().map((Ne,ke)=>ke+1).join(" or "),sfsp__SalesNodeRuleItems__r:he.map((Ne,ke)=>({sobjectType:"sfsp__SalesNodeRuleItem__c",sfsp__Field__c:j.name,sfsp__Operator__c:J,sfsp__Value__c:Ne,sfsp__SortOrder__c:ke+1}))}},toString(F){const j=F.sfsp__SalesNodeRuleItems__r.map(G=>`${G.sfsp__Field__c} ${G.sfsp__Operator__c} ${JSON.stringify(G.sfsp__Value__c)}`);return A.mergeBooleanFilter(F.sfsp__BooleanFilter__c,j)},toSaql(F,j){const G=F.sfsp__SalesNodeRuleItems__r.map(Y=>A.toSaql({field:Y.sfsp__Field__c,operator:Y.sfsp__Operator__c,value:Y.sfsp__Value__c,dataType:F.sfsp__SalesNodeBoundary__c?"Text":j.referenceFields.find(J=>J.id===Y.sfsp__Field__c).type}));return A.mergeBooleanFilter(F.sfsp__BooleanFilter__c,G)},simplifyValues(F,j){const G=new Ww.Trie;F.forEach(he=>G.add(he));const Y=new Ww.Trie;j.forEach(he=>Y.add(he));const J=new Set;return j.forEach(he=>{for(let be=1;be<=he.length;be++){const Ne=he.slice(0,be);if(Y.countChildren(Ne)===G.countChildren(Ne)){J.add(Ne);break}}}),[...J]},unsimplifyValues(F,j){const G=new Ww.Trie;return F.forEach(J=>G.add(J)),j.map(J=>G.prefixMatchingWords(J)).flat()},validateCustomLogic(F,j){if(!F||j==0)return!1;var G=[];for(let he=1;he<=j;he++)G.push(he.toString());const Y=/\d+/g,J=F.match(Y);if(J)for(let he=0;he<J.length;he++){if(J[he]<1||J[he]>j)return!1;let be=G.indexOf(J[he]);be>=0&&G.splice(be,1)}return G.length!==0?!1:this.validateBooleanExpr(F)},validateBooleanExpr(F){let j=F.toLowerCase();const G=/\(\d+\)|\d+ (?:and|or|\|\||\&\&) \d+|\d+/g;for(;;){const Y=j.replace(G,"1");if(Y=="1")return!0;if(Y==j)return!1;j=Y}}},A={toSaql(F){const{field:j,operator:G,value:Y="",dataType:J}=F;if(J==="Text"){let he=Y.split(",");switch(he=he.map(be=>be.trimStart()),G){case"==":return he.length>1?he.some(be=>!be)?`(${j} in ["${he.join('","')}"] || ${j} is null)`:`${j} in ["${he.join('","')}"]`:Y?`${j} == "${Y}"`:`(${j} == "" || ${j} is null)`;case"!=":return he.length>1?he.some(be=>!be)?`(${j} not in ["${he.join('","')}"] || ${j} is null)`:`${j} not in ["${he.join('","')}"]`:Y?`(${j} != "${Y}" || ${j} is null)`:`(${j} != "" || ${j} is not null)`;case"like":return he.length>1?`(${he.map(be=>`${j} like "%${be}%"`).join(" || ")})`:`${j} like "%${Y}%"`;case"startsWith":return he.length>1?`(${he.map(be=>`${j} like "${be}%"`).join(" || ")})`:`${j} like "${Y}%"`;default:return`${j} ${G} "${Y}"`}}else switch(G){case"between":const[he,be]=Y.split(",");return`(${j} >= ${he} && ${j} <= ${be})`;default:return`${j} ${G} ${Y}`}},evaluate({filters:F,filterLogic:j,record:G}){if(F.length===0)return!0;const Y=F.map(he=>{const{field:be,operator:Ne,value:ke="",dataType:qe}=he,ct=Ne==="between"?[ke]:ke.split(","),We=G[be],ht=(We||"").toString().toLowerCase();return ct.some(rt=>{switch(Ne){case"==":return We==rt;case"!=":return We!=rt;case"like":return ht.includes(rt.toLowerCase());case"startsWith":return ht.startsWith(rt.toLowerCase());case"between":const[fe,ye]=rt.split(",");return We>=fe&&We<=ye;case"<":return We<rt;case"<=":return We<=rt;case">":return We>rt;case">=":return We>=rt;default:return!1}})}),J=A.mergeBooleanFilter(j,Y);return Function(`"use strict";return (${J})`)()},mergeBooleanFilter(F,j){F=F.toLowerCase().replaceAll(" and "," && ").replaceAll(" or "," || ");let G="",Y="";for(let J=0;J<F.length;J++){const he=F[J];if(/[0-9]/.test(he)){Y+=he;continue}Y&&(G+=j[parseInt(Y)-1],Y=""),G+=he}return Y&&(G+=j[parseInt(Y)-1]),G},removeBooleanFilterExpression(F,j,G=0){F=F.toLowerCase(),j=String(j);let Y="",J;for(let be=G;be<F.length;be++){const Ne=F[be];if(/[0-9]/.test(Ne)){Y+=Ne;continue}if(Y===j){J=be-String(j).length;break}if(Number(Y)>Number(j)){const ke=String(Number(Y)-1);F=`${F.slice(0,be-1)}${ke}${F.slice(be-1+Y.length)}`,ke.length<j.length&&be--}Y=""}if(!J&&Y===j)J=F.length-String(j).length;else if(!J&&Y&&Number(Y)>Number(j)){const be=String(Number(Y)-1);F=F.replace(new RegExp(`${Y}$`),be)}if(J){const{start:be,end:Ne}=A.getOperatorBounds(F,J,j.length);return A.removeBooleanFilterExpression(`${F.slice(0,be)}${F.slice(Ne)}`,j,be)}let he;for(;(he=F.indexOf("()"))!==-1;){const{start:be,end:Ne}=A.getOperatorBounds(F,he,2);F=`${F.slice(0,be)}${F.slice(Ne)}`}return F},getOperatorBounds(F,j,G){const Y=j+G;let J,he;return j>4&&F.slice(j-4,j)===" or "?(J=j-4,he=Y):Y<F.length-4&&F.slice(Y,Y+4)===" or "?(J=j,he=Y+4):j>5&&F.slice(j-5,j)===" and "?(J=j-5,he=Y):Y<F.length-5&&F.slice(Y,Y+5)===" and "?(J=j,he=Y+5):(J=j,he=Y),{start:J,end:he}}},P=function(){this._promise=new Promise((F,j)=>{this.resolve=F,this.reject=j}),this.then=this._promise.then.bind(this._promise),this.catch=this._promise.catch.bind(this._promise),this.finally=this._promise.finally.bind(this._promise),this[Symbol.toStringTag]="Promise"},q={defaults:()=>({sobjectType:"sfsp__SalesPlan__c",Name:"",sfsp__SalesMetrics__r:[],sfsp__SalesAssignmentObjects__r:[],sfsp__SalesNodeMetrics__r:[],sfsp__ListViews__r:[],sfsp__SalesNodeBoundaries__r:[],sfsp__SalesPlanUsers__r:[],sfsp__SalesUserAccess__r:[]})},ce={getIcon(F){return{Account:{category:"standard",name:"account",color:"#5867E8"},Lead:{category:"standard",name:"lead",color:"#FF5D2D"},Contact:{category:"standard",name:"contact",color:"#a094ed"},Opportunity:{category:"standard",name:"opportunity",color:"#fcb95b"},User:{category:"standard",name:"customers",color:"#06A59A"}}[F]||{category:"standard",name:"entity",color:"#f88962"}},getReferenceMetadata({assignmentObject:F}){return[...F.recordsDataset.dimensions.map(j=>({id:j.id,title:`Unique ${j.title}`,type:"unique"})),...F.recordsDataset.measures.reduce((j,G)=>[{id:G.id,title:`Sum of ${G.title}`,type:"sum"},{id:G.id,title:`Min ${G.title}`,type:"min"},{id:G.id,title:`Max ${G.title}`,type:"max"}].concat(j),[])]},getFieldOptions({assignmentObject:F,mode:j="Record"}){const G=j==="Record"?"":"sum__",Y=j==="Record"?"":"Sum of ",J=F.referenceFields.filter(he=>he.type==="Numeric"||j==="Record").map(({id:he,label:be,type:Ne,isNameField:ke})=>({id:`${G}${F.id}__${he}`,label:`${Y}${be}`,type:Ne,isNameField:ke}));return j==="Record"&&SPM.$store.boundaryObjects.forEach(he=>{var be,Ne;(Ne=(be=F.recordsDataset)==null?void 0:be.dimensions)!=null&&Ne.find(ke=>ke.id===he.name)&&J.push({id:`${F.id}__${he.name}`,label:he.label,type:"Text"})}),J.sort((he,be)=>he.label>be.label?1:he.label<be.label?-1:0),J.find(he=>he.isNameField)?(J.unshift(J.splice(J.findIndex(he=>he.isNameField),1)[0]),j==="Record"&&J.splice(1,0,{id:"AssignedTo",label:"Assigned To",type:"Assignment"},{id:"AssignmentType",label:"Assignment Type",type:"Assignment"})):j==="Record"&&J.push({id:"AssignedTo",label:"Assigned To",type:"Assignment"},{id:"AssignmentType",label:"Assignment Type",type:"Assignment"}),J},getDefaultColumns({assignmentObject:F,mode:j="Record"}){const G=ce.getFieldOptions({assignmentObject:F,mode:j});return G.find(Y=>Y.isNameField)?G.filter(Y=>Y.id!==`${F.id}__Id`).map(({id:Y,type:J,isNameField:he})=>({id:Y,summaryFormat:J==="Numeric"?"Sum":J==="Assignment"?"Assignment":"Unique",isNameField:he})):G.map(({id:Y,type:J})=>({id:Y,summaryFormat:J==="Numeric"?"Sum":J==="Assignment"?"Assignment":"Unique"}))},async getDatasetInfo({alias:F}){let j={},G=[],Y={};if(SPM.hasDataPipelinesAccess){if(j=await SPM.Utils.Rest.invoke("GetDatasets",{alias:F}),!(j!=null&&j.length))return!1;G=j[0],Y=await SPM.Utils.Rest.invoke("GetDatasetMetadata",{url:G.currentVersionUrl})}else{if({datasets:j,metadata:Y}=await SPM.Utils.Apex.invoke("GetDatasets",[F]),!(j!=null&&j.length))return!1;G=j[0]}return{dataset:G,metadata:Y}},async loadDatasets({assignmentObjectId:F,planId:j}){const{dataset:G,metadata:Y}=await SPM.Utils.AssignmentObject.getDatasetInfo({alias:`${j}_${F}_Records`});if(!G||!Y)return!1;const{dataset:J,metadata:he}=await SPM.Utils.AssignmentObject.getDatasetInfo({alias:`${j}_${F}_Assignments`});return!J||!J?!1:(Object.assign(G,{measures:Y.measures.map(be=>({type:"measure",id:be.field,title:be.label})),measuresMetadata:Y.measures,dimensions:Y.dimensions.map(be=>({type:"dimension",id:be.field,title:be.label}))}),Object.assign(J,{measures:he.measures.map(be=>({type:"measure",id:be.field,title:be.label})),measuresMetadata:he.measures,dimensions:he.dimensions.map(be=>({type:"dimension",id:be.field,title:be.label}))}),{recordsDataset:G,assignmentsDataset:J})},async reassign({objectId:F,reassignments:j}){const G=SPM.Utils.Node.getDescendants({nodes:[SPM.$store.rootNode]}).reduce((be,Ne)=>(Ne!==SPM.$store.rootNode&&Ne.assignments.forEach(ke=>{ke.sfsp__SalesAssignmentObject__c===F&&(be[ke.sfsp__RecordId__c]=be[ke.sfsp__RecordId__c]||[],be[ke.sfsp__RecordId__c].push(ke))}),be),{}),Y=[],J=[],he=new Set;j.forEach(({recordId:be,targetId:Ne})=>{const ke=G[be];ke==null||ke.forEach(ct=>{Y.push(ct),he.add(ct.sfsp__SalesNode__c)});let qe=SPM.$store.nodeMap[Ne];for(;qe!==SPM.$store.rootNode;)he.add(qe.id),J.push({sobjectType:"sfsp__SalesNodeAssignment__c",sfsp__SalesAssignmentObject__c:F,sfsp__RecordId__c:be,sfsp__AssignmentType__c:"Manual",sfsp__SalesNode__c:qe.id,sfsp__Status__c:"Active"}),qe=SPM.$store.nodeMap[qe.parentId]}),await Promise.all([SPM.Utils.CRM.delete({records:Y}),SPM.Utils.CRM.upsert({records:J})]),he.forEach(be=>{SPM.$store.nodeMap[be].assignments=SPM.$store.nodeMap[be].assignments.filter(Ne=>!Y.includes(Ne)),SPM.$store.nodeMap[be].assignments.push(...J.filter(Ne=>Ne.sfsp__SalesNode__c===be))})},async reassignBoundaries({objectId:F,reassignments:j,isPreview:G,onProgress:Y=()=>{}}){const J=SPM.$store.boundaryObjects.find(ke=>ke.id===F),he=[],be=[];if(SPM.$store.allNodes.forEach(ke=>{if(ke.id==="All Org")return;const qe=SPM.Utils.Node.getBoundaries({node:ke,boundaryObject:J,format:"map"}),ct=SPM.$store.rootNode.assignmentBehavior==="Exclusive";let We=!1;if(j.forEach(({boundary:ht,targetId:rt})=>{const fe=SPM.$store.nodeMap[rt],ye=ke.id===fe.id||SPM.Utils.Node.isAncestor({node:fe,ancestor:ke,nodeMap:SPM.$store.nodeMap});ye&&!qe[ht]?(qe[ht]=!0,We=!0):ct&&!ye&&qe[ht]&&(delete qe[ht],We=!0)}),We){if(G){const ht=[...(ke.previewRules||ke.rules).filter(rt=>rt.sfsp__SalesNodeBoundary__c!==F)];if(he.push(...(ke.previewRules||ke.rules).filter(rt=>rt.sfsp__SalesNodeBoundary__c===F)),Object.keys(qe).length){const rt=SPM.Utils.Rule.fromBoundaries({boundaries:Object.keys(qe),boundaryObject:J});ht.push(rt)}ke.previewRules=ht}else if(he.push(...ke.rules.filter(ht=>ht.sfsp__SalesNodeBoundary__c===F)),ke.rules=ke.rules.filter(ht=>ht.sfsp__SalesNodeBoundary__c!==F),Object.keys(qe).length){const ht={...SPM.Utils.Rule.fromBoundaries({boundaries:Object.keys(qe),boundaryObject:J}),sfsp__SalesNode__c:ke.id};ke.rules.push(ht),be.push(ht)}}}),G)return;await SPM.Utils.CRM.upsert({records:be,onProgress:ke=>Y(`Saving Rules...${ke}%`)});const Ne=[];be.forEach(ke=>{ke.sfsp__SalesNodeRuleItems__r.forEach(qe=>{qe.sfsp__SalesNodeRule__c=ke.Id,Ne.push(qe)})}),await SPM.Utils.CRM.upsert({records:Ne,onProgress:ke=>Y(`Saving Rule Items...${ke}%`)}),await SPM.Utils.CRM.delete({records:he,onProgress:ke=>Y(`Cleaning Up...${ke}%`)})},async getSalesAsyncJobs({objectId:F,statuses:j=[]}){const G=F?` AND sfsp__SalesAssignmentObject__c = '${F}'`:"",Y=j.length>0?` AND sfsp__Status__c IN ('${j.join("','")}')`:"";return await SPM.Utils.Apex.invoke("Query",[`
                SELECT
                    Name,
                    CreatedDate,
                    sfsp__Details__c,
                    sfsp__Status__c,
                    sfsp__Type__c,
                    sfsp__Splunk__c,
                    sfsp__SalesAssignmentObject__c,
                    sfsp__SalesAssignmentObject__r.Name,
                    sfsp__SalesAssignmentObject__r.sfsp__Label__c,
                    sfsp__SalesAssignmentObject__r.sfsp__SalesPlan__c
                FROM sfsp__SalesAsyncJob__c
                WHERE sfsp__SalesAssignmentObject__r.sfsp__SalesPlan__c = '${SPM.$store.plan.Id}'${G}${Y}
                ORDER BY CreatedDate DESC
            `])||[]},async updateReferenceFields({assignmentObject:F}){const j=JSON.parse((SPM.$store.plan.sfsp__SalesAssignmentObjects__r.find(Y=>Y.Id===F.id)||{}).sfsp__ReferenceFields__c);j.forEach(Y=>Y.lastModifiedDate=Date.now());const[G]=await SPM.Utils.Apex.invoke("UpdateSObjects",[[{Id:F.id,Name:F.name,sfsp__Label__c:F.label,sfsp__ReferenceFields__c:JSON.stringify(j)}],!0]);SPM.$store.$patch(Y=>{const J=Y.plan.sfsp__SalesAssignmentObjects__r.findIndex(he=>he.Id===F.id);Y.plan.sfsp__SalesAssignmentObjects__r.splice(J,1,G),Y.hasChanged=!0})}},re={Defaults:{type:"boundary",icon:"location",styles:{visible:!0,opacity:.3}},getFieldOptions({boundaryObject:F}){const j=[{id:"Name",label:F.label,type:"Text"},{id:"AssignedTo",label:"Assigned To",type:"Text"}];return SPM.$store.assignmentObjects.filter(Y=>{var J,he;return(he=(J=Y.recordsDataset)==null?void 0:J.dimensions)==null?void 0:he.find(be=>be.id===F.name)}).forEach(Y=>{j.push({id:`unique__${Y.id}__Id`,label:Y.label,type:"Numeric"},...Y.referenceFields.filter(J=>J.type==="Numeric").map(({id:J,label:he,type:be})=>({id:`sum__${Y.id}__${J}`,label:he,type:be})))}),Object.entries(F.metadata).forEach(([Y,{label:J,type:he,visible:be}])=>{be&&j.push({id:`BoundaryMetadata:${Y}`,label:J,type:he==="float"?"Numeric":"Text"})}),j.sort((Y,J)=>Y.label>J.label?1:Y.label<J.label?-1:0)},getDefaultColumns({boundaryObject:F}){const j=[{id:"Name",summaryFormat:"Unique"},{id:"AssignedTo",summaryFormat:"Unique"}];return SPM.$store.assignmentObjects.filter(Y=>{var J,he;return(he=(J=Y.recordsDataset)==null?void 0:J.dimensions)==null?void 0:he.find(be=>be.id===F.name)}).forEach(Y=>{j.push({id:`unique__${Y.id}__Id`,summaryFormat:"Sum"})}),j}},W={defaults:()=>({sobjectType:"sfsp__SalesNode__c",Name:"",sfsp__SalesNodes__r:[],sfsp__SalesNodeRules__r:[],sfsp__RuleLogics__c:"{}"}),buildRows({parentRow:F,childNodes:j,lazy:G,includeBoundaries:Y=!0}){const J=[];return j.forEach(he=>{const be={id:he.id,name:he.name,data:[{id:"Name",format:"Name",type:"custom",node:he},...SPM.$store.assignmentObjects.filter(Ne=>Ne.recordsDataset.dimensions).map(Ne=>({id:Ne.id,format:"Assignment",type:"custom",state:"loading",value:0,columnName:Ne.name})),...((Y?SPM.$store.boundaryObjects:[])||[]).map(Ne=>({id:Ne.id,format:"Boundary",type:"custom",state:"loading",value:0})),...he.metrics.map(Ne=>{const ke=SPM.$store.plan.sfsp__SalesMetrics__r.find(We=>We.Id===Ne.sfsp__SalesMetric__c),qe=[...Object.keys(Ne)].filter(We=>We.startsWith("sfsp__Target_Month")),ct={id:Ne.Id,format:"Allocation",type:"custom",dataType:ke.sfsp__Type__c,value:qe.reduce((We,ht)=>We+Ne[ht],0),columnName:ke.Name};return ct.overrideAmount=ke.sfsp__TargetOverrideEnabled__c?Ne.sfsp__TargetOverrideType__c==="Percentage"?Ne.sfsp__TargetOverrideAmount__c/100*ct.value:Ne.sfsp__TargetOverrideAmount__c:0,ct})],parent:F,children:[],childCount:0,expanded:!G,loaded:!G};SPM.$store.hasSalesPlanningTemplateApp&&SPM.$store.isEditor&&be.data.splice(1,0,{id:"SharedWith",format:"Shared with",type:"custom",node:he}),J.push(be),F.children.push(be)}),F.loaded=!0,F.expanded=!0,J},async importHierarchy({hierarchy:F,includeBoundaries:j=!0}){const G={},Y=he=>{he.forEach(be=>{G[be.id]=be,Y(be.children)})};Y(SPM.Components.Hierarchy.rows);let J=[F];for(;J.length;){const he=J.map(Ne=>Ne.id);J=J.reduce((Ne,ke)=>Ne.concat(ke.children.map(qe=>Object.assign(qe,{parentNode:SPM.$store.nodeMap[ke.id]||{id:ke.id,childCount:0}}))),[]);const be=J.map((Ne,ke)=>({sobjectType:"sfsp__SalesNode__c",Name:Ne.name,sfsp__SalesPlan__c:SPM.$store.plan.Id,sfsp__Parent__c:Ne.parentNode.id.replace("All Org",""),sfsp__Priority__c:Ne.parentNode.childCount+ke+1,sfsp__Color__c:SPM.Utils.Node.randomColor(),sfsp__AssignmentBehavior__c:"Exclusive"}));await SPM.Utils.CRM.upsert({records:be}),be.forEach((Ne,ke)=>{J[ke].id=Ne.Id;const qe=Ne.sfsp__Parent__c||"All Org",ct=SPM.$store.nodeMap[qe];if(!(ct!=null&&ct.children))return;const We={id:Ne.Id,name:Ne.Name,color:Ne.sfsp__Color__c,assignmentBehavior:Ne.sfsp__AssignmentBehavior__c||"Exclusive",ownerId:"",ownerName:"",level:ct.level+1,parentId:qe,childCount:0,children:[],metrics:SPM.$store.plan.sfsp__SalesMetrics__r.map(ht=>({...SPM.Utils.NodeMetric.Defaults,sfsp__SalesPlan__c:SPM.$store.plan.Id,sfsp__SalesMetric__c:ht.Id,sfsp__SalesNode__c:Ne.Id})),users:[],accessRecords:[],rules:[],ruleLogics:{},previewRuleLogics:{},assignments:[],boundaries:[],referenceData:[]};SPM.$store.nodeMap[We.id]=We,ct.children.push(We),G[We.id]=this.buildRows({parentRow:G[ct.id],childNodes:[We],includeBoundaries:j})[0]}),he.forEach(Ne=>{const ke=SPM.$store.nodeMap[Ne];!(ke!=null&&ke.children)||(ke.childCount=ke.children.length,ke.children.forEach(qe=>{qe.siblingIds=ke.children.filter(ct=>ct.id!==qe.id).map(ct=>ct.id),qe.olderSiblingIds=ke.children.slice(0,ke.children.indexOf(qe)).map(ct=>ct.id)}))}),SPM.$store.branch.descendantIds.push(...be.map(Ne=>Ne.Id))}this.calculateValues(SPM.Components.Hierarchy.rows)},getBoundaryValue({cell:F,nodeId:j,boundaryObjectId:G}){const Y=SPM.Utils.Node.getBoundaries({node:SPM.$store.nodeMap[j],boundaryObject:SPM.$store.boundaryObjects.find(J=>J.id===G)}).length;F.state="loaded",F.value=Y},async getAssignmentValues({nodeId:F,assignmentObjectId:j,referenceFields:G=[]}){var be;const Y=SPM.$store.assignmentObjects.find(Ne=>Ne.id===j);if(!((be=Y==null?void 0:Y.recordsDataset)!=null&&be.dimensions))return;const J=SPM.Utils.Node.generateSaql({node:SPM.$store.nodeMap[F],assignmentObject:Y,referenceFields:G,boundaryObjects:SPM.$store.boundaryObjects,nodeMap:SPM.$store.nodeMap,recordsDataset:Y.recordsDataset,assignmentsDataset:Y.assignmentsDataset,type:"cogroup"}),{results:he}=await SPM.Utils.Rest.invoke("RunSaql",{query:J.replace(/^ */gm,"")});return((he==null?void 0:he.records)||[]).reduce((Ne,ke)=>(Ne[ke.nodeId]={},Object.entries(ke).forEach(([qe,ct])=>{qe!=="nodeId"&&(Ne[ke.nodeId][qe]=ct)},{}),Ne),{})},calculateValues(F){const j=[],G={},Y=J=>{J.forEach(he=>{var Ne;const be=((Ne=he.parent)==null?void 0:Ne.id)||"All Org";G[be]=G[be]||{},he.data.forEach(ke=>{ke.format==="Assignment"&&ke.state==="loading"?(G[be][ke.id]=G[be][ke.id]||{},G[be][ke.id][he.id]=ke):ke.format==="Boundary"&&ke.state==="loading"&&j.push({cell:ke,nodeId:he.id,boundaryObjectId:ke.id})}),Y(he.children)})};Y(F),SPM.Utils.Async.forEachParallel(j,J=>this.getBoundaryValue(J),5),SPM.Utils.Async.forEach(Object.values(G),async J=>{await SPM.Utils.Async.forEachParallel(Object.entries(J),async([he,be])=>{const Ne=Object.keys(be),ke=Ne[Ne.length-1],qe=await this.getAssignmentValues({nodeId:ke,assignmentObjectId:he});Ne.forEach(ct=>{var ht;const We=((ht=qe[ct])==null?void 0:ht.count)||0;be[ct].value=We,be[ct].state="loaded"})},5)})},async getMaxLevel({planId:F,nodeIds:j,currentLevel:G}){if(j.includes(""))throw new Error("Blank node id is not supported");const Y=await SPM.Utils.Apex.invoke("Query",[`SELECT Id FROM sfsp__SalesNode__c WHERE sfsp__SalesPlan__c = '${F}' AND sfsp__Parent__r.sfsp__Parent__r.sfsp__Parent__r.sfsp__Parent__r.sfsp__Parent__r.Id IN ('${j.join("','")}')`]);if(Y.length)return W.getMaxLevel({planId:F,nodeIds:Y.map(J=>J.Id),currentLevel:G+5});for(let J=4;J>0;J--){const he=Array(J).fill().map(Ne=>"sfsp__Parent__r").join(".");if((await n.invoke("Query",[`SELECT Id FROM sfsp__SalesNode__c WHERE sfsp__SalesPlan__c = '${F}' AND ${he}.Id IN ('${j.join("','")}') LIMIT 1`])).length)return G+J}return G},async getNodeLevel({nodeId:F}){var G,Y,J,he,be;let j=1;for(;F;){const Ne=(await n.invoke("Query",[`
                    SELECT Id,
                        sfsp__Parent__r.Id,
                        sfsp__Parent__r.sfsp__Parent__r.Id,
                        sfsp__Parent__r.sfsp__Parent__r.sfsp__Parent__r.Id,
                        sfsp__Parent__r.sfsp__Parent__r.sfsp__Parent__r.sfsp__Parent__r.Id,
                        sfsp__Parent__r.sfsp__Parent__r.sfsp__Parent__r.sfsp__Parent__r.sfsp__Parent__r.Id
                    FROM sfsp__SalesNode__c WHERE Id = '${F}'
                `]))[0];let ke=Ne;for(;ke=(G=ke==null?void 0:ke.sfsp__Parent__r)==null?void 0:G.Id;)j++;F=(be=(he=(J=(Y=Ne==null?void 0:Ne.sfsp__Parent__r)==null?void 0:Y.sfsp__Parent__r)==null?void 0:J.sfsp__Parent__r)==null?void 0:he.sfsp__Parent__r)==null?void 0:be.sfsp__Parent__r.Id}return j},async getDescendantIds({planId:F,nodeIds:j}){if(!j||j.length===0)return[];const G=(await n.invoke("Query",[`
                SELECT Id, sfsp__SalesPlan__c, sfsp__Parent__r.Id FROM sfsp__SalesNode__c WHERE sfsp__Parent__r.Id IN ('${j.join("','")}') AND sfsp__SalesPlan__c = '${F}'
            `])).map(Y=>Y.Id);return[...G,...await W.getDescendantIds({planId:F,nodeIds:G})]},async getAncestorIds({nodeId:F}){if(!F||F==="All Org")return[];let j=(await n.invoke("Query",[`
                SELECT Id,
                    sfsp__Parent__r.Id,
                    sfsp__Parent__r.sfsp__Parent__r.Id,
                    sfsp__Parent__r.sfsp__Parent__r.sfsp__Parent__r.Id,
                    sfsp__Parent__r.sfsp__Parent__r.sfsp__Parent__r.sfsp__Parent__r.Id,
                    sfsp__Parent__r.sfsp__Parent__r.sfsp__Parent__r.sfsp__Parent__r.sfsp__Parent__r.Id
                FROM sfsp__SalesNode__c WHERE Id = '${F}'
            `]))[0];const G=[];for(;j=j.sfsp__Parent__r;)G.push(j.Id);return[...G,...await W.getAncestorIds({nodeId:G[4]}),"All Org"]},async loadScope({planId:F,metrics:j=[],nodeMap:G={},loadRuleItems:Y=!1,loadAssignments:J=!1,rootNodeId:he,parentNodeIds:be=[]}){he&&G[he]&&(be.push(he),he=null),be=[...new Set(be)].filter(ht=>{var rt;return!((rt=G[ht||"All Org"])!=null&&rt.children)});const Ne=he?[[]]:[];let ke=0;for(;ke<be.length;)Ne.push(be.slice(ke,ke+1e3)),ke+=1e3;const qe=[];await p.forEachParallel(Ne,async ht=>{const rt=he?`(Id = '${he}' OR sfsp__Parent__c = '${he}')`:`sfsp__Parent__c IN ('${ht.join("','")}')`,fe=await n.invoke("Query",[`
                        SELECT
                            Id,
                            Name,
                            sfsp__Parent__c,
                            sfsp__Color__c,
                            sfsp__Owner__c,
                            sfsp__Owner__r.Name,
                            sfsp__AssignmentBehavior__c,
                            sfsp__RuleLogics__c,
                            sfsp__HierarchyReferenceData__c,
                            (
                                SELECT
                                    Id,
                                    sfsp__TargetOverrideAmount__c,
                                    sfsp__TargetOverrideType__c,
                                    ${Array(12).fill().map((ye,Je)=>`sfsp__Target_Month${Je+1}__c`).join(", ")},
                                    sfsp__SalesMetric__c
                                FROM sfsp__SalesNodeMetrics__r
                            ),
                            (
                                SELECT Id, Name, sfsp__SalesNode__c, sfsp__FilterLogic__c, sfsp__BooleanFilter__c, sfsp__SalesAssignmentObject__c, sfsp__SalesNodeBoundary__c
                                FROM sfsp__SalesNodeRules__r
                            ),
                            (
                                SELECT Id, Name, sfsp__SalesNode__c, sfsp__ContainerSet__c, sfsp__Filter__c, sfsp__IncludePoints__c, sfsp__SalesBoundary__c, sfsp__SalesBoundary__r.Name, sfsp__SalesBoundary__r.sfsp__ContainerSet__c, sfsp__SalesBoundary__r.sfsp__IncludePoints__c, sfsp__SalesBoundary__r.sfsp__SalesPlan__c
                                FROM sfsp__SalesNodeBoundaries__r
                            ),
                            (
                                SELECT Id, sfsp__SalesNode__c, sfsp__User__c, sfsp__User__r.Name, sfsp__Role__c
                                FROM sfsp__SalesNodeUsers__r
                            ),
                            (
                                SELECT Id
                                FROM sfsp__SalesNodes__r
                            ),
                            (
                                SELECT Id, sfsp__User__r.Name, sfsp__AccessLevel__c, sfsp__SalesNode__r.Name FROM sfsp__SalesUserAccess__r 
                            )
                        FROM sfsp__SalesNode__c
                        WHERE sfsp__SalesPlan__c = '${F}' AND ${rt}
                        ORDER BY sfsp__Priority__c ASC
                    `]);if(qe.push(...fe),Y){const ye=fe.reduce((at,it)=>((it.sfsp__SalesNodeRules__r||[]).forEach(Et=>{Et.sfsp__SalesNodeRuleItems__r=[],at[Et.Id]=Et}),at),{});(Object.keys(ye).length===0?[]:await n.invoke("Query",[`
                            SELECT Id, sfsp__SalesNodeRule__c, sfsp__Field__c, sfsp__Operator__c, sfsp__Value__c
                            FROM sfsp__SalesNodeRuleItem__c
                            WHERE sfsp__SalesNodeRule__c IN ('${Object.keys(ye).join("','")}')
                        `])).forEach(at=>ye[at.sfsp__SalesNodeRule__c].sfsp__SalesNodeRuleItems__r.push(at))}if(J){const ye=fe.reduce((at,it)=>(it.assignments=[],at[it.Id]=it,at),{});(Object.keys(ye).length===0?[]:await SPM.Utils.Rest.invoke("Query",{query:`
                            SELECT sfsp__SalesNode__c, sfsp__SalesAssignmentObject__c, sfsp__AssignmentType__c, sfsp__RecordId__c, sfsp__Status__c
                            FROM sfsp__SalesNodeAssignment__c
                            WHERE sfsp__SalesNode__c IN ('${Object.keys(ye).join("','")}') AND sfsp__Status__c != 'Deleted'
                        `})).forEach(at=>ye[at.sfsp__SalesNode__c].assignments.push(at))}},5);let ct;he&&(ct=await W.getNodeLevel({nodeId:he}),G[he]={level:ct,siblingIds:[],olderSiblingIds:[],users:[],rules:[],ruleLogics:{},previewRuleLogics:{},assignments:[],boundaries:[],referenceData:[]}),qe.forEach(ht=>{var Je,at,it;const rt=ht.sfsp__SalesNodeMetrics__r||[],fe={...G[ht.Id],id:ht.Id,name:ht.Name,color:ht.sfsp__Color__c,assignmentBehavior:ht.sfsp__AssignmentBehavior__c||"Exclusive",ownerId:ht.sfsp__Owner__c||"",ownerName:((Je=ht==null?void 0:ht.sfsp__Owner__r)==null?void 0:Je.Name)||"",level:ht.Id===he?ct:G[ht.sfsp__Parent__c||"All Org"].level+1,parentId:ht.sfsp__Parent__c||"All Org",childCount:((at=ht==null?void 0:ht.sfsp__SalesNodes__r)==null?void 0:at.length)||0,metrics:j.map(Et=>{const jt=rt.find(Nt=>Nt.sfsp__SalesMetric__c===Et.Id);return{...Ce.Defaults,sfsp__SalesNode__c:ht.Id,sfsp__SalesMetric__c:Et.Id,...jt||{}}}),users:ht.sfsp__SalesNodeUsers__r||[],accessRecords:((it=ht.sfsp__SalesUserAccess__r)==null?void 0:it.map(({sfsp__User__r:Et,sfsp__User__c:jt,sfsp__SalesNode__c:Nt})=>({name:Et.Name,userId:jt,nodeId:Nt})))||[],rules:ht.sfsp__SalesNodeRules__r||[],ruleLogics:JSON.parse(ht.sfsp__RuleLogics__c||"{}"),previewRuleLogics:{},assignments:ht.assignments||[],boundaries:ht.sfsp__SalesNodeBoundaries__r||[],referenceData:JSON.parse((ht==null?void 0:ht.sfsp__HierarchyReferenceData__c)||"[]")};G[ht.Id]=fe;const ye=G[ht.sfsp__Parent__c||"All Org"];if(ye){ye.children=ye.children||[];const Et=ye.children.findIndex(jt=>jt.id===fe.id);Et===-1?ye.children.push(fe):ye.children.splice(Et,1,fe)}}),(he?[he,...be]:be).forEach(ht=>{const rt=G[ht||"All Org"];rt.children=rt.children||[],rt.childCount=rt.children.length,rt.rules=rt.rules||[],rt.boundaries=rt.boundaries||[],rt.children.forEach(fe=>{fe.siblingIds=rt.children.filter(ye=>ye.id!==fe.id).map(ye=>ye.id),fe.olderSiblingIds=rt.children.slice(0,rt.children.indexOf(fe)).map(ye=>ye.id)})})},async loadAncestors({planId:F,nodeId:j,metrics:G=[],nodeMap:Y={},loadRuleItems:J=!1,loadAssignments:he=!1}){var ke;const be=await W.getAncestorIds({nodeId:j});if(!be.length)return;if(!Y["All Org"]){const qe=await SPM.Utils.Apex.invoke("Query",[`SELECT Id, sfsp__TargetOverrideAmount__c, sfsp__TargetOverrideType__c, ${Array(12).fill().map((We,ht)=>`sfsp__Target_Month${ht+1}__c`).join(", ")}, sfsp__SalesMetric__c FROM sfsp__SalesNodeMetric__c WHERE sfsp__SalesPlan__c = '${F}' AND sfsp__SalesNode__c = ''`]),ct=await SPM.Utils.Rest.invoke("Query",{query:`SELECT Id, Name, sfsp__SalesNode__c, sfsp__ContainerSet__c, sfsp__Filter__c, sfsp__IncludePoints__c, sfsp__SalesBoundary__c, sfsp__SalesBoundary__r.Name, sfsp__SalesBoundary__r.sfsp__ContainerSet__c, sfsp__SalesBoundary__r.sfsp__IncludePoints__c, sfsp__SalesBoundary__r.sfsp__SalesPlan__c FROM sfsp__SalesNodeBoundary__c WHERE sfsp__SalesPlan__c = '${F}' AND sfsp__SalesNode__c = ''`});Y["All Org"]={id:"All Org",name:"All Org",color:"#2C7ED0",assignmentBehavior:SPM.$store.plan.sfsp__AssignmentBehavior__c||"Exclusive",ownerId:SPM.$store.plan.sfsp__Owner__c||"",ownerName:((ke=SPM.$store.plan.sfsp__Owner__r)==null?void 0:ke.Name)||"",level:0,metrics:G.map(We=>{const ht=qe.find(rt=>rt.sfsp__SalesMetric__c===We.Id);return{...Ce.Defaults,sfsp__SalesMetric__c:We.Id,...ht||{}}}),users:SPM.$store.plan.sfsp__SalesPlanUsers__r||[],accessRecords:SPM.$store.plan.sfsp__SalesUserAccess__r.filter(We=>!We.sfsp__SalesNode__c&&!SPM.$store.availableAdminIds.has(We.sfsp__User__c)&&!SPM.$store.availableManagerIds.has(We.sfsp__User__c)).map(({sfsp__User__r:We,sfsp__User__c:ht})=>({name:We.Name,userId:ht,nodeId:"All Org"}))||[],rules:[],ruleLogics:{},previewRuleLogics:{},assignments:[],boundaries:ct,siblingIds:[],olderSiblingIds:[]},await W.loadScope({planId:F,metrics:G,nodeMap:Y,loadRuleItems:J,loadAssignments:he,parentNodeIds:[""]})}let Ne=Y["All Org"].children.find(qe=>qe.id===j||be.includes(qe.id));for(;Ne.id!==j;)await W.loadScope({planId:F,metrics:G,nodeMap:Y,loadRuleItems:J,loadAssignments:he,parentNodeIds:[Ne.id]}),Ne=Ne.children.find(qe=>qe.id===j||be.includes(qe.id))},getProjectionFields({node:F,referenceFields:j}){const G=new Set(["Id"]);j.forEach(J=>G.add(J.name));const Y=J=>{if(J.parentId){const he=SPM.$store.nodeMap[J.parentId];[...he.rules,...he.previewRules||[]].forEach(Ne=>{(Ne.sfsp__SalesNodeRuleItems__r||[]).forEach(ke=>{G.add(ke.sfsp__Field__c)})}),[...he.olderSiblingIds].forEach(Ne=>{const ke=SPM.$store.nodeMap[Ne];[...ke.rules,...ke.previewRules||[]].forEach(ct=>{(ct.sfsp__SalesNodeRuleItems__r||[]).forEach(We=>{G.add(We.sfsp__Field__c)})})}),Y(he)}};return Y(F),[...F.olderSiblingIds,F.id].forEach(J=>{const he=SPM.$store.nodeMap[J];[...he.rules,...he.previewRules||[]].forEach(Ne=>{(Ne.sfsp__SalesNodeRuleItems__r||[]).forEach(ke=>{G.add(ke.sfsp__Field__c)})})}),G},generateSaql({node:F,assignmentObject:j,boundaryObjects:G,projectionFields:Y,referenceFields:J=[],nodeMap:he,recordIds:be,type:Ne,returnType:ke="count",descendantNodes:qe=[],descendantSaql:ct="",prefix:We="",skipLoad:ht=!1,isBurndown:rt=!1}){const fe=[...j.recordsDataset.dimensions].map(St=>St.id),ye=[...j.recordsDataset.measures].map(St=>St.id),Je="Id";We=We?`${We}_`:"",Y||(ke==="count"?Y=this.getProjectionFields({node:F,referenceFields:J}):Y=new Set([...fe,...ye]));const at=J.reduce((St,Ct)=>{const Bt=Ct.type==="Text"?"unique":"sum";return St+=` ${Bt}('${Ct.name}') as ${Ct.name},`,St},"");function it(St=""){const Ct=St?`${St}.`:"";return[...fe.filter(Bt=>Y.has(Bt)).map(Bt=>`${Ct}${Bt} as ${Bt}`),...ye.filter(Bt=>Y.has(Bt)).map(Bt=>`sum(${Ct}${Bt}) as ${Bt}`)].join(", ")}function Et(){return`(${fe.filter(St=>Y.has(St)).map(St=>St).join(", ")})`}if(!F.parentId){const St=rt&&F===SPM.$store.rootNode?[F,...qe]:qe;return`
                    ${ht?"":`
                            -- load records
                            q = load "${j.recordsDataset.id}/${j.recordsDataset.currentVersionId}";
                        `}

                    ------------------------------------------------------------------
                    -- All Possible
                    ------------------------------------------------------------------
                    ${be?`
                            all_possible = filter q by ${Je} in ${JSON.stringify(be)};
                            all_possible = foreach all_possible generate ${it()};
                        `:`
                            all_possible = filter q by ${St.length?`(${St.map(Ct=>this.generateRules(Ct,he,j,G,Je,rt&&Ct===SPM.$store.rootNode)).join(") && (")})`:`${Je} is not null`};
                            all_possible = foreach all_possible generate ${it()};
                        `}
                    ${ct||(ke==="count"?`
                            -- All Org
                            ${We}all_possible = group all_possible by all;
                            ${We}all_possible = foreach all_possible generate "All Org" as nodeId,${at} count() as count;
                        `:`
                            -- all records
                            ${We}all_possible = filter all_possible by ${Je} != "";
                        `)}
                `.replace(/^ */gm,"")}const jt=he[F.parentId||"All Org"].assignmentBehavior==="Exclusive";let Nt="";if([...F.olderSiblingIds.map(St=>he[St]),F].forEach((St,Ct)=>{const Bt=St.parentId.replace("All Org","");Nt+=`
                    ------------------------------------------------------------------
                    -- ${St.name}${St.id!==F.id?`(${F.name} sibling)`:""}
                    ------------------------------------------------------------------
                `,Nt+=`
                    -- rules
                    ${St.id} = filter ${Bt||"all_possible"} by ${this.generateRules(St,he,j,G,Je,rt&&St===SPM.$store.rootNode)};
                `,jt&&(Ct===0?Nt+=`
                            -- exclusions
                            exclusions = union ${St.id}, ${St.id};
                        `:(Nt+=Ne==="join"?`
                                -- remove exclusions from older siblings
                                ${St.id} = join ${St.id} by ${Je} anti, exclusions by ${Je};
                            `:`
                                -- remove exclusions from older siblings
                                ${St.id} = cogroup ${St.id} by ${Et()} left, exclusions by ${Et()};
                                ${St.id} = foreach ${St.id} generate ${it(St.id)}, exclusions.${Je} as UnexceptionId;
                                ${St.id} = filter ${St.id} by UnexceptionId is null;
                            `,Nt+=`
                            -- exclusions
                            exclusions = union exclusions, ${St.id};
                        `))}),!ct)if(Nt+=`
                    ------------------------------------------------------------------
                    -- Results
                    ------------------------------------------------------------------
                `,ke==="count"){const St=[];[he[F.parentId],...F.olderSiblingIds.map(Ct=>he[Ct]),F].forEach(Ct=>{const Bt=Ct.id==="All Org"?"all_possible":Ct.id;Nt+=`
                            -- ${Ct.name}
                            ${We}${Bt} = group ${Bt} by all;
                            ${We}${Bt} = foreach ${We}${Bt} generate "${Ct.id}" as nodeId,${at} count() as count;
                        `,St.push(`${We}${Bt}`)}),Nt+=`
                        -- union results for target node, parent node, older siblings
                        results = union ${St.join(", ")};
                    `}else Nt+=`
                        -- all records
                        ${We}${F.id} = filter ${F.id} by ${Je} != "";
                    `;return this.generateSaql({node:he[F.parentId||"All Org"],assignmentObject:j,boundaryObjects:G,projectionFields:Y,nodeMap:he,recordIds:be,type:Ne,descendantNodes:ct?[F,...qe]:qe,descendantSaql:Nt+ct})},generateRules(F,j,G,Y,J,he){var rt,fe;const be=(F.previewRules||F.rules).filter(ye=>ye.sfsp__SalesAssignmentObject__c===G.id&&ye.state!=="deleted"),Ne=(F.previewRules||F.rules).filter(ye=>{var it,Et,jt;const Je=(it=Y==null?void 0:Y.find(Nt=>Nt.id===ye.sfsp__SalesNodeBoundary__c))==null?void 0:it.name;return(jt=(Et=G.recordsDataset)==null?void 0:Et.dimensions)==null?void 0:jt.some(Nt=>Nt.id===Je)}),ke=(F.previewAssignments||F.assignments).filter(ye=>ye.sfsp__SalesAssignmentObject__c===G.id&&ye.sfsp__Status__c!=="Deleted"),qe=he?F.children:[];if(be.length===0&&Ne.length===0&&ke.length===0&&qe.length===0)return`${J} is null`;const ct=[];if(be.length){const ye=((rt=F==null?void 0:F.previewRuleLogics)==null?void 0:rt[G.id])||((fe=F==null?void 0:F.ruleLogics)==null?void 0:fe[G.id])||Array(be.length).fill().map((at,it)=>it+1).join(" or "),Je=SPM.Utils.Filter.mergeBooleanFilter(ye,be.map(at=>O.toSaql(at,G)));ct.push(`(${Je})`)}Ne.length&&ct.push(`(${Ne.map(ye=>O.toSaql(ye,G)).join(" || ")})`),ke.length&&ct.push(`${J} in ${JSON.stringify(ke.map(ye=>ye.sfsp__RecordId__c))}`);const We=[];if(ct.length&&We.push(`(${ct.join(" || ")})`),j[F.parentId||"All Org"].assignmentBehavior==="Exclusive"){const ye=W.getUnexceptionIds(F,j,G);ye.length&&We.push(`${J} not in ${JSON.stringify(ye)}`)}if(qe.length){const ye=qe.map(Je=>`(${W.generateRules(Je,j,G,Y,J)})`);We.push(`!(${ye.join(" || ")})`)}return We.join(" && ")},getUnexceptionIds(F,j,G){const Y=(F.previewAssignments||F.assignments).filter(he=>he.sfsp__SalesAssignmentObject__c===G.id&&he.sfsp__Status__c!=="Deleted").reduce((he,be)=>(he[be.sfsp__RecordId__c]=be,he),{}),J=[];return F.siblingIds.forEach(he=>{const be=j[he],Ne=F.olderSiblingIds.includes(he);(be.previewAssignments||be.assignments).forEach(ke=>{ke.sfsp__SalesAssignmentObject__c!==G.id||ke.sfsp__Status__c==="Deleted"||(Ne||!Y[ke.sfsp__RecordId__c])&&(J[ke.sfsp__RecordId__c]=ke)})}),Object.keys(J)},getDescendants({nodes:F}){if(F.length===0)return[];const j=F.reduce((G,Y)=>G.concat(Y.children||[]),[]);return[...F,...W.getDescendants({nodes:j})]},getAncestors({node:F,nodeMap:j}){const G=[];for(;F=j[F.parentId];)G.unshift(F);return G},isAncestor({node:F,ancestor:j,nodeMap:G}){for(;F=G[F.parentId];)if(F===j)return!0;return!1},async getChildren({node:F}){const j=[];return(await SPM.Utils.Apex.invoke("Query",[`
                    SELECT
                        Id,
                        Name,
                        sfsp__Parent__c,
                        (
                            SELECT
                                Id,
                                sfsp__TargetOverrideAmount__c,
                                sfsp__TargetOverrideType__c,
                                ${Array(12).fill().map((Y,J)=>`sfsp__Target_Month${J+1}__c`).join(", ")},
                                sfsp__SalesMetric__c
                            FROM sfsp__SalesNodeMetrics__r
                        ),
                        (
                            SELECT Id
                            FROM sfsp__SalesNodes__r
                        )
                    FROM sfsp__SalesNode__c
                    WHERE sfsp__SalesPlan__c = '${SPM.$store.plan.Id}' AND sfsp__Parent__c = '${F.id}'
                `])).forEach(Y=>{var J;j.push({id:Y.Id,name:Y.Name,parentId:Y.sfsp__Parent__c||"All Org",childCount:((J=Y.sfsp__SalesNodes__r)==null?void 0:J.length)||0,metrics:SPM.$store.plan.sfsp__SalesMetrics__r.map(he=>{const be=(Y.sfsp__SalesNodeMetrics__r||[]).find(Ne=>Ne.sfsp__SalesMetric__c===he.Id);return{...Ce.Defaults,sfsp__SalesNode__c:F.id,sfsp__SalesMetric__c:he.Id,...be||{}}})})}),j},isExclusiveBranch({node:F}){return W.getDescendants({nodes:[F]}).every(j=>j.assignmentBehavior==="Exclusive")},getBoundaryObjects({node:F,nodeMap:j,includeDescendants:G=!1}){return[...W.getAncestors({node:F,nodeMap:j}),...G?W.getDescendants({nodes:[F]}):[F]].reduce((Y,J)=>(Y.push(...(J.boundaries||[]).map(he=>{const be=SPM.$store.salesBoundaries.find(ct=>ct.Id===he.sfsp__SalesBoundary__c),Ne=SPM.$store.containerSets[he.sfsp__ContainerSet__c],ke=(be==null?void 0:be.sfsp__IncludePoints__c)||he.sfsp__IncludePoints__c,qe=be?`${J.id==="All Org"||he.sfsp__SalesBoundary__c?SPM.$store.plan.Id:J.id}_${he.sfsp__ContainerSet__c}${ke?"_points":""}`:`${J.id==="All Org"?SPM.$store.plan.Id:J.id}_${he.sfsp__ContainerSet__c}`;return{id:he.Id,containerSetId:(be==null?void 0:be.sfsp__ContainerSet__c)||he.sfsp__ContainerSet__c,salesBoundary:he==null?void 0:he.sfsp__SalesBoundary__c,rootNodeId:J.id,name:qe,includesPoints:ke,label:Ne.label,metadata:Ne.metadata,assignmentCount:0,totalCount:Ne.size+(he.sfsp__IncludePoints__c?Object.keys(Ne.childContainers||{}).length:0),progress:null,icon:{category:"standard",name:"address",color:"#3BA755"}}})),Y),[])},getBoundaries({node:F,boundaryObject:j,format:G="array"}){let Y=SPM.$store.containerSets[j.containerSetId].containers;if(j.includesPoints||(Y=Object.keys(Y).filter(qe=>!Y[qe].parent).reduce((qe,ct)=>(qe[ct]=Y[ct],qe),{})),j.rootNodeId===F.id)return G==="map"?Object.values(Y).reduce((qe,ct)=>(qe[ct.name]=!0,qe),{}):Object.values(Y).map(qe=>qe.name);const J=(F.previewRules||F.rules).find(qe=>qe.sfsp__SalesNodeBoundary__c===j.id),he=((J==null?void 0:J.sfsp__SalesNodeRuleItems__r)||[]).reduce((qe,ct)=>(ct.sfsp__Value__c.split(",").forEach(We=>qe[We]=!0),qe),{}),be=Object.keys(he),ke=SPM.Utils.Rule.unsimplifyValues(Object.values(Y).map(qe=>qe.name),be).map(qe=>Y[qe]);return G==="map"?ke.reduce((qe,ct)=>(qe[ct.name]=!0,qe),{}):ke.map(qe=>qe.name)},async getBoundaryData({nodes:F,boundaryObject:j}){var be,Ne;const G={};W.getDescendants({nodes:F}).forEach(ke=>{ke.level>SPM.$store.scope||SPM.Utils.Node.getBoundaries({node:ke,boundaryObject:j}).forEach(qe=>{G[qe]=G[qe]||[];const ct=[];let We=!1;G[qe].forEach(ht=>{if(SPM.Utils.Node.isAncestor({node:ht,ancestor:ke,nodeMap:SPM.$store.nodeMap})){We=!0;return}else SPM.Utils.Node.isAncestor({node:ke,ancestor:ht,nodeMap:SPM.$store.nodeMap})||ct.push(ht)}),We||ct.push(ke),G[qe]=ct})});const Y=SPM.$store.assignmentObjects.filter(ke=>{var qe,ct;return(ct=(qe=ke.recordsDataset)==null?void 0:qe.dimensions)==null?void 0:ct.find(We=>We.id===j.name)}),J=SPM.$store.containerMap[j.containerSetId],he={};Object.keys(G).forEach(ke=>{he[ke]={id:ke,label:J[ke].label,nodeId:G[ke][0].id,AssignedTo:G[ke].map(qe=>qe.name).join(", ")},Y.forEach(qe=>he[ke][qe.id]=0)});for(const ke of Y){let qe="";F.forEach(rt=>{qe+=SPM.Utils.Node.generateSaql({node:rt,assignmentObject:ke,boundaryObjects:SPM.$store.boundaryObjects,nodeMap:SPM.$store.nodeMap,type:"cogroup",returnType:"records",prefix:"boundary",skipLoad:!!qe})});let ct="all_possible";F.length>1?qe+=`
                        ------------------------------------------------------------------
                        -- Combine Filter Nodes
                        ------------------------------------------------------------------
                        all_possible = union ${F.map(rt=>`boundary_${rt.id}`).join(", ")};
                    `:ct=`boundary_${F[0].id.replace("All Org","all_possible")}`;const We=(Ne=(be=ke.recordsDataset)==null?void 0:be.dimensions)==null?void 0:Ne.find(rt=>rt.id===j.name);qe+=`
                    ------------------------------------------------------------------
                    -- Boundary Aggregation
                    ------------------------------------------------------------------
                    boundaries = group ${ct} by ${`'${We.id}'`};
                    boundaries = foreach boundaries generate ${`'${We.id}' as '${We.id}'`}, count() as '${ke.id}';
                    boundaries = order boundaries by '${ke.id}' desc;
                `;const{results:ht}=await SPM.Utils.Rest.invoke("RunSaql",{query:qe.replace(/^ */gm,"")});((ht==null?void 0:ht.records)||[]).forEach(rt=>{const fe=he[rt[We.id]];fe&&(fe[ke.id]=rt[ke.id])})}return Object.values(he)},async getAssignments({recordIds:F,assignmentObject:j,nodes:G=SPM.$store.scopeChildNodes}){const Y=F.reduce((J,he)=>(J[he]=[],J),{});return await p.forEachParallel(G,async J=>{const he=W.generateSaql({node:J,assignmentObject:j,boundaryObjects:SPM.$store.boundaryObjects,nodeMap:SPM.$store.nodeMap,recordIds:F,type:"cogroup",returnType:"records"}),{results:be}=await SPM.Utils.Rest.invoke("RunSaql",{query:he.replace(/^ */gm,"")});be.records.forEach(Ne=>{var qe,ct,We;const ke=((We=(ct=SPM.$store.nodeMap)==null?void 0:ct[(qe=Y[Ne.Id])==null?void 0:qe[0]])==null?void 0:We.level)||0;J.level>ke?Y[Ne.Id]=[J.id]:J.level===ke&&Y[Ne.Id].push(J.id)})}),Y},async getAssignmentData({nodes:F,includeDescendants:j=!1,filters:G=[],filterLogic:Y,assignmentObject:J,type:he,isBurndown:be}){let Ne="";F.forEach(qe=>{Ne+=SPM.Utils.Node.generateSaql({node:qe,assignmentObject:J,boundaryObjects:SPM.$store.boundaryObjects,nodeMap:SPM.$store.nodeMap,type:"cogroup",returnType:"records",prefix:"filter",skipLoad:!!Ne,isBurndown:be})});let ke="all_possible";if(F.length>1?Ne+=`
                    ------------------------------------------------------------------
                    -- Combine Nodes
                    ------------------------------------------------------------------
                    all_possible = union ${F.map(qe=>`filter_${qe.id.replace("All Org","all_possible")}`).join(", ")};
                `:ke=`filter_${F[0].id.replace("All Org","all_possible")}`,G.length){const qe=SPM.Utils.Filter.mergeBooleanFilter(Y||Array(G.length).fill("").map((ct,We)=>We+1).join(" and "),G.map(ct=>SPM.Utils.Filter.toSaql(ct)));Ne+=`
                    ------------------------------------------------------------------
                    -- Record Filters
                    ------------------------------------------------------------------
                    q = filter ${ke} by ${qe};
                `,ke="q"}if(he==="aggregates"){const qe=ce.getReferenceMetadata({assignmentObject:J});Ne+=`
                    ------------------------------------------------------------------
                    -- Measure Aggregation
                    ------------------------------------------------------------------
                    q = group ${ke} by all;
                    q = foreach q generate ${qe.map(We=>["min","max"].includes(We.type)?`floor(${We.type}(${We.id})) as ${We.type}__${J.id}__${We.id}`:`${We.type}(${We.id}) as ${We.type}__${J.id}__${We.id}`).join(", ")};
                `;const{results:ct}=await SPM.Utils.Rest.invoke("RunSaql",{query:Ne.replace(/^ */gm,"")});return qe.reduce((We,ht)=>{var rt,fe,ye,Je;return We[`${ht.type}__${J.id}__${ht.id}`]=["min","max"].includes(ht.type)?(fe=(rt=ct==null?void 0:ct.records)==null?void 0:rt[0])==null?void 0:fe[`${ht.type}__${J.id}__${ht.id}`]:((Je=(ye=ct==null?void 0:ct.records)==null?void 0:ye[0])==null?void 0:Je[`${ht.type}__${J.id}__${ht.id}`])||0,We},{})}if(he==="records"){Ne+=`
                    ------------------------------------------------------------------
                    -- Record Projections
                    ------------------------------------------------------------------
                    q = foreach ${ke} generate ${[...J.recordsDataset.dimensions.map(rt=>rt.id),...J.recordsDataset.measures.map(rt=>rt.id)].map(rt=>`${rt} as ${J.id}__${rt}`).join(", ")};
                `;const{results:qe}=await SPM.Utils.Rest.invoke("RunSaql",{query:Ne.replace(/^ */gm,"")}),ct=Object.values(((qe==null?void 0:qe.records)||[]).reduce((rt,fe)=>{const ye=fe[`${J.id}__Id`];return rt[ye]||(rt[ye]=fe),rt},{})),We=await SPM.Utils.Node.getAssignments({recordIds:ct.map(rt=>rt[`${J.id}__Id`]),assignmentObject:J,nodes:j?SPM.Utils.Node.getDescendants({nodes:[SPM.$store.rootNode]}):SPM.$store.scopeNodes}),ht=new Map;return ct.forEach(rt=>{var ye;const fe=rt[`${J.id}__Id`];We[fe].forEach(Je=>{ht.has(Je)||ht.set(Je,new Map(SPM.$store.nodeMap[Je].assignments.map(at=>[`${at.sfsp__RecordId__c}:${at.sfsp__SalesAssignmentObject__c}`,at])))}),rt.NodeId=((ye=We[fe])==null?void 0:ye[0])||"",rt.AssignedTo=We[fe].join(", "),rt.AssignmentType=We[fe].map(Je=>ht.get(Je).has(`${fe}:${J.id}`)?"Manual":"Rule").join(", ")||"Rule"}),ct}if(he==="saql")return{saql:Ne,rootStream:ke}},Colors:["#FFFA00","#FF6E00","#FF7B96","#D31A28","#D053FF","#6C2777","#46E71B","#6FB384","#68FFD7","#01BFBF","#ADD4F3","#2C7ED0","#e3abec","#c2dbf7","#9fd6ff","#9de7da","#9df0c0","#fff099","#fed49a","#d073e0","#86baf3","#5ebbff","#44d8be","#3be282","#ffe654","#ffb758","#bd35bd","#5779c1","#05007a","#00aea9","#3cba4c","#f5bc25","#f99221","#580d8c","#001970","#0a2399","#0b7477","#0b6b50","#b67e11","#b85d0d"],randomColor(){return SPM.Utils.Node.Colors[Math.floor(Math.random()*SPM.Utils.Node.Colors.length)]}},Ce={Defaults:{sobjectType:"sfsp__SalesNodeMetric__c",sfsp__TargetOverrideAmount__c:0,sfsp__TargetOverrideType__c:null,...[1,2,3,4,5,6,7,8,9,10,11,12].reduce((F,j)=>(F[`sfsp__Target_Month${j}__c`]=0,F[`previewValue${j}`]=void 0,F),{})},changeTarget({nodeMetric:F,period:j,index:G,target:Y,isPreview:J,startingMonth:he,customPercentages:be}){function Ne(ke){return J?`previewValue${ke}`:`sfsp__Target_Month${ke}__c`}if(be)for(let ke=1;ke<13;ke++){const qe=be[ke];F[Ne(ke)]=qe}else if(j==="Year"){const ke=Math.floor(Y/12);for(let qe=1;qe<12;qe++)F[Ne(qe)]=ke;F[Ne(12)]=ke+(Y-ke*12)}else if(j==="Quarter"){const ke=Math.floor(Y/3);let qe=he+(G-1)*3<=12?he+(G-1)*3:(he+(G-1)*3)%12;for(let ct=0;ct<2;ct++)F[Ne(qe)]=ke,qe=qe+1<=12?qe+1:(qe+1)%12;F[Ne(qe)]=ke+(Y-ke*3)}else{const ke=G+he-1<=12?G+he-1:(G+he-1)%12;F[Ne(ke)]=Y}},getTarget({nodeMetric:F,period:j="Year",index:G=0}){let Y,J;j==="Year"?(Y=1,J=12):j==="Quarter"?(Y=(G-1)*3+1,J=G*3):(Y=G,J=G);let he=0;for(let be=Y;be<=J;be++)he+=typeof F[`previewValue${be}`]>"u"?F[`sfsp__Target_Month${be}__c`]:F[`previewValue${be}`];return he}},te={generateAllocationDistributionTable(){const F=[],j=SPM.FiscalPeriod.Quarter.length,G=Math.round(100/j*10)/10;for(let Y=0;Y<j;Y++){const J=SPM.FiscalPeriod.Quarter[Y];F[Y]=F[Y]||{months:[],percent:G,label:`Quarter ${Y+1}`,previewPercent:null},F[Y].percent=G;const he=Math.round(G/J.length*10)/10;for(let ke=0;ke<J.length-1;ke++){const qe=J[ke],ct=SPM.$store.plan.fiscalPeriodLabel?SPM.app.config.globalProperties.$F("DateTime",new Date(2023,qe-1),{month:"long"}):SPM.FiscalLabels.Month[qe];F[Y].months.push({label:ct,percent:he,id:qe,previewPercent:null})}const be=J[J.length-1],Ne=SPM.$store.plan.fiscalPeriodLabel?SPM.app.config.globalProperties.$F("DateTime",new Date(2023,be-1),{month:"long"}):SPM.FiscalLabels.Month[be];F[Y].months.push({label:Ne,percent:Math.round((he+(G-he*J.length))*10)/10,id:be,previewPercent:null})}return F[j-1].percent=Math.round((G+(100-G*j))*10)/10,F},getPercentageChange(F,j){const G=j-F,Y=Math.floor(G/F*100);return Y===0||G===0?"0%":Y===1/0?`+ ${j}%`:Y>0?`+ ${Y}%`:`- ${Y*-1}%`}},oe={generateMetadata({planName:F,datasetType:j,assignmentObject:G,geoBoundaries:Y}){const J=[];JSON.parse(G.sfsp__ReferenceFields__c).forEach(be=>{const Ne={fullyQualifiedName:`${G.Id}.${be.name}`,name:be.name,label:be.label,isUniqueId:be.unique,type:be.type,isSystemField:!1,isMultiValue:!1,description:""};be.type==="Numeric"&&(Ne.precision=be.precision,Ne.scale=be.scale,Ne.defaultValue=0),["Latitude","Longitude"].includes(be.type)&&(Ne.type="Text"),J.push(Ne)});const he=[];return Y==null||Y.forEach(be=>{const Ne=`${be.sfsp__SalesNode__c||be.sfsp__SalesPlan__c}_${be.sfsp__ContainerSet__c}`,ke={fullyQualifiedName:`${G.Id}.${Ne}`,name:Ne,label:be.Name,isUniqueId:!1,type:"Text",isMultiValue:!1,description:""},qe=he.find(ct=>ct.name===ke.name);qe?Object.assign(qe,ke):he.push(ke)}),J.push(...he),j==="Assignments"&&J.push({description:"",fullyQualifiedName:`${G.Id}.AssignmentNode`,label:"Assignment Node",name:"AssignmentNode",isSystemField:!1,isUniqueId:!1,isMultiValue:!1,type:"Text"},{description:"",fullyQualifiedName:`${G.Id}.AssignmentType`,label:"Assignment Type",name:"AssignmentType",isSystemField:!1,isUniqueId:!1,isMultiValue:!1,type:"Text"}),{fileFormat:{charsetName:"UTF-8",fieldsDelimitedBy:",",fieldsEnclosedBy:'"',fieldsEscapedBy:"",linesTerminatedBy:`\r
`,numberOfLinesToIgnore:0},objects:[{connector:"SalesPlanningCSVConnector",fullyQualifiedName:G.Id,label:`${F} ${G.sfsp__Label__c} ${j}`,name:G.Name,description:"",fields:J}]}},async getDatasetRecords({alias:F,assignmentObject:j}){const{dataset:G,metadata:Y}=await SPM.Utils.AssignmentObject.getDatasetInfo({alias:F});Object.assign(G,{measures:Y.measures.map(be=>({type:"measure",id:be.field,title:be.label})),measuresMetadata:Y.measures,dimensions:Y.dimensions.map(be=>({type:"dimension",id:be.field,title:be.label}))});const J={},he=JSON.parse(j.sfsp__ReferenceFields__c).find(be=>be.unique).name;return await async function be(Ne,ke){const qe=`
                    // total records
                    records_batch = load "${G.id}/${G.currentVersionId}";
                    records_batch = foreach records_batch generate ${G.dimensions.concat(G.measures).map(ht=>`'${ht.id}' as '${ht.id}'`).join(", ")};
                    records_batch = order records_batch by '${he}';
                    records_batch = offset records_batch ${Ne};
                    records_batch = limit records_batch ${ke};
                `,{query:ct,results:We}=await SPM.Utils.Rest.invoke("RunSaql",{query:qe.replace(/^ */gm,"")})||{query:"",records:[]};We.records.forEach(ht=>{J[ht[he]]=ht}),We.records.length===ke&&await be(Ne+ke,ke)}(0,1e4),J},async updateDataset({planId:F,planName:j,datasetType:G,assignmentObject:Y,geoBoundaries:J,rowsToUpdate:he}){const be=this.generateMetadata({planName:j,datasetType:G,assignmentObject:Y,geoBoundaries:J}),Ne=await SPM.Utils.Rest.invoke("CreateExternalDataJob",{metadata:e.from(JSON.stringify(be,0,4)).toString("base64"),alias:`${F}_${Y.Id}_${G}`,operation:"Overwrite"});if(!Ne.success)throw Ne.errors[0]||"";const ke=[];if(G==="Records"){const ct=await this.getDatasetRecords({alias:`${F}_${Y.Id}_Records`,assignmentObject:Y}),We=JSON.parse(Y.sfsp__ReferenceFields__c).find(fe=>fe.unique).name;he.forEach(fe=>{const ye=ct[fe[We]];ye&&(Object.keys(fe).forEach(Je=>{ye[Je]=fe[Je]}),ct[fe[We]]=ye)});const ht=[],rt=Object.values(ct);for(;rt.length;)ht.push(rt.splice(0,1e6).map(fe=>be.objects[0].fields.map(ye=>fe[ye.name]||(ye.type==="Text"?"":0))));await p.forEachParallel(ht,async fe=>{const ye=t.unparse(fe),Je=3e6;t.parse(ye,{chunkSize:Je,chunk(at,it){ke.unshift(t.unparse(at.data))}})},5)}else if(G==="Assignments"){const ct=be.objects[0].fields.map(rt=>rt.type==="Text"?"spm_placeholder":0),We=t.unparse([ct]),ht=3e6;t.parse(We,{chunkSize:ht,chunk(rt,fe){ke.unshift(t.unparse(rt.data))}})}let qe=0;await SPM.Utils.Async.forEachParallel(ke,async ct=>{const ht=e.from(qe===ke.length-1?ct:`${ct}\r
`).toString("base64");qe+=1;const rt=await SPM.Utils.Rest.invoke("UploadCsvPart",{parentId:Ne.id,csvPart:ht,partNumber:qe});if(!rt.success)throw rt.errors[0]||""},5),await SPM.Utils.Rest.invoke("StartExternalDataJob",{parentId:Ne.id})},async createManualDataset({planId:F,planName:j,datasetType:G,assignmentObject:Y,records:J}){const he=this.generateMetadata({planName:j,datasetType:G,assignmentObject:Y}),be=await SPM.Utils.Rest.invoke("CreateExternalDataJob",{metadata:e.from(JSON.stringify(he,0,4)).toString("base64"),alias:`${F}_${Y.Id}_${G}`,operation:"Overwrite"});if(!be.success)throw be.errors[0]||"";const Ne=[];if(G==="Records"){const qe=[];for(;J.length;)qe.push(J.splice(0,1e6).map(ct=>he.objects[0].fields.map(We=>m4(We.name,ct)||(We.type==="Text"?"":0))));await p.forEachParallel(qe,async ct=>{const We=t.unparse(ct),ht=3e6;t.parse(We,{chunkSize:ht,chunk(rt,fe){Ne.unshift(t.unparse(rt.data))}})},5)}else if(G==="Assignments"){const qe=he.objects[0].fields.map(ht=>ht.type==="Text"?"spm_placeholder":0),ct=t.unparse([qe]),We=3e6;t.parse(ct,{chunkSize:We,chunk(ht,rt){Ne.unshift(t.unparse(ht.data))}})}let ke=0;await SPM.Utils.Async.forEachParallel(Ne,async qe=>{const We=e.from(ke===Ne.length-1?qe:`${qe}\r
`).toString("base64");ke+=1;const ht=await SPM.Utils.Rest.invoke("UploadCsvPart",{parentId:be.id,csvPart:We,partNumber:ke});if(!ht.success)throw ht.errors[0]||""},5),await SPM.Utils.Rest.invoke("StartExternalDataJob",{parentId:be.id})}},ve={async buildAssignmentObjectScus({balanceField:F,geoAssignment:j,selectedObject:G,selectedRecords:Y,targetNodeIds:J}){const he=SPM.$store.rootNode.id==="All Org"?SPM.$store.plan.Id:SPM.$store.rootNode.id,be=new Set;SPM.$store.boundaryObjects.forEach(qe=>be.add(qe.containerSetId));const Ne={};Y.forEach(qe=>{var Je,at;const We=Object.keys(qe).filter(it=>it.startsWith(`${G.id}__${he}`)).find(it=>!!qe[it]);let ht=qe[We]||"";const rt={Id:qe[`${G.id}__Id`],Locked:!1,Boundaries:ht||"",Weight:F==="Unit"?1:qe[`${G.id}__${F}`]||0,Volume:F==="Unit"?1:qe[`${G.id}__${F}`]||0},fe=(Je=G.latitude)==null?void 0:Je.name,ye=(at=G.longitude)==null?void 0:at.name;if(fe&&ye&&(rt.Latitude=parseFloat(qe[`${G.id}__${fe}`]),rt.Longitude=parseFloat(qe[`${G.id}__${ye}`])),j==="nonContiguous"&&(!rt.Latitude||!rt.Longitude)){const it={latitude:39.8283,longitude:98.5795},Et=944685,jt=s.randomCirclePoint(it,Et);rt.Latitude=jt.latitude,rt.Longitude=jt.longitude}rt.Latitude&&rt.Longitude&&(Ne[rt.Id]=rt)});const ke=J.map(qe=>SPM.$store.nodeMap[qe]);for(const qe of ke){const ct=SPM.Utils.Node.generateSaql({node:qe,assignmentObject:G,boundaryObjects:SPM.$store.boundaryObjects,nodeMap:SPM.$store.nodeMap,type:"cogroup",returnType:"records"}),{results:We}=await SPM.Utils.Rest.invoke("RunSaql",{query:ct.replace(/^ */gm,"")}),ht=We.records.reduce((fe,ye)=>(Object.keys(ye).filter(at=>at.startsWith(he)).forEach(at=>{let it=ye[at]||"";fe.includes(it)||(fe.length===0?fe=it:fe=`${fe},${it}`)}),fe),""),rt=We.records.reduce((fe,ye)=>Ne[ye.Id]?fe:fe+(F==="Unit"?1:ye[F]||0),0);Ne[`${qe.id}-Rollup`]={Id:`${qe.id}-Rollup`,Assignment:qe.id,Boundaries:ht,Locked:!0,Latitude:39.8283,Longitude:98.5795,Weight:rt,Volume:rt}}return{scus:[...Object.values(Ne)],containerSetIds:be}},async buildBoundaryObjectScus({balanceField:F,selectedObject:j,selectedBoundaries:G,node:Y}){var ke,qe;const J={},he=SPM.$store.assignmentObjects.filter(ct=>{var We,ht;return(ht=(We=ct.recordsDataset)==null?void 0:We.dimensions)==null?void 0:ht.find(rt=>rt.id===j.name)});for(const ct of he){let We="";We+=SPM.Utils.Node.generateSaql({node:Y,assignmentObject:ct,boundaryObjects:SPM.$store.boundaryObjects,nodeMap:SPM.$store.nodeMap,type:"cogroup",returnType:"records",prefix:"drilldown",skipLoad:!!We});const ht=`drilldown_${Y.id.replace("All Org","all_possible")}`,rt=(qe=(ke=ct.recordsDataset)==null?void 0:ke.dimensions)==null?void 0:qe.find(at=>at.id===j.name),fe=F==="Unit"?`count() as ${F}`:`sum('${F}') as '${F}'`;We+=`
                    ------------------------------------------------------------------
                    -- Boundary Filter
                    ------------------------------------------------------------------
                    ${ht} = filter ${ht} by ${rt.id} ${Y.id===SPM.$store.rootNode.id?"in":"not in"} ${JSON.stringify(G)};

                    ------------------------------------------------------------------
                    -- Boundary Aggregation
                    ------------------------------------------------------------------
                    boundaries = group ${ht} by ${`'${rt.id}'`};
                    boundaries = foreach boundaries generate ${`'${rt.id}' as '${rt.id}'`}, ${fe};
                `;const{query:ye,results:Je}=await SPM.Utils.Rest.invoke("RunSaql",{query:We.replace(/^ */gm,"")})||{query:"",records:[]};Je.records.forEach(at=>{const it=at[rt.id];J[it]||(J[it]=0),J[it]+=at[F]})}const be={},Ne=SPM.$store.containerMap[j.containerSetId];if(Y.id!==SPM.$store.rootNode.id){let ct="",We=0,ht=0,rt=0;Object.entries(J).forEach(([ye,Je])=>{ct.length===0?ct=ye:ct+=`, ${ye}`,ht+=Ne[ye].metadata.lat,rt+=Ne[ye].metadata.lng,We+=Je});const fe=Y.id==="All Org"?SPM.$store.plan.Id:Y.id;be[`${fe}-Rollup`]={Id:`${fe}-Rollup`,Locked:!0,Assignment:Y.id,Boundaries:ct,Weight:We,Volume:We,Latitude:ht/Object.keys(J).length,Longitude:rt/Object.keys(J).length}}else G.forEach(ct=>{const We=J[ct]||0;be[ct]={Id:ct,Locked:!1,Boundaries:ct,Weight:We,Volume:We,Latitude:Ne[ct].metadata.lat,Longitude:Ne[ct].metadata.lng}});return Object.values(be)}},ee={clearSelection(){var F,j,G;(F=window==null?void 0:window.getSelection())==null||F.empty(),(j=window==null?void 0:window.getSelection())==null||j.removeAllRanges(),(G=document==null?void 0:document.selection)==null||G.empty()},getCursorPosition(F,j,{top:G,left:Y}={}){const{offsetLeft:J,offsetTop:he}=F,be=document.createElement("div"),Ne=getComputedStyle(F);for(const ht of Ne)be.style[ht]=Ne[ht];const ke=F.tagName==="INPUT"?F.value.replace(/ /g,"."):F.value;be.textContent=ke.substr(0,j),F.tagName==="TEXTAREA"&&(be.style.height="auto"),F.tagName==="INPUT"&&(be.style.width="auto");const qe=document.createElement("span");qe.textContent=ke.substr(j)||".",be.appendChild(qe),document.body.appendChild(be),be.style.position="absolute",be.style.top="0px",be.style.left="-1000px";const{offsetLeft:ct,offsetTop:We}=qe;return document.body.removeChild(be),{x:J+ct+(Y||0),y:he+We-F.scrollTop+(G||0)}},setSearchParams(F={}){const j=new URL(window.location);for(const[G,Y]of Object.entries(F))j.searchParams.set(G,Y);window.history.replaceState({},"",j)}},ne={htmlEncode(F){return F=this.htmlDecode(F),String(F).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},htmlDecode(F){let j=F;if(typeof F=="string")if(typeof document=="object"){const G=document.createElement("textarea");G.innerHTML=F,j=G.value}else j=String(F).replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">");return j},sanitizeHTML(F){const j=document.createElement("div");return j.textContent=F,j.innerHTML},splitLines(F){return F.split(/\r?\n|\r|\n/g).filter(j=>!!j).map(j=>j.trim())},truncate(F,{length:j=80,ellipsis:G=!0}={}){return G&&F.length>j&&j>=3?`${F.slice(0,j-3)}...`:F.slice(0,j)}},Se={track(F,j){pendo.visitorId?pendo.track(F,j):console.log("Pendo is unable to track this event")}},Ue={showLogs(F="spm*"){const j="https://splunk-web.log-analytics.monitoring.aws-esvc1-useast2.aws.sfdc.is/en-US/app/search/search?q=search ",G=encodeURIComponent(` index=${SPM.instanceName} organizationId=${SPM.orgId} logRecordType=jsLog logName=${F}`);window.open(`${`${j}${G}&display.page.search.mode=verbose&dispatch.sample_ratio=1&earliest=-24h%40h&latest=now`}`)},sendLog({txnId:F=SPM.$store.txnId||Vn(),logName:j="spmLog",logPayload:G={}}){if(j==="spmEPT"&&SPM.$store.eptCaptured)return;j==="spmEPT"&&(SPM.$store.eptCaptured=!0,G.ept=window.performance.now());const Y=[{logName:j,logLevel:"INFO",logAttrs:{txnId:F,...G}}],J=document.createElement("iframe");J.style.display="none",J.name=`jslogger_${Date.now()}`,document.body.appendChild(J);const he=document.createElement("input");he.style.display="none",he.name="logLines",he.value=JSON.stringify(Y);const be=document.createElement("form");be.style.display="none",be.method="POST",be.action=`${SPM.orgDomainUrl}/_ui/common/request/servlet/JsLoggingServlet`,be.target=J.name,be.appendChild(he),document.body.appendChild(be),be.submit(),setTimeout(()=>{be.remove(),J.remove()},5e3)}},Qe={async checkAsyncJobWaitingStatus(){let F="";try{const j="sfsp__SalesAsyncJob__c",G="sfsp__Status__c";if(!(await SPM.Utils.Rest.invoke("SObject",{sObject:j})).fields.find(be=>be.name===G).picklistValues.find(be=>be.value==="Waiting")){F=`Missing status "Waiting" on the ${G} field for the sobject ${j}`;const be=`SELECT DurableId, QualifiedApiName FROM EntityDefinition WHERE QualifiedApiName = '${j}'`,Ne=await SPM.Utils.Rest.invoke("ToolingQuery",be),ke=Ne.records.length?Ne.records[0]:null;if(ke){const We=`SELECT ${(await SPM.Utils.Rest.invoke("ToolingSObject",{sObject:"CustomField"})).fields.map(fe=>fe.name).join(", ")} FROM CustomField WHERE DeveloperName = 'Status' AND EntityDefinitionId = '${ke.DurableId}' AND NamespacePrefix = 'sfsp' LIMIT 1`,ht=await SPM.Utils.Rest.invoke("ToolingQuery",We);if(!ht.records.length)throw F=`Could not find ${G} field for the sobject ${j}`,new Error(F);const rt=ht.records.find(fe=>fe.FullName===`${j}.${G}`);if(!rt.Metadata.valueSet.valueSetDefinition.value.find(fe=>fe.valueName==="Waiting")){rt.Metadata.valueSet.valueSetDefinition.value.push({color:null,default:!1,description:null,isActive:null,label:"Waiting",urls:null,valueName:"Waiting"}),rt.Metadata.valueSet.valueSettings=[];const fe={Metadata:rt.Metadata,FullName:rt.FullName},ye=rt.attributes.url;try{await SPM.Utils.Rest.invoke("ToolingSObjectPatch",{url:ye,metadata:fe})}catch(Je){throw F=`Error updating ${G} field with picklist value "Waiting" for the sobject ${j}`,new Error(Je)}}}else F=`Unable to find the sobject ${j}. Missing status "Waiting" on the ${G} field.`;F=""}}catch(j){F!==""&&SPM.$store.toast({state:"error",message:`${F}.`,subMessage:"Please contact your admin to ensure Sales Planning is properly configured.",duration:null}),console.log("checkAsyncJobWaitingStatus",j)}}},Me=p4({Buffer:e,Papa:t}),vt={getFieldValue(F,j,G,Y){const J=G.split(":")[0];let he=j.CalculatedMetadata[G];return J==="Special"?he=F.getters.getSpecialFields.find(Ne=>Ne.id===G.replace(/^Special:/,"")).getAreaValue(j):J==="Metadata"?he=j.metadata[G.replace(/^Metadata:/,"")]:J==="Property"&&(he=j[G.replace(/^Property:/,"")]),Y?he/Y:he},getLabelValue(F,j,G,Y){if(G.labelPriorityFieldId&&G.screenLabels){const he=Y[G.labelPriorityFieldId]?numeral(vt.getFieldValue(F,j,G.labelPriorityFieldId,Y[G.labelPriorityFieldId]/Y.FocusCount)).format("0.0%"):vt.getFieldValue(F,j,G.labelPriorityFieldId);if(G.screenValue>he)return""}let J=Y[G.labelFieldId]?numeral(vt.getFieldValue(F,j,G.labelFieldId,Y[G.labelFieldId]/Y.FocusCount)).format("0.0%"):vt.getFieldValue(F,j,G.labelFieldId);return G.altLabelFieldId&&(J+=G.altLabelSeparator,J+=Y[G.altLabelFieldId]?numeral(vt.getFieldValue(F,j,G.altLabelFieldId,Y[G.altLabelFieldId]/Y.FocusCount)).format("0.0%"):vt.getFieldValue(F,j,G.altLabelFieldId)),J}},Ut={getFieldValue(F,j,G,Y){const J=G.split(":")[0];let he=j.CalculatedMetadata[G];return J==="Special"?he=F.getters.getSpecialFields.find(Ne=>Ne.id===G.replace(/^Special:/,"")).getUnitValue(j):J==="Metadata"?he=j.Metadata[G.replace(/^Metadata:/,"")]:J==="ContainerMetadata"?he=F.state.containerSets.find(be=>be.id===j.ContainerSetId).containers[j.ContainerId].metadata[G.replace(/^ContainerMetadata:/,"")]:J==="Property"&&(he=j[G.replace(/^Property:/,"")]),Y?he/Y:he},getLabelValue(F,j,G,Y){if(G.labelPriorityFieldId&&G.screenLabels){const he=Y[G.labelPriorityFieldId]?numeral(Ut.getFieldValue(F,j,G.labelPriorityFieldId,Y[G.labelPriorityFieldId]/Y.FocusCount)).format("0.0%"):Ut.getFieldValue(F,j,G.labelPriorityFieldId);if(G.screenValue>he)return""}let J=Y[G.labelFieldId]?numeral(Ut.getFieldValue(F,j,G.labelFieldId,Y[G.labelFieldId]/Y.FocusCount)).format("0.0%"):Ut.getFieldValue(F,j,G.labelFieldId);return G.altLabelFieldId&&(J+=G.altLabelSeparator,J+=Y[G.altLabelFieldId]?numeral(Ut.getFieldValue(F,j,G.altLabelFieldId,Y[G.altLabelFieldId]/Y.FocusCount)).format("0.0%"):Ut.getFieldValue(F,j,G.altLabelFieldId)),J}},Rt={getFieldValue(F,j,G,Y){const J=G.split(":")[0];let he=j.CalculatedMetadata[G];return J==="Special"?he=F.getters.getSpecialFields.find(Ne=>Ne.id===G.replace(/^Special:/,"")).getUnitValue(j):J==="Metadata"?he=j.Metadata[G.replace(/^Metadata:/,"")]:J==="Property"&&(he=j[G.replace(/^Property:/,"")]),Y?he/Y:he},getLabelValue(F,j,G,Y){if(G.labelPriorityFieldId&&G.screenLabels){const he=Y[G.labelPriorityFieldId]?numeral(Rt.getFieldValue(F,j,G.labelPriorityFieldId,Y[G.labelPriorityFieldId]/Y.FocusCount)).format("0.0%"):Rt.getFieldValue(F,j,G.labelPriorityFieldId);if(G.screenValue>he)return""}let J=Y[G.labelFieldId]?numeral(Rt.getFieldValue(F,j,G.labelFieldId,Y[G.labelFieldId]/Y.FocusCount)).format("0.0%"):Rt.getFieldValue(F,j,G.labelFieldId);return G.altLabelFieldId&&(J+=G.altLabelSeparator,J+=Y[G.altLabelFieldId]?numeral(Rt.getFieldValue(F,j,G.altLabelFieldId,Y[G.altLabelFieldId]/Y.FocusCount)).format("0.0%"):Rt.getFieldValue(F,j,G.altLabelFieldId)),J},get18CharacterId(F,j){let G=j.UnitId||"";if(G.length!==15)return null;for(let Y=0;Y<3;Y++){let J=0;for(let he=0;he<5;he++){const be=G.charAt(Y*5+he);be>="A"&&be<="Z"&&(J+=1<<he)}G+="ABCDEFGHIJKLMNOPQRSTUVWXYZ012345".charAt(J)}return G}};return{Debug:!1,Apex:n,Rest:r,Pendo:Se,Splunk:Ue,HTTP:a,CRM:o,CRMA:d,ExternalData:oe,Async:p,Store:y,Obj:v,Arr:C,Tree:I,Rule:O,Filter:A,DeferredPromise:P,AutoAssignment:ve,Plan:q,AssignmentObject:ce,BoundaryObject:re,Node:W,NodeMetric:Ce,Browser:ee,Str:ne,Map:h4,Segment:Me,Allocation:te,Area:vt,Container:Ut,Unit:Rt,PkChunking:{encode(F,j){let G=j.byCode;if(F===0)return G[0];for(var Y="",J=j.length;F>0;)Y=G[F%J]+Y,F=Math.floor(F/J);return Y},decode(F,j){var G=j.byChar,Y=0,J=F.length,he=j.length,be,Ne;for(be=0;be<J;be++)Ne=F[be],Y+=G[Ne]*Math.pow(he,J-be-1);return Y},indexCharset(F){var j={},G={},Y=F.length,J,he;for(J=0;J<Y;J++)he=F[J],j[J]=he,G[he]=J;return{byCode:j,byChar:G,length:Y}},convertSalesforceIdToLong(F){const j=F.substring(6,15),G="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",Y=this.indexCharset(G);return this.decode(j,Y)},convertLongToSalesforceId(F,j){const G="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",Y=this.indexCharset(G),J=Number(j),he=this.encode(J,Y).padStart(9,0);return F+he},chunkIdRange(F,j,G){const Y=F.substring(0,6),J=this.convertSalesforceIdToLong(F),he=this.convertSalesforceIdToLong(j);return this.chunkRange(J,he,9,G).map(Ne=>{const ke=this.convertLongToSalesforceId(Y,Ne.first),qe=this.convertLongToSalesforceId(Y,Ne.last);return{first:ke,last:qe}})},chunkRange(F,j,G,Y){const J=j-F,he=[];if(J<Y)he.push({first:F,last:j});else{const Ne=Math.trunc(J/Y);let ke=F,qe=F+Y-1;he.push({first:ke,last:qe});for(let We=1;We<Ne;We++)ke=qe+1,qe=ke+Y-1,he.push({first:ke,last:qe});const ct=he[he.length-1].last;ct<j&&he.push({first:ct+1,last:j})}return he.map(Ne=>({first:(Ne.first||"").toString().padStart(G,0),last:(Ne.last||"").toString().padStart(G,0)}))},calculateFragmentation(F,j,G){const Y=this.convertSalesforceIdToLong(F);return(this.convertSalesforceIdToLong(j)-Y)/G},splitIdChunk(F,j,G){const Y=this.convertSalesforceIdToLong(F),he=this.convertSalesforceIdToLong(j)-Y,be=Math.ceil(he/G)+1;return this.chunkIdRange(F,j,be)},calculateChunkSizeToSplitRange(F,j,G){const Y=this.convertSalesforceIdToLong(F),he=this.convertSalesforceIdToLong(j)-Y;return Math.ceil(he/G)+1}},Version244:Qe}}const Cp={name:"ConditionalWrapper",functional:!0,inheritAttrs:!1,props:{element:{type:String,required:!0},active:Boolean},render(){const e=this.$slots.default?this.$slots.default():null;return this.$props.active?An(this.$props.element,{...this.$attrs},e):e}},mh=Object.freeze({MANAGEMENT:"Management",APPROVAL_PROCESS:"ApprovalProcess",STATUS:"Status",ALLOCATION:"Allocation",ASSIGNMENT:"Assignment",HIERARCHY:"Hierarchy",SHARING:"Sharing",CUSTOM:"Custom"}),ma=Object.freeze({CREATE:"Created",UPDATE:"Updated",DELETE:"Deleted",REFRESH:"Refreshed",ADD:"Added",REMOVE:"Removed",CUSTOM:"Custom"});mh.MANAGEMENT+"",ma.CREATE+"",ma.UPDATE+"",ma.DELETE+"",ma.REFRESH+"",mh.SHARING+"",ma.CREATE+"",ma.UPDATE+"",ma.DELETE+"",ma.ADD+"",ma.REMOVE+"",mh.CUSTOM+"",ma.CUSTOM+"";const og=Object.freeze({ASSIGNMENT:"Assignment",METRIC:"Metric",PLAN:"Plan",SCENARIO:"Scenario",CUSTOM:"Custom"});Object.freeze({ALL:"all",OWN:"own"});Object.freeze({OLDEST:"ASC",NEWEST:"DESC"});const _4=dk({}),pm=async(e=[])=>await _4.CRM.upsert({records:e.map(({description:t,name:s,parentId:n,nodeId:r,recordType:a,subtype:o,type:d})=>({sobjectType:"sfsp__SalesActivity__c",Name:s,sfsp__Description__c:t,sfsp__RecordType__c:a,sfsp__SalesPlan__c:n,sfsp__SalesNode__c:r,sfsp__Subtype__c:o,sfsp__Type__c:d}))}),km=ON("main",{state:()=>({txnId:Vn(),eptCaptured:!1,showPreview:!1,toasts:[],showOnLoadToasts:!0,preferences:{AssignmentExplorer:{mode:"Grid"},RecordExplorer:{mode:"Aggregation",columns:{}},Map:{layers:[{type:"basemap",id:"labels",label:"Labels",icon:"text",styles:{visible:!0}},{type:"basemap",id:"roads",label:"Roads",icon:"travel_and_places",styles:{visible:!0}},{type:"basemap",id:"background",label:"Background",icon:"world",styles:{visible:!0}}]}},plan:{sfsp__ListViews__r:[],sfsp__SalesMetrics__r:[],sfsp__SalesAssignmentObjects__r:[]},rootNode:{},nodeMap:{},maxLevel:0,scope:0,assignmentObjects:[],salesAsyncJobs:[],salesBoundaries:[],filters:[],filterLogic:"",filteredNodeIds:[],allContainerSetsLoaded:!1,allManagedContainerSetsLoaded:!1,containerSets:{},activeContainerSets:{},containerMap:{},hasSalesPlanningTemplateApp:!1,userAccessRecords:[],availableAdminIds:new Set,availableManagerIds:new Set,branch:{id:"All Org",name:"All Org",accessLevel:"Editor",descendantIds:[]}}),getters:{hasDataPipelinesAccess:e=>SPM.hasDataPipelinesAccess,isAdmin:e=>SPM.isAdmin,isManager:e=>SPM.isManager,isEditor:e=>SPM.isAdmin||SPM.isManager||e.branch.accessLevel==="Editor",rootNodeAncestors:e=>SPM.Utils.Node.getAncestors({node:e.rootNode,nodeMap:e.nodeMap}),allNodes:e=>Object.values(e.nodeMap),scopes:e=>{var n;const t=SPM.Components.Root.activeTab==="Assignment",s=((n=e.rootNode)==null?void 0:n.level)||0;return Array(Math.max(1,e.maxLevel-s)).fill().reduce((r,a,o)=>{const d=s+o+1,p=o===0||e.rootNode.assignmentBehavior==="Exclusive"&&r.every(y=>!y.disabled)&&e.allNodes.every(y=>y.level!==d||y.assignmentBehavior==="Exclusive");return r.concat([{id:d,title:`Level ${d}${t&&!p?" (Non-Exclusive)":""}`,isExclusive:p}])},[])},scopeNodes:e=>{const t=[e.rootNode];let s=e.rootNode.level,n=e.rootNode.children||[];for(;s++<e.scope;){const r=[];n.forEach(a=>{const o=e.nodeMap[a.id].children||[];s===e.scope||o.length===0?t.push(Object.assign(a,{level:s})):r.push(...o)}),n=r}return t},scopeChildNodes(){return this.scopeNodes.slice(1)},boundaryObjects(){return this.rootNode?SPM.Utils.Node.getBoundaryObjects({node:this.rootNode,nodeMap:this.nodeMap}):[]},allObjects:e=>[...e.boundaryObjects,...e.assignmentObjects],boundaryLayers(){return this.preferences.Map.layers.filter(e=>e.type==="boundary"&&this.boundaryObjects.find(t=>t.id===e.id))}},actions:{async loadScope({rootNodeId:e,parentNodeIds:t=[]}){return SPM.Utils.Node.loadScope({planId:this.plan.Id,nodeMap:this.nodeMap,metrics:this.plan.sfsp__SalesMetrics__r,loadRuleItems:!0,loadAssignments:!0,rootNodeId:e,parentNodeIds:t})},async loadAncestors({nodeId:e}){return SPM.Utils.Node.loadAncestors({planId:this.plan.Id,nodeId:e,nodeMap:this.nodeMap,metrics:this.plan.sfsp__SalesMetrics__r,loadRuleItems:!0,loadAssignments:!0})},async loadLevel({level:e,rootNode:t=this.rootNode,onProgress:s=()=>{}}){let n=t.level,r=t.children||[];for(;n++<e;){const a=r.map(d=>d.id);s(`Loading Level ${n}...`),await this.loadScope({parentNodeIds:a});const o=[];r.forEach(d=>{const p=this.nodeMap[d.id].children||[];o.push(...p)}),r=o}},async addNodes({parentId:e,levels:t}){const s=async(n,r)=>{const a=t[n];if(!a||r.length===0)return;const o=a.name||a.placeholder,d=[];r.forEach(p=>{var v,C;const y=((C=(v=this.nodeMap[p])==null?void 0:v.children)==null?void 0:C.length)||1;for(let I=1;I<=a.count;I++)d.push({sobjectType:"sfsp__SalesNode__c",Name:`${o}${a.count===1?"":` ${d.length+1}`}`,sfsp__SalesPlan__c:this.plan.Id,sfsp__Parent__c:p!=="All Org"?p:"",sfsp__Priority__c:y+I,sfsp__Color__c:SPM.Utils.Node.randomColor(),sfsp__AssignmentBehavior__c:"Exclusive"})}),await SPM.Utils.CRM.upsert({records:d}),d.forEach(p=>{var I;const y=p.sfsp__Parent__c||"All Org",v=this.nodeMap[y];if(v&&v.childCount++,!(v!=null&&v.children))return;const C={id:p.Id,name:p.Name,color:p.sfsp__Color__c,assignmentBehavior:p.sfsp__AssignmentBehavior__c,ownerId:"",ownerName:"",level:v.level+1,parentId:y,children:[],childCount:((I=t[n+1])==null?void 0:I.count)||0,metrics:this.plan.sfsp__SalesMetrics__r.map(O=>({...SPM.Utils.NodeMetric.Defaults,sfsp__SalesPlan__c:this.plan.Id,sfsp__SalesMetric__c:O.Id,sfsp__SalesNode__c:p.Id})),users:[],accessRecords:[],rules:[],ruleLogics:{},previewRuleLogics:{},assignments:[],boundaries:[],referenceData:[]};this.nodeMap[C.id]=C,v.children.push(C)}),r.forEach(p=>{const y=this.nodeMap[p];!(y!=null&&y.children)||(y.childCount=y.children.length,y.children.forEach(v=>{v.siblingIds=y.children.filter(C=>C.id!==v.id).map(C=>C.id),v.olderSiblingIds=y.children.slice(0,y.children.indexOf(v)).map(C=>C.id)}))}),SPM.$store.branch.descendantIds.push(...d.map(p=>p.Id)),await s(n+1,d.map(p=>p.Id))};await s(0,[e])},async deleteNode({nodeId:e}){await SPM.Utils.CRM.upsert({records:[{Id:e,sfsp__SalesPlan__c:"",sfsp__SalesPlanNode__c:""}]}),this.removeNodeFromParent({nodeId:e}),delete this.nodeMap[e]},removeNodeFromParent({nodeId:e}){const t=this.nodeMap[e],s=this.nodeMap[t.parentId],n=s.children.findIndex(r=>r===t);s.children.splice(n,1),s.childCount--,s.children.forEach(r=>{r.siblingIds=r.siblingIds.filter(a=>a!==e),r.olderSiblingIds=r.olderSiblingIds.filter(a=>a!==e)})},async updateAsyncJobCallback(e){var t,s,n;if(SPM.Components.Root.activeTab===e.tab)switch(SPM.Components.Root.activeTab){case"Hierarchy":(t=SPM.Components.Hierarchy)==null||t.loadTable();break;case"Assignment":const r=this.assignmentObjects.find(a=>a.id===e.assignmentObject.Id);r&&(SPM.Components.Assignment.selectedObject=r),SPM.Components.Assignment.loadingMsg="";break;case"Allocation":(n=(s=SPM.Components.Allocation)==null?void 0:s.$refs.listViewManager)==null||n.rebuildListView();break}},toast(e){if(!e.message)throw new Error("Missing message argument.");this.toasts.push({duration:5e3,position:"top-center",state:"success",...e})},loadPreferences(e){var t,s;["RecordExplorer","AssignmentExplorer"].forEach(n=>{Object.assign(this.preferences[n],e[n]||{})}),(s=(t=e==null?void 0:e.Map)==null?void 0:t.layers)==null||s.forEach(n=>{const r=this.preferences.Map.layers.find(a=>a.id===n.id);r?Object.assign(r,n):n.type==="boundary"&&this.preferences.Map.layers.push(n)})},async savePreferences(e=SPM.currentUser.Id){var s;const t=((s=await SPM.Utils.Apex.invoke("Query",[`
                SELECT Id
                FROM sfsp__SalesUserPreference__c
                WHERE sfsp__SalesPlan__c = '${this.plan.Id}' AND sfsp__User__c = '${SPM.currentUser.Id}'
            `]))==null?void 0:s[0])||{};SPM.Utils.CRM.upsert({records:[{sobjectType:"sfsp__SalesUserPreference__c",sfsp__SalesPlan__c:this.plan.Id,sfsp__User__c:e,...t,sfsp__Preferences__c:JSON.stringify(this.preferences,0,4)}]})},async insertActivities(e=[]){await pm(e.map(t=>({...t,parentId:this.plan.Id})))},async loadContainerSets(e=[]){if(e.length===0||e.some(t=>!this.containerSets[t])){const t=e.filter(n=>!this.containerSets[n]),s=await SPM.Utils.Apex.invoke("GetContainerSets",[t]);s.success?s.containerSets.forEach(n=>{this.containerSets[n.id]||(this.containerSets[n.id]=Object.assign(n,{label:`${n.country} ${n.boundary}`})),!this.activeContainerSets[n.id]&&this.containerSets[n.id].is_active&&(this.activeContainerSets[n.id]=this.containerSets[n.id])}):this.toast({message:"Unable to retrieve available container sets",state:"error",duration:5e3})}return this.activeContainerSets},async loadContainers({containerSetId:e}){let t=this.containerSets[e];if(t||((await SPM.Utils.Apex.invoke("GetContainerSets",[[e]])).containerSets.forEach(n=>{this.containerSets[e]=Object.assign(n,{label:`${n.country} ${n.boundary}`,is_active:!0})}),t=this.containerSets[e]),!this.activeContainerSets[t.id]&&t.is_active&&(this.activeContainerSets[t.id]=t),!t.containers){const s=await SPM.Utils.Apex.invoke("GetContainersUrl",[e,"url"]),n=await SPM.Utils.HTTP.get({url:s.url});t.containers={},t.childContainers={},n.data.forEach(r=>{this.containerMap[e]||(this.containerMap[e]={}),this.containerMap[e][r.name]=r,t.containers[r.name]=r,r.parent&&(t.childContainers[r.name]=r)})}return t.containers},openRecordUrl(e){window.open(`/${e}`)}}}),g4="modulepreload",y4=function(e){return"/resource/1730930622617/sfsp__NodeBuilder/dist/"+e},RT={},Yu=function(t,s,n){if(!s||s.length===0)return t();const r=document.getElementsByTagName("link");return Promise.all(s.map(a=>{if(a=y4(a),a in RT)return;RT[a]=!0;const o=a.endsWith(".css"),d=o?'[rel="stylesheet"]':"";if(!!n)for(let v=r.length-1;v>=0;v--){const C=r[v];if(C.href===a&&(!o||C.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${d}`))return;const y=document.createElement("link");if(y.rel=o?"stylesheet":g4,o||(y.as="script",y.crossOrigin=""),y.href=a,document.head.appendChild(y),o)return new Promise((v,C)=>{y.addEventListener("load",v),y.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>t())},$T=(e,t)=>{const s=e[t];return s?typeof s=="function"?s():Promise.resolve(s):new Promise((n,r)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(r.bind(null,new Error("Unknown variable dynamic import: "+t)))})},v4=["Header","Allocation","Assignment","SLDS"],b4=async e=>{const t={};return await SPM.Utils.Async.forEachParallel(v4,async s=>{try{const{default:n}=await $T(Object.assign({"./allocation/en_US.js":()=>Yu(()=>import("./assets/en_US.762adffe.js"),[]),"./allocation/es.js":()=>Yu(()=>import("./assets/es.da4d7ff7.js"),[]),"./assignment/en_US.js":()=>Yu(()=>import("./assets/en_US.adfeca68.js"),[]),"./header/en_US.js":()=>Yu(()=>import("./assets/en_US.9d3ed518.js"),[]),"./header/es.js":()=>Yu(()=>import("./assets/es.08ddecdb.js"),[]),"./slds/en_US.js":()=>Yu(()=>import("./assets/en_US.ed412bfe.js"),[])}),`./${s.toLowerCase()}/${e}.js`);t[s]=n}catch(n){console.log(n==null?void 0:n.message);const{default:r}=await $T(Object.assign({"./allocation/en_US.js":()=>Yu(()=>import("./assets/en_US.762adffe.js"),[]),"./assignment/en_US.js":()=>Yu(()=>import("./assets/en_US.adfeca68.js"),[]),"./header/en_US.js":()=>Yu(()=>import("./assets/en_US.9d3ed518.js"),[]),"./slds/en_US.js":()=>Yu(()=>import("./assets/en_US.ed412bfe.js"),[])}),`./${s.toLowerCase()}/en_US.js`);t[s]=r}},5),t},x4=e=>new Promise((t,s)=>{console.log(e);const n=new XMLHttpRequest;n.onload=()=>{n.status>=200&&n.status<400?t(n.responseText):s(n)},n.onerror=()=>console.error("Could not load the SVG."),n.open("GET",e,!0),n.send()}),yn={name:"Icon",props:{assistiveText:String,button:Boolean,category:{type:String,default:"standard",validator(e){return["action","custom","doctype","standard","utility"].includes(e)?!0:(console.error("Invalid category. Please see documentation for valid categories."),!1)}},iconClass:{type:[Array,String]},inheritFillFromParent:Boolean,name:{type:String,default:""},size:{type:String,default:"",validator(e){return e&&!["xx-small","x-small","small","large"].includes(e)?(console.error("Invalid size. Please see documentation for valid sizes."),!1):!0}},src:String,svg:{type:[Object,String],validator(e){const t=typeof e=="string",s=typeof e=="object"&&e.__esModule===!0;return t||s}},title:{type:String,default:""},variant:{type:String,default:"default",validator(e){return e&&!["inverse","success","warning","error","default","none"].includes(e)?(console.error("Invalid variant. Please see documentation for valid variants."),!1):!0}}},render(){const e=[];this.$props.button||(e.push("slds-icon_container"),this.hasFQIcon&&e.push(`slds-icon-${this.$props.category}-${this.$props.name.replace(/_/g,"-")}`));const s=[this.buildSVGVNode()];return this.$props.assistiveText&&s.push(An("span",{class:"slds-assistive-text"},[this.$props.assistiveText])),this.$props.button?[s]:An("div",{class:e,title:this.$props.title},[s])},data(){return{processing:!1,inlineData:null}},computed:{hasFQIcon(){return this.$props.category&&this.$props.name},computedFill(){return this.$props.button||this.hasFQIcon&&this.$props.category==="utility"?"inherit":this.$props.fill}},watch:{$props:{handler(){this.process()},deep:!0,immediate:!0}},inject:["$__getIconSettings"],methods:{validateSources(){let e=0;if(this.$props.src&&e++,this.$props.svg&&e++,this.hasFQIcon&&e++,e===0||e>1)throw new Error("You must provide exactly one icon source.")},async process(){if(!this.processing){this.validateSources();try{this.processing=!0,this.$props.src?this.inlineData=await x4(this.$props.src):this.$props.svg&&(this.inlineData=this.$props.svg)}finally{this.processing=!1}}},buildSVGVNode(){const e=this.getIconClasses(),t={"aria-hidden":!0,focusable:!1,"data-key":this.$props.name};if(this.inlineData){const s=document.createRange().createContextualFragment(this.inlineData),n=Array.from(s.childNodes).find(a=>a.nodeName==="svg");n.classList.add(...e),this.$props.inheritFillFromParent&&n.querySelectorAll("g, path").forEach(a=>{a.style.fill="inherit"});const r=Object.values(n.attributes).reduce((a,o)=>(a[o.name]=o.value,a),t);return An("svg",{...r,class:e,innerHTML:n.innerHTML})}return An("svg",{...t,class:e},[An("use",{href:this.getAssetURL()})])},getAssetURL(){const{iconPath:e,actionSpritePath:t,customSpritePath:s,doctypeSpritePath:n,standardSpritePath:r,utilitySpritePath:a}=this.$__getIconSettings();if(e)return`${e}/${this.$props.category}-sprite/svg/symbols.svg#${this.$props.name}`;switch(this.$props.category){case"action":return`${t}/symbols.svg#${this.$props.name}`;case"custom":return`${s}/symbols.svg#${this.$props.name}`;case"doctype":return`${n}/symbols.svg#${this.$props.name}`;case"standard":return`${r}/symbols.svg#${this.$props.name}`;case"utility":return`${a}/symbols.svg#${this.$props.name}`;default:throw new Error("Invalid path")}},getIconClasses(){const e=[];return this.$props.category==="utility"&&this.$props.variant!=="none"&&e.push(`slds-icon-text-${this.$props.variant}`),Array.isArray(this.iconClass)?this.iconClass.forEach(t=>e.push(t)):this.iconClass&&e.push(this.iconClass),!this.$props.button&&this.hasFQIcon&&(e.push("slds-icon"),this.$props.size&&e.push(`slds-icon_${this.$props.size}`)),e}}},vn={name:"Button",components:{Icon:yn},props:{assistiveText:{type:String,required:!0},disabled:Boolean,iconCategory:{type:String,default:null},iconClass:{type:[Array,String],default:()=>[]},iconName:{type:String,default:null},iconSize:{type:String,default:"",validator:e=>{const t=["large","small","x-small","xx-small"],s=!e||t.includes(e);return s||console.error(`Valid iconSize prop values are ${t.join(", ")}`),s}},more:Boolean,size:{type:String,default:"",validator:e=>{const t=["large","small","x-small","xx-small"],s=!e||t.includes(e);return s||console.error(`Valid button icon prop values are ${t.join(", ")}`),s}},stretched:Boolean,variant:{type:String,default:"bare",validator:e=>{const t=["bare","container","brand","border","border-filled","bare-inverse","inverse","border-inverse"],s=!e||t.includes(e);return s||console.error(`Valid variant prop values are ${t.join(", ")}`),s}},title:{type:String,required:!0}},computed:{hasFQIcon(){return this.$props.iconCategory&&this.$props.iconName}},render(){let e;if(this.hasFQIcon){const r=Array.isArray(this.$props.iconClass)?this.$props.iconClass:[this.$props.iconClass];r.push("slds-button__icon");const a={assistiveText:this.$props.assistiveText,category:this.$props.iconCategory,name:this.$props.iconName,iconClass:r,variant:"none",button:!0};this.$props.iconSize&&(r.push(`slds-button__icon_${this.$props.iconSize}`),a.size=this.$props.iconSize),e=An(yn,a)}const s=[(this.$slots.default?this.$slots.default():null)||e];if(this.$props.more){const r=An(yn,{assistiveText:e?null:this.$props.assistiveText,category:"utility",name:"down",iconClass:["slds-button__icon","slds-button__icon_x-small"],variant:"none",button:!0});s.push(r)}const n=["slds-button","slds-button_icon"];return this.$props.more&&(this.$props.variant==="border-filled"?n.push("slds-button_icon-more"):n.push("slds-button_icon-container-more")),n.push(`slds-button_icon-${this.$props.variant}`),this.$props.size&&n.push(`slds-button_icon-${this.$props.size}`),this.$props.stretched&&n.push("slds-button_stretch"),An("button",{class:n,title:this.$props.title,disabled:this.$props.disabled},s)},methods:{focus(){this.$el.focus()}}},_v=new Map;function OT(e,t,s){const n=function(r){if(s.$.isUnmounted){document.removeEventListener("click",n);return}!e.contains(r.target)&&e!==r.target&&t(r)};_v.set(e,n),setTimeout(()=>document.addEventListener("click",n),0)}function LT(e){const t=_v.get(e);document.removeEventListener("click",t),_v.delete(e)}const cC={created(e,{arg:{active:t,handler:s},instance:n}){if(typeof s!="function")throw new Error("v-click-outside: missing required handler argument.");t===!0&&OT(e,s,n)},updated(e,{arg:{active:t,handler:s}},n){t&&!_v.has(e)?OT(e,s,n):!t&&_v.has(e)&&LT(e)},unmounted(e){LT(e)}},LS=new Map,w4=(e,t)=>{const s=document.createElement("div");return s.className="slds-scope",s.appendChild(e),document.body.appendChild(s),t.$emit("detached",s),s},mb=(e,t,{anchorRef:s,resizeToAnchor:n,resizeToFitContent:r,alignment:a})=>{e.style.position="fixed";const o=s.getBoundingClientRect();e.style.top=`${o.top+s.offsetHeight}px`,a==="left"||n?(e.style.right="auto",e.style.left=`${o.left}px`):a==="right"&&(e.style.left="auto",e.style.right=`${document.documentElement.clientWidth-o.right}px`);const d=s.offsetWidth;n?e.style.width=`${d}px`:r&&(e.style.minWidth=`${d}px`,e.style.width="auto")},S4=()=>{const e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.overflow="scroll",e.style.position="absolute",e.style.top="-9999px",document.body.appendChild(e);const t=e.offsetWidth-e.clientWidth;return e.remove(),t},Yw=(e,t)=>{const s=e.getBoundingClientRect(),n=document.documentElement.clientHeight,r=document.documentElement.clientWidth,a=n-window.innerHeight;let o;if(a<=0?o=n:o=window.innerHeight-S4(),s.x<0)t.anchorRef&&t.anchorRef instanceof HTMLElement?mb(e,null,{...t,alignment:"left"}):e.style.left=`${e.offsetLeft+Math.abs(s.x)}px`;else if(s.left+s.width>r)if(t.anchorRef&&t.anchorRef instanceof HTMLElement)mb(e,null,{...t,alignment:"right"});else{const y=s.left+s.width-r-window.pageXOffset;e.style.left=`${s.left-y}px`}let d=e.offsetHeight,p;if(t.anchorRef&&t.anchorTopOnVerticalOverflow){const y=t.anchorRef.getBoundingClientRect();let v=y.bottom;const C=window.getComputedStyle(e)["box-shadow"];C&&C!=="none"&&(d+=parseInt(/(?:\dpx ){2}(\d)/.exec(C)[1],10)),v+d>o&&(v=y.top-d),p=v}else s.top+d>o&&(p=s.top-(s.top+d-o));p&&(e.style.top=`${p}px`)},hk=e=>{let t=LS.get(e);!t||(t.remove(),t=null,LS.delete(e))};let K_;const C4=(e,t,s)=>{s&&s.type==="scroll"&&e&&e.contains(s.target)||(typeof t=="function"?t(e,s):(hk(e),window.removeEventListener("scroll",K_,!0),K_=null))},pk={created(e,t,s){t.value.disabled||t.instance.$nextTick(()=>{const n=t.value,r=w4(e,t.instance);s.container=r,LS.set(e,r),typeof n.customDisplayMethod=="function"&&n.customDisplayMethod(),n.anchorRef&&n.anchorRef instanceof HTMLElement&&mb(e,s,n),n.viewPortOverflow&&t.instance.$nextTick(()=>{typeof n.onRender=="function"?(n.onRender(),t.instance.$nextTick(Yw.bind(this,e,n))):Yw(e,n)}),K_=C4.bind(null,e,n.scrollHandler),window.addEventListener("scroll",K_,!0)})},updated(e,{value:t,instance:s},n){t.disabled||(t.anchorRef&&t.anchorRef instanceof HTMLElement&&mb(e,n,t),t.viewPortOverflow&&s.$nextTick(()=>{typeof t.onUpdate=="function"&&t.onUpdate(),Yw(e,t)}))},unmounted(e){hk(e),window.removeEventListener("scroll",K_,!0),K_=null}},os=(e,t)=>{const s=e.__vccOpts||e;for(const[n,r]of t)s[n]=r;return s},I4={name:"ActionMenu",components:{ButtonIcon:vn},directives:{"click-outside":cC,"detach-element":pk},props:{alignment:{type:String,default:"left",validator(e){return["left","right"].includes(e)?!0:(console.error("Invalid alignment. Please see documentation for valid alignments."),!1)}},bindTo:{type:HTMLElement,default:null},bindToCoords:{type:Object,default:null,validator:e=>e.x&&e.y},bindToMousePosition:{type:Boolean,default:!1},buttonIconSize:{type:String,default:""},disabled:Boolean,doShowSync:Boolean,hideOnMouseout:Boolean,iconCategory:{type:String,default:"utility"},iconName:{type:String,default:"down"},iconSize:{type:String,default:""},iconTitle:{type:String,default:""},isActionMenu:{type:Boolean,default:!0},onToggleRequest:{type:Function,default:null},resizeToAnchor:Boolean,showMoreLabel:{type:String,default:"Show More"}},data(){return{doShow:this.doShowSync,isDirty:!1,adjustedAlignment:null,container:null,focusedMenuItemIndex:null,focusableMenuItems:[]}},computed:{doShowAnchor(){return!(this.bindTo||this.bindToMousePosition||this.bindToCoords)},clickOutsideOptions(){return{active:this.doShow,handler:this.doHide}},computedShowMoreIconTitle(){return this.$props.iconTitle||this.$props.showMoreLabel},dropdownClasses(){const e=["slds-dropdown"];return this.$props.isActionMenu&&e.push("slds-dropdown_actions"),e}},watch:{"$props.alignment":{handler(e){if(!["left","right"].includes(e)){console.error("Invalid alignment. Please see documentation for valid alignments.");return}this.adjustedAlignment=e},immediate:!0},doShow(e){this.$emit("update:doShowSync",e)},doShowSync(e){e!==this.doShow&&this.toggleMenu()}},created(){this.bindTo&&this.bindTo.addEventListener("click",this.toggleMenu)},beforeUnmount(){this.bindTo&&this.bindTo.removeEventListener("click",this.toggleMenu),this.destroy()},methods:{toggleMenu(e){this.disabled||e&&this.onToggleRequest&&!this.onToggleRequest(e,this.doShow)||e&&this.$refs.menu&&(this.$refs.menu===e.target||this.$refs.menu.contains(e.target))||(this.doShow=!this.doShow,this.doShow&&!this.isKeyboardCallback?(window.addEventListener("scroll",this.doHide,!0),window.addEventListener("resize",this.doHide),this.$nextTick(this.showMenu.bind(this,e)),this.$emit("bindToClick",e)):this.destroy())},showMenu(){this.$nextTick(()=>{this.getFocusableMenuItems(),this.focusableMenuItems.length&&(this.focusedMenuItemIndex=0,this.setMenuItemFocus())})},onDetachRender(){this.$emit("detached",this.$refs.menu)},adjustAlignment(e){this.adjustedAlignment=e},destroy(){this.focusableMenuItems=[],this.doShow=!1,window.removeEventListener("scroll",this.doHide,!0),window.removeEventListener("resize",this.doHide),this.container&&(this.container.remove(),this.container=null),this.doShowAnchor&&this.$refs.anchor.firstElementChild.focus(),this.$emit("hide")},doHide(){this.destroy()},mouseover(e){this.$emit("mouseover",e)},mouseout(e){if(this.hideOnMouseout&&e.type==="mouseout"&&!this.$refs.menu.contains(e.toElement||e.relatedTarget)){this.destroy();return}this.$emit("mouseout",e)},getFocusableMenuItems(){this.focusableMenuItems=[],this.$refs.menu.querySelectorAll(".slds-dropdown__item").forEach(e=>{this.focusableMenuItems.push(e.querySelector("a"))})},down(){this.doShow?(this.focusableMenuItems[this.focusedMenuItemIndex].tabIndex=-1,this.focusedMenuItemIndex<this.focusableMenuItems.length-1?this.focusedMenuItemIndex++:this.focusedMenuItemIndex=0,this.setMenuItemFocus()):this.toggleMenu()},up(){this.doShow?(this.focusableMenuItems[this.focusedMenuItemIndex].tabIndex=-1,this.focusedMenuItemIndex>0?this.focusedMenuItemIndex--:this.focusedMenuItemIndex=this.focusableMenuItems.length-1,this.setMenuItemFocus()):this.toggleMenu()},setMenuItemFocus(){this.focusableMenuItems[this.focusedMenuItemIndex].tabIndex=0,this.focusableMenuItems[this.focusedMenuItemIndex].focus()}}},T4={key:0,ref:"anchor"},A4=["aria-label"];function M4(e,t,s,n,r,a){const o=pe("ButtonIcon"),d=mg("click-outside"),p=mg("detach-element");return L(),X("div",{class:"slds-dropdown-trigger slds-dropdown-trigger_click slds-is-open slds-show",onClick:t[6]||(t[6]=(...y)=>a.toggleMenu&&a.toggleMenu(...y)),onKeydown:[t[7]||(t[7]=Zs((...y)=>a.toggleMenu&&a.toggleMenu(...y),["enter"])),t[8]||(t[8]=Zs(Os((...y)=>a.up&&a.up(...y),["prevent"]),["up"])),t[9]||(t[9]=Zs(Os((...y)=>a.down&&a.down(...y),["prevent"]),["down"])),t[10]||(t[10]=Zs(Os((...y)=>a.destroy&&a.destroy(...y),["stop"]),["esc"]))]},[a.doShowAnchor?(L(),X("div",T4,[js(e.$slots,"button",{},()=>[de(o,{"aria-haspopup":"",variant:"border-filled",disabled:e.$props.disabled,iconSize:e.$props.iconSize,iconCategory:e.$props.iconCategory,iconName:e.$props.iconName,title:a.computedShowMoreIconTitle,assistiveText:s.showMoreLabel,"aria-expanded":r.doShow,size:e.$props.buttonIconSize},null,8,["disabled","iconSize","iconCategory","iconName","title","assistiveText","aria-expanded","size"])],!0)],512)):$e("",!0),r.doShow?Mn((L(),X("div",{key:1,ref:"menu",class:$t([a.dropdownClasses,"translateX"]),onMouseover:t[0]||(t[0]=(...y)=>a.mouseover&&a.mouseover(...y)),onMouseout:t[1]||(t[1]=(...y)=>a.mouseout&&a.mouseout(...y)),onKeydown:[t[2]||(t[2]=Zs(Os((...y)=>a.down&&a.down(...y),["stop"]),["down"])),t[3]||(t[3]=Zs(Os((...y)=>a.up&&a.up(...y),["stop"]),["up"])),t[4]||(t[4]=Zs(Os((...y)=>a.destroy&&a.destroy(...y),["stop"]),["esc"])),t[5]||(t[5]=Zs((...y)=>a.destroy&&a.destroy(...y),["tab"]))]},[k("ul",{class:"slds-dropdown__list",role:"menu","aria-label":s.showMoreLabel},[js(e.$slots,"default",{},()=>[es("--- menu items go here ---")],!0)],8,A4)],34)),[[d,void 0,a.clickOutsideOptions],[p,{anchorRef:e.$refs.anchor,viewPortOverflow:!0,anchorTopOnVerticalOverflow:!0,onRender:a.onDetachRender,onOverflowAdjustment:a.adjustAlignment,resizeToAnchor:e.$props.resizeToAnchor,scrollHandler:a.doHide,alignment:e.$props.alignment}]]):$e("",!0)],32)}const wa=os(I4,[["render",M4],["__scopeId","data-v-413e8c13"]]),Xo={methods:{decodeHtml(e){const t=document.createElement("textarea");return t.innerHTML=e,t.value}}},E4={name:"ActionMenuItem",components:{Icon:yn},mixins:[Xo],props:{label:{type:String,required:!0},disabled:Boolean,header:Boolean,iconCategory:{type:String,default:null},iconName:{type:String,default:null},role:{type:String,default:"menuitem",validator:e=>{const t=["menuitem","menuitemcheckbox","menuitemradio"],s=!e||t.includes(e);return s||console.error(`Valid role values are ${t.join(", ")}`),s}},selected:Boolean},computed:{hasFQIcon(){return this.$props.iconCategory&&this.$props.iconName}},methods:{onEnter(e){this.$attrs.onClick(e),this.$props.disabled||this.$parent.destroy()},onClick(){this.$props.disabled||this.$parent.destroy()}}},k4={key:0,role:"presentation",class:"slds-dropdown__header slds-text-heading--label"},P4={role:"presentation"},R4=["aria-disabled"],$4=["role","aria-checked"],O4=["title"];function L4(e,t,s,n,r,a){const o=pe("Icon");return e.$props.header?(L(),X("li",k4,[k("div",P4,Pe(e.$props.label),1)])):(L(),X("li",Ji({key:1,class:["slds-dropdown__item",{"slds-is-selected":e.$props.selected}],"aria-disabled":s.disabled,role:"presentation"},id(e.$attrs,!0),{onClick:t[0]||(t[0]=Os((...d)=>a.onClick&&a.onClick(...d),["stop","prevent"])),onKeydown:t[1]||(t[1]=Zs(Os((...d)=>a.onEnter&&a.onEnter(...d),["stop","prevent"]),["enter"]))}),[k("a",{role:s.role,tabindex:"-1","aria-checked":e.$props.selected,class:$t({disabled:s.disabled})},[k("span",{title:s.label,class:$t([{"slds-text-color_inverse-weak":s.disabled,disabled:s.disabled},"slds-truncate"])},[a.hasFQIcon?(L(),Ge(o,{key:0,category:e.$props.iconCategory,name:e.$props.iconName,size:"x-small",class:"slds-m-right_x-small"},null,8,["category","name"])):$e("",!0),e.$parent.$props.isActionMenu?$e("",!0):(L(),Ge(o,{key:1,category:"utility",name:"check",size:"x-small",class:"slds-m-right_x-small",iconClass:"slds-icon_selected"})),js(e.$slots,"default",{},()=>[es(Pe(e.decodeHtml(s.label)),1)],!0)],10,O4)],10,$4)],16,R4))}const Sa=os(E4,[["render",L4],["__scopeId","data-v-ffe335c1"]]),N4={name:"Badge",props:{content:{type:[String,Number],default:""},iconAlignment:{type:String,default:"left"},theme:{type:String,default:"base",validator:e=>{const t=["base","inverse","lightest","success","warning","error"],s=!e||t.includes(e);return s||console.error(`Valid theme prop values are ${t.join(", ")}`),s}}},computed:{iconOnly(){return this.$slots.icon&&!this.content},themeClasses(){const e=["inverse","lightest"],t=["success","warning","error"];let s="";return e.includes(this.theme)&&(s=`slds-badge_${this.theme}`),t.includes(this.theme)&&(s=`slds-theme_${this.theme}`),s},badgeIconClasses(){const e=["slds-badge__icon"];return this.theme==="inverse"&&e.push("slds-badge__icon_inverse"),this.iconAlignment&&!this.iconOnly&&e.push(`slds-badge__icon_${this.iconAlignment}`),e}}};function D4(e,t,s,n,r,a){return L(),X("span",{class:$t(["slds-badge",a.themeClasses])},[e.$slots.icon&&s.iconAlignment==="left"?(L(),X(Lt,{key:0},[k("span",{class:$t(a.badgeIconClasses)},[js(e.$slots,"icon")],2),es(" "+Pe(s.content),1)],64)):e.$slots.icon&&s.iconAlignment==="right"?(L(),X(Lt,{key:1},[es(Pe(s.content)+" ",1),k("span",{class:$t(a.badgeIconClasses)},[js(e.$slots,"icon")],2)],64)):(L(),X(Lt,{key:2},[es(Pe(s.content),1)],64))],2)}const lx=os(N4,[["render",D4]]),Tn={name:"Button",components:{Icon:yn},props:{disabled:Boolean,iconCategory:{type:String,default:null},iconClass:{type:[Array,String]},iconName:{type:String,default:null},iconPosition:{type:String,default:"left"},iconVariant:{type:String,default:"none"},label:{type:String,default:"Button"},stretched:Boolean,variant:{type:String,default:"neutral",validator:e=>{const t=["base","neutral","brand","inverse","destructive","success","outline-brand","text-destructive"],s=!e||t.includes(e);return s||console.error(`Valid variant prop values are ${t.join(", ")}`),s}}},computed:{hasFQIcon(){return this.$props.iconCategory&&this.$props.iconName}},render(){let e;if(this.hasFQIcon){const r=["slds-button__icon"];this.$props.iconPosition&&r.push(`slds-button__icon_${this.$props.iconPosition}`),this.$props.iconClass&&(Array.isArray(this.$props.iconClass)?r.push(...this.$props.iconClass):r.push(this.$props.iconClass)),e=An(yn,{button:!0,category:this.$props.iconCategory,iconClass:r,name:this.$props.iconName,variant:this.$props.iconVariant})}const s=[(this.$slots.default?this.$slots.default():null)||this.$props.label];e&&(this.$props.iconPosition==="right"?s.push(e):s.unshift(e));const n=["slds-button"];return this.$props.stretched&&n.push("slds-button_stretch"),this.$props.variant!=="base"&&n.push(`slds-button_${this.variant}`),An("button",{class:n,disabled:this.$props.disabled},s)},methods:{focus(){this.$el.focus()}}},B4={name:"Card",props:{title:{type:String,default:""},padBody:Boolean},computed:{showHeader(){return this.title||this.$slots.icon||this.$slots["header-content"]||this.$slots.title}}},F4={class:"slds-card"},z4={key:0,class:"slds-card__header slds-grid"},U4={class:"slds-media slds-media_center slds-has-flexi-truncate"},V4={key:0,class:"slds-media__figure"},j4={class:"slds-media__body"},q4={class:"slds-card__header-title"},H4=["title"],G4={key:0},W4={key:1,class:"slds-card__footer"};function Y4(e,t,s,n,r,a){return L(),X("article",F4,[a.showHeader?(L(),X("div",z4,[k("div",U4,[e.$slots.icon?(L(),X("div",V4,[js(e.$slots,"icon")])):$e("",!0),k("div",j4,[js(e.$slots,"title",{},()=>[k("h2",q4,[k("span",{title:s.title,class:"slds-truncate"},[k("span",null,Pe(s.title),1)],8,H4)])])])]),e.$slots["header-content"]?(L(),X("div",G4,[js(e.$slots,"header-content")])):$e("",!0)])):$e("",!0),k("div",{class:$t([{"slds-card__body_inner":s.padBody},"slds-card__body"])},[js(e.$slots,"body",{},()=>[es("Card Body")])],2),e.$slots.footer?(L(),X("footer",W4,[js(e.$slots,"footer")])):$e("",!0)])}const Xp=os(B4,[["render",Y4]]);var il="top",Oc="bottom",Lc="right",ol="left",uC="auto",Wv=[il,Oc,Lc,ol],yg="start",gv="end",Z4="clippingParents",fk="viewport",Ly="popper",X4="reference",NT=Wv.reduce(function(e,t){return e.concat([t+"-"+yg,t+"-"+gv])},[]),mk=[].concat(Wv,[uC]).reduce(function(e,t){return e.concat([t,t+"-"+yg,t+"-"+gv])},[]),K4="beforeRead",J4="read",Q4="afterRead",e8="beforeMain",t8="main",s8="afterMain",n8="beforeWrite",r8="write",i8="afterWrite",o8=[K4,J4,Q4,e8,t8,s8,n8,r8,i8];function dd(e){return e?(e.nodeName||"").toLowerCase():null}function Bl(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Cm(e){var t=Bl(e).Element;return e instanceof t||e instanceof Element}function Pc(e){var t=Bl(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function dC(e){if(typeof ShadowRoot>"u")return!1;var t=Bl(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function a8(e){var t=e.state;Object.keys(t.elements).forEach(function(s){var n=t.styles[s]||{},r=t.attributes[s]||{},a=t.elements[s];!Pc(a)||!dd(a)||(Object.assign(a.style,n),Object.keys(r).forEach(function(o){var d=r[o];d===!1?a.removeAttribute(o):a.setAttribute(o,d===!0?"":d)}))})}function l8(e){var t=e.state,s={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,s.popper),t.styles=s,t.elements.arrow&&Object.assign(t.elements.arrow.style,s.arrow),function(){Object.keys(t.elements).forEach(function(n){var r=t.elements[n],a=t.attributes[n]||{},o=Object.keys(t.styles.hasOwnProperty(n)?t.styles[n]:s[n]),d=o.reduce(function(p,y){return p[y]="",p},{});!Pc(r)||!dd(r)||(Object.assign(r.style,d),Object.keys(a).forEach(function(p){r.removeAttribute(p)}))})}}const c8={name:"applyStyles",enabled:!0,phase:"write",fn:a8,effect:l8,requires:["computeStyles"]};function od(e){return e.split("-")[0]}var fm=Math.max,_b=Math.min,vg=Math.round;function NS(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function _k(){return!/^((?!chrome|android).)*safari/i.test(NS())}function bg(e,t,s){t===void 0&&(t=!1),s===void 0&&(s=!1);var n=e.getBoundingClientRect(),r=1,a=1;t&&Pc(e)&&(r=e.offsetWidth>0&&vg(n.width)/e.offsetWidth||1,a=e.offsetHeight>0&&vg(n.height)/e.offsetHeight||1);var o=Cm(e)?Bl(e):window,d=o.visualViewport,p=!_k()&&s,y=(n.left+(p&&d?d.offsetLeft:0))/r,v=(n.top+(p&&d?d.offsetTop:0))/a,C=n.width/r,I=n.height/a;return{width:C,height:I,top:v,right:y+C,bottom:v+I,left:y,x:y,y:v}}function hC(e){var t=bg(e),s=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-s)<=1&&(s=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:s,height:n}}function gk(e,t){var s=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(s&&dC(s)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function yh(e){return Bl(e).getComputedStyle(e)}function u8(e){return["table","td","th"].indexOf(dd(e))>=0}function Kp(e){return((Cm(e)?e.ownerDocument:e.document)||window.document).documentElement}function cx(e){return dd(e)==="html"?e:e.assignedSlot||e.parentNode||(dC(e)?e.host:null)||Kp(e)}function DT(e){return!Pc(e)||yh(e).position==="fixed"?null:e.offsetParent}function d8(e){var t=/firefox/i.test(NS()),s=/Trident/i.test(NS());if(s&&Pc(e)){var n=yh(e);if(n.position==="fixed")return null}var r=cx(e);for(dC(r)&&(r=r.host);Pc(r)&&["html","body"].indexOf(dd(r))<0;){var a=yh(r);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||t&&a.willChange==="filter"||t&&a.filter&&a.filter!=="none")return r;r=r.parentNode}return null}function Yv(e){for(var t=Bl(e),s=DT(e);s&&u8(s)&&yh(s).position==="static";)s=DT(s);return s&&(dd(s)==="html"||dd(s)==="body"&&yh(s).position==="static")?t:s||d8(e)||t}function pC(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Jy(e,t,s){return fm(e,_b(t,s))}function h8(e,t,s){var n=Jy(e,t,s);return n>s?s:n}function yk(){return{top:0,right:0,bottom:0,left:0}}function vk(e){return Object.assign({},yk(),e)}function bk(e,t){return t.reduce(function(s,n){return s[n]=e,s},{})}var p8=function(t,s){return t=typeof t=="function"?t(Object.assign({},s.rects,{placement:s.placement})):t,vk(typeof t!="number"?t:bk(t,Wv))};function f8(e){var t,s=e.state,n=e.name,r=e.options,a=s.elements.arrow,o=s.modifiersData.popperOffsets,d=od(s.placement),p=pC(d),y=[ol,Lc].indexOf(d)>=0,v=y?"height":"width";if(!(!a||!o)){var C=p8(r.padding,s),I=hC(a),O=p==="y"?il:ol,A=p==="y"?Oc:Lc,P=s.rects.reference[v]+s.rects.reference[p]-o[p]-s.rects.popper[v],q=o[p]-s.rects.reference[p],ce=Yv(a),re=ce?p==="y"?ce.clientHeight||0:ce.clientWidth||0:0,W=P/2-q/2,Ce=C[O],te=re-I[v]-C[A],oe=re/2-I[v]/2+W,ve=Jy(Ce,oe,te),ee=p;s.modifiersData[n]=(t={},t[ee]=ve,t.centerOffset=ve-oe,t)}}function m8(e){var t=e.state,s=e.options,n=s.element,r=n===void 0?"[data-popper-arrow]":n;r!=null&&(typeof r=="string"&&(r=t.elements.popper.querySelector(r),!r)||!gk(t.elements.popper,r)||(t.elements.arrow=r))}const _8={name:"arrow",enabled:!0,phase:"main",fn:f8,effect:m8,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function xg(e){return e.split("-")[1]}var g8={top:"auto",right:"auto",bottom:"auto",left:"auto"};function y8(e,t){var s=e.x,n=e.y,r=t.devicePixelRatio||1;return{x:vg(s*r)/r||0,y:vg(n*r)/r||0}}function BT(e){var t,s=e.popper,n=e.popperRect,r=e.placement,a=e.variation,o=e.offsets,d=e.position,p=e.gpuAcceleration,y=e.adaptive,v=e.roundOffsets,C=e.isFixed,I=o.x,O=I===void 0?0:I,A=o.y,P=A===void 0?0:A,q=typeof v=="function"?v({x:O,y:P}):{x:O,y:P};O=q.x,P=q.y;var ce=o.hasOwnProperty("x"),re=o.hasOwnProperty("y"),W=ol,Ce=il,te=window;if(y){var oe=Yv(s),ve="clientHeight",ee="clientWidth";if(oe===Bl(s)&&(oe=Kp(s),yh(oe).position!=="static"&&d==="absolute"&&(ve="scrollHeight",ee="scrollWidth")),oe=oe,r===il||(r===ol||r===Lc)&&a===gv){Ce=Oc;var ne=C&&oe===te&&te.visualViewport?te.visualViewport.height:oe[ve];P-=ne-n.height,P*=p?1:-1}if(r===ol||(r===il||r===Oc)&&a===gv){W=Lc;var Se=C&&oe===te&&te.visualViewport?te.visualViewport.width:oe[ee];O-=Se-n.width,O*=p?1:-1}}var Ue=Object.assign({position:d},y&&g8),Qe=v===!0?y8({x:O,y:P},Bl(s)):{x:O,y:P};if(O=Qe.x,P=Qe.y,p){var Me;return Object.assign({},Ue,(Me={},Me[Ce]=re?"0":"",Me[W]=ce?"0":"",Me.transform=(te.devicePixelRatio||1)<=1?"translate("+O+"px, "+P+"px)":"translate3d("+O+"px, "+P+"px, 0)",Me))}return Object.assign({},Ue,(t={},t[Ce]=re?P+"px":"",t[W]=ce?O+"px":"",t.transform="",t))}function v8(e){var t=e.state,s=e.options,n=s.gpuAcceleration,r=n===void 0?!0:n,a=s.adaptive,o=a===void 0?!0:a,d=s.roundOffsets,p=d===void 0?!0:d,y={placement:od(t.placement),variation:xg(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:r,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,BT(Object.assign({},y,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:p})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,BT(Object.assign({},y,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:p})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const b8={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:v8,data:{}};var C1={passive:!0};function x8(e){var t=e.state,s=e.instance,n=e.options,r=n.scroll,a=r===void 0?!0:r,o=n.resize,d=o===void 0?!0:o,p=Bl(t.elements.popper),y=[].concat(t.scrollParents.reference,t.scrollParents.popper);return a&&y.forEach(function(v){v.addEventListener("scroll",s.update,C1)}),d&&p.addEventListener("resize",s.update,C1),function(){a&&y.forEach(function(v){v.removeEventListener("scroll",s.update,C1)}),d&&p.removeEventListener("resize",s.update,C1)}}const w8={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:x8,data:{}};var S8={left:"right",right:"left",bottom:"top",top:"bottom"};function H1(e){return e.replace(/left|right|bottom|top/g,function(t){return S8[t]})}var C8={start:"end",end:"start"};function FT(e){return e.replace(/start|end/g,function(t){return C8[t]})}function fC(e){var t=Bl(e),s=t.pageXOffset,n=t.pageYOffset;return{scrollLeft:s,scrollTop:n}}function mC(e){return bg(Kp(e)).left+fC(e).scrollLeft}function I8(e,t){var s=Bl(e),n=Kp(e),r=s.visualViewport,a=n.clientWidth,o=n.clientHeight,d=0,p=0;if(r){a=r.width,o=r.height;var y=_k();(y||!y&&t==="fixed")&&(d=r.offsetLeft,p=r.offsetTop)}return{width:a,height:o,x:d+mC(e),y:p}}function T8(e){var t,s=Kp(e),n=fC(e),r=(t=e.ownerDocument)==null?void 0:t.body,a=fm(s.scrollWidth,s.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),o=fm(s.scrollHeight,s.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),d=-n.scrollLeft+mC(e),p=-n.scrollTop;return yh(r||s).direction==="rtl"&&(d+=fm(s.clientWidth,r?r.clientWidth:0)-a),{width:a,height:o,x:d,y:p}}function _C(e){var t=yh(e),s=t.overflow,n=t.overflowX,r=t.overflowY;return/auto|scroll|overlay|hidden/.test(s+r+n)}function xk(e){return["html","body","#document"].indexOf(dd(e))>=0?e.ownerDocument.body:Pc(e)&&_C(e)?e:xk(cx(e))}function Qy(e,t){var s;t===void 0&&(t=[]);var n=xk(e),r=n===((s=e.ownerDocument)==null?void 0:s.body),a=Bl(n),o=r?[a].concat(a.visualViewport||[],_C(n)?n:[]):n,d=t.concat(o);return r?d:d.concat(Qy(cx(o)))}function DS(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function A8(e,t){var s=bg(e,!1,t==="fixed");return s.top=s.top+e.clientTop,s.left=s.left+e.clientLeft,s.bottom=s.top+e.clientHeight,s.right=s.left+e.clientWidth,s.width=e.clientWidth,s.height=e.clientHeight,s.x=s.left,s.y=s.top,s}function zT(e,t,s){return t===fk?DS(I8(e,s)):Cm(t)?A8(t,s):DS(T8(Kp(e)))}function M8(e){var t=Qy(cx(e)),s=["absolute","fixed"].indexOf(yh(e).position)>=0,n=s&&Pc(e)?Yv(e):e;return Cm(n)?t.filter(function(r){return Cm(r)&&gk(r,n)&&dd(r)!=="body"}):[]}function E8(e,t,s,n){var r=t==="clippingParents"?M8(e):[].concat(t),a=[].concat(r,[s]),o=a[0],d=a.reduce(function(p,y){var v=zT(e,y,n);return p.top=fm(v.top,p.top),p.right=_b(v.right,p.right),p.bottom=_b(v.bottom,p.bottom),p.left=fm(v.left,p.left),p},zT(e,o,n));return d.width=d.right-d.left,d.height=d.bottom-d.top,d.x=d.left,d.y=d.top,d}function wk(e){var t=e.reference,s=e.element,n=e.placement,r=n?od(n):null,a=n?xg(n):null,o=t.x+t.width/2-s.width/2,d=t.y+t.height/2-s.height/2,p;switch(r){case il:p={x:o,y:t.y-s.height};break;case Oc:p={x:o,y:t.y+t.height};break;case Lc:p={x:t.x+t.width,y:d};break;case ol:p={x:t.x-s.width,y:d};break;default:p={x:t.x,y:t.y}}var y=r?pC(r):null;if(y!=null){var v=y==="y"?"height":"width";switch(a){case yg:p[y]=p[y]-(t[v]/2-s[v]/2);break;case gv:p[y]=p[y]+(t[v]/2-s[v]/2);break}}return p}function yv(e,t){t===void 0&&(t={});var s=t,n=s.placement,r=n===void 0?e.placement:n,a=s.strategy,o=a===void 0?e.strategy:a,d=s.boundary,p=d===void 0?Z4:d,y=s.rootBoundary,v=y===void 0?fk:y,C=s.elementContext,I=C===void 0?Ly:C,O=s.altBoundary,A=O===void 0?!1:O,P=s.padding,q=P===void 0?0:P,ce=vk(typeof q!="number"?q:bk(q,Wv)),re=I===Ly?X4:Ly,W=e.rects.popper,Ce=e.elements[A?re:I],te=E8(Cm(Ce)?Ce:Ce.contextElement||Kp(e.elements.popper),p,v,o),oe=bg(e.elements.reference),ve=wk({reference:oe,element:W,strategy:"absolute",placement:r}),ee=DS(Object.assign({},W,ve)),ne=I===Ly?ee:oe,Se={top:te.top-ne.top+ce.top,bottom:ne.bottom-te.bottom+ce.bottom,left:te.left-ne.left+ce.left,right:ne.right-te.right+ce.right},Ue=e.modifiersData.offset;if(I===Ly&&Ue){var Qe=Ue[r];Object.keys(Se).forEach(function(Me){var vt=[Lc,Oc].indexOf(Me)>=0?1:-1,Ut=[il,Oc].indexOf(Me)>=0?"y":"x";Se[Me]+=Qe[Ut]*vt})}return Se}function k8(e,t){t===void 0&&(t={});var s=t,n=s.placement,r=s.boundary,a=s.rootBoundary,o=s.padding,d=s.flipVariations,p=s.allowedAutoPlacements,y=p===void 0?mk:p,v=xg(n),C=v?d?NT:NT.filter(function(A){return xg(A)===v}):Wv,I=C.filter(function(A){return y.indexOf(A)>=0});I.length===0&&(I=C);var O=I.reduce(function(A,P){return A[P]=yv(e,{placement:P,boundary:r,rootBoundary:a,padding:o})[od(P)],A},{});return Object.keys(O).sort(function(A,P){return O[A]-O[P]})}function P8(e){if(od(e)===uC)return[];var t=H1(e);return[FT(e),t,FT(t)]}function R8(e){var t=e.state,s=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var r=s.mainAxis,a=r===void 0?!0:r,o=s.altAxis,d=o===void 0?!0:o,p=s.fallbackPlacements,y=s.padding,v=s.boundary,C=s.rootBoundary,I=s.altBoundary,O=s.flipVariations,A=O===void 0?!0:O,P=s.allowedAutoPlacements,q=t.options.placement,ce=od(q),re=ce===q,W=p||(re||!A?[H1(q)]:P8(q)),Ce=[q].concat(W).reduce(function(be,Ne){return be.concat(od(Ne)===uC?k8(t,{placement:Ne,boundary:v,rootBoundary:C,padding:y,flipVariations:A,allowedAutoPlacements:P}):Ne)},[]),te=t.rects.reference,oe=t.rects.popper,ve=new Map,ee=!0,ne=Ce[0],Se=0;Se<Ce.length;Se++){var Ue=Ce[Se],Qe=od(Ue),Me=xg(Ue)===yg,vt=[il,Oc].indexOf(Qe)>=0,Ut=vt?"width":"height",Rt=yv(t,{placement:Ue,boundary:v,rootBoundary:C,altBoundary:I,padding:y}),_t=vt?Me?Lc:ol:Me?Oc:il;te[Ut]>oe[Ut]&&(_t=H1(_t));var F=H1(_t),j=[];if(a&&j.push(Rt[Qe]<=0),d&&j.push(Rt[_t]<=0,Rt[F]<=0),j.every(function(be){return be})){ne=Ue,ee=!1;break}ve.set(Ue,j)}if(ee)for(var G=A?3:1,Y=function(Ne){var ke=Ce.find(function(qe){var ct=ve.get(qe);if(ct)return ct.slice(0,Ne).every(function(We){return We})});if(ke)return ne=ke,"break"},J=G;J>0;J--){var he=Y(J);if(he==="break")break}t.placement!==ne&&(t.modifiersData[n]._skip=!0,t.placement=ne,t.reset=!0)}}const $8={name:"flip",enabled:!0,phase:"main",fn:R8,requiresIfExists:["offset"],data:{_skip:!1}};function UT(e,t,s){return s===void 0&&(s={x:0,y:0}),{top:e.top-t.height-s.y,right:e.right-t.width+s.x,bottom:e.bottom-t.height+s.y,left:e.left-t.width-s.x}}function VT(e){return[il,Lc,Oc,ol].some(function(t){return e[t]>=0})}function O8(e){var t=e.state,s=e.name,n=t.rects.reference,r=t.rects.popper,a=t.modifiersData.preventOverflow,o=yv(t,{elementContext:"reference"}),d=yv(t,{altBoundary:!0}),p=UT(o,n),y=UT(d,r,a),v=VT(p),C=VT(y);t.modifiersData[s]={referenceClippingOffsets:p,popperEscapeOffsets:y,isReferenceHidden:v,hasPopperEscaped:C},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":v,"data-popper-escaped":C})}const L8={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:O8};function N8(e,t,s){var n=od(e),r=[ol,il].indexOf(n)>=0?-1:1,a=typeof s=="function"?s(Object.assign({},t,{placement:e})):s,o=a[0],d=a[1];return o=o||0,d=(d||0)*r,[ol,Lc].indexOf(n)>=0?{x:d,y:o}:{x:o,y:d}}function D8(e){var t=e.state,s=e.options,n=e.name,r=s.offset,a=r===void 0?[0,0]:r,o=mk.reduce(function(v,C){return v[C]=N8(C,t.rects,a),v},{}),d=o[t.placement],p=d.x,y=d.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=p,t.modifiersData.popperOffsets.y+=y),t.modifiersData[n]=o}const B8={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:D8};function F8(e){var t=e.state,s=e.name;t.modifiersData[s]=wk({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}const z8={name:"popperOffsets",enabled:!0,phase:"read",fn:F8,data:{}};function U8(e){return e==="x"?"y":"x"}function V8(e){var t=e.state,s=e.options,n=e.name,r=s.mainAxis,a=r===void 0?!0:r,o=s.altAxis,d=o===void 0?!1:o,p=s.boundary,y=s.rootBoundary,v=s.altBoundary,C=s.padding,I=s.tether,O=I===void 0?!0:I,A=s.tetherOffset,P=A===void 0?0:A,q=yv(t,{boundary:p,rootBoundary:y,padding:C,altBoundary:v}),ce=od(t.placement),re=xg(t.placement),W=!re,Ce=pC(ce),te=U8(Ce),oe=t.modifiersData.popperOffsets,ve=t.rects.reference,ee=t.rects.popper,ne=typeof P=="function"?P(Object.assign({},t.rects,{placement:t.placement})):P,Se=typeof ne=="number"?{mainAxis:ne,altAxis:ne}:Object.assign({mainAxis:0,altAxis:0},ne),Ue=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,Qe={x:0,y:0};if(!!oe){if(a){var Me,vt=Ce==="y"?il:ol,Ut=Ce==="y"?Oc:Lc,Rt=Ce==="y"?"height":"width",_t=oe[Ce],F=_t+q[vt],j=_t-q[Ut],G=O?-ee[Rt]/2:0,Y=re===yg?ve[Rt]:ee[Rt],J=re===yg?-ee[Rt]:-ve[Rt],he=t.elements.arrow,be=O&&he?hC(he):{width:0,height:0},Ne=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:yk(),ke=Ne[vt],qe=Ne[Ut],ct=Jy(0,ve[Rt],be[Rt]),We=W?ve[Rt]/2-G-ct-ke-Se.mainAxis:Y-ct-ke-Se.mainAxis,ht=W?-ve[Rt]/2+G+ct+qe+Se.mainAxis:J+ct+qe+Se.mainAxis,rt=t.elements.arrow&&Yv(t.elements.arrow),fe=rt?Ce==="y"?rt.clientTop||0:rt.clientLeft||0:0,ye=(Me=Ue==null?void 0:Ue[Ce])!=null?Me:0,Je=_t+We-ye-fe,at=_t+ht-ye,it=Jy(O?_b(F,Je):F,_t,O?fm(j,at):j);oe[Ce]=it,Qe[Ce]=it-_t}if(d){var Et,jt=Ce==="x"?il:ol,Nt=Ce==="x"?Oc:Lc,St=oe[te],Ct=te==="y"?"height":"width",Bt=St+q[jt],Kt=St-q[Nt],ys=[il,ol].indexOf(ce)!==-1,ts=(Et=Ue==null?void 0:Ue[te])!=null?Et:0,Us=ys?Bt:St-ve[Ct]-ee[Ct]-ts+Se.altAxis,ue=ys?St+ve[Ct]+ee[Ct]-ts-Se.altAxis:Kt,B=O&&ys?h8(Us,St,ue):Jy(O?Us:Bt,St,O?ue:Kt);oe[te]=B,Qe[te]=B-St}t.modifiersData[n]=Qe}}const j8={name:"preventOverflow",enabled:!0,phase:"main",fn:V8,requiresIfExists:["offset"]};function q8(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function H8(e){return e===Bl(e)||!Pc(e)?fC(e):q8(e)}function G8(e){var t=e.getBoundingClientRect(),s=vg(t.width)/e.offsetWidth||1,n=vg(t.height)/e.offsetHeight||1;return s!==1||n!==1}function W8(e,t,s){s===void 0&&(s=!1);var n=Pc(t),r=Pc(t)&&G8(t),a=Kp(t),o=bg(e,r,s),d={scrollLeft:0,scrollTop:0},p={x:0,y:0};return(n||!n&&!s)&&((dd(t)!=="body"||_C(a))&&(d=H8(t)),Pc(t)?(p=bg(t,!0),p.x+=t.clientLeft,p.y+=t.clientTop):a&&(p.x=mC(a))),{x:o.left+d.scrollLeft-p.x,y:o.top+d.scrollTop-p.y,width:o.width,height:o.height}}function Y8(e){var t=new Map,s=new Set,n=[];e.forEach(function(a){t.set(a.name,a)});function r(a){s.add(a.name);var o=[].concat(a.requires||[],a.requiresIfExists||[]);o.forEach(function(d){if(!s.has(d)){var p=t.get(d);p&&r(p)}}),n.push(a)}return e.forEach(function(a){s.has(a.name)||r(a)}),n}function Z8(e){var t=Y8(e);return o8.reduce(function(s,n){return s.concat(t.filter(function(r){return r.phase===n}))},[])}function X8(e){var t;return function(){return t||(t=new Promise(function(s){Promise.resolve().then(function(){t=void 0,s(e())})})),t}}function K8(e){var t=e.reduce(function(s,n){var r=s[n.name];return s[n.name]=r?Object.assign({},r,n,{options:Object.assign({},r.options,n.options),data:Object.assign({},r.data,n.data)}):n,s},{});return Object.keys(t).map(function(s){return t[s]})}var jT={placement:"bottom",modifiers:[],strategy:"absolute"};function qT(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return!t.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function J8(e){e===void 0&&(e={});var t=e,s=t.defaultModifiers,n=s===void 0?[]:s,r=t.defaultOptions,a=r===void 0?jT:r;return function(d,p,y){y===void 0&&(y=a);var v={placement:"bottom",orderedModifiers:[],options:Object.assign({},jT,a),modifiersData:{},elements:{reference:d,popper:p},attributes:{},styles:{}},C=[],I=!1,O={state:v,setOptions:function(ce){var re=typeof ce=="function"?ce(v.options):ce;P(),v.options=Object.assign({},a,v.options,re),v.scrollParents={reference:Cm(d)?Qy(d):d.contextElement?Qy(d.contextElement):[],popper:Qy(p)};var W=Z8(K8([].concat(n,v.options.modifiers)));return v.orderedModifiers=W.filter(function(Ce){return Ce.enabled}),A(),O.update()},forceUpdate:function(){if(!I){var ce=v.elements,re=ce.reference,W=ce.popper;if(!!qT(re,W)){v.rects={reference:W8(re,Yv(W),v.options.strategy==="fixed"),popper:hC(W)},v.reset=!1,v.placement=v.options.placement,v.orderedModifiers.forEach(function(Se){return v.modifiersData[Se.name]=Object.assign({},Se.data)});for(var Ce=0;Ce<v.orderedModifiers.length;Ce++){if(v.reset===!0){v.reset=!1,Ce=-1;continue}var te=v.orderedModifiers[Ce],oe=te.fn,ve=te.options,ee=ve===void 0?{}:ve,ne=te.name;typeof oe=="function"&&(v=oe({state:v,options:ee,name:ne,instance:O})||v)}}}},update:X8(function(){return new Promise(function(q){O.forceUpdate(),q(v)})}),destroy:function(){P(),I=!0}};if(!qT(d,p))return O;O.setOptions(y).then(function(q){!I&&y.onFirstUpdate&&y.onFirstUpdate(q)});function A(){v.orderedModifiers.forEach(function(q){var ce=q.name,re=q.options,W=re===void 0?{}:re,Ce=q.effect;if(typeof Ce=="function"){var te=Ce({state:v,name:ce,instance:O,options:W}),oe=function(){};C.push(te||oe)}})}function P(){C.forEach(function(q){return q()}),C=[]}return O}}var Q8=[w8,z8,b8,c8,B8,$8,j8,_8,L8],gC=J8({defaultModifiers:Q8});const BS={top:"top","top left":"top-end","top right":"top-start",right:"right","right top":"right-end","right bottom":"right-start",bottom:"bottom","bottom left":"bottom-end","bottom right":"bottom-start",left:"left","left top":"left-end","left bottom":"left-start"},HT=e=>Object.keys(BS).find(t=>t===e),eD={name:"Tooltip",components:{ButtonIcon:vn},mixins:[Xo],props:{alignment:{type:String,default:"top",validator(e){return HT(e)}},assistiveText:{type:String,default:"Help"},iconTitle:{type:String,default:""},overflowPadding:{type:Number,default:5},position:{type:String,default:"fixed",validator(e){return["absolute","fixed"].find(t=>t===e)}},source:{type:[HTMLElement,Function],default:null},text:{type:String,default:""}},data(){return{localSource:null,isOpen:!1,tooltipId:Vn(),popperInstance:null}},computed:{computedText(){return this.$props.text.replaceAll(/(<br>|<br \/>)/gm,`
`).replaceAll("<br />",`
`).replaceAll("&lt;br /&gt;",`
`).replaceAll(/(\\r\\n|\\n|\\r)/gm,`
`)},computedIconTitle(){return this.$props.iconTitle||this.$props.assistiveText}},watch:{"$props.source":{handler(){if(!!this.$props.source){if(this.$slots.source)throw new Error("Cannot set source prop and provide a default source");this.processSource(this.$props.source)}},immediate:!0},alignment(){HT(this.$props.alignment)&&this.popperInstance.setOptions({placement:BS[this.$props.alignment]})}},mounted(){if(this.$props.source)return;let e;this.$slots.source?e=this.$refs.source:e=this.$refs.defaultSource.$el,this.processSource(e)},beforeUnmount(){this.removeListeners()},methods:{async processSource(e){this.removeListeners(),this.localSource=typeof e=="function"?await e():e,this.localSource.setAttribute("aria-describedby",this.tooltipId),this.addListeners(),this.popperInstance?this.popperInstance.state.elements.reference=this.localSource:this.$nextTick(this.setPopperInstance)},setPopperInstance(){this.popperInstance=gC(this.localSource,this.$refs.tooltip,{strategy:this.$props.position,placement:BS[this.$props.alignment],modifiers:[{name:"offset",options:{offset:({placement:e})=>e.includes("end")?[16,14]:e.includes("start")?[-16,14]:[0,14]}},{name:"preventOverflow",options:{padding:this.$props.overflowPadding}}]}),this.$nextTick(()=>{document.activeElement===this.localSource&&this.enter()})},addListeners(){const e=["mouseenter","focus"],t=["mouseleave","blur"];e.forEach(s=>{this.localSource.addEventListener(s,this.enter)}),t.forEach(s=>{this.localSource.addEventListener(s,this.leave)})},removeListeners(){!this.localSource||(this.localSource.removeEventListener("focus",this.enter),this.localSource.removeEventListener("mouseenter",this.enter),this.localSource.removeEventListener("blur",this.leave),this.localSource.removeEventListener("mouseleave",this.leave))},enter(){this.isOpen=!0,this.popperInstance.update()},leave(){document.activeElement!==this.localSource&&(this.isOpen=!1)}}},tD=e=>(Nr("data-v-0233e977"),e=e(),Dr(),e),sD={key:0,ref:"source"},nD=["id"],rD={class:"slds-popover__body"},iD=tD(()=>k("div",{id:"arrow","data-popper-arrow":""},null,-1));function oD(e,t,s,n,r,a){const o=pe("ButtonIcon");return L(),X("div",null,[e.$props.source?$e("",!0):(L(),X("span",sD,[js(e.$slots,"source",{},()=>[de(o,{ref:"defaultSource","aria-describedby":r.tooltipId,"aria-disabled":"true",iconCategory:"utility",iconName:"info",iconSize:"xx-small",assistiveText:e.$props.assistiveText,title:a.computedIconTitle},null,8,["aria-describedby","assistiveText","title"])],!0)],512)),Mn(k("div",{id:r.tooltipId,ref:"tooltip",class:"slds-popover slds-popover_tooltip",role:"tooltip"},[k("div",rD,[js(e.$slots,"default",{},()=>[es(Pe(e.decodeHtml(a.computedText)),1)],!0)]),iD],8,nD),[[Ai,r.isOpen]])])}const Fo=os(eD,[["render",oD],["__scopeId","data-v-0233e977"]]),aD=()=>({name:"Default Label",stateOn:"Enabled",stateOff:"Disabled",required:"required"}),lD={name:"Checkbox",components:{Icon:yn,Tooltip:Fo},mixins:[Xo],props:{ariaLabeledBy:{type:String,default:""},disabled:Boolean,errors:{type:Array,default:()=>[]},helpText:{type:String,default:""},hideLabel:Boolean,indeterminate:Boolean,isFormElement:Boolean,labels:{type:Object,default:()=>{},validator:e=>!e||!e.name?(console.error('You must provide a "name" label, because it is the minimum requirement for accessibility. If you do not want to render the label than set hideLabel to true and the "name" label will be used as assistive text.'),!1):!0},modelValue:Boolean,readonly:Boolean,required:Boolean,showStateLabels:Boolean,slide:Boolean,toggleBuffer:{type:Number,default:0}},data(){return{checkboxId:Vn(),errorId:Vn(),labelId:Vn()}},computed:{computedLabels(){const e=Object.hasOwn(this,"$__getGlobalLabels")?this.$__getGlobalLabels().checkbox||{}:{};return{...aD(),...e,...this.$props.labels}},hasErrors(){return this.$props.errors.length&&!this.$props.slide},checkboxClass(){return this.slide?"slds-checkbox_toggle slds-grid":"slds-form-element__control"}},watch:{modelValue(e){this.$refs.checkbox&&(this.$refs.checkbox.checked=e),e&&this.$emit("update:indeterminate",!1)},indeterminate:{handler(e){this.$props.slide||this.$nextTick(()=>{this.$refs.checkbox.indeterminate=e,e&&this.$emit("update:modelValue",!1)})},immediate:!0}},mounted(){this.$refs.checkbox&&(this.$refs.checkbox.checked=this.$props.modelValue)},methods:{onClick(e){!e.clientX&&!e.clientY||e.currentTarget.checked&&this.toggleBuffer&&(this.$refs.checkbox.disabled=!0,setTimeout(()=>{this.$refs.checkbox.disabled=!1},this.toggleBuffer))},onInput(e){this.$emit("update:modelValue",e.target.checked)}}},yC=e=>(Nr("data-v-6891711e"),e=e(),Dr(),e),cD=["title"],uD=["checked","disabled","aria-describedby"],dD=["id"],hD=yC(()=>k("span",{class:"slds-checkbox_faux"},null,-1)),pD={key:0,class:"slds-checkbox_on"},fD={key:1,class:"slds-checkbox_off"},mD=["for"],_D=["title"],gD={class:"slds-form-element__control"},yD={key:0,class:"slds-checkbox slds-checkbox_standalone"},vD=["id","aria-describedby","checked","disabled"],bD=yC(()=>k("span",{class:"slds-checkbox_faux"},null,-1)),xD={key:2,class:"slds-form-element__control"},wD={key:0,class:"slds-checkbox"},SD=["title"],CD=["id","checked","disabled","aria-describedby","aria-labelledby"],ID=["id","for"],TD=yC(()=>k("span",{class:"slds-checkbox_faux"},null,-1)),AD={class:"slds-form-element__label slds-m-left_x-small"},MD=["id"];function ED(e,t,s,n,r,a){const o=pe("Icon"),d=pe("Tooltip");return L(),X("div",{class:$t([{"slds-has-error":a.hasErrors},"slds-form-element"])},[s.slide?(L(),X("label",{key:0,class:$t(a.checkboxClass)},[s.readonly?(L(),X(Lt,{key:1},[Mn(de(o,{category:"utility",name:"check",size:"x-small",class:"slds-current-color"},null,512),[[Ai,e.$props.modelValue]]),Mn(de(o,{category:"utility",name:"steps",size:"x-small",class:"slds-current-color"},null,512),[[Ai,!e.$props.modelValue]])],64)):(L(),X(Lt,{key:0},[s.required?(L(),X("abbr",{key:0,class:"slds-required",title:a.computedLabels.required},"*",8,cD)):$e("",!0),k("span",{class:$t(["slds-form-element__label slds-m-bottom_none",{"slds-assistive-text":e.$props.hideLabel}])},[k("span",null,Pe(e.decodeHtml(a.computedLabels.name)),1)],2),k("input",Ji({ref:"checkbox",checked:e.$props.modelValue||!1,disabled:s.disabled,"aria-describedby":r.labelId,type:"checkbox",onClick:t[0]||(t[0]=(...p)=>a.onClick&&a.onClick(...p)),onInput:t[1]||(t[1]=(...p)=>a.onInput&&a.onInput(...p))},id(e.$attrs,!0)),null,16,uD),k("span",{id:r.labelId,class:"slds-checkbox_faux_container","aria-live":"assertive"},[hD,s.showStateLabels?(L(),X("span",pD,Pe(e.decodeHtml(a.computedLabels.stateOn)),1)):$e("",!0),s.showStateLabels?(L(),X("span",fD,Pe(e.decodeHtml(a.computedLabels.stateOff)),1)):$e("",!0)],8,dD)],64))],2)):s.isFormElement?(L(),X(Lt,{key:1},[k("label",{class:"slds-form-element__label",for:r.checkboxId},[s.required?(L(),X("abbr",{key:0,class:"slds-required",title:a.computedLabels.required},"*",8,_D)):$e("",!0),es(" "+Pe(e.decodeHtml(a.computedLabels.name)),1)],8,mD),e.$props.helpText?(L(),Ge(d,{key:0,class:"slds-form-element__icon",alignment:"top right",text:e.$props.helpText},null,8,["text"])):$e("",!0),k("div",gD,[s.readonly?(L(),X(Lt,{key:1},[Mn(de(o,{category:"utility",name:"check",size:"x-small",class:"slds-current-color"},null,512),[[Ai,e.$props.modelValue]]),Mn(de(o,{category:"utility",name:"steps",size:"x-small",class:"slds-current-color"},null,512),[[Ai,!e.$props.modelValue]])],64)):(L(),X("span",yD,[k("input",Ji({id:r.checkboxId,ref:"checkbox","aria-describedby":e.$props.errors.length?r.errorId:null,checked:e.$props.modelValue||!1,disabled:s.disabled,type:"checkbox",onClick:t[2]||(t[2]=(...p)=>a.onClick&&a.onClick(...p)),onInput:t[3]||(t[3]=(...p)=>a.onInput&&a.onInput(...p))},id(e.$attrs,!0)),null,16,vD),bD]))])],64)):(L(),X("div",xD,[s.readonly?(L(),X(Lt,{key:1},[Mn(de(o,{category:"utility",name:"check",size:"x-small",class:"slds-current-color"},null,512),[[Ai,e.$props.modelValue]]),Mn(de(o,{category:"utility",name:"steps",size:"x-small",class:"slds-current-color"},null,512),[[Ai,!e.$props.modelValue]]),k("span",AD,Pe(e.decodeHtml(a.computedLabels.name)),1)],64)):(L(),X("div",wD,[s.required?(L(),X("abbr",{key:0,class:"slds-required",title:a.computedLabels.required},"*",8,SD)):$e("",!0),k("input",Ji({id:r.checkboxId,ref:"checkbox",checked:e.$props.modelValue||!1,disabled:s.disabled,"aria-describedby":e.$props.errors.length?r.errorId:null,"aria-labelledby":`${r.labelId} ${e.$props.ariaLabeledBy}`,type:"checkbox",onClick:t[4]||(t[4]=(...p)=>a.onClick&&a.onClick(...p)),onInput:t[5]||(t[5]=(...p)=>a.onInput&&a.onInput(...p))},id(e.$attrs,!0)),null,16,CD),k("label",{id:r.labelId,for:r.checkboxId,class:"slds-checkbox__label"},[TD,k("span",{class:$t(["slds-form-element__label",{"slds-assistive-text":e.$props.hideLabel}])},Pe(e.decodeHtml(a.computedLabels.name)),3)],8,ID)]))])),e.$props.errors.length?(L(),X("div",{key:3,id:r.errorId,class:"slds-form-element__help"},[(L(!0),X(Lt,null,As(s.errors,(p,y)=>(L(),X("p",{key:y},Pe(e.decodeHtml(p)),1))),128))],8,MD)):$e("",!0)],2)}const za=os(lD,[["render",ED],["__scopeId","data-v-6891711e"]]);var kD={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};const vv=kD,Sk={};for(const e of Object.keys(vv))Sk[vv[e]]=e;const Hs={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};var Ck=Hs;for(const e of Object.keys(Hs)){if(!("channels"in Hs[e]))throw new Error("missing channels property: "+e);if(!("labels"in Hs[e]))throw new Error("missing channel labels property: "+e);if(Hs[e].labels.length!==Hs[e].channels)throw new Error("channel and label counts mismatch: "+e);const{channels:t,labels:s}=Hs[e];delete Hs[e].channels,delete Hs[e].labels,Object.defineProperty(Hs[e],"channels",{value:t}),Object.defineProperty(Hs[e],"labels",{value:s})}Hs.rgb.hsl=function(e){const t=e[0]/255,s=e[1]/255,n=e[2]/255,r=Math.min(t,s,n),a=Math.max(t,s,n),o=a-r;let d,p;a===r?d=0:t===a?d=(s-n)/o:s===a?d=2+(n-t)/o:n===a&&(d=4+(t-s)/o),d=Math.min(d*60,360),d<0&&(d+=360);const y=(r+a)/2;return a===r?p=0:y<=.5?p=o/(a+r):p=o/(2-a-r),[d,p*100,y*100]};Hs.rgb.hsv=function(e){let t,s,n,r,a;const o=e[0]/255,d=e[1]/255,p=e[2]/255,y=Math.max(o,d,p),v=y-Math.min(o,d,p),C=function(I){return(y-I)/6/v+1/2};return v===0?(r=0,a=0):(a=v/y,t=C(o),s=C(d),n=C(p),o===y?r=n-s:d===y?r=1/3+t-n:p===y&&(r=2/3+s-t),r<0?r+=1:r>1&&(r-=1)),[r*360,a*100,y*100]};Hs.rgb.hwb=function(e){const t=e[0],s=e[1];let n=e[2];const r=Hs.rgb.hsl(e)[0],a=1/255*Math.min(t,Math.min(s,n));return n=1-1/255*Math.max(t,Math.max(s,n)),[r,a*100,n*100]};Hs.rgb.cmyk=function(e){const t=e[0]/255,s=e[1]/255,n=e[2]/255,r=Math.min(1-t,1-s,1-n),a=(1-t-r)/(1-r)||0,o=(1-s-r)/(1-r)||0,d=(1-n-r)/(1-r)||0;return[a*100,o*100,d*100,r*100]};function PD(e,t){return(e[0]-t[0])**2+(e[1]-t[1])**2+(e[2]-t[2])**2}Hs.rgb.keyword=function(e){const t=Sk[e];if(t)return t;let s=1/0,n;for(const r of Object.keys(vv)){const a=vv[r],o=PD(e,a);o<s&&(s=o,n=r)}return n};Hs.keyword.rgb=function(e){return vv[e]};Hs.rgb.xyz=function(e){let t=e[0]/255,s=e[1]/255,n=e[2]/255;t=t>.04045?((t+.055)/1.055)**2.4:t/12.92,s=s>.04045?((s+.055)/1.055)**2.4:s/12.92,n=n>.04045?((n+.055)/1.055)**2.4:n/12.92;const r=t*.4124+s*.3576+n*.1805,a=t*.2126+s*.7152+n*.0722,o=t*.0193+s*.1192+n*.9505;return[r*100,a*100,o*100]};Hs.rgb.lab=function(e){const t=Hs.rgb.xyz(e);let s=t[0],n=t[1],r=t[2];s/=95.047,n/=100,r/=108.883,s=s>.008856?s**(1/3):7.787*s+16/116,n=n>.008856?n**(1/3):7.787*n+16/116,r=r>.008856?r**(1/3):7.787*r+16/116;const a=116*n-16,o=500*(s-n),d=200*(n-r);return[a,o,d]};Hs.hsl.rgb=function(e){const t=e[0]/360,s=e[1]/100,n=e[2]/100;let r,a,o;if(s===0)return o=n*255,[o,o,o];n<.5?r=n*(1+s):r=n+s-n*s;const d=2*n-r,p=[0,0,0];for(let y=0;y<3;y++)a=t+1/3*-(y-1),a<0&&a++,a>1&&a--,6*a<1?o=d+(r-d)*6*a:2*a<1?o=r:3*a<2?o=d+(r-d)*(2/3-a)*6:o=d,p[y]=o*255;return p};Hs.hsl.hsv=function(e){const t=e[0];let s=e[1]/100,n=e[2]/100,r=s;const a=Math.max(n,.01);n*=2,s*=n<=1?n:2-n,r*=a<=1?a:2-a;const o=(n+s)/2,d=n===0?2*r/(a+r):2*s/(n+s);return[t,d*100,o*100]};Hs.hsv.rgb=function(e){const t=e[0]/60,s=e[1]/100;let n=e[2]/100;const r=Math.floor(t)%6,a=t-Math.floor(t),o=255*n*(1-s),d=255*n*(1-s*a),p=255*n*(1-s*(1-a));switch(n*=255,r){case 0:return[n,p,o];case 1:return[d,n,o];case 2:return[o,n,p];case 3:return[o,d,n];case 4:return[p,o,n];case 5:return[n,o,d]}};Hs.hsv.hsl=function(e){const t=e[0],s=e[1]/100,n=e[2]/100,r=Math.max(n,.01);let a,o;o=(2-s)*n;const d=(2-s)*r;return a=s*r,a/=d<=1?d:2-d,a=a||0,o/=2,[t,a*100,o*100]};Hs.hwb.rgb=function(e){const t=e[0]/360;let s=e[1]/100,n=e[2]/100;const r=s+n;let a;r>1&&(s/=r,n/=r);const o=Math.floor(6*t),d=1-n;a=6*t-o,(o&1)!==0&&(a=1-a);const p=s+a*(d-s);let y,v,C;switch(o){default:case 6:case 0:y=d,v=p,C=s;break;case 1:y=p,v=d,C=s;break;case 2:y=s,v=d,C=p;break;case 3:y=s,v=p,C=d;break;case 4:y=p,v=s,C=d;break;case 5:y=d,v=s,C=p;break}return[y*255,v*255,C*255]};Hs.cmyk.rgb=function(e){const t=e[0]/100,s=e[1]/100,n=e[2]/100,r=e[3]/100,a=1-Math.min(1,t*(1-r)+r),o=1-Math.min(1,s*(1-r)+r),d=1-Math.min(1,n*(1-r)+r);return[a*255,o*255,d*255]};Hs.xyz.rgb=function(e){const t=e[0]/100,s=e[1]/100,n=e[2]/100;let r,a,o;return r=t*3.2406+s*-1.5372+n*-.4986,a=t*-.9689+s*1.8758+n*.0415,o=t*.0557+s*-.204+n*1.057,r=r>.0031308?1.055*r**(1/2.4)-.055:r*12.92,a=a>.0031308?1.055*a**(1/2.4)-.055:a*12.92,o=o>.0031308?1.055*o**(1/2.4)-.055:o*12.92,r=Math.min(Math.max(0,r),1),a=Math.min(Math.max(0,a),1),o=Math.min(Math.max(0,o),1),[r*255,a*255,o*255]};Hs.xyz.lab=function(e){let t=e[0],s=e[1],n=e[2];t/=95.047,s/=100,n/=108.883,t=t>.008856?t**(1/3):7.787*t+16/116,s=s>.008856?s**(1/3):7.787*s+16/116,n=n>.008856?n**(1/3):7.787*n+16/116;const r=116*s-16,a=500*(t-s),o=200*(s-n);return[r,a,o]};Hs.lab.xyz=function(e){const t=e[0],s=e[1],n=e[2];let r,a,o;a=(t+16)/116,r=s/500+a,o=a-n/200;const d=a**3,p=r**3,y=o**3;return a=d>.008856?d:(a-16/116)/7.787,r=p>.008856?p:(r-16/116)/7.787,o=y>.008856?y:(o-16/116)/7.787,r*=95.047,a*=100,o*=108.883,[r,a,o]};Hs.lab.lch=function(e){const t=e[0],s=e[1],n=e[2];let r;r=Math.atan2(n,s)*360/2/Math.PI,r<0&&(r+=360);const o=Math.sqrt(s*s+n*n);return[t,o,r]};Hs.lch.lab=function(e){const t=e[0],s=e[1],r=e[2]/360*2*Math.PI,a=s*Math.cos(r),o=s*Math.sin(r);return[t,a,o]};Hs.rgb.ansi16=function(e,t=null){const[s,n,r]=e;let a=t===null?Hs.rgb.hsv(e)[2]:t;if(a=Math.round(a/50),a===0)return 30;let o=30+(Math.round(r/255)<<2|Math.round(n/255)<<1|Math.round(s/255));return a===2&&(o+=60),o};Hs.hsv.ansi16=function(e){return Hs.rgb.ansi16(Hs.hsv.rgb(e),e[2])};Hs.rgb.ansi256=function(e){const t=e[0],s=e[1],n=e[2];return t===s&&s===n?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(s/255*5)+Math.round(n/255*5)};Hs.ansi16.rgb=function(e){let t=e%10;if(t===0||t===7)return e>50&&(t+=3.5),t=t/10.5*255,[t,t,t];const s=(~~(e>50)+1)*.5,n=(t&1)*s*255,r=(t>>1&1)*s*255,a=(t>>2&1)*s*255;return[n,r,a]};Hs.ansi256.rgb=function(e){if(e>=232){const a=(e-232)*10+8;return[a,a,a]}e-=16;let t;const s=Math.floor(e/36)/5*255,n=Math.floor((t=e%36)/6)/5*255,r=t%6/5*255;return[s,n,r]};Hs.rgb.hex=function(e){const s=(((Math.round(e[0])&255)<<16)+((Math.round(e[1])&255)<<8)+(Math.round(e[2])&255)).toString(16).toUpperCase();return"000000".substring(s.length)+s};Hs.hex.rgb=function(e){const t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];let s=t[0];t[0].length===3&&(s=s.split("").map(d=>d+d).join(""));const n=parseInt(s,16),r=n>>16&255,a=n>>8&255,o=n&255;return[r,a,o]};Hs.rgb.hcg=function(e){const t=e[0]/255,s=e[1]/255,n=e[2]/255,r=Math.max(Math.max(t,s),n),a=Math.min(Math.min(t,s),n),o=r-a;let d,p;return o<1?d=a/(1-o):d=0,o<=0?p=0:r===t?p=(s-n)/o%6:r===s?p=2+(n-t)/o:p=4+(t-s)/o,p/=6,p%=1,[p*360,o*100,d*100]};Hs.hsl.hcg=function(e){const t=e[1]/100,s=e[2]/100,n=s<.5?2*t*s:2*t*(1-s);let r=0;return n<1&&(r=(s-.5*n)/(1-n)),[e[0],n*100,r*100]};Hs.hsv.hcg=function(e){const t=e[1]/100,s=e[2]/100,n=t*s;let r=0;return n<1&&(r=(s-n)/(1-n)),[e[0],n*100,r*100]};Hs.hcg.rgb=function(e){const t=e[0]/360,s=e[1]/100,n=e[2]/100;if(s===0)return[n*255,n*255,n*255];const r=[0,0,0],a=t%1*6,o=a%1,d=1-o;let p=0;switch(Math.floor(a)){case 0:r[0]=1,r[1]=o,r[2]=0;break;case 1:r[0]=d,r[1]=1,r[2]=0;break;case 2:r[0]=0,r[1]=1,r[2]=o;break;case 3:r[0]=0,r[1]=d,r[2]=1;break;case 4:r[0]=o,r[1]=0,r[2]=1;break;default:r[0]=1,r[1]=0,r[2]=d}return p=(1-s)*n,[(s*r[0]+p)*255,(s*r[1]+p)*255,(s*r[2]+p)*255]};Hs.hcg.hsv=function(e){const t=e[1]/100,s=e[2]/100,n=t+s*(1-t);let r=0;return n>0&&(r=t/n),[e[0],r*100,n*100]};Hs.hcg.hsl=function(e){const t=e[1]/100,n=e[2]/100*(1-t)+.5*t;let r=0;return n>0&&n<.5?r=t/(2*n):n>=.5&&n<1&&(r=t/(2*(1-n))),[e[0],r*100,n*100]};Hs.hcg.hwb=function(e){const t=e[1]/100,s=e[2]/100,n=t+s*(1-t);return[e[0],(n-t)*100,(1-n)*100]};Hs.hwb.hcg=function(e){const t=e[1]/100,n=1-e[2]/100,r=n-t;let a=0;return r<1&&(a=(n-r)/(1-r)),[e[0],r*100,a*100]};Hs.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]};Hs.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]};Hs.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]};Hs.gray.hsl=function(e){return[0,0,e[0]]};Hs.gray.hsv=Hs.gray.hsl;Hs.gray.hwb=function(e){return[0,100,e[0]]};Hs.gray.cmyk=function(e){return[0,0,0,e[0]]};Hs.gray.lab=function(e){return[e[0],0,0]};Hs.gray.hex=function(e){const t=Math.round(e[0]/100*255)&255,n=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(n.length)+n};Hs.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]};const gb=Ck;function RD(){const e={},t=Object.keys(gb);for(let s=t.length,n=0;n<s;n++)e[t[n]]={distance:-1,parent:null};return e}function $D(e){const t=RD(),s=[e];for(t[e].distance=0;s.length;){const n=s.pop(),r=Object.keys(gb[n]);for(let a=r.length,o=0;o<a;o++){const d=r[o],p=t[d];p.distance===-1&&(p.distance=t[n].distance+1,p.parent=n,s.unshift(d))}}return t}function OD(e,t){return function(s){return t(e(s))}}function LD(e,t){const s=[t[e].parent,e];let n=gb[t[e].parent][e],r=t[e].parent;for(;t[r].parent;)s.unshift(t[r].parent),n=OD(gb[t[r].parent][r],n),r=t[r].parent;return n.conversion=s,n}var ND=function(e){const t=$D(e),s={},n=Object.keys(t);for(let r=n.length,a=0;a<r;a++){const o=n[a];t[o].parent!==null&&(s[o]=LD(o,t))}return s};const FS=Ck,DD=ND,Z_={},BD=Object.keys(FS);function FD(e){const t=function(...s){const n=s[0];return n==null?n:(n.length>1&&(s=n),e(s))};return"conversion"in e&&(t.conversion=e.conversion),t}function zD(e){const t=function(...s){const n=s[0];if(n==null)return n;n.length>1&&(s=n);const r=e(s);if(typeof r=="object")for(let a=r.length,o=0;o<a;o++)r[o]=Math.round(r[o]);return r};return"conversion"in e&&(t.conversion=e.conversion),t}BD.forEach(e=>{Z_[e]={},Object.defineProperty(Z_[e],"channels",{value:FS[e].channels}),Object.defineProperty(Z_[e],"labels",{value:FS[e].labels});const t=DD(e);Object.keys(t).forEach(n=>{const r=t[n];Z_[e][n]=zD(r),Z_[e][n].raw=FD(r)})});var Ny=Z_;const UD=["#FF6E00","#D31A28","#6C2777","#6FB384","#01BFBF","#2C7ED0","#000000"],VD=["#FFFA00","#FF7B96","#D053FF","#46E71B","#68FFD7","#ADD4F3","#FFFFFF"],GT="rgba(255, 255, 255, 1)",WT="rgba(0, 0, 0, .7)";function Zw(e){let t=parseInt(e,16);return t/=255,t=t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4),t}function jD(e){let t=String(e).replace(/[^0-9a-f]/gi,"");if(t.length===3&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),UD.includes(`#${t}`))return GT;if(VD.includes(`#${t}`))return WT;const s=Zw(t.slice(0,2)),n=Zw(t.slice(2,4)),r=Zw(t.slice(-2));return .2126*s+.7152*n+.0722*r<.42?GT:WT}const qD={name:"Tabs",components:{Icon:yn},mixins:[Xo],provide(){return{addTab:e=>this.tabs.push(e),updateTab:e=>{const t=this.tabs.findIndex(s=>s.id===e.id);this.tabs[t]=e}}},props:{modelValue:String|Number,navigation:{type:Boolean,default:!1,validation:()=>globalThis.vertical},scoped:{type:Boolean,default:!1,validation:()=>!globalThis.vertical},vertical:{type:Boolean,default:!1,validation:()=>!globalThis.scoped},onRequestTabChange:{type:Function,default:null}},data(){return{tabs:[],localActiveTabId:null}},computed:{tabClass(){let e="slds-tabs_default";return this.$props.scoped?e="slds-tabs_scoped":this.$props.vertical&&(e="slds-vertical-tabs"),e},selectedTabIndex(){return this.tabs.findIndex(e=>e.id===this.localActiveTabId)}},watch:{modelValue(){this.setActiveTab()}},mounted(){this.setActiveTab()},methods:{setActiveTab(){this.selectTab(this.$props.modelValue||this.tabs[0].id)},allowTabChange(e){return typeof this.$props.onRequestTabChange=="function"?this.$props.onRequestTabChange(e,this.activeTabId):!0},getListItemCSSClasses(e){if(e.sectionHeader)return[];const t=[];return!this.$props.navigation&&this.$props.vertical?t.push(`${this.tabClass}__nav-item`):this.$props.navigation&&this.$props.vertical?t.push("slds-nav-vertical__item"):t.push(`${this.tabClass}__item`),e.active&&t.push("slds-is-active"),e.invalid&&t.push("slds-has-error"),e.anchorFocused&&t.push("slds-has-focus"),e.disabled&&t.push("section-disabled"),t},onClick(e,t){t.link?typeof t.link=="function"?t.link():window.open(t.link,"self"):this.selectTab(t.id,e)},async selectTab(e,t){if(this.localActiveTabId===e){t&&t.preventDefault();return}const s=this.tabs.find(n=>n.id===e);!s||s.disabled||!await this.allowTabChange(e)||(this.tabs.forEach(n=>{const r=n.id===s.id;n.active=r,n.setActive(r),r&&this.focusOnTablistItem(n)}),this.localActiveTabId=e,this.$emit("changed",s.id),this.$emit("update:modelValue",e))},nextTab(){let e=this.selectedTabIndex===this.tabs.length-1?0:this.selectedTabIndex+1;for(;this.tabs[e].disabled||this.tabs[e].sectionHeader;)e<this.tabs.length-1?e++:e=0;this.selectTab(this.tabs[e].id)},previousTab(){let e=this.selectedTabIndex===0?this.tabs.length-1:this.selectedTabIndex-1;for(;this.tabs[e].disabled||this.tabs[e].sectionHeader;)e>0?e--:e=this.tabs.length-1;this.selectTab(this.tabs[e].id)},focusOnTablistItem(e){this.$refs.tablist.querySelector(`[aria-controls="${e.id}"]`).focus()},doRenderIcon(e){return this.$props.navigation&&e.iconCategory&&e.iconName&&e.iconAssistiveText}}},HD=["title","tabId","onClick"],GD=["id","aria-selected","aria-controls","tabindex","onFocus","onBlur","onClick"];function WD(e,t,s,n,r,a){const o=pe("Icon");return L(),X("div",{class:$t([a.tabClass])},[k("ul",{ref:"tablist",class:$t([e.$props.navigation?"navigation-list":`${a.tabClass}__nav`]),role:"tablist",onKeydown:[t[0]||(t[0]=Zs(Os((...d)=>a.nextTab&&a.nextTab(...d),["prevent"]),["right"])),t[1]||(t[1]=Zs(Os((...d)=>a.nextTab&&a.nextTab(...d),["prevent"]),["down"])),t[2]||(t[2]=Zs(Os((...d)=>a.previousTab&&a.previousTab(...d),["prevent"]),["left"])),t[3]||(t[3]=Zs(Os((...d)=>a.previousTab&&a.previousTab(...d),["prevent"]),["up"]))]},[(L(!0),X(Lt,null,As(r.tabs,(d,p)=>(L(),X("li",Ji({key:p,class:a.getListItemCSSClasses(d),title:d.title,role:"presentation",tabId:d.id,onClick:y=>e.$emit("tab-click",d.id,y)},id(e.$attrs,!0)),[d.sectionHeader?(L(),X("h2",{key:1,class:$t([{"section-disabled":d.disabled},"slds-nav-vertical__title"])},Pe(e.decodeHtml(d.title)),3)):(L(),X("a",{key:0,id:`${d.id}__item`,class:$t([e.$props.navigation?"slds-nav-vertical__action":`${a.tabClass}__link`]),"aria-selected":d.id===r.localActiveTabId,"aria-controls":d.id,tabindex:d.id===r.localActiveTabId?0:-1,href:"javascript:void(0);",role:"tab",onFocus:y=>d.anchorFocused=!0,onBlur:y=>d.anchorFocused=!1,onClick:y=>a.onClick(y,d)},[a.doRenderIcon(d)?(L(),Ge(o,{key:0,category:d.iconCategory,name:d.iconName,size:"x-small",assistiveText:d.iconAssistiveText,class:"slds-m-right_x-small slds-line-height_reset"},null,8,["category","name","assistiveText"])):$e("",!0),es(" "+Pe(e.decodeHtml(d.title))+" ",1),d.invalid?(L(),X("span",{key:1,class:$t([e.$props.vertical?"slds-vertical-tabs__right-icon":"slds-tabs__right-icon"])},[de(o,{category:"utility",name:"error",size:"x-small",variant:"error",assistiveText:"This item has an error"})],2)):$e("",!0)],42,GD))],16,HD))),128)),js(e.$slots,"content",{},void 0,!0)],34),js(e.$slots,"default",{},void 0,!0)],2)}const vC=os(qD,[["render",WD],["__scopeId","data-v-87fbdef9"]]),YD={name:"Tab",inject:["addTab","updateTab"],props:{disabled:Boolean,forceReloadWhenActivated:Boolean,iconCategory:{type:String,default:null},iconName:{type:String,default:null},iconAssistiveText:{type:String,default:""},id:{type:String,required:!0},isSectionHeader:Boolean,invalid:Boolean,link:{type:[String,Function],default:""},renderImmediately:Boolean,title:{type:String,required:!0}},data(){return{active:!1,vertical:!1,loaded:!1,anchorFocused:!1}},watch:{$props(){this.updateTab({...this.$props,...this.$data,setActive:e=>{this.active=e}})},active(){this.loaded||this.forceReloadWhenActivated||(this.loaded=!0)}},created(){this.addTab({...this.$props,...this.$data,setActive:e=>{this.active=e}})},methods:{getCSSClasses(){const e=[this.active?"slds-show":"slds-hide"];return e.push(`${this.$parent.$props.vertical?"slds-vertical-tabs":"slds-tabs_default"}__content`),e}}},ZD=["id","aria-labelledby"];function XD(e,t,s,n,r,a){return s.renderImmediately||r.active||r.loaded?(L(),X("div",{key:0,id:s.id,class:$t(a.getCSSClasses()),"aria-labelledby":`${s.id}__item`,role:"tabpanel"},[js(e.$slots,"default",{state:{active:r.active,loaded:r.loaded}})],10,ZD)):$e("",!0)}const bC=os(YD,[["render",XD]]),KD=()=>["#FFFA00","#FF7B96","#D053FF","#46E71B","#68FFD7","#ADD4F3","#FFFFFF","#FF6E00","#D31A28","#6C2777","#6FB384","#01BFBF","#2C7ED0","#000000"],JD=()=>["#e3abec","#c2dbf7","#9fd6ff","#9de7da","#9df0c0","#fff099","#fed49a","#d073e0","#86baf3","#5ebbff","#44d8be","#3be282","#ffe654","#ffb758","#bd35bd","#5779c1","#05007a","#00aea9","#3cba4c","#f5bc25","#f99221","#580d8c","#001970","#0a2399","#0b7477","#0b6b50","#b67e11","#b85d0d"],QD=()=>({done:"Done",chooseColor:"Choose Color",cancel:"Cancel",custom:"Custom",required:"Required",hex:"Hex",hexError:"The color entered is not a valid HEX code",assistiveTextInstructions:"Use arrow keys to select a saturation and brightness, on an x and y axis",assistiveTextSaturation:"Saturation",assistiveTextBrightness:"Brightness",assistiveTextSelectHue:"Select Hue",titleR:"R",titleG:"G",titleB:"B",rgbError:"The value needs to be an integer from 0-255",invalidColor:"The color entered is invalid",assistiveTextRed:"Red",assistiveTextGreen:"Green",assistiveTextBlue:"Blue",standard:"Standard",expanded:"Expanded"}),eB={name:"ColorPicker",components:{Button:Tn,ButtonIcon:vn,Tabs:vC,Tab:bC,Tooltip:Fo},directives:{"click-outside":cC},mixins:[Xo],props:{disabled:Boolean,errors:{type:Array,default:()=>[]},helpText:{type:String,default:""},labelForId:{type:String,default:""},labels:{type:Object,default:()=>{}},required:Boolean,modelValue:{type:String,default:""}},data(){return{colorPickerId:Vn(),color:"",standardColors:KD(),expandedColors:JD(),colors:[],colorSwatches:[],errorId:Vn(),focusedColorSwatchIndex:0,doRenderDropdown:!1,newColor:"",customColor:{bottom:0,left:0,hsv:{hue:0,saturation:0,value:0},rgb:{R:0,G:0,B:0},errors:{red:!1,green:!1,blue:!1,hex:!1},isInvalid:!1,invalidMessage:""},activeColorPickerTabId:"",popperInstance:()=>{},tempColor:"",centerColor:""}},computed:{standardTabId(){return`color-picker-standard__item-${this.colorPickerId}`},expandedTabId(){return`color-picker-expanded__item-${this.colorPickerId}`},customTabId(){return`color-picker-custom__item-${this.colorPickerId}`},isStandardTab(){return this.activeColorPickerTabId===this.standardTabId},isExpandedTab(){return this.activeColorPickerTabId===this.expandedTabId},isCustomTab(){return this.activeColorPickerTabId===this.customTabId},computedErrors(){const e=[...this.$props.errors];return this.customColor.errors.hex&&!this.doRenderDropdown&&e.push(this.customColor.invalidMessage),e},computedLabels(){const e=Object.hasOwn(this,"$__getGlobalLabels")?this.$__getGlobalLabels().colorPicker||{}:{};return{...QD(),...e,...this.$props.labels}},positionRangeIndicator(){return`bottom:${this.customColor.bottom}px;left:${this.customColor.left}px`},hue(){return`background-color:hsl(${this.customColor.hsv.hue},100%,50%)`},selectedRGB(){return`background-color:rgb(${this.customColor.rgb.R},${this.customColor.rgb.G},${this.customColor.rgb.B})`},clickOutsideOptions(){return{active:this.doRenderDropdown,handler:this.cancel}}},watch:{$props:{handler(){this.$props.labels&&(!this.$props.labels.chooseColor||!this.$props.labels.chooseColor.length)&&(!this.$props.labelForId||!this.$props.labelForId.length)&&console.error("Must provide label for chooseColor or pass value to labelForId prop")},deep:!0,immediate:!0},"$props.modelValue":{handler(e){this.newColor=e,this.color=e,this.clearErrors(),this.setColor()},immediate:!0},color(){this.$emit("update:modelValue",this.color)},async doRenderDropdown(e){if(e){const{activeTabId:t,swatchIndex:s}=this.getActiveColorMetadata(this.color);this.activeColorPickerTabId=t,this.focusedColorSwatchIndex=s,await this.$nextTick(this.bindPopperInstance)}}},mounted(){this.centerColor=this.$props.modelValue?this.findCenterColor(this.$props.modelValue):""},methods:{findCenterColor(e){return jD(e)},async handleTabChange(e){e!==this.activeColorPickerTabId&&(this.focusedColorSwatchIndex=0),await this.$nextTick(this.popperInstance.update)},handleSwatchFocus(e,t){this.focusedColorSwatchIndex=t,this.tempColor=e},bindPopperInstance(){const e=this.$refs.colorPickerDropdownTrigger.$el,t=this.$refs.colorPickerDropdown;this.popperInstance=gC(e,t,{strategy:"fixed",placement:"bottom-start",modifiers:[{name:"offset",options:{offset:[0,8]}}]})},getActiveColorMetadata(e=this.$props.modelValue){if(e){const t=this.standardColors.findIndex(n=>n===e),s=this.expandedColors.findIndex(n=>n===e);return t!==-1?{swatchIndex:t,activeTabId:this.standardTabId}:s!==-1?{swatchIndex:s,activeTabId:this.expandedTabId}:{swatchIndex:0,activeTabId:this.customTabId}}return{swatchIndex:0,activeTabId:this.standardTabId}},async toggleColorPickerDropdown(){this.doRenderDropdown=!this.doRenderDropdown},async hideColorPickerDropdown(){this.doRenderDropdown=!1,this.tempColor="",this.newColor="",this.focus()},focus(){const{colorPickerDropdownTrigger:e}=this.$refs;e&&e.$el.focus()},setColor(e){e?this.tempColor=e:this.tempColor=this.newColor,this.color&&this.convertHex(this.color)},saveColor(){this.color=this.isCustomTab?this.newColor:this.tempColor,this.centerColor=this.findCenterColor(this.color),this.hideColorPickerDropdown(),this.setColor(this.color)},setCustomRangePosition(){this.customColor.left=Math.round(this.customColor.hsv.saturation/100*196),this.customColor.bottom=Math.round(this.customColor.hsv.value/100*78)},getCustomRangePosition(e){this.focusedColorSwatchIndex=0;const t=e.target.getBoundingClientRect(),s=e.clientX-t.left,n=e.clientY-t.top,r=196,a=78-n,o=Math.round(s/r*100),d=Math.round(a/78*100);this.customColor.left=s,this.customColor.bottom=a,this.customColor.hsv.saturation=o,this.customColor.hsv.value=d,this.convertHSV()},convertHSVToRGB(){const e=Ny.hsv.rgb(this.customColor.hsv.hue,this.customColor.hsv.saturation,this.customColor.hsv.value);[this.customColor.rgb.R,this.customColor.rgb.G,this.customColor.rgb.B]=e},convertHSVToHEX(){const e=Ny.hsv.hex(this.customColor.hsv.hue,this.customColor.hsv.saturation,this.customColor.hsv.value);this.newColor=`#${e}`},convertHSV(){this.customColor.errors.red=!1,this.customColor.errors.green=!1,this.customColor.errors.blue=!1,this.customColor.errors.hex=!1,this.customColor.isInvalid=!1,this.convertHSVToRGB(),this.convertHSVToHEX()},convertRGBToHex(){const e=this.customColor.rgb.R,t=this.customColor.rgb.G,s=this.customColor.rgb.B;if(e<0||e>255?(this.customColor.errors.red=!0,this.customColor.invalidMessage=this.computedLabels.rgbError):this.customColor.errors.red=!1,t<0||t>255?(this.customColor.errors.green=!0,this.customColor.invalidMessage=this.computedLabels.rgbError):this.customColor.errors.green=!1,s<0||s>255?(this.customColor.errors.blue=!0,this.customColor.invalidMessage=this.computedLabels.rgbError):this.customColor.errors.blue=!1,this.customColor.errors.blue||this.customColor.errors.red||this.customColor.errors.green){this.customColor.isInvalid=!0;return}this.customColor.isInvalid=!1;const n=Ny.rgb.hex(this.customColor.rgb.R,this.customColor.rgb.G,this.customColor.rgb.B);this.newColor=`#${n}`},convertRGBToHSV(){const e=this.customColor.rgb.R,t=this.customColor.rgb.G,s=this.customColor.rgb.B;if(e<0||e>255?(this.customColor.errors.red=!0,this.customColor.invalidMessage=this.computedLabels.rgbError):this.customColor.errors.red=!1,t<0||t>255?(this.customColor.errors.green=!0,this.customColor.invalidMessage=this.computedLabels.rgbError):this.customColor.errors.green=!1,s<0||s>255?(this.customColor.errors.blue=!0,this.customColor.invalidMessage=this.computedLabels.rgbError):this.customColor.errors.blue=!1,this.customColor.errors.blue||this.customColor.errors.red||this.customColor.errors.green){this.customColor.isInvalid=!0;return}this.customColor.isInvalid=!1;const n=Ny.rgb.hsv(this.customColor.rgb.R,this.customColor.rgb.G,this.customColor.rgb.B);[this.customColor.hsv.hue,this.customColor.hsv.saturation,this.customColor.hsv.value]=n},convertRGB(){this.customColor.errors.hex=!1,this.convertRGBToHex(),this.convertRGBToHSV(),this.setCustomRangePosition()},convertHexToRGB(e){const t=Ny.hex.rgb(e);[this.customColor.rgb.R,this.customColor.rgb.G,this.customColor.rgb.B]=t},convertHex(e){if(e.charAt(0)!=="#"){this.customColor.invalidMessage=this.computedLabels.hexError,this.customColor.isInvalid=!0,this.customColor.errors.hex=!0;return}let t=e;if(t=t.replace("#",""),t.length!==6){this.customColor.invalidMessage=this.computedLabels.hexError,this.customColor.isInvalid=!0,this.customColor.errors.hex=!0;return}if(this.clearErrors(),/^[0-9a-fA-F]+$/.test(t))this.clearErrors();else{this.customColor.invalidMessage=this.computedLabels.invalidColor,this.customColor.isInvalid=!0,this.customColor.errors.hex=!0;return}this.customColor.errors.hex||(this.convertHexToRGB(e),this.convertRGB())},cancel(){this.color?this.hideColorPickerDropdown():(this.clearCustomPicker(),this.hideColorPickerDropdown())},clearErrors(){this.customColor.invalidMessage="",this.customColor.isInvalid=!1,this.customColor.errors.hex=!1},clearCustomPicker(){this.customColor.hsv.hue=0,this.customColor.hsv.saturation=0,this.customColor.hsv.value=0,this.customColor.rgb.R=null,this.customColor.rgb.G=null,this.customColor.rgb.B=null,this.customColor.bottom=null,this.customColor.left=null,this.newColor=""},isNumber(e){(e.keyCode===101||e.keyCode===43||e.keyCode===45)&&e.preventDefault()},previousColor(e){const t=this.isStandardTab?this.standardColors.length:this.expandedColors.length;this.focusedColorSwatchIndex>0?this.focusedColorSwatchIndex--:this.focusedColorSwatchIndex=t-1,e.target.parentElement.parentElement.children[this.focusedColorSwatchIndex].firstChild.focus()},nextColor(e){const t=this.isStandardTab?this.standardColors.length:this.expandedColors.length;this.focusedColorSwatchIndex<t-1?this.focusedColorSwatchIndex++:this.focusedColorSwatchIndex=0,e.target.parentElement.parentElement.children[this.focusedColorSwatchIndex].firstChild.focus()}}},tB=e=>(Nr("data-v-d5d192e4"),e=e(),Dr(),e),sB=["for"],nB=["title"],rB={class:"slds-form-element__control"},iB={style:{display:"inline-block"}},oB={class:"slds-color-picker__summary-input"},aB=["id","aria-describedby","disabled"],lB=["id"],cB=["aria-label","aria-describedby"],uB=["id"],dB={class:"slds-color-picker__swatches",role:"listbox"},hB=["onKeydown","onClick"],pB=["tabindex","onFocus"],fB={class:"slds-assistive-text"},mB={class:"slds-color-picker__swatches",role:"listbox"},_B=["onKeydown","onClick"],gB=["tabindex","onFocus"],yB={class:"slds-assistive-text"},vB={class:"slds-color-picker__custom"},bB=["id"],xB=["aria-describedby"],wB={class:"slds-assistive-text"},SB={class:"slds-color-picker__hue-and-preview"},CB=["for"],IB=["id"],TB={class:"slds-assistive-text","aria-hidden":"true"},AB=tB(()=>k("span",{class:"slds-assistive-text","aria-hidden":"true"},null,-1)),MB=[AB],EB={class:"slds-color-picker__custom-inputs"},kB={class:"slds-form-element slds-color-picker__input-custom-hex"},PB=["for"],RB=["id"],$B={class:"slds-form-element"},OB=["for"],LB=["title"],NB=["id"],DB={class:"slds-form-element"},BB=["for"],FB=["title"],zB=["id"],UB={class:"slds-form-element"},VB=["for"],jB=["title"],qB=["id"],HB={key:0,class:"slds-form-error slds-color-picker__input-custom-error"},GB={class:"slds-popover__footer"},WB={class:"slds-color-picker__selector-footer"};function YB(e,t,s,n,r,a){const o=pe("Tooltip"),d=pe("ButtonIcon"),p=pe("Tab"),y=pe("Tabs"),v=pe("Button"),C=mg("click-outside");return L(),X("div",{class:"slds-color-picker",onKeydown:t[27]||(t[27]=Zs(Os((...I)=>a.hideColorPickerDropdown&&a.hideColorPickerDropdown(...I),["stop"]),["esc"]))},[k("div",{class:$t(["slds-form-element slds-color-picker__summary",{"slds-has-error":a.computedErrors.length}])},[a.computedLabels.chooseColor?(L(),X("label",{key:0,class:"slds-form-element__label slds-color-picker__summary-label",for:`slds-color-picker__summary-input-${r.colorPickerId}`},[e.$props.required?(L(),X("abbr",{key:0,class:"slds-required",title:a.computedLabels.required},"*",8,nB)):$e("",!0),es(" "+Pe(e.decodeHtml(a.computedLabels.chooseColor)),1)],8,sB)):$e("",!0),e.$props.helpText?(L(),Ge(o,{key:1,class:"slds-form-element__icon",alignment:"top right",text:e.$props.helpText},null,8,["text"])):$e("",!0),k("div",rB,[de(d,{ref:"colorPickerDropdownTrigger",class:"slds-color-picker__summary-button",assistiveText:`Choose a color. Current color: ${r.color}`,more:"",variant:"border-filled",title:a.computedLabels.chooseColor,disabled:e.$props.disabled,onClick:a.toggleColorPickerDropdown},{default:je(()=>[k("span",iB,[k("span",{style:br({background:r.color}),class:"slds-swatch a11ySwatch slds-m-right_xx-small"},[r.centerColor?(L(),X("span",{key:0,style:br({backgroundColor:r.centerColor}),class:"swatchCenter"},null,4)):$e("",!0)],4)])]),_:1},8,["assistiveText","title","disabled","onClick"]),k("div",oB,[Mn(k("input",{id:a.computedLabels.chooseColor?`slds-color-picker__summary-input-${r.colorPickerId}`:s.labelForId,"onUpdate:modelValue":t[0]||(t[0]=I=>r.color=I),type:"text",maxlength:"7",class:"slds-input","aria-describedby":a.computedErrors.length?r.errorId:null,disabled:e.$props.disabled,onChange:t[1]||(t[1]=I=>a.convertHex(r.color)),onFocus:t[2]||(t[2]=I=>r.doRenderDropdown=!1)},null,40,aB),[[Tp,r.color]])])]),a.computedErrors.length?(L(),X("div",{key:2,id:r.errorId,class:"slds-form-element__help"},[(L(!0),X(Lt,null,As(a.computedErrors,(I,O)=>(L(),X("p",{key:O},Pe(e.decodeHtml(I)),1))),128))],8,lB)):$e("",!0)],2),r.doRenderDropdown?Mn((L(),X("section",{key:0,ref:"colorPickerDropdown",tabindex:"-1","aria-label":a.computedLabels.chooseColor,"aria-describedby":a.customTabId,class:"slds-popover slds-color-picker__selector",role:"dialog"},[k("div",{id:a.customTabId,class:"slds-popover__body"},[de(y,{ref:"defaultTab",modelValue:r.activeColorPickerTabId,"onUpdate:modelValue":t[26]||(t[26]=I=>r.activeColorPickerTabId=I),onChanged:a.handleTabChange},{default:je(()=>[de(p,{id:a.standardTabId,title:a.computedLabels.standard},{default:je(()=>[k("ul",dB,[(L(!0),X(Lt,null,As(r.standardColors,(I,O)=>(L(),X("li",{key:O,class:$t(["slds-color-picker__swatch",{"is-active":r.focusedColorSwatchIndex===O}]),role:"presentation",onKeydown:Zs(Os(A=>a.setColor(I,O),["stop"]),["enter"]),onClick:Os(A=>a.setColor(I,O),["prevent"])},[k("a",{tabindex:r.focusedColorSwatchIndex===O?0:-1,class:"slds-color-picker__swatch-trigger",href:"#!",role:"option",onKeydown:[t[3]||(t[3]=Zs(Os(A=>a.previousColor(A),["prevent"]),["up"])),t[4]||(t[4]=Zs(Os(A=>a.previousColor(A),["prevent"]),["left"])),t[5]||(t[5]=Zs(Os(A=>a.nextColor(A),["prevent"]),["down"])),t[6]||(t[6]=Zs(Os(A=>a.nextColor(A),["prevent"]),["right"]))],onFocus:A=>a.handleSwatchFocus(I,O)},[k("span",{style:br({background:I}),class:"slds-swatch a11ySwatch"},[k("span",{style:br({backgroundColor:a.findCenterColor(I)}),class:"swatchCenter"},null,4),k("span",fB,Pe(I),1)],4)],40,pB)],42,hB))),128))])]),_:1},8,["id","title"]),de(p,{id:a.expandedTabId,title:a.computedLabels.expanded},{default:je(()=>[k("ul",mB,[(L(!0),X(Lt,null,As(r.expandedColors,(I,O)=>(L(),X("li",{key:O,class:$t(["slds-color-picker__swatch",{"is-active":r.focusedColorSwatchIndex===O}]),role:"presentation",onKeydown:Zs(Os(A=>a.setColor(I,O),["stop"]),["enter"]),onClick:Os(A=>a.setColor(I,O),["prevent"])},[k("a",{tabindex:r.focusedColorSwatchIndex===O?0:-1,class:"slds-color-picker__swatch-trigger",href:"#!",role:"option",onKeydown:[t[7]||(t[7]=Zs(Os(A=>a.previousColor(A),["prevent"]),["up"])),t[8]||(t[8]=Zs(Os(A=>a.previousColor(A),["prevent"]),["left"])),t[9]||(t[9]=Zs(Os(A=>a.nextColor(A),["prevent"]),["down"])),t[10]||(t[10]=Zs(Os(A=>a.nextColor(A),["prevent"]),["right"]))],onFocus:A=>a.handleSwatchFocus(I,O)},[k("span",{style:br({background:I}),class:"slds-swatch a11ySwatch"},[k("span",{style:br({backgroundColor:a.findCenterColor(I)}),class:"swatchCenter"},null,4),k("span",yB,Pe(I),1)],4)],40,gB)],42,_B))),128))])]),_:1},8,["id","title"]),de(p,{id:a.customTabId,title:a.computedLabels.custom},{default:je(()=>[k("div",vB,[k("p",{id:`color-picker-instructions-${r.colorPickerId}`,class:"slds-assistive-text"},Pe(a.computedLabels.assistiveTextInstructions)+". ",9,bB),k("div",{class:"slds-color-picker__custom-range",style:br(a.hue),onClick:t[11]||(t[11]=Os(I=>a.getCustomRangePosition(I),["prevent"]))},[k("a",{class:"slds-color-picker__range-indicator",style:br(a.positionRangeIndicator),href:"#","aria-live":"assertive","aria-atomic":"true","aria-describedby":`color-picker-instructions-${r.colorPickerId}`},[k("span",wB,Pe(a.computedLabels.assistiveTextSaturation)+": "+Pe(r.customColor.hsv.saturation)+". "+Pe(a.computedLabels.assistiveTextBrightness)+": "+Pe(r.customColor.hsv.value),1)],12,xB)],4),k("div",SB,[k("label",{for:`custom-color-hue-${r.colorPickerId}`,class:"slds-assistive-text"},Pe(a.computedLabels.assistiveTextSelectHue),9,CB),Mn(k("input",{id:`custom-color-hue-${r.colorPickerId}`,"onUpdate:modelValue":t[12]||(t[12]=I=>r.customColor.hsv.hue=I),min:"0",max:"360",type:"range",class:"slds-color-picker__hue-slider",onChange:t[13]||(t[13]=(...I)=>a.convertHSV&&a.convertHSV(...I))},null,40,IB),[[Tp,r.customColor.hsv.hue,void 0,{number:!0}]]),k("span",{class:"slds-swatch",style:br(a.selectedRGB)},[k("span",TB,Pe(r.newColor),1)],4),k("span",{id:"clearCustomColor",class:"slds-swatch",onClick:t[14]||(t[14]=Os((...I)=>a.clearCustomPicker&&a.clearCustomPicker(...I),["prevent"]))},MB)])]),k("div",EB,[k("div",kB,[k("label",{for:`custom-color-hex-${r.colorPickerId}`,class:"slds-form-element__label"},Pe(a.computedLabels.hex),9,PB),k("div",{class:$t(["slds-form-element__control",{"slds-has-error":r.customColor.errors.hex}])},[Mn(k("input",{id:`custom-color-hex-${r.colorPickerId}`,"onUpdate:modelValue":t[15]||(t[15]=I=>r.newColor=I),class:"slds-input slds-input_counter",maxlength:"7",type:"text",onChange:t[16]||(t[16]=I=>a.convertHex(r.newColor))},null,40,RB),[[Tp,r.newColor]])],2)]),k("div",$B,[k("label",{for:`custom-color-red-${r.colorPickerId}`,class:"slds-form-element__label"},[k("abbr",{title:a.computedLabels.assistiveTextRed},Pe(a.computedLabels.titleR),9,LB)],8,OB),k("div",{class:$t(["slds-form-element__control",{"slds-has-error":r.customColor.errors.red}])},[Mn(k("input",{id:`custom-color-red-${r.colorPickerId}`,"onUpdate:modelValue":t[17]||(t[17]=I=>r.customColor.rgb.R=I),max:"255",class:"slds-input slds-input_counter",type:"number",onKeypress:t[18]||(t[18]=I=>a.isNumber(I)),onChange:t[19]||(t[19]=(...I)=>a.convertRGB&&a.convertRGB(...I))},null,40,NB),[[Tp,r.customColor.rgb.R,void 0,{number:!0}]])],2)]),k("div",DB,[k("label",{for:`custom-color-green-${r.colorPickerId}`,class:"slds-form-element__label"},[k("abbr",{title:a.computedLabels.assistiveTextGreen},Pe(a.computedLabels.titleG),9,FB)],8,BB),k("div",{class:$t(["slds-form-element__control",{"slds-has-error":r.customColor.errors.green}])},[Mn(k("input",{id:`custom-color-green-${r.colorPickerId}`,"onUpdate:modelValue":t[20]||(t[20]=I=>r.customColor.rgb.G=I),max:"255",class:"slds-input slds-input_counter",type:"number",onKeypress:t[21]||(t[21]=I=>a.isNumber(I)),onChange:t[22]||(t[22]=(...I)=>a.convertRGB&&a.convertRGB(...I))},null,40,zB),[[Tp,r.customColor.rgb.G,void 0,{number:!0}]])],2)]),k("div",UB,[k("label",{for:`custom-color-blue-${r.colorPickerId}`,class:"slds-form-element__label"},[k("abbr",{title:a.computedLabels.assistiveTextBlue},Pe(a.computedLabels.titleB),9,jB)],8,VB),k("div",{class:$t(["slds-form-element__control",{"slds-has-error":r.customColor.errors.blue}])},[Mn(k("input",{id:`custom-color-blue-${r.colorPickerId}`,"onUpdate:modelValue":t[23]||(t[23]=I=>r.customColor.rgb.B=I),max:"255",class:"slds-input slds-input_counter",type:"number",onKeypress:t[24]||(t[24]=I=>a.isNumber(I)),onChange:t[25]||(t[25]=(...I)=>a.convertRGB&&a.convertRGB(...I))},null,40,qB),[[Tp,r.customColor.rgb.B,void 0,{number:!0}]])],2)])]),r.customColor.isInvalid?(L(),X("p",HB,Pe(r.customColor.invalidMessage),1)):$e("",!0)]),_:1},8,["id","title"])]),_:1},8,["modelValue","onChanged"])],8,uB),k("footer",GB,[k("div",WB,[de(v,{variant:"neutral",onClick:a.cancel},{default:je(()=>[es(Pe(e.decodeHtml(a.computedLabels.cancel)),1)]),_:1},8,["onClick"]),de(v,{variant:"brand",onClick:a.saveColor},{default:je(()=>[es(Pe(e.decodeHtml(a.computedLabels.done)),1)]),_:1},8,["onClick"])])])],8,cB)),[[C,void 0,a.clickOutsideOptions]]):$e("",!0)],32)}const ZB=os(eB,[["render",YB],["__scopeId","data-v-d5d192e4"]]),Ik={name:"ConditionalWrapper",functional:!0,inheritAttrs:!1,props:{element:{type:String,required:!0},active:Boolean},render(){const e=this.$slots.default?this.$slots.default():null;return this.$props.active?An(this.$props.element,{...this.$attrs},e):e}};function zS(e,t,s){var n,r,a,o,d;t==null&&(t=100);function p(){var v=Date.now()-o;v<t&&v>=0?n=setTimeout(p,t-v):(n=null,s||(d=e.apply(a,r),a=r=null))}var y=function(){a=this,r=arguments,o=Date.now();var v=s&&!n;return n||(n=setTimeout(p,t)),v&&(d=e.apply(a,r),a=r=null),d};return y.clear=function(){n&&(clearTimeout(n),n=null)},y.flush=function(){n&&(d=e.apply(a,r),a=r=null,clearTimeout(n),n=null)},y}zS.debounce=zS;var Tk=zS,Ak={exports:{}};(function(e,t){(function(s,n){e.exports=n()})(Qu,function(){var s="__v-click-outside",n=typeof window<"u",r=typeof navigator<"u",a=n&&("ontouchstart"in window||r&&navigator.msMaxTouchPoints>0)?["touchstart"]:["click"],o=function(v){var C=v.event,I=v.handler;(0,v.middleware)(C)&&I(C)},d=function(v,C){var I=function(re){var W=typeof re=="function";if(!W&&typeof re!="object")throw new Error("v-click-outside: Binding value must be a function or an object");return{handler:W?re:re.handler,middleware:re.middleware||function(Ce){return Ce},events:re.events||a,isActive:re.isActive!==!1,detectIframe:re.detectIframe!==!1,capture:Boolean(re.capture)}}(C.value),O=I.handler,A=I.middleware,P=I.detectIframe,q=I.capture;if(I.isActive){if(v[s]=I.events.map(function(re){return{event:re,srcTarget:document.documentElement,handler:function(W){return function(Ce){var te=Ce.el,oe=Ce.event,ve=Ce.handler,ee=Ce.middleware,ne=oe.path||oe.composedPath&&oe.composedPath();(ne?ne.indexOf(te)<0:!te.contains(oe.target))&&o({event:oe,handler:ve,middleware:ee})}({el:v,event:W,handler:O,middleware:A})},capture:q}}),P){var ce={event:"blur",srcTarget:window,handler:function(re){return function(W){var Ce=W.el,te=W.event,oe=W.handler,ve=W.middleware;setTimeout(function(){var ee=document.activeElement;ee&&ee.tagName==="IFRAME"&&!Ce.contains(ee)&&o({event:te,handler:oe,middleware:ve})},0)}({el:v,event:re,handler:O,middleware:A})},capture:q};v[s]=[].concat(v[s],[ce])}v[s].forEach(function(re){var W=re.event,Ce=re.srcTarget,te=re.handler;return setTimeout(function(){v[s]&&Ce.addEventListener(W,te,q)},0)})}},p=function(v){(v[s]||[]).forEach(function(C){return C.srcTarget.removeEventListener(C.event,C.handler,C.capture)}),delete v[s]},y=n?{beforeMount:d,updated:function(v,C){var I=C.value,O=C.oldValue;JSON.stringify(I)!==JSON.stringify(O)&&(p(v),d(v,{value:I}))},unmounted:p}:{};return{install:function(v){v.directive("click-outside",y)},directive:y}})})(Ak);const XB=Ak.exports;function YT(){const e={0:{options:[],filtered:[]}};let t=0,s=!1,n=1;const r=this.options.length;for(let a=0;a<r;a++){const o=this.options[a];if(o.options){const p=o.title;if(Array.isArray(o.options)){const{title:y,options:v}=o;p?e[n++]={title:y,options:v,filtered:[],static:!0}:e[0].options=e[0].options.concat(v),s=!0}else if(typeof o.options=="function"){const y=p?n++:0,v=O=>this.invokeOptionsFunction(o.options,y,O),C=Tk(v,this.asyncDelay,o.lazy),I={searchIndex:0,cached:!1,options:[],doCancelAsync:!1,loading:!1,async:!0,lazy:o.lazy,optionsFunction:v,debounce:C};p?e[y]={title:o.title,filtered:[],...I}:e[0]={...e[0],...I},t++}}else if(e[0].static=!0,s=!0,typeof o=="object")e[0].options.push({$__guid:Vn(),...o});else if(["string","number","symbol"].includes(typeof o)){const p=typeof o=="symbol"?o.description:o.toString();e[0].options.push({$__guid:Vn(),[this.idKey]:o,[this.titleKey]:p})}}return{groups:e,numAsyncGroups:t,hasStaticOptions:s}}const KB={name:"Spinner",props:{adjustForOverflow:Boolean,delayed:Boolean,fixed:Boolean,immediate:Boolean,inline:Boolean,loadingLabel:{type:String,default:"Loading"},size:{type:String,default:"medium",validator:e=>{const t=["xx-small","x-small","small","medium","large"],s=t.includes(e);return s||console.error(`Valid size prop values are ${t.join(", ")}`),s}},theme:{type:String,default:"base",validator:e=>{const t=["base","brand","inverse"],s=t.includes(e);return s||console.error(`Valid theme prop values are ${t.join(", ")}`),s}},withoutContainer:Boolean},data(){return{observer:null}},computed:{spinnerClasses(){const e=[];return this.$props.immediate&&e.push("spm-spinner_immediate"),this.$props.theme&&e.push(`slds-spinner_${this.$props.theme}`),this.$props.delayed&&e.push("slds-spinner_delayed"),this.$props.size&&e.push(`slds-spinner_${this.$props.size}`),this.$props.inline&&e.push("slds-spinner_inline"),e},containerClasses(){const e=[];return(!this.$props.withoutContainer||this.$slots.description)&&e.push("slds-spinner_container"),this.$props.fixed&&e.push("slds-is-fixed"),e}},created(){this.$props.adjustForOverflow&&window.addEventListener("scroll",this.updateContainerSize)},mounted(){this.$props.adjustForOverflow&&(this.updateContainerSize(),this.observer=new MutationObserver(this.updateContainerSize),this.observer.observe(this.$refs.container,{attributes:!0}))},beforeUnmount(){this.$props.adjustForOverflow&&(window.removeEventListener("scroll",this.updateContainerSize),this.observer.disconnect(),this.observer=null)},methods:{updateContainerSize(){const e=this.$refs.container,{parentNode:t}=e.parentNode,s=t.getBoundingClientRect(),n=window.innerHeight;s.height<n||(s.top<0?e.style.top=`${Math.abs(s.top)}px`:e.style.top=0,s.bottom>n?e.style.bottom=`${s.bottom-n}px`:e.style.bottom=0)}}},Mk=e=>(Nr("data-v-21b087de"),e=e(),Dr(),e),JB={class:"slds-assistive-text"},QB=Mk(()=>k("div",{class:"slds-spinner__dot-a"},null,-1)),eF=Mk(()=>k("div",{class:"slds-spinner__dot-b"},null,-1)),tF={key:0,class:"description"},sF={"aria-live":"assertive",class:"slds-grid slds-grid_vertical slds-p-top_xx-large slds-text-align_center"};function nF(e,t,s,n,r,a){return L(),X("div",{ref:"container",class:$t(a.containerClasses)},[k("div",{class:$t([a.spinnerClasses,"slds-spinner"]),"aria-hidden":"false",role:"status"},[k("span",JB,Pe(e.$props.loadingLabel),1),QB,eF],2),e.$slots.description?(L(),X("div",tF,[k("div",sF,[js(e.$slots,"description",{},void 0,!0)])])):$e("",!0)],2)}const Vr=os(KB,[["render",nF],["__scopeId","data-v-21b087de"]]),{parseInt:V_,getComputedStyle:Xw}=window,rF={name:"PicklistDropdown",components:{Icon:yn,Spinner:Vr},mixins:[Xo],data(){return{focusedOption:null,paddingBuffer:0,currentOptionsLength:this.getDefaultOptionsLength()}},computed:{focusedOptionId(){let e=null;return this.focusedOption&&(e=this.focusedOption.dataset.id,this.focusedOption.dataset.type==="number"&&(e=V_(e)),this.focusedOption.dataset.type==="symbol"&&(e=Symbol.for(e))),e},computedOptionGroups(){const e={};let t=this.currentOptionsLength;return Object.entries(this.$parent.groupData.groups).forEach(([s,n])=>{if(n.async||n.filtered.length){if(t===0)return;let r;n.filtered.length>=t?(r=t,t=0):(r=n.filtered.length,t-=n.filtered.length),e[s]={renderLength:r,...n}}}),e},doRenderGlobalNoSearchResults(){return this.$parent.groupData.hasStaticOptions&&!Object.values(this.$parent.groupData.groups).some(e=>e.async||e.filtered.length)}},watch:{focusedOption(){this.$parent.focusedOptionId=this.focusedOptionId},"$parent.groupData.groups":{handler(){this.$parent.computedDoRenderDropdown&&(this.currentOptionsLength=this.getDefaultOptionsLength(),this.$nextTick(this.setDropdownHeight))},deep:!0,immediate:!0},"$parent.comboboxInputOption":{handler(e){this.$nextTick(()=>{this.focusedOption=e?this.$refs.comboboxInputOption:this.getFirstAvailableOptionEl(),this.$el.scrollTop=0})}}},mounted(){this.$nextTick(()=>{this.paddingBuffer=V_(Xw(this.$el).paddingTop||0)})},methods:{getDefaultOptionsLength(){return this.$parent.$props.pageSize<=0?1/0:Math.max(this.$parent.$props.pageSize,this.$parent.$props.heightInNumOptions+1)},getListRole(e){return e?"group":"presentation"},setDropdownHeight(){var a,o,d;const e=this.$el;let t=0,s=0,n=0;const r=Array.from(this.$el.querySelectorAll("li.slds-listbox__item"));for(let p=0;p<r.length;p++){const y=r[p];if(t+=y.clientHeight,Object.prototype.hasOwnProperty.call(y.dataset,"header")?n++:s++,s===this.$parent.$props.heightInNumOptions)break}if(r.length<=s+n)e.style.height="auto";else{const{borderTopWidth:p,paddingTop:y}=Xw(e),v=(V_(p,10)+V_(y,10))*2;let C=(a=this.$refs.dropdownHeader)==null?void 0:a.clientHeight;if(C){const{marginTop:I,marginBottom:O}=Xw((d=(o=this.$refs.dropdownHeader)==null?void 0:o.children)==null?void 0:d[0]);C+=V_(I,10),C+=V_(O,10)}e.style.height=`${t+v+C}px`}this.focusOption()},focusOption(){if(Array.isArray(this.$parent.modelValue))if(this.$parent.modelValue.length){const[e]=this.$parent.modelValue;this.focusedOption=this.$el.querySelector(`li[data-id="${this.$parent.getIdAsString(e)}"][data-type="${typeof e}"]`)||this.getFirstAvailableOptionEl(),this.scrollToFocusedOption()}else this.focusedOption=this.getFirstAvailableOptionEl();else this.$parent.modelValue!==null&&this.$parent.modelValue!==""&&this.$parent.comboboxInputOption===null?(this.focusedOption=this.$el.querySelector(`li[data-id="${this.$parent.getIdAsString(this.$parent.modelValue)}"][data-type="${typeof this.$parent.modelValue}"]`)||this.getFirstAvailableOptionEl(),this.scrollToFocusedOption()):this.focusedOption=this.getFirstAvailableOptionEl()},getFirstAvailableOptionEl(){return this.$el.querySelector("li[data-option]")},scrollToFocusedOption(){const e=this.focusedOption.offsetTop+this.paddingBuffer,t=this.$el.clientHeight;e>=this.$el.scrollTop+t-this.paddingBuffer&&(this.$el.scrollTop=e+this.focusedOption.clientHeight-t)},enter(e){if(this.focusedOption===this.$refs.comboboxInputOption)this.$parent.select(this.$parent.comboboxInputOption,e);else{const t=this.$parent.getOptionById(this.focusedOptionId);this.$parent.select(t,e)}},down(){if(!this.focusedOption)return;const{nextElementSibling:e,parentElement:{nextElementSibling:t}}=this.focusedOption;if(e)this.focusedOption=e;else if(t){const n=function r(a){return a===null?null:a.querySelector("li[data-option]")||r(t.nextElementSibling)}(t);n&&(this.focusedOption=n)}this.focusedOption&&this.scrollToFocusedOption(),this.onScroll()},up(){if(!this.focusedOption)return;const{previousElementSibling:e,parentElement:{previousElementSibling:t}}=this.focusedOption;if(e&&Object.hasOwnProperty.call(e.dataset,"option"))this.focusedOption=e;else if(t){const r=function a(o){return o===null?null:o.querySelector("li[data-option]:last-child")||a(t.previousElementSibling)}(t);r&&(this.focusedOption=r)}this.focusedOption.offsetTop<=this.$el.scrollTop&&(this.$el.scrollTop=this.focusedOption.offsetTop-this.paddingBuffer)},onScroll({target:e=this.$el}={}){const{scrollTop:t,scrollHeight:s,clientHeight:n}=e||this.$el;this.lastScrollTop>t||t+n>=s-5&&(this.currentOptionsLength+=this.$parent.$props.pageSize,e.scrollTop=t,this.lastScrollTop=t)}}},iF=["id"],oF={ref:"dropdownHeader"},aF={key:0,class:"slds-listbox slds-listbox_vertical",role:"presentation"},lF=["data-id"],cF=["aria-selected"],uF={class:"slds-media__figure slds-listbox__option-icon"},dF={class:"slds-media__body"},hF={class:"slds-listbox__option-text slds-listbox__option-text_entity"},pF={key:1},fF={class:"slds-listbox__item slds-listbox__status slds-p-vertical_x-small",role:"status","aria-live":"polite"},mF=["title"],_F=["role"],gF={key:0,role:"presentation",class:"slds-listbox__item","data-header":""},yF={class:"slds-media slds-listbox__option slds-listbox__option_plain slds-media_small",role:"presentation"},vF={class:"slds-listbox__option-header",role:"presentation"},bF={key:1,class:"slds-listbox__item slds-listbox__status slds-p-vertical_x-small",role:"status","aria-live":"polite"},xF=["title"],wF=["data-id","data-type","onMousedown"],SF=["aria-selected"],CF={class:"slds-media__figure slds-listbox__option-icon"},IF={class:"slds-media__body"},TF=["title"],AF={key:2},MF={class:"slds-align_absolute-center slds-p-top_medium"};function EF(e,t,s,n,r,a){const o=pe("Icon"),d=pe("Spinner");return L(),X("div",Ji({id:e.$parent.dropdownId,class:"slds-dropdown slds-dropdown_fluid",role:"listbox"},id(e.$parent.$props.pageSize>0?{scroll:a.onScroll}:{},!0)),[k("div",oF,[js(e.$slots,"dropdownHeader",{},void 0,!0)],512),e.$parent.comboboxInputOption?(L(),X("ul",aF,[k("li",{ref:"comboboxInputOption",role:"presentation",class:"slds-listbox__item","data-id":e.$parent.getIdAsString(e.$parent.getId(e.$parent.comboboxInputOption)),"data-option":"",onMousedown:t[0]||(t[0]=Os(p=>e.$parent.select(e.$parent.comboboxInputOption,p),["prevent"]))},[k("div",{"aria-selected":r.focusedOption===e.$refs.comboboxInputOption,class:$t(["slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_term",{"slds-has-focus":r.focusedOption===e.$refs.comboboxInputOption}]),role:"option"},[k("span",uF,[de(o,{assistiveText:e.$parent.computedLabels.comboboxAdd,title:e.$parent.computedLabels.comboboxAdd,category:"utility",name:"add",size:"x-small"},null,8,["assistiveText","title"])]),k("span",dF,[k("span",hF,Pe(e.$parent.comboboxInputOption[e.$parent.$props.titleKey]),1)])],10,cF)],40,lF)])):$e("",!0),a.doRenderGlobalNoSearchResults?(L(),X("ul",pF,[k("li",fF,[k("span",{class:"slds-m-left_x-large",title:e.$parent.computedLabels.noSearchResults},Pe(e.decodeHtml(e.$parent.computedLabels.noSearchResults)),9,mF)])])):$e("",!0),(L(!0),X(Lt,null,As(a.computedOptionGroups,(p,y,v)=>(L(),X("ul",{key:v,class:"slds-listbox slds-listbox_vertical",role:a.getListRole(p)},[p.title!=null&&(p.filtered.length||p.async)?(L(),X("li",gF,[k("div",yF,[k("h3",vF,Pe(e.decodeHtml(p.title)),1)])])):$e("",!0),p.async&&!p.filtered.length&&!p.loading?(L(),X("li",bF,[k("span",{class:"slds-m-left_x-large",title:e.$parent.computedLabels.noSearchResults},Pe(e.decodeHtml(e.$parent.computedLabels.noSearchResults)),9,xF)])):$e("",!0),(L(!0),X(Lt,null,As(p.renderLength,C=>(L(),X("li",{key:p.filtered[C-1].$__guid,"data-id":e.$parent.getIdAsString(e.$parent.getId(p.filtered[C-1])),"data-type":e.$parent.getIdType(p.filtered[C-1]),"data-option":"",role:"presentation",class:"slds-listbox__item",onMousedown:Os(I=>e.$parent.select(p.filtered[C-1],I),["prevent"])},[k("div",{class:$t(["slds-media slds-listbox__option slds-listbox__option_plain slds-media_small",{"slds-has-focus":e.$parent.getId(p.filtered[C-1])===a.focusedOptionId,"slds-is-selected":e.$parent.isOptionSelected(p.filtered[C-1])}]),"aria-selected":e.$parent.getId(p.filtered[C-1])===a.focusedOptionId,role:"option"},[js(e.$slots,"option",{option:p.filtered[C-1],index:C},()=>[k("span",CF,[e.$parent.isOptionSelected(p.filtered[C-1])?(L(),Ge(o,{key:0,class:"slds-current-color",category:"utility",name:"check",size:"x-small"})):$e("",!0)]),k("span",IF,[k("span",{class:"slds-truncate",title:e.$parent.getTitle(p.filtered[C-1])},Pe(e.decodeHtml(e.$parent.getTitle(p.filtered[C-1]))),9,TF)])],!0)],10,SF)],40,wF))),128)),p.loading?(L(),X("li",AF,[k("div",MF,[de(d,{class:"slds-input__icon",size:"x-small",withoutContainer:"",isInline:""})])])):$e("",!0)],8,_F))),128))],16,iF)}const kF=os(rF,[["render",EF],["__scopeId","data-v-4e43a862"]]),PF={components:{Checkbox:za},mixins:[Xo],data(){return{dialogId:Vn(),focusableElements:[]}},watch:{"$parent.groupData":{handler(e){Object.values(e.groups).forEach(t=>{t.filtered=t.filtered.map(s=>({...s,isSelected:this.$parent.isOptionSelected(s),original:s}))})},immediate:!0}},mounted(){this.$nextTick(()=>{this.focusableElements=this.$el.querySelectorAll("input:not([disabled])"),this.focusableElements[0].focus()})},methods:{save(e){const t=[];Object.values(this.$parent.groupData.groups).forEach(s=>{s.filtered.forEach(n=>{if(n.isSelected){const r=this.$parent.getId(n);t.push(r)}})}),this.$parent.$emit("update:modelValue",t),this.reset(e)},select(e,t){this.$parent.$emit("selected-option",e.original,t)},reset(e){this.$parent.reset(e),this.$parent.focus()},focusFirstElement(e){e.stopPropagation(),e.preventDefault(),this.focusableElements[0].focus()},shiftTab(e){document.activeElement===this.focusableElements[0]&&(e.stopPropagation(),e.preventDefault(),this.$refs.savebutton.focus())}}},RF=["aria-describedby","aria-label"],$F=["id"],OF={key:0,class:"slds-form-element__legend slds-form-element__label"},LF={class:"slds-form-element__control"},NF={class:"slds-popover__footer slds-popover__footer_form"};function DF(e,t,s,n,r,a){const o=pe("Checkbox");return L(),X("section",{"aria-describedby":r.dialogId,"aria-label":e.$parent.$props.labels.name,class:"slds-popover slds-popover_full-width custom-z-index",role:"dialog",onKeydown:[t[3]||(t[3]=Zs(Os((...d)=>a.reset&&a.reset(...d),["stop"]),["esc"])),t[4]||(t[4]=Zs(Os((...d)=>a.shiftTab&&a.shiftTab(...d),["exact","shift"]),["tab"]))]},[k("div",{id:r.dialogId,ref:"multiselectdialog",class:"slds-popover__body slds-popover__body_small"},[(L(!0),X(Lt,null,As(e.$parent.groupData.groups,(d,p,y)=>(L(),X("fieldset",{key:y,class:"slds-form-element"},[d.title!=null?(L(),X("legend",OF,Pe(e.decodeHtml(d.title)),1)):$e("",!0),k("div",LF,[(L(!0),X(Lt,null,As(d.filtered,v=>(L(),Ge(o,{key:v.$__guid,modelValue:v.isSelected,"onUpdate:modelValue":C=>v.isSelected=C,labels:{name:e.$parent.getTitle(v)},onClick:C=>a.select(v,C)},null,8,["modelValue","onUpdate:modelValue","labels","onClick"]))),128))])]))),128))],8,$F),k("footer",NF,[k("button",{class:"slds-button slds-button_neutral",onClick:t[0]||(t[0]=(...d)=>a.reset&&a.reset(...d))},Pe(e.decodeHtml(e.$parent.computedLabels.cancel)),1),k("button",{ref:"savebutton",class:"slds-button slds-button_brand",onKeydown:t[1]||(t[1]=Zs(Os((...d)=>a.focusFirstElement&&a.focusFirstElement(...d),["stop","exact"]),["tab"])),onClick:t[2]||(t[2]=(...d)=>a.save&&a.save(...d))},Pe(e.decodeHtml(e.$parent.computedLabels.save)),545)])],40,RF)}const BF=os(PF,[["render",DF],["__scopeId","data-v-0a28cef2"]]),FF={name:"PillList",components:{Icon:yn},mixins:[Xo],props:{assistiveText:{type:Object,default:()=>({remove:"Press delete or backspace to remove.",listboxLabel:"Selected Options:",error:"Warning"})},containerBorder:Boolean,labels:{type:Object,default:()=>({removeTitle:"Remove",error:"Error"})},options:{type:Array,default:()=>[],validator(e){return e.every(t=>{const n=uk(t,["label","title"]);return n.length?(console.error(`Options object is missing required properties: ${n.toString()}`),!1):!0})}},pillBorder:{type:Boolean,default:!0},readonly:Boolean},data(){return{mutableOptionsArray:[],lastFocusedOptionIndex:0}},watch:{options:{handler(e){this.mutableOptionsArray=e.map(t=>({$__guid:Vn(),...t}))},deep:!0,immediate:!0}},methods:{focusLastFocusedOption(){const e=this.$refs[`option-${this.lastFocusedOptionIndex}`][0];e&&e.focus()},remove(e,t){if(this.readonly)return;const s=this.mutableOptionsArray.splice(e,1)[0];if(delete s.$__guid,this.$emit("update:options",this.mutableOptionsArray),this.$emit("remove",s,t),!this.mutableOptionsArray.length){this.$nextTick(this.$refs.listbox.focus.bind(this.$refs.listbox));return}this.lastFocusedOptionIndex>this.mutableOptionsArray.length-1&&this.lastFocusedOptionIndex--,this.$nextTick(this.focusLastFocusedOption.bind(this))},left(){this.lastFocusedOptionIndex>0?this.lastFocusedOptionIndex--:this.lastFocusedOptionIndex=this.mutableOptionsArray.length-1,this.focusLastFocusedOption()},right(){this.lastFocusedOptionIndex<this.mutableOptionsArray.length-1?this.lastFocusedOptionIndex++:this.lastFocusedOptionIndex=0,this.focusLastFocusedOption()}}},zF=["aria-label"],UF=["tabindex","onFocus"],VF=["title"];function jF(e,t,s,n,r,a){const o=pe("Icon");return L(),X("div",{class:$t({"slds-pill_container":e.$props.containerBorder,"slds-listbox_selection-group":!e.$props.containerBorder})},[k("ul",{ref:"listbox",class:"slds-listbox slds-listbox_horizontal",role:"listbox","aria-label":s.assistiveText.listboxLabel,"aria-orientation":"horizontal",onKeydown:[t[0]||(t[0]=Zs((...d)=>a.left&&a.left(...d),["left"])),t[1]||(t[1]=Zs((...d)=>a.right&&a.right(...d),["right"])),t[2]||(t[2]=Zs(d=>a.remove(r.lastFocusedOptionIndex,d),["delete"]))]},[(L(!0),X(Lt,null,As(r.mutableOptionsArray,(d,p)=>(L(),X("li",{key:d.$__guid,class:"slds-listbox-item",role:"presentation"},[k("span",{ref_for:!0,ref:`option-${p}`,class:$t(["slds-pill",{"slds-pill_bare":!s.pillBorder,"slds-has-error":d.hasError}]),role:"option",tabindex:r.lastFocusedOptionIndex===p?0:-1,"aria-selected":"true",onFocus:y=>r.lastFocusedOptionIndex=p},[d.hasError?(L(),Ge(o,{key:0,class:"slds-pill__icon_container",category:"utility",name:"error",variant:"error",assistiveText:s.assistiveText.error,title:s.labels.error},null,8,["assistiveText","title"])):$e("",!0),k("span",{class:"slds-pill__label",title:d.title},Pe(e.decodeHtml(d.label)),9,VF),s.readonly?$e("",!0):(L(),Ge(o,{key:1,class:"slds-pill__remove cursor-pointer",category:"utility",name:"close",size:"x-small",assistiveText:s.assistiveText.remove,onMousedown:Os(y=>a.remove(p,y),["prevent"])},null,8,["assistiveText","onMousedown"]))],42,UF)]))),128))],40,zF)],2)}const Ek=os(FF,[["render",jF],["__scopeId","data-v-e31e462f"]]),ZT=function(t){t?Array.isArray(this.$props.modelValue)?this.mutableValueArray=[].concat(...this.$props.modelValue):(this.mutableValueArray=this.$props.modelValue?[this.$props.modelValue]:[],this.$emit("update:modelValue",this.mutableValueArray)):this.$emit("update:modelValue",this.mutableValueArray.length===1?this.mutableValueArray[0]:"")},qF=()=>({name:null,search:"Search...",noSearchResults:"No search results.",clearTitle:"Clear the text input",clearAssistiveText:"Clear the text input",removeTitle:"Remove",removeAssistiveText:"Remove",comboboxAdd:"Add",comboboxSearchAssistiveText:"Search for term",save:"Save",required:"Required",loading:"Loading",cancel:"Cancel",placeholder:"Select an Option"}),HF={name:"Picklist",components:{ButtonIcon:vn,Dropdown:kF,Icon:yn,MultiselectDialog:BF,PillList:Ek,Spinner:Vr,Tooltip:Fo},directives:{"click-outside":XB.directive,"detach-element":pk},mixins:[Xo],props:{asyncDelay:{type:Number,default:500},combobox:Boolean,detach:{type:Boolean,default:!0},disabled:Boolean,errors:{type:Array,default:()=>[]},filterable:Boolean,heightInNumOptions:{type:[Number,1/0],default:5},helpText:{type:String,default:""},idKey:{type:String,default:"id"},labelForId:{type:String,default:""},labels:{type:Object,default:()=>{}},minSearchLength:{type:Number,default:2},modelValue:{type:[Number,String,Array,Symbol],default:""},multiselect:Boolean,multiselectDialog:Boolean,onRequestSelectOption:{type:Function,default:null},options:{type:Array,required:!0,validator(e){let t=!1;for(let s=0;s<e.length;s++){const n=e[s];if(Object.hasOwnProperty.call(n,"options")&&!Object.hasOwnProperty.call(n,"title")){if(t)return console.error("Cannot have more than one group without a title."),!1;t=!0}}return!0}},pageSize:{type:Number,default:50},readonly:Boolean,remainOpenOnSelect:Boolean,required:Boolean,resizeToFitContent:Boolean,titleKey:{type:String,default:"title"}},emits:["clear","detached","reset","selected-option","update:modelValue"],data(){return{isActive:!1,doRenderDropdown:!1,dropdownId:Vn(),errorId:Vn(),focusedOptionId:null,input:"",cachedInput:"",labelId:Vn(),inputId:Vn(),mutableValueArray:[],comboboxInputOption:null,multiselectOptions:[],groupData:{groups:{},numAsyncGroups:0,hasStaticOptions:!1}}},computed:{computedLabels(){const e=Object.hasOwn(this,"$__getGlobalLabels")?this.$__getGlobalLabels().picklist||{}:{};return{...qF(),...e,...this.$props.labels}},clickOutsideOptions(){return{isActive:this.doRenderDropdown,handler:this.clickedOutside}},showSearchIcon(){return this.$props.filterable&&(this.$props.multiselect||!this.hasValue)},hasAutocompletedValue(){return this.hasValue&&this.singleSelect&&this.$props.filterable},showDownIcon(){return!this.$props.filterable},isReadOnly(){return this.hasAutocompletedValue||!this.$props.filterable&&!this.$props.combobox},readonlyValue(){if(this.singleSelect){const e=this.getOptionById(this.$props.modelValue);return e?this.getTitle(e):null}return null},singleSelect(){return!this.$props.multiselect},hasValue(){return this.$props.multiselect?(this.$props.modelValue||[]).length>0:!!this.$props.modelValue},hasErrors(){return this.$props.errors.length},computedPlaceholder(){return this.isLoading?this.computedLabels.loading:this.isReadOnly||this.$props.combobox&&!this.$props.filterable?this.computedLabels.placeholder:this.computedLabels.search},doRenderPillList(){return this.$props.readonly&&this.multiselectOptions.length||this.$props.multiselect&&!this.$props.multiselectDialog&&(this.multiselectOptions.length>1||(this.$props.filterable||this.$props.combobox)&&this.multiselectOptions.length)},isLoading(){return Object.values(this.groupData.groups).some(e=>e.loading)},computedDoRenderDropdown(){return!this.$props.multiselectDialog&&this.doRenderDropdown||this.groupData.numAsyncGroups>1&&this.isLoading}},watch:{modelValue:{handler(e){(e===null||Array.isArray(e))&&(this.mutableValueArray=[].concat(...e||[])),this.setMultiselectOptions(),this.setInput()},immediate:!0},multiselect:ZT,multiselectDialog:ZT,$props:{handler(){if(this.$props.multiselectDialog&&(this.$props.filterable||this.$props.combobox||this.$props.multiselect))throw new Error("Cannot combine multiselectDialog with other features.");this.$props.labels&&(!this.$props.labels.name||!this.$props.labels.name.length)&&(!this.$props.labelForId||!this.$props.labelForId.length)&&console.error("Must provide label for name or pass value to labelForId prop"),this.$props.remainOpenOnSelect&&!this.$props.multiselect&&console.error("Must enable multiselect to use remainOpenOnSelect prop")},deep:!0,immediate:!0},focusedOptionId(e){e&&!this.$props.filterable&&!this.$props.combobox&&this.singleSelect&&(this.input=this.getTitleById(e))},options:{handler(){this.groupData=YT.call(this),this.reconcileOptions()},deep:!0},asyncDelay(e){Object.values(this.groupData.groups).forEach(t=>{t.async&&(t.debounce=Tk(t.optionsFunction,e))})}},created(){this.validateValueBindingType(),this.groupData=YT.call(this)},methods:{focus(){this.$refs.input.focus()},reconcileOptions(){if(!(this.$props.combobox||!this.hasValue))if(this.$props.multiselect||this.$props.multiselectDialog){const e=this.mutableValueArray.length;this.mutableValueArray=this.mutableValueArray.filter(t=>this.getOptionById(t)),e!==this.mutableValueArray.length&&this.$emit("update:modelValue",this.mutableValueArray)}else this.getOptionById(this.$props.modelValue)?this.setInput():this.$emit("update:modelValue","")},clear(){this.input="",this.$emit("update:modelValue",this.input),this.$emit("clear"),this.$nextTick(this.activationHandler),this.$nextTick(()=>{this.$refs.input.focus()})},setMultiselectOptions(){this.multiselectOptions=this.mutableValueArray.map(e=>{const t=this.getOptionById(e),s=t?this.getTitle(t):e;return{[this.$props.idKey]:e,label:s,title:s}})},setInput(){if((this.$props.multiselect||this.$props.multiselectDialog)&&!this.$props.filterable){if(this.$props.combobox){this.input=null;return}this.mutableValueArray.length>1?this.input=`${this.mutableValueArray.length} options selected`:this.input=this.getTitleById(this.mutableValueArray[0])}else this.$props.modelValue?this.input=this.getTitleById(this.$props.modelValue):this.input=null;this.cachedInput=this.input},validateValueBindingType(){if(this.$props.modelValue!==null){if(this.$props.multiselect||this.$props.multiselectDialog){if(!Array.isArray(this.$props.modelValue))throw new Error("Value binding type must be in array in multi-select mode.")}else if(!["string","number","symbol"].includes(typeof this.$props.modelValue))throw new Error("Value binding type must be a Number, String, or Symbol in single-select mode.")}},onBlur(e){e.relatedTarget&&this.doRenderDropdown&&!this.$props.multiselectDialog&&(this.reset(e),this.$emit("reset"))},onClick(){this.doRenderDropdown||this.activationHandler()},onDetachRender(){this.$props.multiselectDialog||this.$refs.dropdown.setDropdownHeight()},enter(e){e.isComposing||e.keyCode===229||this.$props.multiselectDialog&&this.doRenderDropdown||(this.doRenderDropdown?this.$refs.dropdown.enter(e):this.activationHandler())},up(){!this.$props.multiselectDialog&&this.doRenderDropdown&&this.$refs.dropdown.up()},down(){this.$props.multiselectDialog&&this.doRenderDropdown||(this.doRenderDropdown?this.$refs.dropdown.down():this.activationHandler())},activationHandler(){this.hasAutocompletedValue||this.isLoading||(this.groupData.hasStaticOptions?this.doRenderDropdown=!0:this.$props.combobox&&this.input?(this.doRenderDropdown=!0,this.updateComboboxInputOption()):this.doRenderDropdown=!1,this.search())},clickedOutside(e){e&&e.type==="click"&&e.target===this.$refs.input||(this.reset(e),this.$emit("reset"))},escape(e){this.reset(e),this.$emit("reset")},reset(e){e&&e.type==="click"&&e.target===this.$refs.input||(this.input=this.cachedInput,Object.values(this.groupData.groups).forEach(t=>{t.filtered=[],t.searchIndex++,t.loading=!1}),this.comboboxInputOption=null,this.focusedOptionId=null,this.doRenderDropdown=!1)},getIdType(e){return typeof this.getId(e)},getId(e){return!e||["string","number","symbol"].includes(typeof e)?e:e[this.$props.idKey]},getIdAsString(e){return typeof e=="symbol"?e.description:e},getTitle(e){return["string","number"].includes(typeof e)?e.toString():typeof e=="symbol"?e.description:e[this.$props.titleKey]},getTitleById(e){return this.getTitle(this.getOptionById(e)||e||"")},getOptionById(e){if(!e)return null;for(let s=0;s<this.$props.options.length;s++){const n=this.$props.options[s];if(Array.isArray(n.options)){const r=n.options.find(a=>this.getId(a)===e);if(r)return r}if(typeof n=="object"&&this.getId(n)===e||["string","number","symbol"].includes(typeof n)&&n===e)return n}const t=Object.values(this.groupData.groups);for(let s=0;s<t.length;s++){const n=t[s].filtered.find(r=>this.getId(r)===e);if(n)return n}return null},search(){if(this.hasAutocompletedValue)return;const e=(this.input||"").replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),t=new RegExp(e,"i"),s=!e||!this.$props.filterable||!this.$props.filterable&&this.$props.combobox;Object.entries(this.groupData.groups).forEach(([,n])=>{n.filtered=[],n.static?s||this.groupData.numAsyncGroups?n.filtered=n.options:n.options.forEach(r=>{t.test(this.getTitle(r))&&n.filtered.push(r)}):n.async&&(this.$props.filterable?(n.lazy||e.length>=this.$props.minSearchLength)&&n.debounce(e):n.optionsFunction(e))})},invokeOptionsFunction(e,t,s){const n=this.groupData.groups[t];n.loading=!0;const r=++n.searchIndex;e.call(e,s).then((a=[])=>{if(r<n.searchIndex)return;const o=[];a.forEach(d=>{typeof d=="object"?o.push({$__guid:Vn(),...d}):["string","number"].includes(typeof d)&&o.push({$__guid:Vn(),[this.idKey]:d,[this.titleKey]:d.toString()})}),n.filtered=n.filtered.concat(o),(n.lazy||!this.$props.filterable)&&(n.options=n.filtered,n.static=!0,n.async=!1,this.groupData.hasStaticOptions=!0,this.groupData.numAsyncGroups--),this.doRenderDropdown=!0,this.multiselectDialog||this.$nextTick(()=>{n.loading=!1})}).catch(a=>{throw new Error(a)})},isOptionSelected(e){const t=this.getId(e);return this.$props.modelValue===t||(this.$props.multiselect||this.$props.multiselectDialog)&&this.mutableValueArray.includes(t)},onInput(){this.activationHandler(),this.updateComboboxInputOption()},updateComboboxInputOption(){!this.combobox||(this.input?this.comboboxInputOption={[this.$props.idKey]:this.input,[this.$props.titleKey]:this.input}:this.comboboxInputOption=null)},select(e,t){if(this.onRequestSelectOption&&typeof this.onRequestSelectOption=="function"&&!this.onRequestSelectOption(e,t))return;const s=this.getId(e);this.singleSelect?this.$emit("update:modelValue",s):this.isOptionSelected(e)?this.$emit("update:modelValue",this.mutableValueArray.filter(r=>this.getId(r)!==s)):(this.mutableValueArray.push(s),this.$emit("update:modelValue",this.mutableValueArray));const n={...e};delete n.$__guid,this.$emit("selected-option",n,t),!this.$props.multiselectDialog&&!this.$props.remainOpenOnSelect&&this.$nextTick(()=>{this.reset(),this.$nextTick(()=>{this.$refs.input.focus()})})},removePillListOptionHandler(e,t){this.select(e,t)}}},GF=["id","for"],WF=["title"],YF={class:"slds-form-element__control"},ZF=["aria-expanded"],XF={class:"slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right",role:"none"},KF=["id","disabled","aria-labelledby","aria-controls"],JF={class:"slds-truncate"},QF=["id","aria-controls","aria-activedescendant","aria-invalid","aria-describedby","placeholder","readonly","disabled"],e6={key:1,class:"readonly-select-label"},t6=["id"];function s6(e,t,s,n,r,a){const o=pe("Tooltip"),d=pe("ButtonIcon"),p=pe("Spinner"),y=pe("Icon"),v=pe("Dropdown"),C=pe("MultiselectDialog"),I=pe("PillList"),O=mg("click-outside"),A=mg("detach-element");return L(),X("div",{class:$t(["slds-form-element",{"slds-has-error":a.hasErrors}])},[a.computedLabels.name?(L(),X("label",{key:0,id:r.labelId,class:"slds-form-element__label",for:r.inputId},[s.required?(L(),X("abbr",{key:0,class:"slds-required",title:a.computedLabels.required},"* ",8,WF)):$e("",!0),es(Pe(e.decodeHtml(a.computedLabels.name)),1)],8,GF)):$e("",!0),e.$props.helpText?(L(),Ge(o,{key:1,alignment:"top right",class:"slds-form-element__icon",text:e.$props.helpText},null,8,["text"])):$e("",!0),k("div",YF,[k("div",{class:$t(["slds-combobox_container",{"slds-has-selection":a.hasAutocompletedValue}])},[k("div",{class:$t(["slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click",{"slds-is-open":a.computedDoRenderDropdown}]),"aria-expanded":`${a.computedDoRenderDropdown}`,"aria-haspopup":"listbox",role:"combobox"},[k("div",XF,[e.$props.readonly?(L(),X("div",e6,Pe(a.readonlyValue),1)):(L(),X(Lt,{key:0},[a.hasAutocompletedValue?(L(),X("button",{key:0,id:r.inputId,ref:"input",disabled:e.$props.disabled,type:"button",class:"slds-input_faux slds-combobox__input slds-combobox__input-value","aria-labelledby":[r.labelId,r.inputId].join(" "),"aria-controls":r.dropdownId,"aria-expanded":"false","aria-haspopup":"listbox"},[k("span",JF,Pe(r.input),1)],8,KF)):Mn((L(),X("input",Ji({key:1,id:a.computedLabels.name?r.inputId:s.labelForId,ref:"input","onUpdate:modelValue":t[0]||(t[0]=P=>r.input=P),type:"text",class:["slds-input slds-combobox__input",{"slds-combobox__input-value":a.hasAutocompletedValue}],"aria-autocomplete":"list",autoComplete:"off",role:"textbox","aria-controls":a.computedDoRenderDropdown?r.dropdownId:null,"aria-activedescendant":a.getIdAsString(r.focusedOptionId),"aria-invalid":!!e.$props.errors.length,"aria-describedby":e.$props.errors.length?r.errorId:null,placeholder:a.computedPlaceholder,readonly:a.isReadOnly,disabled:e.$props.disabled},e.$attrs,{onInput:t[1]||(t[1]=(...P)=>a.onInput&&a.onInput(...P)),onClick:t[2]||(t[2]=(...P)=>a.onClick&&a.onClick(...P)),onBlur:t[3]||(t[3]=(...P)=>a.onBlur&&a.onBlur(...P)),onKeydown:[t[4]||(t[4]=Zs(Os((...P)=>a.down&&a.down(...P),["prevent"]),["down"])),t[5]||(t[5]=Zs(Os((...P)=>a.up&&a.up(...P),["prevent"]),["up"])),t[6]||(t[6]=Zs(Os((...P)=>a.enter&&a.enter(...P),["prevent"]),["enter"])),t[7]||(t[7]=Zs(Os((...P)=>a.escape&&a.escape(...P),["stop"]),["esc"]))]}),null,16,QF)),[[Tp,r.input]]),!e.$props.disabled&&a.hasAutocompletedValue?(L(),Ge(d,{key:2,class:"slds-input__icon",iconCategory:"utility",iconName:"clear",assistiveText:a.computedLabels.clearAssistiveText,title:a.computedLabels.clearTitle,onClick:a.clear},null,8,["assistiveText","title","onClick"])):a.isLoading?(L(),Ge(p,{key:3,class:"slds-input__icon",size:"x-small",theme:"brand",loadingLabel:a.computedLabels.loading,withoutContainer:""},null,8,["loadingLabel"])):js(e.$slots,"icon",{key:4},()=>[a.showSearchIcon?(L(),Ge(y,{key:0,class:"slds-input__icon",category:"utility",name:"search",size:"x-small"})):a.showDownIcon&&!a.isLoading?(L(),Ge(y,{key:1,class:"slds-input__icon",category:"utility",name:"down",size:"x-small"})):$e("",!0)],!0)],64))]),a.computedDoRenderDropdown?Mn((L(),Ge(v,{key:0,ref:"dropdown"},{option:je(({option:P,index:q})=>[js(e.$slots,"option",{option:P,index:q},void 0,!0)]),dropdownHeader:je(()=>[js(e.$slots,"dropdownHeader",{},void 0,!0)]),_:3})),[[O,a.clickOutsideOptions],[A,{disabled:!s.detach,anchorRef:e.$refs.input,viewPortOverflow:!0,anchorTopOnVerticalOverflow:!0,onRender:a.onDetachRender,resizeToAnchor:!e.$props.resizeToFitContent,resizeToFitContent:e.$props.resizeToFitContent,alignment:"left",scrollHandler:a.reset}]]):$e("",!0),e.$props.multiselectDialog&&r.doRenderDropdown?Mn((L(),Ge(C,{key:1,ref:"dropdown"},null,512)),[[A,{disabled:!s.detach,anchorRef:e.$refs.input,viewPortOverflow:!0,anchorTopOnVerticalOverflow:!0,onRender:a.onDetachRender,resizeToAnchor:!e.$props.resizeToFitContent,resizeToFitContent:e.$props.resizeToFitContent,alignment:"left",scrollHandler:a.reset}]]):$e("",!0)],10,ZF)],2),a.doRenderPillList?(L(),Ge(I,{key:0,readonly:e.$props.readonly,options:r.multiselectOptions,onRemove:a.removePillListOptionHandler},null,8,["readonly","options","onRemove"])):$e("",!0)]),js(e.$slots,"footer",{},void 0,!0),e.$props.errors.length?(L(),X("div",{key:2,id:r.errorId,class:"slds-form-element__help"},[(L(!0),X(Lt,null,As(s.errors,(P,q)=>(L(),X("p",{key:q},Pe(e.decodeHtml(P)),1))),128))],8,t6)):$e("",!0)],2)}const Qi=os(HF,[["render",s6],["__scopeId","data-v-3db3f0d2"]]),n6=()=>({name:null,placeholder:null,required:"Required"}),r6={name:"TextInput",components:{Tooltip:Fo},mixins:[Xo],props:{disabled:Boolean,disableResize:Boolean,errors:{type:Array,default:()=>[]},fixedTextLeft:{type:String,default:""},fixedTextRight:{type:String,default:""},hasFocus:Boolean,helpText:{type:String,default:""},labels:{type:Object,default:()=>{}},modelValue:{type:[String,Number],default:null},readonly:Boolean,required:Boolean,type:{type:String,default:"text"},useTextArea:Boolean},data(){return{errorId:Vn(),inputId:Vn(),labelId:Vn()}},computed:{computedLabels(){const e=Object.hasOwn(this,"$__getGlobalLabels")?this.$__getGlobalLabels().textInput||{}:{};return{...n6(),...e,...this.$props.labels}},hasErrors(){return this.$props.errors.length},hasFixedAddon(){return this.$props.fixedTextLeft||this.$props.fixedTextRight},fixedAddonIds(){if(!this.hasFixedAddon)return null;let e=this.labelId;return this.$props.fixedTextLeft&&(e+=" fixed-text-addon-pre"),this.$props.fixedTextRight&&(e+=" fixed-text-addon-post"),e}},watch:{"$props.hasFocus":{handler(e){e&&this.focus()}}},mounted(){this.$props.hasFocus&&this.focus()},methods:{focus(){this.$refs.input.focus(),this.$refs.input.select()},onInput(e){this.$emit("update:modelValue",e.target.value)}}},i6=["id","for"],o6=["title"],a6={key:0,id:"fixed-text-addon-pre",class:"slds-form-element__addon"},l6=["id","disabled","value","placeholder","readonly","aria-labelledby","aria-invalid","aria-describedby"],c6=["id","type","disabled","readonly","placeholder","value","aria-labelledby","aria-invalid","aria-describedby"],u6={key:3,id:"fixed-text-addon-post",class:"slds-form-element__addon"},d6=["id"];function h6(e,t,s,n,r,a){const o=pe("Tooltip");return L(),X("div",{class:$t([{"slds-has-error":a.hasErrors},"slds-form-element"])},[a.computedLabels.name?(L(),X("label",{key:0,id:r.labelId,for:r.inputId,class:"slds-form-element__label"},[e.$props.required?(L(),X("abbr",{key:0,class:"slds-required",title:a.computedLabels.required},"*",8,o6)):$e("",!0),es(" "+Pe(e.decodeHtml(a.computedLabels.name)),1)],8,i6)):$e("",!0),e.$props.helpText?(L(),Ge(o,{key:1,class:"slds-form-element__icon",alignment:"top right",text:e.$props.helpText},null,8,["text"])):$e("",!0),k("div",{class:$t(["slds-form-element__control",{"slds-input-has-fixed-addon":a.hasFixedAddon}])},[e.$props.fixedTextLeft?(L(),X("span",a6,Pe(e.$props.fixedTextLeft),1)):$e("",!0),e.$props.useTextArea?(L(),X("textarea",Ji({key:1,id:r.inputId,ref:"input",disabled:e.$props.disabled,value:e.$props.modelValue,placeholder:a.computedLabels.placeholder,readonly:e.$props.readonly,"aria-labelledby":a.fixedAddonIds,"aria-invalid":!!e.$props.errors.length,"aria-describedby":e.$props.errors.length?r.errorId:null,class:[{"disable-resize":e.$props.disableResize},"slds-textarea"]},id(e.$attrs,!0),{onInput:t[0]||(t[0]=(...d)=>a.onInput&&a.onInput(...d)),onBlur:t[1]||(t[1]=d=>e.$emit("update:hasFocus",!1))}),null,16,l6)):(L(),X("input",Ji({key:2,id:r.inputId,ref:"input",type:e.$props.type,disabled:e.$props.disabled,readonly:e.$props.readonly,placeholder:a.computedLabels.placeholder,value:e.$props.modelValue,"aria-labelledby":a.fixedAddonIds,"aria-invalid":!!e.$props.errors.length,"aria-describedby":e.$props.errors.length?r.errorId:null,class:"slds-input"},id(e.$attrs,!0),{onInput:t[2]||(t[2]=(...d)=>a.onInput&&a.onInput(...d)),onBlur:t[3]||(t[3]=d=>e.$emit("update:hasFocus",!1))}),null,16,c6)),e.$props.fixedTextRight?(L(),X("span",u6,Pe(e.$props.fixedTextRight),1)):$e("",!0),js(e.$slots,"extend",{},void 0,!0)],2),e.$props.errors.length?(L(),X("div",{key:2,id:r.errorId,class:"slds-form-element__help"},[(L(!0),X(Lt,null,As(s.errors,(d,p)=>(L(),X("p",{key:p},Pe(e.decodeHtml(d)),1))),128))],8,d6)):$e("",!0)],2)}const Ko=os(r6,[["render",h6],["__scopeId","data-v-7b6f943d"]]),XT=()=>({id:Vn(),resource:"",operator:"",value:""}),p6=()=>({deleteCondition:"Delete Condition",resource:"Resource",operator:"Operator",value:"Value",parent:"Parent",grandparent:"Grandparent",magnus:"Great"}),KT=()=>({title:"Condition",deleteIcon:"Delete Condition"}),f6={name:"ExpressionCondition",components:{ButtonIcon:vn,ConditionalWrapper:Ik,Picklist:Qi,TextInput:Ko},props:{ancestral:Boolean,assistiveText:{type:Object,default:()=>KT()},id:{type:[String,Number],required:!0},labels:{type:Object,default:()=>{}},operator:{type:[String,Number,Symbol],default:""},operatorErrors:{type:Array,default:()=>[]},operators:{type:Array,default:()=>[]},resource:{type:[String,Number,Symbol,Array],default:""},resourceErrors:{type:Array,default:()=>[]},resources:{type:Array,default:()=>[]},resourceIdKey:{type:String,default:"id"},resourceTitleKey:{type:String,default:"title"},skipRegistration:Boolean,value:{type:[String,Number,Symbol],default:""}},data(){return{index:0,gutterLabel:null,gutterVisibile:!0,numSiblings:0,localResources:[]}},computed:{computedLabels(){const e=Object.hasOwn(this,"$__getGlobalLabels")?this.$__getGlobalLabels().condition||{}:{};return{...p6(),...e,...this.$props.labels}},computedAssistiveText(){return{...KT(),...this.$props.assistiveText}},computedGutterAssistiveText(){return`${this.computedAssistiveText.title} ${this.gutterLabel}`},isSelectedResourceNullOrBlank(){const e=this.resource===null||this.resource==="";let t=!1;if(this.$props.ancestral){const s=this.resource[this.resources.length-1];t=typeof s>"u"||s===""||s===null}return e||t},isDeleteButtonDisabled(){const e=this.isSelectedResourceNullOrBlank&&this.numSiblings===0;let t=!0;return this.$props.ancestral&&(t=this.resource.length===0),e&&t}},watch:{"$props.resources":{handler(){this.localResources=this.$props.resources.map((e,t)=>({id:Vn(),label:this.getResourceOptionsLabel(t,this.$props.resources.length),resources:e})),!this.$parent.$props.disableA11y&&this.$props.ancestral&&this.$nextTick(this.focusResource)},deep:!0,immediate:!0}},created(){this.$props.skipRegistration||this.$parent.registerCondition(this.id,{setGutterVisibility:this.setGutterVisibility.bind(this),setGutterLabel:this.setGutterLabel.bind(this),setIndex:this.setIndex.bind(this),setNumSiblings:this.setNumSiblings.bind(this),focusResource:this.focusResource.bind(this)})},beforeUnmount(){this.$props.skipRegistration||this.$parent.unregisterCondition(this.$props.id)},methods:{setGutterVisibility(e){this.gutterVisibile=e},setGutterLabel(e){this.gutterLabel=e},setIndex(e){this.index=e},setNumSiblings(e){this.numSiblings=e},focusResource(){if(this.$props.ancestral){const{id:e}=this.localResources[this.localResources.length-1];this.$refs[`resource-${e}`].focus()}else this.$refs.resource.focus()},getResourceOptionsLabel(e,t){return t===1||e+1===t?this.computedLabels.resource:e===0?this.computedLabels.parent:e===1?this.computedLabels.grandparent:`${`${this.computedLabels.magnus} `.repeat(e-1)} ${this.computedLabels.grandparent}`},onDeleteRequest(){this.numSiblings===0?this.resetCondition():this.deleteCondition()},async resetCondition(){if(this.onValueInput(""),this.onOperatorChanged(""),this.$props.ancestral){if(this.$emit("update:resource",[]),this.$props.resources.length){const e=[this.$props.resources[0]];this.$emit("update:resources",e)}}else this.onResourceChanged("");await this.$nextTick(this.focusResource),this.$emit("reset-condition",{id:this.$props.id,index:this.index})},deleteCondition(){this.$emit("delete-condition",{id:this.$props.id,index:this.index})},onOperatorChanged(e){this.$emit("update:operator",e),this.$emit("operator-change",{id:this.$props.id,index:this.index,value:e})},onResourceChanged(e){this.$emit("update:resource",e),this.$emit("resource-change",{id:this.$props.id,index:this.index,value:e})},onSelectedResourceOption(e,t=0){let s=[...this.$props.resource];e?s.splice(t,s.length,e[this.$props.resourceIdKey]):s.splice(t,s.length),this.$emit("update:resource",s),t!==this.$props.resources.length-1&&(s=[...this.$props.resources],s.splice(t+1),this.$emit("update:resources",s)),this.$emit("resource-change",{id:this.$props.id,index:this.index,ancestralIndex:t,cleared:e===null,option:e})},onResourceClear(e=0){this.onSelectedResourceOption(null,e)},onValueInput(e){this.$emit("update:value",e),this.$emit("value-change",{id:this.$props.id,index:this.index,value:e})}}},m6={class:"slds-expression__row"},_6={key:0,class:"slds-expression__legend"},g6={class:"slds-assistive-text"},y6={class:"slds-col slds-grow-none",style:{width:"15rem"}},v6={key:0,class:"slds-col slds-grow-none margin-top-auto",style:{"min-width":"15rem"}},b6={class:"slds-col slds-grow-none margin-top-auto"},x6={class:"slds-grid"},w6={class:"slds-col slds-grow-none margin-top-auto"},S6={class:"slds-col slds-grow-none"},C6={class:"slds-form-element"},I6=k("span",{class:"slds-form-element__label"},"\xA0",-1),T6={class:"slds-form-element__control"};function A6(e,t,s,n,r,a){const o=pe("Picklist"),d=pe("TextInput"),p=pe("ButtonIcon"),y=pe("ConditionalWrapper");return L(),X("li",m6,[k("fieldset",null,[r.gutterVisibile?(L(),X("legend",_6,[k("span",null,Pe(r.gutterLabel),1),k("span",g6,Pe(a.computedGutterAssistiveText),1)])):$e("",!0),k("div",{class:$t(["slds-grid slds-gutters_xx-small",{"slds-grid_vertical":e.$props.ancestral}])},[k("div",y6,[e.$props.ancestral&&r.localResources.length>1?(L(!0),X(Lt,{key:0},As(r.localResources.length-1,v=>(L(),Ge(o,{ref_for:!0,ref:`resource-${r.localResources[v-1].id}`,key:r.localResources[v-1].id,errors:s.resourceErrors,idKey:e.$props.resourceIdKey,labels:{name:r.localResources[v-1].label},options:r.localResources[v-1].resources,titleKey:e.$props.resourceTitleKey,modelValue:e.$props.resource[v-1],filterable:"",resizeToFitContent:"",onSelectedOption:C=>a.onSelectedResourceOption(C,v-1),onClear:C=>a.onResourceClear(v-1)},null,8,["errors","idKey","labels","options","titleKey","modelValue","onSelectedOption","onClear"]))),128)):$e("",!0),e.$props.ancestral?$e("",!0):(L(),Ge(o,{key:1,ref:"resource",errors:s.resourceErrors,idKey:e.$props.resourceIdKey,labels:{name:a.computedLabels.resource},options:s.resources,titleKey:e.$props.resourceTitleKey,modelValue:e.$props.resource,filterable:"",resizeToFitContent:"","onUpdate:modelValue":a.onResourceChanged},null,8,["errors","idKey","labels","options","titleKey","modelValue","onUpdate:modelValue"]))]),de(y,{active:e.$props.ancestral,element:"div",class:"slds-grid slds-grid_vertical-align-start"},{default:je(()=>[e.$props.ancestral?(L(),X("div",v6,[de(o,{ref:`resource-${r.localResources[r.localResources.length-1].id}`,errors:s.resourceErrors,idKey:e.$props.resourceIdKey,labels:{name:r.localResources[r.localResources.length-1].label},options:r.localResources[r.localResources.length-1].resources,titleKey:e.$props.resourceTitleKey,modelValue:e.$props.resource[r.localResources.length-1],filterable:"",resizeToFitContent:"",onSelectedOption:t[0]||(t[0]=v=>a.onSelectedResourceOption(v,r.localResources.length-1)),onClear:t[1]||(t[1]=v=>a.onResourceClear(r.localResources.length-1))},null,8,["errors","idKey","labels","options","titleKey","modelValue"])])):$e("",!0),k("div",b6,[de(o,{disabled:a.isSelectedResourceNullOrBlank,errors:s.operatorErrors,labels:{name:a.computedLabels.operator},options:s.operators,modelValue:e.$props.operator,resizeToFitContent:"","onUpdate:modelValue":a.onOperatorChanged},null,8,["disabled","errors","labels","options","modelValue","onUpdate:modelValue"])]),k("div",x6,[js(e.$slots,"value",{},()=>[k("div",w6,[de(d,{disabled:a.isSelectedResourceNullOrBlank,labels:{name:a.computedLabels.value},modelValue:e.$props.value,required:"","onUpdate:modelValue":a.onValueInput},null,8,["disabled","labels","modelValue","onUpdate:modelValue"])])]),js(e.$slots,"extension"),k("div",S6,[k("div",C6,[I6,k("div",T6,[de(p,{iconCategory:"utility",iconName:"delete",variant:"border-filled",assistiveText:a.computedAssistiveText.deleteIcon,disabled:a.isDeleteButtonDisabled,title:a.computedLabels.deleteCondition,onClick:a.onDeleteRequest},null,8,["assistiveText","disabled","title","onClick"])])])])])]),_:3},8,["active"])],2)])])}const M6=os(f6,[["render",A6]]);var kk={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(Qu,()=>(()=>{var s={887:o=>{o.exports=function(p){for(var y=5381,v=p.length;v;)y=33*y^p.charCodeAt(--v);return y>>>0}}},n={};function r(o){var d=n[o];if(d!==void 0)return d.exports;var p=n[o]={exports:{}};return s[o](p,p.exports,r),p.exports}r.n=o=>{var d=o&&o.__esModule?()=>o.default:()=>o;return r.d(d,{a:d}),d},r.d=(o,d)=>{for(var p in d)r.o(d,p)&&!r.o(o,p)&&Object.defineProperty(o,p,{enumerable:!0,get:d[p]})},r.o=(o,d)=>Object.prototype.hasOwnProperty.call(o,d),r.r=o=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})};var a={};return(()=>{r.r(a),r.d(a,{default:()=>q});var o=r(887),d=r.n(o);function p(ce){return p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(re){return typeof re}:function(re){return re&&typeof Symbol=="function"&&re.constructor===Symbol&&re!==Symbol.prototype?"symbol":typeof re},p(ce)}function y(ce,re){for(var W=0;W<re.length;W++){var Ce=re[W];Ce.enumerable=Ce.enumerable||!1,Ce.configurable=!0,"value"in Ce&&(Ce.writable=!0),Object.defineProperty(ce,O(Ce.key),Ce)}}function v(ce,re,W){return re&&y(ce.prototype,re),W&&y(ce,W),Object.defineProperty(ce,"prototype",{writable:!1}),ce}function C(ce,re){if(!(ce instanceof re))throw new TypeError("Cannot call a class as a function")}function I(ce,re,W){return(re=O(re))in ce?Object.defineProperty(ce,re,{value:W,enumerable:!0,configurable:!0,writable:!0}):ce[re]=W,ce}function O(ce){var re=function(Ce,te){if(p(Ce)!=="object"||Ce===null)return Ce;var oe=Ce[Symbol.toPrimitive];if(oe!==void 0){var ve=oe.call(Ce,te||"default");if(p(ve)!=="object")return ve;throw new TypeError("@@toPrimitive must return a primitive value.")}return(te==="string"?String:Number)(Ce)}(ce,"string");return p(re)==="symbol"?re:String(re)}var A,P=(A=0,function(){return A++}),q=v(function ce(re){var W=this,Ce=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};C(this,ce),I(this,"ID","id"),I(this,"PX","px"),I(this,"RESIZABLE","grip-resizable"),I(this,"FLEX","grip-flex"),I(this,"legacyIE",navigator.userAgent.indexOf("Trident/4.0")>0),I(this,"reset",function(te){return W.init(te)}),I(this,"onResize",function(){var te=W.tb;if(te.classList.remove(W.RESIZABLE),te.opt.fixed){te.tableWidth=Number(window.getComputedStyle(te).width.replace(/px/,"")).valueOf();for(var oe=0,ve=0;ve<te.columnCnt;ve++)oe+=te.columns[ve].w;for(var ee=0;ee<te.columnCnt;ee++)te.columns[ee].style.width=Math.round(1e3*te.columns[ee].w/oe)/10+"%",te.columns[ee].locked=!0,te.opt.currentWidths[ee]=Number(window.getComputedStyle(te.columns[ee]).width.replace(/px/,"")).valueOf()}else W.applyBounds(),te.opt.resizeMode==="flex"&&te.opt.serialize&&W.serializeStore();te.classList.add(W.RESIZABLE),W.syncGrips()}),I(this,"onGripMouseDown",function(te){var oe=te.target.parentNode.data,ve=W.tb,ee=ve.grips[oe.i],ne=te.touches;if(ee.ox=ne?ne[0].pageX:te.pageX,ee.l=ee.offsetLeft,ee.x=ee.l,W.createStyle(document.querySelector("head"),"*{cursor:"+ve.opt.dragCursor+"!important}"),document.addEventListener("touchmove",W.onGripDrag),document.addEventListener("mousemove",W.onGripDrag),document.addEventListener("touchend",W.onGripDragOver),document.addEventListener("mouseup",W.onGripDragOver),ee.classList.add(ve.opt.draggingClass),W.grip=ee,ve.columns[oe.i].locked)for(var Se,Ue=0;Ue<ve.columnCnt;Ue++)(Se=ve.columns[Ue]).locked=!1,Se.w=Number(window.getComputedStyle(Se).width.replace(/px/,"")).valueOf();te.preventDefault()}),I(this,"onGripDrag",function(te){var oe=W.grip;if(oe){var ve=oe.t,ee=te.touches,ne=(ee?ee[0].pageX:te.pageX)-oe.ox+oe.l,Se=ve.opt.minWidth,Ue=oe.i,Qe=1.5*ve.cellSpace+Se+ve.borderSpace,Me=Ue===ve.columnCnt-1,vt=Ue?ve.grips[Ue-1].offsetLeft+ve.cellSpace+Se:Qe,Ut=ve.opt.fixed?Ue===ve.columnCnt-1?ve.tableWidth-Qe:ve.grips[Ue+1].offsetLeft-ve.cellSpace-Se:1/0;if(ne=Math.max(vt,Math.min(Ut,ne)),oe.x=ne,oe.style.left=ne+W.PX,Me&&(oe.w=ve.columns[Ue].w+ne-oe.l),ve.opt.liveDrag){Me?(ve.columns[Ue].style.width=oe.w+W.PX,!ve.opt.fixed&&ve.opt.overflow?ve.style.minWidth=ve.tableWidth+ne-oe.l+W.PX:ve.tableWidth=Number(window.getComputedStyle(ve).width.replace(/px/,"")).valueOf()):W.syncCols(ve,Ue,!1,ve.opt),W.syncGrips();var Rt=ve.opt.onDrag;Rt&&Rt(te)}te.preventDefault()}}),I(this,"onGripDragOver",function(te){var oe=W.grip;document.removeEventListener("touchend",W.onGripDragOver),document.removeEventListener("mouseup",W.onGripDragOver),document.removeEventListener("touchmove",W.onGripDrag),document.removeEventListener("mousemove",W.onGripDrag);var ve=document.querySelector("head").lastChild;if(ve.parentNode.removeChild(ve),oe){if(oe.classList.remove(oe.t.opt.draggingClass),oe.x-oe.l!=0){var ee=oe.t,ne=ee.opt.onResize,Se=oe.i;if(Se===ee.columnCnt-1){var Ue=ee.columns[Se];Ue.style.width=oe.w+W.PX,Ue.w=oe.w}else W.syncCols(ee,Se,!0,ee.opt);ee.opt.fixed||W.applyBounds(),W.syncGrips(),ne&&ne(te),ee.opt.serialize&&W.serializeStore()}W.grip=null}}),I(this,"init",function(te){if(te.disable)return W.destroy();var oe=W.tb,ve=oe.getAttribute(W.ID)||W.RESIZABLE+P();if(!oe.matches("table")||oe.extended&&!te.partialRefresh)return null;var ee=document.querySelector("head");if(W.createStyle(ee," .grip-resizable{table-layout:fixed;} .grip-resizable > tbody > tr > td, .grip-resizable > tbody > tr > th{overflow:hidden} .grip-padding > tbody > tr > td, .grip-padding > tbody > tr > th{padding-left:0!important; padding-right:0!important;} .grip-container{ height:0px; position:relative;} .grip-handle{margin-left:-5px; position:absolute; z-index:5; } .grip-handle .grip-resizable{position:absolute;background-color:red;filter:alpha(opacity=1);opacity:0;width:10px;height:100%;cursor: col-resize;top:0px} .grip-lastgrip{position:absolute; width:1px; } .grip-drag{ border-left:1px dotted black;	} .grip-flex{width:auto!important;} .grip-handle.grip-disabledgrip .grip-resizable{cursor:default; display:none;}"),te.hoverCursor&&te.hoverCursor!=="col-resize"){var ne=".grip-handle .grip-resizable:hover{cursor:"+te.hoverCursor+"!important}";W.createStyle(ee,ne)}oe.setAttribute(W.ID,ve);var Se=oe.opt;oe.opt=W.extendOptions(te);var Ue=W.getTableHeaders(oe);if(W.extendTable(Ue),te.remoteTable&&te.remoteTable.matches("table")){var Qe=W.getTableHeaders(oe.opt.remoteTable);Ue.length===Qe.length?W.extendRemoteTable(oe.opt.remoteTable,Qe,oe):console.warn("column count for remote table did not match")}return Se}),I(this,"applyBounds",function(){var te=W.tb,oe=te.columns.map(function(ve){return window.getComputedStyle(ve).width});te.style.width=window.getComputedStyle(te).width,te.tableWidth=Number(te.style.width.replace(/px/,"")).valueOf(),te.classList.remove(W.FLEX),te.columns.forEach(function(ve,ee){ve.style.width=oe[ee];var ne=Number(oe[ee].replace(/px/,"")).valueOf();ve.w=ne,te.opt.currentWidths[ee]=ne}),te.classList.add(W.FLEX)}),I(this,"serializeStore",function(){var te=W.store,oe=W.tb;te[oe.getAttribute(W.ID)]="";for(var ve=0,ee=0;ee<oe.columns.length;ee++){var ne=window.getComputedStyle(oe.columns[ee]).width.replace(/px/,"");te[oe.getAttribute(W.ID)]+=ne+";",ve+=Number(ne).valueOf()}te[oe.getAttribute(W.ID)]+=ve.toString(),oe.opt.fixed||(te[oe.getAttribute(W.ID)]+=";"+window.getComputedStyle(oe).width.replace(/px/,""))}),I(this,"syncGrips",function(){var te=W.tb;te.gripContainer.style.width=te.tableWidth+W.PX;for(var oe=0;oe<te.columnCnt;oe++){var ve=te.columns[oe],ee=ve.getBoundingClientRect(),ne=te.getBoundingClientRect();te.grips[oe].style.left=ee.left-ne.left+ve.offsetWidth+te.cellSpace/2+W.PX,te.grips[oe].style.height=(te.opt.headerOnly?te.columns[0].offsetHeight:te.offsetHeight)+W.PX}}),I(this,"destroy",function(){var te=W.tb,oe=te.getAttribute(W.ID);return oe?(W.store[oe]="",te.classList.remove(W.RESIZABLE),te.classList.remove(W.FLEX),te.remote&&(te.remote.classList.remove(W.RESIZABLE),te.remote.classList.remove(W.FLEX)),te.gripContainer&&te.gripContainer.parentNode&&te.gripContainer.parentNode.removeChild(te.gripContainer),delete te.extended,te.opt):null}),I(this,"createStyle",function(te,oe){var ve=d()(oe).toString(),ee=te.querySelectorAll("style"),ne=Array.from(ee).filter(function(Ue){return Ue.gripid===ve});if(!ne.length){var Se=document.createElement("style");Se.type="text/css",Se.gripid=ve,Se.styleSheet?Se.styleSheet.cssText=oe:Se.appendChild(document.createTextNode(oe)),te.appendChild(Se)}}),I(this,"extendOptions",function(te){var oe=Object.assign({},ce.DEFAULTS,te);switch(oe.fixed=!0,oe.overflow=!1,oe.resizeMode){case"flex":oe.fixed=!1;break;case"overflow":oe.fixed=!1,oe.overflow=!0}return oe}),I(this,"getTableHeaders",function(te){var oe="#"+te.id,ve=Array.from(te.querySelectorAll(oe+">thead>tr:nth-of-type(1)>th"));return(ve=ve.concat(Array.from(te.querySelectorAll(oe+">thead>tr:nth-of-type(1)>td")))).length||(ve=(ve=(ve=(ve=Array.from(te.querySelectorAll(oe+">tbody>tr:nth-of-type(1)>th"))).concat(Array.from(te.querySelectorAll(oe+">tr:nth-of-type(1)>th")))).concat(Array.from(te.querySelectorAll(oe+">tbody>tr:nth-of-type(1)>td")))).concat(Array.from(te.querySelectorAll(oe+">tr:nth-of-type(1)>td")))),W.filterInvisible(ve,!1)}),I(this,"filterInvisible",function(te,oe){return te.filter(function(ve){var ee=oe?-1:ve.offsetWidth,ne=oe?-1:ve.offsetHeight;return!(ee===0&&ne===0||ve.style&&ve.style.display&&window.getComputedStyle(ve).display==="none")})}),I(this,"extendTable",function(te){var oe=W.tb;oe.opt.removePadding&&oe.classList.add("grip-padding"),oe.classList.add(W.RESIZABLE),oe.insertAdjacentHTML("beforebegin",'<div class="grip-container"/>'),oe.grips=[],oe.columns=[],oe.tableWidth=Number(window.getComputedStyle(oe).width.replace(/px/,"")).valueOf(),oe.gripContainer=oe.previousElementSibling,oe.opt.marginLeft&&(oe.gripContainer.style.marginLeft=oe.opt.marginLeft),oe.opt.marginRight&&(oe.gripContainer.style.marginRight=oe.opt.marginRight),oe.cellSpace=parseInt(W.legacyIE?oe.cellSpacing||oe.currentStyle.borderSpacing:window.getComputedStyle(oe).borderSpacing.split(" ")[0].replace(/px/,""))||2,oe.borderSpace=parseInt(W.legacyIE?oe.border||oe.currentStyle.borderLeftWidth:window.getComputedStyle(oe).borderLeftWidth.replace(/px/,""))||1,oe.extended=!0,W.createGrips(te)}),I(this,"extendRemoteTable",function(te,oe,ve){ve.opt.removePadding&&te.classList.add("grip-padding"),te.classList.add(W.RESIZABLE),te.getAttribute(W.ID)||te.setAttribute(W.ID,ve.getAttribute(W.ID)+"remote"),te.columns=[],oe.forEach(function(ne,Se){var Ue=oe[Se];Ue.w=ve.columns[Se].w,Ue.style.width=Ue.w+W.PX,Ue.removeAttribute("width"),te.columns.push(Ue)}),te.tableWidth=ve.tableWidth,te.cellSpace=ve.cellSpace,te.borderSpace=ve.borderSpace;var ee=Array.from(te.querySelectorAll("col"));te.columnGrp=W.filterInvisible(ee,!0),te.columnGrp.forEach(function(ne,Se){ne.removeAttribute("width"),ne.style.width=ve.columnGrp[Se].style.width}),ve.remote=te}),I(this,"createGrips",function(te){var oe=W.tb;oe.columnGrp=W.filterInvisible(Array.from(oe.querySelectorAll("col")),!0),oe.columnGrp.forEach(function(ne){ne.removeAttribute("width")}),oe.columnCnt=te.length;var ve=!1;W.store[oe.getAttribute(W.ID)]&&(W.deserializeStore(te),ve=!0),te.forEach(function(ne,Se){var Ue=te[Se],Qe=oe.opt.disabledColumns.indexOf(Se)!==-1;W.createDiv(oe.gripContainer,"grip-handle");var Me=oe.gripContainer.lastChild;!Qe&&oe.opt.gripInnerHtml&&(Me.innerHTML=oe.opt.gripInnerHtml),W.createDiv(Me,W.RESIZABLE),Se===oe.columnCnt-1&&(Me.classList.add("grip-lastgrip"),oe.opt.fixed&&(Me.innerHTML="")),Me.addEventListener("touchstart",W.onGripMouseDown,{capture:!0,passive:!0}),Me.addEventListener("mousedown",W.onGripMouseDown,!0),Qe?Me.classList.add("grip-disabledgrip"):(Me.classList.remove("grip-disabledgrip"),Me.addEventListener("touchstart",W.onGripMouseDown,{capture:!0,passive:!0}),Me.addEventListener("mousedown",W.onGripMouseDown,!0)),Me.t=oe,Me.i=Se,oe.opt.widths[Se]?Ue.w=oe.opt.widths[Se]:Ue.w=ve?Number(Ue.style.width.replace(/px/,"")).valueOf():Number(window.getComputedStyle(Ue).width.replace(/px/,"")).valueOf(),oe.opt.currentWidths[Se]=Ue.w,Ue.style.width=Ue.w+W.PX,Ue.removeAttribute("width"),Me.data={i:Se,t:oe.getAttribute(W.ID),last:Se===oe.columnCnt-1},oe.grips.push(Me),oe.columns.push(Ue)});var ee=Array.from(oe.querySelectorAll("td"));ee.concat(Array.from(oe.querySelectorAll("th"))),(ee=(ee=ee.filter(function(ne){for(var Se=0;Se<te.length;Se++)if(te[Se]===ne)return!1;return!0})).filter(function(ne){return!(ne.querySelectorAll("table th").length||ne.querySelectorAll("table td").length)})).forEach(function(ne){ne.removeAttribute("width")}),oe.opt.fixed||(oe.removeAttribute("width"),oe.classList.add(W.FLEX)),W.syncGrips()}),I(this,"deserializeStore",function(te){var oe=W.tb;if(oe.columnGrp.forEach(function(Se){Se.removeAttribute("width")}),oe.opt.flush)W.store[oe.getAttribute(W.ID)]="";else{var ve=W.store[oe.getAttribute(W.ID)].split(";"),ee=ve[oe.columnCnt+1];!oe.opt.fixed&&ee&&(oe.style.width=ee+W.PX,oe.opt.overflow&&(oe.style.minWidth=ee+W.PX,oe.tableWidth=Number(ee).valueOf()));for(var ne=0;ne<oe.columnCnt;ne++)te[ne].style.width=ve[ne]+W.PX,oe.columnGrp[ne]&&(oe.columnGrp[ne].style.width=100*Number(ve[ne]).valueOf()/Number(ve[oe.columnCnt]).valueOf()+"%")}}),I(this,"createDiv",function(te,oe,ve){var ee=document.createElement("div");ee.classList.add(oe),ve&&(ee.innerHTML=ve),te.appendChild(ee)}),I(this,"syncCols",function(te,oe,ve,ee){var ne=te.remote,Se=W.grip.x-W.grip.l,Ue=te.columns[oe],Qe=te.columns[oe+1];if(Ue&&Qe){var Me=Ue.w+Se,vt=Qe.w-Se,Ut=Me+W.PX;if(Ue.style.width=Ut,te.columnGrp[oe]&&te.columnGrp[oe].style.width&&(te.columnGrp[oe].style.width=Ut),ne&&(ne.columns[oe].style.width=Ut,ne.columnGrp[oe]&&ne.columnGrp[oe].style.width&&(ne.columnGrp[oe].style.width=Ut)),ee.fixed){var Rt=vt+W.PX;Qe.style.width=Rt,te.columnGrp[oe+1]&&te.columnGrp[oe+1].style.width&&(te.columnGrp[oe+1].style.width=Rt),ne&&(ne.columns[oe+1].style.width=Rt,ne.columnGrp[oe+1]&&ne.columnGrp[oe+1].style.width&&(ne.columnGrp[oe+1].style.width=Rt))}else ee.overflow&&(te.style.minWidth=te.tableWidth+Se+W.PX);ve&&(Ue.w=Me,Qe.w=ee.fixed?vt:Qe.w,ne&&(ne.columns[oe].w=Me,ne.columns[oe+1].w=ee.fixed?vt:Qe.w))}});try{this.store=sessionStorage}catch{this.store={}}this.grip=null,this.tb=re,window.addEventListener("resize",this.onResize),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector),this.init(Ce)});q.DEFAULTS={resizeMode:"fit",draggingClass:"grip-drag",gripInnerHtml:"",liveDrag:!1,minWidth:15,headerOnly:!1,hoverCursor:"col-resize",dragCursor:"col-resize",flush:!1,marginLeft:null,marginRight:null,remoteTable:null,disable:!1,partialRefresh:!1,disabledColumns:[],removePadding:!0,widths:[],currentWidths:[],serialize:!0,onDrag:null,onResize:null}})(),a})())})(kk);const Pk=NN(kk.exports),Rk={center:"slds-grid_align-center",space:"slds-grid_align-space",spread:"slds-grid_align-spread",end:"slds-grid_align-end"},$k={start:"slds-grid_vertical-align-start",center:"slds-grid_vertical-align-center",end:"slds-grid_vertical-align-end",stretch:"slds-grid_vertical-stretch"},Ok={small:"slds-grid_pull-padded",medium:"slds-grid_pull-padded-medium",large:"slds-grid_pull-padded-large"},E6=Object.keys($k),k6=Object.keys(Ok),P6=Object.keys(Rk),R6="slds-wrap",$6="slds-grid",O6="slds-grid_vertical",L6="slds-gutters",N6={name:"Layout",props:{gutters:Boolean,horizontalAlign:{type:String,default:null,validator(e){return!e||P6.includes(e)}},multipleRows:Boolean,pullToBoundary:{type:String,default:null,validator(e){return!e||k6.includes(e)}},vertical:Boolean,verticalAlign:{type:String,default:null,validator(e){return!e||E6.includes(e)}}},computed:{computedClasses(){const e=[$6,Rk[this.$props.horizontalAlign],$k[this.$props.verticalAlign],Ok[this.$props.boundary]];return this.$props.multipleRows&&e.push(R6),this.$props.vertical&&e.push(O6),this.$props.gutters&&e.push(L6),e}}};function D6(e,t,s,n,r,a){return L(),X("div",{class:$t(a.computedClasses)},[js(e.$slots,"default",{},void 0,!0)],2)}const xC=os(N6,[["render",D6],["__scopeId","data-v-8aa1ef04"]]),B6=["horizontal-small","horizontal-medium","horizontal-large","around-small","around-medium","around-large"],JT={"slds-p-right_small":"horizontal-small","slds-p-left_small":"horizontal-small","slds-p-right_medium":"horizontal-medium","slds-p-left_medium":"horizontal-medium","slds-p-right_large":"horizontal-large","slds-p-left_large":"horizontal-large","slds-p-around_small":"around-small","slds-p-around_medium":"around-medium","slds-p-around_large":"around-large"},F6=["auto","shrink","no-shrink","grow","no-grow","no-flex"],QT={"slds-col":"auto","slds-grow":"grow","slds-shrink":"shrink","slds-grow-none":"no-grow","slds-shrink-none":"no-shrink","slds-no-flex":"no-flex"},I1=1,T1=12,eA={default:"slds-size_",small:"slds-small-size_",medium:"slds-medium-size_",large:"slds-large-size_"},z6=["left","top","right","bottom"],j_={FLEX_CONFLICT:"You cannot have `flexibility` value to be set to `auto` and `no-flex` together for LayoutItem component",SIZE_RANGE:"Invalid `size` attribute for LayoutItem component. The `size` attribute should be an integer between 1 and 12",SMALL_SIZE_RANGE:"Invalid `smallDeviceSize` attribute for LayoutItem component. The `smallDeviceSize` attribute should be an integer between 1 and 12",MEDIUM_SIZE_RANGE:"Invalid `mediumDeviceSize` attribute for LayoutItem component. The `mediumDeviceSize` attribute should be an integer between 1 and 12",LARGE_SIZE_RANGE:"Invalid `largeDeviceSize` attribute for LayoutItem component. The `largeDeviceSize` attribute should be an integer between 1 and 12",SIZE_REQUIRED:"You cannot have device specific size attributes for LayoutItem component without specifying the `size` attribute"},U6={name:"LayoutItem",props:{flexibility:{type:String,default:"auto",validator(e){const t=e.trim().split(/[,|\s]+/).map(s=>s.trim());if(t.some(s=>s==="auto")&&t.some(s=>s==="no-flex"))throw new Error(j_.FLEX_CONFLICT);return t.every(s=>F6.some(n=>s===n))}},alignmentBump:{type:String,default:null,validator(e){const t=e.trim().split(/[,|\s]+/);if(t.size>1)throw new Error("You cannot have more than one alignment class set.");return t.every(s=>z6.some(n=>s===n))}},padding:{type:String,default:null,validator(e){const t=e.trim().split(/[,|\s]+/);if(t.size>1)throw new Error("You cannot have more than one padding class set.");return t.every(s=>B6.some(n=>s===n))}},size:{type:[Number,String],default:null,validator(e){const t=parseInt(e,10);if(!(I1<=t&&t<=T1))throw new Error(j_.SIZE_RANGE);return!0}},smallDeviceSize:{type:[Number,String],default:null,validator(e){const t=parseInt(e,10);if(!(I1<=t&&t<=T1))throw new Error(j_.SMALL_SIZE_RANGE);return!0}},mediumDeviceSize:{type:[Number,String],default:null,validator(e){const t=parseInt(e,10);if(!(I1<=t&&t<=T1))throw new Error(j_.MEDIUM_SIZE_RANGE);return!0}},largeDeviceSize:{type:[Number,String],default:null,validator(e){const t=parseInt(e,10);if(!(I1<=t&&t<=T1))throw new Error(j_.LARGE_SIZE_RANGE);return!0}}},data(){return{pFlexibility:null,pPadding:null,pAlignmentBump:null}},computed:{computedClasses(){const e=new Set;return this.computeSizeClasses({default:this.$props.size,small:this.$props.smallDeviceSize,medium:this.$props.mediumDeviceSize,large:this.$props.largeDeviceSize},e),this.computePaddingClass(this.$props.padding,e),this.computeFlexibilityClass(this.$props.flexibility,e),this.computeBumpClass(this.$props.alignmentBump,e),Array.from(e)}},watch:{size(){this.validateSizes()},smallDeviceSize(){this.validateSizes()},mediumDeviceSize(){this.validateSizes()},largeDeviceSize(){this.validateSizes()}},created(){this.validateSizes()},methods:{validateSizes(){if(this.$props.size===null&&(this.$props.smallDeviceSize!=null||this.$props.mediumDeviceSize!=null||this.$props.largeDeviceSize!=null))throw new Error(j_.SIZE_REQUIRED)},computeSizeClasses(e,t){Object.keys(eA).forEach(s=>{const n=e[s];n!=null&&n!==0&&t.add(`${eA[s]}${n}-of-12`)})},computeFlexibilityClass(e,t){e!==null&&(e=e.trim().split(/[,|\s]+/).map(s=>s.trim()),Object.keys(QT).forEach(s=>{e.some(n=>n===QT[s])&&t.add(s)}))},computePaddingClass(e,t){e!==null&&Object.keys(JT).forEach(s=>{JT[s].toLowerCase()===e.trim()&&t.add(s)})},computeBumpClass(e,t){e&&t.add(`slds-col_bump-${e}`)}}};function V6(e,t,s,n,r,a){return L(),X("div",{class:$t(a.computedClasses)},[js(e.$slots,"default")],2)}const wC=os(U6,[["render",V6]]),j6={name:"DataTableRow",components:{ActionMenu:wa,ActionMenuItem:Sa,Badge:lx,ButtonIcon:vn,Checkbox:za,ConditionalWrapper:Ik,Icon:yn},inject:["rootProps","selectAllId","rootEmit"],props:["childIndex","depth","parentRef","row"],data(){return{indexOfColumnBeingEdited:null}},methods:{handleAnchorClick(e,t){typeof e.onClick=="function"&&(t.preventDefault(),e.onClick(e,t))},handleRowToggleClick(){this.$props.row.expanded=!this.$props.row.expanded},handleCellEdit(e,t){this.indexOfColumnBeingEdited=t;const s=e.path.find(n=>["td","th"].includes(n.localName)&&n.className.includes("slds-cell-edit"));this.$nextTick(()=>s.querySelector("input").focus())},handleRowAction(e){this.rootEmit("row-action",{action:e,...this.$props})},updateCellValue(e){const t=e.path[0].value;this.$props.row.data[this.indexOfColumnBeingEdited].value=t,this.rootEmit("update-cell",{value:t,row:this.$props.row,columnIndex:this.indexOfColumnBeingEdited}),this.$nextTick(()=>{this.$props.row.data[this.indexOfColumnBeingEdited].error||(this.indexOfColumnBeingEdited=null)})},resetEditMode(){this.indexOfColumnBeingEdited=null}}},q6=["aria-selected","aria-level"],H6={key:0,class:"slds-text-align_right slds-cell_action-mode",role:"gridcell"},G6=["title"],W6={key:0,"aria-describedby":"dialog-body-id-1",class:"slds-popover slds-popover slds-popover_edit",role:"dialog",style:{position:"absolute",top:"0px",left:"0.0625rem"}},Y6={id:"dialog-body-id-1",class:"slds-popover__body"},Z6={class:"slds-media"},X6={class:"slds-media__body"},K6=["for"],J6={class:"slds-assistive-text"},Q6={class:"slds-form-element__control slds-grow"},ez=["id","value"],tz={key:0,class:"slds-form-element__help"},sz={key:1,class:"slds-cell_action-mode",role:"gridcell"};function nz(e,t,s,n,r,a){var O;const o=pe("Checkbox"),d=pe("ButtonIcon"),p=pe("Badge"),y=pe("Icon"),v=pe("ConditionalWrapper"),C=pe("ActionMenuItem"),I=pe("ActionMenu");return L(),X("tr",{ref:"row",key:e.$props.row.id,"aria-selected":a.rootProps.multiselectable?e.$props.row.selected||"false":null,"aria-level":e.$props.depth?e.$props.depth:null,class:$t([{"slds-is-selected":e.$props.row.selected},"slds-hint-parent"])},[a.rootProps.multiselectable?(L(),X("td",H6,[de(o,{modelValue:e.$props.row.selected,"onUpdate:modelValue":t[0]||(t[0]=A=>e.$props.row.selected=A),ariaLabeledBy:a.selectAllId,labels:{name:`Select item ${e.$props.childIndex+1}`},hideLabel:"",onInput:t[1]||(t[1]=A=>a.rootEmit("select-row",{id:e.$props.row.id,row:e.$props.row,selected:e.$props.row.selected}))},null,8,["modelValue","ariaLabeledBy","labels"])])):$e("",!0),(L(!0),X(Lt,null,As(e.$props.row.data,(A,P)=>{var q,ce;return L(),Ge(pE(P===0?"th":"td"),{key:`'Root' + ${P}`,"data-label":a.rootProps.columns[P].name,class:$t([`slds-text-align_${((q=a.rootProps.columns[P])==null?void 0:q.alignment)||"left"}`,{"slds-tree__item":P===0&&a.rootProps.tree,"slds-cell-edit":(ce=a.rootProps)==null?void 0:ce.editableColumnIndices.includes(P),"slds-is-edited":A==null?void 0:A.dirty,"slds-has-error":A==null?void 0:A.error}]),role:P>0&&a.rootProps.tree?"gridcell":null,scope:P===0?"row":null},{default:je(()=>{var re;return[de(v,{class:$t(["slds-grid slds-grid_align-spread",{"slds-grow":P===0}]),element:"span",style:{width:"100%"},active:(re=a.rootProps)==null?void 0:re.editableColumnIndices.includes(P)},{default:je(()=>{var W,Ce;return[de(v,{element:"span",class:"slds-grid slds-truncate",active:P===0&&((W=a.rootProps)==null?void 0:W.editableColumnIndices.includes(P))},{default:je(()=>{var te;return[a.rootProps.tree&&P===0?(L(),Ge(d,{key:0,variant:"bare",iconCategory:"utility",iconName:e.$props.row.expanded?"chevrondown":"chevronright",size:"x-small",class:$t(["slds-m-right_x-small",{"slds-is-disabled":!((te=e.$props.row.children)!=null&&te.length)}]),tabindex:"-1",title:`Expand ${(A==null?void 0:A.type)==="anchor"?A.value:A}`,assistiveText:`Expand ${(A==null?void 0:A.type)==="anchor"?A.value:A}`,onClick:a.handleRowToggleClick},null,8,["iconName","class","title","assistiveText","onClick"])):$e("",!0),(A==null?void 0:A.type)==="custom"?js(e.$slots,"cell",Ji({key:1,column:a.rootProps.columns[P],columnIndex:P,data:A},e.$props)):(L(),X(Lt,{key:2},[(A==null?void 0:A.type)==="badge"?(L(),Ge(p,{key:0,theme:A.theme,content:A.value},null,8,["theme","content"])):typeof A=="boolean"?(L(),Ge(y,{key:1,category:"utility",name:"check",size:"xx-small"})):(L(),X("div",{key:2,title:(A==null?void 0:A.type)==="anchor"?A.value:A,class:"slds-truncate"},[de(v,Ji({tabindex:"-1",element:"a"},(A==null?void 0:A.attrs)||{},{active:(A==null?void 0:A.type)==="anchor",onClick:oe=>a.handleAnchorClick(A,oe)}),{default:je(()=>[es(Pe((A==null?void 0:A.type)==="anchor"?A.value:A),1)]),_:2},1040,["active","onClick"])],8,G6))],64))]}),_:2},1032,["active"]),(Ce=a.rootProps)!=null&&Ce.editableColumnIndices.includes(P)?(L(),Ge(d,{key:0,variant:"bare",iconCategory:"utility",iconClass:"slds-button__icon_hint slds-button__icon_edit",iconName:A.locked?"lock":"edit",size:"x-small",class:"slds-cell-edit__button slds-m-left_x-small",title:`Edit ${a.rootProps.columns[P].name} of ${(A==null?void 0:A.type)==="anchor"?A.value:A}`,assistiveText:`Edit ${a.rootProps.columns[P].name} of ${(A==null?void 0:A.type)==="anchor"?A.value:A}`,disabled:A.locked,onClick:te=>a.handleCellEdit(te,P)},null,8,["iconName","title","assistiveText","disabled","onClick"])):$e("",!0)]}),_:2},1032,["class","active"]),P===r.indexOfColumnBeingEdited?(L(),X("section",W6,[k("div",Y6,[k("div",Z6,[k("div",X6,[k("div",{class:$t(["slds-form-element slds-grid slds-wrap",{"slds-has-error":A.error}])},[k("label",{class:"slds-form-element__label slds-form-element__label_edit slds-no-flex",for:`${a.rootProps.columns[P].name}-${P}`},[k("span",J6,Pe(a.rootProps.columns[P].name),1)],8,K6),k("div",Q6,[k("input",{id:`${a.rootProps.columns[P].name}-${P}`,class:"slds-input",type:"text",value:A.value,onBlur:t[2]||(t[2]=(...W)=>a.resetEditMode&&a.resetEditMode(...W)),onKeydown:[t[3]||(t[3]=Zs(Os((...W)=>a.resetEditMode&&a.resetEditMode(...W),["stop"]),["esc"])),t[4]||(t[4]=Zs(Os(W=>a.updateCellValue(W),["stop"]),["enter"]))]},null,40,ez)]),A.error?(L(),X("div",tz,Pe(A.error),1)):$e("",!0)],2)])])])])):$e("",!0)]}),_:2},1032,["data-label","class","role","scope"])}),128)),(O=e.$props.row.actions)!=null&&O.length?(L(),X("td",sz,[de(I,null,{default:je(()=>[(L(!0),X(Lt,null,As(e.$props.row.actions,(A,P)=>(L(),Ge(C,{key:P,label:A.label,onClick:q=>a.handleRowAction(A)},null,8,["label","onClick"]))),128))]),_:1})])):$e("",!0)],10,q6)}const US=os(j6,[["render",nz]]),VS={name:"DataTableTreeNode",components:{Row:US},props:["depth","parentRef","row","childIndex"],render(){const e=[An(US,{...this.$props},{cell:t=>this.$slots.cell?this.$slots.cell(t):null})];return this.$props.row.children&&this.$props.row.expanded&&this.$props.row.children.forEach((t,s)=>e.push(An(VS,{childIndex:s,depth:this.$props.depth+1,parentRef:this.$props.row,row:t},{cell:n=>this.$slots.cell?this.$slots.cell(n):null}))),[e]}},rz={name:"DataTableTree",components:{Node:VS},props:["rows"],render(){const e=this.$slots.default?this.$slots.default():null;return this.$props.rows.map((t,s)=>An(VS,{childIndex:s,depth:0,parentRef:null,row:t},{cell:n=>this.$slots.cell?this.$slots.cell(n):null})).concat(e)}},Lk={name:"DataTable",components:{ActionMenu:wa,ActionMenuItem:Sa,Checkbox:za,Icon:yn,Layout:xC,LayoutItem:wC,Row:US,Tree:rz},provide(){return{rootProps:this.$props,selectAllId:this.selectAllId,rootEmit:(...e)=>{this.$emit(e[0],...e.slice(1))}}},props:{actions:Boolean,ariaLabel:{type:String,default:""},bordered:Boolean,bufferCells:Boolean,columns:{type:Array,required:!0},columnsBordered:Boolean,editableColumnIndices:{type:Array,default:()=>[]},hideHeader:Boolean,multiselectable:Boolean,resizable:Boolean,rows:{type:Array,required:!0},selectAll:Boolean,summaryFooter:Boolean,summaryHeader:Boolean,tree:Boolean,virtual:Boolean},emits:["column-action","row-action","select-all","select-column","select-row","update-cell"],data(){return{selectedAll:!1,selectAllId:Vn(),columnResizer:{},rowHeight:0,containerHeight:0,visibleRowsStartIndex:0,selectedColumnBackgroundColor:"blue"}},computed:{computedRole(){return this.$props.tree?"treegrid":this.$props.multiselectable?"grid":null},visibleRows(){return this.$props.virtual?this.rows.slice(this.visibleRowsStartIndex,this.visibleRowsStartIndex+200):this.rows},tableContainerPaddingTop(){return this.visibleRowsStartIndex*this.rowHeight},tableContainerPaddingBottom(){return(this.rows.length-this.visibleRows.length)*this.rowHeight-this.tableContainerPaddingTop},hasSelectableColumns(){return this.$props.columns.some(e=>e.selectable)},verticalHeaderCellPadding(){return this.$props.summaryHeader&&this.hasSelectableColumns?"0.75rem":"0.5rem"},selectedPseudoElementTop(){return!this.hasSelectableColumns||!this.$props.summaryHeader?"-4px":0},selectedBorderRadius(){return this.$props.summaryHeader?0:"2px"}},watch:{"$props.rows":{handler(e){e.length&&(this.initColumnResizer(),this.$props.virtual&&this.$nextTick(()=>{this.rowHeight=this.$refs["row-0"][0].$refs.row.offsetHeight,this.containerHeight=this.$refs.tableContainer.offsetHeight}))},immediate:!0}},methods:{async initColumnResizer(){!this.$props.resizable||(await this.$nextTick(),this.columnResizer=new Pk(this.$refs.table,{disable:!this.$props.resizable,innerGripHtml:"<div class='rangeGrip'></div>",removePadding:!1,minWidth:48}))},onSelectAllChange(){this.rows.forEach(e=>{e.selected=this.selectedAll}),this.$emit("select-all",this.selectedAll)},onScroll(){!this.$props.virtual||this.scrollTimeout||(this.scrollTimeout=setTimeout(()=>{this.visibleRowsStartIndex=Math.max(0,Math.floor(this.$refs.tableContainer.scrollTop/this.rowHeight)-100),this.scrollTimeout=null},500))},getListeners(e,t){const s={...e.listeners||{}};return e.selectable&&(s.click=[s.click,this.onHeaderClick.bind(this,e,t)]),s},onHeaderClick(e,t,s){function n(r){if(r.nodeName==="TH")return r;for(;r.parentNode;)if(r=r.parentNode,r.nodeName==="TH")return r;return null}if(s.target.nodeName!=="BUTTON"&&(this.$emit("select-column",{column:e,columnIndex:t}),e.selected=!0,this.$refs.tableContainer.style.paddingTop="5px",e.icon)){const r=n(s.target).querySelector("div.slds-icon_container");r&&(this.selectedColumnBackgroundColor=window.getComputedStyle(r).backgroundColor)}}}},tA=()=>{AE(e=>({"4d4e3100":e.selectedPseudoElementTop,"85016f72":e.selectedBorderRadius,"484c9e56":e.selectedColumnBackgroundColor,f99d0584:e.verticalHeaderCellPadding}))},sA=Lk.setup;Lk.setup=sA?(e,t)=>(tA(),sA(e,t)):tA;//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var Nk;function Rs(){return Nk.apply(null,arguments)}function iz(e){Nk=e}function wu(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function mm(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function xr(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function SC(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(xr(e,t))return!1;return!0}function sl(e){return e===void 0}function vh(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function Zv(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function Dk(e,t){var s=[],n,r=e.length;for(n=0;n<r;++n)s.push(t(e[n],n));return s}function Rp(e,t){for(var s in t)xr(t,s)&&(e[s]=t[s]);return xr(t,"toString")&&(e.toString=t.toString),xr(t,"valueOf")&&(e.valueOf=t.valueOf),e}function md(e,t,s,n){return aP(e,t,s,n,!0).utc()}function oz(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function $n(e){return e._pf==null&&(e._pf=oz()),e._pf}var jS;Array.prototype.some?jS=Array.prototype.some:jS=function(e){var t=Object(this),s=t.length>>>0,n;for(n=0;n<s;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function CC(e){if(e._isValid==null){var t=$n(e),s=jS.call(t.parsedDateParts,function(r){return r!=null}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&s);if(e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n}return e._isValid}function ux(e){var t=md(NaN);return e!=null?Rp($n(t),e):$n(t).userInvalidated=!0,t}var nA=Rs.momentProperties=[],Kw=!1;function IC(e,t){var s,n,r,a=nA.length;if(sl(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),sl(t._i)||(e._i=t._i),sl(t._f)||(e._f=t._f),sl(t._l)||(e._l=t._l),sl(t._strict)||(e._strict=t._strict),sl(t._tzm)||(e._tzm=t._tzm),sl(t._isUTC)||(e._isUTC=t._isUTC),sl(t._offset)||(e._offset=t._offset),sl(t._pf)||(e._pf=$n(t)),sl(t._locale)||(e._locale=t._locale),a>0)for(s=0;s<a;s++)n=nA[s],r=t[n],sl(r)||(e[n]=r);return e}function Xv(e){IC(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Kw===!1&&(Kw=!0,Rs.updateOffset(this),Kw=!1)}function Su(e){return e instanceof Xv||e!=null&&e._isAMomentObject!=null}function Bk(e){Rs.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function Bc(e,t){var s=!0;return Rp(function(){if(Rs.deprecationHandler!=null&&Rs.deprecationHandler(null,e),s){var n=[],r,a,o,d=arguments.length;for(a=0;a<d;a++){if(r="",typeof arguments[a]=="object"){r+=`
[`+a+"] ";for(o in arguments[0])xr(arguments[0],o)&&(r+=o+": "+arguments[0][o]+", ");r=r.slice(0,-2)}else r=arguments[a];n.push(r)}Bk(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),s=!1}return t.apply(this,arguments)},t)}var rA={};function Fk(e,t){Rs.deprecationHandler!=null&&Rs.deprecationHandler(e,t),rA[e]||(Bk(t),rA[e]=!0)}Rs.suppressDeprecationWarnings=!1;Rs.deprecationHandler=null;function _d(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function az(e){var t,s;for(s in e)xr(e,s)&&(t=e[s],_d(t)?this[s]=t:this["_"+s]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function qS(e,t){var s=Rp({},e),n;for(n in t)xr(t,n)&&(mm(e[n])&&mm(t[n])?(s[n]={},Rp(s[n],e[n]),Rp(s[n],t[n])):t[n]!=null?s[n]=t[n]:delete s[n]);for(n in e)xr(e,n)&&!xr(t,n)&&mm(e[n])&&(s[n]=Rp({},s[n]));return s}function TC(e){e!=null&&this.set(e)}var HS;Object.keys?HS=Object.keys:HS=function(e){var t,s=[];for(t in e)xr(e,t)&&s.push(t);return s};var lz={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function cz(e,t,s){var n=this._calendar[e]||this._calendar.sameElse;return _d(n)?n.call(t,s):n}function hd(e,t,s){var n=""+Math.abs(e),r=t-n.length,a=e>=0;return(a?s?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+n}var AC=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,A1=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Jw={},ag={};function Js(e,t,s,n){var r=n;typeof n=="string"&&(r=function(){return this[n]()}),e&&(ag[e]=r),t&&(ag[t[0]]=function(){return hd(r.apply(this,arguments),t[1],t[2])}),s&&(ag[s]=function(){return this.localeData().ordinal(r.apply(this,arguments),e)})}function uz(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function dz(e){var t=e.match(AC),s,n;for(s=0,n=t.length;s<n;s++)ag[t[s]]?t[s]=ag[t[s]]:t[s]=uz(t[s]);return function(r){var a="",o;for(o=0;o<n;o++)a+=_d(t[o])?t[o].call(r,e):t[o];return a}}function G1(e,t){return e.isValid()?(t=zk(t,e.localeData()),Jw[t]=Jw[t]||dz(t),Jw[t](e)):e.localeData().invalidDate()}function zk(e,t){var s=5;function n(r){return t.longDateFormat(r)||r}for(A1.lastIndex=0;s>=0&&A1.test(e);)e=e.replace(A1,n),A1.lastIndex=0,s-=1;return e}var hz={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function pz(e){var t=this._longDateFormat[e],s=this._longDateFormat[e.toUpperCase()];return t||!s?t:(this._longDateFormat[e]=s.match(AC).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var fz="Invalid date";function mz(){return this._invalidDate}var _z="%d",gz=/\d{1,2}/;function yz(e){return this._ordinal.replace("%d",e)}var vz={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function bz(e,t,s,n){var r=this._relativeTime[s];return _d(r)?r(e,t,s,n):r.replace(/%d/i,e)}function xz(e,t){var s=this._relativeTime[e>0?"future":"past"];return _d(s)?s(t):s.replace(/%s/i,t)}var ev={};function Ca(e,t){var s=e.toLowerCase();ev[s]=ev[s+"s"]=ev[t]=e}function Fc(e){return typeof e=="string"?ev[e]||ev[e.toLowerCase()]:void 0}function MC(e){var t={},s,n;for(n in e)xr(e,n)&&(s=Fc(n),s&&(t[s]=e[n]));return t}var Uk={};function Ia(e,t){Uk[e]=t}function wz(e){var t=[],s;for(s in e)xr(e,s)&&t.push({unit:s,priority:Uk[s]});return t.sort(function(n,r){return n.priority-r.priority}),t}function dx(e){return e%4===0&&e%100!==0||e%400===0}function Ic(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function jn(e){var t=+e,s=0;return t!==0&&isFinite(t)&&(s=Ic(t)),s}function Bg(e,t){return function(s){return s!=null?(Vk(this,e,s),Rs.updateOffset(this,t),this):yb(this,e)}}function yb(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function Vk(e,t,s){e.isValid()&&!isNaN(s)&&(t==="FullYear"&&dx(e.year())&&e.month()===1&&e.date()===29?(s=jn(s),e._d["set"+(e._isUTC?"UTC":"")+t](s,e.month(),gx(s,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](s))}function Sz(e){return e=Fc(e),_d(this[e])?this[e]():this}function Cz(e,t){if(typeof e=="object"){e=MC(e);var s=wz(e),n,r=s.length;for(n=0;n<r;n++)this[s[n].unit](e[s[n].unit])}else if(e=Fc(e),_d(this[e]))return this[e](t);return this}var jk=/\d/,Vl=/\d\d/,qk=/\d{3}/,EC=/\d{4}/,hx=/[+-]?\d{6}/,pi=/\d\d?/,Hk=/\d\d\d\d?/,Gk=/\d\d\d\d\d\d?/,px=/\d{1,3}/,kC=/\d{1,4}/,fx=/[+-]?\d{1,6}/,Fg=/\d+/,mx=/[+-]?\d+/,Iz=/Z|[+-]\d\d:?\d\d/gi,_x=/Z|[+-]\d\d(?::?\d\d)?/gi,Tz=/[+-]?\d+(\.\d{1,3})?/,Kv=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,vb;vb={};function Ns(e,t,s){vb[e]=_d(t)?t:function(n,r){return n&&s?s:t}}function Az(e,t){return xr(vb,e)?vb[e](t._strict,t._locale):new RegExp(Mz(e))}function Mz(e){return Ol(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,s,n,r,a){return s||n||r||a}))}function Ol(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var GS={};function jr(e,t){var s,n=t,r;for(typeof e=="string"&&(e=[e]),vh(t)&&(n=function(a,o){o[t]=jn(a)}),r=e.length,s=0;s<r;s++)GS[e[s]]=n}function Jv(e,t){jr(e,function(s,n,r,a){r._w=r._w||{},t(s,r._w,r,a)})}function Ez(e,t,s){t!=null&&xr(GS,e)&&GS[e](t,s._a,s,e)}var va=0,lh=1,td=2,wo=3,gu=4,ch=5,am=6,kz=7,Pz=8;function Rz(e,t){return(e%t+t)%t}var Zi;Array.prototype.indexOf?Zi=Array.prototype.indexOf:Zi=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function gx(e,t){if(isNaN(e)||isNaN(t))return NaN;var s=Rz(t,12);return e+=(t-s)/12,s===1?dx(e)?29:28:31-s%7%2}Js("M",["MM",2],"Mo",function(){return this.month()+1});Js("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});Js("MMMM",0,0,function(e){return this.localeData().months(this,e)});Ca("month","M");Ia("month",8);Ns("M",pi);Ns("MM",pi,Vl);Ns("MMM",function(e,t){return t.monthsShortRegex(e)});Ns("MMMM",function(e,t){return t.monthsRegex(e)});jr(["M","MM"],function(e,t){t[lh]=jn(e)-1});jr(["MMM","MMMM"],function(e,t,s,n){var r=s._locale.monthsParse(e,n,s._strict);r!=null?t[lh]=r:$n(s).invalidMonth=e});var $z="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Wk="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Yk=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Oz=Kv,Lz=Kv;function Nz(e,t){return e?wu(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||Yk).test(t)?"format":"standalone"][e.month()]:wu(this._months)?this._months:this._months.standalone}function Dz(e,t){return e?wu(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Yk.test(t)?"format":"standalone"][e.month()]:wu(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Bz(e,t,s){var n,r,a,o=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)a=md([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(a,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(a,"").toLocaleLowerCase();return s?t==="MMM"?(r=Zi.call(this._shortMonthsParse,o),r!==-1?r:null):(r=Zi.call(this._longMonthsParse,o),r!==-1?r:null):t==="MMM"?(r=Zi.call(this._shortMonthsParse,o),r!==-1?r:(r=Zi.call(this._longMonthsParse,o),r!==-1?r:null)):(r=Zi.call(this._longMonthsParse,o),r!==-1?r:(r=Zi.call(this._shortMonthsParse,o),r!==-1?r:null))}function Fz(e,t,s){var n,r,a;if(this._monthsParseExact)return Bz.call(this,e,t,s);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(r=md([2e3,n]),s&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),!s&&!this._monthsParse[n]&&(a="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[n]=new RegExp(a.replace(".",""),"i")),s&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(s&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!s&&this._monthsParse[n].test(e))return n}}function Zk(e,t){var s;if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=jn(t);else if(t=e.localeData().monthsParse(t),!vh(t))return e}return s=Math.min(e.date(),gx(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,s),e}function Xk(e){return e!=null?(Zk(this,e),Rs.updateOffset(this,!0),this):yb(this,"Month")}function zz(){return gx(this.year(),this.month())}function Uz(e){return this._monthsParseExact?(xr(this,"_monthsRegex")||Kk.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(xr(this,"_monthsShortRegex")||(this._monthsShortRegex=Oz),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function Vz(e){return this._monthsParseExact?(xr(this,"_monthsRegex")||Kk.call(this),e?this._monthsStrictRegex:this._monthsRegex):(xr(this,"_monthsRegex")||(this._monthsRegex=Lz),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function Kk(){function e(o,d){return d.length-o.length}var t=[],s=[],n=[],r,a;for(r=0;r<12;r++)a=md([2e3,r]),t.push(this.monthsShort(a,"")),s.push(this.months(a,"")),n.push(this.months(a,"")),n.push(this.monthsShort(a,""));for(t.sort(e),s.sort(e),n.sort(e),r=0;r<12;r++)t[r]=Ol(t[r]),s[r]=Ol(s[r]);for(r=0;r<24;r++)n[r]=Ol(n[r]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}Js("Y",0,0,function(){var e=this.year();return e<=9999?hd(e,4):"+"+e});Js(0,["YY",2],0,function(){return this.year()%100});Js(0,["YYYY",4],0,"year");Js(0,["YYYYY",5],0,"year");Js(0,["YYYYYY",6,!0],0,"year");Ca("year","y");Ia("year",1);Ns("Y",mx);Ns("YY",pi,Vl);Ns("YYYY",kC,EC);Ns("YYYYY",fx,hx);Ns("YYYYYY",fx,hx);jr(["YYYYY","YYYYYY"],va);jr("YYYY",function(e,t){t[va]=e.length===2?Rs.parseTwoDigitYear(e):jn(e)});jr("YY",function(e,t){t[va]=Rs.parseTwoDigitYear(e)});jr("Y",function(e,t){t[va]=parseInt(e,10)});function tv(e){return dx(e)?366:365}Rs.parseTwoDigitYear=function(e){return jn(e)+(jn(e)>68?1900:2e3)};var Jk=Bg("FullYear",!0);function jz(){return dx(this.year())}function qz(e,t,s,n,r,a,o){var d;return e<100&&e>=0?(d=new Date(e+400,t,s,n,r,a,o),isFinite(d.getFullYear())&&d.setFullYear(e)):d=new Date(e,t,s,n,r,a,o),d}function bv(e){var t,s;return e<100&&e>=0?(s=Array.prototype.slice.call(arguments),s[0]=e+400,t=new Date(Date.UTC.apply(null,s)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function bb(e,t,s){var n=7+t-s,r=(7+bv(e,0,n).getUTCDay()-t)%7;return-r+n-1}function Qk(e,t,s,n,r){var a=(7+s-n)%7,o=bb(e,n,r),d=1+7*(t-1)+a+o,p,y;return d<=0?(p=e-1,y=tv(p)+d):d>tv(e)?(p=e+1,y=d-tv(e)):(p=e,y=d),{year:p,dayOfYear:y}}function xv(e,t,s){var n=bb(e.year(),t,s),r=Math.floor((e.dayOfYear()-n-1)/7)+1,a,o;return r<1?(o=e.year()-1,a=r+_h(o,t,s)):r>_h(e.year(),t,s)?(a=r-_h(e.year(),t,s),o=e.year()+1):(o=e.year(),a=r),{week:a,year:o}}function _h(e,t,s){var n=bb(e,t,s),r=bb(e+1,t,s);return(tv(e)-n+r)/7}Js("w",["ww",2],"wo","week");Js("W",["WW",2],"Wo","isoWeek");Ca("week","w");Ca("isoWeek","W");Ia("week",5);Ia("isoWeek",5);Ns("w",pi);Ns("ww",pi,Vl);Ns("W",pi);Ns("WW",pi,Vl);Jv(["w","ww","W","WW"],function(e,t,s,n){t[n.substr(0,1)]=jn(e)});function Hz(e){return xv(e,this._week.dow,this._week.doy).week}var Gz={dow:0,doy:6};function Wz(){return this._week.dow}function Yz(){return this._week.doy}function Zz(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function Xz(e){var t=xv(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}Js("d",0,"do","day");Js("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});Js("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});Js("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});Js("e",0,0,"weekday");Js("E",0,0,"isoWeekday");Ca("day","d");Ca("weekday","e");Ca("isoWeekday","E");Ia("day",11);Ia("weekday",11);Ia("isoWeekday",11);Ns("d",pi);Ns("e",pi);Ns("E",pi);Ns("dd",function(e,t){return t.weekdaysMinRegex(e)});Ns("ddd",function(e,t){return t.weekdaysShortRegex(e)});Ns("dddd",function(e,t){return t.weekdaysRegex(e)});Jv(["dd","ddd","dddd"],function(e,t,s,n){var r=s._locale.weekdaysParse(e,n,s._strict);r!=null?t.d=r:$n(s).invalidWeekday=e});Jv(["d","e","E"],function(e,t,s,n){t[n]=jn(e)});function Kz(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function Jz(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function PC(e,t){return e.slice(t,7).concat(e.slice(0,t))}var Qz="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),eP="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),eU="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),tU=Kv,sU=Kv,nU=Kv;function rU(e,t){var s=wu(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?PC(s,this._week.dow):e?s[e.day()]:s}function iU(e){return e===!0?PC(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function oU(e){return e===!0?PC(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function aU(e,t,s){var n,r,a,o=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)a=md([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(a,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(a,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(a,"").toLocaleLowerCase();return s?t==="dddd"?(r=Zi.call(this._weekdaysParse,o),r!==-1?r:null):t==="ddd"?(r=Zi.call(this._shortWeekdaysParse,o),r!==-1?r:null):(r=Zi.call(this._minWeekdaysParse,o),r!==-1?r:null):t==="dddd"?(r=Zi.call(this._weekdaysParse,o),r!==-1||(r=Zi.call(this._shortWeekdaysParse,o),r!==-1)?r:(r=Zi.call(this._minWeekdaysParse,o),r!==-1?r:null)):t==="ddd"?(r=Zi.call(this._shortWeekdaysParse,o),r!==-1||(r=Zi.call(this._weekdaysParse,o),r!==-1)?r:(r=Zi.call(this._minWeekdaysParse,o),r!==-1?r:null)):(r=Zi.call(this._minWeekdaysParse,o),r!==-1||(r=Zi.call(this._weekdaysParse,o),r!==-1)?r:(r=Zi.call(this._shortWeekdaysParse,o),r!==-1?r:null))}function lU(e,t,s){var n,r,a;if(this._weekdaysParseExact)return aU.call(this,e,t,s);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(r=md([2e3,1]).day(n),s&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(r,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(r,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(r,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(a="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[n]=new RegExp(a.replace(".",""),"i")),s&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(s&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(s&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!s&&this._weekdaysParse[n].test(e))return n}}function cU(e){if(!this.isValid())return e!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=Kz(e,this.localeData()),this.add(e-t,"d")):t}function uU(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function dU(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=Jz(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function hU(e){return this._weekdaysParseExact?(xr(this,"_weekdaysRegex")||RC.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(xr(this,"_weekdaysRegex")||(this._weekdaysRegex=tU),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function pU(e){return this._weekdaysParseExact?(xr(this,"_weekdaysRegex")||RC.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(xr(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=sU),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function fU(e){return this._weekdaysParseExact?(xr(this,"_weekdaysRegex")||RC.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(xr(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=nU),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function RC(){function e(v,C){return C.length-v.length}var t=[],s=[],n=[],r=[],a,o,d,p,y;for(a=0;a<7;a++)o=md([2e3,1]).day(a),d=Ol(this.weekdaysMin(o,"")),p=Ol(this.weekdaysShort(o,"")),y=Ol(this.weekdays(o,"")),t.push(d),s.push(p),n.push(y),r.push(d),r.push(p),r.push(y);t.sort(e),s.sort(e),n.sort(e),r.sort(e),this._weekdaysRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function $C(){return this.hours()%12||12}function mU(){return this.hours()||24}Js("H",["HH",2],0,"hour");Js("h",["hh",2],0,$C);Js("k",["kk",2],0,mU);Js("hmm",0,0,function(){return""+$C.apply(this)+hd(this.minutes(),2)});Js("hmmss",0,0,function(){return""+$C.apply(this)+hd(this.minutes(),2)+hd(this.seconds(),2)});Js("Hmm",0,0,function(){return""+this.hours()+hd(this.minutes(),2)});Js("Hmmss",0,0,function(){return""+this.hours()+hd(this.minutes(),2)+hd(this.seconds(),2)});function tP(e,t){Js(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}tP("a",!0);tP("A",!1);Ca("hour","h");Ia("hour",13);function sP(e,t){return t._meridiemParse}Ns("a",sP);Ns("A",sP);Ns("H",pi);Ns("h",pi);Ns("k",pi);Ns("HH",pi,Vl);Ns("hh",pi,Vl);Ns("kk",pi,Vl);Ns("hmm",Hk);Ns("hmmss",Gk);Ns("Hmm",Hk);Ns("Hmmss",Gk);jr(["H","HH"],wo);jr(["k","kk"],function(e,t,s){var n=jn(e);t[wo]=n===24?0:n});jr(["a","A"],function(e,t,s){s._isPm=s._locale.isPM(e),s._meridiem=e});jr(["h","hh"],function(e,t,s){t[wo]=jn(e),$n(s).bigHour=!0});jr("hmm",function(e,t,s){var n=e.length-2;t[wo]=jn(e.substr(0,n)),t[gu]=jn(e.substr(n)),$n(s).bigHour=!0});jr("hmmss",function(e,t,s){var n=e.length-4,r=e.length-2;t[wo]=jn(e.substr(0,n)),t[gu]=jn(e.substr(n,2)),t[ch]=jn(e.substr(r)),$n(s).bigHour=!0});jr("Hmm",function(e,t,s){var n=e.length-2;t[wo]=jn(e.substr(0,n)),t[gu]=jn(e.substr(n))});jr("Hmmss",function(e,t,s){var n=e.length-4,r=e.length-2;t[wo]=jn(e.substr(0,n)),t[gu]=jn(e.substr(n,2)),t[ch]=jn(e.substr(r))});function _U(e){return(e+"").toLowerCase().charAt(0)==="p"}var gU=/[ap]\.?m?\.?/i,yU=Bg("Hours",!0);function vU(e,t,s){return e>11?s?"pm":"PM":s?"am":"AM"}var nP={calendar:lz,longDateFormat:hz,invalidDate:fz,ordinal:_z,dayOfMonthOrdinalParse:gz,relativeTime:vz,months:$z,monthsShort:Wk,week:Gz,weekdays:Qz,weekdaysMin:eU,weekdaysShort:eP,meridiemParse:gU},gi={},Dy={},wv;function bU(e,t){var s,n=Math.min(e.length,t.length);for(s=0;s<n;s+=1)if(e[s]!==t[s])return s;return n}function iA(e){return e&&e.toLowerCase().replace("_","-")}function xU(e){for(var t=0,s,n,r,a;t<e.length;){for(a=iA(e[t]).split("-"),s=a.length,n=iA(e[t+1]),n=n?n.split("-"):null;s>0;){if(r=yx(a.slice(0,s).join("-")),r)return r;if(n&&n.length>=s&&bU(a,n)>=s-1)break;s--}t++}return wv}function wU(e){return e.match("^[^/\\\\]*$")!=null}function yx(e){var t=null,s;if(gi[e]===void 0&&typeof rb<"u"&&rb&&rb.exports&&wU(e))try{t=wv._abbr,s=require,s("./locale/"+e),Fp(t)}catch{gi[e]=null}return gi[e]}function Fp(e,t){var s;return e&&(sl(t)?s=Th(e):s=OC(e,t),s?wv=s:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),wv._abbr}function OC(e,t){if(t!==null){var s,n=nP;if(t.abbr=e,gi[e]!=null)Fk("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=gi[e]._config;else if(t.parentLocale!=null)if(gi[t.parentLocale]!=null)n=gi[t.parentLocale]._config;else if(s=yx(t.parentLocale),s!=null)n=s._config;else return Dy[t.parentLocale]||(Dy[t.parentLocale]=[]),Dy[t.parentLocale].push({name:e,config:t}),null;return gi[e]=new TC(qS(n,t)),Dy[e]&&Dy[e].forEach(function(r){OC(r.name,r.config)}),Fp(e),gi[e]}else return delete gi[e],null}function SU(e,t){if(t!=null){var s,n,r=nP;gi[e]!=null&&gi[e].parentLocale!=null?gi[e].set(qS(gi[e]._config,t)):(n=yx(e),n!=null&&(r=n._config),t=qS(r,t),n==null&&(t.abbr=e),s=new TC(t),s.parentLocale=gi[e],gi[e]=s),Fp(e)}else gi[e]!=null&&(gi[e].parentLocale!=null?(gi[e]=gi[e].parentLocale,e===Fp()&&Fp(e)):gi[e]!=null&&delete gi[e]);return gi[e]}function Th(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return wv;if(!wu(e)){if(t=yx(e),t)return t;e=[e]}return xU(e)}function CU(){return HS(gi)}function LC(e){var t,s=e._a;return s&&$n(e).overflow===-2&&(t=s[lh]<0||s[lh]>11?lh:s[td]<1||s[td]>gx(s[va],s[lh])?td:s[wo]<0||s[wo]>24||s[wo]===24&&(s[gu]!==0||s[ch]!==0||s[am]!==0)?wo:s[gu]<0||s[gu]>59?gu:s[ch]<0||s[ch]>59?ch:s[am]<0||s[am]>999?am:-1,$n(e)._overflowDayOfYear&&(t<va||t>td)&&(t=td),$n(e)._overflowWeeks&&t===-1&&(t=kz),$n(e)._overflowWeekday&&t===-1&&(t=Pz),$n(e).overflow=t),e}var IU=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,TU=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,AU=/Z|[+-]\d\d(?::?\d\d)?/,M1=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Qw=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],MU=/^\/?Date\((-?\d+)/i,EU=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,kU={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function rP(e){var t,s,n=e._i,r=IU.exec(n)||TU.exec(n),a,o,d,p,y=M1.length,v=Qw.length;if(r){for($n(e).iso=!0,t=0,s=y;t<s;t++)if(M1[t][1].exec(r[1])){o=M1[t][0],a=M1[t][2]!==!1;break}if(o==null){e._isValid=!1;return}if(r[3]){for(t=0,s=v;t<s;t++)if(Qw[t][1].exec(r[3])){d=(r[2]||" ")+Qw[t][0];break}if(d==null){e._isValid=!1;return}}if(!a&&d!=null){e._isValid=!1;return}if(r[4])if(AU.exec(r[4]))p="Z";else{e._isValid=!1;return}e._f=o+(d||"")+(p||""),DC(e)}else e._isValid=!1}function PU(e,t,s,n,r,a){var o=[RU(e),Wk.indexOf(t),parseInt(s,10),parseInt(n,10),parseInt(r,10)];return a&&o.push(parseInt(a,10)),o}function RU(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function $U(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function OU(e,t,s){if(e){var n=eP.indexOf(e),r=new Date(t[0],t[1],t[2]).getDay();if(n!==r)return $n(s).weekdayMismatch=!0,s._isValid=!1,!1}return!0}function LU(e,t,s){if(e)return kU[e];if(t)return 0;var n=parseInt(s,10),r=n%100,a=(n-r)/100;return a*60+r}function iP(e){var t=EU.exec($U(e._i)),s;if(t){if(s=PU(t[4],t[3],t[2],t[5],t[6],t[7]),!OU(t[1],s,e))return;e._a=s,e._tzm=LU(t[8],t[9],t[10]),e._d=bv.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),$n(e).rfc2822=!0}else e._isValid=!1}function NU(e){var t=MU.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(rP(e),e._isValid===!1)delete e._isValid;else return;if(iP(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:Rs.createFromInputFallback(e)}Rs.createFromInputFallback=Bc("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function X_(e,t,s){return e!=null?e:t!=null?t:s}function DU(e){var t=new Date(Rs.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function NC(e){var t,s,n=[],r,a,o;if(!e._d){for(r=DU(e),e._w&&e._a[td]==null&&e._a[lh]==null&&BU(e),e._dayOfYear!=null&&(o=X_(e._a[va],r[va]),(e._dayOfYear>tv(o)||e._dayOfYear===0)&&($n(e)._overflowDayOfYear=!0),s=bv(o,0,e._dayOfYear),e._a[lh]=s.getUTCMonth(),e._a[td]=s.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=r[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[wo]===24&&e._a[gu]===0&&e._a[ch]===0&&e._a[am]===0&&(e._nextDay=!0,e._a[wo]=0),e._d=(e._useUTC?bv:qz).apply(null,n),a=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[wo]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==a&&($n(e).weekdayMismatch=!0)}}function BU(e){var t,s,n,r,a,o,d,p,y;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(a=1,o=4,s=X_(t.GG,e._a[va],xv(hi(),1,4).year),n=X_(t.W,1),r=X_(t.E,1),(r<1||r>7)&&(p=!0)):(a=e._locale._week.dow,o=e._locale._week.doy,y=xv(hi(),a,o),s=X_(t.gg,e._a[va],y.year),n=X_(t.w,y.week),t.d!=null?(r=t.d,(r<0||r>6)&&(p=!0)):t.e!=null?(r=t.e+a,(t.e<0||t.e>6)&&(p=!0)):r=a),n<1||n>_h(s,a,o)?$n(e)._overflowWeeks=!0:p!=null?$n(e)._overflowWeekday=!0:(d=Qk(s,n,r,a,o),e._a[va]=d.year,e._dayOfYear=d.dayOfYear)}Rs.ISO_8601=function(){};Rs.RFC_2822=function(){};function DC(e){if(e._f===Rs.ISO_8601){rP(e);return}if(e._f===Rs.RFC_2822){iP(e);return}e._a=[],$n(e).empty=!0;var t=""+e._i,s,n,r,a,o,d=t.length,p=0,y,v;for(r=zk(e._f,e._locale).match(AC)||[],v=r.length,s=0;s<v;s++)a=r[s],n=(t.match(Az(a,e))||[])[0],n&&(o=t.substr(0,t.indexOf(n)),o.length>0&&$n(e).unusedInput.push(o),t=t.slice(t.indexOf(n)+n.length),p+=n.length),ag[a]?(n?$n(e).empty=!1:$n(e).unusedTokens.push(a),Ez(a,n,e)):e._strict&&!n&&$n(e).unusedTokens.push(a);$n(e).charsLeftOver=d-p,t.length>0&&$n(e).unusedInput.push(t),e._a[wo]<=12&&$n(e).bigHour===!0&&e._a[wo]>0&&($n(e).bigHour=void 0),$n(e).parsedDateParts=e._a.slice(0),$n(e).meridiem=e._meridiem,e._a[wo]=FU(e._locale,e._a[wo],e._meridiem),y=$n(e).era,y!==null&&(e._a[va]=e._locale.erasConvertYear(y,e._a[va])),NC(e),LC(e)}function FU(e,t,s){var n;return s==null?t:e.meridiemHour!=null?e.meridiemHour(t,s):(e.isPM!=null&&(n=e.isPM(s),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function zU(e){var t,s,n,r,a,o,d=!1,p=e._f.length;if(p===0){$n(e).invalidFormat=!0,e._d=new Date(NaN);return}for(r=0;r<p;r++)a=0,o=!1,t=IC({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[r],DC(t),CC(t)&&(o=!0),a+=$n(t).charsLeftOver,a+=$n(t).unusedTokens.length*10,$n(t).score=a,d?a<n&&(n=a,s=t):(n==null||a<n||o)&&(n=a,s=t,o&&(d=!0));Rp(e,s||t)}function UU(e){if(!e._d){var t=MC(e._i),s=t.day===void 0?t.date:t.day;e._a=Dk([t.year,t.month,s,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),NC(e)}}function VU(e){var t=new Xv(LC(oP(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function oP(e){var t=e._i,s=e._f;return e._locale=e._locale||Th(e._l),t===null||s===void 0&&t===""?ux({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),Su(t)?new Xv(LC(t)):(Zv(t)?e._d=t:wu(s)?zU(e):s?DC(e):jU(e),CC(e)||(e._d=null),e))}function jU(e){var t=e._i;sl(t)?e._d=new Date(Rs.now()):Zv(t)?e._d=new Date(t.valueOf()):typeof t=="string"?NU(e):wu(t)?(e._a=Dk(t.slice(0),function(s){return parseInt(s,10)}),NC(e)):mm(t)?UU(e):vh(t)?e._d=new Date(t):Rs.createFromInputFallback(e)}function aP(e,t,s,n,r){var a={};return(t===!0||t===!1)&&(n=t,t=void 0),(s===!0||s===!1)&&(n=s,s=void 0),(mm(e)&&SC(e)||wu(e)&&e.length===0)&&(e=void 0),a._isAMomentObject=!0,a._useUTC=a._isUTC=r,a._l=s,a._i=e,a._f=t,a._strict=n,VU(a)}function hi(e,t,s,n){return aP(e,t,s,n,!1)}var qU=Bc("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=hi.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:ux()}),HU=Bc("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=hi.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:ux()});function lP(e,t){var s,n;if(t.length===1&&wu(t[0])&&(t=t[0]),!t.length)return hi();for(s=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](s))&&(s=t[n]);return s}function GU(){var e=[].slice.call(arguments,0);return lP("isBefore",e)}function WU(){var e=[].slice.call(arguments,0);return lP("isAfter",e)}var YU=function(){return Date.now?Date.now():+new Date},By=["year","quarter","month","week","day","hour","minute","second","millisecond"];function ZU(e){var t,s=!1,n,r=By.length;for(t in e)if(xr(e,t)&&!(Zi.call(By,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<r;++n)if(e[By[n]]){if(s)return!1;parseFloat(e[By[n]])!==jn(e[By[n]])&&(s=!0)}return!0}function XU(){return this._isValid}function KU(){return Cu(NaN)}function vx(e){var t=MC(e),s=t.year||0,n=t.quarter||0,r=t.month||0,a=t.week||t.isoWeek||0,o=t.day||0,d=t.hour||0,p=t.minute||0,y=t.second||0,v=t.millisecond||0;this._isValid=ZU(t),this._milliseconds=+v+y*1e3+p*6e4+d*1e3*60*60,this._days=+o+a*7,this._months=+r+n*3+s*12,this._data={},this._locale=Th(),this._bubble()}function W1(e){return e instanceof vx}function WS(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function JU(e,t,s){var n=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),a=0,o;for(o=0;o<n;o++)(s&&e[o]!==t[o]||!s&&jn(e[o])!==jn(t[o]))&&a++;return a+r}function cP(e,t){Js(e,0,0,function(){var s=this.utcOffset(),n="+";return s<0&&(s=-s,n="-"),n+hd(~~(s/60),2)+t+hd(~~s%60,2)})}cP("Z",":");cP("ZZ","");Ns("Z",_x);Ns("ZZ",_x);jr(["Z","ZZ"],function(e,t,s){s._useUTC=!0,s._tzm=BC(_x,e)});var QU=/([\+\-]|\d\d)/gi;function BC(e,t){var s=(t||"").match(e),n,r,a;return s===null?null:(n=s[s.length-1]||[],r=(n+"").match(QU)||["-",0,0],a=+(r[1]*60)+jn(r[2]),a===0?0:r[0]==="+"?a:-a)}function FC(e,t){var s,n;return t._isUTC?(s=t.clone(),n=(Su(e)||Zv(e)?e.valueOf():hi(e).valueOf())-s.valueOf(),s._d.setTime(s._d.valueOf()+n),Rs.updateOffset(s,!1),s):hi(e).local()}function YS(e){return-Math.round(e._d.getTimezoneOffset())}Rs.updateOffset=function(){};function e7(e,t,s){var n=this._offset||0,r;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=BC(_x,e),e===null)return this}else Math.abs(e)<16&&!s&&(e=e*60);return!this._isUTC&&t&&(r=YS(this)),this._offset=e,this._isUTC=!0,r!=null&&this.add(r,"m"),n!==e&&(!t||this._changeInProgress?hP(this,Cu(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Rs.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:YS(this)}function t7(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function s7(e){return this.utcOffset(0,e)}function n7(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(YS(this),"m")),this}function r7(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=BC(Iz,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function i7(e){return this.isValid()?(e=e?hi(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function o7(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function a7(){if(!sl(this._isDSTShifted))return this._isDSTShifted;var e={},t;return IC(e,this),e=oP(e),e._a?(t=e._isUTC?md(e._a):hi(e._a),this._isDSTShifted=this.isValid()&&JU(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function l7(){return this.isValid()?!this._isUTC:!1}function c7(){return this.isValid()?this._isUTC:!1}function uP(){return this.isValid()?this._isUTC&&this._offset===0:!1}var u7=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,d7=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Cu(e,t){var s=e,n=null,r,a,o;return W1(e)?s={ms:e._milliseconds,d:e._days,M:e._months}:vh(e)||!isNaN(+e)?(s={},t?s[t]=+e:s.milliseconds=+e):(n=u7.exec(e))?(r=n[1]==="-"?-1:1,s={y:0,d:jn(n[td])*r,h:jn(n[wo])*r,m:jn(n[gu])*r,s:jn(n[ch])*r,ms:jn(WS(n[am]*1e3))*r}):(n=d7.exec(e))?(r=n[1]==="-"?-1:1,s={y:Wf(n[2],r),M:Wf(n[3],r),w:Wf(n[4],r),d:Wf(n[5],r),h:Wf(n[6],r),m:Wf(n[7],r),s:Wf(n[8],r)}):s==null?s={}:typeof s=="object"&&("from"in s||"to"in s)&&(o=h7(hi(s.from),hi(s.to)),s={},s.ms=o.milliseconds,s.M=o.months),a=new vx(s),W1(e)&&xr(e,"_locale")&&(a._locale=e._locale),W1(e)&&xr(e,"_isValid")&&(a._isValid=e._isValid),a}Cu.fn=vx.prototype;Cu.invalid=KU;function Wf(e,t){var s=e&&parseFloat(e.replace(",","."));return(isNaN(s)?0:s)*t}function oA(e,t){var s={};return s.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(s.months,"M").isAfter(t)&&--s.months,s.milliseconds=+t-+e.clone().add(s.months,"M"),s}function h7(e,t){var s;return e.isValid()&&t.isValid()?(t=FC(t,e),e.isBefore(t)?s=oA(e,t):(s=oA(t,e),s.milliseconds=-s.milliseconds,s.months=-s.months),s):{milliseconds:0,months:0}}function dP(e,t){return function(s,n){var r,a;return n!==null&&!isNaN(+n)&&(Fk(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),a=s,s=n,n=a),r=Cu(s,n),hP(this,r,e),this}}function hP(e,t,s,n){var r=t._milliseconds,a=WS(t._days),o=WS(t._months);!e.isValid()||(n=n==null?!0:n,o&&Zk(e,yb(e,"Month")+o*s),a&&Vk(e,"Date",yb(e,"Date")+a*s),r&&e._d.setTime(e._d.valueOf()+r*s),n&&Rs.updateOffset(e,a||o))}var p7=dP(1,"add"),f7=dP(-1,"subtract");function pP(e){return typeof e=="string"||e instanceof String}function m7(e){return Su(e)||Zv(e)||pP(e)||vh(e)||g7(e)||_7(e)||e===null||e===void 0}function _7(e){var t=mm(e)&&!SC(e),s=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],r,a,o=n.length;for(r=0;r<o;r+=1)a=n[r],s=s||xr(e,a);return t&&s}function g7(e){var t=wu(e),s=!1;return t&&(s=e.filter(function(n){return!vh(n)&&pP(e)}).length===0),t&&s}function y7(e){var t=mm(e)&&!SC(e),s=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],r,a;for(r=0;r<n.length;r+=1)a=n[r],s=s||xr(e,a);return t&&s}function v7(e,t){var s=e.diff(t,"days",!0);return s<-6?"sameElse":s<-1?"lastWeek":s<0?"lastDay":s<1?"sameDay":s<2?"nextDay":s<7?"nextWeek":"sameElse"}function b7(e,t){arguments.length===1&&(arguments[0]?m7(arguments[0])?(e=arguments[0],t=void 0):y7(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var s=e||hi(),n=FC(s,this).startOf("day"),r=Rs.calendarFormat(this,n)||"sameElse",a=t&&(_d(t[r])?t[r].call(this,s):t[r]);return this.format(a||this.localeData().calendar(r,this,hi(s)))}function x7(){return new Xv(this)}function w7(e,t){var s=Su(e)?e:hi(e);return this.isValid()&&s.isValid()?(t=Fc(t)||"millisecond",t==="millisecond"?this.valueOf()>s.valueOf():s.valueOf()<this.clone().startOf(t).valueOf()):!1}function S7(e,t){var s=Su(e)?e:hi(e);return this.isValid()&&s.isValid()?(t=Fc(t)||"millisecond",t==="millisecond"?this.valueOf()<s.valueOf():this.clone().endOf(t).valueOf()<s.valueOf()):!1}function C7(e,t,s,n){var r=Su(e)?e:hi(e),a=Su(t)?t:hi(t);return this.isValid()&&r.isValid()&&a.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(r,s):!this.isBefore(r,s))&&(n[1]===")"?this.isBefore(a,s):!this.isAfter(a,s))):!1}function I7(e,t){var s=Su(e)?e:hi(e),n;return this.isValid()&&s.isValid()?(t=Fc(t)||"millisecond",t==="millisecond"?this.valueOf()===s.valueOf():(n=s.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function T7(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function A7(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function M7(e,t,s){var n,r,a;if(!this.isValid())return NaN;if(n=FC(e,this),!n.isValid())return NaN;switch(r=(n.utcOffset()-this.utcOffset())*6e4,t=Fc(t),t){case"year":a=Y1(this,n)/12;break;case"month":a=Y1(this,n);break;case"quarter":a=Y1(this,n)/3;break;case"second":a=(this-n)/1e3;break;case"minute":a=(this-n)/6e4;break;case"hour":a=(this-n)/36e5;break;case"day":a=(this-n-r)/864e5;break;case"week":a=(this-n-r)/6048e5;break;default:a=this-n}return s?a:Ic(a)}function Y1(e,t){if(e.date()<t.date())return-Y1(t,e);var s=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(s,"months"),r,a;return t-n<0?(r=e.clone().add(s-1,"months"),a=(t-n)/(n-r)):(r=e.clone().add(s+1,"months"),a=(t-n)/(r-n)),-(s+a)||0}Rs.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Rs.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function E7(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function k7(e){if(!this.isValid())return null;var t=e!==!0,s=t?this.clone().utc():this;return s.year()<0||s.year()>9999?G1(s,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):_d(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",G1(s,"Z")):G1(s,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function P7(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",s,n,r,a;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),s="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r="-MM-DD[T]HH:mm:ss.SSS",a=t+'[")]',this.format(s+n+r+a)}function R7(e){e||(e=this.isUtc()?Rs.defaultFormatUtc:Rs.defaultFormat);var t=G1(this,e);return this.localeData().postformat(t)}function $7(e,t){return this.isValid()&&(Su(e)&&e.isValid()||hi(e).isValid())?Cu({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function O7(e){return this.from(hi(),e)}function L7(e,t){return this.isValid()&&(Su(e)&&e.isValid()||hi(e).isValid())?Cu({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function N7(e){return this.to(hi(),e)}function fP(e){var t;return e===void 0?this._locale._abbr:(t=Th(e),t!=null&&(this._locale=t),this)}var mP=Bc("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function _P(){return this._locale}var xb=1e3,lg=60*xb,wb=60*lg,gP=(365*400+97)*24*wb;function cg(e,t){return(e%t+t)%t}function yP(e,t,s){return e<100&&e>=0?new Date(e+400,t,s)-gP:new Date(e,t,s).valueOf()}function vP(e,t,s){return e<100&&e>=0?Date.UTC(e+400,t,s)-gP:Date.UTC(e,t,s)}function D7(e){var t,s;if(e=Fc(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(s=this._isUTC?vP:yP,e){case"year":t=s(this.year(),0,1);break;case"quarter":t=s(this.year(),this.month()-this.month()%3,1);break;case"month":t=s(this.year(),this.month(),1);break;case"week":t=s(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=s(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=s(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=cg(t+(this._isUTC?0:this.utcOffset()*lg),wb);break;case"minute":t=this._d.valueOf(),t-=cg(t,lg);break;case"second":t=this._d.valueOf(),t-=cg(t,xb);break}return this._d.setTime(t),Rs.updateOffset(this,!0),this}function B7(e){var t,s;if(e=Fc(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(s=this._isUTC?vP:yP,e){case"year":t=s(this.year()+1,0,1)-1;break;case"quarter":t=s(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=s(this.year(),this.month()+1,1)-1;break;case"week":t=s(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=s(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=s(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=wb-cg(t+(this._isUTC?0:this.utcOffset()*lg),wb)-1;break;case"minute":t=this._d.valueOf(),t+=lg-cg(t,lg)-1;break;case"second":t=this._d.valueOf(),t+=xb-cg(t,xb)-1;break}return this._d.setTime(t),Rs.updateOffset(this,!0),this}function F7(){return this._d.valueOf()-(this._offset||0)*6e4}function z7(){return Math.floor(this.valueOf()/1e3)}function U7(){return new Date(this.valueOf())}function V7(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function j7(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function q7(){return this.isValid()?this.toISOString():null}function H7(){return CC(this)}function G7(){return Rp({},$n(this))}function W7(){return $n(this).overflow}function Y7(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Js("N",0,0,"eraAbbr");Js("NN",0,0,"eraAbbr");Js("NNN",0,0,"eraAbbr");Js("NNNN",0,0,"eraName");Js("NNNNN",0,0,"eraNarrow");Js("y",["y",1],"yo","eraYear");Js("y",["yy",2],0,"eraYear");Js("y",["yyy",3],0,"eraYear");Js("y",["yyyy",4],0,"eraYear");Ns("N",zC);Ns("NN",zC);Ns("NNN",zC);Ns("NNNN",iV);Ns("NNNNN",oV);jr(["N","NN","NNN","NNNN","NNNNN"],function(e,t,s,n){var r=s._locale.erasParse(e,n,s._strict);r?$n(s).era=r:$n(s).invalidEra=e});Ns("y",Fg);Ns("yy",Fg);Ns("yyy",Fg);Ns("yyyy",Fg);Ns("yo",aV);jr(["y","yy","yyy","yyyy"],va);jr(["yo"],function(e,t,s,n){var r;s._locale._eraYearOrdinalRegex&&(r=e.match(s._locale._eraYearOrdinalRegex)),s._locale.eraYearOrdinalParse?t[va]=s._locale.eraYearOrdinalParse(e,r):t[va]=parseInt(e,10)});function Z7(e,t){var s,n,r,a=this._eras||Th("en")._eras;for(s=0,n=a.length;s<n;++s){switch(typeof a[s].since){case"string":r=Rs(a[s].since).startOf("day"),a[s].since=r.valueOf();break}switch(typeof a[s].until){case"undefined":a[s].until=1/0;break;case"string":r=Rs(a[s].until).startOf("day").valueOf(),a[s].until=r.valueOf();break}}return a}function X7(e,t,s){var n,r,a=this.eras(),o,d,p;for(e=e.toUpperCase(),n=0,r=a.length;n<r;++n)if(o=a[n].name.toUpperCase(),d=a[n].abbr.toUpperCase(),p=a[n].narrow.toUpperCase(),s)switch(t){case"N":case"NN":case"NNN":if(d===e)return a[n];break;case"NNNN":if(o===e)return a[n];break;case"NNNNN":if(p===e)return a[n];break}else if([o,d,p].indexOf(e)>=0)return a[n]}function K7(e,t){var s=e.since<=e.until?1:-1;return t===void 0?Rs(e.since).year():Rs(e.since).year()+(t-e.offset)*s}function J7(){var e,t,s,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(s=this.clone().startOf("day").valueOf(),n[e].since<=s&&s<=n[e].until||n[e].until<=s&&s<=n[e].since)return n[e].name;return""}function Q7(){var e,t,s,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(s=this.clone().startOf("day").valueOf(),n[e].since<=s&&s<=n[e].until||n[e].until<=s&&s<=n[e].since)return n[e].narrow;return""}function eV(){var e,t,s,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(s=this.clone().startOf("day").valueOf(),n[e].since<=s&&s<=n[e].until||n[e].until<=s&&s<=n[e].since)return n[e].abbr;return""}function tV(){var e,t,s,n,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e)if(s=r[e].since<=r[e].until?1:-1,n=this.clone().startOf("day").valueOf(),r[e].since<=n&&n<=r[e].until||r[e].until<=n&&n<=r[e].since)return(this.year()-Rs(r[e].since).year())*s+r[e].offset;return this.year()}function sV(e){return xr(this,"_erasNameRegex")||UC.call(this),e?this._erasNameRegex:this._erasRegex}function nV(e){return xr(this,"_erasAbbrRegex")||UC.call(this),e?this._erasAbbrRegex:this._erasRegex}function rV(e){return xr(this,"_erasNarrowRegex")||UC.call(this),e?this._erasNarrowRegex:this._erasRegex}function zC(e,t){return t.erasAbbrRegex(e)}function iV(e,t){return t.erasNameRegex(e)}function oV(e,t){return t.erasNarrowRegex(e)}function aV(e,t){return t._eraYearOrdinalRegex||Fg}function UC(){var e=[],t=[],s=[],n=[],r,a,o=this.eras();for(r=0,a=o.length;r<a;++r)t.push(Ol(o[r].name)),e.push(Ol(o[r].abbr)),s.push(Ol(o[r].narrow)),n.push(Ol(o[r].name)),n.push(Ol(o[r].abbr)),n.push(Ol(o[r].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+s.join("|")+")","i")}Js(0,["gg",2],0,function(){return this.weekYear()%100});Js(0,["GG",2],0,function(){return this.isoWeekYear()%100});function bx(e,t){Js(0,[e,e.length],0,t)}bx("gggg","weekYear");bx("ggggg","weekYear");bx("GGGG","isoWeekYear");bx("GGGGG","isoWeekYear");Ca("weekYear","gg");Ca("isoWeekYear","GG");Ia("weekYear",1);Ia("isoWeekYear",1);Ns("G",mx);Ns("g",mx);Ns("GG",pi,Vl);Ns("gg",pi,Vl);Ns("GGGG",kC,EC);Ns("gggg",kC,EC);Ns("GGGGG",fx,hx);Ns("ggggg",fx,hx);Jv(["gggg","ggggg","GGGG","GGGGG"],function(e,t,s,n){t[n.substr(0,2)]=jn(e)});Jv(["gg","GG"],function(e,t,s,n){t[n]=Rs.parseTwoDigitYear(e)});function lV(e){return bP.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function cV(e){return bP.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function uV(){return _h(this.year(),1,4)}function dV(){return _h(this.isoWeekYear(),1,4)}function hV(){var e=this.localeData()._week;return _h(this.year(),e.dow,e.doy)}function pV(){var e=this.localeData()._week;return _h(this.weekYear(),e.dow,e.doy)}function bP(e,t,s,n,r){var a;return e==null?xv(this,n,r).year:(a=_h(e,n,r),t>a&&(t=a),fV.call(this,e,t,s,n,r))}function fV(e,t,s,n,r){var a=Qk(e,t,s,n,r),o=bv(a.year,0,a.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}Js("Q",0,"Qo","quarter");Ca("quarter","Q");Ia("quarter",7);Ns("Q",jk);jr("Q",function(e,t){t[lh]=(jn(e)-1)*3});function mV(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}Js("D",["DD",2],"Do","date");Ca("date","D");Ia("date",9);Ns("D",pi);Ns("DD",pi,Vl);Ns("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});jr(["D","DD"],td);jr("Do",function(e,t){t[td]=jn(e.match(pi)[0])});var xP=Bg("Date",!0);Js("DDD",["DDDD",3],"DDDo","dayOfYear");Ca("dayOfYear","DDD");Ia("dayOfYear",4);Ns("DDD",px);Ns("DDDD",qk);jr(["DDD","DDDD"],function(e,t,s){s._dayOfYear=jn(e)});function _V(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}Js("m",["mm",2],0,"minute");Ca("minute","m");Ia("minute",14);Ns("m",pi);Ns("mm",pi,Vl);jr(["m","mm"],gu);var gV=Bg("Minutes",!1);Js("s",["ss",2],0,"second");Ca("second","s");Ia("second",15);Ns("s",pi);Ns("ss",pi,Vl);jr(["s","ss"],ch);var yV=Bg("Seconds",!1);Js("S",0,0,function(){return~~(this.millisecond()/100)});Js(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Js(0,["SSS",3],0,"millisecond");Js(0,["SSSS",4],0,function(){return this.millisecond()*10});Js(0,["SSSSS",5],0,function(){return this.millisecond()*100});Js(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Js(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Js(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Js(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});Ca("millisecond","ms");Ia("millisecond",16);Ns("S",px,jk);Ns("SS",px,Vl);Ns("SSS",px,qk);var $p,wP;for($p="SSSS";$p.length<=9;$p+="S")Ns($p,Fg);function vV(e,t){t[am]=jn(("0."+e)*1e3)}for($p="S";$p.length<=9;$p+="S")jr($p,vV);wP=Bg("Milliseconds",!1);Js("z",0,0,"zoneAbbr");Js("zz",0,0,"zoneName");function bV(){return this._isUTC?"UTC":""}function xV(){return this._isUTC?"Coordinated Universal Time":""}var ds=Xv.prototype;ds.add=p7;ds.calendar=b7;ds.clone=x7;ds.diff=M7;ds.endOf=B7;ds.format=R7;ds.from=$7;ds.fromNow=O7;ds.to=L7;ds.toNow=N7;ds.get=Sz;ds.invalidAt=W7;ds.isAfter=w7;ds.isBefore=S7;ds.isBetween=C7;ds.isSame=I7;ds.isSameOrAfter=T7;ds.isSameOrBefore=A7;ds.isValid=H7;ds.lang=mP;ds.locale=fP;ds.localeData=_P;ds.max=HU;ds.min=qU;ds.parsingFlags=G7;ds.set=Cz;ds.startOf=D7;ds.subtract=f7;ds.toArray=V7;ds.toObject=j7;ds.toDate=U7;ds.toISOString=k7;ds.inspect=P7;typeof Symbol<"u"&&Symbol.for!=null&&(ds[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ds.toJSON=q7;ds.toString=E7;ds.unix=z7;ds.valueOf=F7;ds.creationData=Y7;ds.eraName=J7;ds.eraNarrow=Q7;ds.eraAbbr=eV;ds.eraYear=tV;ds.year=Jk;ds.isLeapYear=jz;ds.weekYear=lV;ds.isoWeekYear=cV;ds.quarter=ds.quarters=mV;ds.month=Xk;ds.daysInMonth=zz;ds.week=ds.weeks=Zz;ds.isoWeek=ds.isoWeeks=Xz;ds.weeksInYear=hV;ds.weeksInWeekYear=pV;ds.isoWeeksInYear=uV;ds.isoWeeksInISOWeekYear=dV;ds.date=xP;ds.day=ds.days=cU;ds.weekday=uU;ds.isoWeekday=dU;ds.dayOfYear=_V;ds.hour=ds.hours=yU;ds.minute=ds.minutes=gV;ds.second=ds.seconds=yV;ds.millisecond=ds.milliseconds=wP;ds.utcOffset=e7;ds.utc=s7;ds.local=n7;ds.parseZone=r7;ds.hasAlignedHourOffset=i7;ds.isDST=o7;ds.isLocal=l7;ds.isUtcOffset=c7;ds.isUtc=uP;ds.isUTC=uP;ds.zoneAbbr=bV;ds.zoneName=xV;ds.dates=Bc("dates accessor is deprecated. Use date instead.",xP);ds.months=Bc("months accessor is deprecated. Use month instead",Xk);ds.years=Bc("years accessor is deprecated. Use year instead",Jk);ds.zone=Bc("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",t7);ds.isDSTShifted=Bc("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",a7);function wV(e){return hi(e*1e3)}function SV(){return hi.apply(null,arguments).parseZone()}function SP(e){return e}var wr=TC.prototype;wr.calendar=cz;wr.longDateFormat=pz;wr.invalidDate=mz;wr.ordinal=yz;wr.preparse=SP;wr.postformat=SP;wr.relativeTime=bz;wr.pastFuture=xz;wr.set=az;wr.eras=Z7;wr.erasParse=X7;wr.erasConvertYear=K7;wr.erasAbbrRegex=nV;wr.erasNameRegex=sV;wr.erasNarrowRegex=rV;wr.months=Nz;wr.monthsShort=Dz;wr.monthsParse=Fz;wr.monthsRegex=Vz;wr.monthsShortRegex=Uz;wr.week=Hz;wr.firstDayOfYear=Yz;wr.firstDayOfWeek=Wz;wr.weekdays=rU;wr.weekdaysMin=oU;wr.weekdaysShort=iU;wr.weekdaysParse=lU;wr.weekdaysRegex=hU;wr.weekdaysShortRegex=pU;wr.weekdaysMinRegex=fU;wr.isPM=_U;wr.meridiem=vU;function Sb(e,t,s,n){var r=Th(),a=md().set(n,t);return r[s](a,e)}function CP(e,t,s){if(vh(e)&&(t=e,e=void 0),e=e||"",t!=null)return Sb(e,t,s,"month");var n,r=[];for(n=0;n<12;n++)r[n]=Sb(e,n,s,"month");return r}function VC(e,t,s,n){typeof e=="boolean"?(vh(t)&&(s=t,t=void 0),t=t||""):(t=e,s=t,e=!1,vh(t)&&(s=t,t=void 0),t=t||"");var r=Th(),a=e?r._week.dow:0,o,d=[];if(s!=null)return Sb(t,(s+a)%7,n,"day");for(o=0;o<7;o++)d[o]=Sb(t,(o+a)%7,n,"day");return d}function CV(e,t){return CP(e,t,"months")}function IV(e,t){return CP(e,t,"monthsShort")}function TV(e,t,s){return VC(e,t,s,"weekdays")}function AV(e,t,s){return VC(e,t,s,"weekdaysShort")}function MV(e,t,s){return VC(e,t,s,"weekdaysMin")}Fp("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,s=jn(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+s}});Rs.lang=Bc("moment.lang is deprecated. Use moment.locale instead.",Fp);Rs.langData=Bc("moment.langData is deprecated. Use moment.localeData instead.",Th);var eh=Math.abs;function EV(){var e=this._data;return this._milliseconds=eh(this._milliseconds),this._days=eh(this._days),this._months=eh(this._months),e.milliseconds=eh(e.milliseconds),e.seconds=eh(e.seconds),e.minutes=eh(e.minutes),e.hours=eh(e.hours),e.months=eh(e.months),e.years=eh(e.years),this}function IP(e,t,s,n){var r=Cu(t,s);return e._milliseconds+=n*r._milliseconds,e._days+=n*r._days,e._months+=n*r._months,e._bubble()}function kV(e,t){return IP(this,e,t,1)}function PV(e,t){return IP(this,e,t,-1)}function aA(e){return e<0?Math.floor(e):Math.ceil(e)}function RV(){var e=this._milliseconds,t=this._days,s=this._months,n=this._data,r,a,o,d,p;return e>=0&&t>=0&&s>=0||e<=0&&t<=0&&s<=0||(e+=aA(ZS(s)+t)*864e5,t=0,s=0),n.milliseconds=e%1e3,r=Ic(e/1e3),n.seconds=r%60,a=Ic(r/60),n.minutes=a%60,o=Ic(a/60),n.hours=o%24,t+=Ic(o/24),p=Ic(TP(t)),s+=p,t-=aA(ZS(p)),d=Ic(s/12),s%=12,n.days=t,n.months=s,n.years=d,this}function TP(e){return e*4800/146097}function ZS(e){return e*146097/4800}function $V(e){if(!this.isValid())return NaN;var t,s,n=this._milliseconds;if(e=Fc(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,s=this._months+TP(t),e){case"month":return s;case"quarter":return s/3;case"year":return s/12}else switch(t=this._days+Math.round(ZS(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function OV(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+jn(this._months/12)*31536e6:NaN}function Ah(e){return function(){return this.as(e)}}var LV=Ah("ms"),NV=Ah("s"),DV=Ah("m"),BV=Ah("h"),FV=Ah("d"),zV=Ah("w"),UV=Ah("M"),VV=Ah("Q"),jV=Ah("y");function qV(){return Cu(this)}function HV(e){return e=Fc(e),this.isValid()?this[e+"s"]():NaN}function Pm(e){return function(){return this.isValid()?this._data[e]:NaN}}var GV=Pm("milliseconds"),WV=Pm("seconds"),YV=Pm("minutes"),ZV=Pm("hours"),XV=Pm("days"),KV=Pm("months"),JV=Pm("years");function QV(){return Ic(this.days()/7)}var rh=Math.round,J_={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function e9(e,t,s,n,r){return r.relativeTime(t||1,!!s,e,n)}function t9(e,t,s,n){var r=Cu(e).abs(),a=rh(r.as("s")),o=rh(r.as("m")),d=rh(r.as("h")),p=rh(r.as("d")),y=rh(r.as("M")),v=rh(r.as("w")),C=rh(r.as("y")),I=a<=s.ss&&["s",a]||a<s.s&&["ss",a]||o<=1&&["m"]||o<s.m&&["mm",o]||d<=1&&["h"]||d<s.h&&["hh",d]||p<=1&&["d"]||p<s.d&&["dd",p];return s.w!=null&&(I=I||v<=1&&["w"]||v<s.w&&["ww",v]),I=I||y<=1&&["M"]||y<s.M&&["MM",y]||C<=1&&["y"]||["yy",C],I[2]=t,I[3]=+e>0,I[4]=n,e9.apply(null,I)}function s9(e){return e===void 0?rh:typeof e=="function"?(rh=e,!0):!1}function n9(e,t){return J_[e]===void 0?!1:t===void 0?J_[e]:(J_[e]=t,e==="s"&&(J_.ss=t-1),!0)}function r9(e,t){if(!this.isValid())return this.localeData().invalidDate();var s=!1,n=J_,r,a;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(s=e),typeof t=="object"&&(n=Object.assign({},J_,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),r=this.localeData(),a=t9(this,!s,n,r),s&&(a=r.pastFuture(+this,a)),r.postformat(a)}var eS=Math.abs;function q_(e){return(e>0)-(e<0)||+e}function xx(){if(!this.isValid())return this.localeData().invalidDate();var e=eS(this._milliseconds)/1e3,t=eS(this._days),s=eS(this._months),n,r,a,o,d=this.asSeconds(),p,y,v,C;return d?(n=Ic(e/60),r=Ic(n/60),e%=60,n%=60,a=Ic(s/12),s%=12,o=e?e.toFixed(3).replace(/\.?0+$/,""):"",p=d<0?"-":"",y=q_(this._months)!==q_(d)?"-":"",v=q_(this._days)!==q_(d)?"-":"",C=q_(this._milliseconds)!==q_(d)?"-":"",p+"P"+(a?y+a+"Y":"")+(s?y+s+"M":"")+(t?v+t+"D":"")+(r||n||e?"T":"")+(r?C+r+"H":"")+(n?C+n+"M":"")+(e?C+o+"S":"")):"P0D"}var cr=vx.prototype;cr.isValid=XU;cr.abs=EV;cr.add=kV;cr.subtract=PV;cr.as=$V;cr.asMilliseconds=LV;cr.asSeconds=NV;cr.asMinutes=DV;cr.asHours=BV;cr.asDays=FV;cr.asWeeks=zV;cr.asMonths=UV;cr.asQuarters=VV;cr.asYears=jV;cr.valueOf=OV;cr._bubble=RV;cr.clone=qV;cr.get=HV;cr.milliseconds=GV;cr.seconds=WV;cr.minutes=YV;cr.hours=ZV;cr.days=XV;cr.weeks=QV;cr.months=KV;cr.years=JV;cr.humanize=r9;cr.toISOString=xx;cr.toString=xx;cr.toJSON=xx;cr.locale=fP;cr.localeData=_P;cr.toIsoString=Bc("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",xx);cr.lang=mP;Js("X",0,0,"unix");Js("x",0,0,"valueOf");Ns("x",mx);Ns("X",Tz);jr("X",function(e,t,s){s._d=new Date(parseFloat(e)*1e3)});jr("x",function(e,t,s){s._d=new Date(jn(e))});//! moment.js
Rs.version="2.29.4";iz(hi);Rs.fn=ds;Rs.min=GU;Rs.max=WU;Rs.now=YU;Rs.utc=md;Rs.unix=wV;Rs.months=CV;Rs.isDate=Zv;Rs.locale=Fp;Rs.invalid=ux;Rs.duration=Cu;Rs.isMoment=Su;Rs.weekdays=TV;Rs.parseZone=SV;Rs.localeData=Th;Rs.isDuration=W1;Rs.monthsShort=IV;Rs.weekdaysMin=MV;Rs.defineLocale=OC;Rs.updateLocale=SU;Rs.locales=CU;Rs.weekdaysShort=AV;Rs.normalizeUnits=Fc;Rs.relativeTimeRounding=s9;Rs.relativeTimeThreshold=n9;Rs.calendarFormat=v7;Rs.prototype=ds;Rs.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const pa=Object.freeze({ALL:Symbol.for("slds-vue-expression-all"),ANY:Symbol.for("slds-vue-expression-any"),CUSTOM:Symbol.for("slds-vue-expression-custom")}),lA=()=>({addCondition:"Add Condition",customLogic:"Custom Logic",takeAction:"Take Action When",title:"Conditions",modeAll:"All Conditions Are Met",modeAny:"Any Condition Is Met",modeCustom:"Custom Logic Is Met",and:"AND",or:"OR",customLogicPlaceholder:"e.g. (1 AND 2) OR 3"}),i9={name:"Expression",components:{Button:Tn,TextInput:Ko,Picklist:Qi},mixins:[Xo],props:{customLogicListeners:{type:Object,default:()=>{}},disableA11y:Boolean,disableLogic:Boolean,labels:{type:Object,default:()=>lA()},mode:{type:Symbol,default:pa.ALL,validator(e){const t=Object.values(pa).includes(e);return t||console.warn("Mode prop must be equal to one of the enumerated values from the exported Expression.Modes module."),t}},modes:{type:Array,default:()=>[pa.ALL,pa.ANY,pa.CUSTOM],validator(){return!0}},noGutter:Boolean,noLogic:Boolean,noTitle:Boolean,customLogic:{type:String,default:""},customLogicErrors:{type:Array,default:()=>[]}},data(){return{registeredConditions:{},localMode:this.$props.mode,addConditionFlag:!1,mergedLabels:{...lA(),...this.$props.labels}}},computed:{modeOptions(){return this.$props.modes.map(e=>({id:e,title:this.modeLabels[e]}))},modeLabels(){return{[pa.ALL]:this.mergedLabels.modeAll,[pa.ANY]:this.mergedLabels.modeAny,[pa.CUSTOM]:this.mergedLabels.modeCustom}},showCustomLogicInput(){return this.$props.mode===pa.CUSTOM},numConditions(){return Object.keys(this.registeredConditions).length}},watch:{numConditions(e,t){if(this.updateConditions(),this.addConditionFlag&&e>t){const s=Object.keys(this.registeredConditions)[e-1];this.$nextTick(this.registeredConditions[s].focusResource)}},"$props.mode":{handler(e){this.localMode=e}},"$props.noGutter":{handler(){this.updateConditions()}},localMode(){this.updateConditions()}},mounted(){this.$el.addEventListener("register-condition",this.onRegisterCondition)},methods:{registerCondition(e,t){this.registeredConditions[e]=t},unregisterCondition(e){this.updateFocus(e),delete this.registeredConditions[e]},updateFocus(e){const t=Object.keys(this.registeredConditions),s=t.indexOf(e);let n;s===t.length-1?n=this.registeredConditions[t[s-1]]:n=this.registeredConditions[t[s+1]],n&&n.focusResource&&n.focusResource()},addCondition(){this.addConditionFlag=!0,this.$emit("add-condition")},updateConditions(){Object.entries(this.registeredConditions).forEach(([,e],t)=>{switch(e.setGutterLabel(null),this.localMode){case pa.ALL:t>0&&e.setGutterLabel(this.mergedLabels.and);break;case pa.ANY:t>0&&e.setGutterLabel(this.mergedLabels.or);break;case pa.CUSTOM:e.setGutterLabel(t+1);break}e.setGutterVisibility(!this.$props.noGutter),e.setIndex(t),e.setNumSiblings(this.numConditions-1)})}}},o9={class:"slds-expression"},a9={key:0,class:"slds-expression__title"},l9={key:1,class:"slds-expression__options"},c9={key:2,class:"slds-expression__custom-logic"},u9={class:"slds-expression__buttons"};function d9(e,t,s,n,r,a){const o=pe("Picklist"),d=pe("TextInput"),p=pe("Button");return L(),X("div",o9,[s.noTitle?$e("",!0):(L(),X("h2",a9,Pe(e.decodeHtml(r.mergedLabels.title)),1)),e.$props.noLogic?$e("",!0):(L(),X("div",l9,[de(o,{modelValue:r.localMode,"onUpdate:modelValue":[t[0]||(t[0]=y=>r.localMode=y),t[1]||(t[1]=y=>e.$emit("update:mode",y))],disabled:e.$props.disableLogic,labels:{name:r.mergedLabels.takeAction},options:a.modeOptions},null,8,["modelValue","disabled","labels","options"])])),a.showCustomLogicInput?(L(),X("div",c9,[de(d,Ji({errors:e.$props.customLogicErrors,modelValue:e.$props.customLogic,labels:{name:r.mergedLabels.customLogic,placeholder:r.mergedLabels.customLogicPlaceholder}},id(e.$props.customLogicListeners),{onInput:t[2]||(t[2]=y=>e.$emit("update:customLogic",y.target.value))}),null,16,["errors","modelValue","labels"])])):$e("",!0),k("ul",null,[js(e.$slots,"default",{ref:"default"})]),k("div",u9,[de(p,{variant:"neutral",iconCategory:"utility",iconName:"add",label:r.mergedLabels.addCondition,title:r.mergedLabels.addCondition,onClick:a.addCondition},null,8,["label","title","onClick"])])])}const h9=os(i9,[["render",d9]]),p9=()=>({prompt:"Okay",closeTitle:"Close",closeAssistiveText:"Close"}),f9={name:"Modal",components:{ButtonIcon:vn},mixins:[Xo],props:{bodyless:Boolean,detach:{type:Boolean,default:!0},headless:Boolean,hideCloseButton:Boolean,footless:Boolean,labels:{type:Object,default:()=>{}},prompt:Boolean,size:{type:String,default:"medium",validator:e=>{const t=["small","base","medium","large","x-large"];return!e||!t.includes(e)?(console.error(`Valid size prop values are ${t.join(", ")}`),!1):!0}},title:{type:String,required:!0}},data(){return{container:null,focusableElements:[],modalId:Vn(),triggerElement:null}},computed:{computedLabels(){const e=Object.hasOwn(this,"$__getGlobalLabels")?this.$__getGlobalLabels().modal||{}:{};return{...p9(),...e,...this.$props.labels}},headerClasses(){const e=[];return this.prompt&&e.push("slds-theme_alert-texture slds-theme_error"),this.headless&&e.push("slds-modal__header_empty"),e},footerClasses(){const e=[];return this.prompt&&e.push("slds-theme_default"),this.bodyless&&e.push("footer-bodyless"),e},modalClass(){const e=[];return this.size!=="base"&&e.push(`slds-modal_${this.size}`),this.prompt&&e.push("slds-modal_prompt"),e}},mounted(){this.triggerElement=document.activeElement||document.body,this.detach&&(this._detach(),Array.from(this.container.parentNode.children).filter(e=>e!==this.container&&!(e instanceof HTMLScriptElement)).forEach(e=>{e.setAttribute("aria-hidden",!0)})),this.getFocusableElements(),this.setFocusOnFirstFocusableItem(),this.$emit("mounted")},beforeUnmount(){this.container&&(this.container.remove(),this.container=null),this.triggerElement.focus()},updated(){this.getFocusableElements()},methods:{_detach(){this.container=document.createElement("div"),this.container.className=`slds-scope ${this.$el.className}`,this.container.appendChild(this.$el),document.body.appendChild(this.container)},getFocusableElements(){this.focusableElements=[...this.$refs.section.querySelectorAll("a, button, input, textarea, select, details")].filter(e=>!e.hasAttribute("disabled")&&e.tabIndex!==-1)},setFocusOnFirstFocusableItem(){!this.focusableElements.length||(this.focusableElements.length>1&&this.focusableElements[0]===this.$refs.closeButton.$el?this.focusableElements[1].focus():this.focusableElements[0].focus())},tab(e){!this.focusableElements.length||this.focusableElements[this.focusableElements.length-1]===document.activeElement&&(e.preventDefault(),this.focusableElements[0].focus())},shiftTab(e){!this.focusableElements.length||this.focusableElements[0]===document.activeElement&&(e.preventDefault(),this.focusableElements[this.focusableElements.length-1].focus())}}},m9={appear:"",name:"fade"},_9=["role","tabindex","aria-labelledby","aria-describedby"],g9={class:"slds-modal__container"},y9=["id"],v9=["id"],b9={key:1},x9={ref:"backdrop",key:"backdrop",class:"slds-backdrop-custom"};function w9(e,t,s,n,r,a){const o=pe("ButtonIcon");return L(),X("div",m9,[k("section",{ref:"section",key:"section",role:s.prompt?"alertdialog":"dialog",tabindex:s.prompt?"0":null,class:$t(["slds-modal-custom",a.modalClass]),"aria-labelledby":s.headless?null:`modal-heading-${r.modalId}`,"aria-describedby":`modal-content-${r.modalId}`,onKeydown:[t[3]||(t[3]=Zs(Os((...d)=>a.tab&&a.tab(...d),["exact"]),["tab"])),t[4]||(t[4]=Zs(Os((...d)=>a.shiftTab&&a.shiftTab(...d),["shift"]),["tab"])),t[5]||(t[5]=Zs(Os(d=>e.$emit("close"),["stop"]),["esc"]))]},[k("div",g9,[k("header",{class:$t([a.headerClasses,"slds-modal__header"])},[s.hideCloseButton?$e("",!0):(L(),Ge(o,{key:0,ref:"closeButton",iconCategory:"utility",iconName:"close",iconSize:"large",class:"slds-modal__close slds-button_icon-inverse",assistiveText:a.computedLabels.closeAssistiveText,title:a.computedLabels.closeTitle,onClick:t[0]||(t[0]=d=>e.$emit("close"))},null,8,["assistiveText","title"])),s.headless?$e("",!0):(L(),X("h2",{key:1,id:`modal-heading-${r.modalId}`,class:"slds-text-heading_medium slds-hyphenate"},Pe(e.decodeHtml(s.title)),9,y9)),s.headless?$e("",!0):js(e.$slots,"tagline",{key:2},void 0,!0)],2),s.bodyless?$e("",!0):(L(),X("div",{key:0,id:`modal-content-${r.modalId}`,ref:"content",class:"slds-modal__content slds-p-around_medium slds-is-relative",onKeydown:t[1]||(t[1]=Zs(d=>e.$emit("submit"),["enter"]))},[js(e.$slots,"content",{},()=>[es("default content")],!0)],40,v9)),s.footless?$e("",!0):(L(),X("footer",{key:1,class:$t(["slds-modal__footer",a.footerClasses])},[js(e.$slots,"footer",{},()=>[s.prompt?(L(),X("button",{key:0,class:"slds-button slds-button_neutral",onClick:t[2]||(t[2]=d=>e.$emit("close"))},Pe(a.computedLabels.prompt),1)):(L(),X("span",b9," default footer "))],!0)],2))])],42,_9),k("div",x9,null,512)])}const zc=os(f9,[["render",w9],["__scopeId","data-v-7777abc4"]]),Z1={top:"top","top left":"top-end","top right":"top-start",right:"right","right top":"right-end","right bottom":"right-start",bottom:"bottom","bottom left":"bottom-end","bottom right":"bottom-start",left:"left","left top":"left-end","left bottom":"left-start"},S9=()=>({closeTitle:"Close Dialog",closeAssistiveText:"Close Dialog"}),cA=e=>Object.keys(Z1).find(t=>t===e),C9={name:"Popover",description:"Renders a SLDS-themed popover dialog",components:{ButtonIcon:vn,Icon:yn},directives:{"click-outside":cC},props:{alignment:{type:String,default:"top",validator(e){return cA(e)}},ariaLabel:{type:String,default:null},bindTo:{type:HTMLElement,default:null},bindToRect:{type:Object,default:()=>{},validator:e=>e.x&&e.y},closeOnClickOutside:Boolean,labels:{type:Object,default:()=>{}},nubbinREM:{type:Number,default:1.8},overflowPadding:{type:Number,default:5},position:{type:String,default:"fixed",validator(e){return["absolute","fixed"].find(t=>t===e)}},scrollElementsToIgnore:{type:Array,default:()=>[]},theme:{type:String,default:"base",validator:e=>{const t=["base","error","warning"],s=!e||t.includes(e);return s||console.error(`Valid theme prop values are ${t.join(", ")}`),s}},width:{type:String,default:"small",validator:e=>{const t=["small","medium","large","x-large","full-width"],s=!e||t.includes(e);return s||console.error(`Valid width prop values are ${t.join(", ")}`),s}}},data(){return{container:null,el:null,focusableElements:[],triggerElement:null,popoverId:Vn(),observer:null,popperInstance:()=>{}}},computed:{computedLabels(){const e=Object.hasOwn(this,"$__getGlobalLabels")?this.$__getGlobalLabels().popover||{}:{};return{...S9(),...e,...this.$props.labels}},widthClass(){return`slds-popover_${this.width}`},popoverClass(){return this.theme!=="base"?`slds-popover_${this.theme}`:""},showHeader(){return this.$slots.header||this.$slots.custom},showFooter(){return this.$slots.footer},clickOutsideOptions(){return{active:this.closeOnClickOutside,handler:this.doHide}}},watch:{alignment(){cA(this.$props.alignment)&&this.popperInstance.setOptions({placement:Z1[this.$props.alignment]})},width(){this.popperInstance.setOptions({placement:Z1[this.$props.alignment]})},"$props.bindTo":{handler(){!this.$props.bindTo||(this.popperInstance.state.elements.reference=this.$props.bindTo,this.popperInstance.update())}}},mounted(){this.triggerElement=this.bindTo||document.activeElement||document.body,this.getFocusableElements(),this.popperInstance=gC(this.triggerElement,this.$refs.popover,{strategy:this.position,placement:Z1[this.alignment],modifiers:[{name:"offset",options:{offset:({placement:e})=>e.includes("end")?[16,16]:e.includes("start")?[-16,16]:[0,16]}},{name:"preventOverflow",options:{padding:this.$props.overflowPadding}}]}),this.observer=new MutationObserver(()=>this.popperInstance.update()),this.observer.observe(this.triggerElement,{attributes:!0,childList:!0,subtree:!0}),this.focusableElements.length&&(this.focusableElements.length>1&&this.focusableElements[0]===this.$refs.closeButton?this.focusableElements[1].focus():this.focusableElements[0].focus())},updated(){this.getFocusableElements()},beforeUnmount(){this.destroy()},methods:{doHide(e){if(e)if(e.type!=="scroll"){if(this.bindTo&&this.bindTo.contains(e.target))return}else{const t=this.$refs.popover.contains(e.target),s=this.scrollElementsToIgnore.includes(e.target)||this.scrollElementsToIgnore.some(n=>n&&n.contains(e.target));if(t||s)return}this.$emit("close",e)},destroy(){this.el&&this.el.remove(),this.container&&this.container.remove(),this.el=null,this.container=null,window.removeEventListener("scroll",this.doHide,!0),this.triggerElement.focus(),this.observer.disconnect(),this.observer=null},getFocusableElements(){this.focusableElements=[...this.$refs.popover.querySelectorAll('a, button, input, textarea, select, details, [tabindex]:not([tabindex="-1"])')].filter(e=>!e.hasAttribute("disabled"))},tab(e){!this.focusableElements.length||this.focusableElements[this.focusableElements.length-1]===document.activeElement&&(e.preventDefault(),this.focusableElements[0].focus())},shiftTab(e){!this.focusableElements.length||this.focusableElements[0]===document.activeElement&&(e.preventDefault(),this.focusableElements[this.focusableElements.length-1].focus())}}},jC=e=>(Nr("data-v-ee69ade2"),e=e(),Dr(),e),I9=["aria-describedby","aria-labelledby","aria-label"],T9=["id"],A9={class:"slds-media"},M9={class:"slds-media__body"},E9=["id"],k9={class:"slds-text-heading_small"},P9=jC(()=>k("p",null,"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.",-1)),R9=["id"],$9={class:"slds-media slds-media_center slds-has-flexi-truncate"},O9={class:"slds-media__figure"},L9={class:"slds-media__body"},N9={class:"slds-truncate slds-text-heading_medium"},D9=["id"],B9=jC(()=>k("p",null,"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.",-1)),F9={key:2,class:"slds-popover__footer"},z9=jC(()=>k("div",{id:"arrow","data-popper-arrow":""},null,-1));function U9(e,t,s,n,r,a){const o=pe("ButtonIcon"),d=pe("Icon"),p=mg("click-outside");return Mn((L(),X("section",{ref:"popover",role:"dialog","aria-describedby":`dialog-body-${r.popoverId}`,"aria-labelledby":a.showHeader?`dialog-heading-${r.popoverId}`:null,"aria-label":s.ariaLabel,tabindex:"-1",class:$t([[a.popoverClass,a.widthClass],"slds-popover"]),onKeydown:[t[0]||(t[0]=Zs(Os((...y)=>a.tab&&a.tab(...y),["exact","stop"]),["tab"])),t[1]||(t[1]=Zs(Os((...y)=>a.shiftTab&&a.shiftTab(...y),["shift","stop"]),["tab"])),t[2]||(t[2]=Zs(Os((...y)=>a.doHide&&a.doHide(...y),["stop"]),["esc"]))]},[de(o,{ref:"closeButton",variant:s.theme==="error"?"inverse":"bare",title:a.computedLabels.closeTitle,class:"slds-float_right slds-popover__close",iconCategory:"utility",size:"small",iconName:"close",assistiveText:a.computedLabels.closeAssistiveText,onClick:Os(a.doHide,["stop"])},null,8,["variant","title","assistiveText","onClick"]),s.theme==="base"?(L(),X("div",{key:0,id:`dialog-body-${r.popoverId}`,class:"slds-popover__body"},[k("div",A9,[k("div",M9,[a.showHeader?(L(),X("header",{key:0,id:`dialog-heading-${r.popoverId}`,class:"slds-popover__header"},[js(e.$slots,"custom",{},()=>[k("h2",k9,[js(e.$slots,"header",{},void 0,!0)])],!0)],8,E9)):$e("",!0)])]),js(e.$slots,"content",{},()=>[P9],!0)],8,T9)):(L(),X(Lt,{key:1},[a.showHeader?(L(),X("header",{key:0,id:`dialog-heading-${r.popoverId}`,class:"slds-popover__header"},[k("div",$9,[js(e.$slots,"custom",{},()=>[k("div",O9,[s.theme!=="base"?(L(),Ge(d,{key:0,category:"utility",name:e.$props.theme,variant:"inverse",iconClass:["slds-icon","slds-icon_x-small"]},null,8,["name"])):$e("",!0)]),k("div",L9,[k("h2",N9,[js(e.$slots,"header",{},void 0,!0)])])],!0)])],8,R9)):$e("",!0),k("div",{id:`dialog-body-${r.popoverId}`,class:"slds-popover__body"},[js(e.$slots,"content",{},()=>[B9],!0)],8,D9)],64)),a.showFooter?(L(),X("footer",F9,[js(e.$slots,"footer",{},void 0,!0)])):$e("",!0),z9],42,I9)),[[p,void 0,a.clickOutsideOptions]])}const Uc=os(C9,[["render",U9],["__scopeId","data-v-ee69ade2"]]),V9=()=>({name:null,required:"Required"}),j9={components:{Tooltip:Fo},props:{disabled:Boolean,helpText:{type:String,default:""},invalid:Boolean,labels:{type:Object,default:()=>{}},modelValue:{type:[String,Number],default:null},options:{type:Array,required:!0},readonly:Boolean,required:Boolean},data(){return{guid:Vn()}},computed:{computedLabels(){const e=Object.hasOwn(this,"$__getGlobalLabels")?this.$__getGlobalLabels().radio||{}:{};return{...V9(),...e,...this.$props.labels}},input:{get(){return this.$props.modelValue},set(e){this.$emit("update:modelValue",e)}}}},AP=os(j9,[["__scopeId","data-v-20f14d8f"]]),q9={name:"RadioButtonGroup",extends:AP,mixins:[Xo]},H9={key:0,class:"slds-form-element__legend slds-form-element__label"},G9=["title"],W9={class:"slds-form-element__control"},Y9={key:0,class:"slds-radio_button-group"},Z9=["id","name","value","disabled","aria-describedby"],X9=["for"],K9={class:"slds-radio_faux"},J9={key:1,class:"readonly-radio-label"},Q9=["id"];function ej(e,t,s,n,r,a){const o=pe("Tooltip");return L(),X("fieldset",{class:$t([{"slds-has-error":e.$props.invalid},"slds-form-element"])},[e.computedLabels.name?(L(),X("legend",H9,[e.$props.required?(L(),X("abbr",{key:0,class:"slds-required",title:e.computedLabels.required},"*",8,G9)):$e("",!0),es(" "+Pe(e.decodeHtml(e.computedLabels.name)),1)])):$e("",!0),e.$props.helpText?(L(),Ge(o,{key:1,alignment:"top right",class:"slds-form-element__icon",text:e.$props.helpText},null,8,["text"])):$e("",!0),k("div",W9,[e.$props.readonly?(L(),X("div",J9,Pe(e.decodeHtml(e.$props.modelValue)||"\xA0"),1)):(L(),X("div",Y9,[(L(!0),X(Lt,null,As(e.options,(d,p)=>(L(),X("span",{key:p,class:"slds-button slds-radio_button"},[Mn(k("input",{id:e.guid+p,"onUpdate:modelValue":t[0]||(t[0]=y=>e.input=y),class:$t({"ma-is-selected":e.input===d.value}),name:e.guid,value:d.value,disabled:e.$props.disabled||d.disabled,"aria-describedby":e.$props.invalid?`error-${e.guid}`:null,type:"radio"},null,10,Z9),[[Ng,e.input]]),k("label",{class:"slds-radio_button__label",for:e.guid+p},[k("span",K9,Pe(e.decodeHtml(d.label)),1)],8,X9)]))),128))]))]),e.$props.invalid?(L(),X("div",{key:2,id:`error-${e.guid}`,class:"slds-form-element__help"},[js(e.$slots,"errors")],8,Q9)):$e("",!0)],2)}const tj=os(q9,[["render",ej]]),sj={name:"RadioGroup",extends:AP,mixins:[Xo]},nj={key:0,class:"slds-form-element__label"},rj=["title"],ij={key:2,class:"slds-form-element__control",style:{position:"relative"}},oj=["id","name","value","disabled","aria-describedby"],aj=["for"],lj=k("span",{class:"slds-radio_faux"},null,-1),cj={class:"slds-form-element__label"},uj={key:3,class:"slds-form-element__control readonly-radio-label"},dj=["id"];function hj(e,t,s,n,r,a){const o=pe("Tooltip");return L(),X("fieldset",{class:$t([{"slds-has-error":e.$props.invalid},"slds-form-element"])},[e.computedLabels.name?(L(),X("label",nj,[e.$props.required?(L(),X("abbr",{key:0,class:"slds-required",title:e.computedLabels.required},"*",8,rj)):$e("",!0),es(" "+Pe(e.decodeHtml(e.computedLabels.name)),1)])):$e("",!0),e.$props.helpText?(L(),Ge(o,{key:1,alignment:"top right",class:"slds-form-element__icon",text:e.$props.helpText},null,8,["text"])):$e("",!0),e.$props.readonly?(L(),X("div",uj,Pe(e.decodeHtml(e.$props.modelValue)||"\xA0"),1)):(L(),X("div",ij,[(L(!0),X(Lt,null,As(e.options,(d,p)=>(L(),X("span",{key:p,class:"slds-radio"},[Mn(k("input",{id:e.guid+p,"onUpdate:modelValue":t[0]||(t[0]=y=>e.input=y),name:e.guid,value:d.value,disabled:e.$props.disabled||d.disabled,"aria-describedby":e.$props.invalid?`error-${e.guid}`:null,type:"radio"},null,8,oj),[[Ng,e.input]]),k("label",{for:e.guid+p,class:"slds-radio__label"},[lj,k("span",cj,Pe(e.decodeHtml(d.label)),1)],8,aj)]))),128))])),e.$props.invalid?(L(),X("div",{key:4,id:`error-${e.guid}`,class:"slds-form-element__help"},[js(e.$slots,"errors")],8,dj)):$e("",!0)],2)}const pj=os(sj,[["render",hj]]),fj={name:"ScopedNotification",components:{Icon:yn},props:{theme:{type:String,default:"base",validator:e=>{const t=["base","info","success","error","warning"],s=!e||t.includes(e);return s||console.error(`Valid theme prop values are ${t.join(", ")}`),s}}},computed:{themeClass(){let e;return this.$props.theme===""||this.$props.theme==="base"?e="slds-scoped-notification_light":e=`slds-theme_${this.$props.theme}`,e}}},mj={class:"slds-media__figure"},_j={class:"slds-media__body"};function gj(e,t,s,n,r,a){const o=pe("Icon");return L(),X("div",{class:$t(["slds-scoped-notification slds-media slds-media_center",a.themeClass]),role:"status"},[k("div",mj,[js(e.$slots,"icon",{},()=>[de(o,{category:"utility",assistiveText:"info",size:"small",name:e.$props.theme==="base"?"info":e.$props.theme,variant:e.$props.theme==="base"?"default":"inverse"},null,8,["name","variant"])])]),k("div",_j,[js(e.$slots,"content")])],2)}const yj=os(fj,[["render",gj]]),Qv=new Map;Qv.set("info",{divClass:"slds-theme_info"});Qv.set("success",{divClass:"slds-theme_success"});Qv.set("warning",{divClass:"slds-theme_warning"});Qv.set("error",{divClass:"slds-theme_error"});const vj={name:"ToastContainer",components:{ButtonIcon:vn,Icon:yn},mixins:[Xo],props:{toasts:{type:Array,required:!0}},data(){return{stateMap:Qv}}},bj={class:"slds-assistive-text"},xj={class:"slds-notify__content"},wj={class:"slds-text-heading_small"},Sj={key:0};function Cj(e,t,s,n,r,a){const o=pe("Icon"),d=pe("ButtonIcon");return L(),Ge(fN,{name:"slide",tag:"div"},{default:je(()=>[(L(!0),X(Lt,null,As(s.toasts,p=>(L(),X("div",{key:p.$__id,class:$t([r.stateMap.get(p.state).divClass,"slds-notify slds-notify_toast"]),role:"status"},[k("span",bj,Pe(p.state),1),de(o,{category:"utility",name:p.state,size:"small",variant:"none",class:"slds-icon_container slds-m-right_small slds-no-flex slds-align-top"},null,8,["name"]),k("div",xj,[js(e.$slots,"default",{},()=>[k("h2",wj,Pe(e.decodeHtml(p.message)),1),p.subMessage?(L(),X("p",Sj,Pe(e.decodeHtml(p.subMessage)),1)):$e("",!0)],!0)]),de(d,{title:p.closeLabel,iconCategory:"utility",iconName:"close",iconSize:"large",variant:"inverse",class:"slds-notify__close",assistiveText:p.closeLabel,onClick:y=>e.$parent.close(p.$__id)},null,8,["title","assistiveText","onClick"])],2))),128))]),_:3})}const Ij=os(vj,[["render",Cj],["__scopeId","data-v-f8233d6c"]]),Tj={name:"Toast",components:{ToastContainer:Ij},props:{toasts:{type:Array,required:!0}},data(){return{timeoutMap:new Map,callbackMap:new Map}},computed:{topCenterToasts(){return this.toasts.filter(e=>e.position==="top-center")},topRightToasts(){return this.toasts.filter(e=>e.position==="top-right")},bottomRightToasts(){return this.toasts.filter(e=>e.position==="bottom-right")}},watch:{toasts:{handler(e){e.forEach(t=>{if(!Object.prototype.hasOwnProperty.call(t,"$__id")){t.state||(t.state="info"),t.closeLabel||(t.closeLabel="Close"),t.position||(t.position="top-center");const s=Vn();t.$__id=s,typeof t.onClose=="function"&&this.callbackMap.set(s,t.onClose),t.duration>0&&this.timeoutMap.set(s,setTimeout(this.close.bind(this,s),t.duration))}})},immediate:!0,deep:!0}},beforeUnmount(){this.timeoutMap.forEach(e=>clearTimeout(e))},methods:{close(e){this.$emit("close",e);const t=this.toasts.findIndex(n=>n.$__id===e),s=this.toasts.splice(t,1);this.$emit("input",s),this.$emit("update:toasts",s),this.timeoutMap.has(e)&&(clearTimeout(this.timeoutMap.get(e)),this.timeoutMap.delete(e)),this.callbackMap.has(e)&&this.callbackMap.get(e)()}}};function Aj(e,t,s,n,r,a){const o=pe("ToastContainer");return L(),X("div",null,[de(o,{toasts:a.topCenterToasts,class:"slds-notify_container slds-is-fixed slds-grid slds-grid_vertical slds-grid_vertical-align-center slds-grid_vertical-reverse"},null,8,["toasts"]),de(o,{toasts:a.bottomRightToasts,class:"slds-notify_container slds-is-fixed slds-grid slds-grid_vertical slds-grid_vertical-align-center notify_bottom-right slds-grid_vertical-align-end"},null,8,["toasts"]),de(o,{toasts:a.topRightToasts,class:"slds-notify_container slds-is-fixed slds-grid slds-grid_vertical slds-grid_vertical-align-center notify_top-right slds-grid_vertical-reversee"},null,8,["toasts"])])}const MP=os(Tj,[["render",Aj],["__scopeId","data-v-339e5872"]]),Mj={name:"NoAccess",props:{type:{type:String,default:"plan"}},computed:{text(){return this.type==="segment"?"To access this segment, contact its owner.":"To access this sales plan, contact its owner or your Salesforce admin."}}},Ej={class:"slds-grid slds-grid_vertical-align-center slds-grid_align-center",style:{height:"100%",background:"#fff"}},kj={class:"slds-illustration slds-illustration_small"},Pj=ex('<svg class="slds-illustration__svg" viewBox="0 0 454 212" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g transform="translate(-70.000000, -95.000000)"><g><g transform="translate(124.500000, 222.000000)"><g fill="#FFFFFF"><path vector-effect="non-scaling-stroke" d="M18.9209988,1.95433401 L33.259296,51.443436 C33.5666778,52.5043744 32.9557995,53.613617 31.8948612,53.9209988 C31.7139843,53.9734036 31.5266126,54 31.3382972,54 L2.6617028,54 C1.5571333,54 0.661702805,53.1045695 0.661702805,52 C0.661702805,51.8116846 0.688299176,51.6243129 0.74070397,51.443436 L15.0790012,1.95433401 C15.386383,0.893395645 16.4956256,0.282517358 17.556564,0.589899164 C18.2152102,0.780726338 18.7301717,1.29568777 18.9209988,1.95433401 Z"></path></g><g class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3"><polygon vector-effect="non-scaling-stroke" stroke-linejoin="round" points="17 0.323943662 34 54 -1.81721305e-12 54"></polygon><path vector-effect="non-scaling-stroke" d="M17,4.6953125 C17,43.0456294 17,62.6471919 17,63.5 C17,62.6471919 17,43.0456294 17,4.6953125 Z"></path><path vector-effect="non-scaling-stroke" d="M17,29.3239437 C22.3333333,35.7851611 25,39.1184944 25,39.3239437 C25,39.1184944 22.3333333,35.7851611 17,29.3239437 Z" stroke-linejoin="round" transform="translate(21.000000, 34.323944) scale(-1, 1) translate(-21.000000, -34.323944) "></path></g></g><g transform="translate(145.000000, 194.000000)"><g transform="translate(1.000000, 0.000000)" fill="#FFFFFF"><path vector-effect="non-scaling-stroke" d="M25.6478873,0 L50.879042,84.4273253 C51.1953215,85.4856452 50.5937789,86.5999782 49.535459,86.9162577 C49.3496374,86.9717906 49.1567264,87 48.9627843,87 L2.33299037,87 C1.22842087,87 0.332990367,86.1045695 0.332990367,85 C0.332990367,84.8060578 0.361199757,84.6131469 0.416732643,84.4273253 L25.6478873,0 Z"></path></g><g class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3"><polygon vector-effect="non-scaling-stroke" stroke-linejoin="round" points="26.5 0 52.5 87 0.5 87"></polygon><path vector-effect="non-scaling-stroke" d="M26.5,2.58642578 C26.5,61.0261034 26.5,90.9972948 26.5,92.5 C26.5,90.9972948 26.5,61.0261034 26.5,2.58642578 Z"></path><path vector-effect="non-scaling-stroke" d="M15.6478873,42 C22.314554,49.078692 25.6478873,52.7453587 25.6478873,53 C25.6478873,52.7453587 22.314554,49.078692 15.6478873,42 Z" stroke-linejoin="round"></path><path vector-effect="non-scaling-stroke" d="M27.6478873,68 C36.9812207,57.078692 41.6478873,51.7453587 41.6478873,52 C41.6478873,51.7453587 36.9812207,57.078692 27.6478873,68 Z" stroke-linejoin="round"></path></g></g><g transform="translate(404.500000, 245.000000) scale(-1, 1) translate(-404.500000, -245.000000) translate(348.000000, 226.000000)" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"><g><polyline vector-effect="non-scaling-stroke" points="0 38 47.5 0 80.5 26"></polyline><polyline vector-effect="non-scaling-stroke" points="71 17 80.5 9 113 36"></polyline></g></g><g transform="translate(72.000000, 262.500000)"><path vector-effect="non-scaling-stroke" d="M153.962142,26.4644491 C151.225735,20.0143094 144.944776,15.5029106 137.633892,15.5029106 C135.619663,15.5029106 133.683612,15.8453541 131.878328,16.4764392 C128.451481,11.1704266 122.567406,7.66985447 115.883789,7.66985447 C109.491267,7.66985447 103.830159,10.8721423 100.350851,15.7935668 C98.9589956,14.968161 97.3423157,14.4956341 95.6177606,14.4956341 C94.1083143,14.4956341 92.6815102,14.8576334 91.4157672,15.5014039 C87.9975328,6.58722215 79.5098304,0.275259875 69.5804557,0.275259875 C60.4632836,0.275259875 52.5615782,5.59684366 48.6837305,13.3681823 C46.3912034,12.266973 43.8314865,11.6515593 41.1312741,11.6515593 C32.4373504,11.6515593 25.1998844,18.0312998 23.6476214,26.4644491 L153.962142,26.4644491 Z" class="slds-illustration__fill-secondary"></path><path vector-effect="non-scaling-stroke" d="M13,25 L143,25" class="slds-illustration__stroke-secondary" stroke-width="3" stroke-linecap="round"></path><path vector-effect="non-scaling-stroke" d="M0,25 L450,25" class="slds-illustration__stroke-secondary" stroke-width="3" stroke-linecap="round"></path></g><g transform="translate(344.000000, 247.000000)"><g transform="translate(0.293436, 0.054545)"><path vector-effect="non-scaling-stroke" d="M165.428708,41.9454545 L0.0995432562,41.9454545 C0.0336614956,41.2089487 0,40.4630069 0,39.7090909 C0,26.2132599 10.7866531,15.2727273 24.0926641,15.2727273 C27.7492016,15.2727273 31.215485,16.0989227 34.3199502,17.5772977 C39.5712028,7.14424616 50.271428,0 62.6175975,0 C76.0636257,0 87.5573893,8.47383452 92.1862485,20.441159 C93.9002755,19.5768947 95.8324059,19.0909091 97.8764479,19.0909091 C100.211783,19.0909091 102.401037,19.7252784 104.285841,20.8333889 C108.997403,14.2263569 116.663488,9.92727273 125.320028,9.92727273 C138.043441,9.92727273 148.627152,19.2146805 150.834755,31.4671412 C151.487388,31.3631046 152.156394,31.3090909 152.837838,31.3090909 C159.117096,31.3090909 164.340238,35.8953699 165.428708,41.9454545 Z" class="slds-illustration__fill-secondary"></path><path vector-effect="non-scaling-stroke" d="M32.7065637,40.4454545 L173.706564,40.4454545" class="slds-illustration__stroke-secondary" stroke-width="3" stroke-linecap="round"></path></g></g><g transform="translate(105.000000, 203.000000)"><g transform="translate(106.000000, 0.000000)" fill="#FFFFFF"><polygon vector-effect="non-scaling-stroke" points="121.5 48.5 158.5 48.5 158.5 34.5 47.5 34.5 47.5 48.5 93.5 48.5 93.5 69.5 121.5 69.5 121.5 48.5"></polygon><path vector-effect="non-scaling-stroke" d="M33.9882812,0.21875 C36.5611979,0.21875 70.6126302,0.21875 136.142578,0.21875 L152.384766,11.1132813 C155.083088,16.811292 155.656656,19.677503 154.105469,19.7119141 C152.554281,19.7463252 116.293865,17.6717809 45.3242187,13.4882812 C35.1940104,4.64192708 31.4153646,0.21875 33.9882812,0.21875 Z"></path><path vector-effect="non-scaling-stroke" d="M32.6708984,2.02246094 L21.5554199,0.374195518 L17.6036034,0.374195518 L5.77148437,7.90429688 C3.09089817,12.6737672 3.09089817,15.2284547 5.77148437,15.5683594 C8.45207058,15.9082641 16.1278518,14.3268839 28.7988281,10.8242188 L42.9921875,7.90429688 L41.0699892,5.68448183 L32.6708984,2.02246094 Z"></path><rect x="0" y="34" width="48" height="14"></rect></g><g transform="translate(106.000000, 5.000000)" class="slds-illustration__fill-secondary"><polygon vector-effect="non-scaling-stroke" points="93.3109375 43.4566406 93.3109375 64.6722656 120.925 64.6722656 121.823047 44.1324219 158.5 43.4566406 158.5 97.5 48.5 97.5 48.5 43.6933594"></polygon><path vector-effect="non-scaling-stroke" d="M132.670898,7.66300119e-19 C125.172201,-2.55433373e-19 94.1907552,-2.55433373e-19 39.7265625,7.66300119e-19 L31.8183594,12.5058594 L29.7050781,28.2714844 L157.78125,28.2714844 L157.78125,15.4775391 C148.539714,5.15917969 140.169596,1.78803361e-18 132.670898,7.66300119e-19 Z"></path><path vector-effect="non-scaling-stroke" d="M37.8266602,0 C34.4632704,0 29.4181858,0 22.6914062,0 C16.1624349,0 9.53808594,3.83528646 2.81835938,11.5058594 L0.705078125,30.2714844 L48.4101562,30.2714844 L48.4101562,14.4775391 L48.1789909,12.3275853 C43.283405,4.10919509 39.832628,0 37.8266602,0 Z"></path><rect x="0.5" y="43.5" width="48" height="54"></rect></g><g><rect class="slds-illustration__stroke-primary" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" x="154.5" y="34.5" width="110" height="68"></rect><polygon vector-effect="non-scaling-stroke" class="slds-illustration__stroke-primary" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" points="264.5 48.5 264.5 34.5 154.5 34.5 154.5 48.5 199.5 48.5 199.5 69.5 227.5 69.5 227.5 48.5"></polygon><path vector-effect="non-scaling-stroke" d="M130.5,0.5 L234.5,0.5 C251.068542,0.5 264.5,13.9314575 264.5,30.5 L264.5,34.5 L106.5,34.5 L106.5,24.5 C106.5,11.245166 117.245166,0.5 130.5,0.5 Z" class="slds-illustration__stroke-primary" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path><path vector-effect="non-scaling-stroke" d="M130.5,0.5 L130.5,0.5 C143.754834,0.5 154.5,11.245166 154.5,24.5 L154.5,34.5 L106.5,34.5 L106.5,24.5 C106.5,11.245166 117.245166,0.5 130.5,0.5 Z" class="slds-illustration__stroke-primary" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path><rect class="slds-illustration__stroke-primary" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" x="106.5" y="48.5" width="48" height="54"></rect><rect class="slds-illustration__stroke-primary" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" x="106.5" y="34.5" width="48" height="14"></rect><path vector-effect="non-scaling-stroke" d="M219,52 C219,54.765 216.765,57 214,57 C211.235,57 209,54.765 209,52 C209,49.235 211.235,47 214,47 C216.765,47 219,49.235 219,52 Z" class="slds-illustration__fill-primary"></path><path vector-effect="non-scaling-stroke" d="M214,55 L214,60" class="slds-illustration__stroke-primary" stroke-width="4" stroke-linecap="round"></path><circle vector-effect="non-scaling-stroke" class="slds-illustration__fill-primary" cx="164" cy="58" r="3"></circle><circle vector-effect="non-scaling-stroke" class="slds-illustration__fill-primary" cx="164" cy="93" r="3"></circle><circle vector-effect="non-scaling-stroke" class="slds-illustration__fill-primary" cx="255" cy="58" r="3"></circle><circle vector-effect="non-scaling-stroke" class="slds-illustration__fill-primary" cx="255" cy="93" r="3"></circle><circle vector-effect="non-scaling-stroke" class="slds-illustration__fill-primary" cx="145" cy="58" r="3"></circle><circle vector-effect="non-scaling-stroke" class="slds-illustration__fill-primary" cx="145" cy="93" r="3"></circle><circle vector-effect="non-scaling-stroke" class="slds-illustration__fill-primary" cx="116" cy="58" r="3"></circle><circle vector-effect="non-scaling-stroke" class="slds-illustration__fill-primary" cx="116" cy="93" r="3"></circle><path vector-effect="non-scaling-stroke" d="M289.928751,82.2971422 L298,102.518658 L280,102.518658 L288.071249,82.2971422 C288.275982,81.784207 288.857768,81.5343604 289.370703,81.7390942 C289.625359,81.8407378 289.827108,82.0424867 289.928751,82.2971422 Z" class="slds-illustration__fill-primary"></path><path vector-effect="non-scaling-stroke" d="M300.428751,89.8132712 L305.5,102.518658 L293.5,102.518658 L298.571249,89.8132712 C298.775982,89.300336 299.357768,89.0504894 299.870703,89.2552232 C300.125359,89.3568668 300.327108,89.5586158 300.428751,89.8132712 Z" class="slds-illustration__fill-primary"></path><path vector-effect="non-scaling-stroke" d="M93.4287513,82.2971422 L101.5,102.518658 L83.5,102.518658 L91.5712487,82.2971422 C91.7759825,81.784207 92.3577681,81.5343604 92.8707033,81.7390942 C93.1253588,81.8407378 93.3271077,82.0424867 93.4287513,82.2971422 Z" class="slds-illustration__fill-primary" transform="translate(92.500000, 92.517446) scale(-1, 1) translate(-92.500000, -92.517446) "></path><path vector-effect="non-scaling-stroke" d="M76.9287513,89.8132712 L82,102.518658 L70,102.518658 L75.0712487,89.8132712 C75.2759825,89.300336 75.8577681,89.0504894 76.3707033,89.2552232 C76.6253588,89.3568668 76.8271077,89.5586158 76.9287513,89.8132712 Z" class="slds-illustration__fill-primary" transform="translate(76.000000, 96.275510) scale(-1, 1) translate(-76.000000, -96.275510) "></path><path vector-effect="non-scaling-stroke" d="M360,102.5 L372,102.5" class="slds-illustration__stroke-primary" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path><path vector-effect="non-scaling-stroke" d="M0,102.5 L350,102.5" class="slds-illustration__stroke-primary" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path></g></g><g transform="translate(150.000000, 96.000000)" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3"><path vector-effect="non-scaling-stroke" d="M44,17.5 L63,17.5 C62.2789714,12.0723971 64.081543,7.53186978 68.4077148,3.87841797 C73.3754883,-0.195556641 79.2734375,0.717773438 82.440918,2.12353516 C85.6083984,3.52929687 87.9606934,5.46069336 89.5913086,9.10524041 C90.2822266,10.6397351 90.7517904,11.9379883 91,13"></path><path vector-effect="non-scaling-stroke" d="M83,20.5 C84.0558268,16.8461914 86.2227376,14.4572754 89.5007324,13.333252 C94.4177246,11.6472168 99.0800781,13.8925781 100.942383,16.1518555 C102.804687,18.4111328 103.39502,20.2260742 103.746582,22.1201172 C103.980957,23.3828125 104.06543,24.8427734 104,26.5 C108.141764,26.3313802 110.918945,27.1647135 112.331543,29 C114.040039,31.1936035 114.215332,33.817627 113.593018,35.75 C112.970703,37.682373 110.894531,40.5 107,40.5 L28,40.5"></path><path vector-effect="non-scaling-stroke" d="M18,27.5 L83.0004985,27.5"></path><path vector-effect="non-scaling-stroke" d="M0,27.5 L8,27.5"></path></g><g transform="translate(271.000000, 135.000000)" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3"><g><path vector-effect="non-scaling-stroke" d="M44,17.5 L63,17.5 C62.2789714,12.0723971 64.081543,7.53186978 68.4077148,3.87841797 C73.3754883,-0.195556641 79.2734375,0.717773438 82.440918,2.12353516 C85.6083984,3.52929687 87.9606934,5.46069336 89.5913086,9.10524041 C90.2822266,10.6397351 90.7517904,11.9379883 91,13"></path><path vector-effect="non-scaling-stroke" d="M83,20.5 C84.0558268,16.8461914 86.2227376,14.4572754 89.5007324,13.333252 C94.4177246,11.6472168 99.0800781,13.8925781 100.942383,16.1518555 C102.804687,18.4111328 103.39502,20.2260742 103.746582,22.1201172 C103.980957,23.3828125 104.06543,24.8427734 104,26.5 C108.141764,26.3313802 110.918945,27.1647135 112.331543,29 C114.040039,31.1936035 114.215332,33.817627 113.593018,35.75 C112.970703,37.682373 110.894531,40.5 107,40.5 L28,40.5"></path><path vector-effect="non-scaling-stroke" d="M18,27.5 L83.0004985,27.5"></path><path vector-effect="non-scaling-stroke" d="M0,27.5 L8,27.5"></path></g></g><g transform="translate(402.000000, 164.000000)" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3"><g transform="translate(31.713442, 25.088326) rotate(-15.000000) translate(-31.713442, -25.088326) translate(4.713442, 6.588326)"><path vector-effect="non-scaling-stroke" d="M31.0360707,3.43528591 C31.0360707,3.43528591 40.5802283,0.671893051 42.6488424,10.6908663" transform="translate(36.842457, 6.888440) rotate(41.000000) translate(-36.842457, -6.888440) "></path><path vector-effect="non-scaling-stroke" d="M40.4282002,10.1797377 C40.4282002,10.1797377 49.9723578,7.4163448 52.0409719,17.435318" transform="translate(46.234586, 13.632892) scale(-1, 1) rotate(-41.000000) translate(-46.234586, -13.632892) "></path><path vector-effect="non-scaling-stroke" d="M0.730284783,29.5865514 C0.730284783,29.5865514 10.2744424,26.8231586 12.3430565,36.8421318"></path><path vector-effect="non-scaling-stroke" d="M12.7302848,29.5865514 C12.7302848,29.5865514 22.2744424,26.8231586 24.3430565,36.8421318" transform="translate(18.536671, 33.039705) scale(-1, 1) translate(-18.536671, -33.039705) "></path></g></g></g></g></g></svg>',1),Rj={class:"slds-text-longform"},$j=k("h3",{class:"slds-text-heading_medium"},"No access yet",-1),Oj={class:"slds-text-body_regular"};function Lj(e,t,s,n,r,a){return L(),X("div",Ej,[k("div",kj,[Pj,k("div",Rj,[$j,k("p",Oj,Pe(a.text),1)])])])}const Nj=os(Mj,[["render",Lj]]),Dj={name:"DataTableRow",components:{ActionMenu:wa,ActionMenuItem:Sa,Badge:lx,ButtonIcon:vn,Checkbox:za,ConditionalWrapper:Cp,Icon:yn},inject:["rootProps","rootEmit"],props:["childIndex","depth","parentRef","row"],data(){return{indexOfColumnBeingEdited:null}},methods:{handleRowToggleClick(){if(!this.$props.row.loading){if(this.$props.row.loaded===!1){this.rootEmit("load-row",this.$props.row);return}this.$props.row.expanded=!this.$props.row.expanded}},handleCellEdit(e,t){this.indexOfColumnBeingEdited=t;const s=e.path.find(n=>["td","th"].includes(n.localName)&&n.className.includes("slds-cell-edit"));this.$nextTick(()=>s.querySelector("input").focus())},handleRowAction(e){this.rootEmit("row-action",{action:e,...this.$props})},updateCellValue(e){const t=e.path[0].value;this.$props.row.data[this.indexOfColumnBeingEdited].value=t,this.rootEmit("update-cell",{value:t,row:this.$props.row,columnIndex:this.indexOfColumnBeingEdited}),this.$nextTick(()=>{this.$props.row.data[this.indexOfColumnBeingEdited].error||(this.indexOfColumnBeingEdited=null)})},resetEditMode(){this.indexOfColumnBeingEdited=null}}},Bj=["aria-selected","aria-level"],Fj={key:0,class:"slds-text-align_center slds-cell_action-mode",role:"gridcell"},zj=["title"],Uj={key:0,"aria-describedby":"dialog-body-id-1",class:"slds-popover slds-popover slds-popover_edit",role:"dialog",style:{position:"absolute",top:"0px",left:"0.0625rem"}},Vj={id:"dialog-body-id-1",class:"slds-popover__body"},jj={class:"slds-media"},qj={class:"slds-media__body"},Hj=["for"],Gj={class:"slds-assistive-text"},Wj={class:"slds-form-element__control slds-grow"},Yj=["id","value"],Zj={key:0,class:"slds-form-element__help"},Xj={key:1,class:"slds-cell_action-mode",role:"gridcell"};function Kj(e,t,s,n,r,a){var O;const o=pe("Checkbox"),d=pe("ButtonIcon"),p=pe("Badge"),y=pe("Icon"),v=pe("ConditionalWrapper"),C=pe("ActionMenuItem"),I=pe("ActionMenu");return s.row.hidden?$e("",!0):(L(),X("tr",{ref:"row",key:e.$props.row.id,"aria-selected":a.rootProps.multiselectable?e.$props.row.selected||"false":null,"aria-level":e.$props.depth?e.$props.depth:null,class:$t([{"slds-is-selected":e.$props.row.selected,"slds-is-edited":e.$props.row.dirty,...(s.row.class||[]).reduce((A,P)=>(A[P]=!0,A),{})},"slds-hint-parent"])},[a.rootProps.multiselectable?(L(),X("td",Fj,[de(o,{modelValue:e.$props.row.selected,"onUpdate:modelValue":t[0]||(t[0]=A=>e.$props.row.selected=A),labels:{name:`Select item ${e.$props.childIndex+1}`},hideLabel:"",onClick:t[1]||(t[1]=Os(A=>e.$emit("select-row",{e:A,row:s.row}),["prevent"]))},null,8,["modelValue","labels"])])):$e("",!0),(L(!0),X(Lt,null,As(e.$props.row.data,(A,P)=>{var q,ce,re,W,Ce,te;return L(),Ge(pE(P===0?"th":"td"),{key:`'Root' + ${P}`,"data-label":(q=a.rootProps.columns[P])==null?void 0:q.name,class:$t({"slds-tree__item":P===0&&a.rootProps.tree,"slds-cell-edit":(ce=a.rootProps)==null?void 0:ce.editableColumnIndices.includes(P),"slds-is-edited":A==null?void 0:A.dirty,"slds-has-error":A==null?void 0:A.error,"slds-text-align_center":((re=a.rootProps.columns[P])==null?void 0:re.alignment)==="center","slds-text-align_left":((W=a.rootProps.columns[P])==null?void 0:W.alignment)==="left"||((Ce=a.rootProps.columns[P])==null?void 0:Ce.alignment)===void 0,"slds-text-align_right":((te=a.rootProps.columns[P])==null?void 0:te.alignment)==="right"}),role:P>0&&a.rootProps.tree?"gridcell":null,scope:P===0?"row":null},{default:je(()=>{var oe;return[de(v,{class:$t(["slds-grid slds-grid_align-spread",{"slds-grow":P===0}]),element:"span",style:{width:"100%"},active:(oe=a.rootProps)==null?void 0:oe.editableColumnIndices.includes(P)},{default:je(()=>{var ve,ee;return[de(v,{element:"span",class:"slds-grid slds-truncate",active:P===0&&((ve=a.rootProps)==null?void 0:ve.editableColumnIndices.includes(P))},{default:je(()=>{var ne;return[a.rootProps.tree&&P===0?(L(),Ge(d,{key:0,name:"expand-node-tree",variant:"bare",iconCategory:"utility",iconName:e.$props.row.loading?"spinner":e.$props.row.expanded?"chevrondown":"chevronright",size:"x-small",class:$t(["slds-m-right_x-small",{"slds-is-disabled":e.$props.row.loaded!==!1&&!((ne=e.$props.row.children)!=null&&ne.length)}]),tabindex:"-1",title:`Expand ${(A==null?void 0:A.type)==="anchor"?A.value:A}`,assistiveText:`Expand ${(A==null?void 0:A.type)==="anchor"?A.value:A}`,onClick:a.handleRowToggleClick},null,8,["iconName","class","title","assistiveText","onClick"])):$e("",!0),(A==null?void 0:A.type)==="custom"?js(e.$slots,"cell",Ji({key:1,column:a.rootProps.columns[P],columnIndex:P,data:A},{...e.$props,$row:this})):(L(),X(Lt,{key:2},[(A==null?void 0:A.type)==="badge"?(L(),Ge(p,{key:0,theme:A.theme,content:A.value},null,8,["theme","content"])):typeof A=="boolean"?(L(),Ge(y,{key:1,category:"utility",name:"check",size:"xx-small"})):(L(),X("div",{key:2,title:(A==null?void 0:A.type)==="anchor"?A.value:A,class:"slds-truncate"},[de(v,Ji({tabindex:"-1",element:"a"},(A==null?void 0:A.attrs)||{},{active:(A==null?void 0:A.type)==="anchor"}),{default:je(()=>[es(Pe((A==null?void 0:A.type)==="anchor"?A.value:A),1)]),_:2},1040,["active"])],8,zj))],64))]}),_:2},1032,["active"]),(ee=a.rootProps)!=null&&ee.editableColumnIndices.includes(P)?(L(),Ge(d,{key:0,variant:"bare",iconCategory:"utility",iconClass:"slds-button__icon_hint slds-button__icon_edit",iconName:A.locked?"lock":"edit",size:"x-small",class:"slds-cell-edit__button slds-m-left_x-small",title:`Edit ${a.rootProps.columns[P].name} of ${(A==null?void 0:A.type)==="anchor"?A.value:A}`,assistiveText:`Edit ${a.rootProps.columns[P].name} of ${(A==null?void 0:A.type)==="anchor"?A.value:A}`,disabled:A.locked,onClick:ne=>a.handleCellEdit(ne,P)},null,8,["iconName","title","assistiveText","disabled","onClick"])):$e("",!0)]}),_:2},1032,["class","active"]),P===r.indexOfColumnBeingEdited?(L(),X("section",Uj,[k("div",Vj,[k("div",jj,[k("div",qj,[k("div",{class:$t(["slds-form-element slds-grid slds-wrap",{"slds-has-error":A.error}])},[k("label",{class:"slds-form-element__label slds-form-element__label_edit slds-no-flex",for:`${a.rootProps.columns[P].name}-${P}`},[k("span",Gj,Pe(a.rootProps.columns[P].name),1)],8,Hj),k("div",Wj,[k("input",{id:`${a.rootProps.columns[P].name}-${P}`,class:"slds-input",type:"text",value:A.value,onBlur:t[2]||(t[2]=(...ve)=>a.resetEditMode&&a.resetEditMode(...ve)),onKeydown:[t[3]||(t[3]=Zs(Os((...ve)=>a.resetEditMode&&a.resetEditMode(...ve),["stop"]),["esc"])),t[4]||(t[4]=Zs(Os(ve=>a.updateCellValue(ve),["stop"]),["enter"]))]},null,40,Yj)]),A.error?(L(),X("div",Zj,Pe(A.error),1)):$e("",!0)],2)])])])])):$e("",!0)]}),_:2},1032,["data-label","class","role","scope"])}),128)),(O=e.$props.row.actions)!=null&&O.length?(L(),X("td",Xj,[de(I,{buttonIconSize:"x-small"},{default:je(()=>[(L(!0),X(Lt,null,As(e.$props.row.actions,(A,P)=>(L(),Ge(C,{key:P,label:A.label,onClick:q=>a.handleRowAction(A)},null,8,["label","onClick"]))),128))]),_:1})])):$e("",!0)],10,Bj))}const XS=os(Dj,[["render",Kj]]),KS={name:"DataTableTreeNode",components:{Row:XS},props:["depth","parentRef","row","childIndex"],render(){const e=[An(XS,{...this.$props},{cell:t=>this.$slots.cell?this.$slots.cell(t):null})];return this.$props.row.children&&this.$props.row.expanded&&this.$props.row.children.forEach((t,s)=>e.push(An(KS,{childIndex:s,depth:this.$props.depth+1,parentRef:this.$props.row,row:t},{cell:n=>this.$slots.cell?this.$slots.cell(n):null}))),[e]}},Jj={name:"DataTableTree",components:{Node:KS},props:["rows"],render(){const e=this.$slots.default?this.$slots.default():null;return this.$props.rows.map((t,s)=>An(KS,{childIndex:s,depth:0,parentRef:null,row:t},{cell:n=>this.$slots.cell?this.$slots.cell(n):null})).concat(e)}},Qj={name:"DataTableTreeGroup",components:{ActionMenu:wa,ActionMenuItem:Sa,Checkbox:za},props:["rows"],inject:["rootEmit","rootProps"],emits:["select-row"],data(){return{maxDepth:0}},watch:{rows:{handler(){this.maxDepth=0},deep:!0}},render(){let e=!1;const t=[],s=(n,r=An("tr",[]),a=0)=>{var p,y,v;let o=0,d;if((p=n.children)!=null&&p.length){++a,a>this.maxDepth&&(this.maxDepth=a),e||(e=!0),d=An("th",{class:n.selected||n.indeterminate?"spm-data-table-selected-cell":null,style:{"background-color":"#f9f9fa","vertical-align":"top"}},[n.data[0]]),this.rootProps.multiselectable&&(typeof n.selected>"u"&&(n.selected=!1),typeof n.indeterminate>"u"&&(n.indeterminate=!1),d.children=[An("div",{class:"slds-grid slds-grid_vertical-align-center"},[An(za,{class:"slds-m-right_small",disabled:n.disabled,hideLabel:!0,indeterminate:n.indeterminate,modelValue:n.selected,onClick:Os(I=>this.$emit("select-row",{row:n,e:I}),["prevent"])}),An("div",[n.data[0]])])]),this.$slots.groupActions&&d.children[0].children.push(this.$slots.groupActions({row:n})),r.children.push(d);for(let I=0;I<n.children.length;I++){e||(r=An("tr",[]),e=!0);const{rowspan:O}=s(n.children[I],r,a);o+=O}const C=An("tr",{class:"spm-subtotal-row"},[]);for(let I=1;I<n.data.length;I++)C.children.push(An("td",{class:"spm-subtotal-cell"},[n.data[I]]));C.children.unshift(An("th",{colspan:this.maxDepth-a+1},[An("span",{class:"spm-subtotal-cell"},["Subtotal"])])),(y=n.actions)!=null&&y.length&&C.children.push(An("td")),d.props.rowspan=o+1,t.push(C)}else{e||(r=An("tr",[]));const C=An("th",{class:n.selected||n.indeterminate?"spm-data-table-selected-cell":null,style:{"vertical-align":"top"}},[n.data[0]]);this.rootProps.multiselectable&&(typeof n.selected>"u"&&(n.selected=!1),C.children=[An("div",{class:"slds-grid slds-grid_vertical-align-center"},[An(za,{disabled:n.disabled,hideLabel:!0,class:"slds-m-right_small",modelValue:n.selected,onClick:Os(I=>this.$emit("select-row",{row:n,e:I}),["prevent"])}),An("div",[n.data[0]])])]),this.$slots.groupActions&&C.children[0].children.push(this.$slots.groupActions({row:n})),r.children.push(C);for(let I=0;I<this.maxDepth-a;I++)r.children.push(An("td",["-"]));for(let I=1;I<n.data.length;I++)r.children.push(An("td",[n.data[I]]));(v=n.actions)!=null&&v.length&&r.children.push(An("td",{class:"slds-cell_action-mode",role:"gridcell"},[An(wa,{buttonIconSize:"x-small"},{default:()=>n.actions.map((I,O)=>An(Sa,{key:O,label:I.label,click:this.onRowAction.bind(this,I,n)}))})])),e=!1,t.push(r)}return{depth:a,rowspan:o+1}};return this.$props.rows.forEach(n=>{s(n)}),t},methods:{onRowAction(e,t){this.rootEmit("row-action",{action:e,row:t})}}},qC={name:"DataTable",components:{ActionMenu:wa,ActionMenuItem:Sa,Checkbox:za,Icon:yn,Layout:xC,LayoutItem:wC,Row:XS,Tree:Jj,TreeGroup:Qj},provide(){return{rootProps:this.$props,rootEmit:(...e)=>{this.$emit(e[0],...e.slice(1))}}},props:{actions:Boolean,ariaLabel:{type:String,default:""},bordered:Boolean,bufferCells:Boolean,columns:{type:Array,required:!0},columnsBordered:Boolean,editableColumnIndices:{type:Array,default:()=>[]},fixed:Boolean,hideHeader:Boolean,sortable:Boolean,multiselectable:Boolean,resizable:Boolean,rows:{type:Array,required:!0},noRowHover:Boolean,selectAll:Boolean,fullHeader:Boolean,contentHeader:Boolean,summaryFooter:Boolean,summaryHeader:Boolean,tree:Boolean,treeGroup:Boolean,virtual:Boolean},emits:["column-action","row-action","select-column","select-row","load-row","update-cell","column-sorted"],data(){return{lastSelectedRow:null,selectAllState:"none",selectAllId:Vn(),columnResizer:{},sortDirection:"",sortedColumnIndex:null,rowHeight:0,containerHeight:0,visibleRowsStartIndex:0}},computed:{computedRole(){return this.$props.tree?"treegrid":this.$props.multiselectable?"grid":null},visibleRows(){return this.$props.virtual?this.rows.slice(this.visibleRowsStartIndex,this.visibleRowsStartIndex+200):this.rows},tableContainerPaddingTop(){return this.visibleRowsStartIndex*this.rowHeight},tableContainerPaddingBottom(){return(this.rows.length-this.visibleRows.length)*this.rowHeight-this.tableContainerPaddingTop},hasSelectableColumns(){return this.$props.columns.some(e=>e.selectable)},verticalHeaderCellPadding(){return this.$props.summaryHeader&&this.hasSelectableColumns?"0.75rem":"0.5rem"},selectedPseudoElementTop(){return!this.hasSelectableColumns||!this.$props.summaryHeader?"-4px":0},selectedBorderRadius(){return this.$props.summaryHeader?0:"2px"},selectedColumnBackgroundColor(){var e,t;return((t=(e=this.columns.find(s=>s.selected))==null?void 0:e.icon)==null?void 0:t.color)||"blue"}},watch:{"$props.rows":{handler(e){e.length&&(this.initColumnResizer(),this.virtual&&this.$nextTick(()=>{this.rowHeight=this.$refs["row-0"][0].$refs.row.offsetHeight,this.containerHeight=this.$refs.tableContainer.offsetHeight})),this.updateSelectAllState()},immediate:!0}},methods:{async initColumnResizer(){!this.$props.resizable||(await this.$nextTick(),this.columnResizer=new Pk(this.$refs.table,{disable:!this.$props.resizable,innerGripHtml:"<div class='rangeGrip'></div>",removePadding:!1,minWidth:48}))},async onSelectRow({e,row:t}){var a;const s=[t];if(e.shiftKey&&this.lastSelectedRow){const o=((a=t==null?void 0:t.parent)==null?void 0:a.children)||this.rows;let d=o.findIndex(y=>y===t),p=o.findIndex(y=>y===this.lastSelectedRow);for(;p!==-1&&p!==d;)s.push(o[p]),p+=p>d?-1:1}this.lastSelectedRow=t;const n=!t.selected&&!t.indeterminate;s.forEach(o=>{o.selected=n,o.indeterminate=!1,function d(p){var y;(y=p==null?void 0:p.children)==null||y.forEach(v=>{v.indeterminate=!1,v.selected=n,d(v)})}(o)});let r=t.parent;for(;r;){let o=!1,d=!1;r.children.some(p=>{if((p.selected||p.indeterminate)&&(o=!0),(!p.selected||p.indeterminate)&&(d=!0),o&&d)return!0}),r.indeterminate=o&&d,r.selected=o&&!d,r=r.parent}this.updateSelectAllState(),SPM.Utils.Browser.clearSelection()},onSelectAll(){const e=this.selectAllState==="none";this.rows.forEach(t=>t.selected=e),this.updateSelectAllState()},updateSelectAllState(){let e=!1,t=!1;this.rows.some(s=>{if((s.selected||s.indeterminate)&&(e=!0),(!s.selected||s.indeterminate)&&(t=!0),e&&t)return!0}),this.selectAllState=e?t?"some":"all":"none"},onScroll(){!this.$props.virtual||!this.$refs.tableContainer||!(Math.abs(this.$refs.tableContainer.scrollTop-(this.lastScrollTop||0))>this.rowHeight*20)||(this.lastScrollTop=this.$refs.tableContainer.scrollTop,this.visibleRowsStartIndex=Math.max(0,Math.floor(this.$refs.tableContainer.scrollTop/this.rowHeight)-100))},onColumnSort(e){this.sortedColumnIndex=e,!this.sortDirection||this.sortDirection==="descending"?this.sortDirection="ascending":this.sortDirection="descending",this.$emit("column-sorted",e,this.sortDirection)},getListeners(e,t){const s={...e.listeners||{}};return e.selectable&&(s.click=[s.click]),s}}},uA=()=>{AE(e=>({"78c6120a":e.selectedPseudoElementTop,"5f55835e":e.selectedBorderRadius,"9aac58e8":e.selectedColumnBackgroundColor,72948518:e.verticalHeaderCellPadding}))},dA=qC.setup;qC.setup=dA?(e,t)=>(uA(),dA(e,t)):uA;const eq=qC,EP=e=>(Nr("data-v-8116ab47"),e=e(),Dr(),e),tq=["aria-multiselectable","aria-label","role"],sq={key:0},nq=["colspan"],rq={key:1},iq=["colspan"],oq={key:2,class:"summary-header"},aq={key:0},lq={key:0},cq={class:"column-header slds-line-height_reset"},uq={key:0,class:"slds-text-align_center slds-cell_action-mode",scope:"col",style:{padding:"0"}},dq=["id"],hq={class:"slds-th__action slds-th__action_form"},pq=["id","aria-sort"],fq=["onClick"],mq=EP(()=>k("span",{class:"slds-assistive-text"},"Sort by: ",-1)),_q={class:"slds-grid slds-grid_vertical-align-center slds-has-flexi-truncate"},gq=["title"],yq={class:"slds-assistive-text","aria-live":"polite","aria-atomic":"true"},vq={class:"slds-truncate"},bq={key:1,class:"slds-cell_action-mode",scope:"col"},xq=EP(()=>k("div",{class:"slds-truncate slds-assistive-text",title:"Actions"}," Actions ",-1)),wq=[xq],Sq={slot:"text-data","slot-scope":"slotProps"},Cq={key:3,class:"summary-footer"},Iq={key:0};function Tq(e,t,s,n,r,a){const o=pe("Checkbox"),d=pe("Icon"),p=pe("ActionMenuItem"),y=pe("ActionMenu"),v=pe("LayoutItem"),C=pe("Layout"),I=pe("Tree"),O=pe("TreeGroup"),A=pe("Row");return L(),X("div",{ref:"tableContainer",class:$t(["slds-scrollable slds-grow",{virtual:e.$props.virtual}]),onScroll:t[0]||(t[0]=(...P)=>a.onScroll&&a.onScroll(...P))},[e.$props.virtual?(L(),X("div",{key:0,style:br({height:`${a.tableContainerPaddingTop}px`})},null,4)):$e("",!0),k("table",{ref:"table","aria-multiselectable":e.$props.multiselectable,class:$t(["spm-table slds-table",{"slds-table_edit":e.$props.editableColumnIndices.length,"slds-table_bordered":e.$props.bordered,"slds-table_col-bordered":e.$props.columnsBordered,"slds-table_header-hidden":e.$props.hideHeader,"slds-table_cell-buffer":e.$props.bufferCells,"slds-tree slds-table_tree":e.$props.tree,"slds-table_resizable-cols slds-table_fixed-layout":e.$props.resizable,"slds-no-row-hover":e.$props.treeGroup||e.$props.noRowHover,"slds-table_fixed-layout":e.$props.fixed}]),"aria-label":e.$props.ariaLabel,role:a.computedRole},[k("thead",{class:$t({"slds-assistive-text":e.$props.hideHeader})},[e.$props.fullHeader?(L(),X("tr",sq,[k("th",{class:$t([{"slds-is-resizable":e.$props.resizable},"slds-line-height_reset"]),scope:"col",style:{padding:"0","background-color":"#fff","font-weight":"400"},colspan:e.$props.columns.length},[js(e.$slots,"header-content-full",{},void 0,!0)],10,nq)])):$e("",!0),e.$props.contentHeader?(L(),X("tr",rq,[k("th",{class:$t([{"slds-is-resizable":e.$props.resizable},"slds-line-height_reset"]),scope:"col",style:{padding:"0","background-color":"#fff"},colspan:"1"},[js(e.$slots,"header-content-left",{},void 0,!0)],2),k("th",{class:$t([{"slds-is-resizable":e.$props.resizable},"slds-line-height_reset"]),scope:"col",style:{padding:"0","background-color":"#fff"},colspan:e.$props.columns.length-1},[js(e.$slots,"header-content-right",{},void 0,!0)],10,iq)])):$e("",!0),e.$props.summaryHeader?(L(),X("tr",oq,[js(e.$slots,"summaryHeaderRow",{},()=>[e.$props.multiselectable&&!e.$props.treeGroup?(L(),X("td",aq)):$e("",!0),(L(!0),X(Lt,null,As(e.$props.columns,(P,q)=>{var ce,re,W,Ce;return L(),X("td",{key:q,class:$t({"slds-text-align_left":((ce=e.$props.columns[q])==null?void 0:ce.alignment)==="left"||((re=e.$props.columns[q])==null?void 0:re.alignment)===void 0,"slds-text-align_right":((W=e.$props.columns[q])==null?void 0:W.alignment)==="right","slds-text-align_center":((Ce=e.$props.columns[q])==null?void 0:Ce.alignment)==="center"}),style:br(P.style||{}),scope:"col"},[js(e.$slots,"summaryHeader",{column:P,columnIndex:q},void 0,!0)],6)}),128))],!0),e.$props.actions?(L(),X("td",lq)):$e("",!0)])):$e("",!0),k("tr",cq,[e.$props.multiselectable&&!e.$props.treeGroup?(L(),X("th",uq,[k("span",{id:r.selectAllId,class:"slds-assistive-text"},"Choose a row",8,dq),k("div",hq,[de(o,{modelValue:r.selectAllState==="all",indeterminate:r.selectAllState==="some",ariaLabeledBy:r.selectAllId,labels:{name:"Select All"},hideLabel:"",onClick:Os(a.onSelectAll,["prevent"])},null,8,["modelValue","indeterminate","ariaLabeledBy","onClick"])])])):$e("",!0),(L(!0),X(Lt,null,As(e.$props.columns,(P,q)=>(L(),X("th",Ji({key:P.id,id:P.id.replaceAll(" ","-"),class:[{"slds-is-resizable":e.$props.resizable,"selected-column":P.selected,"selectable-column":P.selectable,"slds-is-sortable":e.$props.sortable&&!P.hideSorting,"slds-is-sorted":e.$props.sortable&&r.sortedColumnIndex===q&&!P.hideSorting,"slds-is-sorted_asc":e.$props.sortable&&r.sortedColumnIndex===q&&r.sortDirection==="ascending"&&!P.hideSorting,"slds-is-sorted_desc":e.$props.sortable&&r.sortedColumnIndex===q&&r.sortDirection==="descending"&&!P.hideSorting},"table-header"],"aria-sort":e.$props.sortable&&r.sortedColumnIndex===q?r.sortDirection:null,scope:"col"},id(a.getListeners(P,q),!0)),[(P==null?void 0:P.type)==="custom"?js(e.$slots,"header",{key:0,column:P,columnIndex:q},void 0,!0):e.$props.sortable?(L(),X(Lt,{key:1},[k("a",{class:"slds-th__action slds-text-link_reset",href:"#",role:"button",tabindex:"0",onClick:ce=>a.onColumnSort(q)},[mq,k("div",_q,[k("span",{class:"slds-truncate",title:P.name},Pe(P.name),9,gq),de(d,{category:"utility",name:"arrowdown",iconClass:["slds-icon-text-default","slds-is-sortable__icon"]})])],8,fq),k("span",yq,"Sorted "+Pe(r.sortDirection),1)],64)):(L(),Ge(C,{key:2,title:P.name,verticalAlign:"center"},{default:je(()=>[P.icon?(L(),Ge(d,Ji({key:0},{size:"x-small",...P.icon},{class:"slds-m-right_x-small"}),null,16)):$e("",!0),k("span",vq,Pe(P.name),1),P.actions?(L(),Ge(v,{key:1,alignmentBump:"left",flexibility:"no-flex",class:"slds-p-left_x-small"},{default:je(()=>[de(y,{buttonIconSize:"xx-small"},{default:je(()=>[(L(!0),X(Lt,null,As(P.actions,(ce,re)=>(L(),Ge(p,{key:re,label:ce.label,onClick:W=>e.$emit("column-action",{action:ce,column:P,columnIndex:q},W)},null,8,["label","onClick"]))),128))]),_:2},1024)]),_:2},1024)):$e("",!0)]),_:2},1032,["title"]))],16,pq))),128)),e.$props.actions?(L(),X("th",bq,wq)):$e("",!0)])],2),k("tbody",null,[e.$props.tree?(L(),Ge(I,{key:0,rows:e.$props.rows},{cell:je(P=>[js(e.$slots,"cell",kp(im({...P})),void 0,!0)]),_:3},8,["rows"])):e.$props.treeGroup?(L(),Ge(O,{key:1,rows:e.$props.rows,onSelectRow:a.onSelectRow},{groupActions:je(P=>[js(e.$slots,"groupActions",kp(im({...P})),void 0,!0)]),_:3},8,["rows","onSelectRow"])):(L(!0),X(Lt,{key:2},As(a.visibleRows,(P,q)=>(L(),Ge(A,{ref_for:!0,ref:`row-${q}`,key:P.id,row:P,index:q,onSelectRow:a.onSelectRow},{cell:je(ce=>[js(e.$slots,"cell",kp(im({...ce})),void 0,!0)]),default:je(()=>[k("template",Sq,[js(e.$slots,"text-data",kp(im(e.slotProps)),void 0,!0)])]),_:2},1032,["row","index","onSelectRow"]))),128)),e.$props.summaryFooter?(L(),X("tr",Cq,[e.$props.multiselectable?(L(),X("td",Iq)):$e("",!0),(L(!0),X(Lt,null,As(e.$props.columns,(P,q)=>{var ce,re,W,Ce;return L(),X("td",{key:q,class:$t({"slds-text-align_left":((ce=e.$props.columns[q])==null?void 0:ce.alignment)==="left"||((re=e.$props.columns[q])==null?void 0:re.alignment)===void 0,"slds-text-align_right":((W=e.$props.columns[q])==null?void 0:W.alignment)==="right","slds-text-align_center":((Ce=e.$props.columns[q])==null?void 0:Ce.alignment)==="center"}),scope:"col"},[js(e.$slots,"summaryFooter",{column:P,columnIndex:q},void 0,!0)],2)}),128))])):$e("",!0)])],10,tq),e.$props.virtual?(L(),X("div",{key:1,style:br({height:`${a.tableContainerPaddingBottom}px`})},null,4)):$e("",!0)],34)}const Rm=os(eq,[["render",Tq],["__scopeId","data-v-8116ab47"]]);function ih(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kP(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}/*!
 * GSAP 3.11.5
 * https://greensock.com
 *
 * @license Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Dl={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},wg={duration:.5,overwrite:!1,delay:0},HC,ba,ho,Tc=1e8,Wr=1/Tc,JS=Math.PI*2,Aq=JS/4,Mq=0,PP=Math.sqrt,Eq=Math.cos,kq=Math.sin,Bo=function(t){return typeof t=="string"},Li=function(t){return typeof t=="function"},bh=function(t){return typeof t=="number"},GC=function(t){return typeof t>"u"},pd=function(t){return typeof t=="object"},al=function(t){return t!==!1},WC=function(){return typeof window<"u"},E1=function(t){return Li(t)||Bo(t)},RP=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},xa=Array.isArray,QS=/(?:-?\.?\d|\.)+/gi,$P=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Q_=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,tS=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,OP=/[+-]=-?[.\d]+/,LP=/[^,'"\[\]\s]+/gi,Pq=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,Mi,Cc,e2,YC,Fl={},Cb={},NP,DP=function(t){return(Cb=Im(t,Fl))&&dl},ZC=function(t,s){return console.warn("Invalid property",t,"set to",s,"Missing plugin? gsap.registerPlugin()")},Ib=function(t,s){return!s&&console.warn(t)},BP=function(t,s){return t&&(Fl[t]=s)&&Cb&&(Cb[t]=s)||Fl},Sv=function(){return 0},Rq={suppressEvents:!0,isStart:!0,kill:!1},X1={suppressEvents:!0,kill:!1},$q={suppressEvents:!0},XC={},zp=[],t2={},FP,$l={},sS={},hA=30,K1=[],KC="",JC=function(t){var s=t[0],n,r;if(pd(s)||Li(s)||(t=[t]),!(n=(s._gsap||{}).harness)){for(r=K1.length;r--&&!K1[r].targetTest(s););n=K1[r]}for(r=t.length;r--;)t[r]&&(t[r]._gsap||(t[r]._gsap=new cR(t[r],n)))||t.splice(r,1);return t},_m=function(t){return t._gsap||JC(Ac(t))[0]._gsap},zP=function(t,s,n){return(n=t[s])&&Li(n)?t[s]():GC(n)&&t.getAttribute&&t.getAttribute(s)||n},ll=function(t,s){return(t=t.split(",")).forEach(s)||t},Xi=function(t){return Math.round(t*1e5)/1e5||0},Yo=function(t){return Math.round(t*1e7)/1e7||0},ug=function(t,s){var n=s.charAt(0),r=parseFloat(s.substr(2));return t=parseFloat(t),n==="+"?t+r:n==="-"?t-r:n==="*"?t*r:t/r},Oq=function(t,s){for(var n=s.length,r=0;t.indexOf(s[r])<0&&++r<n;);return r<n},Tb=function(){var t=zp.length,s=zp.slice(0),n,r;for(t2={},zp.length=0,n=0;n<t;n++)r=s[n],r&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},UP=function(t,s,n,r){zp.length&&!ba&&Tb(),t.render(s,n,r||ba&&s<0&&(t._initted||t._startAt)),zp.length&&!ba&&Tb()},VP=function(t){var s=parseFloat(t);return(s||s===0)&&(t+"").match(LP).length<2?s:Bo(t)?t.trim():t},jP=function(t){return t},Nc=function(t,s){for(var n in s)n in t||(t[n]=s[n]);return t},Lq=function(t){return function(s,n){for(var r in n)r in s||r==="duration"&&t||r==="ease"||(s[r]=n[r])}},Im=function(t,s){for(var n in s)t[n]=s[n];return t},pA=function e(t,s){for(var n in s)n!=="__proto__"&&n!=="constructor"&&n!=="prototype"&&(t[n]=pd(s[n])?e(t[n]||(t[n]={}),s[n]):s[n]);return t},Ab=function(t,s){var n={},r;for(r in t)r in s||(n[r]=t[r]);return n},sv=function(t){var s=t.parent||Mi,n=t.keyframes?Lq(xa(t.keyframes)):Nc;if(al(t.inherit))for(;s;)n(t,s.vars.defaults),s=s.parent||s._dp;return t},Nq=function(t,s){for(var n=t.length,r=n===s.length;r&&n--&&t[n]===s[n];);return n<0},qP=function(t,s,n,r,a){n===void 0&&(n="_first"),r===void 0&&(r="_last");var o=t[r],d;if(a)for(d=s[a];o&&o[a]>d;)o=o._prev;return o?(s._next=o._next,o._next=s):(s._next=t[n],t[n]=s),s._next?s._next._prev=s:t[r]=s,s._prev=o,s.parent=s._dp=t,s},wx=function(t,s,n,r){n===void 0&&(n="_first"),r===void 0&&(r="_last");var a=s._prev,o=s._next;a?a._next=o:t[n]===s&&(t[n]=o),o?o._prev=a:t[r]===s&&(t[r]=a),s._next=s._prev=s.parent=null},Wp=function(t,s){t.parent&&(!s||t.parent.autoRemoveChildren)&&t.parent.remove(t),t._act=0},gm=function(t,s){if(t&&(!s||s._end>t._dur||s._start<0))for(var n=t;n;)n._dirty=1,n=n.parent;return t},Dq=function(t){for(var s=t.parent;s&&s.parent;)s._dirty=1,s.totalDuration(),s=s.parent;return t},s2=function(t,s,n,r){return t._startAt&&(ba?t._startAt.revert(X1):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(s,!0,r))},Bq=function e(t){return!t||t._ts&&e(t.parent)},fA=function(t){return t._repeat?Sg(t._tTime,t=t.duration()+t._rDelay)*t:0},Sg=function(t,s){var n=Math.floor(t/=s);return t&&n===t?n-1:n},Mb=function(t,s){return(t-s._start)*s._ts+(s._ts>=0?0:s._dirty?s.totalDuration():s._tDur)},Sx=function(t){return t._end=Yo(t._start+(t._tDur/Math.abs(t._ts||t._rts||Wr)||0))},Cx=function(t,s){var n=t._dp;return n&&n.smoothChildTiming&&t._ts&&(t._start=Yo(n._time-(t._ts>0?s/t._ts:((t._dirty?t.totalDuration():t._tDur)-s)/-t._ts)),Sx(t),n._dirty||gm(n,t)),t},HP=function(t,s){var n;if((s._time||s._initted&&!s._dur)&&(n=Mb(t.rawTime(),s),(!s._dur||e0(0,s.totalDuration(),n)-s._tTime>Wr)&&s.render(n,!0)),gm(t,s)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(n=t;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;t._zTime=-Wr}},sd=function(t,s,n,r){return s.parent&&Wp(s),s._start=Yo((bh(n)?n:n||t!==Mi?wc(t,n,s):t._time)+s._delay),s._end=Yo(s._start+(s.totalDuration()/Math.abs(s.timeScale())||0)),qP(t,s,"_first","_last",t._sort?"_start":0),n2(s)||(t._recent=s),r||HP(t,s),t._ts<0&&Cx(t,t._tTime),t},GP=function(t,s){return(Fl.ScrollTrigger||ZC("scrollTrigger",s))&&Fl.ScrollTrigger.create(s,t)},WP=function(t,s,n,r,a){if(eI(t,s,a),!t._initted)return 1;if(!n&&t._pt&&!ba&&(t._dur&&t.vars.lazy!==!1||!t._dur&&t.vars.lazy)&&FP!==Ll.frame)return zp.push(t),t._lazy=[a,r],1},Fq=function e(t){var s=t.parent;return s&&s._ts&&s._initted&&!s._lock&&(s.rawTime()<0||e(s))},n2=function(t){var s=t.data;return s==="isFromStart"||s==="isStart"},zq=function(t,s,n,r){var a=t.ratio,o=s<0||!s&&(!t._start&&Fq(t)&&!(!t._initted&&n2(t))||(t._ts<0||t._dp._ts<0)&&!n2(t))?0:1,d=t._rDelay,p=0,y,v,C;if(d&&t._repeat&&(p=e0(0,t._tDur,s),v=Sg(p,d),t._yoyo&&v&1&&(o=1-o),v!==Sg(t._tTime,d)&&(a=1-o,t.vars.repeatRefresh&&t._initted&&t.invalidate())),o!==a||ba||r||t._zTime===Wr||!s&&t._zTime){if(!t._initted&&WP(t,s,r,n,p))return;for(C=t._zTime,t._zTime=s||(n?Wr:0),n||(n=s&&!C),t.ratio=o,t._from&&(o=1-o),t._time=0,t._tTime=p,y=t._pt;y;)y.r(o,y.d),y=y._next;s<0&&s2(t,s,n,!0),t._onUpdate&&!n&&Mc(t,"onUpdate"),p&&t._repeat&&!n&&t.parent&&Mc(t,"onRepeat"),(s>=t._tDur||s<0)&&t.ratio===o&&(o&&Wp(t,1),!n&&!ba&&(Mc(t,o?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=s)},Uq=function(t,s,n){var r;if(n>s)for(r=t._first;r&&r._start<=n;){if(r.data==="isPause"&&r._start>s)return r;r=r._next}else for(r=t._last;r&&r._start>=n;){if(r.data==="isPause"&&r._start<s)return r;r=r._prev}},Cg=function(t,s,n,r){var a=t._repeat,o=Yo(s)||0,d=t._tTime/t._tDur;return d&&!r&&(t._time*=o/t._dur),t._dur=o,t._tDur=a?a<0?1e10:Yo(o*(a+1)+t._rDelay*a):o,d>0&&!r&&Cx(t,t._tTime=t._tDur*d),t.parent&&Sx(t),n||gm(t.parent,t),t},mA=function(t){return t instanceof nl?gm(t):Cg(t,t._dur)},Vq={_start:0,endTime:Sv,totalDuration:Sv},wc=function e(t,s,n){var r=t.labels,a=t._recent||Vq,o=t.duration()>=Tc?a.endTime(!1):t._dur,d,p,y;return Bo(s)&&(isNaN(s)||s in r)?(p=s.charAt(0),y=s.substr(-1)==="%",d=s.indexOf("="),p==="<"||p===">"?(d>=0&&(s=s.replace(/=/,"")),(p==="<"?a._start:a.endTime(a._repeat>=0))+(parseFloat(s.substr(1))||0)*(y?(d<0?a:n).totalDuration()/100:1)):d<0?(s in r||(r[s]=o),r[s]):(p=parseFloat(s.charAt(d-1)+s.substr(d+1)),y&&n&&(p=p/100*(xa(n)?n[0]:n).totalDuration()),d>1?e(t,s.substr(0,d-1),n)+p:o+p)):s==null?o:+s},nv=function(t,s,n){var r=bh(s[1]),a=(r?2:1)+(t<2?0:1),o=s[a],d,p;if(r&&(o.duration=s[1]),o.parent=n,t){for(d=o,p=n;p&&!("immediateRender"in d);)d=p.vars.defaults||{},p=al(p.vars.inherit)&&p.parent;o.immediateRender=al(d.immediateRender),t<2?o.runBackwards=1:o.startAt=s[a-1]}return new xo(s[0],o,s[a+1])},Jp=function(t,s){return t||t===0?s(t):s},e0=function(t,s,n){return n<t?t:n>s?s:n},ga=function(t,s){return!Bo(t)||!(s=Pq.exec(t))?"":s[1]},jq=function(t,s,n){return Jp(n,function(r){return e0(t,s,r)})},r2=[].slice,YP=function(t,s){return t&&pd(t)&&"length"in t&&(!s&&!t.length||t.length-1 in t&&pd(t[0]))&&!t.nodeType&&t!==Cc},qq=function(t,s,n){return n===void 0&&(n=[]),t.forEach(function(r){var a;return Bo(r)&&!s||YP(r,1)?(a=n).push.apply(a,Ac(r)):n.push(r)})||n},Ac=function(t,s,n){return ho&&!s&&ho.selector?ho.selector(t):Bo(t)&&!n&&(e2||!Ig())?r2.call((s||YC).querySelectorAll(t),0):xa(t)?qq(t,n):YP(t)?r2.call(t,0):t?[t]:[]},i2=function(t){return t=Ac(t)[0]||Ib("Invalid scope")||{},function(s){var n=t.current||t.nativeElement||t;return Ac(s,n.querySelectorAll?n:n===t?Ib("Invalid scope")||YC.createElement("div"):t)}},ZP=function(t){return t.sort(function(){return .5-Math.random()})},XP=function(t){if(Li(t))return t;var s=pd(t)?t:{each:t},n=ym(s.ease),r=s.from||0,a=parseFloat(s.base)||0,o={},d=r>0&&r<1,p=isNaN(r)||d,y=s.axis,v=r,C=r;return Bo(r)?v=C={center:.5,edges:.5,end:1}[r]||0:!d&&p&&(v=r[0],C=r[1]),function(I,O,A){var P=(A||s).length,q=o[P],ce,re,W,Ce,te,oe,ve,ee,ne;if(!q){if(ne=s.grid==="auto"?0:(s.grid||[1,Tc])[1],!ne){for(ve=-Tc;ve<(ve=A[ne++].getBoundingClientRect().left)&&ne<P;);ne--}for(q=o[P]=[],ce=p?Math.min(ne,P)*v-.5:r%ne,re=ne===Tc?0:p?P*C/ne-.5:r/ne|0,ve=0,ee=Tc,oe=0;oe<P;oe++)W=oe%ne-ce,Ce=re-(oe/ne|0),q[oe]=te=y?Math.abs(y==="y"?Ce:W):PP(W*W+Ce*Ce),te>ve&&(ve=te),te<ee&&(ee=te);r==="random"&&ZP(q),q.max=ve-ee,q.min=ee,q.v=P=(parseFloat(s.amount)||parseFloat(s.each)*(ne>P?P-1:y?y==="y"?P/ne:ne:Math.max(ne,P/ne))||0)*(r==="edges"?-1:1),q.b=P<0?a-P:a,q.u=ga(s.amount||s.each)||0,n=n&&P<0?oR(n):n}return P=(q[I]-q.min)/q.max||0,Yo(q.b+(n?n(P):P)*q.v)+q.u}},o2=function(t){var s=Math.pow(10,((t+"").split(".")[1]||"").length);return function(n){var r=Yo(Math.round(parseFloat(n)/t)*t*s);return(r-r%1)/s+(bh(n)?0:ga(n))}},KP=function(t,s){var n=xa(t),r,a;return!n&&pd(t)&&(r=n=t.radius||Tc,t.values?(t=Ac(t.values),(a=!bh(t[0]))&&(r*=r)):t=o2(t.increment)),Jp(s,n?Li(t)?function(o){return a=t(o),Math.abs(a-o)<=r?a:o}:function(o){for(var d=parseFloat(a?o.x:o),p=parseFloat(a?o.y:0),y=Tc,v=0,C=t.length,I,O;C--;)a?(I=t[C].x-d,O=t[C].y-p,I=I*I+O*O):I=Math.abs(t[C]-d),I<y&&(y=I,v=C);return v=!r||y<=r?t[v]:o,a||v===o||bh(o)?v:v+ga(o)}:o2(t))},JP=function(t,s,n,r){return Jp(xa(t)?!s:n===!0?!!(n=0):!r,function(){return xa(t)?t[~~(Math.random()*t.length)]:(n=n||1e-5)&&(r=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((t-n/2+Math.random()*(s-t+n*.99))/n)*n*r)/r})},Hq=function(){for(var t=arguments.length,s=new Array(t),n=0;n<t;n++)s[n]=arguments[n];return function(r){return s.reduce(function(a,o){return o(a)},r)}},Gq=function(t,s){return function(n){return t(parseFloat(n))+(s||ga(n))}},Wq=function(t,s,n){return eR(t,s,0,1,n)},QP=function(t,s,n){return Jp(n,function(r){return t[~~s(r)]})},Yq=function e(t,s,n){var r=s-t;return xa(t)?QP(t,e(0,t.length),s):Jp(n,function(a){return(r+(a-t)%r)%r+t})},Zq=function e(t,s,n){var r=s-t,a=r*2;return xa(t)?QP(t,e(0,t.length-1),s):Jp(n,function(o){return o=(a+(o-t)%a)%a||0,t+(o>r?a-o:o)})},Cv=function(t){for(var s=0,n="",r,a,o,d;~(r=t.indexOf("random(",s));)o=t.indexOf(")",r),d=t.charAt(r+7)==="[",a=t.substr(r+7,o-r-7).match(d?LP:QS),n+=t.substr(s,r-s)+JP(d?a:+a[0],d?0:+a[1],+a[2]||1e-5),s=o+1;return n+t.substr(s,t.length-s)},eR=function(t,s,n,r,a){var o=s-t,d=r-n;return Jp(a,function(p){return n+((p-t)/o*d||0)})},Xq=function e(t,s,n,r){var a=isNaN(t+s)?0:function(O){return(1-O)*t+O*s};if(!a){var o=Bo(t),d={},p,y,v,C,I;if(n===!0&&(r=1)&&(n=null),o)t={p:t},s={p:s};else if(xa(t)&&!xa(s)){for(v=[],C=t.length,I=C-2,y=1;y<C;y++)v.push(e(t[y-1],t[y]));C--,a=function(A){A*=C;var P=Math.min(I,~~A);return v[P](A-P)},n=s}else r||(t=Im(xa(t)?[]:{},t));if(!v){for(p in s)QC.call(d,t,p,"get",s[p]);a=function(A){return nI(A,d)||(o?t.p:t)}}}return Jp(n,a)},_A=function(t,s,n){var r=t.labels,a=Tc,o,d,p;for(o in r)d=r[o]-s,d<0==!!n&&d&&a>(d=Math.abs(d))&&(p=o,a=d);return p},Mc=function(t,s,n){var r=t.vars,a=r[s],o=ho,d=t._ctx,p,y,v;if(!!a)return p=r[s+"Params"],y=r.callbackScope||t,n&&zp.length&&Tb(),d&&(ho=d),v=p?a.apply(y,p):a.call(y),ho=o,v},jy=function(t){return Wp(t),t.scrollTrigger&&t.scrollTrigger.kill(!!ba),t.progress()<1&&Mc(t,"onInterrupt"),t},eg,tR=[],sR=function(t){if(!WC()){tR.push(t);return}t=!t.name&&t.default||t;var s=t.name,n=Li(t),r=s&&!n&&t.init?function(){this._props=[]}:t,a={init:Sv,render:nI,add:QC,kill:hH,modifier:dH,rawVars:0},o={targetTest:0,get:0,getSetter:sI,aliases:{},register:0};if(Ig(),t!==r){if($l[s])return;Nc(r,Nc(Ab(t,a),o)),Im(r.prototype,Im(a,Ab(t,o))),$l[r.prop=s]=r,t.targetTest&&(K1.push(r),XC[s]=1),s=(s==="css"?"CSS":s.charAt(0).toUpperCase()+s.substr(1))+"Plugin"}BP(s,r),t.register&&t.register(dl,r,cl)},Gr=255,qy={aqua:[0,Gr,Gr],lime:[0,Gr,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Gr],navy:[0,0,128],white:[Gr,Gr,Gr],olive:[128,128,0],yellow:[Gr,Gr,0],orange:[Gr,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Gr,0,0],pink:[Gr,192,203],cyan:[0,Gr,Gr],transparent:[Gr,Gr,Gr,0]},nS=function(t,s,n){return t+=t<0?1:t>1?-1:0,(t*6<1?s+(n-s)*t*6:t<.5?n:t*3<2?s+(n-s)*(2/3-t)*6:s)*Gr+.5|0},nR=function(t,s,n){var r=t?bh(t)?[t>>16,t>>8&Gr,t&Gr]:0:qy.black,a,o,d,p,y,v,C,I,O,A;if(!r){if(t.substr(-1)===","&&(t=t.substr(0,t.length-1)),qy[t])r=qy[t];else if(t.charAt(0)==="#"){if(t.length<6&&(a=t.charAt(1),o=t.charAt(2),d=t.charAt(3),t="#"+a+a+o+o+d+d+(t.length===5?t.charAt(4)+t.charAt(4):"")),t.length===9)return r=parseInt(t.substr(1,6),16),[r>>16,r>>8&Gr,r&Gr,parseInt(t.substr(7),16)/255];t=parseInt(t.substr(1),16),r=[t>>16,t>>8&Gr,t&Gr]}else if(t.substr(0,3)==="hsl"){if(r=A=t.match(QS),!s)p=+r[0]%360/360,y=+r[1]/100,v=+r[2]/100,o=v<=.5?v*(y+1):v+y-v*y,a=v*2-o,r.length>3&&(r[3]*=1),r[0]=nS(p+1/3,a,o),r[1]=nS(p,a,o),r[2]=nS(p-1/3,a,o);else if(~t.indexOf("="))return r=t.match($P),n&&r.length<4&&(r[3]=1),r}else r=t.match(QS)||qy.transparent;r=r.map(Number)}return s&&!A&&(a=r[0]/Gr,o=r[1]/Gr,d=r[2]/Gr,C=Math.max(a,o,d),I=Math.min(a,o,d),v=(C+I)/2,C===I?p=y=0:(O=C-I,y=v>.5?O/(2-C-I):O/(C+I),p=C===a?(o-d)/O+(o<d?6:0):C===o?(d-a)/O+2:(a-o)/O+4,p*=60),r[0]=~~(p+.5),r[1]=~~(y*100+.5),r[2]=~~(v*100+.5)),n&&r.length<4&&(r[3]=1),r},rR=function(t){var s=[],n=[],r=-1;return t.split(Up).forEach(function(a){var o=a.match(Q_)||[];s.push.apply(s,o),n.push(r+=o.length+1)}),s.c=n,s},gA=function(t,s,n){var r="",a=(t+r).match(Up),o=s?"hsla(":"rgba(",d=0,p,y,v,C;if(!a)return t;if(a=a.map(function(I){return(I=nR(I,s,1))&&o+(s?I[0]+","+I[1]+"%,"+I[2]+"%,"+I[3]:I.join(","))+")"}),n&&(v=rR(t),p=n.c,p.join(r)!==v.c.join(r)))for(y=t.replace(Up,"1").split(Q_),C=y.length-1;d<C;d++)r+=y[d]+(~p.indexOf(d)?a.shift()||o+"0,0,0,0)":(v.length?v:a.length?a:n).shift());if(!y)for(y=t.split(Up),C=y.length-1;d<C;d++)r+=y[d]+a[d];return r+y[C]},Up=function(){var e="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",t;for(t in qy)e+="|"+t+"\\b";return new RegExp(e+")","gi")}(),Kq=/hsl[a]?\(/,iR=function(t){var s=t.join(" "),n;if(Up.lastIndex=0,Up.test(s))return n=Kq.test(s),t[1]=gA(t[1],n),t[0]=gA(t[0],n,rR(t[1])),!0},Iv,Ll=function(){var e=Date.now,t=500,s=33,n=e(),r=n,a=1e3/240,o=a,d=[],p,y,v,C,I,O,A=function P(q){var ce=e()-r,re=q===!0,W,Ce,te,oe;if(ce>t&&(n+=ce-s),r+=ce,te=r-n,W=te-o,(W>0||re)&&(oe=++C.frame,I=te-C.time*1e3,C.time=te=te/1e3,o+=W+(W>=a?4:a-W),Ce=1),re||(p=y(P)),Ce)for(O=0;O<d.length;O++)d[O](te,I,oe,q)};return C={time:0,frame:0,tick:function(){A(!0)},deltaRatio:function(q){return I/(1e3/(q||60))},wake:function(){NP&&(!e2&&WC()&&(Cc=e2=window,YC=Cc.document||{},Fl.gsap=dl,(Cc.gsapVersions||(Cc.gsapVersions=[])).push(dl.version),DP(Cb||Cc.GreenSockGlobals||!Cc.gsap&&Cc||{}),v=Cc.requestAnimationFrame,tR.forEach(sR)),p&&C.sleep(),y=v||function(q){return setTimeout(q,o-C.time*1e3+1|0)},Iv=1,A(2))},sleep:function(){(v?Cc.cancelAnimationFrame:clearTimeout)(p),Iv=0,y=Sv},lagSmoothing:function(q,ce){t=q||1/0,s=Math.min(ce||33,t)},fps:function(q){a=1e3/(q||240),o=C.time*1e3+a},add:function(q,ce,re){var W=ce?function(Ce,te,oe,ve){q(Ce,te,oe,ve),C.remove(W)}:q;return C.remove(q),d[re?"unshift":"push"](W),Ig(),W},remove:function(q,ce){~(ce=d.indexOf(q))&&d.splice(ce,1)&&O>=ce&&O--},_listeners:d},C}(),Ig=function(){return!Iv&&Ll.wake()},or={},Jq=/^[\d.\-M][\d.\-,\s]/,Qq=/["']/g,eH=function(t){for(var s={},n=t.substr(1,t.length-3).split(":"),r=n[0],a=1,o=n.length,d,p,y;a<o;a++)p=n[a],d=a!==o-1?p.lastIndexOf(","):p.length,y=p.substr(0,d),s[r]=isNaN(y)?y.replace(Qq,"").trim():+y,r=p.substr(d+1).trim();return s},tH=function(t){var s=t.indexOf("(")+1,n=t.indexOf(")"),r=t.indexOf("(",s);return t.substring(s,~r&&r<n?t.indexOf(")",n+1):n)},sH=function(t){var s=(t+"").split("("),n=or[s[0]];return n&&s.length>1&&n.config?n.config.apply(null,~t.indexOf("{")?[eH(s[1])]:tH(t).split(",").map(VP)):or._CE&&Jq.test(t)?or._CE("",t):n},oR=function(t){return function(s){return 1-t(1-s)}},aR=function e(t,s){for(var n=t._first,r;n;)n instanceof nl?e(n,s):n.vars.yoyoEase&&(!n._yoyo||!n._repeat)&&n._yoyo!==s&&(n.timeline?e(n.timeline,s):(r=n._ease,n._ease=n._yEase,n._yEase=r,n._yoyo=s)),n=n._next},ym=function(t,s){return t&&(Li(t)?t:or[t]||sH(t))||s},$m=function(t,s,n,r){n===void 0&&(n=function(p){return 1-s(1-p)}),r===void 0&&(r=function(p){return p<.5?s(p*2)/2:1-s((1-p)*2)/2});var a={easeIn:s,easeOut:n,easeInOut:r},o;return ll(t,function(d){or[d]=Fl[d]=a,or[o=d.toLowerCase()]=n;for(var p in a)or[o+(p==="easeIn"?".in":p==="easeOut"?".out":".inOut")]=or[d+"."+p]=a[p]}),a},lR=function(t){return function(s){return s<.5?(1-t(1-s*2))/2:.5+t((s-.5)*2)/2}},rS=function e(t,s,n){var r=s>=1?s:1,a=(n||(t?.3:.45))/(s<1?s:1),o=a/JS*(Math.asin(1/r)||0),d=function(v){return v===1?1:r*Math.pow(2,-10*v)*kq((v-o)*a)+1},p=t==="out"?d:t==="in"?function(y){return 1-d(1-y)}:lR(d);return a=JS/a,p.config=function(y,v){return e(t,y,v)},p},iS=function e(t,s){s===void 0&&(s=1.70158);var n=function(o){return o?--o*o*((s+1)*o+s)+1:0},r=t==="out"?n:t==="in"?function(a){return 1-n(1-a)}:lR(n);return r.config=function(a){return e(t,a)},r};ll("Linear,Quad,Cubic,Quart,Quint,Strong",function(e,t){var s=t<5?t+1:t;$m(e+",Power"+(s-1),t?function(n){return Math.pow(n,s)}:function(n){return n},function(n){return 1-Math.pow(1-n,s)},function(n){return n<.5?Math.pow(n*2,s)/2:1-Math.pow((1-n)*2,s)/2})});or.Linear.easeNone=or.none=or.Linear.easeIn;$m("Elastic",rS("in"),rS("out"),rS());(function(e,t){var s=1/t,n=2*s,r=2.5*s,a=function(d){return d<s?e*d*d:d<n?e*Math.pow(d-1.5/t,2)+.75:d<r?e*(d-=2.25/t)*d+.9375:e*Math.pow(d-2.625/t,2)+.984375};$m("Bounce",function(o){return 1-a(1-o)},a)})(7.5625,2.75);$m("Expo",function(e){return e?Math.pow(2,10*(e-1)):0});$m("Circ",function(e){return-(PP(1-e*e)-1)});$m("Sine",function(e){return e===1?1:-Eq(e*Aq)+1});$m("Back",iS("in"),iS("out"),iS());or.SteppedEase=or.steps=Fl.SteppedEase={config:function(t,s){t===void 0&&(t=1);var n=1/t,r=t+(s?0:1),a=s?1:0,o=1-Wr;return function(d){return((r*e0(0,o,d)|0)+a)*n}}};wg.ease=or["quad.out"];ll("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(e){return KC+=e+","+e+"Params,"});var cR=function(t,s){this.id=Mq++,t._gsap=this,this.target=t,this.harness=s,this.get=s?s.get:zP,this.set=s?s.getSetter:sI},Tg=function(){function e(s){this.vars=s,this._delay=+s.delay||0,(this._repeat=s.repeat===1/0?-2:s.repeat||0)&&(this._rDelay=s.repeatDelay||0,this._yoyo=!!s.yoyo||!!s.yoyoEase),this._ts=1,Cg(this,+s.duration,1,1),this.data=s.data,ho&&(this._ctx=ho,ho.data.push(this)),Iv||Ll.wake()}var t=e.prototype;return t.delay=function(n){return n||n===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+n-this._delay),this._delay=n,this):this._delay},t.duration=function(n){return arguments.length?this.totalDuration(this._repeat>0?n+(n+this._rDelay)*this._repeat:n):this.totalDuration()&&this._dur},t.totalDuration=function(n){return arguments.length?(this._dirty=0,Cg(this,this._repeat<0?n:(n-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(n,r){if(Ig(),!arguments.length)return this._tTime;var a=this._dp;if(a&&a.smoothChildTiming&&this._ts){for(Cx(this,n),!a._dp||a.parent||HP(a,this);a&&a.parent;)a.parent._time!==a._start+(a._ts>=0?a._tTime/a._ts:(a.totalDuration()-a._tTime)/-a._ts)&&a.totalTime(a._tTime,!0),a=a.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&n<this._tDur||this._ts<0&&n>0||!this._tDur&&!n)&&sd(this._dp,this,this._start-this._delay)}return(this._tTime!==n||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===Wr||!n&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=n),UP(this,n,r)),this},t.time=function(n,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),n+fA(this))%(this._dur+this._rDelay)||(n?this._dur:0),r):this._time},t.totalProgress=function(n,r){return arguments.length?this.totalTime(this.totalDuration()*n,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},t.progress=function(n,r){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-n:n)+fA(this),r):this.duration()?Math.min(1,this._time/this._dur):this.ratio},t.iteration=function(n,r){var a=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(n-1)*a,r):this._repeat?Sg(this._tTime,a)+1:1},t.timeScale=function(n){if(!arguments.length)return this._rts===-Wr?0:this._rts;if(this._rts===n)return this;var r=this.parent&&this._ts?Mb(this.parent._time,this):this._tTime;return this._rts=+n||0,this._ts=this._ps||n===-Wr?0:this._rts,this.totalTime(e0(-Math.abs(this._delay),this._tDur,r),!0),Sx(this),Dq(this)},t.paused=function(n){return arguments.length?(this._ps!==n&&(this._ps=n,n?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Ig(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==Wr&&(this._tTime-=Wr)))),this):this._ps},t.startTime=function(n){if(arguments.length){this._start=n;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&sd(r,this,n-this._delay),this}return this._start},t.endTime=function(n){return this._start+(al(n)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(n){var r=this.parent||this._dp;return r?n&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Mb(r.rawTime(n),this):this._tTime:this._tTime},t.revert=function(n){n===void 0&&(n=$q);var r=ba;return ba=n,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(n),this.totalTime(-.01,n.suppressEvents)),this.data!=="nested"&&n.kill!==!1&&this.kill(),ba=r,this},t.globalTime=function(n){for(var r=this,a=arguments.length?n:r.rawTime();r;)a=r._start+a/(r._ts||1),r=r._dp;return!this.parent&&this._sat?this._sat.vars.immediateRender?-1:this._sat.globalTime(n):a},t.repeat=function(n){return arguments.length?(this._repeat=n===1/0?-2:n,mA(this)):this._repeat===-2?1/0:this._repeat},t.repeatDelay=function(n){if(arguments.length){var r=this._time;return this._rDelay=n,mA(this),r?this.time(r):this}return this._rDelay},t.yoyo=function(n){return arguments.length?(this._yoyo=n,this):this._yoyo},t.seek=function(n,r){return this.totalTime(wc(this,n),al(r))},t.restart=function(n,r){return this.play().totalTime(n?-this._delay:0,al(r))},t.play=function(n,r){return n!=null&&this.seek(n,r),this.reversed(!1).paused(!1)},t.reverse=function(n,r){return n!=null&&this.seek(n||this.totalDuration(),r),this.reversed(!0).paused(!1)},t.pause=function(n,r){return n!=null&&this.seek(n,r),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(n){return arguments.length?(!!n!==this.reversed()&&this.timeScale(-this._rts||(n?-Wr:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-Wr,this},t.isActive=function(){var n=this.parent||this._dp,r=this._start,a;return!!(!n||this._ts&&this._initted&&n.isActive()&&(a=n.rawTime(!0))>=r&&a<this.endTime(!0)-Wr)},t.eventCallback=function(n,r,a){var o=this.vars;return arguments.length>1?(r?(o[n]=r,a&&(o[n+"Params"]=a),n==="onUpdate"&&(this._onUpdate=r)):delete o[n],this):o[n]},t.then=function(n){var r=this;return new Promise(function(a){var o=Li(n)?n:jP,d=function(){var y=r.then;r.then=null,Li(o)&&(o=o(r))&&(o.then||o===r)&&(r.then=y),a(o),r.then=y};r._initted&&r.totalProgress()===1&&r._ts>=0||!r._tTime&&r._ts<0?d():r._prom=d})},t.kill=function(){jy(this)},e}();Nc(Tg.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-Wr,_prom:0,_ps:!1,_rts:1});var nl=function(e){kP(t,e);function t(n,r){var a;return n===void 0&&(n={}),a=e.call(this,n)||this,a.labels={},a.smoothChildTiming=!!n.smoothChildTiming,a.autoRemoveChildren=!!n.autoRemoveChildren,a._sort=al(n.sortChildren),Mi&&sd(n.parent||Mi,ih(a),r),n.reversed&&a.reverse(),n.paused&&a.paused(!0),n.scrollTrigger&&GP(ih(a),n.scrollTrigger),a}var s=t.prototype;return s.to=function(r,a,o){return nv(0,arguments,this),this},s.from=function(r,a,o){return nv(1,arguments,this),this},s.fromTo=function(r,a,o,d){return nv(2,arguments,this),this},s.set=function(r,a,o){return a.duration=0,a.parent=this,sv(a).repeatDelay||(a.repeat=0),a.immediateRender=!!a.immediateRender,new xo(r,a,wc(this,o),1),this},s.call=function(r,a,o){return sd(this,xo.delayedCall(0,r,a),o)},s.staggerTo=function(r,a,o,d,p,y,v){return o.duration=a,o.stagger=o.stagger||d,o.onComplete=y,o.onCompleteParams=v,o.parent=this,new xo(r,o,wc(this,p)),this},s.staggerFrom=function(r,a,o,d,p,y,v){return o.runBackwards=1,sv(o).immediateRender=al(o.immediateRender),this.staggerTo(r,a,o,d,p,y,v)},s.staggerFromTo=function(r,a,o,d,p,y,v,C){return d.startAt=o,sv(d).immediateRender=al(d.immediateRender),this.staggerTo(r,a,d,p,y,v,C)},s.render=function(r,a,o){var d=this._time,p=this._dirty?this.totalDuration():this._tDur,y=this._dur,v=r<=0?0:Yo(r),C=this._zTime<0!=r<0&&(this._initted||!y),I,O,A,P,q,ce,re,W,Ce,te,oe,ve;if(this!==Mi&&v>p&&r>=0&&(v=p),v!==this._tTime||o||C){if(d!==this._time&&y&&(v+=this._time-d,r+=this._time-d),I=v,Ce=this._start,W=this._ts,ce=!W,C&&(y||(d=this._zTime),(r||!a)&&(this._zTime=r)),this._repeat){if(oe=this._yoyo,q=y+this._rDelay,this._repeat<-1&&r<0)return this.totalTime(q*100+r,a,o);if(I=Yo(v%q),v===p?(P=this._repeat,I=y):(P=~~(v/q),P&&P===v/q&&(I=y,P--),I>y&&(I=y)),te=Sg(this._tTime,q),!d&&this._tTime&&te!==P&&this._tTime-te*q-this._dur<=0&&(te=P),oe&&P&1&&(I=y-I,ve=1),P!==te&&!this._lock){var ee=oe&&te&1,ne=ee===(oe&&P&1);if(P<te&&(ee=!ee),d=ee?0:y,this._lock=1,this.render(d||(ve?0:Yo(P*q)),a,!y)._lock=0,this._tTime=v,!a&&this.parent&&Mc(this,"onRepeat"),this.vars.repeatRefresh&&!ve&&(this.invalidate()._lock=1),d&&d!==this._time||ce!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(y=this._dur,p=this._tDur,ne&&(this._lock=2,d=ee?y:-1e-4,this.render(d,!0),this.vars.repeatRefresh&&!ve&&this.invalidate()),this._lock=0,!this._ts&&!ce)return this;aR(this,ve)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(re=Uq(this,Yo(d),Yo(I)),re&&(v-=I-(I=re._start))),this._tTime=v,this._time=I,this._act=!W,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=r,d=0),!d&&I&&!a&&!P&&(Mc(this,"onStart"),this._tTime!==v))return this;if(I>=d&&r>=0)for(O=this._first;O;){if(A=O._next,(O._act||I>=O._start)&&O._ts&&re!==O){if(O.parent!==this)return this.render(r,a,o);if(O.render(O._ts>0?(I-O._start)*O._ts:(O._dirty?O.totalDuration():O._tDur)+(I-O._start)*O._ts,a,o),I!==this._time||!this._ts&&!ce){re=0,A&&(v+=this._zTime=-Wr);break}}O=A}else{O=this._last;for(var Se=r<0?r:I;O;){if(A=O._prev,(O._act||Se<=O._end)&&O._ts&&re!==O){if(O.parent!==this)return this.render(r,a,o);if(O.render(O._ts>0?(Se-O._start)*O._ts:(O._dirty?O.totalDuration():O._tDur)+(Se-O._start)*O._ts,a,o||ba&&(O._initted||O._startAt)),I!==this._time||!this._ts&&!ce){re=0,A&&(v+=this._zTime=Se?-Wr:Wr);break}}O=A}}if(re&&!a&&(this.pause(),re.render(I>=d?0:-Wr)._zTime=I>=d?1:-1,this._ts))return this._start=Ce,Sx(this),this.render(r,a,o);this._onUpdate&&!a&&Mc(this,"onUpdate",!0),(v===p&&this._tTime>=this.totalDuration()||!v&&d)&&(Ce===this._start||Math.abs(W)!==Math.abs(this._ts))&&(this._lock||((r||!y)&&(v===p&&this._ts>0||!v&&this._ts<0)&&Wp(this,1),!a&&!(r<0&&!d)&&(v||d||!p)&&(Mc(this,v===p&&r>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(v<p&&this.timeScale()>0)&&this._prom())))}return this},s.add=function(r,a){var o=this;if(bh(a)||(a=wc(this,a,r)),!(r instanceof Tg)){if(xa(r))return r.forEach(function(d){return o.add(d,a)}),this;if(Bo(r))return this.addLabel(r,a);if(Li(r))r=xo.delayedCall(0,r);else return this}return this!==r?sd(this,r,a):this},s.getChildren=function(r,a,o,d){r===void 0&&(r=!0),a===void 0&&(a=!0),o===void 0&&(o=!0),d===void 0&&(d=-Tc);for(var p=[],y=this._first;y;)y._start>=d&&(y instanceof xo?a&&p.push(y):(o&&p.push(y),r&&p.push.apply(p,y.getChildren(!0,a,o)))),y=y._next;return p},s.getById=function(r){for(var a=this.getChildren(1,1,1),o=a.length;o--;)if(a[o].vars.id===r)return a[o]},s.remove=function(r){return Bo(r)?this.removeLabel(r):Li(r)?this.killTweensOf(r):(wx(this,r),r===this._recent&&(this._recent=this._last),gm(this))},s.totalTime=function(r,a){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Yo(Ll.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),e.prototype.totalTime.call(this,r,a),this._forcing=0,this):this._tTime},s.addLabel=function(r,a){return this.labels[r]=wc(this,a),this},s.removeLabel=function(r){return delete this.labels[r],this},s.addPause=function(r,a,o){var d=xo.delayedCall(0,a||Sv,o);return d.data="isPause",this._hasPause=1,sd(this,d,wc(this,r))},s.removePause=function(r){var a=this._first;for(r=wc(this,r);a;)a._start===r&&a.data==="isPause"&&Wp(a),a=a._next},s.killTweensOf=function(r,a,o){for(var d=this.getTweensOf(r,o),p=d.length;p--;)Op!==d[p]&&d[p].kill(r,a);return this},s.getTweensOf=function(r,a){for(var o=[],d=Ac(r),p=this._first,y=bh(a),v;p;)p instanceof xo?Oq(p._targets,d)&&(y?(!Op||p._initted&&p._ts)&&p.globalTime(0)<=a&&p.globalTime(p.totalDuration())>a:!a||p.isActive())&&o.push(p):(v=p.getTweensOf(d,a)).length&&o.push.apply(o,v),p=p._next;return o},s.tweenTo=function(r,a){a=a||{};var o=this,d=wc(o,r),p=a,y=p.startAt,v=p.onStart,C=p.onStartParams,I=p.immediateRender,O,A=xo.to(o,Nc({ease:a.ease||"none",lazy:!1,immediateRender:!1,time:d,overwrite:"auto",duration:a.duration||Math.abs((d-(y&&"time"in y?y.time:o._time))/o.timeScale())||Wr,onStart:function(){if(o.pause(),!O){var q=a.duration||Math.abs((d-(y&&"time"in y?y.time:o._time))/o.timeScale());A._dur!==q&&Cg(A,q,0,1).render(A._time,!0,!0),O=1}v&&v.apply(A,C||[])}},a));return I?A.render(0):A},s.tweenFromTo=function(r,a,o){return this.tweenTo(a,Nc({startAt:{time:wc(this,r)}},o))},s.recent=function(){return this._recent},s.nextLabel=function(r){return r===void 0&&(r=this._time),_A(this,wc(this,r))},s.previousLabel=function(r){return r===void 0&&(r=this._time),_A(this,wc(this,r),1)},s.currentLabel=function(r){return arguments.length?this.seek(r,!0):this.previousLabel(this._time+Wr)},s.shiftChildren=function(r,a,o){o===void 0&&(o=0);for(var d=this._first,p=this.labels,y;d;)d._start>=o&&(d._start+=r,d._end+=r),d=d._next;if(a)for(y in p)p[y]>=o&&(p[y]+=r);return gm(this)},s.invalidate=function(r){var a=this._first;for(this._lock=0;a;)a.invalidate(r),a=a._next;return e.prototype.invalidate.call(this,r)},s.clear=function(r){r===void 0&&(r=!0);for(var a=this._first,o;a;)o=a._next,this.remove(a),a=o;return this._dp&&(this._time=this._tTime=this._pTime=0),r&&(this.labels={}),gm(this)},s.totalDuration=function(r){var a=0,o=this,d=o._last,p=Tc,y,v,C;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-r:r));if(o._dirty){for(C=o.parent;d;)y=d._prev,d._dirty&&d.totalDuration(),v=d._start,v>p&&o._sort&&d._ts&&!o._lock?(o._lock=1,sd(o,d,v-d._delay,1)._lock=0):p=v,v<0&&d._ts&&(a-=v,(!C&&!o._dp||C&&C.smoothChildTiming)&&(o._start+=v/o._ts,o._time-=v,o._tTime-=v),o.shiftChildren(-v,!1,-1/0),p=0),d._end>a&&d._ts&&(a=d._end),d=y;Cg(o,o===Mi&&o._time>a?o._time:a,1,1),o._dirty=0}return o._tDur},t.updateRoot=function(r){if(Mi._ts&&(UP(Mi,Mb(r,Mi)),FP=Ll.frame),Ll.frame>=hA){hA+=Dl.autoSleep||120;var a=Mi._first;if((!a||!a._ts)&&Dl.autoSleep&&Ll._listeners.length<2){for(;a&&!a._ts;)a=a._next;a||Ll.sleep()}}},t}(Tg);Nc(nl.prototype,{_lock:0,_hasPause:0,_forcing:0});var nH=function(t,s,n,r,a,o,d){var p=new cl(this._pt,t,s,0,1,mR,null,a),y=0,v=0,C,I,O,A,P,q,ce,re;for(p.b=n,p.e=r,n+="",r+="",(ce=~r.indexOf("random("))&&(r=Cv(r)),o&&(re=[n,r],o(re,t,s),n=re[0],r=re[1]),I=n.match(tS)||[];C=tS.exec(r);)A=C[0],P=r.substring(y,C.index),O?O=(O+1)%5:P.substr(-5)==="rgba("&&(O=1),A!==I[v++]&&(q=parseFloat(I[v-1])||0,p._pt={_next:p._pt,p:P||v===1?P:",",s:q,c:A.charAt(1)==="="?ug(q,A)-q:parseFloat(A)-q,m:O&&O<4?Math.round:0},y=tS.lastIndex);return p.c=y<r.length?r.substring(y,r.length):"",p.fp=d,(OP.test(r)||ce)&&(p.e=0),this._pt=p,p},QC=function(t,s,n,r,a,o,d,p,y,v){Li(r)&&(r=r(a||0,t,o));var C=t[s],I=n!=="get"?n:Li(C)?y?t[s.indexOf("set")||!Li(t["get"+s.substr(3)])?s:"get"+s.substr(3)](y):t[s]():C,O=Li(C)?y?lH:pR:tI,A;if(Bo(r)&&(~r.indexOf("random(")&&(r=Cv(r)),r.charAt(1)==="="&&(A=ug(I,r)+(ga(I)||0),(A||A===0)&&(r=A))),!v||I!==r||a2)return!isNaN(I*r)&&r!==""?(A=new cl(this._pt,t,s,+I||0,r-(I||0),typeof C=="boolean"?uH:fR,0,O),y&&(A.fp=y),d&&A.modifier(d,this,t),this._pt=A):(!C&&!(s in t)&&ZC(s,r),nH.call(this,t,s,I,r,O,p||Dl.stringFilter,y))},rH=function(t,s,n,r,a){if(Li(t)&&(t=rv(t,a,s,n,r)),!pd(t)||t.style&&t.nodeType||xa(t)||RP(t))return Bo(t)?rv(t,a,s,n,r):t;var o={},d;for(d in t)o[d]=rv(t[d],a,s,n,r);return o},uR=function(t,s,n,r,a,o){var d,p,y,v;if($l[t]&&(d=new $l[t]).init(a,d.rawVars?s[t]:rH(s[t],r,a,o,n),n,r,o)!==!1&&(n._pt=p=new cl(n._pt,a,t,0,1,d.render,d,0,d.priority),n!==eg))for(y=n._ptLookup[n._targets.indexOf(a)],v=d._props.length;v--;)y[d._props[v]]=p;return d},Op,a2,eI=function e(t,s,n){var r=t.vars,a=r.ease,o=r.startAt,d=r.immediateRender,p=r.lazy,y=r.onUpdate,v=r.onUpdateParams,C=r.callbackScope,I=r.runBackwards,O=r.yoyoEase,A=r.keyframes,P=r.autoRevert,q=t._dur,ce=t._startAt,re=t._targets,W=t.parent,Ce=W&&W.data==="nested"?W.vars.targets:re,te=t._overwrite==="auto"&&!HC,oe=t.timeline,ve,ee,ne,Se,Ue,Qe,Me,vt,Ut,Rt,_t,F,j;if(oe&&(!A||!a)&&(a="none"),t._ease=ym(a,wg.ease),t._yEase=O?oR(ym(O===!0?a:O,wg.ease)):0,O&&t._yoyo&&!t._repeat&&(O=t._yEase,t._yEase=t._ease,t._ease=O),t._from=!oe&&!!r.runBackwards,!oe||A&&!r.stagger){if(vt=re[0]?_m(re[0]).harness:0,F=vt&&r[vt.prop],ve=Ab(r,XC),ce&&(ce._zTime<0&&ce.progress(1),s<0&&I&&d&&!P?ce.render(-1,!0):ce.revert(I&&q?X1:Rq),ce._lazy=0),o){if(Wp(t._startAt=xo.set(re,Nc({data:"isStart",overwrite:!1,parent:W,immediateRender:!0,lazy:!ce&&al(p),startAt:null,delay:0,onUpdate:y,onUpdateParams:v,callbackScope:C,stagger:0},o))),t._startAt._dp=0,t._startAt._sat=t,s<0&&(ba||!d&&!P)&&t._startAt.revert(X1),d&&q&&s<=0&&n<=0){s&&(t._zTime=s);return}}else if(I&&q&&!ce){if(s&&(d=!1),ne=Nc({overwrite:!1,data:"isFromStart",lazy:d&&!ce&&al(p),immediateRender:d,stagger:0,parent:W},ve),F&&(ne[vt.prop]=F),Wp(t._startAt=xo.set(re,ne)),t._startAt._dp=0,t._startAt._sat=t,s<0&&(ba?t._startAt.revert(X1):t._startAt.render(-1,!0)),t._zTime=s,!d)e(t._startAt,Wr,Wr);else if(!s)return}for(t._pt=t._ptCache=0,p=q&&al(p)||p&&!q,ee=0;ee<re.length;ee++){if(Ue=re[ee],Me=Ue._gsap||JC(re)[ee]._gsap,t._ptLookup[ee]=Rt={},t2[Me.id]&&zp.length&&Tb(),_t=Ce===re?ee:Ce.indexOf(Ue),vt&&(Ut=new vt).init(Ue,F||ve,t,_t,Ce)!==!1&&(t._pt=Se=new cl(t._pt,Ue,Ut.name,0,1,Ut.render,Ut,0,Ut.priority),Ut._props.forEach(function(G){Rt[G]=Se}),Ut.priority&&(Qe=1)),!vt||F)for(ne in ve)$l[ne]&&(Ut=uR(ne,ve,t,_t,Ue,Ce))?Ut.priority&&(Qe=1):Rt[ne]=Se=QC.call(t,Ue,ne,"get",ve[ne],_t,Ce,0,r.stringFilter);t._op&&t._op[ee]&&t.kill(Ue,t._op[ee]),te&&t._pt&&(Op=t,Mi.killTweensOf(Ue,Rt,t.globalTime(s)),j=!t.parent,Op=0),t._pt&&p&&(t2[Me.id]=1)}Qe&&_R(t),t._onInit&&t._onInit(t)}t._onUpdate=y,t._initted=(!t._op||t._pt)&&!j,A&&s<=0&&oe.render(Tc,!0,!0)},iH=function(t,s,n,r,a,o,d){var p=(t._pt&&t._ptCache||(t._ptCache={}))[s],y,v,C,I;if(!p)for(p=t._ptCache[s]=[],C=t._ptLookup,I=t._targets.length;I--;){if(y=C[I][s],y&&y.d&&y.d._pt)for(y=y.d._pt;y&&y.p!==s&&y.fp!==s;)y=y._next;if(!y)return a2=1,t.vars[s]="+=0",eI(t,d),a2=0,1;p.push(y)}for(I=p.length;I--;)v=p[I],y=v._pt||v,y.s=(r||r===0)&&!a?r:y.s+(r||0)+o*y.c,y.c=n-y.s,v.e&&(v.e=Xi(n)+ga(v.e)),v.b&&(v.b=y.s+ga(v.b))},oH=function(t,s){var n=t[0]?_m(t[0]).harness:0,r=n&&n.aliases,a,o,d,p;if(!r)return s;a=Im({},s);for(o in r)if(o in a)for(p=r[o].split(","),d=p.length;d--;)a[p[d]]=a[o];return a},aH=function(t,s,n,r){var a=s.ease||r||"power1.inOut",o,d;if(xa(s))d=n[t]||(n[t]=[]),s.forEach(function(p,y){return d.push({t:y/(s.length-1)*100,v:p,e:a})});else for(o in s)d=n[o]||(n[o]=[]),o==="ease"||d.push({t:parseFloat(t),v:s[o],e:a})},rv=function(t,s,n,r,a){return Li(t)?t.call(s,n,r,a):Bo(t)&&~t.indexOf("random(")?Cv(t):t},dR=KC+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",hR={};ll(dR+",id,stagger,delay,duration,paused,scrollTrigger",function(e){return hR[e]=1});var xo=function(e){kP(t,e);function t(n,r,a,o){var d;typeof r=="number"&&(a.duration=r,r=a,a=null),d=e.call(this,o?r:sv(r))||this;var p=d.vars,y=p.duration,v=p.delay,C=p.immediateRender,I=p.stagger,O=p.overwrite,A=p.keyframes,P=p.defaults,q=p.scrollTrigger,ce=p.yoyoEase,re=r.parent||Mi,W=(xa(n)||RP(n)?bh(n[0]):"length"in r)?[n]:Ac(n),Ce,te,oe,ve,ee,ne,Se,Ue;if(d._targets=W.length?JC(W):Ib("GSAP target "+n+" not found. https://greensock.com",!Dl.nullTargetWarn)||[],d._ptLookup=[],d._overwrite=O,A||I||E1(y)||E1(v)){if(r=d.vars,Ce=d.timeline=new nl({data:"nested",defaults:P||{},targets:re&&re.data==="nested"?re.vars.targets:W}),Ce.kill(),Ce.parent=Ce._dp=ih(d),Ce._start=0,I||E1(y)||E1(v)){if(ve=W.length,Se=I&&XP(I),pd(I))for(ee in I)~dR.indexOf(ee)&&(Ue||(Ue={}),Ue[ee]=I[ee]);for(te=0;te<ve;te++)oe=Ab(r,hR),oe.stagger=0,ce&&(oe.yoyoEase=ce),Ue&&Im(oe,Ue),ne=W[te],oe.duration=+rv(y,ih(d),te,ne,W),oe.delay=(+rv(v,ih(d),te,ne,W)||0)-d._delay,!I&&ve===1&&oe.delay&&(d._delay=v=oe.delay,d._start+=v,oe.delay=0),Ce.to(ne,oe,Se?Se(te,ne,W):0),Ce._ease=or.none;Ce.duration()?y=v=0:d.timeline=0}else if(A){sv(Nc(Ce.vars.defaults,{ease:"none"})),Ce._ease=ym(A.ease||r.ease||"none");var Qe=0,Me,vt,Ut;if(xa(A))A.forEach(function(Rt){return Ce.to(W,Rt,">")}),Ce.duration();else{oe={};for(ee in A)ee==="ease"||ee==="easeEach"||aH(ee,A[ee],oe,A.easeEach);for(ee in oe)for(Me=oe[ee].sort(function(Rt,_t){return Rt.t-_t.t}),Qe=0,te=0;te<Me.length;te++)vt=Me[te],Ut={ease:vt.e,duration:(vt.t-(te?Me[te-1].t:0))/100*y},Ut[ee]=vt.v,Ce.to(W,Ut,Qe),Qe+=Ut.duration;Ce.duration()<y&&Ce.to({},{duration:y-Ce.duration()})}}y||d.duration(y=Ce.duration())}else d.timeline=0;return O===!0&&!HC&&(Op=ih(d),Mi.killTweensOf(W),Op=0),sd(re,ih(d),a),r.reversed&&d.reverse(),r.paused&&d.paused(!0),(C||!y&&!A&&d._start===Yo(re._time)&&al(C)&&Bq(ih(d))&&re.data!=="nested")&&(d._tTime=-Wr,d.render(Math.max(0,-v)||0)),q&&GP(ih(d),q),d}var s=t.prototype;return s.render=function(r,a,o){var d=this._time,p=this._tDur,y=this._dur,v=r<0,C=r>p-Wr&&!v?p:r<Wr?0:r,I,O,A,P,q,ce,re,W,Ce;if(!y)zq(this,r,a,o);else if(C!==this._tTime||!r||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==v){if(I=C,W=this.timeline,this._repeat){if(P=y+this._rDelay,this._repeat<-1&&v)return this.totalTime(P*100+r,a,o);if(I=Yo(C%P),C===p?(A=this._repeat,I=y):(A=~~(C/P),A&&A===C/P&&(I=y,A--),I>y&&(I=y)),ce=this._yoyo&&A&1,ce&&(Ce=this._yEase,I=y-I),q=Sg(this._tTime,P),I===d&&!o&&this._initted)return this._tTime=C,this;A!==q&&(W&&this._yEase&&aR(W,ce),this.vars.repeatRefresh&&!ce&&!this._lock&&(this._lock=o=1,this.render(Yo(P*A),!0).invalidate()._lock=0))}if(!this._initted){if(WP(this,v?r:I,o,a,C))return this._tTime=0,this;if(d!==this._time)return this;if(y!==this._dur)return this.render(r,a,o)}if(this._tTime=C,this._time=I,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=re=(Ce||this._ease)(I/y),this._from&&(this.ratio=re=1-re),I&&!d&&!a&&!A&&(Mc(this,"onStart"),this._tTime!==C))return this;for(O=this._pt;O;)O.r(re,O.d),O=O._next;W&&W.render(r<0?r:!I&&ce?-Wr:W._dur*W._ease(I/this._dur),a,o)||this._startAt&&(this._zTime=r),this._onUpdate&&!a&&(v&&s2(this,r,a,o),Mc(this,"onUpdate")),this._repeat&&A!==q&&this.vars.onRepeat&&!a&&this.parent&&Mc(this,"onRepeat"),(C===this._tDur||!C)&&this._tTime===C&&(v&&!this._onUpdate&&s2(this,r,!0,!0),(r||!y)&&(C===this._tDur&&this._ts>0||!C&&this._ts<0)&&Wp(this,1),!a&&!(v&&!d)&&(C||d||ce)&&(Mc(this,C===p?"onComplete":"onReverseComplete",!0),this._prom&&!(C<p&&this.timeScale()>0)&&this._prom()))}return this},s.targets=function(){return this._targets},s.invalidate=function(r){return(!r||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(r),e.prototype.invalidate.call(this,r)},s.resetTo=function(r,a,o,d){Iv||Ll.wake(),this._ts||this.play();var p=Math.min(this._dur,(this._dp._time-this._start)*this._ts),y;return this._initted||eI(this,p),y=this._ease(p/this._dur),iH(this,r,a,o,d,y,p)?this.resetTo(r,a,o,d):(Cx(this,0),this.parent||qP(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},s.kill=function(r,a){if(a===void 0&&(a="all"),!r&&(!a||a==="all"))return this._lazy=this._pt=0,this.parent?jy(this):this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(r,a,Op&&Op.vars.overwrite!==!0)._first||jy(this),this.parent&&o!==this.timeline.totalDuration()&&Cg(this,this._dur*this.timeline._tDur/o,0,1),this}var d=this._targets,p=r?Ac(r):d,y=this._ptLookup,v=this._pt,C,I,O,A,P,q,ce;if((!a||a==="all")&&Nq(d,p))return a==="all"&&(this._pt=0),jy(this);for(C=this._op=this._op||[],a!=="all"&&(Bo(a)&&(P={},ll(a,function(re){return P[re]=1}),a=P),a=oH(d,a)),ce=d.length;ce--;)if(~p.indexOf(d[ce])){I=y[ce],a==="all"?(C[ce]=a,A=I,O={}):(O=C[ce]=C[ce]||{},A=a);for(P in A)q=I&&I[P],q&&((!("kill"in q.d)||q.d.kill(P)===!0)&&wx(this,q,"_pt"),delete I[P]),O!=="all"&&(O[P]=1)}return this._initted&&!this._pt&&v&&jy(this),this},t.to=function(r,a){return new t(r,a,arguments[2])},t.from=function(r,a){return nv(1,arguments)},t.delayedCall=function(r,a,o,d){return new t(a,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:r,onComplete:a,onReverseComplete:a,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:d})},t.fromTo=function(r,a,o){return nv(2,arguments)},t.set=function(r,a){return a.duration=0,a.repeatDelay||(a.repeat=0),new t(r,a)},t.killTweensOf=function(r,a,o){return Mi.killTweensOf(r,a,o)},t}(Tg);Nc(xo.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});ll("staggerTo,staggerFrom,staggerFromTo",function(e){xo[e]=function(){var t=new nl,s=r2.call(arguments,0);return s.splice(e==="staggerFromTo"?5:4,0,0),t[e].apply(t,s)}});var tI=function(t,s,n){return t[s]=n},pR=function(t,s,n){return t[s](n)},lH=function(t,s,n,r){return t[s](r.fp,n)},cH=function(t,s,n){return t.setAttribute(s,n)},sI=function(t,s){return Li(t[s])?pR:GC(t[s])&&t.setAttribute?cH:tI},fR=function(t,s){return s.set(s.t,s.p,Math.round((s.s+s.c*t)*1e6)/1e6,s)},uH=function(t,s){return s.set(s.t,s.p,!!(s.s+s.c*t),s)},mR=function(t,s){var n=s._pt,r="";if(!t&&s.b)r=s.b;else if(t===1&&s.e)r=s.e;else{for(;n;)r=n.p+(n.m?n.m(n.s+n.c*t):Math.round((n.s+n.c*t)*1e4)/1e4)+r,n=n._next;r+=s.c}s.set(s.t,s.p,r,s)},nI=function(t,s){for(var n=s._pt;n;)n.r(t,n.d),n=n._next},dH=function(t,s,n,r){for(var a=this._pt,o;a;)o=a._next,a.p===r&&a.modifier(t,s,n),a=o},hH=function(t){for(var s=this._pt,n,r;s;)r=s._next,s.p===t&&!s.op||s.op===t?wx(this,s,"_pt"):s.dep||(n=1),s=r;return!n},pH=function(t,s,n,r){r.mSet(t,s,r.m.call(r.tween,n,r.mt),r)},_R=function(t){for(var s=t._pt,n,r,a,o;s;){for(n=s._next,r=a;r&&r.pr>s.pr;)r=r._next;(s._prev=r?r._prev:o)?s._prev._next=s:a=s,(s._next=r)?r._prev=s:o=s,s=n}t._pt=a},cl=function(){function e(s,n,r,a,o,d,p,y,v){this.t=n,this.s=a,this.c=o,this.p=r,this.r=d||fR,this.d=p||this,this.set=y||tI,this.pr=v||0,this._next=s,s&&(s._prev=this)}var t=e.prototype;return t.modifier=function(n,r,a){this.mSet=this.mSet||this.set,this.set=pH,this.m=n,this.mt=a,this.tween=r},e}();ll(KC+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(e){return XC[e]=1});Fl.TweenMax=Fl.TweenLite=xo;Fl.TimelineLite=Fl.TimelineMax=nl;Mi=new nl({sortChildren:!1,defaults:wg,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});Dl.stringFilter=iR;var Ag=[],J1={},fH=[],yA=0,oS=function(t){return(J1[t]||fH).map(function(s){return s()})},l2=function(){var t=Date.now(),s=[];t-yA>2&&(oS("matchMediaInit"),Ag.forEach(function(n){var r=n.queries,a=n.conditions,o,d,p,y;for(d in r)o=Cc.matchMedia(r[d]).matches,o&&(p=1),o!==a[d]&&(a[d]=o,y=1);y&&(n.revert(),p&&s.push(n))}),oS("matchMediaRevert"),s.forEach(function(n){return n.onMatch(n)}),yA=t,oS("matchMedia"))},gR=function(){function e(s,n){this.selector=n&&i2(n),this.data=[],this._r=[],this.isReverted=!1,s&&this.add(s)}var t=e.prototype;return t.add=function(n,r,a){Li(n)&&(a=r,r=n,n=Li);var o=this,d=function(){var y=ho,v=o.selector,C;return y&&y!==o&&y.data.push(o),a&&(o.selector=i2(a)),ho=o,C=r.apply(o,arguments),Li(C)&&o._r.push(C),ho=y,o.selector=v,o.isReverted=!1,C};return o.last=d,n===Li?d(o):n?o[n]=d:d},t.ignore=function(n){var r=ho;ho=null,n(this),ho=r},t.getTweens=function(){var n=[];return this.data.forEach(function(r){return r instanceof e?n.push.apply(n,r.getTweens()):r instanceof xo&&!(r.parent&&r.parent.data==="nested")&&n.push(r)}),n},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(n,r){var a=this;if(n){var o=this.getTweens();this.data.forEach(function(p){p.data==="isFlip"&&(p.revert(),p.getChildren(!0,!0,!1).forEach(function(y){return o.splice(o.indexOf(y),1)}))}),o.map(function(p){return{g:p.globalTime(0),t:p}}).sort(function(p,y){return y.g-p.g||-1}).forEach(function(p){return p.t.revert(n)}),this.data.forEach(function(p){return!(p instanceof Tg)&&p.revert&&p.revert(n)}),this._r.forEach(function(p){return p(n,a)}),this.isReverted=!0}else this.data.forEach(function(p){return p.kill&&p.kill()});if(this.clear(),r){var d=Ag.indexOf(this);~d&&Ag.splice(d,1)}},t.revert=function(n){this.kill(n||{})},e}(),mH=function(){function e(s){this.contexts=[],this.scope=s}var t=e.prototype;return t.add=function(n,r,a){pd(n)||(n={matches:n});var o=new gR(0,a||this.scope),d=o.conditions={},p,y,v;this.contexts.push(o),r=o.add("onMatch",r),o.queries=n;for(y in n)y==="all"?v=1:(p=Cc.matchMedia(n[y]),p&&(Ag.indexOf(o)<0&&Ag.push(o),(d[y]=p.matches)&&(v=1),p.addListener?p.addListener(l2):p.addEventListener("change",l2)));return v&&r(o),this},t.revert=function(n){this.kill(n||{})},t.kill=function(n){this.contexts.forEach(function(r){return r.kill(n,!0)})},e}(),Eb={registerPlugin:function(){for(var t=arguments.length,s=new Array(t),n=0;n<t;n++)s[n]=arguments[n];s.forEach(function(r){return sR(r)})},timeline:function(t){return new nl(t)},getTweensOf:function(t,s){return Mi.getTweensOf(t,s)},getProperty:function(t,s,n,r){Bo(t)&&(t=Ac(t)[0]);var a=_m(t||{}).get,o=n?jP:VP;return n==="native"&&(n=""),t&&(s?o(($l[s]&&$l[s].get||a)(t,s,n,r)):function(d,p,y){return o(($l[d]&&$l[d].get||a)(t,d,p,y))})},quickSetter:function(t,s,n){if(t=Ac(t),t.length>1){var r=t.map(function(v){return dl.quickSetter(v,s,n)}),a=r.length;return function(v){for(var C=a;C--;)r[C](v)}}t=t[0]||{};var o=$l[s],d=_m(t),p=d.harness&&(d.harness.aliases||{})[s]||s,y=o?function(v){var C=new o;eg._pt=0,C.init(t,n?v+n:v,eg,0,[t]),C.render(1,C),eg._pt&&nI(1,eg)}:d.set(t,p);return o?y:function(v){return y(t,p,n?v+n:v,d,1)}},quickTo:function(t,s,n){var r,a=dl.to(t,Im((r={},r[s]="+=0.1",r.paused=!0,r),n||{})),o=function(p,y,v){return a.resetTo(s,p,y,v)};return o.tween=a,o},isTweening:function(t){return Mi.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=ym(t.ease,wg.ease)),pA(wg,t||{})},config:function(t){return pA(Dl,t||{})},registerEffect:function(t){var s=t.name,n=t.effect,r=t.plugins,a=t.defaults,o=t.extendTimeline;(r||"").split(",").forEach(function(d){return d&&!$l[d]&&!Fl[d]&&Ib(s+" effect requires "+d+" plugin.")}),sS[s]=function(d,p,y){return n(Ac(d),Nc(p||{},a),y)},o&&(nl.prototype[s]=function(d,p,y){return this.add(sS[s](d,pd(p)?p:(y=p)&&{},this),y)})},registerEase:function(t,s){or[t]=ym(s)},parseEase:function(t,s){return arguments.length?ym(t,s):or},getById:function(t){return Mi.getById(t)},exportRoot:function(t,s){t===void 0&&(t={});var n=new nl(t),r,a;for(n.smoothChildTiming=al(t.smoothChildTiming),Mi.remove(n),n._dp=0,n._time=n._tTime=Mi._time,r=Mi._first;r;)a=r._next,(s||!(!r._dur&&r instanceof xo&&r.vars.onComplete===r._targets[0]))&&sd(n,r,r._start-r._delay),r=a;return sd(Mi,n,0),n},context:function(t,s){return t?new gR(t,s):ho},matchMedia:function(t){return new mH(t)},matchMediaRefresh:function(){return Ag.forEach(function(t){var s=t.conditions,n,r;for(r in s)s[r]&&(s[r]=!1,n=1);n&&t.revert()})||l2()},addEventListener:function(t,s){var n=J1[t]||(J1[t]=[]);~n.indexOf(s)||n.push(s)},removeEventListener:function(t,s){var n=J1[t],r=n&&n.indexOf(s);r>=0&&n.splice(r,1)},utils:{wrap:Yq,wrapYoyo:Zq,distribute:XP,random:JP,snap:KP,normalize:Wq,getUnit:ga,clamp:jq,splitColor:nR,toArray:Ac,selector:i2,mapRange:eR,pipe:Hq,unitize:Gq,interpolate:Xq,shuffle:ZP},install:DP,effects:sS,ticker:Ll,updateRoot:nl.updateRoot,plugins:$l,globalTimeline:Mi,core:{PropTween:cl,globals:BP,Tween:xo,Timeline:nl,Animation:Tg,getCache:_m,_removeLinkedListItem:wx,reverting:function(){return ba},context:function(t){return t&&ho&&(ho.data.push(t),t._ctx=ho),ho},suppressOverwrites:function(t){return HC=t}}};ll("to,from,fromTo,delayedCall,set,killTweensOf",function(e){return Eb[e]=xo[e]});Ll.add(nl.updateRoot);eg=Eb.to({},{duration:0});var _H=function(t,s){for(var n=t._pt;n&&n.p!==s&&n.op!==s&&n.fp!==s;)n=n._next;return n},gH=function(t,s){var n=t._targets,r,a,o;for(r in s)for(a=n.length;a--;)o=t._ptLookup[a][r],o&&(o=o.d)&&(o._pt&&(o=_H(o,r)),o&&o.modifier&&o.modifier(s[r],t,n[a],r))},aS=function(t,s){return{name:t,rawVars:1,init:function(r,a,o){o._onInit=function(d){var p,y;if(Bo(a)&&(p={},ll(a,function(v){return p[v]=1}),a=p),s){p={};for(y in a)p[y]=s(a[y]);a=p}gH(d,a)}}}},dl=Eb.registerPlugin({name:"attr",init:function(t,s,n,r,a){var o,d,p;this.tween=n;for(o in s)p=t.getAttribute(o)||"",d=this.add(t,"setAttribute",(p||0)+"",s[o],r,a,0,0,o),d.op=o,d.b=p,this._props.push(o)},render:function(t,s){for(var n=s._pt;n;)ba?n.set(n.t,n.p,n.b,n):n.r(t,n.d),n=n._next}},{name:"endArray",init:function(t,s){for(var n=s.length;n--;)this.add(t,n,t[n]||0,s[n],0,0,0,0,0,1)}},aS("roundProps",o2),aS("modifiers"),aS("snap",KP))||Eb;xo.version=nl.version=dl.version="3.11.5";NP=1;WC()&&Ig();or.Power0;or.Power1;or.Power2;or.Power3;or.Power4;or.Linear;or.Quad;or.Cubic;or.Quart;or.Quint;or.Strong;or.Elastic;or.Back;or.SteppedEase;or.Bounce;or.Sine;or.Expo;or.Circ;/*!
 * CSSPlugin 3.11.5
 * https://greensock.com
 *
 * Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var vA,Lp,dg,rI,lm,bA,iI,yH=function(){return typeof window<"u"},xh={},Kf=180/Math.PI,hg=Math.PI/180,H_=Math.atan2,xA=1e8,oI=/([A-Z])/g,vH=/(left|right|width|margin|padding|x)/i,bH=/[\s,\(]\S/,rd={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},c2=function(t,s){return s.set(s.t,s.p,Math.round((s.s+s.c*t)*1e4)/1e4+s.u,s)},xH=function(t,s){return s.set(s.t,s.p,t===1?s.e:Math.round((s.s+s.c*t)*1e4)/1e4+s.u,s)},wH=function(t,s){return s.set(s.t,s.p,t?Math.round((s.s+s.c*t)*1e4)/1e4+s.u:s.b,s)},SH=function(t,s){var n=s.s+s.c*t;s.set(s.t,s.p,~~(n+(n<0?-.5:.5))+s.u,s)},yR=function(t,s){return s.set(s.t,s.p,t?s.e:s.b,s)},vR=function(t,s){return s.set(s.t,s.p,t!==1?s.b:s.e,s)},CH=function(t,s,n){return t.style[s]=n},IH=function(t,s,n){return t.style.setProperty(s,n)},TH=function(t,s,n){return t._gsap[s]=n},AH=function(t,s,n){return t._gsap.scaleX=t._gsap.scaleY=n},MH=function(t,s,n,r,a){var o=t._gsap;o.scaleX=o.scaleY=n,o.renderTransform(a,o)},EH=function(t,s,n,r,a){var o=t._gsap;o[s]=n,o.renderTransform(a,o)},Ei="transform",bu=Ei+"Origin",kH=function e(t,s){var n=this,r=this.target,a=r.style;if(t in xh){if(this.tfm=this.tfm||{},t!=="transform")t=rd[t]||t,~t.indexOf(",")?t.split(",").forEach(function(o){return n.tfm[o]=oh(r,o)}):this.tfm[t]=r._gsap.x?r._gsap[t]:oh(r,t);else return rd.transform.split(",").forEach(function(o){return e.call(n,o,s)});if(this.props.indexOf(Ei)>=0)return;r._gsap.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(bu,s,"")),t=Ei}(a||s)&&this.props.push(t,s,a[t])},bR=function(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},PH=function(){var t=this.props,s=this.target,n=s.style,r=s._gsap,a,o;for(a=0;a<t.length;a+=3)t[a+1]?s[t[a]]=t[a+2]:t[a+2]?n[t[a]]=t[a+2]:n.removeProperty(t[a].substr(0,2)==="--"?t[a]:t[a].replace(oI,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)r[o]=this.tfm[o];r.svg&&(r.renderTransform(),s.setAttribute("data-svg-origin",this.svgo||"")),a=iI(),(!a||!a.isStart)&&!n[Ei]&&(bR(n),r.uncache=1)}},xR=function(t,s){var n={target:t,props:[],revert:PH,save:kH};return t._gsap||dl.core.getCache(t),s&&s.split(",").forEach(function(r){return n.save(r)}),n},wR,u2=function(t,s){var n=Lp.createElementNS?Lp.createElementNS((s||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):Lp.createElement(t);return n.style?n:Lp.createElement(t)},ad=function e(t,s,n){var r=getComputedStyle(t);return r[s]||r.getPropertyValue(s.replace(oI,"-$1").toLowerCase())||r.getPropertyValue(s)||!n&&e(t,Mg(s)||s,1)||""},wA="O,Moz,ms,Ms,Webkit".split(","),Mg=function(t,s,n){var r=s||lm,a=r.style,o=5;if(t in a&&!n)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);o--&&!(wA[o]+t in a););return o<0?null:(o===3?"ms":o>=0?wA[o]:"")+t},d2=function(){yH()&&window.document&&(vA=window,Lp=vA.document,dg=Lp.documentElement,lm=u2("div")||{style:{}},u2("div"),Ei=Mg(Ei),bu=Ei+"Origin",lm.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",wR=!!Mg("perspective"),iI=dl.core.reverting,rI=1)},lS=function e(t){var s=u2("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),n=this.parentNode,r=this.nextSibling,a=this.style.cssText,o;if(dg.appendChild(s),s.appendChild(this),this.style.display="block",t)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=e}catch{}else this._gsapBBox&&(o=this._gsapBBox());return n&&(r?n.insertBefore(this,r):n.appendChild(this)),dg.removeChild(s),this.style.cssText=a,o},SA=function(t,s){for(var n=s.length;n--;)if(t.hasAttribute(s[n]))return t.getAttribute(s[n])},SR=function(t){var s;try{s=t.getBBox()}catch{s=lS.call(t,!0)}return s&&(s.width||s.height)||t.getBBox===lS||(s=lS.call(t,!0)),s&&!s.width&&!s.x&&!s.y?{x:+SA(t,["x","cx","x1"])||0,y:+SA(t,["y","cy","y1"])||0,width:0,height:0}:s},CR=function(t){return!!(t.getCTM&&(!t.parentNode||t.ownerSVGElement)&&SR(t))},Tv=function(t,s){if(s){var n=t.style;s in xh&&s!==bu&&(s=Ei),n.removeProperty?((s.substr(0,2)==="ms"||s.substr(0,6)==="webkit")&&(s="-"+s),n.removeProperty(s.replace(oI,"-$1").toLowerCase())):n.removeAttribute(s)}},Np=function(t,s,n,r,a,o){var d=new cl(t._pt,s,n,0,1,o?vR:yR);return t._pt=d,d.b=r,d.e=a,t._props.push(n),d},CA={deg:1,rad:1,turn:1},RH={grid:1,flex:1},Yp=function e(t,s,n,r){var a=parseFloat(n)||0,o=(n+"").trim().substr((a+"").length)||"px",d=lm.style,p=vH.test(s),y=t.tagName.toLowerCase()==="svg",v=(y?"client":"offset")+(p?"Width":"Height"),C=100,I=r==="px",O=r==="%",A,P,q,ce;return r===o||!a||CA[r]||CA[o]?a:(o!=="px"&&!I&&(a=e(t,s,n,"px")),ce=t.getCTM&&CR(t),(O||o==="%")&&(xh[s]||~s.indexOf("adius"))?(A=ce?t.getBBox()[p?"width":"height"]:t[v],Xi(O?a/A*C:a/100*A)):(d[p?"width":"height"]=C+(I?o:r),P=~s.indexOf("adius")||r==="em"&&t.appendChild&&!y?t:t.parentNode,ce&&(P=(t.ownerSVGElement||{}).parentNode),(!P||P===Lp||!P.appendChild)&&(P=Lp.body),q=P._gsap,q&&O&&q.width&&p&&q.time===Ll.time&&!q.uncache?Xi(a/q.width*C):((O||o==="%")&&!RH[ad(P,"display")]&&(d.position=ad(t,"position")),P===t&&(d.position="static"),P.appendChild(lm),A=lm[v],P.removeChild(lm),d.position="absolute",p&&O&&(q=_m(P),q.time=Ll.time,q.width=P[v]),Xi(I?A*a/C:A&&a?C/A*a:0))))},oh=function(t,s,n,r){var a;return rI||d2(),s in rd&&s!=="transform"&&(s=rd[s],~s.indexOf(",")&&(s=s.split(",")[0])),xh[s]&&s!=="transform"?(a=Mv(t,r),a=s!=="transformOrigin"?a[s]:a.svg?a.origin:Pb(ad(t,bu))+" "+a.zOrigin+"px"):(a=t.style[s],(!a||a==="auto"||r||~(a+"").indexOf("calc("))&&(a=kb[s]&&kb[s](t,s,n)||ad(t,s)||zP(t,s)||(s==="opacity"?1:0))),n&&!~(a+"").trim().indexOf(" ")?Yp(t,s,a,n)+n:a},$H=function(t,s,n,r){if(!n||n==="none"){var a=Mg(s,t,1),o=a&&ad(t,a,1);o&&o!==n?(s=a,n=o):s==="borderColor"&&(n=ad(t,"borderTopColor"))}var d=new cl(this._pt,t.style,s,0,1,mR),p=0,y=0,v,C,I,O,A,P,q,ce,re,W,Ce,te;if(d.b=n,d.e=r,n+="",r+="",r==="auto"&&(t.style[s]=r,r=ad(t,s)||r,t.style[s]=n),v=[n,r],iR(v),n=v[0],r=v[1],I=n.match(Q_)||[],te=r.match(Q_)||[],te.length){for(;C=Q_.exec(r);)q=C[0],re=r.substring(p,C.index),A?A=(A+1)%5:(re.substr(-5)==="rgba("||re.substr(-5)==="hsla(")&&(A=1),q!==(P=I[y++]||"")&&(O=parseFloat(P)||0,Ce=P.substr((O+"").length),q.charAt(1)==="="&&(q=ug(O,q)+Ce),ce=parseFloat(q),W=q.substr((ce+"").length),p=Q_.lastIndex-W.length,W||(W=W||Dl.units[s]||Ce,p===r.length&&(r+=W,d.e+=W)),Ce!==W&&(O=Yp(t,s,P,W)||0),d._pt={_next:d._pt,p:re||y===1?re:",",s:O,c:ce-O,m:A&&A<4||s==="zIndex"?Math.round:0});d.c=p<r.length?r.substring(p,r.length):""}else d.r=s==="display"&&r==="none"?vR:yR;return OP.test(r)&&(d.e=0),this._pt=d,d},IA={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},OH=function(t){var s=t.split(" "),n=s[0],r=s[1]||"50%";return(n==="top"||n==="bottom"||r==="left"||r==="right")&&(t=n,n=r,r=t),s[0]=IA[n]||n,s[1]=IA[r]||r,s.join(" ")},LH=function(t,s){if(s.tween&&s.tween._time===s.tween._dur){var n=s.t,r=n.style,a=s.u,o=n._gsap,d,p,y;if(a==="all"||a===!0)r.cssText="",p=1;else for(a=a.split(","),y=a.length;--y>-1;)d=a[y],xh[d]&&(p=1,d=d==="transformOrigin"?bu:Ei),Tv(n,d);p&&(Tv(n,Ei),o&&(o.svg&&n.removeAttribute("transform"),Mv(n,1),o.uncache=1,bR(r)))}},kb={clearProps:function(t,s,n,r,a){if(a.data!=="isFromStart"){var o=t._pt=new cl(t._pt,s,n,0,0,LH);return o.u=r,o.pr=-10,o.tween=a,t._props.push(n),1}}},Av=[1,0,0,1,0,0],IR={},TR=function(t){return t==="matrix(1, 0, 0, 1, 0, 0)"||t==="none"||!t},TA=function(t){var s=ad(t,Ei);return TR(s)?Av:s.substr(7).match($P).map(Xi)},aI=function(t,s){var n=t._gsap||_m(t),r=t.style,a=TA(t),o,d,p,y;return n.svg&&t.getAttribute("transform")?(p=t.transform.baseVal.consolidate().matrix,a=[p.a,p.b,p.c,p.d,p.e,p.f],a.join(",")==="1,0,0,1,0,0"?Av:a):(a===Av&&!t.offsetParent&&t!==dg&&!n.svg&&(p=r.display,r.display="block",o=t.parentNode,(!o||!t.offsetParent)&&(y=1,d=t.nextElementSibling,dg.appendChild(t)),a=TA(t),p?r.display=p:Tv(t,"display"),y&&(d?o.insertBefore(t,d):o?o.appendChild(t):dg.removeChild(t))),s&&a.length>6?[a[0],a[1],a[4],a[5],a[12],a[13]]:a)},h2=function(t,s,n,r,a,o){var d=t._gsap,p=a||aI(t,!0),y=d.xOrigin||0,v=d.yOrigin||0,C=d.xOffset||0,I=d.yOffset||0,O=p[0],A=p[1],P=p[2],q=p[3],ce=p[4],re=p[5],W=s.split(" "),Ce=parseFloat(W[0])||0,te=parseFloat(W[1])||0,oe,ve,ee,ne;n?p!==Av&&(ve=O*q-A*P)&&(ee=Ce*(q/ve)+te*(-P/ve)+(P*re-q*ce)/ve,ne=Ce*(-A/ve)+te*(O/ve)-(O*re-A*ce)/ve,Ce=ee,te=ne):(oe=SR(t),Ce=oe.x+(~W[0].indexOf("%")?Ce/100*oe.width:Ce),te=oe.y+(~(W[1]||W[0]).indexOf("%")?te/100*oe.height:te)),r||r!==!1&&d.smooth?(ce=Ce-y,re=te-v,d.xOffset=C+(ce*O+re*P)-ce,d.yOffset=I+(ce*A+re*q)-re):d.xOffset=d.yOffset=0,d.xOrigin=Ce,d.yOrigin=te,d.smooth=!!r,d.origin=s,d.originIsAbsolute=!!n,t.style[bu]="0px 0px",o&&(Np(o,d,"xOrigin",y,Ce),Np(o,d,"yOrigin",v,te),Np(o,d,"xOffset",C,d.xOffset),Np(o,d,"yOffset",I,d.yOffset)),t.setAttribute("data-svg-origin",Ce+" "+te)},Mv=function(t,s){var n=t._gsap||new cR(t);if("x"in n&&!s&&!n.uncache)return n;var r=t.style,a=n.scaleX<0,o="px",d="deg",p=getComputedStyle(t),y=ad(t,bu)||"0",v,C,I,O,A,P,q,ce,re,W,Ce,te,oe,ve,ee,ne,Se,Ue,Qe,Me,vt,Ut,Rt,_t,F,j,G,Y,J,he,be,Ne;return v=C=I=P=q=ce=re=W=Ce=0,O=A=1,n.svg=!!(t.getCTM&&CR(t)),p.translate&&((p.translate!=="none"||p.scale!=="none"||p.rotate!=="none")&&(r[Ei]=(p.translate!=="none"?"translate3d("+(p.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(p.rotate!=="none"?"rotate("+p.rotate+") ":"")+(p.scale!=="none"?"scale("+p.scale.split(" ").join(",")+") ":"")+(p[Ei]!=="none"?p[Ei]:"")),r.scale=r.rotate=r.translate="none"),ve=aI(t,n.svg),n.svg&&(n.uncache?(F=t.getBBox(),y=n.xOrigin-F.x+"px "+(n.yOrigin-F.y)+"px",_t=""):_t=!s&&t.getAttribute("data-svg-origin"),h2(t,_t||y,!!_t||n.originIsAbsolute,n.smooth!==!1,ve)),te=n.xOrigin||0,oe=n.yOrigin||0,ve!==Av&&(Ue=ve[0],Qe=ve[1],Me=ve[2],vt=ve[3],v=Ut=ve[4],C=Rt=ve[5],ve.length===6?(O=Math.sqrt(Ue*Ue+Qe*Qe),A=Math.sqrt(vt*vt+Me*Me),P=Ue||Qe?H_(Qe,Ue)*Kf:0,re=Me||vt?H_(Me,vt)*Kf+P:0,re&&(A*=Math.abs(Math.cos(re*hg))),n.svg&&(v-=te-(te*Ue+oe*Me),C-=oe-(te*Qe+oe*vt))):(Ne=ve[6],he=ve[7],G=ve[8],Y=ve[9],J=ve[10],be=ve[11],v=ve[12],C=ve[13],I=ve[14],ee=H_(Ne,J),q=ee*Kf,ee&&(ne=Math.cos(-ee),Se=Math.sin(-ee),_t=Ut*ne+G*Se,F=Rt*ne+Y*Se,j=Ne*ne+J*Se,G=Ut*-Se+G*ne,Y=Rt*-Se+Y*ne,J=Ne*-Se+J*ne,be=he*-Se+be*ne,Ut=_t,Rt=F,Ne=j),ee=H_(-Me,J),ce=ee*Kf,ee&&(ne=Math.cos(-ee),Se=Math.sin(-ee),_t=Ue*ne-G*Se,F=Qe*ne-Y*Se,j=Me*ne-J*Se,be=vt*Se+be*ne,Ue=_t,Qe=F,Me=j),ee=H_(Qe,Ue),P=ee*Kf,ee&&(ne=Math.cos(ee),Se=Math.sin(ee),_t=Ue*ne+Qe*Se,F=Ut*ne+Rt*Se,Qe=Qe*ne-Ue*Se,Rt=Rt*ne-Ut*Se,Ue=_t,Ut=F),q&&Math.abs(q)+Math.abs(P)>359.9&&(q=P=0,ce=180-ce),O=Xi(Math.sqrt(Ue*Ue+Qe*Qe+Me*Me)),A=Xi(Math.sqrt(Rt*Rt+Ne*Ne)),ee=H_(Ut,Rt),re=Math.abs(ee)>2e-4?ee*Kf:0,Ce=be?1/(be<0?-be:be):0),n.svg&&(_t=t.getAttribute("transform"),n.forceCSS=t.setAttribute("transform","")||!TR(ad(t,Ei)),_t&&t.setAttribute("transform",_t))),Math.abs(re)>90&&Math.abs(re)<270&&(a?(O*=-1,re+=P<=0?180:-180,P+=P<=0?180:-180):(A*=-1,re+=re<=0?180:-180)),s=s||n.uncache,n.x=v-((n.xPercent=v&&(!s&&n.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-v)?-50:0)))?t.offsetWidth*n.xPercent/100:0)+o,n.y=C-((n.yPercent=C&&(!s&&n.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-C)?-50:0)))?t.offsetHeight*n.yPercent/100:0)+o,n.z=I+o,n.scaleX=Xi(O),n.scaleY=Xi(A),n.rotation=Xi(P)+d,n.rotationX=Xi(q)+d,n.rotationY=Xi(ce)+d,n.skewX=re+d,n.skewY=W+d,n.transformPerspective=Ce+o,(n.zOrigin=parseFloat(y.split(" ")[2])||0)&&(r[bu]=Pb(y)),n.xOffset=n.yOffset=0,n.force3D=Dl.force3D,n.renderTransform=n.svg?DH:wR?AR:NH,n.uncache=0,n},Pb=function(t){return(t=t.split(" "))[0]+" "+t[1]},cS=function(t,s,n){var r=ga(s);return Xi(parseFloat(s)+parseFloat(Yp(t,"x",n+"px",r)))+r},NH=function(t,s){s.z="0px",s.rotationY=s.rotationX="0deg",s.force3D=0,AR(t,s)},Yf="0deg",Fy="0px",Zf=") ",AR=function(t,s){var n=s||this,r=n.xPercent,a=n.yPercent,o=n.x,d=n.y,p=n.z,y=n.rotation,v=n.rotationY,C=n.rotationX,I=n.skewX,O=n.skewY,A=n.scaleX,P=n.scaleY,q=n.transformPerspective,ce=n.force3D,re=n.target,W=n.zOrigin,Ce="",te=ce==="auto"&&t&&t!==1||ce===!0;if(W&&(C!==Yf||v!==Yf)){var oe=parseFloat(v)*hg,ve=Math.sin(oe),ee=Math.cos(oe),ne;oe=parseFloat(C)*hg,ne=Math.cos(oe),o=cS(re,o,ve*ne*-W),d=cS(re,d,-Math.sin(oe)*-W),p=cS(re,p,ee*ne*-W+W)}q!==Fy&&(Ce+="perspective("+q+Zf),(r||a)&&(Ce+="translate("+r+"%, "+a+"%) "),(te||o!==Fy||d!==Fy||p!==Fy)&&(Ce+=p!==Fy||te?"translate3d("+o+", "+d+", "+p+") ":"translate("+o+", "+d+Zf),y!==Yf&&(Ce+="rotate("+y+Zf),v!==Yf&&(Ce+="rotateY("+v+Zf),C!==Yf&&(Ce+="rotateX("+C+Zf),(I!==Yf||O!==Yf)&&(Ce+="skew("+I+", "+O+Zf),(A!==1||P!==1)&&(Ce+="scale("+A+", "+P+Zf),re.style[Ei]=Ce||"translate(0, 0)"},DH=function(t,s){var n=s||this,r=n.xPercent,a=n.yPercent,o=n.x,d=n.y,p=n.rotation,y=n.skewX,v=n.skewY,C=n.scaleX,I=n.scaleY,O=n.target,A=n.xOrigin,P=n.yOrigin,q=n.xOffset,ce=n.yOffset,re=n.forceCSS,W=parseFloat(o),Ce=parseFloat(d),te,oe,ve,ee,ne;p=parseFloat(p),y=parseFloat(y),v=parseFloat(v),v&&(v=parseFloat(v),y+=v,p+=v),p||y?(p*=hg,y*=hg,te=Math.cos(p)*C,oe=Math.sin(p)*C,ve=Math.sin(p-y)*-I,ee=Math.cos(p-y)*I,y&&(v*=hg,ne=Math.tan(y-v),ne=Math.sqrt(1+ne*ne),ve*=ne,ee*=ne,v&&(ne=Math.tan(v),ne=Math.sqrt(1+ne*ne),te*=ne,oe*=ne)),te=Xi(te),oe=Xi(oe),ve=Xi(ve),ee=Xi(ee)):(te=C,ee=I,oe=ve=0),(W&&!~(o+"").indexOf("px")||Ce&&!~(d+"").indexOf("px"))&&(W=Yp(O,"x",o,"px"),Ce=Yp(O,"y",d,"px")),(A||P||q||ce)&&(W=Xi(W+A-(A*te+P*ve)+q),Ce=Xi(Ce+P-(A*oe+P*ee)+ce)),(r||a)&&(ne=O.getBBox(),W=Xi(W+r/100*ne.width),Ce=Xi(Ce+a/100*ne.height)),ne="matrix("+te+","+oe+","+ve+","+ee+","+W+","+Ce+")",O.setAttribute("transform",ne),re&&(O.style[Ei]=ne)},BH=function(t,s,n,r,a){var o=360,d=Bo(a),p=parseFloat(a)*(d&&~a.indexOf("rad")?Kf:1),y=p-r,v=r+y+"deg",C,I;return d&&(C=a.split("_")[1],C==="short"&&(y%=o,y!==y%(o/2)&&(y+=y<0?o:-o)),C==="cw"&&y<0?y=(y+o*xA)%o-~~(y/o)*o:C==="ccw"&&y>0&&(y=(y-o*xA)%o-~~(y/o)*o)),t._pt=I=new cl(t._pt,s,n,r,y,xH),I.e=v,I.u="deg",t._props.push(n),I},AA=function(t,s){for(var n in s)t[n]=s[n];return t},FH=function(t,s,n){var r=AA({},n._gsap),a="perspective,force3D,transformOrigin,svgOrigin",o=n.style,d,p,y,v,C,I,O,A;r.svg?(y=n.getAttribute("transform"),n.setAttribute("transform",""),o[Ei]=s,d=Mv(n,1),Tv(n,Ei),n.setAttribute("transform",y)):(y=getComputedStyle(n)[Ei],o[Ei]=s,d=Mv(n,1),o[Ei]=y);for(p in xh)y=r[p],v=d[p],y!==v&&a.indexOf(p)<0&&(O=ga(y),A=ga(v),C=O!==A?Yp(n,p,y,A):parseFloat(y),I=parseFloat(v),t._pt=new cl(t._pt,d,p,C,I-C,c2),t._pt.u=A||0,t._props.push(p));AA(d,r)};ll("padding,margin,Width,Radius",function(e,t){var s="Top",n="Right",r="Bottom",a="Left",o=(t<3?[s,n,r,a]:[s+a,s+n,r+n,r+a]).map(function(d){return t<2?e+d:"border"+d+e});kb[t>1?"border"+e:e]=function(d,p,y,v,C){var I,O;if(arguments.length<4)return I=o.map(function(A){return oh(d,A,y)}),O=I.join(" "),O.split(I[0]).length===5?I[0]:O;I=(v+"").split(" "),O={},o.forEach(function(A,P){return O[A]=I[P]=I[P]||I[(P-1)/2|0]}),d.init(p,O,C)}});var MR={name:"css",register:d2,targetTest:function(t){return t.style&&t.nodeType},init:function(t,s,n,r,a){var o=this._props,d=t.style,p=n.vars.startAt,y,v,C,I,O,A,P,q,ce,re,W,Ce,te,oe,ve,ee;rI||d2(),this.styles=this.styles||xR(t),ee=this.styles.props,this.tween=n;for(P in s)if(P!=="autoRound"&&(v=s[P],!($l[P]&&uR(P,s,n,r,t,a)))){if(O=typeof v,A=kb[P],O==="function"&&(v=v.call(n,r,t,a),O=typeof v),O==="string"&&~v.indexOf("random(")&&(v=Cv(v)),A)A(this,t,P,v,n)&&(ve=1);else if(P.substr(0,2)==="--")y=(getComputedStyle(t).getPropertyValue(P)+"").trim(),v+="",Up.lastIndex=0,Up.test(y)||(q=ga(y),ce=ga(v)),ce?q!==ce&&(y=Yp(t,P,y,ce)+ce):q&&(v+=q),this.add(d,"setProperty",y,v,r,a,0,0,P),o.push(P),ee.push(P,0,d[P]);else if(O!=="undefined"){if(p&&P in p?(y=typeof p[P]=="function"?p[P].call(n,r,t,a):p[P],Bo(y)&&~y.indexOf("random(")&&(y=Cv(y)),ga(y+"")||(y+=Dl.units[P]||ga(oh(t,P))||""),(y+"").charAt(1)==="="&&(y=oh(t,P))):y=oh(t,P),I=parseFloat(y),re=O==="string"&&v.charAt(1)==="="&&v.substr(0,2),re&&(v=v.substr(2)),C=parseFloat(v),P in rd&&(P==="autoAlpha"&&(I===1&&oh(t,"visibility")==="hidden"&&C&&(I=0),ee.push("visibility",0,d.visibility),Np(this,d,"visibility",I?"inherit":"hidden",C?"inherit":"hidden",!C)),P!=="scale"&&P!=="transform"&&(P=rd[P],~P.indexOf(",")&&(P=P.split(",")[0]))),W=P in xh,W){if(this.styles.save(P),Ce||(te=t._gsap,te.renderTransform&&!s.parseTransform||Mv(t,s.parseTransform),oe=s.smoothOrigin!==!1&&te.smooth,Ce=this._pt=new cl(this._pt,d,Ei,0,1,te.renderTransform,te,0,-1),Ce.dep=1),P==="scale")this._pt=new cl(this._pt,te,"scaleY",te.scaleY,(re?ug(te.scaleY,re+C):C)-te.scaleY||0,c2),this._pt.u=0,o.push("scaleY",P),P+="X";else if(P==="transformOrigin"){ee.push(bu,0,d[bu]),v=OH(v),te.svg?h2(t,v,0,oe,0,this):(ce=parseFloat(v.split(" ")[2])||0,ce!==te.zOrigin&&Np(this,te,"zOrigin",te.zOrigin,ce),Np(this,d,P,Pb(y),Pb(v)));continue}else if(P==="svgOrigin"){h2(t,v,1,oe,0,this);continue}else if(P in IR){BH(this,te,P,I,re?ug(I,re+v):v);continue}else if(P==="smoothOrigin"){Np(this,te,"smooth",te.smooth,v);continue}else if(P==="force3D"){te[P]=v;continue}else if(P==="transform"){FH(this,v,t);continue}}else P in d||(P=Mg(P)||P);if(W||(C||C===0)&&(I||I===0)&&!bH.test(v)&&P in d)q=(y+"").substr((I+"").length),C||(C=0),ce=ga(v)||(P in Dl.units?Dl.units[P]:q),q!==ce&&(I=Yp(t,P,y,ce)),this._pt=new cl(this._pt,W?te:d,P,I,(re?ug(I,re+C):C)-I,!W&&(ce==="px"||P==="zIndex")&&s.autoRound!==!1?SH:c2),this._pt.u=ce||0,q!==ce&&ce!=="%"&&(this._pt.b=y,this._pt.r=wH);else if(P in d)$H.call(this,t,P,y,re?re+v:v);else if(P in t)this.add(t,P,y||t[P],re?re+v:v,r,a);else if(P!=="parseTransform"){ZC(P,v);continue}W||(P in d?ee.push(P,0,d[P]):ee.push(P,1,y||t[P])),o.push(P)}}ve&&_R(this)},render:function(t,s){if(s.tween._time||!iI())for(var n=s._pt;n;)n.r(t,n.d),n=n._next;else s.styles.revert()},get:oh,aliases:rd,getSetter:function(t,s,n){var r=rd[s];return r&&r.indexOf(",")<0&&(s=r),s in xh&&s!==bu&&(t._gsap.x||oh(t,"x"))?n&&bA===n?s==="scale"?AH:TH:(bA=n||{})&&(s==="scale"?MH:EH):t.style&&!GC(t.style[s])?CH:~s.indexOf("-")?IH:sI(t,s)},core:{_removeProperty:Tv,_getMatrix:aI}};dl.utils.checkPrefix=Mg;dl.core.getStyleSaver=xR;(function(e,t,s,n){var r=ll(e+","+t+","+s,function(a){xh[a]=1});ll(t,function(a){Dl.units[a]="deg",IR[a]=1}),rd[r[13]]=e+","+t,ll(n,function(a){var o=a.split(":");rd[o[1]]=r[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");ll("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(e){Dl.units[e]="px"});dl.registerPlugin(MR);var ER=dl.registerPlugin(MR)||dl;ER.core.Tween;const zH={name:"NumberAnimator",props:{value:{type:Number,default:0},duration:{type:Number,default:.5},formatType:{type:String,default:""}},data(){return{displayValue:Math.ceil(this.value),tweenValue:this.value}},computed:{formatted(){return this.formatType?SPM.app.config.globalProperties.$F(this.formatType,this.displayValue):this.displayValue}},watch:{value(){ER.to(this,{tweenValue:Math.ceil(this.value),duration:this.duration,onUpdate:()=>{this.displayValue=Math.round(this.tweenValue)},onComplete:()=>{this.displayValue=Math.round(this.value)}})}}};function UH(e,t,s,n,r,a){return L(),X("span",null,Pe(a.formatted),1)}const kR=os(zH,[["render",UH]]),VH={name:"ProgressBar",props:{assistiveText:{type:String,default:""},color:{type:String,default:""},description:{type:String,required:!0},radius:Boolean,thickness:{type:String,default:"medium"},value:{type:Number,default:0},vertical:Boolean},data(){return{progressBarId:Vn()}},computed:{themeClasses(){const e=[`slds-progress-bar_${this.$props.thickness}`];return this.$props.radius&&e.push("slds-progress-bar_circular"),this.$props.vertical&&e.push("slds-progress-bar_vertical"),e},progressBarStyle(){const t={[this.$props.vertical?"height":"width"]:`${Math.min(100,this.$props.value)}%`};return this.$props.color&&(t.backgroundColor=this.$props.color),t},computedAssistiveText(){return this.$props.assistiveText||`Progress: ${this.$props.value}%`}}},jH=["aria-valuenow","aria-label"],qH={class:"slds-assistive-text"};function HH(e,t,s,n,r,a){return L(),X("div",{class:$t(["slds-progress-bar",a.themeClasses]),"aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":e.$props.value,"aria-label":e.$props.description,role:"progressbar"},[k("span",{class:$t(["slds-progress-bar__value",{"slds-progress-bar__value_success":!e.$props.color&&e.$props.value>=100}]),style:br(a.progressBarStyle)},[k("span",qH,Pe(a.computedAssistiveText),1)],6)],10,jH)}const lI=os(VH,[["render",HH]]),GH={name:"NodeMetric",components:{Spinner:Vr},props:["period","label","cell","metric"],emits:["update-node-metric","node-metric-focus","node-metric-blur"],computed:{nodeMetric(){return this.cell.data.nodeMetric},metricIndex(){return this.cell.row.metricIndex},showTotalTargetValue(){return this.period!=="Year"&&this.metricIndex===null},currentTarget(){return this.metricIndex!==null?this.nodeMetricTargets[this.metricIndex]:this.nodeMetricTargets[0]},nodeMetricTargets(){const e=SPM.FiscalPeriod[this.period],t=[];for(let s=0;s<e.length;s++){const n={value:0,isPreview:!1,previousValue:0};e[s].forEach(r=>{const a=this.nodeMetric[`previewValue${r}`];n.previousValue+=this.nodeMetric[`sfsp__Target_Month${r}__c`],typeof a>"u"?n.value+=this.nodeMetric[`sfsp__Target_Month${r}__c`]:(n.value+=a,n.isPreview=!0)}),t.push(n)}return t},totalTargetValue(){return this.nodeMetricTargets.reduce((e,t)=>e+t.value,0)}},methods:{changeTarget({target:e}){var t,s,n;SPM.Utils.NodeMetric.changeTarget({nodeMetric:this.nodeMetric,period:this.period,index:this.metricIndex+1,target:e,startingMonth:((n=(s=(t=SPM.FiscalPeriod)==null?void 0:t.Month)==null?void 0:s[0])==null?void 0:n[0])||1}),this.$emit("update-node-metric",{nodeMetric:this.nodeMetric})},getPercentageChange(e,t){return SPM.Utils.Allocation.getPercentageChange(e,t)},onInputFocus(){this.$el.closest("td").classList.add("spm-table_summary-row-color"),this.$emit("node-metric-focus",this.cell.columnIndex)},onInputBlur(){this.$el.closest("td").classList.remove("spm-table_summary-row-color"),this.$emit("node-metric-blur",this.cell.columnIndex)}}},WH={class:"slds-grid slds-grid_vertical"},YH={key:1,class:"slds-p-around_small slds-grid"},ZH={key:2,class:"slds-form-element"},XH={class:"slds-form-element__label slds-assistive-text"},KH={class:"slds-form-element__control"},JH=["value",".disabled","readonly"],QH={key:1,class:"slds-input node-metric-preview slds-grid",style:""},eG={class:"slds-col_bump-left slds-text-body_small",style:{"font-weight":"bold"}};function tG(e,t,s,n,r,a){const o=pe("Spinner");return L(),X("div",WH,[s.metric.isLoading||s.cell.data.state==="loading"?(L(),Ge(o,{key:0,size:"x-small",style:{"z-index":"1"}})):$e("",!0),a.showTotalTargetValue?(L(),X("div",YH,Pe(e.$F("Numeric",a.totalTargetValue)),1)):(L(),X("div",ZH,[k("label",XH,Pe(e.$props.label),1),k("div",KH,[a.currentTarget.isPreview?(L(),X("div",QH,[k("div",null,Pe(e.$F("Numeric",a.currentTarget.value)),1),k("div",eG,Pe(a.getPercentageChange(a.currentTarget.previousValue,a.currentTarget.value)),1)])):(L(),X("input",{key:0,value:a.currentTarget.value,class:$t(["slds-input spm-text-input",{"node-metric-preview":a.currentTarget.isPreview}]),".disabled":a.currentTarget.isPreview,readonly:!e.$store.isEditor,onFocus:t[0]||(t[0]=(...d)=>a.onInputFocus&&a.onInputFocus(...d)),onBlur:t[1]||(t[1]=(...d)=>a.onInputBlur&&a.onInputBlur(...d)),onChange:t[2]||(t[2]=d=>a.changeTarget({target:parseInt(d.currentTarget.value)||0}))},null,42,JH))])]))])}const sG=os(GH,[["render",tG],["__scopeId","data-v-e1619222"]]),nG={name:"NodeMetricHeader",components:{NumberAnimator:kR,ProgressBar:lI,Spinner:Vr},props:["data","metric","period"],emits:["mounted"],data(){return{isPreview:!1}},computed:{nodeMetricTarget(){const e=SPM.FiscalPeriod.Year,t={value:0,isPreview:!1,previousValue:this.metric.rollup};for(let s=0;s<e.length;s++)e[s].forEach(n=>{const r=this.data[`previewValue${n}`];typeof r<"u"&&(t.value+=r,t.isPreview=!0)});return t.isPreview||(t.value=this.metric.rollup),t},progress(){return this.nodeMetricTarget.isPreview?Math.floor(100*this.nodeMetricTarget.value/this.metric.target):Math.floor(100*this.metric.rollup/this.metric.target)||0}},mounted(){this.$emit("mounted")},methods:{getPercentageChange(e,t){return SPM.Utils.Allocation.getPercentageChange(e,t)}}},rG={class:"slds-col_bump-left slds-text-title_bold slds-grid",style:""},iG={class:"slds-p-bottom_xx-small"},oG={key:0,class:"slds-col_bump-left slds-text-body_small",style:{"font-weight":"bold"}};function aG(e,t,s,n,r,a){const o=pe("Spinner"),d=pe("NumberAnimator"),p=pe("ProgressBar");return L(),X("div",{class:$t([{"node-metric-preview":a.nodeMetricTarget.isPreview},"slds-p-around_xx-small"])},[s.metric.isLoading?(L(),Ge(o,{key:0,size:"x-small",style:{"z-index":"1"}})):$e("",!0),k("div",rG,[k("div",iG,[de(d,{formatType:s.metric.type,value:a.nodeMetricTarget.value},null,8,["formatType","value"])]),a.nodeMetricTarget.isPreview?(L(),X("div",oG,Pe(a.getPercentageChange(a.nodeMetricTarget.previousValue,a.nodeMetricTarget.value)),1)):$e("",!0)]),de(p,{description:`Allocation Progress bar for ${s.metric.name}`,radius:"",value:e.$store.rootNode.childCount>0?a.progress:100},null,8,["description","value"])],2)}const lG=os(nG,[["render",aG],["__scopeId","data-v-008f01af"]]),cG={name:"DuelingPicklist",components:{ButtonIcon:vn,Icon:yn},props:["labels","fields"],computed:{availableFields(){return this.fields.filter(e=>!e.selected)},selectedFields(){return this.fields.filter(e=>e.selected).sort((e,t)=>e.order<t.order?-1:e.order>t.order?1:0).map((e,t)=>Object.assign(e,{order:t+1}))}},methods:{moveToSelected(){this.availableFields.filter(e=>e.active).forEach(e=>{e.locked||(e.selected=!0,e.active=!1,e.order=this.selectedFields.length+1)})},moveToAvailable(){this.selectedFields.filter(e=>e.active).forEach(e=>{e.selected=!1,e.active=!1}),this.selectedFields.forEach((e,t)=>e.order=t+1)},moveUp(){this.selectedFields.forEach((e,t)=>{e.active&&e.order>1&&(this.selectedFields[t-1].order+=1,e.order-=1)})},moveDown(){this.selectedFields.forEach((e,t)=>{e.active&&e.order<this.selectedFields.length&&(this.selectedFields[t+1].order-=1,e.order+=1)})}}},uG={key:0},dG={class:"slds-form-element__label"},hG={class:"slds-dueling-list"},pG={class:"slds-dueling-list__column slds-size_5-of-12"},fG={class:"slds-form-element__label",style:{position:"relative"}},mG={style:{position:"absolute",top:"0",right:"0"}},_G={class:"slds-dueling-list__options",style:{width:"auto"}},gG={"aria-multiselectable":"true",class:"slds-listbox slds-listbox_vertical",role:"listbox"},yG=["onClick"],vG=["aria-selected","aria-disabled"],bG={class:"slds-media__body slds-grid"},xG=["title"],wG=["title"],SG={key:2,class:"slds-icon_container slds-current-color"},CG={class:"slds-dueling-list__column"},IG={class:"slds-dueling-list__column slds-size_5-of-12"},TG={class:"slds-form-element__label"},AG={class:"slds-dueling-list__options",style:{width:"auto"}},MG={"aria-multiselectable":"true",class:"slds-listbox slds-listbox_vertical",role:"listbox"},EG=["onClick"],kG=["aria-selected","aria-disabled"],PG={class:"slds-media__body"},RG=["title"],$G={key:0,class:"slds-icon_container slds-current-color"},OG={class:"slds-dueling-list__column"};function LG(e,t,s,n,r,a){var p,y,v;const o=pe("Icon"),d=pe("ButtonIcon");return L(),X("div",null,[(p=s.labels)!=null&&p.name?(L(),X("div",uG,[k("label",dG,[k("strong",null,Pe(s.labels.name),1)])])):$e("",!0),k("div",hG,[k("div",pG,[k("span",fG,[es(Pe(((y=s.labels)==null?void 0:y.available)||"Available")+" ",1),k("div",mG,[k("button",{class:"slds-button slds-m-around_none",onClick:t[0]||(t[0]=C=>{s.fields.forEach((I,O)=>{I.locked||(I.selected=!0),I.active=!1,I.order=O+1})})},"Select All"),es(" | "),k("button",{class:"slds-button slds-m-around_none",onClick:t[1]||(t[1]=C=>{s.fields.filter(I=>!I.locked).forEach(I=>{I.selected=!1,I.active=!1,I.locked=!!I.message})})},"None")])]),k("div",_G,[k("ul",gG,[(L(!0),X(Lt,null,As(a.availableFields,(C,I)=>(L(),X("li",{key:I,role:"presentation",class:"slds-listbox__item",onClick:O=>C.active=!C.active&&!C.locked},[k("div",{class:$t(["slds-listbox__option slds-listbox__option_plain slds-media slds-media_small slds-media_inline",{active:C.active}]),"aria-selected":C.active,role:"option","aria-disabled":C.locked},[k("span",bG,[C.locked?(L(),X("span",{key:0,class:"slds-truncate",title:`${C.message}`},Pe(C.label),9,xG)):(L(),X("span",{key:1,class:"slds-truncate",title:C.label},Pe(C.label),9,wG)),C.locked?(L(),X("span",SG,[de(o,{category:"utility",name:"warning",size:"x-small",class:"slds-media__figure slds-media__figure_reverse"})])):$e("",!0)]),js(e.$slots,"fieldEnd",kp(im({field:C})))],10,vG)],8,yG))),128))])])]),k("div",CG,[de(d,{assistiveText:"Move Selection to Second Category",iconCategory:"utility",iconName:"right",title:"Move Selection to Second Category",variant:"container",onClick:a.moveToSelected},null,8,["onClick"]),de(d,{assistiveText:"Move Selection to First Category",iconCategory:"utility",iconName:"left",title:"Move Selection to First Category",variant:"container",onClick:a.moveToAvailable},null,8,["onClick"])]),k("div",IG,[k("span",TG,Pe(((v=s.labels)==null?void 0:v.selected)||"Selected"),1),k("div",AG,[k("ul",MG,[(L(!0),X(Lt,null,As(a.selectedFields,(C,I)=>(L(),X("li",{key:I,role:"presentation",class:"slds-listbox__item",onClick:O=>C.active=!C.active&&!C.locked},[k("div",{class:$t(["slds-listbox__option slds-listbox__option_plain slds-media slds-media_small slds-media_inline",{active:C.active}]),"aria-selected":C.active,"aria-disabled":C.locked,role:"option"},[k("span",PG,[k("span",{class:"slds-truncate",title:C.label},Pe(C.label),9,RG)]),C.locked?(L(),X("span",$G,[de(o,{category:"utility",name:"lock",size:"x-small",class:"slds-media__figure slds-media__figure_reverse"})])):$e("",!0),js(e.$slots,"fieldEnd",kp(im({field:C})))],10,kG)],8,EG))),128))])])]),k("div",OG,[de(d,{assistiveText:"Move Selection Up",iconCategory:"utility",iconName:"up",title:"Move Selection Up",variant:"container",onClick:a.moveUp},null,8,["onClick"]),de(d,{assistiveText:"Move Selection Down",iconCategory:"utility",iconName:"down",title:"Move Selection Down",variant:"container",onClick:a.moveDown},null,8,["onClick"])])])])}const PR=os(cG,[["render",LG]]),Cs=Object.freeze({HIERARCHY:Symbol("Hierarchy"),ASSIGNMENT:Symbol("Assignment Object"),BOUNDARY:Symbol("Boundary Object"),METRIC:Symbol("Allocation Metric"),REFERENCE:Symbol("Reference Field"),HIERARCHY_REFERENCE:Symbol("Hierarchy Reference Field")}),NG=e=>Cs[Object.entries(Cs).find(([t,s])=>e===s.description)[0]],da=Object.freeze({NEW:Symbol("new"),CLONE:Symbol("clone"),RENAME:Symbol("rename"),SELECT_FIELDS:Symbol("select"),DELETE:Symbol("delete")}),Ep="default";let k1=null;const cI=()=>{const e=new Map,t=km();return k1&&k1.size===t.plan.sfsp__SalesAssignmentObjects__r.length?k1:(t.plan.sfsp__SalesAssignmentObjects__r.forEach(s=>{const n={name:s.sfsp__Label__c,referenceFields:[]};JSON.parse(s.sfsp__ReferenceFields__c).forEach(r=>{r.type==="Latitude"?n.latitude=r:r.type==="Longitude"?n.longitude=r:n.referenceFields.push({...r,id:r.name})}),e.set(s.Id,n)}),k1=e)},MA=(e=[])=>{const t=cI(),s=km(),n={label:"Standard View",id:Ep,columns:[]};return e.forEach(r=>{switch(r){case Cs.HIERARCHY:n.columns.push({columnType:Cs.HIERARCHY,columnId:"Owner",id:"Owner",name:"Owner"});break;case Cs.ASSIGNMENT:t.forEach((a,o)=>n.columns.push({assignmentObject:{id:o,name:a.name},columnType:Cs.ASSIGNMENT,columnId:o,summaryFormat:"Sum",id:o,name:a.name}));break;case Cs.BOUNDARY:s.boundaryObjects.forEach(a=>{n.columns.push({boundaryObject:{id:a.id,name:a.label},columnType:Cs.BOUNDARY,columnId:a.id,summaryFormat:"Sum",id:a.id,name:a.name})});break;case Cs.METRIC:s.plan.sfsp__SalesMetrics__r.forEach(a=>n.columns.push({columnType:Cs.METRIC,columnId:a.Id,summaryFormat:"Sum",id:a.Id,name:a.Name,metric:a}));break;case Cs.REFERENCE:t.forEach((a,o)=>{a.referenceFields.forEach(d=>n.columns.push({assignmentObject:{id:o,name:a.name},field:d,columnType:Cs.REFERENCE,columnId:d.id,summaryFormat:"Sum",id:d.id,name:d.name}))});break;case Cs.HIERARCHY_REFERENCE:s.plan.sfsp__HierarchyReference__c.forEach(a=>n.columns.push({field:a,columnId:a==null?void 0:a.id,columnType:Cs.HIERARCHY_REFERENCE,id:a==null?void 0:a.id,value:a["All Org"],label:a.label,name:a.name,summaryFormat:"Sum"}));break}}),n},DG=(e,t=[Cs.HIERARCHY,Cs.ASSIGNMENT,Cs.BOUNDARY,Cs.METRIC,Cs.REFERENCE,Cs.HIERARCHY_REFERENCE])=>{const s=cI(),n=[],r=new Map,a=km(),o=a.plan.sfsp__ListViews__r.find(d=>d.Id===e);return o&&(o.sfsp__ListViewColumns__r||[]).forEach(d=>{r.set(`${d.sfsp__SalesAssignmentObject__c||null}.${d.sfsp__Column__c}`,d)}),t.forEach(d=>{switch(d){case Cs.HIERARCHY:["Owner","Assigned Users"].forEach(p=>{const y=r.get(`null.${p}`);n.push({active:!1,columnId:y==null?void 0:y.Id,columnType:Cs.HIERARCHY,id:p,label:p,name:p,order:y==null?void 0:y.sfsp__Order__c,selected:r.has(`null.${p}`)})});break;case Cs.ASSIGNMENT:a.plan.sfsp__SalesAssignmentObjects__r.forEach(p=>{const y=r.get(`${p.Id}.${p.Name}`);n.push({active:!1,assignmentObject:{id:p.Id},columnId:y==null?void 0:y.Id,columnType:Cs.ASSIGNMENT,id:p.Id,label:p.sfsp__Label__c,name:p.Name,order:y==null?void 0:y.sfsp__Order__c,summaryFormat:y==null?void 0:y.sfsp__SummaryFormat__c,selected:r.has(`${p.Id}.${p.Name}`)})});break;case Cs.BOUNDARY:a.boundaryObjects.forEach(p=>{const y=r.get(`null.${p.name}`);n.push({active:!1,boundaryObject:{id:p.id},columnId:y==null?void 0:y.Id,columnType:Cs.BOUNDARY,id:p.id,label:p.label,name:p.name,order:y==null?void 0:y.sfsp__Order__c,summaryFormat:(y==null?void 0:y.sfsp__SummaryFormat__c)||"Sum",selected:r.has(`null.${p.name}`)})});break;case Cs.METRIC:a.plan.sfsp__SalesMetrics__r.forEach(p=>{const y=r.get(`null.${p.Name}`);n.push({active:!1,assignmentObject:{id:null},columnId:y==null?void 0:y.Id,columnType:Cs.METRIC,id:p.Id,label:p.Name,name:p.Name,order:y==null?void 0:y.sfsp__Order__c,summaryFormat:y==null?void 0:y.sfsp__SummaryFormat__c,selected:r.has(`null.${p.Name}`)})});break;case Cs.REFERENCE:s.forEach((p,y)=>{p.referenceFields.forEach(v=>{const C=r.get(`${y}.${v.name}`);n.push({active:!1,assignmentObject:{id:y},columnId:C==null?void 0:C.Id,columnType:Cs.REFERENCE,id:v.id,label:`${p.name}.${v.name}`,name:v.name,order:C==null?void 0:C.sfsp__Order__c,summaryFormat:C==null?void 0:C.sfsp__SummaryFormat__c,selected:r.has(`${y}.${v.name}`)})})});break;case Cs.HIERARCHY_REFERENCE:a.plan.sfsp__HierarchyReference__c.forEach(p=>{const y=r.get(`null.${p.name}`);n.push({active:!1,columnId:y==null?void 0:y.Id,columnType:Cs.HIERARCHY_REFERENCE,id:p==null?void 0:p.id,value:p["All Org"],label:p.label,name:p.name,order:y==null?void 0:y.sfsp__Order__c,summaryFormat:(y==null?void 0:y.sfsp__SummaryFormat__c)||"Sum",selected:r.has(`null.${p.name}`)})});break}}),n},BG=()=>{const e=km();return e.plan.sfsp__ListViews__r.length===0?Ep:(e.plan.sfsp__ListViews__r.find(t=>typeof t.sfsp__LastViewed__c<"u"&&t.sfsp__LastViewed__c!==0)||{Id:Ep}).Id},EA=async()=>{const e=cI(),t=km(),s=await SPM.Utils.Apex.invoke("Query",[`
        SELECT
            Name,
            sfsp__LastViewed__c,
            (
                SELECT
                    sfsp__Column__c,
                    sfsp__Order__c,
                    sfsp__SalesNodeBoundary__c,
                    sfsp__SalesAssignmentObject__c,
                    sfsp__Type__c,
                    sfsp__SummaryFormat__c
                FROM sfsp__ListViewColumns__r
                ORDER BY sfsp__Order__c
            )
        FROM sfsp__ListView__c
        WHERE sfsp__SalesPlan__c = '${t.plan.Id}'
        ORDER BY sfsp__LastViewed__c DESC
    `]);return t.$patch({plan:{sfsp__ListViews__r:s}}),s.map(n=>{const{sfsp__ListViewColumns__r:r=[],Name:a,Id:o}=n,d=r.map(p=>{const y=NG(p.sfsp__Type__c);if(!y)return null;const v=p.sfsp__SalesAssignmentObject__c,C=e.get(v);switch(y){case Cs.HIERARCHY:return{columnType:y,columnId:p.Id,id:p.sfsp__Column__c,name:p.sfsp__Column__c};case Cs.ASSIGNMENT:return C?{assignmentObject:{id:v,name:C.name},columnType:y,columnId:p.Id,summaryFormat:p.sfsp__SummaryFormat__c,id:v,name:C.name}:null;case Cs.BOUNDARY:const I=t.boundaryObjects.find(q=>q.id===p.sfsp__SalesNodeBoundary__c);return I?{boundaryObject:{id:I.id,name:I.name},columnType:y,columnId:p.Id,summaryFormat:p.sfsp__SummaryFormat__c,id:I.id,name:I.name}:null;case Cs.REFERENCE:if(!C)return null;const O=C.referenceFields.find(q=>q.name===p.sfsp__Column__c);return O?{assignmentObject:{id:v,name:C.name},columnType:y,columnId:p.Id,summaryFormat:p.sfsp__SummaryFormat__c,field:O,id:O.id,name:O.name}:null;case Cs.METRIC:const A=t.plan.sfsp__SalesMetrics__r.find(q=>q.Name===p.sfsp__Column__c);return A?{columnType:y,columnId:p.Id,summaryFormat:p.sfsp__SummaryFormat__c,id:A.Id,name:A.Name,metric:A}:null;case Cs.HIERARCHY_REFERENCE:const P=t.plan.sfsp__HierarchyReference__c.find(q=>q.name===p.sfsp__Column__c);return P?(P.type==="Numeric"&&(P.value=P!=null&&P.value?Number(P.value):Number(P["All Org"])),{columnType:y,columnId:p==null?void 0:p.Id,summaryFormat:P.type!=="Text"?p.sfsp__SummaryFormat__c:"",id:P==null?void 0:P.id,name:P.name,value:(P==null?void 0:P.value)||P["All Org"],refField:P}):null}}).filter(p=>!!p);return{label:a,id:o,columns:d}})},FG={name:"ListViewManager",components:{ActionMenu:wa,ActionMenuItem:Sa,ButtonIcon:vn,DuelingPicklist:PR,Modal:zc,SLDSButton:Tn,Spinner:Vr,TextInput:Ko},props:["defaultViewColumnTypes","title","summary"],emits:["change"],data(){return{ListViewActions:da,defaultListView:MA(this.$props.defaultViewColumnTypes),customListViews:[],currentListView:Ep,selectableFields:[],listViewAction:null,renderListViewActionModal:!1,loadingListViewActionModal:!1,configuredListViewName:""}},computed:{computedSelectedListViewLabel(){return(this.computedListViews.find(e=>e.id===this.currentListView)||{label:"Default "}).label},computedListViewModalTitle(){switch(this.listViewAction){case da.NEW:return"Create List View";case da.CLONE:return"Clone List View";case da.RENAME:return"Rename List View";case da.SELECT_FIELDS:return"Select Fields to Display";case da.DELETE:return"Delete List View";default:return null}},isDefaultListView(){return this.currentListView===Ep},isDeleteListViewAction(){return this.listViewAction===da.DELETE},computedListViews(){return[this.defaultListView,...this.customListViews]}},async mounted(){this.rebuildListView()},methods:{async rebuildListView(){this.defaultListView=MA(this.$props.defaultViewColumnTypes),this.customListViews=await EA(),this.currentListView=BG(),this.emitListViewColumns()},onListViewAction(e){switch(this.listViewAction=e,this.renderListViewActionModal=!0,e){case da.CLONE:this.configuredListViewName=`Copy of ${this.computedSelectedListViewLabel}`;break;case da.RENAME:this.configuredListViewName=this.computedSelectedListViewLabel;break;case da.SELECT_FIELDS:this.selectableFields=DG(this.currentListView);break}},async onListViewActionSave(){this.loadingListViewActionModal=!0,await this.$nextTick();try{let e=!1;switch(this.listViewAction){case da.NEW:case da.CLONE:const t={sobjectType:"sfsp__ListView__c",Name:this.configuredListViewName,sfsp__LastViewed__c:Date.now(),sfsp__SalesPlan__c:this.$store.plan.Id};await SPM.Utils.CRM.upsert({records:[t]});let s;this.listViewAction===da.NEW?s=this.computedListViews[0].columns:s=this.computedListViews.find(d=>d.id===this.currentListView).columns;const n=s.map((d,p)=>{var y,v;return{sobjectType:"sfsp__ListViewColumn__c",sfsp__Column__c:d.name,sfsp__ListView__c:t.Id,sfsp__Order__c:d.order||p+1,sfsp__SalesNodeBoundary__c:(y=d.boundaryObject)==null?void 0:y.id,sfsp__SalesAssignmentObject__c:(v=d.assignmentObject)==null?void 0:v.id,sfsp__Type__c:d.columnType.description,sfsp__SummaryFormat__c:d.summaryFormat||"Sum"}});await SPM.Utils.CRM.upsert({records:n}),this.currentListView=t.Id,e=!0;break;case da.RENAME:const r={Id:this.currentListView,Name:this.configuredListViewName};await SPM.Utils.CRM.upsert({records:[r]});break;case da.SELECT_FIELDS:const a=[],o=[];this.selectableFields.forEach(d=>{var p,y;if(!d.selected&&d.columnId)a.push({Id:d.columnId});else if(d.selected){const v={sobjectType:"sfsp__ListViewColumn__c",Id:d.columnId,sfsp__Column__c:d.name,sfsp__Order__c:d.order,sfsp__SalesNodeBoundary__c:(p=d.boundaryObject)==null?void 0:p.id,sfsp__SalesAssignmentObject__c:(y=d.assignmentObject)==null?void 0:y.id,sfsp__Type__c:d.columnType.description,sfsp__SummaryFormat__c:d.summaryFormat||"Sum"};v.Id||(v.sfsp__ListView__c=this.currentListView),o.push(v)}}),a.length&&(e=!0,await SPM.Utils.CRM.delete({records:a})),o.length&&(e=!0,await SPM.Utils.CRM.upsert({records:o}));break;case da.DELETE:await SPM.Utils.CRM.delete({records:[{Id:this.currentListView}]}),this.currentListView=Ep,e=!0;break}this.onListViewActionCancel(),this.customListViews=await EA(),e&&this.emitListViewColumns()}catch(e){this.$store.toast({message:e.name||e.type,subMessage:e.message||e.error.message,state:"error"})}finally{this.loadingListViewActionModal=!1}},onListViewActionCancel(){this.listViewAction=null,this.configuredListViewName=null,this.renderListViewActionModal=!1,this.loadingListViewActionModal=!1},onListViewSelect(e){this.currentListView=e.id,this.emitListViewColumns(),this.currentListView!==Ep?SPM.Utils.CRM.upsert({records:[{Id:e.id,sfsp__LastViewed__c:Date.now()}]}):SPM.Utils.CRM.upsert({records:this.computedListViews.slice(1).map(t=>({Id:t.id,sfsp__LastViewed__c:0}))})},emitListViewColumns(){let e;this.currentListView===Ep?e=this.computedListViews[0].columns:e=this.computedListViews.find(t=>t.id===this.currentListView).columns,this.$emit("change",e)}}},zG={class:"slds-grid slds-grid_vertical-align-center slds-p-around_large"},UG={class:"slds-grid slds-grid_vertical-align-center"},VG={class:"slds-grid slds-grid_vertical"},jG={class:"slds-text-body_default slds-text-color_weak slds-p-bottom_xx-small"},qG={class:"slds-text-color_default slds-page-header__title"},HG={class:"slds-col_bump-left slds-grid slds-grid_vertical-align-center"},GG={key:1,style:{"text-align":"center"}},WG={class:"slds-grid"},YG={class:"slds-col_bump-left"};function ZG(e,t,s,n,r,a){const o=pe("SLDSButton"),d=pe("ActionMenuItem"),p=pe("ActionMenu"),y=pe("ButtonIcon"),v=pe("Spinner"),C=pe("DuelingPicklist"),I=pe("TextInput"),O=pe("Modal");return L(),X(Lt,null,[k("div",zG,[k("div",UG,[k("div",VG,[k("span",jG,Pe(e.$props.title),1),de(p,{isActionMenu:!1,class:"slds-col"},{button:je(()=>[de(o,{id:"list-view-switcher",style:{border:"none","margin-top":"-4px"},variant:"base",iconCategory:"utility",iconName:"down",iconPosition:"right",iconVariant:"default"},{default:je(()=>[k("span",qG,[k("strong",null,Pe(a.computedSelectedListViewLabel),1)])]),_:1})]),default:je(()=>[de(d,{label:"list views",header:""}),(L(!0),X(Lt,null,As(a.computedListViews,A=>(L(),Ge(d,{key:A.id,selected:r.currentListView===A.id,label:A.label,role:"menuitemradio",onClick:P=>a.onListViewSelect(A)},null,8,["selected","label","onClick"]))),128))]),_:1})])]),k("div",HG,[js(e.$slots,"controls-left"),e.$store.isEditor?(L(),Ge(p,{key:0},{button:je(()=>[de(y,{name:"list-view-controls",iconCategory:"utility",iconName:"settings",variant:"border-filled",title:"Settings",assistiveText:"Settings",more:""})]),default:je(()=>[de(d,{label:"list view controls",header:""}),de(d,{label:"New",onClick:t[0]||(t[0]=A=>a.onListViewAction(r.ListViewActions.NEW))}),de(d,{label:"Clone",disabled:a.isDefaultListView,onClick:t[1]||(t[1]=A=>a.isDefaultListView?null:a.onListViewAction(r.ListViewActions.CLONE))},null,8,["disabled"]),de(d,{label:"Rename",disabled:a.isDefaultListView,onClick:t[2]||(t[2]=A=>a.isDefaultListView?null:a.onListViewAction(r.ListViewActions.RENAME))},null,8,["disabled"]),de(d,{label:"Select Fields to Display",disabled:a.isDefaultListView,onClick:t[3]||(t[3]=A=>a.isDefaultListView?null:a.onListViewAction(r.ListViewActions.SELECT_FIELDS))},null,8,["disabled"]),e.$store.isAdmin||e.$store.isManager?(L(),Ge(d,{key:0,label:"Delete",disabled:a.isDefaultListView,onClick:t[4]||(t[4]=A=>a.isDefaultListView?null:a.onListViewAction(r.ListViewActions.DELETE))},null,8,["disabled"])):$e("",!0)]),_:1})):$e("",!0),js(e.$slots,"controls-right")])]),r.renderListViewActionModal?(L(),Ge(O,{key:0,size:"base",title:a.computedListViewModalTitle,onClose:a.onListViewActionCancel},{content:je(()=>[r.loadingListViewActionModal?(L(),Ge(v,{key:0})):$e("",!0),r.listViewAction===r.ListViewActions.DELETE?(L(),X("div",GG," Deleting this list view also deletes it for any users with access to it. ")):r.listViewAction===r.ListViewActions.SELECT_FIELDS?(L(),Ge(C,{key:2,fields:r.selectableFields,labels:{name:"Available Fields"}},null,8,["fields"])):(L(),Ge(I,{key:3,modelValue:r.configuredListViewName,"onUpdate:modelValue":t[5]||(t[5]=A=>r.configuredListViewName=A),labels:{name:"List View Name"},required:""},null,8,["modelValue"]))]),footer:je(()=>[k("div",WG,[k("div",YG,[de(o,{disabled:r.loadingListViewActionModal,class:"slds-button slds-button_neutral",label:"Cancel",onClick:a.onListViewActionCancel},null,8,["disabled","onClick"]),de(o,{disabled:r.loadingListViewActionModal,class:"slds-button slds-button_brand",label:a.isDeleteListViewAction?"Delete":"Save",onClick:a.onListViewActionSave},null,8,["disabled","label","onClick"])])])]),_:1},8,["title","onClose"])):$e("",!0)],64)}const RR=os(FG,[["render",ZG]]),XG={name:"ErrorPopover",components:{ButtonIcon:vn,Popover:Uc},props:{error:String,errors:Object,lazy:Boolean,refs:Object},data(){return{renderPopover:!1}},mounted(){SPM.Components.FormErrorIndicator=this,this.lazy||(this.renderPopover=!0)},methods:{focusElementWithError(e){this.renderPopover=!1,this.$nextTick(()=>this.refs[e.ref].focus())}}},KG=k("span",null,"We hit a snag.",-1),JG={key:0},QG=k("div",{style:{"margin-bottom":"0.25rem","margin-left":"-0.5rem","font-weight":"600"}}," Review the following fields ",-1),eW={class:"slds-m-left_medium",style:{"list-style":"disc"}},tW=["onClick"];function sW(e,t,s,n,r,a){const o=pe("ButtonIcon"),d=pe("Popover");return L(),X(Lt,null,[de(o,{ref:"errorButtonIcon",assistiveText:"Error",title:"Error",iconCategory:"utility",iconName:"error",iconSize:"large",class:"slds-button_icon-error",onClick:t[0]||(t[0]=p=>r.renderPopover=!r.renderPopover)},null,512),r.renderPopover?(L(),Ge(d,{key:0,ref:"errorPopover",bindTo:e.$refs.errorButtonIcon.$el,theme:"error",width:"medium",class:"slds-text-align_left",onClose:t[1]||(t[1]=p=>r.renderPopover=!1)},{header:je(()=>[KG]),content:je(()=>[s.error?(L(),X("div",JG,Pe(s.error),1)):$e("",!0),s.errors?(L(),X(Lt,{key:1},[QG,k("ul",eW,[(L(!0),X(Lt,null,As(s.errors,(p,y)=>(L(),X("li",{key:y,class:$t({"slds-text-link":p.ref}),onClick:v=>a.focusElementWithError(p)},Pe(p.message),11,tW))),128))])],64)):$e("",!0)]),_:1},8,["bindTo"])):$e("",!0)],64)}const $R=os(XG,[["render",sW]]),nW={name:"EditNode",components:{FormErrorIndicator:$R,Picklist:Qi,Popover:Uc,SLDSButton:Tn,TextInput:Ko},props:["contextNode","targetBindTo","error","allowReparent"],emits:["close","save"],data(){return{parent:{},parentId:this.$store.nodeMap[this.contextNode.parentId].name,searchOptions:[{options:this.getSearchOptions}],name:"",showError:!0}},computed:{accessibleNodeIds(){return[this.$store.branch.id,...this.$store.branch.descendantIds]}},mounted(){this.parent=this.$store.nodeMap[this.contextNode.parentId],this.name=this.contextNode.name},methods:{async getSearchOptions(e){const t=[];e=e.replace(/'/g,"\\'");const s=await this.searchHierarchy(e.toLowerCase());return this.$store.branch.id==="All Org"&&"all org".includes(e.toLowerCase())&&s.push({id:"All Org",name:"All Org"}),s.forEach(n=>{n.id!==this.contextNode.id&&t.push({id:n.id,title:n.name,parent:n.parentName})}),t},async searchHierarchy(e){const t=[];return(await SPM.Utils.Apex.invoke("Query",[`
                    SELECT
                        Id,
                        Name,
                        sfsp__Parent__r.Name,
                        sfsp__Parent__r.sfsp__Parent__r.Name
                    FROM sfsp__SalesNode__c
                    WHERE sfsp__SalesPlan__c = '${SPM.$store.plan.Id}' AND Name LIKE '%${e}%'
                `])).forEach(n=>{var r,a,o;if(this.accessibleNodeIds.includes(n.sfsp__Parent__c||"All Org")){const d=(r=n.sfsp__Parent__r)!=null&&r.sfsp__Parent__c?this.accessibleNodeIds.includes(n.sfsp__Parent__r.sfsp__Parent__c):!1;t.push({id:n.Id,name:n.Name,parentName:((a=n.sfsp__Parent__r)==null?void 0:a.Name)||"All Org",grandparentName:d?((o=n.sfsp__Parent__r.sfsp__Parent__r)==null?void 0:o.Name)||"All Org":""})}}),t},async selectParent(e){const t=this.$store.nodeMap[e.id]||await this.getNode({nodeId:e.id});this.parent={id:t.id,name:t.name,parentId:t.parentId||"All Org",childCount:t.childCount||0},this.showError=!1},async getNode({nodeId:e}){var s;this.isLoading=!0;const t=(await SPM.Utils.Apex.invoke("Query",[`
                    SELECT
                        Id,
                        Name,
                        sfsp__Parent__c,
                        (
                            SELECT Id
                            FROM sfsp__SalesNodes__r
                        )
                    FROM sfsp__SalesNode__c
                    WHERE sfsp__SalesPlan__c = '${SPM.$store.plan.Id}' AND Id = '${e}'
                `]))[0];return this.isLoading=!1,{id:t.Id,name:t.Name,parentId:t.sfsp__Parent__c||"All Org",childCount:((s=t.sfsp__SalesNodes__r)==null?void 0:s.length)||0}},save(){this.showError=!0,this.$emit("save",{id:this.contextNode.id,name:this.name,parentId:this.parent.id,nodeHasNewParent:this.contextNode.parentId!==this.parent.id})}}},rW=e=>(Nr("data-v-fd2e7ef0"),e=e(),Dr(),e),iW=rW(()=>k("div",{class:"slds-grid slds-grid_align-center slds-grid_vertical-align-center"}," Edit Node ",-1)),oW={class:"slds-p-around_medium slds-border_top slds-scrollable_y",style:{"max-height":"20rem"}},aW={class:"slds-grid slds-grid_vertical slds-grid_vertical-align-bottom"},lW={class:"slds-media__body"},cW=["title"],uW={key:0,class:"slds-listbox__option-meta"},dW={class:"slds-grid slds-grid_align-end slds-grid_vertical-align-center"},hW={class:"slds-grid slds-grid_vertical-align-center slds-m-right_x-small nested-popover"};function pW(e,t,s,n,r,a){const o=pe("Picklist"),d=pe("TextInput"),p=pe("FormErrorIndicator"),y=pe("SLDSButton"),v=pe("Popover");return L(),Ge(v,{bindTo:s.targetBindTo,alignment:"right",position:"absolute",width:"large",onClose:t[3]||(t[3]=C=>e.$emit("close"))},{header:je(()=>[iW]),content:je(()=>[k("div",oW,[k("div",aW,[de(o,{modelValue:r.parentId,"onUpdate:modelValue":t[0]||(t[0]=C=>r.parentId=C),labels:{name:"Parent Node",search:"Quick find..."},minSearchLength:0,filterable:"",options:r.searchOptions,errors:r.showError&&e.$props.error?["Please select a different node"]:[],disabled:!s.allowReparent||!a.accessibleNodeIds.includes(r.parent.id),onSelectedOption:a.selectParent},{option:je(({option:C})=>[k("span",lW,[k("span",{class:"slds-truncate",title:C.title},Pe(C.title),9,cW),C.parent?(L(),X("span",uW,"Parent: "+Pe(C.parent),1)):$e("",!0)])]),_:1},8,["modelValue","labels","options","errors","disabled","onSelectedOption"]),de(d,{modelValue:r.name,"onUpdate:modelValue":t[1]||(t[1]=C=>r.name=C),class:"slds-col",labels:{name:"Node Name"}},null,8,["modelValue"])])])]),footer:je(()=>[k("div",dW,[k("div",hW,[r.showError&&e.$props.error?(L(),Ge(p,{key:0,error:e.$props.error,lazy:""},null,8,["error"])):$e("",!0)]),de(y,{variant:"neutral",onClick:t[2]||(t[2]=C=>e.$emit("close"))},{default:je(()=>[es("Cancel")]),_:1}),de(y,{variant:"brand",disabled:!r.parentId||r.parentId===r.name,onClick:a.save},{default:je(()=>[es("Save")]),_:1},8,["disabled","onClick"])])]),_:1},8,["bindTo"])}const OR=os(nW,[["render",pW],["__scopeId","data-v-fd2e7ef0"]]),fW={name:"AddNodes",components:{Button:Tn,ButtonIcon:vn,TextInput:Ko,Popover:Uc,FormErrorIndicator:$R},props:["contextNode","targetBindTo","singleLevel"],emits:["save","close"],data(){return{levels:[{name:"",placeholder:`Level ${this.contextNode.level+1}`,depth:this.contextNode.level,count:1}]}},computed:{total(){const e=this.levels.map(r=>r.count),t=e[0];e.splice(0,1);let s=t,n=t;return e.reduce((r,a)=>n+=s*=a,t)},totalInvalid(){return this.total>1e3}},mounted(){},methods:{showNextLevel(){const e=this.levels[this.levels.length-1];this.levels.push({name:"",placeholder:`Level ${e.depth+2}`,depth:e.depth+1,count:1}),this.$refs.popover.popperInstance.update()},removeLevel(e){const t=this.levels.map((s,n)=>(n>e&&(s.depth--,s.placeholder=`Level ${s.depth+1}`),s));t.splice(e,1),this.levels=t,this.$refs.popover.popperInstance.update()},isNumber(e){const t=["0","1","2","3","4","5","6","7","8","9"],s=e.key;t.includes(s)||e.preventDefault()}}},mW=e=>(Nr("data-v-588a5e33"),e=e(),Dr(),e),_W=mW(()=>k("div",{class:"slds-grid slds-grid_align-center slds-grid_vertical-align-center"}," Add Nodes ",-1)),gW={class:"slds-p-around_medium slds-border_top",style:{"max-height":"20rem",overflow:"auto"}},yW={class:"slds-grid slds-grid_vertical-align-center slds-p-around_medium slds-border_top nested-popover"},vW={class:"slds-grid slds-grid_align-spread slds-grid_vertical-align-center"};function bW(e,t,s,n,r,a){const o=pe("TextInput"),d=pe("ButtonIcon"),p=pe("FormErrorIndicator"),y=pe("Button"),v=pe("Popover");return L(),Ge(v,{bindTo:s.targetBindTo,ref:"popover",alignment:"right",position:"absolute",width:"medium",closeOnClickOutside:"",onClose:t[3]||(t[3]=C=>e.$emit("close"))},{header:je(()=>[_W]),content:je(()=>[k("div",gW,[(L(!0),X(Lt,null,As(r.levels,(C,I)=>(L(),X("div",{key:C.depth,class:"slds-grid slds-grid_vertical-align-bottom slds-m-bottom_small"},[de(o,{modelValue:C.name,"onUpdate:modelValue":O=>C.name=O,class:"slds-col slds-size_6-of-12 slds-m-right_small",labels:{name:`${C.placeholder} Name`}},null,8,["modelValue","onUpdate:modelValue","labels"]),de(o,{modelValue:C.count,"onUpdate:modelValue":O=>C.count=O,modelModifiers:{number:!0},style:{"white-space":"nowrap"},class:"slds-col slds-m-right_small",labels:{name:"Number of Nodes"},onKeypress:t[0]||(t[0]=O=>a.isNumber(O)),"onUpdate:hasFocus":()=>{C.count||(C.count=0)}},null,8,["modelValue","onUpdate:modelValue","onUpdate:hasFocus"]),de(d,{style:{position:"relative",margin:"0.25rem","z-index":"6001","align-self":"flex-end"},class:"slds-col",iconCategory:"utility",iconName:"close",size:"small",assistiveText:"Remove Level",title:"Remove Level",disabled:I===0,onClick:O=>a.removeLevel(I)},null,8,["disabled","onClick"])]))),128)),s.singleLevel?$e("",!0):(L(),Ge(d,{key:0,iconCategory:"utility",iconName:"add",variant:"border-filled",size:"small",assistiveText:"Next Level",title:"Next Level",onClick:a.showNextLevel},null,8,["onClick"]))]),k("div",yW,[a.totalInvalid?(L(),Ge(p,{key:0,error:"Add as many as 1,000 nodes.",lazy:""})):$e("",!0),k("span",{style:br(a.totalInvalid?"color: #ea001e; font-weight: 700; margin-left: .5rem;":"")},"Nodes: "+Pe(e.$F("Numeric",a.total)),5)])]),footer:je(()=>[k("div",vW,[de(y,{variant:"neutral",onClick:t[1]||(t[1]=C=>e.$emit("close"))},{default:je(()=>[es("Cancel")]),_:1}),de(y,{variant:"brand",disabled:a.totalInvalid,onClick:t[2]||(t[2]=C=>e.$emit("save",{levels:r.levels}))},{default:je(()=>[es("Save")]),_:1},8,["disabled"])])]),_:1},8,["bindTo"])}const uI=os(fW,[["render",bW],["__scopeId","data-v-588a5e33"]]),xW={name:"ColumnCell",components:{Icon:yn,ActionMenu:wa,ActionMenuItem:Sa,ButtonIcon:vn},props:["column"],emits:["change-root-node","handle-column-action"],computed:{accessibleNodeIds(){return[this.$store.branch.id,...this.$store.branch.descendantIds]}}},wW={key:0,class:"slds-grid slds-grid_vertical-align-center"},SW=k("span",{class:"slds-p-horizontal_x-small"},">",-1),CW={key:1,class:"slds-grid slds-grid_align-spread slds-grid_vertical-align-center",style:{width:"100%"}},IW={class:"slds-grid slds-grid_vertical-align-center"},TW={class:"slds-m-left_x-small"},AW=k("span",{class:"slds-text-color_default"},"Remove Allocation Values",-1);function MW(e,t,s,n,r,a){const o=pe("Icon"),d=pe("ButtonIcon"),p=pe("ActionMenuItem"),y=pe("ActionMenu");return s.column.format==="Name"?(L(),X("div",wW,[e.$store.rootNode.id!=="All Org"&&a.accessibleNodeIds.includes(e.$store.rootNode.parentId||"All Org")?(L(),X(Lt,{key:0},[k("span",{class:"slds-text-title_normal slds-text-link",style:{color:"#0250D9"},onClick:t[0]||(t[0]=v=>e.$emit("change-root-node",e.$store.rootNode.parentId))},Pe(e.$store.nodeMap[e.$store.rootNode.parentId].name),1),SW],64)):$e("",!0),k("span",null,Pe(e.$store.rootNode.name),1)])):(L(),X("div",CW,[k("div",IW,[["Assignment","Boundary"].includes(s.column.format)?(L(),Ge(o,kp(Ji({key:0},{size:"x-small",...s.column.icon})),null,16)):$e("",!0),k("span",TW,Pe(s.column.name),1)]),s.column.format==="Metric"&&e.$store.isEditor?(L(),Ge(y,{key:0,disabled:e.$store.showPreview,class:"slds-p-right_x-small",onClick:t[2]||(t[2]=v=>v.stopImmediatePropagation())},{button:je(()=>[de(d,{iconCategory:"utility",iconName:"down",variant:"border-filled",size:"x-small",disabled:e.$store.showPreview,assistiveText:`${s.column.name} Actions`,title:`${s.column.name} Actions`},null,8,["disabled","assistiveText","title"])]),default:je(()=>[de(p,{label:"",onClick:t[1]||(t[1]=v=>e.$emit("handle-column-action",{action:"CLEAR_ALLOCATION_VALUES",column:s.column}))},{default:je(()=>[AW]),_:1})]),_:1},8,["disabled"])):$e("",!0)]))}const EW=os(xW,[["render",MW]]),kW={name:"RowCell",components:{Spinner:Vr,ActionMenu:wa,ActionMenuItem:Sa,ButtonIcon:vn},props:["cell","period"],emits:["handle-row-action","change-root-node"],computed:{summaryFormat(){return this.cell.column.summaryFormat},formattedValue(){let e="";if(this.summaryFormat==="PercentOfFocus"){const s=this.cell.column.summaryValue/this.$store.scopeChildNodes.length;e=100*(this.cell.data.value/s),e=Number.isFinite(e)?`${this.$F("Numeric",e)}%`:"0%"}return this.cell.data.format==="HierarchyReference"&&(this.cell.data.value===null||this.cell.data.refField.type==="Text")?{value:this.cell.data.value,percentValue:e}:{value:this.$F("Numeric",this.cell.data.value),percentValue:e}},formattedPreview(){let e="";if(this.summaryFormat==="PercentOfFocus"){const s=this.cell.column.previewValue/this.$store.scopeChildNodes.length;e=100*(this.cell.data.previewValue/s),e=Number.isFinite(e)?`${this.$F("Numeric",e)}%`:"0%"}return this.cell.data.format==="HierarchyReference"&&(this.cell.data.value===null||this.cell.data.refField.type==="Text")?{value:this.cell.data.value,percentValue:e}:{value:this.$F("Numeric",this.cell.data.previewValue),percentValue:e}}}},LR=e=>(Nr("data-v-556021ab"),e=e(),Dr(),e),PW={key:0,class:"slds-grid slds-grid_vertical-align-center slds-p-around_x-small"},RW={class:"slds-form-element__control"},$W={class:"slds-checkbox"},OW=["id","name","checked","indeterminate"],LW=["for"],NW=LR(()=>k("span",{class:"slds-checkbox_faux"},null,-1)),DW={class:"slds-form-element__label slds-assistive-text"},BW={class:"slds-col_bump-right slds-p-horizontal_medium"},FW=["name"],zW=["name"],UW=["name"],VW={key:1,class:"slds-button-group slds-grid_vertical-align-center",role:"group"},jW={key:1,class:"slds-grid slds-grid_vertical slds-grid_align-start slds-grid_vertical-align-center"},qW={class:"slds-grid slds-grid_align-end slds-grid_vertical-align-center slds-p-vertical_xx-small slds-p-horizontal_x-small",style:{width:"100%"}},HW=["name"],GW={class:"slds-text-color_weak"},WW={key:2,class:"slds-grid slds-grid_vertical slds-grid_align-start slds-grid_vertical-align-center"},YW=LR(()=>k("div",{class:"slds-grid slds-grid_align-end slds-grid_vertical-align-center slds-p-vertical_xx-small slds-p-horizontal_x-small",style:{width:"100%"}},"-",-1)),ZW=[YW],XW={key:3,class:"slds-grid slds-grid_vertical slds-grid_align-start slds-grid_vertical-align-center"},KW={key:1,class:"slds-grid slds-grid_align-end slds-grid_vertical-align-center slds-p-vertical_xx-small slds-p-horizontal_x-small",style:{width:"100%"}},JW=["name"],QW={class:"slds-text-color_weak"};function eY(e,t,s,n,r,a){var v;const o=pe("ButtonIcon"),d=pe("ActionMenuItem"),p=pe("ActionMenu"),y=pe("Spinner");return s.cell.data.format==="Name"?(L(),X("div",PW,[e.$store.isEditor?(L(),X("div",{key:0,class:$t(["slds-form-element",{"slds-m-left_medium":!s.cell.data.isRoot}])},[k("div",RW,[k("div",$W,[k("input",{id:`checkbox-${s.cell.data.node.id}`,type:"checkbox",name:`${s.cell.data.node.name.replaceAll(" ","-").toLowerCase()}-allocation-node-checkbox`,checked:s.cell.data.selected==="all",indeterminate:s.cell.data.selected==="some",hideLabel:"",onClick:t[0]||(t[0]=Os(C=>e.$emit("handle-row-action",{action:"CHANGE_SELECTION",cell:s.cell}),["prevent"]))},null,8,OW),k("label",{class:"slds-checkbox__label",for:`checkbox-${s.cell.data.node.id}`},[NW,k("span",DW,"Select "+Pe(s.cell.data.node.name),1)],8,LW)])])],2)):$e("",!0),k("div",BW,[k("div",{class:"slds-text-title_normal slds-text-link",name:`${s.cell.data.node.name.replaceAll(" ","-").toLowerCase()}-allocation-node-name`,style:{color:"#0250D9"},onClick:t[1]||(t[1]=C=>e.$emit("change-root-node",s.cell.data.node.id))},Pe(s.cell.data.node.name),9,FW),s.cell.data.node.childCount===1?(L(),X("div",{key:0,name:`${s.cell.data.node.name.replaceAll(" ","-").toLowerCase()}-allocation-node-level`,class:"slds-text-body_regular"},Pe(s.cell.data.node.childCount)+" child node \u2022 Level "+Pe(s.cell.data.node.level),9,zW)):(L(),X("div",{key:1,class:"slds-text-body_regular",name:`${s.cell.data.node.name.replaceAll(" ","-").toLowerCase()}-allocation-node-level`},Pe(s.cell.data.node.childCount)+" child nodes \u2022 Level "+Pe(s.cell.data.node.level),9,UW))]),e.$store.isEditor?(L(),X("div",VW,[s.cell.row.data[0].isRoot?(L(),Ge(o,{key:0,name:`allocation-add-node-${s.cell.data.node.name.replaceAll(" ","-").toLowerCase()}`,iconCategory:"utility",iconName:"add",variant:"border-filled",size:"small",title:`Add Node to ${s.cell.data.node.name}`,assistiveText:`Add Node to ${s.cell.data.node.name}`,disabled:e.$store.showPreview,onClick:t[2]||(t[2]=C=>e.$emit("handle-row-action",{action:"OPEN_ADD_NODES",cell:s.cell,bindTo:C.target}))},null,8,["name","title","assistiveText","disabled"])):$e("",!0),de(o,{name:`allocation-edit-node-${s.cell.data.node.name.replaceAll(" ","-").toLowerCase()}`,iconCategory:"utility",iconName:"edit",variant:"border-filled",size:"small",title:`Edit ${s.cell.data.node.name}`,assistiveText:`Edit ${s.cell.data.node.name}`,disabled:s.cell.row.data[0].isRoot||e.$store.showPreview,onClick:t[3]||(t[3]=C=>e.$emit("handle-row-action",{action:"OPEN_EDIT_NODE",cell:s.cell,bindTo:C.target}))},null,8,["name","title","assistiveText","disabled"]),de(p,{name:`${s.cell.data.node.name.replaceAll(" ","-").toLowerCase()}-allocation-node-actions`,class:"node-menu-button slds-button_last",disabled:s.cell.row.data[0].isRoot||e.$store.showPreview},{button:je(()=>[de(o,{iconCategory:"utility",iconName:"threedots_vertical",disabled:s.cell.row.data[0].isRoot||e.$store.showPreview,variant:"border-filled",size:"small",title:`Add Node to ${s.cell.data.node.name}`,assistiveText:`Add Node to ${s.cell.data.node.name}`},null,8,["disabled","title","assistiveText"])]),default:je(()=>[de(d,{label:"Share",disabled:!e.$store.hasSalesPlanningTemplateApp,onClick:t[4]||(t[4]=C=>e.$emit("handle-row-action",{action:"SHARE_NODE",node:s.cell.data.node}))},null,8,["disabled"]),de(d,{label:"Remove Allocation Values",onClick:t[5]||(t[5]=C=>e.$emit("handle-row-action",{action:"CLEAR_ROW_ALLOCATION",cell:s.cell}))}),e.$store.isAdmin||e.$store.isManager?(L(),Ge(d,{key:0,label:"Delete Node",onClick:t[6]||(t[6]=C=>e.$emit("handle-row-action",{action:"DELETE_NODE",cell:s.cell}))})):$e("",!0)]),_:1},8,["name","disabled"])])):$e("",!0),s.period!=="Year"&&!s.cell.row.data[0].isRoot?(L(),Ge(o,{key:2,class:"spm-subperiod-button slds-is-absolute",variant:"border-filled",iconCategory:"utility",iconName:s.cell.row.subperiodExpanded?"dash":"add",size:"xx-small",title:`Expand sub period row for ${s.cell.data.node.name}`,assistiveText:`Expand sub period row for ${s.cell.data.node.name}`,onClick:t[7]||(t[7]=C=>e.$emit("handle-row-action",{action:"TOGGLE_SUBPERIOD_ROWS",cell:s.cell}))},null,8,["iconName","title","assistiveText"])):$e("",!0)])):["Assignment"].includes(s.cell.data.format)?(L(),X("div",jW,[s.cell.data.state==="loading"||((v=s.cell.data.object.recordsDataset)==null?void 0:v.dataflowStatus)?(L(),Ge(y,{key:0,size:"x-small",style:{"z-index":"1"}})):$e("",!0),k("div",qW,[k("span",{name:`${s.cell.row.title.replaceAll(" ","-").toLowerCase()}-allocation-${s.cell.data.name.replaceAll(" ","-").toLowerCase()}-value`,class:$t({"slds-p-right_x-small":a.formattedValue.percentValue})},Pe(a.formattedValue.value),11,HW),k("span",GW,Pe(a.formattedValue.percentValue),1)])])):s.cell.data.format==="Empty"?(L(),X("div",WW,ZW)):(L(),X("div",XW,[s.cell.data.state==="loading"?(L(),Ge(y,{key:0,size:"x-small",style:{"z-index":"1"}})):(L(),X("div",KW,[k("span",{name:`${s.cell.row.title.replaceAll(" ","-").toLowerCase()}-allocation-${s.cell.data.name.replaceAll(" ","-").toLowerCase()}-value`,class:$t({"slds-p-right_x-small":a.formattedValue.percentValue})},Pe(a.formattedValue.value),11,JW),k("span",QW,Pe(a.formattedValue.percentValue),1)]))]))}const tY=os(kW,[["render",eY],["__scopeId","data-v-556021ab"]]),sY={name:"AllocationRoot",components:{AddNodes:uI,EditNode:OR,Icon:yn,ActionMenu:wa,ActionMenuItem:Sa,Button:Tn,ButtonIcon:vn,Badge:lx,Card:Xp,TextInput:Ko,Picklist:Qi,ProgressBar:lI,Spinner:Vr,DataTable:Rm,NodeMetric:sG,NumberAnimator:kR,ListViewManager:RR,PillList:Ek,NodeMetricHeader:lG,ColumnCell:EW,RowCell:tY,Tooltip:Fo},data(){return{loadingMsg:"",showSidePanel:!1,period:"Year",periods:[{id:"Year",title:"Year"},{id:"Quarter",title:"Quarter"},{id:"Month",title:"Month"}],autoAllocation:{loadingMsg:"",state:"configuration",metricId:"",temporaryMetricId:"",dirty:!1,amount:0,nodeCount:0,methods:[{id:"even",label:"Equally across nodes"},{id:"fixed",label:"Fixed across nodes"},{id:"field",label:"Proportional to another field's values",style:{"border-bottom":"none"}}],selectedMethod:"even",distributionPercents:[{months:[],percent:25,label:"Quarter 1"},{months:[],percent:25,label:"Quarter 2"},{months:[],percent:25,label:"Quarter 3"},{months:[],percent:25,label:"Quarter 4"}],distributionField:""},rootNode:{},nodeMap:{},metricRollups:this.$store.plan.sfsp__SalesMetrics__r.reduce((e,t)=>(e[t.Id]={rollup:0,steps:[]},e),{}),showAddNodesPopup:!1,showEditNodePopup:!1,contextRow:{},contextNode:{},targetBindTo:null,rows:[],columns:[],ColumnTypes:Cs,metrics:[],loadMetricData:!1,rootNodeMetrics:[]}},computed:{selectedRows(){return this.rows.filter(e=>!e.data[0].isRoot&&e.data[0].selected==="all")},allocationFields(){return this.columns.filter(e=>e.id!=="Name")},autoAllocationDisabled(){return this.autoAllocation.selectedMethod==="field"?!this.autoAllocation.metricId||this.autoAllocation.amount===""||this.autoAllocation.distributionField==="":!this.autoAllocation.metricId||this.autoAllocation.amount===""}},watch:{"$store.scope":{async handler(){await this.$store.loadLevel({level:this.$store.scope,onProgress:e=>this.loadingMsg=e}),this.loadingMsg="",this.updateRows()}},period:{handler(){this.updateRows()},immediate:!0},"autoAllocation.state":{handler(){this.$store.showPreview=this.autoAllocation.state==="preview"}},metrics:{async handler(){SPM.Utils.Async.forEachParallel(this.metrics,async e=>{const t=this.metricRollups[e.id];if(t.steps.at(-1)!==e.rollup){if(t.steps.length){if(t.steps.length===1)t.steps[0]=e.rollup;else{let s=t.steps[0];const n=t.steps.splice(1).length,r=(e.rollup-s)/n;for(let a=0;a<n;a++)s+=r,t.steps.push(s)}return}if(e.rollup!==t.rollup){const s=(e.rollup-t.rollup)/25;let n=t.rollup;for(let a=0;a<25;a++)n+=s,t.steps.push(n);const r=this;(async function a(){if(t.steps.length){t.rollup=t.steps.shift(),SPM.Utils.Async.wait(20,a);return}t.rollup=r.metrics.find(o=>o.id===e.id).rollup})()}}})},deep:!0},"autoAllocation.metricId":{handler(e){this.setSelectedColumnMetric(e)}},selectedRows(e){this.autoAllocation.state==="preview"&&(e.length===0?(this.cancelAutoAllocation({clearAll:!0}),this.showSidePanel=!1):this.autoAllocation.dirty=!0)}},created(){this.autoAllocation.distributionPercents=SPM.Utils.Allocation.generateAllocationDistributionTable(),this.buildMetrics(!1),this.metrics.length===1&&(this.autoAllocation.temporaryMetricId=this.metrics[0].id,this.autoAllocation.metricId=this.metrics[0].id,this.metrics[0].selected=!0)},mounted(){SPM.Components.Allocation=this,this.rootNodeMetrics=this.metrics.map(e=>({...e,rollup:0})),SPM.Utils.Splunk.sendLog({logName:"spmEPT",logPayload:{pageName:"Allocation"}})},methods:{async onNodeMetricHeaderLoad(){this.loadMetricData=!0,await this.$nextTick(),this.rootNodeMetrics=this.metrics},buildMetrics(e=!0){const t=this.metrics.find(s=>s.isPreview);this.metrics=[],this.$store.plan.sfsp__SalesMetrics__r.forEach(s=>{var p,y;const n=(((p=this.$store.rootNode)==null?void 0:p.metrics)||[]).find(v=>v.sfsp__SalesMetric__c===s.Id);if(!n)return;let r=Array(12).fill().reduce((v,C,I)=>v+n[`sfsp__Target_Month${I+1}__c`],0),a=0;const d=(((y=this.$store.rootNode)==null?void 0:y.children)||[]).reduce((v,C)=>{const I=C.metrics.find(A=>A.sfsp__SalesMetric__c===s.Id),O=Array(12).fill().reduce((A,P,q)=>A+I[`sfsp__Target_Month${q+1}__c`],0);return v+O},0);a=r,n.sfsp__TargetOverrideAmount__c!==0&&(r+=n.sfsp__TargetOverrideType__c==="Percentage"?a!==0?n.sfsp__TargetOverrideAmount__c/100*r:n.sfsp__TargetOverrideAmount__c/100:n.sfsp__TargetOverrideAmount__c),this.metrics.push({id:s.Id,name:s.Name,type:s.sfsp__Type__c,selected:this.autoAllocation.metricId===s.Id,rollup:d,isLoading:!1,isPreview:(t==null?void 0:t.id)===s.Id||!1,preview:{rollup:(t==null?void 0:t.preview.rollup)||0,remaining:(t==null?void 0:t.preview.remaining)||0,progress:(t==null?void 0:t.preview.progress)||0},target:r,originalTarget:a,targetOverrideEnabled:s.sfsp__TargetOverrideEnabled__c,targetOverrideAmount:n.sfsp__TargetOverrideAmount__c,targetOverrideType:n.sfsp__TargetOverrideType__c,remaining:r-d,progress:Math.floor(100*d/r)})}),e&&(this.rootNodeMetrics=this.metrics)},setSelectedColumnMetric(e=""){this.columns.forEach(t=>{t.columnType===Cs.METRIC&&(t.selected=t.id===e)})},async updateAllocation(){this.cancelAutoAllocation({clearAll:!1}),await this.$nextTick(),this.previewAutoAllocation()},getRootNodeMetric(e){return this.rootNodeMetrics.find(t=>e.data.nodeMetric.sfsp__SalesMetric__c===t.id)},formatRootNodeMetric(e){var s,n;const t=this.getRootNodeMetric(e);return this.$F(t.type,((n=(s=this.metricRollups)==null?void 0:s[t.id])==null?void 0:n.rollup)||0)},async loadRootNode(e){this.rootNodeMetrics=this.metrics,this.cancelAutoAllocation({clearAll:!0}),await SPM.Components.Root.loadRootNode(e),this.buildMetrics(!1)},onColumnAction({action:e,column:t,columnIndex:s}){this.applyAllocation({nodeMetricToClear:t.id})},async removeMetricPill(e){this.autoAllocation.state==="preview"&&(this.autoAllocation.dirty=!0);const t=this.rows.find(n=>n.id===e.id),s={data:t.data[0],row:t};await this.onCheckChange({cell:s}),this.selectedRows.length===0&&(this.showSidePanel=!1)},updateRows(){const e=this.selectedRows;if(!this.$store.rootNode)return this.rows=[];this.rows=[],this.$store.scopeNodes.forEach(t=>{const s=e.find(r=>r.id===t.id)?"all":"none",n={label:t.name,title:t.name,id:t.id,parentId:t.parentId,metricIndex:null,subperiodExpanded:!0,class:t.id===this.$store.rootNode.id?["is-root"]:this.period!=="Year"?["spm-subperiod-expanded"]:[],data:[{id:"Name",format:"Name",type:"custom",isRoot:t.id===this.$store.rootNode.id,selected:s,node:t},...this.columns.slice(1).map(r=>{switch(r.columnType){case Cs.HIERARCHY:return{...r,format:"Hierarchy",type:"custom",node:t};case Cs.ASSIGNMENT:return{...r,id:r.object.id,format:"Assignment",state:"loading",object:r.object,isRoot:t.id===this.$store.rootNode.id,value:t.id===this.$store.rootNode.id?r.object.assignmentCount:0};case Cs.METRIC:return{id:"",format:"Metric",type:"custom",nodeMetric:t.metrics.find(d=>d.sfsp__SalesMetric__c===r.metric.Id),state:"loaded"};case Cs.REFERENCE:return{...r,id:r.assignmentObject.id,state:"loading",format:"Reference",value:0};case Cs.HIERARCHY_REFERENCE:let o=null;if(t.name==="All Org"&&"All Org"in r.refField)o=r.refField["All Org"];else{const d=t.referenceData.find(p=>p.hasOwnProperty(r.name));o=d?d[r.name]:null}return r.refField.type==="Numeric"&&o&&(o=Number(o)),{...r,id:r.name,state:"loaded",format:"HierarchyReference",type:"custom",value:o}}})]};if(this.rows.push(n),!(this.$store.scope>t.level)){if(this.period!=="Year"){const r=SPM.FiscalPeriod[this.period],a=SPM.FiscalLabels[this.period];for(let o=0;o<r.length;o++){const d=this.period==="Month"?r[o]:o+1,p=a?a[d]:`${this.period} ${d}`,y=["spm-subperiod-row"];y.push(o%2===0?"spm-subperiod-row-even":"spm-subperiod-row-odd"),this.rows.push({label:p,title:p,id:t.id+this.period+o,metricIndex:o,parentId:t.id,class:y,isSubperiodRow:!0,data:[p,...this.columns.slice(1).map(v=>{switch(v.columnType){case Cs.HIERARCHY:return{...v,format:"Hierarchy",type:"custom",node:t};case Cs.ASSIGNMENT:return{type:"custom",format:"Empty",value:"-"};case Cs.METRIC:return{id:"",format:"Metric",type:"custom",nodeMetric:t.metrics.find(I=>I.sfsp__SalesMetric__c===v.metric.Id)};case Cs.REFERENCE:return{type:"custom",format:"Empty",value:"-"};case Cs.HIERARCHY_REFERENCE:return{type:"custom",format:"Empty",value:"-"}}})]})}}this.buildMetrics(!1)}});try{this.rows.filter(s=>!s.isSubperiodRow).length-1===this.selectedRows.length?this.rows[0].data[0].selected="all":SPM.Components.Allocation.selectedRows.length===0?this.rows[0].data[0].selected="none":this.rows[0].data[0].selected="some"}catch{}this.updateAssignmentCells()},async updateAssignmentCells({assignmentObjectIds:e=this.$store.assignmentObjects.map(t=>t.id)}={}){const t=this.rows.reduce((n,r)=>{const a=r.parentId||"All Org";return n[a]=n[a]||{},r.data.forEach(o=>{["Assignment","Reference"].includes(o.format)&&e.includes(o.id)&&(n[a][o.id]=n[a][o.id]||{},n[a][o.id][r.id]=n[a][o.id][r.id]||[],n[a][o.id][r.id].push(o))}),n},{});await SPM.Utils.Async.forEach(Object.values(t),async n=>{await SPM.Utils.Async.forEachParallel(Object.entries(n),async([r,a])=>{const o=Object.keys(a),d=o[o.length-1],p=Object.values(a[d]).filter(v=>v.format==="Reference").map(v=>v.field),y=await SPM.Utils.Node.getAssignmentValues({nodeId:d,assignmentObjectId:r,referenceFields:p});o.forEach(v=>{a[v].forEach(I=>{var O,A;if(I.format==="Assignment"){const P=((O=y[v])==null?void 0:O.count)||0;I.value=P,I.state="loaded"}else if(I.format==="Reference"){const P=((A=y[v])==null?void 0:A[I.field.name])||0;this.$store.showPreview?I.previewValue=P:(I.value=P,delete I.previewValue),I.dirty=this.$store.showPreview&&I.previewValue!==I.value,I.state="loaded"}})})},5)});const s=this.columns.filter(n=>n.assignmentObject).map(n=>n.id);e=e.filter(n=>s.includes(n)),this.$store.assignmentObjects.filter(n=>e.includes(n.id)).forEach(n=>{n.assignmentCount=this.rows.slice(1).reduce((o,d)=>{const p=d.data.reduce((y,v)=>{const C=v.format==="Assignment"&&v.id===n.id?typeof v.previewValue<"u"?v.previewValue:v.value:0;return y+C},0);return o+p},0);const r=this.rows[0].data.find(o=>o.format==="Assignment"&&o.id===n.id);n.totalCount=typeof r.previewValue<"u"?r.previewValue:r.value,this.$store.showPreview?(typeof n.oldProgress>"u"&&(n.oldProgress=n.progress),n.dirty=n.oldProgress!==n.progress):(delete n.oldProgress,delete n.dirty);let a=Math.floor(100*n.assignmentCount/n.totalCount);a===0&&n.assignmentCount>0&&(a=1),n.progress=a})},async updateNodeMetric({nodeMetric:e}){const t=await SPM.Utils.Apex.invoke(e.Id?"UpdateSObjects":"InsertSObjects",[[e],!0]);e.Id||(e.Id=t[0].Id),this.buildMetrics()},toggleSubperiodRows({cell:e}){const{row:t}=e;t.subperiodExpanded=!t.subperiodExpanded,t.subperiodExpanded?t.class=["spm-subperiod-expanded"]:t.class=[],this.rows.filter(s=>s.parentId===t.id).forEach(s=>s.hidden=!t.subperiodExpanded)},async onCheckChange({cell:e}){await SPM.Utils.Async.wait(1);const t=this.rows.filter(n=>!n.isSubperiodRow);if(e.data.isRoot){const n=s(t)==="none"?"all":"none";t.forEach(r=>{r.data[0].selected=n,r.selected=n==="all"});return}e.data.selected=e.data.selected==="all"?"none":"all",t[0].data[0].selected=s(t),e.row.selected=e.data.selected==="all",t[0].selected=t[0].data[0].selected==="all";function s(n){let r=!1,a=!1;return n.some(o=>{const d=o.data[0];if(!d.isRoot&&(d.selected==="all"?r=!0:a=!0,r&&a))return!0}),r?a?"some":"all":"none"}this.selectedRows.length===0&&(this.showSidePanel=!1)},createAllocationValueMap({amountToAllocate:e}){const t={},s=this.autoAllocation.distributionPercents;let n=e,r;for(let o=0;o<s.length;o++){const d=s[o],{months:p}=d;for(let y=0;y<p.length;y++){const v=p[y],{percent:C,id:I}=v,O=Math.floor(e*C/100);n-=O,t[I]=O,r=v}}const a=Math.floor(e*r.percent/100);return t[12]=a+n,t},async previewAutoAllocation(){this.autoAllocation.dirty=!1,this.autoAllocation.loadingMsg="Calculating Preview...";const e=this.rows.filter(n=>!n.data[0].isRoot&&n.data[0].selected==="all");let t=e.length;const s=new Set;if(this.autoAllocation.selectedMethod==="even"||this.autoAllocation.selectedMethod==="fixed"){const n=this.autoAllocation.selectedMethod==="fixed"?this.autoAllocation.amount:Math.floor(this.autoAllocation.amount/e.length),r=this.createAllocationValueMap({amountToAllocate:n});if(await SPM.Utils.Async.forEachBulk(e,a=>{const o=a.data.find(d=>d.format==="Metric"&&d.nodeMetric.sfsp__SalesMetric__c===this.autoAllocation.metricId);SPM.Utils.NodeMetric.changeTarget({nodeMetric:o.nodeMetric,period:"Year",isPreview:!0,customPercentages:r}),s.add(a.parentId)},10),this.autoAllocation.selectedMethod==="even"){const a=n+(this.autoAllocation.amount-n*e.length),o=this.createAllocationValueMap({amountToAllocate:a}),d=e.slice(-1)[0].data.find(p=>p.format==="Metric"&&p.nodeMetric.sfsp__SalesMetric__c===this.autoAllocation.metricId);SPM.Utils.NodeMetric.changeTarget({nodeMetric:d.nodeMetric,period:"Year",isPreview:!0,customPercentages:o})}}else{const n=this.columns.findIndex(y=>y.id===this.autoAllocation.distributionField),r=this.columns[n],{columnType:a}=r,o={all:0,rows:{}};e.forEach((y,v)=>{const{data:C}=y,I=C[n];if(a===Cs.METRIC){const{nodeMetric:O}=I;let A=0;for(let P=1;P<13;P++)o.all+=O[`sfsp__Target_Month${P}__c`],A+=O[`sfsp__Target_Month${P}__c`];o.rows[v]=A}else(a===Cs.ASSIGNMENT||a===Cs.REFERENCE||a===Cs.HIERARCHY_REFERENCE)&&(o.all+=I.value,o.rows[v]=I.value)});let d=this.autoAllocation.amount,p=0;await SPM.Utils.Async.forEachBulk(e,y=>{let v=o.all===0?0:Math.floor(o.rows[p]/o.all*this.autoAllocation.amount);d-=v,p++,p===e.length&&(v+=o.all===0?0:d);{const C=this.createAllocationValueMap({amountToAllocate:v}),I=y.data.find(O=>O.format==="Metric"&&O.nodeMetric.sfsp__SalesMetric__c===this.autoAllocation.metricId);SPM.Utils.NodeMetric.changeTarget({nodeMetric:I.nodeMetric,period:"Year",isPreview:!0,customPercentages:C}),s.add(y.parentId)}},10)}await async function n(r,a,o,d){const p=new Set;await SPM.Utils.Async.forEachBulk([...r],y=>{if(y===o)return;const v=d[y],C=v.metrics.find(I=>I.sfsp__SalesMetric__c===a);Array(12).fill().forEach((I,O)=>{C[`previewValue${O+1}`]=v.children.reduce((A,P)=>{const q=P.metrics.find(ce=>ce.sfsp__SalesMetric__c===a);return A+SPM.Utils.NodeMetric.getTarget({nodeMetric:q,period:"Month",index:O+1})},0)}),p.add(v.parentId)},100),t+=r.size,p.size&&await n(p,a,o,d)}(s,this.autoAllocation.metricId,this.$store.rootNode.id,this.$store.nodeMap),await this.previewMetricHeader(),this.autoAllocation.state="preview",this.autoAllocation.nodeCount=t,this.autoAllocation.scope=this.$store.scope,this.autoAllocation.loadingMsg=""},async previewMetricHeader(){let e=this.$store.rootNode.level;this.autoAllocation.scope=this.$store.scope;let t=this.$store.rootNode.children||[],s=0;for(;e++<=this.autoAllocation.scope;){const a=[];await SPM.Utils.Async.forEachBulk(t,o=>{const d=o.metrics.find(p=>p.sfsp__SalesMetric__c===this.autoAllocation.metricId);Array(12).fill().forEach((p,y)=>{s+=typeof d[`previewValue${y+1}`]<"u"?Number(d[`previewValue${y+1}`]):Number(d[`sfsp__Target_Month${y+1}__c`])})},1e3),t=a}const n=this.metrics.find(a=>a.id===this.autoAllocation.metricId);n.isPreview=!0,n.preview={rollup:s,remaining:n.target-s,progress:Math.floor(100*s/n.target)},n.isLoading=!1;const r=this.rows[0].data.find(a=>a.format==="Metric"&&a.nodeMetric.sfsp__SalesMetric__c===this.autoAllocation.metricId);SPM.Utils.NodeMetric.changeTarget({nodeMetric:r.nodeMetric,period:"Year",target:s,isPreview:!0})},clearPreviewMetricHeader(){const t=this.$store.rootNode.metrics.find(n=>n.sfsp__SalesMetric__c===this.autoAllocation.metricId),s=this.metrics.find(n=>n.id===this.autoAllocation.metricId);s&&(s.isPreview=!1),t&&Array(12).fill().forEach((n,r)=>{t[`previewValue${r+1}`]=void 0})},fillAllocationAmount(e){const t=this.metrics.find(s=>s.id===this.autoAllocation.metricId);this.autoAllocation.amount=(e==="target"?t==null?void 0:t.target:t==null?void 0:t.remaining)||0},async applyAllocation(){this.loadingMsg="Applying Changes...0%";const e=[];let t=this.$store.rootNode.level,s=this.$store.rootNode.children||[];for(;t++<=this.autoAllocation.scope;){const r=[];await SPM.Utils.Async.forEachBulk(s,a=>{const o=a.metrics.find(p=>p.sfsp__SalesMetric__c===this.autoAllocation.metricId);let d=!1;Array(12).fill().forEach((p,y)=>{typeof o[`previewValue${y+1}`]<"u"&&(o[`sfsp__Target_Month${y+1}__c`]=o[`previewValue${y+1}`],o[`previewValue${y+1}`]=void 0,d=!0)}),d&&(e.push(o),r.push(...this.$store.nodeMap[a.id].children||[]))},1e3),s=r}await SPM.Utils.CRM.upsert({records:e,onProgress:r=>this.loadingMsg=`Applying Changes...${r}%`});const n=this.metrics.find(r=>r.id===this.autoAllocation.metricId);this.$store.toast({message:`${n.name} successfully allocated to ${e.length} nodes`}),this.cancelAutoAllocation({clearAll:!0}),this.buildMetrics(),this.loadingMsg=""},async clearRowAllocationValues({cell:e}){const{row:t}=e;this.loadingMsg="Applying Changes...0%",this.autoAllocation.scope=this.$store.scope;const s=[];let n=this.$store.rootNode.children||[],r=this.$store.rootNode.level;for(;r++<=this.autoAllocation.scope;){const a=[],o=n.find(p=>p.id===t.id);t.data.filter(p=>p.format==="Metric").forEach(p=>{const y=this.clearMetricValue(p.nodeMetric,o);y&&s.push(y)}),n=a}s.length&&await SPM.Utils.CRM.upsert({records:s,onProgress:a=>this.loadingMsg=`Applying Changes...${a}%`}),this.buildMetrics(),this.loadingMsg=""},async clearMetricColumn({column:e}){this.autoAllocation.scope=this.$store.scope;const t=e.id,s=this.metrics.find(o=>o.id===t);s.isLoading=!0;let n=this.$store.rootNode.level,r=this.$store.rootNode.children||[];const a=[];for(;n++<=this.autoAllocation.scope;){const o=[];await SPM.Utils.Async.forEachBulk(r,d=>{const p=d.metrics.find(v=>v.sfsp__SalesMetric__c===t),y=this.clearMetricValue(p,d);y&&a.push(y),o.push(...this.$store.nodeMap[d.id].children||[])},1e3),r=o}a.length&&await SPM.Utils.CRM.upsert({records:a}),this.buildMetrics()},clearMetricValue(e,t){let s=!1;return Array(12).fill().forEach((n,r)=>{e[`sfsp__Target_Month${r+1}__c`]!==0&&(e[`sfsp__Target_Month${r+1}__c`]=0,s=!0)}),s?e:null},cancelAutoAllocation({clearAll:e=!0}){this.autoAllocation.dirty=!1;let t=this.$store.rootNode.level,s=this.$store.rootNode.children||[];for(;t++<=this.autoAllocation.scope;){const n=[];s.forEach(r=>{const a=r.metrics.find(o=>o.sfsp__SalesMetric__c===this.autoAllocation.metricId);a&&Array(12).fill().forEach((o,d)=>{a[`previewValue${d+1}`]=void 0}),n.push(...this.$store.nodeMap[r.id].children||[])}),s=n}this.clearPreviewMetricHeader(),e===!0&&(this.autoAllocation.state="configuration",this.autoAllocation.scope=null,this.autoAllocation.amount=0,this.autoAllocation.nodeCount=0,this.autoAllocation.selectedMethod="even",this.autoAllocation.distributionField="",this.showSidePanel=!1,this.setSelectedColumnMetric())},onListViewChange(e){this.columns=[{id:"Name",name:"Name",type:"custom",format:"Name"},...e.map(t=>{var s;if(t.columnType===Cs.HIERARCHY)return{...t,format:"Hierarchy",type:"custom"};if(t.columnType===Cs.ASSIGNMENT){const n=this.$store.assignmentObjects.find(r=>r.id===t.id);if((s=n==null?void 0:n.recordsDataset)!=null&&s.dimensions)return{...t,id:n.id,name:n.label,icon:n.icon,format:"Assignment",type:"custom",object:n,summaryValue:0}}if(t.columnType===Cs.METRIC)return{...t,format:"Metric",type:"custom",selected:this.autoAllocation.metricId===t.id&&this.autoAllocation.state==="preview"};if(t.columnType===Cs.REFERENCE)return{...t,name:t.field.label,format:"Reference",type:"custom",summaryValue:0};if(t.columnType===Cs.HIERARCHY_REFERENCE)return{...t,id:t.name,format:"HierarchyReference",type:"custom"}}).filter(t=>!!t)],this.updateRows()},editAutoAllocationPeriods(){SPM.Components.Root.openModal("editperioddistributions",{distribution:this.autoAllocation.distributionPercents,callback:e=>{this.autoAllocation.dirty=!0,this.autoAllocation.distributionPercents.forEach((t,s)=>{const n=e[s];t.percent=n.previewPercent;const{months:r}=t;r.forEach(a=>{const o=n.months.find(d=>d.id===a.id);a.percent=o.previewPercent})})}})},getBoundaryValue({cell:e,nodeId:t,boundaryObjectId:s}){const n=SPM.Utils.Node.getBoundaries({node:this.$store.nodeMap[t],boundaryObject:this.$store.boundaryObjects.find(r=>r.id===s)}).length;e.state="loaded",e.value=n},async addNodes({levels:e}){const t=this.contextNode.id;this.contextRow.children=[],this.closePopover(),this.loadingMsg="Adding Nodes...",await async function s(n,r,a){const o=e[r];if(!o||a.length===0)return;const d=[];a.forEach(p=>{const y=n.$store.nodeMap[p],v=o.name||o.placeholder,C=(y.children||[]).length;for(let I=1;I<=o.count;I++)d.push({sobjectType:"sfsp__SalesNode__c",Name:`${v} ${C+I}`,sfsp__SalesPlan__c:n.$store.plan.Id,sfsp__Parent__c:p!=="All Org"?p:""})}),await SPM.Utils.CRM.upsert({records:d}),d.forEach(p=>{const y=p.sfsp__Parent__c||"All Org",v=n.$store.nodeMap[y],C={id:p.Id,name:p.Name,color:SPM.Utils.Node.randomColor(),ownerId:"",ownerName:"",level:v.level+1,parentId:y,childCount:0,children:[],metrics:n.$store.plan.sfsp__SalesMetrics__r.map(I=>({...SPM.Utils.NodeMetric.Defaults,sfsp__SalesPlan__c:n.$store.plan.Id,sfsp__SalesMetric__c:I.Id,sfsp__SalesNode__c:p.Id})),users:[],rules:[],ruleLogics:{},previewRuleLogics:{},assignments:[],boundaries:[],referenceData:[]};n.$store.nodeMap[C.id]=C,v.children.push(C)}),a.forEach(p=>{const y=n.$store.nodeMap[p];y.childCount=y.children.length,y.children.forEach(v=>{v.siblingIds=y.children.filter(C=>C.id!==v.id).map(C=>C.id),v.olderSiblingIds=y.children.slice(0,y.children.indexOf(v)).map(C=>C.id)})}),n.$store.branch.descendantIds.push(...d.map(p=>p.Id)),await s(n,r+1,d.map(p=>p.Id))}(this,0,[t]),await this.$nextTick(),this.$store.toast({message:"Nodes Added"}),this.contextRow={},this.contextNode={},this.loadingMsg="",this.updateRows(),this.showSidePanel&&this.cancelAutoAllocation({clearAll:!0})},editTargetOverride(e){SPM.Components.Root.openModal("overrideTarget",{metric:e,callback:({updatedMetric:t})=>{const s=this.$store.rootNode.metrics.find(n=>n.sfsp__SalesMetric__c===t.id);s.sfsp__TargetOverrideAmount__c=t.targetOverrideAmount,s.sfsp__TargetOverrideType__c=t.targetOverrideType,this.updateNodeMetric({nodeMetric:s})}})},async editNode({id:e,name:t,parentId:s}){this.loadingMsg="Saving Node...",this.closePopover(),await SPM.Utils.Apex.invoke("UpdateSObjects",[[{Id:e,Name:t,sfsp__Parent__c:s!=="All Org"?s:""}],!0]),this.$store.nodeMap[e].name=t,this.contextRow.name=t,this.contextRow.data[0].node=this.$store.nodeMap[e],await this.$nextTick(),this.$store.toast({message:"Node Saved"}),this.contextRow={},this.contextNode={},this.loadingMsg=""},async deleteNode({cell:e}){this.closePopover(),await this.$nextTick(),this.contextRow=e.row,this.contextNode=e.data.node,SPM.Components.Root.openModal("confirm",{title:`Delete ${this.contextNode.name}`,description:"Deleting this node also deletes its assignments, allocations, and descendants.",confirmButton:{label:"Delete",type:"brand"},cancelButton:{label:"Cancel",type:"neutral"},callback:async()=>{var r,a,o;this.loadingMsg="Deleting Nodes...";const t=await SPM.Utils.Apex.invoke("Query",[`SELECT Id, sfsp__SalesPlan__c, sfsp__SalesNode__r.Name, sfsp__AccessLevel__c FROM sfsp__SalesUserAccess__c WHERE sfsp__SalesPlan__c = '${this.$store.plan.Id}'`])||[],s=[(r=e==null?void 0:e.data)==null?void 0:r.node.id,...await SPM.Utils.Node.getDescendantIds({planId:this.$store.plan.Id,nodeIds:[(a=e==null?void 0:e.data)==null?void 0:a.node.id]})],n=t.filter(d=>s.includes(d.sfsp__SalesNode__c));await SPM.Utils.CRM.delete({records:n.map(d=>({Id:d.Id}))}),await this.$store.deleteNode({nodeId:(o=e==null?void 0:e.data)==null?void 0:o.node.id}),this.updateRows(),this.$store.toast({message:"Node Deleted"}),this.contextRow={},this.contextNode={},this.loadingMsg=""}})},async openAddNodesPopup({bindTo:e,cell:t}){this.closePopover(),await this.$nextTick(),this.contextRow=t.row,this.contextNode=t.data.node,this.targetBindTo=e,this.showAddNodesPopup=!0},async openEditNodePopup({cell:e,bindTo:t}){this.closePopover(),await this.$nextTick(),this.contextRow=e.row,this.contextNode=e.data.node,this.targetBindTo=t,this.showEditNodePopup=!0},getPercentageChange(e,t){return SPM.Utils.Allocation.getPercentageChange(e,t)},getMetricValue(e,t){return e.isPreview?e.preview[t]:e[t]||0},getMetricProgressValue(e){return this.$store.rootNode.childCount===0?100:this.loadMetricData?this.getMetricValue(e,"progress"):0},closePopover(){this.showAddNodesPopup=!1,this.targetBindTo=null,this.showEditNodePopup=!1},validateChange(){this.autoAllocation.metricId!==this.autoAllocation.temporaryMetricId&&(this.autoAllocation.state==="preview"?(this.cancelAutoAllocation({clearAll:!1}),this.autoAllocation.dirty=!0,this.autoAllocation.metricId=this.autoAllocation.temporaryMetricId):this.autoAllocation.metricId=this.autoAllocation.temporaryMetricId)},handleRowAction(e){switch(e.action){case"OPEN_ADD_NODES":this.openAddNodesPopup({cell:e.cell,bindTo:e.bindTo});break;case"OPEN_EDIT_NODE":this.openEditNodePopup({cell:e.cell,bindTo:e.bindTo});break;case"SHARE_NODE":if(!this.$store.hasSalesPlanningTemplateApp)return;SPM.Components.Root.openShareModal(e.node);break;case"CLEAR_ROW_ALLOCATION":this.clearRowAllocationValues({cell:e.cell});break;case"DELETE_NODE":this.deleteNode({cell:e.cell});break;case"CHANGE_SELECTION":this.onCheckChange({cell:e.cell});break;case"TOGGLE_SUBPERIOD_ROWS":this.toggleSubperiodRows({cell:e.cell});break}},handleColumnAction(e){switch(e.action){case"CLEAR_ALLOCATION_VALUES":this.clearMetricColumn({column:e.column});break}},onNodeMetricFocus(e){const t=this.$refs.allocationTable.$el.querySelector("tr.is-root").children[e],s=this.$refs.metricCardContainer.querySelectorAll(".metric-card")[e-1];t.classList.add("spm-table_summary-row-color"),s.classList.add("spm-table_summary-row-color")},onNodeMetricBlur(e){const t=this.$refs.allocationTable.$el.querySelector("tr.is-root").children[e],s=this.$refs.metricCardContainer.querySelectorAll(".metric-card")[e-1];t.classList.remove("spm-table_summary-row-color"),s.classList.remove("spm-table_summary-row-color")},onCardMouseEnter(e){const t=this.$refs.metricCardContainer.querySelectorAll(".metric-card")[e],s=this.$refs.allocationTable.$el.querySelectorAll(`tbody tr > :nth-child(${e+2})`);t.classList.add("spm-table_summary-row-color"),s.forEach(n=>n.classList.add("spm-table_summary-row-color"))},onCardMouseLeave(e){const t=this.$refs.metricCardContainer.querySelectorAll(".metric-card")[e],s=this.$refs.allocationTable.$el.querySelectorAll(`tbody tr > :nth-child(${e+2})`);t.classList.remove("spm-table_summary-row-color"),s.forEach(n=>n.classList.remove("spm-table_summary-row-color"))}}},Qp=e=>(Nr("data-v-d6953321"),e=e(),Dr(),e),nY={class:"slds-grid",style:{position:"relative",overflow:"hidden"}},rY={ref:"metricCardContainer",class:"slds-grid slds-p-bottom_medium"},iY=["onMouseenter","onMouseleave"],oY={class:"slds-text-body_regular"},aY={class:"slds-text-heading_medium"},lY={key:0,class:"slds-p-left_large slds-text-body_regular"},cY={class:"slds-grid"},uY={class:"slds-text-body_small slds-text-color_weak"},dY={style:{"margin-left":"1.5rem","padding-left":"1.5rem","border-left":".1rem solid #c0c0c0"}},hY=Qp(()=>k("div",{class:"slds-text-body_small slds-text-color_weak"},"Remaining",-1)),pY={class:"slds-grid slds-grid_vertical-align-center",style:{position:"absolute",top:".75rem",right:".75rem"}},fY={id:"Allocation-Table",class:"spm-box slds-grid slds-grid_vertical slds-grow"},mY={class:"slds-grow slds-grid slds-grid_vertical",style:{"border-radius":"var(--slds-c-card-radius-border,var(--sds-c-card-radius-border,.25rem))"}},_Y={class:"slds-text-title"},gY=Qp(()=>k("span",{class:"slds-m-right_x-small"},"Hierarchy Level",-1)),yY=Qp(()=>k("span",{class:"slds-m-right_small"},"Time Period",-1)),vY={key:0,class:"slds-grid slds-grid_vertical-align-center"},bY={key:0,class:"slds-grid slds-grid_vertical-align-center slds-p-vertical_xx-small slds-p-horizontal_x-small"},xY={key:0},wY={key:1},SY={key:1,class:"slds-grid slds-grid_vertical-align-center slds-p-vertical_xx-small slds-p-horizontal_x-small"},CY={key:0},IY={key:1},TY={key:2},AY={id:"allocation-side-panel",class:"slds-panel slds-size_medium slds-panel_docked slds-panel_docked-right slds-panel_drawer slds-is-open","aria-hidden":"false"},MY={class:"slds-panel__header"},EY=Qp(()=>k("h2",{class:"slds-panel__header-title slds-text-heading_small slds-truncate",title:"Allocation"},"Allocation",-1)),kY={class:"slds-panel__header-actions"},PY={class:"slds-grid slds-grid_vertical",style:{height:"calc(100% - 95px)",overflow:"auto"}},RY={class:"slds-panel__body slds-grid slds-grid_vertical slds-grow slds-border_bottom slds-grow-none"},$Y={key:0,class:"slds-p-top_small"},OY={key:1,class:"slds-p-top_small"},LY={class:"slds-panel__body slds-grid slds-grid_vertical slds-grow"},NY={id:"allocation-target",class:"slds-p-top_xx-small"},DY={class:"slds-form-element slds-m-top_small"},BY=Qp(()=>k("legend",{class:"slds-form-element__label slds-text-body_regular"},"Distribution Method",-1)),FY={class:"slds-form-element__control box-group"},zY=["id","value"],UY=["for"],VY=Qp(()=>k("span",{class:"slds-radio_faux"},null,-1)),jY={class:"slds-form-element__label"},qY=Qp(()=>k("br",null,null,-1)),HY={class:"slds-text-color_weak slds-text-body_small"},GY={key:0},WY={class:"slds-p-top_small"},YY=Qp(()=>k("div",null,"Time Period Distribution",-1)),ZY={class:"box-group"},XY={key:0,class:"slds-box_x-small slds-border_bottom slds-grid slds-grid_align-center"},KY={class:"slds-col_bump-right slds-m-top_xx-small"},JY={class:"slds-badge"},QY={class:"slds-col_bump-right slds-m-top_xx-small"},eZ={class:"slds-badge"},tZ={class:"slds-box_xx-small slds-grid slds-grid_align-center",style:{"border-radius":"0 0 0.25rem 0.25rem"}},sZ={class:"slds-docked-form-footer",style:{position:"absolute",bottom:"0px"}},nZ={class:"slds-col_bump-top slds-grid",style:{"max-height":"3rem"}};function rZ(e,t,s,n,r,a){const o=pe("Spinner"),d=pe("NumberAnimator"),p=pe("ProgressBar"),y=pe("Badge"),v=pe("ButtonIcon"),C=pe("ActionMenuItem"),I=pe("ActionMenu"),O=pe("Tooltip"),A=pe("Picklist"),P=pe("Button"),q=pe("ListViewManager"),ce=pe("ColumnCell"),re=pe("NodeMetricHeader"),W=pe("NodeMetric"),Ce=pe("RowCell"),te=pe("DataTable"),oe=pe("AddNodes"),ve=pe("EditNode"),ee=pe("PillList"),ne=pe("TextInput");return L(),X("div",nY,[r.loadingMsg?(L(),Ge(o,{key:0},{description:je(()=>[es(Pe(r.loadingMsg),1)]),_:1})):$e("",!0),k("div",{id:"allocation-main-panel",class:$t(["slds-grid slds-grid_vertical slds-grow slds-p-around_small slds-col",{"side-panel-in":r.showSidePanel}])},[k("div",null,[k("div",rY,[(L(!0),X(Lt,null,As(r.metrics,(Se,Ue)=>(L(),X("article",{key:Se.id,class:"slds-card metric-card",style:br({background:Se.isPreview?"#FAFFBD":""}),onMouseenter:Qe=>a.onCardMouseEnter(Ue),onMouseleave:Qe=>a.onCardMouseLeave(Ue)},[Se.id===r.autoAllocation.metricId&&r.showSidePanel?(L(),X("div",{key:0,style:br([{position:"absolute",top:"0",left:"0",height:".3rem",width:"100%"},{background:a.getMetricValue(Se,"progress")>=100?"#2E844A":"#1589EE"}])},null,4)):$e("",!0),k("div",oY,Pe(Se.name),1),k("div",aY,[k("strong",null,[de(d,{formatType:Se.type,value:r.loadMetricData?a.getMetricValue(Se,"rollup"):0},null,8,["formatType","value"])]),Se.isPreview?(L(),X("span",lY,Pe(a.getPercentageChange(Se.rollup,Se.preview.rollup)),1)):$e("",!0)]),de(p,{class:"slds-m-vertical_small",description:`Allocation Progress bar for ${Se.name}`,value:a.getMetricProgressValue(Se),thickness:"large",radius:""},null,8,["description","value"]),k("div",cY,[k("div",null,[k("div",uY,Pe(Se.targetOverrideEnabled&&Se.targetOverrideAmount?"Overridden Target":"Target"),1),k("div",null,[k("strong",null,Pe(e.$F(Se.type,Se.target)),1)])]),k("div",dY,[hY,k("div",null,[k("strong",null,Pe(e.$F(Se.type,a.getMetricValue(Se,"remaining"))),1)])])]),k("div",pY,[Se.progress>=100&&!Se.isPreview?(L(),Ge(y,{key:0,theme:"success",content:"Done"})):$e("",!0),Se.targetOverrideEnabled&&(e.$store.isAdmin||e.$store.isManager)?(L(),Ge(I,{key:1,class:"slds-p-left_xxx-small node-menu-button slds-button_last",isActionMenu:"false"},{button:je(()=>[de(v,{iconCategory:"utility",iconName:"threedots_vertical",size:"small"})]),default:je(()=>[de(C,{label:"Override Target",onClick:Qe=>a.editTargetOverride(Se)},null,8,["onClick"])]),_:2},1024)):$e("",!0)])],44,iY))),128))],512)]),k("div",fY,[k("div",mY,[de(te,{ref:"allocationTable",columns:r.columns,rows:r.rows,bordered:"",columnsBordered:"",fullHeader:"",virtual:"",style:{"border-radius":"var(--slds-c-card-radius-border,var(--sds-c-card-radius-border,.25rem))"}},{"header-content-full":je(()=>[de(q,{ref:"listViewManager",defaultViewColumnTypes:[r.ColumnTypes.METRIC,r.ColumnTypes.ASSIGNMENT],title:"Allocations",onChange:a.onListViewChange},{subtext:je(()=>[k("div",_Y,Pe(e.$L("Allocation.Table.ItemDetails",{count:r.rows.length-1,minutes:"?"})),1)]),"controls-left":je(()=>[gY,de(O,{class:"slds-m-right_small",text:"Level that you're allocating to"}),de(A,{id:"hierarchy-level",modelValue:e.$store.scope,"onUpdate:modelValue":t[0]||(t[0]=Se=>e.$store.scope=Se),class:"slds-m-right_large",disabled:r.showSidePanel,options:e.$store.scopes},null,8,["modelValue","disabled","options"]),yY,de(A,{id:"time-period",modelValue:r.period,"onUpdate:modelValue":t[1]||(t[1]=Se=>r.period=Se),class:"slds-m-right_x-small",options:r.periods},null,8,["modelValue","options"])]),"controls-right":je(()=>[e.$store.isEditor?(L(),Ge(P,{key:0,id:`allocate-button-${a.selectedRows.length>0}`,variant:"brand",class:"slds-m-left_x-small",label:"Allocate",disabled:a.selectedRows.length===0,onClick:t[2]||(t[2]=Se=>r.showSidePanel=!0)},null,8,["id","disabled"])):$e("",!0)]),_:1},8,["defaultViewColumnTypes","onChange"])]),header:je(Se=>[de(ce,{column:Se.column,onChangeRootNode:a.loadRootNode,onHandleColumnAction:a.handleColumnAction},null,8,["column","onChangeRootNode","onHandleColumnAction"])]),cell:je(Se=>{var Ue,Qe;return[Se.data.format==="Hierarchy"?(L(),X("div",vY,[Se.column.id==="Owner"?(L(),X("div",bY,[Se.data.node.ownerId?(L(),X("span",xY,Pe(Se.data.node.ownerName),1)):(L(),X("span",wY,"-"))])):$e("",!0),Se.column.id==="Assigned Users"?(L(),X("div",SY,[Se.data.node.users.length===0?(L(),X("span",CY,"-")):Se.data.node.users.length===1?(L(),X("span",IY,Pe(Se.data.node.users[0].sfsp__User__r.Name),1)):(L(),X("span",TY,Pe(Se.data.node.users.length)+" users",1))])):$e("",!0)])):Se.data.format==="Metric"?(L(),X(Lt,{key:1},[Se.row.data[0].isRoot?(L(),Ge(re,{key:0,period:r.period,data:Se.data.nodeMetric,metric:a.getRootNodeMetric(Se),class:"slds-p-around_x-small",onMounted:a.onNodeMetricHeaderLoad},null,8,["period","data","metric","onMounted"])):(L(),Ge(W,{key:1,ref:`nodeMetric-${Se.row.id}`,cell:Se,metric:a.getRootNodeMetric(Se),label:`${a.getRootNodeMetric(Se).name} for ${(Qe=(Ue=Se.row.data[0])==null?void 0:Ue.node)==null?void 0:Qe.name}`,period:r.period,class:"slds-p-around_x-small",onUpdateNodeMetric:a.updateNodeMetric,onNodeMetricFocus:a.onNodeMetricFocus,onNodeMetricBlur:a.onNodeMetricBlur},null,8,["cell","metric","label","period","onUpdateNodeMetric","onNodeMetricFocus","onNodeMetricBlur"]))],64)):(L(),Ge(Ce,{key:2,period:r.period,cell:Se,onHandleRowAction:a.handleRowAction,onChangeRootNode:a.loadRootNode},null,8,["period","cell","onHandleRowAction","onChangeRootNode"]))]}),_:1},8,["columns","rows"])]),r.showAddNodesPopup?(L(),Ge(oe,{key:0,contextNode:r.contextNode,targetBindTo:r.targetBindTo,singleLevel:!0,onClose:a.closePopover,onSave:a.addNodes},null,8,["contextNode","targetBindTo","onClose","onSave"])):r.showEditNodePopup?(L(),Ge(ve,{key:1,contextNode:r.contextNode,targetBindTo:r.targetBindTo,allowReparent:!1,onClose:a.closePopover,onSave:a.editNode},null,8,["contextNode","targetBindTo","onClose","onSave"])):$e("",!0)])],2),de(Pp,{name:"slide"},{default:je(()=>[Mn(k("div",AY,[r.autoAllocation.loadingMsg?(L(),Ge(o,{key:0},{description:je(()=>[es(Pe(r.autoAllocation.loadingMsg),1)]),_:1})):$e("",!0),k("div",MY,[EY,k("div",kY,[de(v,{iconCategory:"utility",iconName:"close",title:"Collapse Panel Header",assistiveText:"Collapse Panel Header",onClick:a.cancelAutoAllocation},null,8,["onClick"])])]),k("div",PY,[k("div",RY,[de(A,{modelValue:r.autoAllocation.temporaryMetricId,"onUpdate:modelValue":t[3]||(t[3]=Se=>r.autoAllocation.temporaryMetricId=Se),name:"allocation-metric",options:r.metrics,titleKey:"name",labels:{name:"Metric"},onSelectedOption:a.validateChange},null,8,["modelValue","options","onSelectedOption"]),r.autoAllocation.state==="configuration"?(L(),X("div",$Y,"Nodes ("+Pe(a.selectedRows.length)+")",1)):(L(),X("div",OY,Pe(r.autoAllocation.nodeCount)+" nodes will be updated",1)),de(ee,{containerBorder:"",options:a.selectedRows,onRemove:a.removeMetricPill},null,8,["options","onRemove"])]),k("div",LY,[de(ne,{id:"allocation-amount",modelValue:r.autoAllocation.amount,"onUpdate:modelValue":t[4]||(t[4]=Se=>r.autoAllocation.amount=Se),modelModifiers:{number:!0},labels:{name:"Amount",placeholder:"Enter Number"},onInput:t[5]||(t[5]=Se=>r.autoAllocation.dirty=r.autoAllocation.state==="preview")},null,8,["modelValue"]),k("div",NY,[k("span",{class:"slds-text-link",onClick:t[6]||(t[6]=Se=>a.fillAllocationAmount("target"))},"Target"),es(" | "),k("span",{id:"allocation-remaining",class:"slds-text-link",onClick:t[7]||(t[7]=Se=>a.fillAllocationAmount("remaining"))},"Remaining")]),k("fieldset",DY,[BY,k("div",FY,[(L(!0),X(Lt,null,As(r.autoAllocation.methods,Se=>(L(),X("span",{key:Se.id,class:"slds-radio slds-border_bottom",style:br(Se.style)},[Mn(k("input",{id:Se.id,"onUpdate:modelValue":t[8]||(t[8]=Ue=>r.autoAllocation.selectedMethod=Ue),type:"radio",name:"allocationMethod",value:Se.id,onInput:t[9]||(t[9]=Ue=>r.autoAllocation.dirty=r.autoAllocation.state==="preview")},null,40,zY),[[Ng,r.autoAllocation.selectedMethod]]),k("label",{class:"slds-radio__label",for:Se.id},[VY,k("span",jY,Pe(Se.label),1),qY,k("span",HY,Pe(Se.desc),1)],8,UY)],4))),128))])]),r.autoAllocation.selectedMethod==="field"?(L(),X("div",GY,[de(A,{modelValue:r.autoAllocation.distributionField,"onUpdate:modelValue":t[10]||(t[10]=Se=>r.autoAllocation.distributionField=Se),class:"slds-p-top_x-small",options:a.allocationFields,titleKey:"name",labels:{name:"Field"},onSelectedOption:t[11]||(t[11]=Se=>r.autoAllocation.dirty=r.autoAllocation.state==="preview")},null,8,["modelValue","options"])])):$e("",!0),k("div",WY,[YY,k("div",ZY,[(L(!0),X(Lt,null,As(r.autoAllocation.distributionPercents,(Se,Ue)=>(L(),X("div",{key:`dist_${Ue}`},[r.period==="Quarter"||r.period==="Year"?(L(),X("div",XY,[k("div",KY,Pe(Se.label),1),k("span",JY,Pe(Se.percent)+"%",1)])):(L(!0),X(Lt,{key:1},As(Se.months,Qe=>(L(),X("div",{key:Qe.id,class:"slds-box_x-small slds-grid slds-grid_align-center slds-border_bottom"},[k("div",QY,Pe(Qe.label),1),k("span",eZ,Pe(Qe.percent)+"%",1)]))),128))]))),128)),k("div",tZ,[de(P,{id:"update-time-period-button",variant:"base",class:"slds-grow slds-col",label:"Update",onClick:a.editAutoAllocationPeriods},null,8,["onClick"])])])])])]),k("div",sZ,[k("div",nZ,[de(P,{id:"allocation-cancel",class:"slds-grow",label:"Cancel",onClick:a.cancelAutoAllocation},null,8,["onClick"]),r.autoAllocation.state==="configuration"?(L(),Ge(P,{key:0,id:"allocation-preview",disabled:a.autoAllocationDisabled,class:"slds-grow",variant:"brand",label:"Preview",onClick:a.previewAutoAllocation},null,8,["disabled","onClick"])):$e("",!0),r.autoAllocation.state==="preview"&&r.autoAllocation.dirty?(L(),Ge(P,{key:1,id:"allocation-update-preview",disabled:a.autoAllocationDisabled,class:"slds-grow",variant:"brand",label:"Update Preview",onClick:a.updateAllocation},null,8,["disabled","onClick"])):$e("",!0),r.autoAllocation.state==="preview"&&!r.autoAllocation.dirty?(L(),Ge(P,{key:2,id:"allocation-apply",disabled:a.autoAllocationDisabled,class:"slds-grow",variant:"brand",label:"Apply",onClick:a.applyAllocation},null,8,["disabled","onClick"])):$e("",!0)])])],512),[[Ai,r.showSidePanel]])]),_:1})])}const iZ=os(sY,[["render",rZ],["__scopeId","data-v-d6953321"]]),oZ={name:"ColumnCell",components:{ActionMenu:wa,ActionMenuItem:Sa,ButtonIcon:vn,Icon:yn,SLDSButton:Tn},props:["column","colIndex","currentListView"],emits:["handle-column-action","change-root-node","set-last-opened-column"],computed:{accessibleNodeIds(){return[this.$store.branch.id,...this.$store.branch.descendantIds]}},methods:{setLastOpenedColumn(e){e.stopImmediatePropagation(),this.$emit("set-last-opened-column",this.colIndex)},closeActionMenu(){this.$refs.hasOwnProperty("actionMenu")&&(this.$refs.actionMenu.doShow=!1)}}},aZ={key:0,class:"slds-grid slds-grid_vertical-align-center"},lZ=k("span",{class:"slds-p-horizontal_x-small"},">",-1),cZ=["id"],uZ={class:"slds-grid slds-grid_vertical-align-center"},dZ={class:"slds-text-color_default"},hZ=k("span",{class:"slds-text-color_default"},"Sum",-1),pZ=k("span",{class:"slds-text-color_default"},"Average",-1),fZ=k("span",{class:"slds-text-color_default"},"Max",-1),mZ=k("span",{class:"slds-text-color_default"},"Min",-1),_Z=k("span",{class:"slds-text-color_default"},"Median",-1),gZ=k("span",{class:"slds-text-color_default"},"% of Focus",-1),yZ={key:1,class:"slds-has-divider_top-space",role:"separator"},vZ=k("span",{class:"slds-text-color_default"},"Move Left",-1),bZ=k("span",{class:"slds-text-color_default"},"Move Right",-1),xZ=k("li",{class:"slds-has-divider_top-space",role:"separator"},null,-1),wZ=k("span",{class:"slds-text-color_default"},"Remove Column",-1);function SZ(e,t,s,n,r,a){const o=pe("Icon"),d=pe("ButtonIcon"),p=pe("SLDSButton"),y=pe("ActionMenuItem"),v=pe("ActionMenu");return s.column.format==="Name"?(L(),X("div",aZ,[e.$store.rootNode.id!=="All Org"&&a.accessibleNodeIds.includes(e.$store.rootNode.parentId||"All Org")?(L(),X(Lt,{key:0},[k("span",{class:"slds-text-title_normal slds-text-link",style:{color:"#0250D9"},onClick:t[0]||(t[0]=C=>e.$emit("change-root-node",{nodeId:e.$store.rootNode.parentId}))},Pe(e.$store.nodeMap[e.$store.rootNode.parentId].name),1),lZ],64)):$e("",!0),k("span",null,Pe(e.$store.rootNode.name),1)])):(L(),X("div",{key:1,id:`${s.column.name.replaceAll(" ","_")}`,class:"slds-grid slds-grid_align-spread slds-grid_vertical-align-center",style:br([{width:"100%"},{cursor:s.column.selectable?"pointer":"initial"}])},[k("div",uZ,[["Assignment","Boundary"].includes(s.column.format)?(L(),Ge(o,Ji({key:0},{size:"x-small",...s.column.icon},{class:"slds-m-right_x-small"}),null,16)):$e("",!0),k("span",null,Pe(s.column.name),1)]),e.$store.isEditor||s.currentListView==="default"?(L(),Ge(v,{key:0,ref:"actionMenu",onClick:a.setLastOpenedColumn},{button:je(()=>[de(d,{name:"column-actions",iconCategory:"utility",iconName:"down",variant:"border-filled",size:"x-small",assistiveText:`${s.column.name} Actions`,title:`${s.column.name} Actions`},null,8,["assistiveText","title"])]),default:je(()=>[["Hierarchy","None"].includes(s.column.format)?$e("",!0):(L(),Ge(y,{key:0,label:""},{default:je(()=>{var C;return[de(v,{alignment:"right",disabled:s.column.format==="HierarchyReference"&&((C=s.column.refField)==null?void 0:C.type)==="Text",onClick:t[7]||(t[7]=I=>I.stopImmediatePropagation())},{button:je(()=>[de(p,{style:{border:"none","margin-top":"-4px"},variant:"base",iconCategory:"utility",iconName:"right",iconPosition:"right",iconVariant:"default"},{default:je(()=>[k("span",dZ,[de(o,{category:"utility",name:"summarydetail",class:"slds-current-color",iconClass:["slds-button__icon","slds-button__icon_left"],size:"x-small",assistiveText:"Show Summary Details"}),es(" Summarize ")])]),_:1})]),default:je(()=>[de(y,{label:"",onClick:t[1]||(t[1]=I=>e.$emit("handle-column-action",{action:"CHANGE_SUMMARY",summaryFormat:"Sum",column:s.column}))},{default:je(()=>[hZ]),_:1}),de(y,{label:"",onClick:t[2]||(t[2]=I=>e.$emit("handle-column-action",{action:"CHANGE_SUMMARY",summaryFormat:"Average",column:s.column}))},{default:je(()=>[pZ]),_:1}),de(y,{label:"",onClick:t[3]||(t[3]=I=>e.$emit("handle-column-action",{action:"CHANGE_SUMMARY",summaryFormat:"Max",column:s.column}))},{default:je(()=>[fZ]),_:1}),de(y,{label:"",onClick:t[4]||(t[4]=I=>e.$emit("handle-column-action",{action:"CHANGE_SUMMARY",summaryFormat:"Min",column:s.column}))},{default:je(()=>[mZ]),_:1}),de(y,{label:"",onClick:t[5]||(t[5]=I=>e.$emit("handle-column-action",{action:"CHANGE_SUMMARY",summaryFormat:"Median",column:s.column}))},{default:je(()=>[_Z]),_:1}),de(y,{label:"",onClick:t[6]||(t[6]=I=>e.$emit("handle-column-action",{action:"CHANGE_SUMMARY",summaryFormat:"PercentOfFocus",column:s.column}))},{default:je(()=>[gZ]),_:1})]),_:1},8,["disabled"])]}),_:1})),["Hierarchy","None"].includes(s.column.format)?$e("",!0):(L(),X("li",yZ)),de(y,{iconCategory:"utility",iconName:"back",label:"",onClick:t[8]||(t[8]=C=>e.$emit("handle-column-action",{action:"MOVE_LEFT",column:s.column}))},{default:je(()=>[vZ]),_:1}),de(y,{iconCategory:"utility",iconName:"forward",label:"",onClick:t[9]||(t[9]=C=>e.$emit("handle-column-action",{action:"MOVE_RIGHT",column:s.column}))},{default:je(()=>[bZ]),_:1}),xZ,de(y,{iconCategory:"utility",iconName:"close",label:"",onClick:t[10]||(t[10]=C=>e.$emit("handle-column-action",{action:"REMOVE_COLUMN",column:s.column}))},{default:je(()=>[wZ]),_:1})]),_:1},8,["onClick"])):$e("",!0)],12,cZ))}const NR=os(oZ,[["render",SZ]]),CZ={name:"RowCell",components:{ActionMenu:wa,ActionMenuItem:Sa,ButtonIcon:vn,Icon:yn,ProgressBar:lI,SLDSButton:Tn,Tooltip:Fo,Spinner:Vr},props:["cell","viewMode"],emits:["handle-row-action","change-root-node"],computed:{showPreview(){return this.cell.data.isRoot&&this.cell.data.object?typeof this.cell.column.previewValue<"u"&&this.cell.column.previewValue!==this.cell.column.summaryValue:typeof this.cell.data.previewValue<"u"&&this.cell.data.value!==this.cell.data.previewValue},summaryFormat(){return this.cell.column.summaryFormat},dataType(){return this.cell.data.format==="Metric"&&this.cell.data.metric.sfsp__Type__c==="Currency"?"Currency":"Numeric"},formattedValue(){let e="";if(this.summaryFormat==="PercentOfFocus"){const s=this.cell.column.columnTotal/this.$store.scopeChildNodes.length;e=100*(this.cell.data.value/s),e=Number.isFinite(e)?`${this.$F(this.dataType,e)}%`:"0%"}return this.cell.data.format==="HierarchyReference"&&(this.cell.data.value===null||this.cell.data.refField.type==="Text")?{value:this.cell.data.value,percentValue:e}:{value:this.$F(this.dataType,this.cell.data.value),percentValue:e}},formattedPreview(){let e="";if(this.summaryFormat==="PercentOfFocus"){const s=this.cell.column.previewTotal/this.$store.scopeChildNodes.length;e=100*(this.cell.data.previewValue/s),e=Number.isFinite(e)?`${this.$F(this.dataType,e)}%`:"0%"}return this.cell.data.format==="HierarchyReference"&&(this.cell.data.value===null||this.cell.data.refField.type==="Text")?{value:this.cell.data.value,percentValue:e}:{value:this.$F(this.dataType,this.cell.data.previewValue),percentValue:e}},ruleLinkText(){return this.cell.data.node.rules.length>0?`${this.cell.data.node.rules.length} Rules`:this.$store.isEditor?"Add Rules":""},getBoundaryLocationTooltip(){var e;return((e=this.cell.data)==null?void 0:e.node.boundaries.map(t=>t.sfsp__SalesBoundary__c?t.sfsp__SalesBoundary__r.Name:t.sfsp__IncludePoints__c?`${t.Name} (with point ZIPs)`:t.Name).join("\\n"))||"No boundaries found"}}},IZ={key:0,class:"slds-grid slds-grid_vertical-align-center"},TZ={class:"slds-color-picker__swatch"},AZ={class:"slds-col slds-grid slds-grid_vertical-align-center slds-p-around_x-small"},MZ=["name"],EZ=["name"],kZ=["name"],PZ={class:"slds-text-title"},RZ=["name"],$Z={class:"slds-grid slds-grid_vertical-align-center slds-p-around_x-small slds-col_bump-left"},OZ={key:0,class:"slds-grid slds-grid_vertical-align-center"},LZ={class:"slds-col_bump-left"},NZ={class:"slds-col slds-button-group slds-grid_vertical-align-center",role:"group"},DZ=k("span",{id:"view-node-assigned-records",class:"slds-text-color_default"},"View Assigned Records",-1),BZ={id:"manage-node-rules",class:"slds-text-color_default"},FZ=k("span",{class:"slds-text-color_default"},"Manage Boundaries",-1),zZ=k("li",{class:"slds-has-divider_top-space",role:"separator"},null,-1),UZ=k("span",{id:"remove-node-assignments",class:"slds-text-color_destructive"},"Remove Assignments",-1),VZ=k("span",{id:"delete-node",class:"slds-text-color_destructive"},"Delete Node",-1),jZ={key:1,class:"slds-grid slds-grid_vertical-align-center"},qZ=["name"],HZ={key:0},GZ={key:1},WZ=["name"],YZ={key:0},ZZ={key:1},XZ={key:2},KZ={key:2,class:"slds-grid slds-grid_vertical slds-grid_align-start slds-grid_vertical-align-center"},JZ={class:"slds-text-body-normal"},QZ={key:2,class:"slds-grid slds-grid_align-end slds-grid_vertical-align-center slds-p-vertical_xx-small slds-p-horizontal_x-small",style:{width:"100%"}},eX=["name"],tX=["name"],sX=["name"],nX=["name"],rX=["name"],iX=["name"],oX={key:1,class:"slds-grid slds-grid_align-end slds-grid_vertical-align-center slds-p-vertical_xx-small slds-p-horizontal_x-small",style:{width:"100%"}},aX={class:"slds-p-horizontal_xx-small slds-text-color_weak"},lX={class:"slds-p-horizontal_xx-small"},cX={class:"slds-text-color_weak"},uX={class:"slds-text-color_weak"};function dX(e,t,s,n,r,a){var A,P;const o=pe("SLDSButton"),d=pe("ButtonIcon"),p=pe("Tooltip"),y=pe("ActionMenuItem"),v=pe("ActionMenu"),C=pe("Spinner"),I=pe("ProgressBar"),O=pe("Icon");return s.cell.data.format==="Name"?(L(),X("div",IZ,[k("div",{class:$t(["slds-form-element",{"slds-m-left_medium":!s.cell.data.isRoot}])},[k("div",TZ,[k("span",{class:"slds-swatch",style:br({"background-color":s.cell.data.node.color})},null,4)])],2),k("div",AZ,[k("div",{name:`${s.cell.data.node.name.replaceAll(" ","-").toLowerCase()}-node-name`,class:$t(["slds-text-title_normal slds-m-right_small",{"slds-text-link":!s.cell.data.isRoot}]),style:br({color:s.cell.data.isRoot?"initial":"#0250D9"}),onClick:t[0]||(t[0]=q=>e.$emit("change-root-node",{nodeId:s.cell.data.node.id}))},Pe(s.cell.data.node.name),15,MZ),s.cell.data.node.childCount===1?(L(),X("div",{key:0,name:`${s.cell.data.node.name.replaceAll(" ","-").toLowerCase()}-node-child-count`,class:"slds-text-title"},Pe(s.cell.data.node.childCount)+" child node \u2022",9,EZ)):(L(),X("div",{key:1,name:`${s.cell.data.node.name.replaceAll(" ","-").toLowerCase()}-node-child-count`,class:"slds-text-title"},Pe(s.cell.data.node.childCount)+" child nodes \u2022",9,kZ)),k("div",PZ,[!s.cell.data.isRoot&&s.viewMode!=="Map"?(L(),X(Lt,{key:0},[de(o,{name:`${s.cell.data.node.name.replaceAll(" ","-").toLowerCase()}-manage-rules`,variant:"base",label:a.ruleLinkText,onClick:t[1]||(t[1]=q=>e.$emit("handle-row-action",{action:"SHOW_RULES",nodeId:s.cell.data.node.id}))},null,8,["name","label"]),es(" "+Pe(a.ruleLinkText.length>0?"\u2022 ":""),1)],64)):$e("",!0),k("span",{name:`${s.cell.data.node.name.replaceAll(" ","-").toLowerCase()}-node-level-count`,class:"slds-p-left_xxx-small"},"Level "+Pe(s.cell.data.node.level),9,RZ)])]),k("div",$Z,[((A=s.cell.data)==null?void 0:A.node.boundaries.length)>0?(L(),X("div",OZ,[de(p,{text:a.getBoundaryLocationTooltip,alignment:"top"},{source:je(()=>[de(d,{id:`${s.cell.data.node.name}.boundary-icon`,iconCategory:"utility",iconName:"location",variant:"bare",size:"small",assistiveText:`${s.cell.data.node.name} Boundaries`,title:`${s.cell.data.node.name} Boundaries`},null,8,["id","assistiveText","title"])]),_:1},8,["text"])])):$e("",!0)]),k("div",LZ,[k("div",NZ,[s.cell.data.isRoot&&e.$store.isEditor?(L(),Ge(d,{key:0,id:"add-node",iconCategory:"utility",iconName:"add",variant:"border-filled",size:"small",assistiveText:`Add nodes to ${s.cell.data.node.name}`,title:`Add nodes to ${s.cell.data.node.name}`,onClick:t[2]||(t[2]=q=>e.$emit("handle-row-action",{action:"OPEN_ADD_NODES",node:s.cell.data.node,bindTo:q.target}))},null,8,["assistiveText","title"])):$e("",!0),e.$store.isEditor?(L(),Ge(d,{key:1,name:`edit-node-${s.cell.data.node.name.replaceAll(" ","-").toLowerCase()}`,iconCategory:"utility",iconName:"edit",variant:"border-filled",size:"small",assistiveText:`Edit ${s.cell.data.node.name}`,title:`Edit ${s.cell.data.node.name}`,onClick:t[3]||(t[3]=q=>e.$emit("handle-row-action",{action:"OPEN_EDIT_NODE",node:s.cell.data.node}))},null,8,["name","assistiveText","title"])):$e("",!0),de(v,null,{button:je(()=>[de(d,{name:`manage-node-actions-${s.cell.data.node.name.replaceAll(" ","-").toLowerCase()}`,iconCategory:"utility",iconName:"down",variant:"border-filled",size:"small",style:{"border-radius":"0 .25rem .25rem 0","margin-left":"-1px"},assistiveText:`${s.cell.data.node.name} Overflow Actions`,title:`${s.cell.data.node.name} Overflow Actions`},null,8,["name","assistiveText","title"])]),default:je(()=>[de(y,{label:"",onClick:t[4]||(t[4]=q=>e.$emit("handle-row-action",{action:"SHOW_ASSIGNED_RECORDS",nodeId:s.cell.data.node.id}))},{default:je(()=>[DZ]),_:1}),!s.cell.row.isRoot&&s.viewMode!=="Map"?(L(),Ge(y,{key:0,label:"",onClick:t[5]||(t[5]=q=>e.$emit("handle-row-action",{action:"SHOW_RULES",nodeId:s.cell.data.node.id}))},{default:je(()=>[k("span",BZ,Pe(`${e.$store.isEditor?"Manage":"View"} Assignment Rules`),1)]),_:1})):$e("",!0),e.$store.isEditor?(L(),X(Lt,{key:1},[e.$store.isEditor&&e.$store.salesBoundaries.length>0?(L(),Ge(y,{key:0,disabled:e.$store.salesBoundaries.length===0,label:"",onClick:t[6]||(t[6]=q=>e.$emit("handle-row-action",{action:"MANAGE_BOUNDARIES",node:s.cell.data.node}))},{default:je(()=>[FZ]),_:1},8,["disabled"])):$e("",!0),de(y,{disabled:!e.$store.hasSalesPlanningTemplateApp,name:`share-${s.cell.data.node.name.replaceAll(" ","-").toLowerCase()}`,onClick:t[7]||(t[7]=q=>e.$emit("handle-row-action",{action:"SHARE_NODE",node:s.cell.data.node}))},{default:je(()=>[k("span",{class:$t({"slds-text-color_default":e.$store.hasSalesPlanningTemplateApp})},"Share",2)]),_:1},8,["disabled","name"]),zZ,de(y,{label:"",onClick:t[8]||(t[8]=q=>e.$emit("handle-row-action",{action:"CLEAR_ASSIGNMENTS",node:s.cell.data.node}))},{default:je(()=>[UZ]),_:1}),(e.$store.isAdmin||e.$store.isManager)&&!s.cell.row.isRoot?(L(),Ge(y,{key:1,label:"",onClick:t[9]||(t[9]=q=>e.$emit("handle-row-action",{action:"DELETE_NODE",node:s.cell.data.node}))},{default:je(()=>[VZ]),_:1})):$e("",!0)],64)):$e("",!0)]),_:1})])])])):s.cell.data.format==="Hierarchy"?(L(),X("div",jZ,[s.cell.column.id==="Owner"?(L(),X("div",{key:0,name:`${s.cell.data.node.name.replaceAll(" ","-").toLowerCase()}-owner-name`,class:"slds-grid slds-grid_vertical-align-center slds-p-vertical_xx-small slds-p-horizontal_x-small"},[s.cell.data.node.ownerId?(L(),X("span",HZ,Pe(s.cell.data.node.ownerName),1)):(L(),X("span",GZ,"-"))],8,qZ)):$e("",!0),s.cell.column.id==="Assigned Users"?(L(),X("div",{key:1,name:`${s.cell.data.node.name.replaceAll(" ","-").toLowerCase()}-assigned-users`,class:"slds-grid slds-grid_vertical-align-center slds-p-vertical_xx-small slds-p-horizontal_x-small"},[s.cell.data.node.users.length===0?(L(),X("span",YZ,"-")):s.cell.data.node.users.length===1?(L(),X("span",ZZ,Pe(s.cell.data.node.users[0].sfsp__User__r.Name),1)):(L(),X("span",XZ,Pe(s.cell.data.node.users.length)+" users",1))],8,WZ)):$e("",!0)])):["Assignment","Boundary"].includes(s.cell.data.format)?(L(),X("div",KZ,[s.cell.data.state==="loading"||((P=s.cell.data.object.recordsDataset)==null?void 0:P.dataflowStatus)?(L(),Ge(C,{key:0,size:"x-small",style:{"z-index":"1"}})):$e("",!0),s.cell.data.isRoot?(L(),X("div",{key:1,style:{width:"100%"},class:$t(["slds-p-vertical_small slds-p-horizontal_x-small",{"slds-is-edited":a.showPreview}])},[k("div",JZ,[k("b",null,Pe(e.$store.rootNode.childCount>0?e.$F("Numeric",s.cell.data.object.assignmentCount):s.cell.data.value),1),es(" of "+Pe(e.$F("Numeric",s.cell.data.value)),1)]),de(I,{class:"slds-m-vertical_small",description:`Assignment Progress bar for ${s.cell.data.name}`,value:e.$store.rootNode.childCount>0?s.cell.data.object.progress:100,radius:""},null,8,["description","value"])],2)):(L(),X("div",QZ,[a.showPreview?(L(),X(Lt,{key:0},[k("span",{name:`${s.cell.data.name.replaceAll(" ","-").toLowerCase()}-${s.cell.data.format.replaceAll(" ","-").toLowerCase()}-value-${s.cell.row.data[0].node.name.replaceAll(" ","-").toLowerCase()}`},Pe(a.formattedValue.value),9,eX),k("span",{name:`${s.cell.data.name.replaceAll(" ","-").toLowerCase()}-${s.cell.data.format.replaceAll(" ","-").toLowerCase()}-percent-value-${s.cell.row.data[0].node.name.replaceAll(" ","-").toLowerCase()}`,class:"slds-p-horizontal_xx-small slds-text-color_weak"},Pe(a.formattedValue.percentValue),9,tX),de(O,{category:"utility",name:"forward",size:"xx-small"}),k("span",{name:`${s.cell.data.name.replaceAll(" ","-").toLowerCase()}-${s.cell.data.format.replaceAll(" ","-").toLowerCase()}-preview-value-${s.cell.row.data[0].node.name.replaceAll(" ","-").toLowerCase()}`,class:"slds-p-horizontal_xx-small"},Pe(a.formattedPreview.value),9,sX),k("span",{name:`${s.cell.data.name.replaceAll(" ","-").toLowerCase()}-${s.cell.data.format.replaceAll(" ","-").toLowerCase()}-percent-value-${s.cell.row.data[0].node.name.replaceAll(" ","-").toLowerCase()}`,class:"slds-text-color_weak"},Pe(a.formattedPreview.percentValue),9,nX)],64)):(L(),X(Lt,{key:1},[k("span",{name:`${s.cell.data.name.replaceAll(" ","-").toLowerCase()}-${s.cell.data.format.replaceAll(" ","-").toLowerCase()}-value-${s.cell.row.data[0].node.name.replaceAll(" ","-").toLowerCase()}`,class:$t({"slds-p-right_x-small":a.formattedValue.percentValue})},Pe(a.formattedValue.value),11,rX),k("span",{name:`${s.cell.data.name.replaceAll(" ","-").toLowerCase()}-${s.cell.data.format.replaceAll(" ","-").toLowerCase()}-value-${s.cell.row.data[0].node.name.replaceAll(" ","-").toLowerCase()}`,class:"slds-text-color_weak"},Pe(a.formattedValue.percentValue),9,iX)],64))]))])):(L(),X("div",{key:3,class:$t(["slds-grid slds-grid_vertical slds-grid_align-start slds-grid_vertical-align-center",{"slds-is-edited":a.showPreview}])},[s.cell.data.state==="loading"?(L(),Ge(C,{key:0,size:"x-small",style:{"z-index":"1"}})):(L(),X("div",oX,[a.showPreview?(L(),X(Lt,{key:0},[k("span",null,Pe(a.formattedValue.value),1),k("span",aX,Pe(a.formattedValue.percentValue),1),de(O,{category:"utility",name:"forward",size:"xx-small"}),k("span",lX,Pe(a.formattedPreview.value),1),k("span",cX,Pe(a.formattedPreview.percentValue),1)],64)):(L(),X(Lt,{key:1},[k("span",{class:$t({"slds-p-right_x-small":a.formattedValue.percentValue})},Pe(a.formattedValue.value),3),k("span",uX,Pe(a.formattedValue.percentValue),1)],64))]))],2))}const hX=os(CZ,[["render",dX]]),pX={name:"SummaryCell",components:{Icon:yn},props:["column"],computed:{showPreview(){return typeof this.$props.column.previewValue<"u"&&this.$props.column.summaryValue!==this.$props.column.previewValue},formattedValue(){let e=this.$F("Numeric",this.$props.column.summaryValue);switch(this.$props.column.summaryFormat==="PercentOfFocus"&&(e=Number.isFinite(e)?`${this.$F("Numeric",e)}%`:"0%"),this.$props.column.summaryFormat){case"Sum":return e;case"Average":return`Avg ${e}`;case"Median":return`Median ${e}`;case"Max":return`Max ${e}`;case"Min":return`Min ${e}`;case"PercentOfFocus":return`% of Focus ${e}`;default:return this.$props.column.summaryValue}},formattedPreviewValue(){let e=this.$F("Numeric",this.$props.column.previewValue);return this.$props.column.summaryFormat==="PercentOfFocus"&&(e=Number.isFinite(e)?`${this.$F("Numeric",e)}%`:"0%"),e}}},fX={key:0},mX=["name"],_X=["name"];function gX(e,t,s,n,r,a){const o=pe("Icon");return L(),X("div",{class:$t(["slds-grid slds-grid_align-end slds-grid_vertical-align-center slds-p-around_x-small slds-text-color_default",{"slds-is-edited":a.showPreview}]),style:{width:"100%"}},[e.$props.column.summaryFormat?(L(),X("span",fX,[a.showPreview?(L(),X(Lt,{key:0},[es(Pe(a.formattedValue)+" ",1),de(o,{category:"utility",name:"forward",size:"xx-small",class:"slds-p-horizontal_xx-small"}),es(" "+Pe(a.formattedPreviewValue),1)],64)):(L(),X("span",{key:1,class:"slds-text-color_default",name:`${e.$props.column.name.replaceAll(" ","-").toLowerCase()}-column-total`},Pe(a.formattedValue),9,mX))])):e.$props.column.summaryValue?(L(),X("span",{key:1,name:`${e.$props.column.name.replaceAll(" ","-").toLowerCase()}-column-total`},[k("b",null,Pe(a.formattedValue),1)],8,_X)):$e("",!0)],2)}const yX=os(pX,[["render",gX]]),vX={name:"AssignmentTable",components:{SLDSButton:Tn,Picklist:Qi,DataTable:Rm,ColumnCell:NR,RowCell:hX,SummaryCell:yX,ListViewManager:RR,Spinner:Vr,Tooltip:Fo,AddNodes:uI},props:["selectedObject"],emits:["select-assignment","show-rules","node-updated"],data(){return{loadingMsg:"",viewMode:this.$store.preferences.AssignmentExplorer.mode,rows:[],columns:[],lastOpenedColumnIndex:null,ColumnTypes:Cs,addNodesPopover:{bindTo:null,node:null}}},watch:{selectedObject:{handler(){this.$store.showPreview&&this.viewMode!=="Map"&&(this.$store.allNodes.forEach(e=>{delete e.previewRules,delete e.previewAssignments}),this.$store.showPreview=!1),this.updateTable()}},"$store.rootNode":{async handler(){var e;(e=this.$refs.listViewManager)==null||e.rebuildListView(),await this.$nextTick(),this.updateTable()}},"$store.scope":{async handler(){this.$store.scope!==this.$store.scopes[0].id&&!this.$store.scopes.find(e=>e.id===this.$store.scope).isExclusive&&(this.$store.scope=this.$store.scopes[0].id,this.$store.toast({message:"Viewing levels that contain a non-exclusive hierarchy is not supported.  Switching back to top level.",state:"warning"})),await this.$store.loadLevel({level:this.$store.scope,onProgress:e=>this.loadingMsg=e}),this.loadingMsg="",this.updateTable()}},viewMode:{async handler(){var e,t;["Grid","Map"].includes(this.viewMode)&&((e=SPM.Components.AssignmentPanel)==null||e.cancelAssignment(),(t=SPM.Components.NodePanel)==null||t.cancelAssignments(),this.$store.filters.splice(0),this.$store.filterLogic="",SPM.Components.Assignment.sidePanel="",this.$store.preferences.AssignmentExplorer.mode=this.viewMode,await this.$store.savePreferences(),this.updateTable())}}},async mounted(){SPM.Components.AssignmentTable=this},methods:{setLastOpenedColumnIndex(e){this.lastOpenedColumnIndex&&this.lastOpenedColumnIndex!==e&&this.$refs[`col-${this.lastOpenedColumnIndex}`].closeActionMenu(),this.lastOpenedColumnIndex=e},async handleColumnAction(e){const t=this.$refs.listViewManager.computedListViews.find(r=>r.id===this.$refs.listViewManager.currentListView),s=t.columns.findIndex(r=>r.columnId===e.column.columnId),n=t.columns[s];switch(e.action){case"CHANGE_SUMMARY":n.summaryFormat=e.summaryFormat||"Sum",t.id!=="default"&&await SPM.Utils.CRM.upsert({records:[{Id:n.columnId,sfsp__SummaryFormat__c:n.summaryFormat}]}),this.$refs[`col-${this.columns.indexOf(e.column)}`].closeActionMenu(),this.updateTable();break;case"MOVE_LEFT":const r=t.columns[s-1];if(r){if(t.columns[s]=r,t.columns[s-1]=n,n.order=s-1,r.order=s,t.id!=="default"){const o=[{Id:n.columnId,sfsp__Order__c:n.order},{Id:r.columnId,sfsp__Order__c:r.order}];await SPM.Utils.CRM.upsert({records:o})}this.$refs[`col-${this.columns.indexOf(e.column)}`].closeActionMenu(),this.updateTable()}break;case"MOVE_RIGHT":const a=t.columns[s+1];if(a){if(t.columns[s]=a,t.columns[s+1]=n,n.order=s+1,a.order=s,t.id!=="default"){const o=[{Id:n.columnId,sfsp__Order__c:n.order},{Id:a.columnId,sfsp__Order__c:a.order}];await SPM.Utils.CRM.upsert({records:o})}this.$refs[`col-${this.columns.indexOf(e.column)}`].closeActionMenu(),this.updateTable()}break;case"REMOVE_COLUMN":if(t.columns.splice(s,1),t.id!=="default"){const o=[{Id:e.column.columnId}];await SPM.Utils.CRM.delete({records:o})}this.$refs[`col-${this.columns.indexOf(e.column)}`].closeActionMenu(),this.updateTable();break}},async handleRowAction(e){switch(e.action){case"OPEN_ADD_NODES":this.openAddNodesPopover({node:e.node,bindTo:e.bindTo});break;case"OPEN_EDIT_NODE":this.editNode({node:e.node});break;case"SHOW_ASSIGNED_RECORDS":this.showAssignedRecords({nodeId:e.nodeId});break;case"SHOW_RULES":this.$emit("show-rules",{nodeId:e.nodeId});break;case"MANAGE_BOUNDARIES":this.addGeoBoundaries({node:e.node});break;case"SHARE_NODE":if(!this.$store.hasSalesPlanningTemplateApp)return;SPM.Components.Root.openShareModal(e.node);break;case"CLEAR_ASSIGNMENTS":this.clearAssignments({node:e.node});break;case"DELETE_NODE":this.deleteNode({node:e.node});break;case"CHANGE_ROOT_NODE":this.loadRootNode({nodeId:e.nodeId});break}},loadRootNode({nodeId:e}){SPM.Components.Root.loadRootNode(e)},addGeoBoundaries({node:e}){SPM.Components.Root.openModal("manageGeoBoundaries",{plan:this.$store.plan,node:e,callback:async(t,s)=>{const n=this.$refs.listViewManager.computedListViews.find(r=>r.id===this.$refs.listViewManager.currentListView);for(const r of t){const a=this.$store.salesBoundaries.find(v=>v.Id===r.sfsp__SalesBoundary__c);Object.assign(r,{sfsp__SalesBoundary__r:a});const o=r.sfsp__SalesNode__c||"All Org",d=this.$store.nodeMap[o].boundaries.find(v=>v.Id===r.Id);if(d?Object.assign(d,r):this.$store.nodeMap[o].boundaries.push(r),this.$store.rootNode.id===o){const v={sobjectType:"sfsp__ListViewColumn__c",sfsp__Column__c:`${r.Id}_${r.sfsp__ContainerSet__c}`,sfsp__ListView__c:n.id,sfsp__Order__c:n.length+1,sfsp__SalesNodeBoundary__c:r.Id,sfsp__Type__c:Cs.BOUNDARY.description,sfsp__SummaryFormat__c:"Sum"};let C=r.Id;const I={boundaryObject:{id:r.Id,name:`${r.sfsp__SalesNode__c||this.$store.plan.Id}_${r.sfsp__ContainerSet__c}`},columnType:Cs.BOUNDARY,columnId:C,summaryFormat:"Sum",id:r.Id,name:`${r.sfsp__SalesNode__c||this.$store.plan.Id}_${r.sfsp__ContainerSet__c}`};if(n.id!=="default")await SPM.Utils.CRM.upsert({records:[v]}),C=v.Id,I.columnId=v.Id,n.columns.push(I);else{const O=n.columns.findIndex(ce=>ce.columnType===Cs.METRIC),A=n.columns.findLastIndex(ce=>ce.columnType===Cs.ASSIGNMENT),P=n.columns.findLastIndex(ce=>ce.columnType===Cs.BOUNDARY),q=O>-1?O:A>-1&&P===-1?A:P;n.columns.splice(q,0,I)}}const p={...JSON.parse(JSON.stringify(SPM.Utils.BoundaryObject.Defaults)),id:r.Id,label:this.$store.containerSets[r.sfsp__ContainerSet__c].label},y=this.$store.preferences.Map.layers.find(v=>v.id===p.id);y?Object.assign(y,{...p,...y}):this.$store.preferences.Map.layers.push(p)}for(const r of s){const a=r.sfsp__SalesNode__c||"All Org";if(this.$store.rootNode.id===a){const p=n.columns.find(v=>v.id===r.Id);n.id!=="default"&&await SPM.Utils.CRM.delete({records:[{Id:p.columnId}]});const y=n.columns.findIndex(v=>v.id===r.Id);y>-1&&n.columns.splice(y,1)}const o=this.$store.nodeMap[a].boundaries.findIndex(p=>p.Id===r.Id);o>-1&&this.$store.nodeMap[a].boundaries.splice(o,1);const d=this.$store.preferences.Map.layers.findIndex(p=>p.id===r.Id);d>-1&&this.$store.preferences.Map.layers.splice(d,1)}this.updateTable(),this.$emit("select-assignment",t.length&&this.$store.rootNode.id===t[0].sfsp__SalesNode__c?this.$store.boundaryObjects.find(r=>r.id===t[0].Id):this.$store.assignmentObjects[0]),t.length&&this.$store.toast({message:"Geo boundaries added"}),s.length&&this.$store.toast({message:"Geo boundaries deleted"})}})},async updateTable(){var t;if(!this.$store.rootNode)return this.rows=[];const e=(t=this.$refs.listViewManager)==null?void 0:t.computedListViews.find(s=>{var n;return s.id===((n=this.$refs.listViewManager)==null?void 0:n.currentListView)});!e||(this.loadingMsg="Loading...",this.columns=[{id:"Name",name:"Name",format:"Name",type:"custom",summaryValue:"Totals"},...e.columns.map(s=>{switch(s.columnType){case Cs.HIERARCHY:return{...s,format:"Hierarchy",type:"custom"};case Cs.ASSIGNMENT:const n=this.$store.assignmentObjects.find(a=>a.id===s.id);return n!=null&&n.recordsDataset.dimensions?{...s,id:n.id,name:n.label,icon:n.icon,format:"Assignment",type:"custom",selected:this.$props.selectedObject.id===n.id&&this.viewMode==="Grid",selectable:!0,object:n,summaryValue:0,listeners:{click:()=>{this.columns.forEach(a=>{a.id!==n.id&&(a.selected=!1)}),this.$emit("select-assignment",n)}}}:null;case Cs.BOUNDARY:const r=this.$store.boundaryObjects.find(a=>a.id===s.id);return r?{...s,id:r.id,name:r.label,icon:r.icon,format:"Boundary",type:"custom",selected:this.$props.selectedObject.id===r.id&&this.viewMode==="Grid",selectable:!0,object:r,summaryValue:0,listeners:{click:()=>{this.columns.forEach(a=>{a.id!==r.id&&(a.selected=!1)}),this.$emit("select-assignment",r)}}}:null;case Cs.METRIC:return{...s,format:"Metric",type:"custom",summaryValue:0};case Cs.REFERENCE:return{...s,name:s.field.label,format:"Reference",type:"custom",summaryValue:0};case Cs.HIERARCHY_REFERENCE:return{...s,id:s.name,format:"HierarchyReference",type:"custom",summaryValue:0}}}).filter(s=>!!s)],this.rows=this.$store.scopeNodes.map(s=>({id:s.id,parentId:s.parentId,isRoot:s.id===this.$store.rootNode.id,data:[{id:"Name",format:"Name",type:"custom",selected:"none",isRoot:s.id===this.$store.rootNode.id,node:s},...this.columns.slice(1).map(n=>{switch(n.columnType){case Cs.HIERARCHY:return{...n,format:"Hierarchy",type:"custom",node:s};case Cs.ASSIGNMENT:return{...n,id:n.object.id,format:"Assignment",type:"custom",state:"loading",object:n.object,isRoot:s.id===this.$store.rootNode.id,value:s.id===this.$store.rootNode.id?n.object.assignmentCount:0};case Cs.BOUNDARY:return{...n,id:n.object.id,format:"Boundary",type:"custom",state:"loading",object:n.object,isRoot:s.id===this.$store.rootNode.id,value:s.id===this.$store.rootNode.id?n.object.assignmentCount:0};case Cs.METRIC:const r=s.metrics.find(p=>p.sfsp__SalesMetric__c===n.metric.Id),o=[...Object.keys(r)].filter(p=>p.startsWith("sfsp__Target_Month")).reduce((p,y)=>p+r[y],0);return{...n,id:n.metric.Id,format:"Metric",state:"loading",type:"custom",value:o};case Cs.REFERENCE:return{...n,id:n.assignmentObject.id,state:"loading",format:"Reference",type:"custom",value:0};case Cs.HIERARCHY_REFERENCE:let d=null;if(s.name==="All Org"&&"All Org"in n.refField)d=n.refField["All Org"];else{const p=s.referenceData.find(y=>y.hasOwnProperty(n.name));d=p?p[n.name]:null}return n.refField.type==="Numeric"&&d&&(d=Number(d)),{...n,id:n.name,state:"loaded",format:"HierarchyReference",type:"custom",value:d}}})]})),this.updateAssignmentCells(),this.updateBoundaryCells(),this.updateMetricCells(),await this.$nextTick(),this.viewMode==="Grid"&&SPM.Components.RecordExplorer&&await SPM.Components.RecordExplorer.reloadTable(),this.viewMode==="Map"&&SPM.Components.AssignmentMap&&SPM.Components.AssignmentMap.checkAssignmentBehavior(!0)&&await SPM.Components.AssignmentMap.reloadData(),this.loadingMsg="")},updateSummaryCells({format:e}){this.columns.forEach((t,s)=>{if(t.format===e){const n=this.rows.filter(d=>!d.isRoot),r=n.map(d=>this.$store.showPreview?typeof d.data[s].previewValue<"u"?d.data[s].previewValue:d.data[s].value:d.data[s].value||0);let a=0;const o=r.reduce((d,p)=>d+p,0);switch(t.summaryFormat){case"Sum":a=o;break;case"PercentOfFocus":const d=r.reduce((y,v)=>y+v,0)/n.length,p=r.reduce((y,v)=>y+(d-v)**2,0)/n.length;a=Math.sqrt(p);break;case"Average":a=n.length>0?r.reduce((y,v)=>y+v,0)/n.length:0;break;case"Median":if(r.length>0){r.sort((v,C)=>v-C);const y=Math.floor(r.length/2);a=r.length%2===1?r[y]:(r[y-1]+r[y])/2}break;case"Max":a=Math.max(...r);break;case"Min":a=Math.min(...r);break}this.$store.showPreview?(t.previewValue=a,t.previewTotal=o):(t.summaryValue=a,t.columnTotal=o,delete t.previewValue,delete t.previewTotal)}})},updateMetricCells(){this.rows.forEach(e=>{e.data.forEach(t=>{t.format==="Metric"&&this.getMetricValue({cell:t,nodeId:e.id,metricId:t.id})})}),this.updateSummaryCells({format:"Metric"})},async updateAssignmentCells({assignmentObjectIds:e=this.$store.assignmentObjects.map(t=>t.id)}={}){var r;const t=this.rows.reduce((a,o)=>{const d=o.parentId||"All Org";return a[d]=a[d]||{},o.data.forEach(p=>{["Assignment","Reference"].includes(p.format)&&e.includes(p.id)&&(a[d][p.id]=a[d][p.id]||{},a[d][p.id][o.id]=a[d][p.id][o.id]||[],a[d][p.id][o.id].push(p))}),a},{});await SPM.Utils.Async.forEach(Object.values(t),async a=>{await SPM.Utils.Async.forEachParallel(Object.entries(a),async([o,d])=>{const p=Object.keys(d),y=p[p.length-1],v=Object.values(d[y]).filter(I=>I.format==="Reference").map(I=>I.field),C=await SPM.Utils.Node.getAssignmentValues({nodeId:y,assignmentObjectId:o,referenceFields:v});p.forEach(I=>{d[I].forEach(A=>{var q,ce;let P=0;A.format==="Assignment"?P=((q=C[I])==null?void 0:q.count)||0:A.format==="Reference"&&(P=((ce=C[I])==null?void 0:ce[A.field.name])||0),this.$store.showPreview?A.previewValue=P:(A.value=P,delete A.previewValue),A.dirty=this.$store.showPreview&&A.previewValue!==A.value,A.state="loaded"})})},5)});const n=((r=this.$refs.listViewManager)==null?void 0:r.computedListViews.find(a=>{var o;return a.id===((o=this.$refs.listViewManager)==null?void 0:o.currentListView)})).columns.filter(a=>a.assignmentObject).map(a=>a.id);e=e.filter(a=>n.includes(a)),this.$store.assignmentObjects.filter(a=>e.includes(a.id)).forEach(a=>{a.assignmentCount=this.rows.slice(1).reduce((p,y)=>{const v=y.data.reduce((C,I)=>{const O=I.format==="Assignment"&&I.id===a.id?typeof I.previewValue<"u"?I.previewValue:I.value:0;return C+O},0);return p+v},0);const o=this.rows[0].data.find(p=>p.format==="Assignment"&&p.id===a.id);a.totalCount=typeof o.previewValue<"u"?o.previewValue:o.value,this.$store.showPreview?(typeof a.oldProgress>"u"&&(a.oldProgress=a.progress),a.dirty=a.oldProgress!==a.progress):(delete a.oldProgress,delete a.dirty);let d=Math.floor(100*a.assignmentCount/a.totalCount);d===0&&a.assignmentCount>0&&(d=1),a.progress=d}),this.updateSummaryCells({format:"Assignment"}),this.updateSummaryCells({format:"Reference"}),this.updateSummaryCells({format:"HierarchyReference"})},updateBoundaryCells({boundaryObjectIds:e=this.$store.boundaryObjects.map(t=>t.id)}={}){var n;this.rows.forEach(r=>{r.data.forEach(a=>{a.format==="Boundary"&&e.includes(a.id)&&this.getBoundaryValue({cell:a,nodeId:r.id,boundaryObjectId:a.id})})});const s=((n=this.$refs.listViewManager)==null?void 0:n.computedListViews.find(r=>{var a;return r.id===((a=this.$refs.listViewManager)==null?void 0:a.currentListView)})).columns.filter(r=>r.boundaryObject).map(r=>r.boundaryObject.id);e=e.filter(r=>s.includes(r)),this.$store.boundaryObjects.filter(r=>e.includes(r.id)).forEach(r=>{r.assignmentCount=this.rows.slice(1).reduce((d,p)=>{const y=p.data.reduce((v,C)=>{const I=C.format==="Boundary"&&C.id===r.id?typeof C.previewValue<"u"?C.previewValue:C.value:0;return v+I},0);return d+y},0);const a=this.rows[0].data.find(d=>d.format==="Boundary"&&d.id===r.id);r.totalCount=typeof a.previewValue<"u"?a.previewValue:a.value,this.$store.showPreview?(typeof r.oldProgress>"u"&&(r.oldProgress=r.progress),r.dirty=r.oldProgress!==r.progress):(delete r.oldProgress,delete r.dirty);let o=Math.floor(100*r.assignmentCount/r.totalCount);o===0&&r.assignmentCount>0&&(o=1),r.progress=o}),this.updateSummaryCells({format:"Boundary"})},getMetricValue({cell:e,nodeId:t,metricId:s}){const r=this.$store.nodeMap[t].metrics.find(d=>d.sfsp__SalesMetric__c===s),o=[...Object.keys(r)].filter(d=>d.startsWith("sfsp__Target_Month")).reduce((d,p)=>d+r[p],0);e.value=o,e.previewValue=o,e.state="loaded"},getBoundaryValue({cell:e,nodeId:t,boundaryObjectId:s}){const n=SPM.Utils.Node.getBoundaries({node:this.$store.nodeMap[t],boundaryObject:this.$store.boundaryObjects.find(r=>r.id===s)}).length;this.$store.showPreview?e.previewValue=n:(e.value=n,delete e.previewValue),e.state="loaded",e.dirty=this.$store.showPreview&&e.previewValue!==e.value},openAddNodesPopover({node:e,bindTo:t}){this.addNodesPopover.bindTo=t,this.addNodesPopover.node=e},async addNodes({levels:e}){this.loadingMsg="Adding Nodes...";const t=this.addNodesPopover.node.id;this.addNodesPopover.node=null,await this.$store.addNodes({parentId:t,levels:e}),this.$store.toast({message:"Nodes Added"}),this.updateTable(),this.loadingMsg=""},editNode({node:e}){SPM.Components.Root.openModal("editNode",{node:e,callback:()=>{this.updateTable(),this.$emit("node-updated",{node:e}),this.$store.toast({message:"Node updated successfully"})}})},showAssignedRecords({nodeId:e}){this.$store.filteredNodeIds=[e],this.$store.filters.splice(0),SPM.Components.RecordExplorer.resetTable({mode:"Record"})},clearAssignments({node:e}){SPM.Components.Root.openModal("confirm",{title:"Remove Assignments",options:[{id:"clearDescendantAssignments",label:"Remove assignments for this node's descendants",selected:!1}],confirmButton:{label:"Remove",type:"brand"},cancelButton:{label:"Close",type:"neutral"},callback:async({options:t})=>{this.loadingMsg="Clearing Assignments...",SPM.Components.Assignment.sidePanel==="NodePanel"&&SPM.Components.NodePanel.cancelAssignments();const s=t.find(d=>d.id==="clearDescendantAssignments").selected?SPM.Utils.Node.getDescendants({nodes:[e]}):[e];await SPM.Utils.CRM.delete({records:s.reduce((d,p)=>d.concat(p.assignments),[])}),await SPM.Utils.CRM.delete({records:s.reduce((d,p)=>d.concat(p.rules),[]).map(d=>({Id:d.Id}))}),await SPM.Utils.CRM.upsert({records:s.map(d=>({sobjectType:"sfsp__SalesNode__c",sfsp__RuleLogics__c:"{}"}))}),s.forEach(d=>d.ruleLogics={});const n=s.reduce((d,p)=>d.concat(p.assignments.splice(0)),[]),r=s.reduce((d,p)=>d.concat(p.rules.splice(0)),[]),a=new Set;a.add(...n.map(d=>d.sfsp__SalesAssignmentObject__c));const o=new Set;r.forEach(d=>{d.sfsp__SalesNodeBoundary__c?(o.add(d.sfsp__SalesNodeBoundary__c),this.$store.assignmentObjects.forEach(p=>a.add(p.id))):a.add(d.sfsp__SalesAssignmentObject__c)}),this.updateAssignmentCells({assignmentObjectIds:[...a]}),this.updateBoundaryCells({boundaryObjectIds:[...o]}),this.updateMetricCells(),SPM.Components.RecordExplorer.reloadTable(),this.$store.toast({message:"Assignments Cleared"}),this.loadingMsg=""}})},deleteNode({node:e}){SPM.Components.Root.openModal("confirm",{title:`Delete ${e.name}`,description:"Deleting this node also deletes its assignments, allocations, and descendants.",confirmButton:{label:"Delete",type:"brand"},cancelButton:{label:"Close",type:"neutral"},callback:async()=>{this.loadingMsg="Deleting Node...";const t=await SPM.Utils.Apex.invoke("Query",[`SELECT Id, sfsp__SalesPlan__c, sfsp__SalesNode__r.Name, sfsp__AccessLevel__c FROM sfsp__SalesUserAccess__c WHERE sfsp__SalesPlan__c = '${this.$store.plan.Id}'`])||[],s=[e.id,...await SPM.Utils.Node.getDescendantIds({planId:this.$store.plan.Id,nodeIds:[e.id]})],n=t.filter(r=>s.includes(r.sfsp__SalesNode__c));await SPM.Utils.CRM.delete({records:n.map(r=>({Id:r.Id}))}),await this.$store.deleteNode({nodeId:e.id}),this.updateTable(),this.$store.toast({message:"Node Deleted"}),this.loadingMsg=""}})}}},bX=e=>(Nr("data-v-cb976495"),e=e(),Dr(),e),xX={class:"spm-box slds-grid slds-grid_vertical"},wX={class:"slds-grid slds-grow slds-grid_vertical",style:{position:"relative"}},SX=bX(()=>k("span",{class:"slds-m-right_x-small"},"Hierarchy Level",-1));function CX(e,t,s,n,r,a){const o=pe("Spinner"),d=pe("Tooltip"),p=pe("Picklist"),y=pe("ListViewManager"),v=pe("ColumnCell"),C=pe("RowCell"),I=pe("SummaryCell"),O=pe("DataTable"),A=pe("AddNodes");return L(),X("div",xX,[k("div",wX,[r.loadingMsg?(L(),Ge(o,{key:0,theme:"brand"},{description:je(()=>[es(Pe(r.loadingMsg==="NONE"?"":r.loadingMsg),1)]),_:1})):$e("",!0),de(O,{columns:r.columns,rows:r.rows,bordered:"",columnsBordered:"",fullHeader:"",summaryFooter:"",virtual:"",style:{"border-radius":"var(--slds-c-card-radius-border,var(--sds-c-card-radius-border,.25rem))"}},{"header-content-full":je(()=>[de(y,{ref:"listViewManager",defaultViewColumnTypes:[r.ColumnTypes.HIERARCHY,r.ColumnTypes.ASSIGNMENT,r.ColumnTypes.BOUNDARY,r.ColumnTypes.METRIC],title:"Assignment",onChange:a.updateTable},{"controls-left":je(()=>[SX,de(d,{class:"slds-m-right_small",text:"Level that you're assigning to"}),de(p,{id:"hierarchy-level",modelValue:e.$store.scope,"onUpdate:modelValue":t[0]||(t[0]=P=>e.$store.scope=P),class:"slds-m-right_small",options:e.$store.scopes},null,8,["modelValue","options"]),de(p,{id:"assignment-view-switcher",modelValue:r.viewMode,"onUpdate:modelValue":t[1]||(t[1]=P=>r.viewMode=P),class:"slds-m-right_small",options:[{id:"Grid",title:"Grid View"},{id:"Map",title:"Map View"}]},null,8,["modelValue"])]),_:1},8,["defaultViewColumnTypes","onChange"])]),header:je(P=>[de(v,{ref:`col-${r.columns.indexOf(P.column)}`,column:P.column,colIndex:r.columns.indexOf(P.column),currentListView:e.$refs.listViewManager.currentListView,onHandleColumnAction:a.handleColumnAction,onChangeRootNode:a.loadRootNode,onSetLastOpenedColumn:a.setLastOpenedColumnIndex},null,8,["column","colIndex","currentListView","onHandleColumnAction","onChangeRootNode","onSetLastOpenedColumn"])]),cell:je(P=>[de(C,{cell:P,viewMode:r.viewMode,onHandleRowAction:a.handleRowAction,onChangeRootNode:a.loadRootNode},null,8,["cell","viewMode","onHandleRowAction","onChangeRootNode"])]),summaryFooter:je(P=>[de(I,{column:P.column},null,8,["column"])]),_:1},8,["columns","rows"])]),r.addNodesPopover.node?(L(),Ge(A,{key:0,contextNode:r.addNodesPopover.node,targetBindTo:r.addNodesPopover.bindTo,singleLevel:!0,onClose:t[2]||(t[2]=P=>r.addNodesPopover.node=null),onSave:a.addNodes},null,8,["contextNode","targetBindTo","onSave"])):$e("",!0)])}const DR=os(vX,[["render",CX],["__scopeId","data-v-cb976495"]]),IX=()=>({name:null}),TX={name:"SLDSSlider",mixins:[Xo],props:{disabled:Boolean,errors:{type:Array,default:()=>[]},label:String,labels:{type:Object,default:()=>{}},hideRangeLabel:Boolean,max:String|Number,min:String|Number,size:{type:String,default:null,validator:e=>{const t=["x-small","small","medium","large"];return e&&!t.includes(e)?(console.error(`Valid size prop values are ${t.join(", ")}`),!1):!0}},step:String|Number,modelValue:Number,vertical:Boolean},data(){return{errorGUID:Vn(),guid:Vn()}},computed:{computedLabels(){return{...IX(),...this.$props.labels}},computedRangeLabel(){return this.$props.min&&this.$props.max?`${this.$props.min} - ${this.$props.max}`:null},computedClasses(){const e=[];return this.$props.size&&e.push(`slds-size_${this.$props.size}`),this.$props.vertical&&e.push("slds-slider_vertical"),e}},methods:{onInput(e){this.$emit("update:modelValue",parseInt(e.target.value))},getGUID:Vn}},AX=["for"],MX={class:"slds-slider-label"},EX={class:"slds-slider-label__label"},kX={key:0,class:"slds-slider-label__range"},PX={class:"slds-form-element__control"},RX=["id","aria-describedby","disabled","max","min","step","value"],$X={class:"slds-slider__value","aria-hidden":"true"},OX=["id"];function LX(e,t,s,n,r,a){var o,d,p;return L(),X("div",{class:$t([{"slds-has-error":(o=e.$props.errors)==null?void 0:o.length},"slds-form-element"])},[k("label",{for:r.guid,class:"slds-form-element__label"},[k("span",MX,[k("span",EX,Pe(e.$props.label),1),s.hideRangeLabel?$e("",!0):(L(),X("span",kX,Pe(a.computedRangeLabel),1))])],8,AX),k("div",PX,[k("div",{class:$t([a.computedClasses,"slds-slider"])},[k("input",Ji({id:r.guid,"aria-describedby":(d=e.$props.errors)!=null&&d.length?r.errorGUID:null,disabled:e.$props.disabled?"":null,max:e.$props.max?e.$props.max:null,min:e.$props.min?e.$props.min:null,step:e.$props.step?e.$props.step:null,value:e.$props.modelValue,type:"range",class:"slds-slider__range"},e.$attrs,{onInput:t[0]||(t[0]=(...y)=>a.onInput&&a.onInput(...y))}),null,16,RX),k("span",$X,Pe(e.$props.modelValue),1)],2),(p=e.$props.errors)!=null&&p.length?(L(),X("div",{key:0,id:r.errorGUID,class:"slds-form-element__help"},[(L(!0),X(Lt,null,As(s.errors,y=>(L(),X("p",{key:a.getGUID()},Pe(e.decodeHtml(y)),1))),128))],8,OX)):$e("",!0)])],2)}const BR=os(TX,[["render",LX]]);var p2={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(e,t){(function(){var s,n="4.17.21",r=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",d="Invalid `variable` option passed into `_.template`",p="__lodash_hash_undefined__",y=500,v="__lodash_placeholder__",C=1,I=2,O=4,A=1,P=2,q=1,ce=2,re=4,W=8,Ce=16,te=32,oe=64,ve=128,ee=256,ne=512,Se=30,Ue="...",Qe=800,Me=16,vt=1,Ut=2,Rt=3,_t=1/0,F=9007199254740991,j=17976931348623157e292,G=0/0,Y=4294967295,J=Y-1,he=Y>>>1,be=[["ary",ve],["bind",q],["bindKey",ce],["curry",W],["curryRight",Ce],["flip",ne],["partial",te],["partialRight",oe],["rearg",ee]],Ne="[object Arguments]",ke="[object Array]",qe="[object AsyncFunction]",ct="[object Boolean]",We="[object Date]",ht="[object DOMException]",rt="[object Error]",fe="[object Function]",ye="[object GeneratorFunction]",Je="[object Map]",at="[object Number]",it="[object Null]",Et="[object Object]",jt="[object Promise]",Nt="[object Proxy]",St="[object RegExp]",Ct="[object Set]",Bt="[object String]",Kt="[object Symbol]",ys="[object Undefined]",ts="[object WeakMap]",Us="[object WeakSet]",ue="[object ArrayBuffer]",B="[object DataView]",U="[object Float32Array]",Re="[object Float64Array]",nt="[object Int8Array]",gt="[object Int16Array]",kt="[object Int32Array]",Ds="[object Uint8Array]",tn="[object Uint8ClampedArray]",nn="[object Uint16Array]",qn="[object Uint32Array]",Kn=/\b__p \+= '';/g,Eh=/\b(__p \+=) '' \+/g,Vc=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ua=/&(?:amp|lt|gt|quot|#39);/g,Va=/[&<>"']/g,Tu=RegExp(Ua.source),yd=RegExp(Va.source),qr=/<%-([\s\S]+?)%>/g,Q=/<%([\s\S]+?)%>/g,ae=/<%=([\s\S]+?)%>/g,me=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ae=/^\w*$/,Fe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,et=/[\\^$.*+?()[\]{}|]/g,st=RegExp(et.source),xe=/^\s+/,Ve=/\s/,pt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ft=/\{\n\/\* \[wrapped with (.+)\] \*/,Ht=/,? & /,Tt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Vt=/[()=,{}\[\]\/\s]/,xs=/\\(\\)?/g,ms=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,At=/\w*$/,fs=/^[-+]0x[0-9a-f]+$/i,ns=/^0b[01]+$/i,is=/^\[object .+?Constructor\]$/,rn=/^0o[0-7]+$/i,hs=/^(?:0|[1-9]\d*)$/,mn=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Fn=/($^)/,hn=/['\n\r\u2028\u2029\\]/g,Sn="\\ud800-\\udfff",bn="\\u0300-\\u036f",eo="\\ufe20-\\ufe2f",zn="\\u20d0-\\u20ff",Br=bn+eo+zn,Hn="\\u2700-\\u27bf",pn="a-z\\xdf-\\xf6\\xf8-\\xff",On="\\xac\\xb1\\xd7\\xf7",po="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",vd="\\u2000-\\u206f",vi=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",to="A-Z\\xc0-\\xd6\\xd8-\\xde",kh="\\ufe0e\\ufe0f",Au=On+po+vd+vi,Pr="['\u2019]",bd="["+Sn+"]",Di="["+Au+"]",Zr="["+Br+"]",zo="\\d+",Sr="["+Hn+"]",Jo="["+pn+"]",Co="[^"+Sn+Au+zo+Hn+pn+to+"]",Ph="\\ud83c[\\udffb-\\udfff]",Qo="(?:"+Zr+"|"+Ph+")",Lm="[^"+Sn+"]",Ta="(?:\\ud83c[\\udde6-\\uddff]){2}",fi="[\\ud800-\\udbff][\\udc00-\\udfff]",fo="["+to+"]",Bi="\\u200d",jl="(?:"+Jo+"|"+Co+")",Hg="(?:"+fo+"|"+Co+")",Nm="(?:"+Pr+"(?:d|ll|m|re|s|t|ve))?",Rh="(?:"+Pr+"(?:D|LL|M|RE|S|T|VE))?",Dm=Qo+"?",nf="["+kh+"]?",Gg="(?:"+Bi+"(?:"+[Lm,Ta,fi].join("|")+")"+nf+Dm+")*",Bm="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Fm="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",jc=nf+Dm+Gg,rf="(?:"+[Sr,Ta,fi].join("|")+")"+jc,xd="(?:"+[Lm+Zr+"?",Zr,Ta,fi,bd].join("|")+")",zm=RegExp(Pr,"g"),$h=RegExp(Zr,"g"),Io=RegExp(Ph+"(?="+Ph+")|"+xd+jc,"g"),ql=RegExp([fo+"?"+Jo+"+"+Nm+"(?="+[Di,fo,"$"].join("|")+")",Hg+"+"+Rh+"(?="+[Di,fo+jl,"$"].join("|")+")",fo+"?"+jl+"+"+Nm,fo+"+"+Rh,Fm,Bm,zo,rf].join("|"),"g"),Hl=RegExp("["+Bi+Sn+Br+kh+"]"),qc=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Gl=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Wl=-1,pr={};pr[U]=pr[Re]=pr[nt]=pr[gt]=pr[kt]=pr[Ds]=pr[tn]=pr[nn]=pr[qn]=!0,pr[Ne]=pr[ke]=pr[ue]=pr[ct]=pr[B]=pr[We]=pr[rt]=pr[fe]=pr[Je]=pr[at]=pr[Et]=pr[St]=pr[Ct]=pr[Bt]=pr[ts]=!1;var Cn={};Cn[Ne]=Cn[ke]=Cn[ue]=Cn[B]=Cn[ct]=Cn[We]=Cn[U]=Cn[Re]=Cn[nt]=Cn[gt]=Cn[kt]=Cn[Je]=Cn[at]=Cn[Et]=Cn[St]=Cn[Ct]=Cn[Bt]=Cn[Kt]=Cn[Ds]=Cn[tn]=Cn[nn]=Cn[qn]=!0,Cn[rt]=Cn[fe]=Cn[ts]=!1;var Xr={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Mu={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Um={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Wg={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Yg=parseFloat,of=parseInt,Oh=typeof Qu=="object"&&Qu&&Qu.Object===Object&&Qu,af=typeof self=="object"&&self&&self.Object===Object&&self,bi=Oh||af||Function("return this")(),Lh=t&&!t.nodeType&&t,Yl=Lh&&!0&&e&&!e.nodeType&&e,Vm=Yl&&Yl.exports===Lh,Hc=Vm&&Oh.process,so=function(){try{var dt=Yl&&Yl.require&&Yl.require("util").types;return dt||Hc&&Hc.binding&&Hc.binding("util")}catch{}}(),lf=so&&so.isArrayBuffer,xi=so&&so.isDate,Nh=so&&so.isMap,hl=so&&so.isRegExp,pl=so&&so.isSet,Zl=so&&so.isTypedArray;function wi(dt,Ot,Mt){switch(Mt.length){case 0:return dt.call(Ot);case 1:return dt.call(Ot,Mt[0]);case 2:return dt.call(Ot,Mt[0],Mt[1]);case 3:return dt.call(Ot,Mt[0],Mt[1],Mt[2])}return dt.apply(Ot,Mt)}function Xl(dt,Ot,Mt,rs){for(var on=-1,En=dt==null?0:dt.length;++on<En;){var Er=dt[on];Ot(rs,Er,Mt(Er),dt)}return rs}function ki(dt,Ot){for(var Mt=-1,rs=dt==null?0:dt.length;++Mt<rs&&Ot(dt[Mt],Mt,dt)!==!1;);return dt}function Gc(dt,Ot){for(var Mt=dt==null?0:dt.length;Mt--&&Ot(dt[Mt],Mt,dt)!==!1;);return dt}function fl(dt,Ot){for(var Mt=-1,rs=dt==null?0:dt.length;++Mt<rs;)if(!Ot(dt[Mt],Mt,dt))return!1;return!0}function ml(dt,Ot){for(var Mt=-1,rs=dt==null?0:dt.length,on=0,En=[];++Mt<rs;){var Er=dt[Mt];Ot(Er,Mt,dt)&&(En[on++]=Er)}return En}function wd(dt,Ot){var Mt=dt==null?0:dt.length;return!!Mt&&Yc(dt,Ot,0)>-1}function Gn(dt,Ot,Mt){for(var rs=-1,on=dt==null?0:dt.length;++rs<on;)if(Mt(Ot,dt[rs]))return!0;return!1}function Fr(dt,Ot){for(var Mt=-1,rs=dt==null?0:dt.length,on=Array(rs);++Mt<rs;)on[Mt]=Ot(dt[Mt],Mt,dt);return on}function Aa(dt,Ot){for(var Mt=-1,rs=Ot.length,on=dt.length;++Mt<rs;)dt[on+Mt]=Ot[Mt];return dt}function Dh(dt,Ot,Mt,rs){var on=-1,En=dt==null?0:dt.length;for(rs&&En&&(Mt=dt[++on]);++on<En;)Mt=Ot(Mt,dt[on],on,dt);return Mt}function jm(dt,Ot,Mt,rs){var on=dt==null?0:dt.length;for(rs&&on&&(Mt=dt[--on]);on--;)Mt=Ot(Mt,dt[on],on,dt);return Mt}function Bh(dt,Ot){for(var Mt=-1,rs=dt==null?0:dt.length;++Mt<rs;)if(Ot(dt[Mt],Mt,dt))return!0;return!1}var qm=_l("length");function Wc(dt){return dt.split("")}function Kl(dt){return dt.match(Tt)||[]}function Jl(dt,Ot,Mt){var rs;return Mt(dt,function(on,En,Er){if(Ot(on,En,Er))return rs=En,!1}),rs}function Sd(dt,Ot,Mt,rs){for(var on=dt.length,En=Mt+(rs?1:-1);rs?En--:++En<on;)if(Ot(dt[En],En,dt))return En;return-1}function Yc(dt,Ot,Mt){return Ot===Ot?ff(dt,Ot,Mt):Sd(dt,Ql,Mt)}function cf(dt,Ot,Mt,rs){for(var on=Mt-1,En=dt.length;++on<En;)if(rs(dt[on],Ot))return on;return-1}function Ql(dt){return dt!==dt}function uf(dt,Ot){var Mt=dt==null?0:dt.length;return Mt?tr(dt,Ot)/Mt:G}function _l(dt){return function(Ot){return Ot==null?s:Ot[dt]}}function gl(dt){return function(Ot){return dt==null?s:dt[Ot]}}function df(dt,Ot,Mt,rs,on){return on(dt,function(En,Er,Es){Mt=rs?(rs=!1,En):Ot(Mt,En,Er,Es)}),Mt}function Cd(dt,Ot){var Mt=dt.length;for(dt.sort(Ot);Mt--;)dt[Mt]=dt[Mt].value;return dt}function tr(dt,Ot){for(var Mt,rs=-1,on=dt.length;++rs<on;){var En=Ot(dt[rs]);En!==s&&(Mt=Mt===s?En:Mt+En)}return Mt}function Eu(dt,Ot){for(var Mt=-1,rs=Array(dt);++Mt<dt;)rs[Mt]=Ot(Mt);return rs}function Zg(dt,Ot){return Fr(Ot,function(Mt){return[Mt,dt[Mt]]})}function Zc(dt){return dt&&dt.slice(0,jh(dt)+1).replace(xe,"")}function To(dt){return function(Ot){return dt(Ot)}}function hf(dt,Ot){return Fr(Ot,function(Mt){return dt[Mt]})}function ku(dt,Ot){return dt.has(Ot)}function Id(dt,Ot){for(var Mt=-1,rs=dt.length;++Mt<rs&&Yc(Ot,dt[Mt],0)>-1;);return Mt}function Xc(dt,Ot){for(var Mt=dt.length;Mt--&&Yc(Ot,dt[Mt],0)>-1;);return Mt}function Td(dt,Ot){for(var Mt=dt.length,rs=0;Mt--;)dt[Mt]===Ot&&++rs;return rs}var Fh=gl(Xr),Ad=gl(Mu);function Pu(dt){return"\\"+Wg[dt]}function Hm(dt,Ot){return dt==null?s:dt[Ot]}function Ma(dt){return Hl.test(dt)}function Ea(dt){return qc.test(dt)}function Gm(dt){for(var Ot,Mt=[];!(Ot=dt.next()).done;)Mt.push(Ot.value);return Mt}function zh(dt){var Ot=-1,Mt=Array(dt.size);return dt.forEach(function(rs,on){Mt[++Ot]=[on,rs]}),Mt}function pf(dt,Ot){return function(Mt){return dt(Ot(Mt))}}function Ao(dt,Ot){for(var Mt=-1,rs=dt.length,on=0,En=[];++Mt<rs;){var Er=dt[Mt];(Er===Ot||Er===v)&&(dt[Mt]=v,En[on++]=Mt)}return En}function ec(dt){var Ot=-1,Mt=Array(dt.size);return dt.forEach(function(rs){Mt[++Ot]=rs}),Mt}function Uh(dt){var Ot=-1,Mt=Array(dt.size);return dt.forEach(function(rs){Mt[++Ot]=[rs,rs]}),Mt}function ff(dt,Ot,Mt){for(var rs=Mt-1,on=dt.length;++rs<on;)if(dt[rs]===Ot)return rs;return-1}function Vh(dt,Ot,Mt){for(var rs=Mt+1;rs--;)if(dt[rs]===Ot)return rs;return rs}function Ru(dt){return Ma(dt)?Ym(dt):qm(dt)}function Mo(dt){return Ma(dt)?qh(dt):Wc(dt)}function jh(dt){for(var Ot=dt.length;Ot--&&Ve.test(dt.charAt(Ot)););return Ot}var Wm=gl(Um);function Ym(dt){for(var Ot=Io.lastIndex=0;Io.test(dt);)++Ot;return Ot}function qh(dt){return dt.match(Io)||[]}function mf(dt){return dt.match(ql)||[]}var _f=function dt(Ot){Ot=Ot==null?bi:tc.defaults(bi.Object(),Ot,tc.pick(bi,Gl));var Mt=Ot.Array,rs=Ot.Date,on=Ot.Error,En=Ot.Function,Er=Ot.Math,Es=Ot.Object,sr=Ot.RegExp,Uo=Ot.String,no=Ot.TypeError,yl=Mt.prototype,Md=En.prototype,$u=Es.prototype,Hh=Ot["__core-js_shared__"],sc=Md.toString,Wn=$u.hasOwnProperty,vl=0,Kr=function(){var m=/[^.]+$/.exec(Hh&&Hh.keys&&Hh.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),nc=$u.toString,Zm=sc.call(Es),Jr=bi._,_s=sr("^"+sc.call(Wn).replace(et,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Fi=Vm?Ot.Buffer:s,ka=Ot.Symbol,bl=Ot.Uint8Array,ea=Fi?Fi.allocUnsafe:s,zi=pf(Es.getPrototypeOf,Es),Gh=Es.create,ss=$u.propertyIsEnumerable,Ou=yl.splice,Ed=ka?ka.isConcatSpreadable:s,Kc=ka?ka.iterator:s,Pi=ka?ka.toStringTag:s,Ui=function(){try{var m=Ho(Es,"defineProperty");return m({},"",{}),m}catch{}}(),Wh=Ot.clearTimeout!==bi.clearTimeout&&Ot.clearTimeout,Yh=rs&&rs.now!==bi.Date.now&&rs.now,Eo=Ot.setTimeout!==bi.setTimeout&&Ot.setTimeout,ta=Er.ceil,kd=Er.floor,Jc=Es.getOwnPropertySymbols,gf=Fi?Fi.isBuffer:s,Zh=Ot.isFinite,Pa=yl.join,Vo=pf(Es.keys,Es),Bs=Er.max,Rr=Er.min,sa=rs.now,Ri=Ot.parseInt,rc=Er.random,ic=yl.reverse,jo=Ho(Ot,"DataView"),mi=Ho(Ot,"Map"),Qc=Ho(Ot,"Promise"),Ss=Ho(Ot,"Set"),gs=Ho(Ot,"WeakMap"),oc=Ho(Es,"create"),Si=gs&&new gs,ro={},$i=Vu(jo),ja=Vu(mi),yf=Vu(Qc),Xh=Vu(Ss),Un=Vu(gs),Qr=ka?ka.prototype:s,Lu=Qr?Qr.valueOf:s,ac=Qr?Qr.toString:s;function Ie(m){if(Lr(m)&&!Ys(m)&&!(m instanceof un)){if(m instanceof ji)return m;if(Wn.call(m,"__wrapped__"))return my(m)}return new ji(m)}var ko=function(){function m(){}return function(b){if(!Or(b))return{};if(Gh)return Gh(b);m.prototype=b;var E=new m;return m.prototype=s,E}}();function Vi(){}function ji(m,b){this.__wrapped__=m,this.__actions__=[],this.__chain__=!!b,this.__index__=0,this.__values__=s}Ie.templateSettings={escape:qr,evaluate:Q,interpolate:ae,variable:"",imports:{_:Ie}},Ie.prototype=Vi.prototype,Ie.prototype.constructor=Ie,ji.prototype=ko(Vi.prototype),ji.prototype.constructor=ji;function un(m){this.__wrapped__=m,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Y,this.__views__=[]}function Kh(){var m=new un(this.__wrapped__);return m.__actions__=la(this.__actions__),m.__dir__=this.__dir__,m.__filtered__=this.__filtered__,m.__iteratees__=la(this.__iteratees__),m.__takeCount__=this.__takeCount__,m.__views__=la(this.__views__),m}function Nu(){if(this.__filtered__){var m=new un(this);m.__dir__=-1,m.__filtered__=!0}else m=this.clone(),m.__dir__*=-1;return m}function Pd(){var m=this.__wrapped__.value(),b=this.__dir__,E=Ys(m),z=b<0,ie=E?m.length:0,Ee=Kx(0,ie,this.__views__),Ke=Ee.start,ot=Ee.end,mt=ot-Ke,Wt=z?ot:Ke-1,Zt=this.__iteratees__,Jt=Zt.length,Ts=0,Gs=Rr(mt,this.__takeCount__);if(!E||!z&&ie==mt&&Gs==mt)return ty(m,this.__actions__);var ln=[];e:for(;mt--&&Ts<Gs;){Wt+=b;for(var Dn=-1,cn=m[Wt];++Dn<Jt;){var Zn=Zt[Dn],rr=Zn.iteratee,kl=Zn.type,Da=rr(cn);if(kl==Ut)cn=Da;else if(!Da){if(kl==vt)continue e;break e}}ln[Ts++]=cn}return ln}un.prototype=ko(Vi.prototype),un.prototype.constructor=un;function xl(m){var b=-1,E=m==null?0:m.length;for(this.clear();++b<E;){var z=m[b];this.set(z[0],z[1])}}function Du(){this.__data__=oc?oc(null):{},this.size=0}function eu(m){var b=this.has(m)&&delete this.__data__[m];return this.size-=b?1:0,b}function vf(m){var b=this.__data__;if(oc){var E=b[m];return E===p?s:E}return Wn.call(b,m)?b[m]:s}function lc(m){var b=this.__data__;return oc?b[m]!==s:Wn.call(b,m)}function cc(m,b){var E=this.__data__;return this.size+=this.has(m)?0:1,E[m]=oc&&b===s?p:b,this}xl.prototype.clear=Du,xl.prototype.delete=eu,xl.prototype.get=vf,xl.prototype.has=lc,xl.prototype.set=cc;function na(m){var b=-1,E=m==null?0:m.length;for(this.clear();++b<E;){var z=m[b];this.set(z[0],z[1])}}function uc(){this.__data__=[],this.size=0}function ra(m){var b=this.__data__,E=wt(b,m);if(E<0)return!1;var z=b.length-1;return E==z?b.pop():Ou.call(b,E,1),--this.size,!0}function bf(m){var b=this.__data__,E=wt(b,m);return E<0?s:b[E][1]}function Rd(m){return wt(this.__data__,m)>-1}function xf(m,b){var E=this.__data__,z=wt(E,m);return z<0?(++this.size,E.push([m,b])):E[z][1]=b,this}na.prototype.clear=uc,na.prototype.delete=ra,na.prototype.get=bf,na.prototype.has=Rd,na.prototype.set=xf;function ia(m){var b=-1,E=m==null?0:m.length;for(this.clear();++b<E;){var z=m[b];this.set(z[0],z[1])}}function u(){this.size=0,this.__data__={hash:new xl,map:new(mi||na),string:new xl}}function f(m){var b=Jn(this,m).delete(m);return this.size-=b?1:0,b}function h(m){return Jn(this,m).get(m)}function g(m){return Jn(this,m).has(m)}function S(m,b){var E=Jn(this,m),z=E.size;return E.set(m,b),this.size+=E.size==z?0:1,this}ia.prototype.clear=u,ia.prototype.delete=f,ia.prototype.get=h,ia.prototype.has=g,ia.prototype.set=S;function M(m){var b=-1,E=m==null?0:m.length;for(this.__data__=new ia;++b<E;)this.add(m[b])}function R(m){return this.__data__.set(m,p),this}function N(m){return this.__data__.has(m)}M.prototype.add=M.prototype.push=R,M.prototype.has=N;function H(m){var b=this.__data__=new na(m);this.size=b.size}function se(){this.__data__=new na,this.size=0}function ge(m){var b=this.__data__,E=b.delete(m);return this.size=b.size,E}function we(m){return this.__data__.get(m)}function Te(m){return this.__data__.has(m)}function ze(m,b){var E=this.__data__;if(E instanceof na){var z=E.__data__;if(!mi||z.length<r-1)return z.push([m,b]),this.size=++E.size,this;E=this.__data__=new ia(z)}return E.set(m,b),this.size=E.size,this}H.prototype.clear=se,H.prototype.delete=ge,H.prototype.get=we,H.prototype.has=Te,H.prototype.set=ze;function De(m,b){var E=Ys(m),z=!E&&Lo(m),ie=!E&&!z&&Na(m),Ee=!E&&!z&&!ie&&_c(m),Ke=E||z||ie||Ee,ot=Ke?Eu(m.length,Uo):[],mt=ot.length;for(var Wt in m)(b||Wn.call(m,Wt))&&!(Ke&&(Wt=="length"||ie&&(Wt=="offset"||Wt=="parent")||Ee&&(Wt=="buffer"||Wt=="byteLength"||Wt=="byteOffset")||ca(Wt,mt)))&&ot.push(Wt);return ot}function Ye(m){var b=m.length;return b?m[Jg(0,b-1)]:s}function Le(m,b){return ou(la(m),as(b,0,m.length))}function Ze(m){return ou(la(m))}function tt(m,b,E){(E!==s&&!er(m[b],E)||E===s&&!(b in m))&&Gt(m,b,E)}function ut(m,b,E){var z=m[b];(!(Wn.call(m,b)&&er(z,E))||E===s&&!(b in m))&&Gt(m,b,E)}function wt(m,b){for(var E=m.length;E--;)if(er(m[E][0],b))return E;return-1}function bt(m,b,E,z){return Ls(m,function(ie,Ee,Ke){b(z,ie,E(ie),Ke)}),z}function It(m,b){return m&&hc(b,Gi(b),m)}function Dt(m,b){return m&&hc(b,Oi(b),m)}function Gt(m,b,E){b=="__proto__"&&Ui?Ui(m,b,{configurable:!0,enumerable:!0,value:E,writable:!0}):m[b]=E}function Xt(m,b){for(var E=-1,z=b.length,ie=Mt(z),Ee=m==null;++E<z;)ie[E]=Ee?s:N_(m,b[E]);return ie}function as(m,b,E){return m===m&&(E!==s&&(m=m<=E?m:E),b!==s&&(m=m>=b?m:b)),m}function vs(m,b,E,z,ie,Ee){var Ke,ot=b&C,mt=b&I,Wt=b&O;if(E&&(Ke=ie?E(m,z,ie,Ee):E(m)),Ke!==s)return Ke;if(!Or(m))return m;var Zt=Ys(m);if(Zt){if(Ke=Qx(m),!ot)return la(m,Ke)}else{var Jt=Ro(m),Ts=Jt==fe||Jt==ye;if(Na(m))return f0(m,ot);if(Jt==Et||Jt==Ne||Ts&&!ie){if(Ke=mt||Ts?{}:M0(m),!ot)return mt?tp(m,Dt(Ke,m)):g0(m,It(Ke,m))}else{if(!Cn[Jt])return ie?m:{};Ke=ew(m,Jt,ot)}}Ee||(Ee=new H);var Gs=Ee.get(m);if(Gs)return Gs;Ee.set(m,Ke),Yd(m)?m.forEach(function(cn){Ke.add(vs(cn,b,E,cn,m,Ee))}):uu(m)&&m.forEach(function(cn,Zn){Ke.set(Zn,vs(cn,b,E,Zn,m,Ee))});var ln=Wt?mt?ly:ay:mt?Oi:Gi,Dn=Zt?s:ln(m);return ki(Dn||m,function(cn,Zn){Dn&&(Zn=cn,cn=m[Zn]),ut(Ke,Zn,vs(cn,b,E,Zn,m,Ee))}),Ke}function $s(m){var b=Gi(m);return function(E){return ks(E,m,b)}}function ks(m,b,E){var z=E.length;if(m==null)return!z;for(m=Es(m);z--;){var ie=E[z],Ee=b[ie],Ke=m[ie];if(Ke===s&&!(ie in m)||!Ee(Ke))return!1}return!0}function xn(m,b,E){if(typeof m!="function")throw new no(o);return zd(function(){m.apply(s,E)},b)}function ps(m,b,E,z){var ie=-1,Ee=wd,Ke=!0,ot=m.length,mt=[],Wt=b.length;if(!ot)return mt;E&&(b=Fr(b,To(E))),z?(Ee=Gn,Ke=!1):b.length>=r&&(Ee=ku,Ke=!1,b=new M(b));e:for(;++ie<ot;){var Zt=m[ie],Jt=E==null?Zt:E(Zt);if(Zt=z||Zt!==0?Zt:0,Ke&&Jt===Jt){for(var Ts=Wt;Ts--;)if(b[Ts]===Jt)continue e;mt.push(Zt)}else Ee(b,Jt,z)||mt.push(Zt)}return mt}var Ls=ny(kr),Qs=ny(oi,!0);function qs(m,b){var E=!0;return Ls(m,function(z,ie,Ee){return E=!!b(z,ie,Ee),E}),E}function zs(m,b,E){for(var z=-1,ie=m.length;++z<ie;){var Ee=m[z],Ke=b(Ee);if(Ke!=null&&(ot===s?Ke===Ke&&!co(Ke):E(Ke,ot)))var ot=Ke,mt=Ee}return mt}function en(m,b,E,z){var ie=m.length;for(E=gn(E),E<0&&(E=-E>ie?0:ie+E),z=z===s||z>ie?ie:gn(z),z<0&&(z+=ie),z=E>z?0:t1(z);E<z;)m[E++]=b;return m}function Vs(m,b){var E=[];return Ls(m,function(z,ie,Ee){b(z,ie,Ee)&&E.push(z)}),E}function ws(m,b,E,z,ie){var Ee=-1,Ke=m.length;for(E||(E=h_),ie||(ie=[]);++Ee<Ke;){var ot=m[Ee];b>0&&E(ot)?b>1?ws(ot,b-1,E,z,ie):Aa(ie,ot):z||(ie[ie.length]=ot)}return ie}var ei=ry(),$r=ry(!0);function kr(m,b){return m&&ei(m,b,Gi)}function oi(m,b){return m&&$r(m,b,Gi)}function fr(m,b){return ml(b,function(E){return Ja(m[E])})}function ur(m,b){b=ru(b,m);for(var E=0,z=b.length;m!=null&&E<z;)m=m[Ml(b[E++])];return E&&E==z?m:s}function _o(m,b,E){var z=b(m);return Ys(m)?z:Aa(z,E(m))}function lr(m){return m==null?m===s?ys:it:Pi&&Pi in Es(m)?rp(m):m_(m)}function qa(m,b){return m>b}function go(m,b){return m!=null&&Wn.call(m,b)}function Ra(m,b){return m!=null&&b in Es(m)}function oa(m,b,E){return m>=Rr(b,E)&&m<Bs(b,E)}function tu(m,b,E){for(var z=E?Gn:wd,ie=m[0].length,Ee=m.length,Ke=Ee,ot=Mt(Ee),mt=1/0,Wt=[];Ke--;){var Zt=m[Ke];Ke&&b&&(Zt=Fr(Zt,To(b))),mt=Rr(Zt.length,mt),ot[Ke]=!E&&(b||ie>=120&&Zt.length>=120)?new M(Ke&&Zt):s}Zt=m[0];var Jt=-1,Ts=ot[0];e:for(;++Jt<ie&&Wt.length<mt;){var Gs=Zt[Jt],ln=b?b(Gs):Gs;if(Gs=E||Gs!==0?Gs:0,!(Ts?ku(Ts,ln):z(Wt,ln,E))){for(Ke=Ee;--Ke;){var Dn=ot[Ke];if(!(Dn?ku(Dn,ln):z(m[Ke],ln,E)))continue e}Ts&&Ts.push(ln),Wt.push(Gs)}}return Wt}function Bu(m,b,E,z){return kr(m,function(ie,Ee,Ke){b(z,E(ie),Ee,Ke)}),z}function aa(m,b,E){b=ru(b,m),m=dy(m,b);var z=m==null?m:m[Ml(Xa(b))];return z==null?s:wi(z,m,E)}function su(m){return Lr(m)&&lr(m)==Ne}function $d(m){return Lr(m)&&lr(m)==ue}function Ha(m){return Lr(m)&&lr(m)==We}function wl(m,b,E,z,ie){return m===b?!0:m==null||b==null||!Lr(m)&&!Lr(b)?m!==m&&b!==b:Ga(m,b,E,z,wl,ie)}function Ga(m,b,E,z,ie,Ee){var Ke=Ys(m),ot=Ys(b),mt=Ke?ke:Ro(m),Wt=ot?ke:Ro(b);mt=mt==Ne?Et:mt,Wt=Wt==Ne?Et:Wt;var Zt=mt==Et,Jt=Wt==Et,Ts=mt==Wt;if(Ts&&Na(m)){if(!Na(b))return!1;Ke=!0,Zt=!1}if(Ts&&!Zt)return Ee||(Ee=new H),Ke||_c(m)?I0(m,b,E,z,ie,Ee):Zx(m,b,mt,E,z,ie,Ee);if(!(E&A)){var Gs=Zt&&Wn.call(m,"__wrapped__"),ln=Jt&&Wn.call(b,"__wrapped__");if(Gs||ln){var Dn=Gs?m.value():m,cn=ln?b.value():b;return Ee||(Ee=new H),ie(Dn,cn,E,z,Ee)}}return Ts?(Ee||(Ee=new H),Xx(m,b,E,z,ie,Ee)):!1}function _i(m){return Lr(m)&&Ro(m)==Je}function $a(m,b,E,z){var ie=E.length,Ee=ie,Ke=!z;if(m==null)return!Ee;for(m=Es(m);ie--;){var ot=E[ie];if(Ke&&ot[2]?ot[1]!==m[ot[0]]:!(ot[0]in m))return!1}for(;++ie<Ee;){ot=E[ie];var mt=ot[0],Wt=m[mt],Zt=ot[1];if(Ke&&ot[2]){if(Wt===s&&!(mt in m))return!1}else{var Jt=new H;if(z)var Ts=z(Wt,Zt,mt,m,b,Jt);if(!(Ts===s?wl(Zt,Wt,A|P,z,Jt):Ts))return!1}}return!0}function Sl(m){if(!Or(m)||E0(m))return!1;var b=Ja(m)?_s:is;return b.test(Vu(m))}function nu(m){return Lr(m)&&lr(m)==St}function Ln(m){return Lr(m)&&Ro(m)==Ct}function qo(m){return Lr(m)&&Qa(m.length)&&!!pr[lr(m)]}function io(m){return typeof m=="function"?m:m==null?el:typeof m=="object"?Ys(m)?wf(m[0],m[1]):zu(m):OI(m)}function Cl(m){if(!iu(m))return Vo(m);var b=[];for(var E in Es(m))Wn.call(m,E)&&E!="constructor"&&b.push(E);return b}function Xg(m){if(!Or(m))return f_(m);var b=iu(m),E=[];for(var z in m)z=="constructor"&&(b||!Wn.call(m,z))||E.push(z);return E}function Fu(m,b){return m<b}function Xm(m,b){var E=-1,z=Nn(m)?Mt(m.length):[];return Ls(m,function(ie,Ee,Ke){z[++E]=b(ie,Ee,Ke)}),z}function zu(m){var b=u_(m);return b.length==1&&b[0][2]?Go(b[0][0],b[0][1]):function(E){return E===m||$a(E,m,b)}}function wf(m,b){return cy(m)&&ip(b)?Go(Ml(m),b):function(E){var z=N_(E,m);return z===s&&z===b?_p(E,m):wl(b,z,A|P)}}function Il(m,b,E,z,ie){m!==b&&ei(b,function(Ee,Ke){if(ie||(ie=new H),Or(Ee))Jh(m,b,Ke,E,Il,z,ie);else{var ot=z?z(hy(m,Ke),Ee,Ke+"",m,b,ie):s;ot===s&&(ot=Ee),tt(m,Ke,ot)}},Oi)}function Jh(m,b,E,z,ie,Ee,Ke){var ot=hy(m,E),mt=hy(b,E),Wt=Ke.get(mt);if(Wt){tt(m,E,Wt);return}var Zt=Ee?Ee(ot,mt,E+"",m,b,Ke):s,Jt=Zt===s;if(Jt){var Ts=Ys(mt),Gs=!Ts&&Na(mt),ln=!Ts&&!Gs&&_c(mt);Zt=mt,Ts||Gs||ln?Ys(ot)?Zt=ot:gr(ot)?Zt=la(ot):Gs?(Jt=!1,Zt=f0(mt,!0)):ln?(Jt=!1,Zt=n_(mt,!0)):Zt=[]:du(mt)||Lo(mt)?(Zt=ot,Lo(ot)?Zt=Ur(ot):(!Or(ot)||Ja(ot))&&(Zt=M0(mt))):Jt=!1}Jt&&(Ke.set(mt,Zt),ie(Zt,mt,z,Ee,Ke),Ke.delete(mt)),tt(m,E,Zt)}function Km(m,b){var E=m.length;if(!!E)return b+=b<0?E:0,ca(b,E)?m[b]:s}function Uu(m,b,E){b.length?b=Fr(b,function(Ee){return Ys(Ee)?function(Ke){return ur(Ke,Ee.length===1?Ee[0]:Ee)}:Ee}):b=[el];var z=-1;b=Fr(b,To(Xs()));var ie=Xm(m,function(Ee,Ke,ot){var mt=Fr(b,function(Wt){return Wt(Ee)});return{criteria:mt,index:++z,value:Ee}});return Cd(ie,function(Ee,Ke){return Tl(Ee,Ke,E)})}function Po(m,b){return c0(m,b,function(E,z){return _p(m,z)})}function c0(m,b,E){for(var z=-1,ie=b.length,Ee={};++z<ie;){var Ke=b[z],ot=ur(m,Ke);E(ot,Ke)&&Wa(Ee,ru(Ke,m),ot)}return Ee}function u0(m){return function(b){return ur(b,m)}}function Kg(m,b,E,z){var ie=z?cf:Yc,Ee=-1,Ke=b.length,ot=m;for(m===b&&(b=la(b)),E&&(ot=Fr(m,To(E)));++Ee<Ke;)for(var mt=0,Wt=b[Ee],Zt=E?E(Wt):Wt;(mt=ie(ot,Zt,mt,z))>-1;)ot!==m&&Ou.call(ot,mt,1),Ou.call(m,mt,1);return m}function d0(m,b){for(var E=m?b.length:0,z=E-1;E--;){var ie=b[E];if(E==z||ie!==Ee){var Ee=ie;ca(ie)?Ou.call(m,ie,1):ey(m,ie)}}return m}function Jg(m,b){return m+kd(rc()*(b-m+1))}function Ux(m,b,E,z){for(var ie=-1,Ee=Bs(ta((b-m)/(E||1)),0),Ke=Mt(Ee);Ee--;)Ke[z?Ee:++ie]=m,m+=E;return Ke}function Sf(m,b){var E="";if(!m||b<1||b>F)return E;do b%2&&(E+=m),b=kd(b/2),b&&(m+=m);while(b);return E}function kn(m,b){return Ef(Oo(m,b,el),m+"")}function Jm(m){return Ye(Jd(m))}function h0(m,b){var E=Jd(m);return ou(E,as(b,0,E.length))}function Wa(m,b,E,z){if(!Or(m))return m;b=ru(b,m);for(var ie=-1,Ee=b.length,Ke=Ee-1,ot=m;ot!=null&&++ie<Ee;){var mt=Ml(b[ie]),Wt=E;if(mt==="__proto__"||mt==="constructor"||mt==="prototype")return m;if(ie!=Ke){var Zt=ot[mt];Wt=z?z(Zt,mt,ot):s,Wt===s&&(Wt=Or(Zt)?Zt:ca(b[ie+1])?[]:{})}ut(ot,mt,Wt),ot=ot[mt]}return m}var Qh=Si?function(m,b){return Si.set(m,b),m}:el,Vx=Ui?function(m,b){return Ui(m,"toString",{configurable:!0,enumerable:!1,value:kw(b),writable:!0})}:el;function jx(m){return ou(Jd(m))}function Ya(m,b,E){var z=-1,ie=m.length;b<0&&(b=-b>ie?0:ie+b),E=E>ie?ie:E,E<0&&(E+=ie),ie=b>E?0:E-b>>>0,b>>>=0;for(var Ee=Mt(ie);++z<ie;)Ee[z]=m[z+b];return Ee}function qx(m,b){var E;return Ls(m,function(z,ie,Ee){return E=b(z,ie,Ee),!E}),!!E}function Qm(m,b,E){var z=0,ie=m==null?z:m.length;if(typeof b=="number"&&b===b&&ie<=he){for(;z<ie;){var Ee=z+ie>>>1,Ke=m[Ee];Ke!==null&&!co(Ke)&&(E?Ke<=b:Ke<b)?z=Ee+1:ie=Ee}return ie}return Qg(m,b,el,E)}function Qg(m,b,E,z){var ie=0,Ee=m==null?0:m.length;if(Ee===0)return 0;b=E(b);for(var Ke=b!==b,ot=b===null,mt=co(b),Wt=b===s;ie<Ee;){var Zt=kd((ie+Ee)/2),Jt=E(m[Zt]),Ts=Jt!==s,Gs=Jt===null,ln=Jt===Jt,Dn=co(Jt);if(Ke)var cn=z||ln;else Wt?cn=ln&&(z||Ts):ot?cn=ln&&Ts&&(z||!Gs):mt?cn=ln&&Ts&&!Gs&&(z||!Dn):Gs||Dn?cn=!1:cn=z?Jt<=b:Jt<b;cn?ie=Zt+1:Ee=Zt}return Rr(Ee,J)}function p0(m,b){for(var E=-1,z=m.length,ie=0,Ee=[];++E<z;){var Ke=m[E],ot=b?b(Ke):Ke;if(!E||!er(ot,mt)){var mt=ot;Ee[ie++]=Ke===0?0:Ke}}return Ee}function e_(m){return typeof m=="number"?m:co(m)?G:+m}function Oa(m){if(typeof m=="string")return m;if(Ys(m))return Fr(m,Oa)+"";if(co(m))return ac?ac.call(m):"";var b=m+"";return b=="0"&&1/m==-_t?"-0":b}function La(m,b,E){var z=-1,ie=wd,Ee=m.length,Ke=!0,ot=[],mt=ot;if(E)Ke=!1,ie=Gn;else if(Ee>=r){var Wt=b?null:yo(m);if(Wt)return ec(Wt);Ke=!1,ie=ku,mt=new M}else mt=b?[]:ot;e:for(;++z<Ee;){var Zt=m[z],Jt=b?b(Zt):Zt;if(Zt=E||Zt!==0?Zt:0,Ke&&Jt===Jt){for(var Ts=mt.length;Ts--;)if(mt[Ts]===Jt)continue e;b&&mt.push(Jt),ot.push(Zt)}else ie(mt,Jt,E)||(mt!==ot&&mt.push(Jt),ot.push(Zt))}return ot}function ey(m,b){return b=ru(b,m),m=dy(m,b),m==null||delete m[Ml(Xa(b))]}function ti(m,b,E,z){return Wa(m,b,E(ur(m,b)),z)}function Od(m,b,E,z){for(var ie=m.length,Ee=z?ie:-1;(z?Ee--:++Ee<ie)&&b(m[Ee],Ee,m););return E?Ya(m,z?0:Ee,z?Ee+1:ie):Ya(m,z?Ee+1:0,z?ie:Ee)}function ty(m,b){var E=m;return E instanceof un&&(E=E.value()),Dh(b,function(z,ie){return ie.func.apply(ie.thisArg,Aa([z],ie.args))},E)}function ep(m,b,E){var z=m.length;if(z<2)return z?La(m[0]):[];for(var ie=-1,Ee=Mt(z);++ie<z;)for(var Ke=m[ie],ot=-1;++ot<z;)ot!=ie&&(Ee[ie]=ps(Ee[ie]||Ke,m[ot],b,E));return La(ws(Ee,1),b,E)}function Cf(m,b,E){for(var z=-1,ie=m.length,Ee=b.length,Ke={};++z<ie;){var ot=z<Ee?b[z]:s;E(Ke,m[z],ot)}return Ke}function Ld(m){return gr(m)?m:[]}function t_(m){return typeof m=="function"?m:el}function ru(m,b){return Ys(m)?m:cy(m,b)?[m]:__(yr(m))}var If=kn;function dc(m,b,E){var z=m.length;return E=E===s?z:E,!b&&E>=z?m:Ya(m,b,E)}var s_=Wh||function(m){return bi.clearTimeout(m)};function f0(m,b){if(b)return m.slice();var E=m.length,z=ea?ea(E):new m.constructor(E);return m.copy(z),z}function Nd(m){var b=new m.constructor(m.byteLength);return new bl(b).set(new bl(m)),b}function Hx(m,b){var E=b?Nd(m.buffer):m.buffer;return new m.constructor(E,m.byteOffset,m.byteLength)}function sy(m){var b=new m.constructor(m.source,At.exec(m));return b.lastIndex=m.lastIndex,b}function Gx(m){return Lu?Es(Lu.call(m)):{}}function n_(m,b){var E=b?Nd(m.buffer):m.buffer;return new m.constructor(E,m.byteOffset,m.length)}function r_(m,b){if(m!==b){var E=m!==s,z=m===null,ie=m===m,Ee=co(m),Ke=b!==s,ot=b===null,mt=b===b,Wt=co(b);if(!ot&&!Wt&&!Ee&&m>b||Ee&&Ke&&mt&&!ot&&!Wt||z&&Ke&&mt||!E&&mt||!ie)return 1;if(!z&&!Ee&&!Wt&&m<b||Wt&&E&&ie&&!z&&!Ee||ot&&E&&ie||!Ke&&ie||!mt)return-1}return 0}function Tl(m,b,E){for(var z=-1,ie=m.criteria,Ee=b.criteria,Ke=ie.length,ot=E.length;++z<Ke;){var mt=r_(ie[z],Ee[z]);if(mt){if(z>=ot)return mt;var Wt=E[z];return mt*(Wt=="desc"?-1:1)}}return m.index-b.index}function m0(m,b,E,z){for(var ie=-1,Ee=m.length,Ke=E.length,ot=-1,mt=b.length,Wt=Bs(Ee-Ke,0),Zt=Mt(mt+Wt),Jt=!z;++ot<mt;)Zt[ot]=b[ot];for(;++ie<Ke;)(Jt||ie<Ee)&&(Zt[E[ie]]=m[ie]);for(;Wt--;)Zt[ot++]=m[ie++];return Zt}function _0(m,b,E,z){for(var ie=-1,Ee=m.length,Ke=-1,ot=E.length,mt=-1,Wt=b.length,Zt=Bs(Ee-ot,0),Jt=Mt(Zt+Wt),Ts=!z;++ie<Zt;)Jt[ie]=m[ie];for(var Gs=ie;++mt<Wt;)Jt[Gs+mt]=b[mt];for(;++Ke<ot;)(Ts||ie<Ee)&&(Jt[Gs+E[Ke]]=m[ie++]);return Jt}function la(m,b){var E=-1,z=m.length;for(b||(b=Mt(z));++E<z;)b[E]=m[E];return b}function hc(m,b,E,z){var ie=!E;E||(E={});for(var Ee=-1,Ke=b.length;++Ee<Ke;){var ot=b[Ee],mt=z?z(E[ot],m[ot],ot,E,m):s;mt===s&&(mt=m[ot]),ie?Gt(E,ot,mt):ut(E,ot,mt)}return E}function g0(m,b){return hc(m,d_(m),b)}function tp(m,b){return hc(m,T0(m),b)}function i_(m,b){return function(E,z){var ie=Ys(E)?Xl:bt,Ee=b?b():{};return ie(E,m,Xs(z,2),Ee)}}function sp(m){return kn(function(b,E){var z=-1,ie=E.length,Ee=ie>1?E[ie-1]:s,Ke=ie>2?E[2]:s;for(Ee=m.length>3&&typeof Ee=="function"?(ie--,Ee):s,Ke&&$o(E[0],E[1],Ke)&&(Ee=ie<3?s:Ee,ie=1),b=Es(b);++z<ie;){var ot=E[z];ot&&m(b,ot,z,Ee)}return b})}function ny(m,b){return function(E,z){if(E==null)return E;if(!Nn(E))return m(E,z);for(var ie=E.length,Ee=b?ie:-1,Ke=Es(E);(b?Ee--:++Ee<ie)&&z(Ke[Ee],Ee,Ke)!==!1;);return E}}function ry(m){return function(b,E,z){for(var ie=-1,Ee=Es(b),Ke=z(b),ot=Ke.length;ot--;){var mt=Ke[m?ot:++ie];if(E(Ee[mt],mt,Ee)===!1)break}return b}}function Wx(m,b,E){var z=b&q,ie=Tf(m);function Ee(){var Ke=this&&this!==bi&&this instanceof Ee?ie:m;return Ke.apply(z?E:this,arguments)}return Ee}function y0(m){return function(b){b=yr(b);var E=Ma(b)?Mo(b):s,z=E?E[0]:b.charAt(0),ie=E?dc(E,1).join(""):b.slice(1);return z[m]()+ie}}function Al(m){return function(b){return Dh(RI(Py(b).replace(zm,"")),m,"")}}function Tf(m){return function(){var b=arguments;switch(b.length){case 0:return new m;case 1:return new m(b[0]);case 2:return new m(b[0],b[1]);case 3:return new m(b[0],b[1],b[2]);case 4:return new m(b[0],b[1],b[2],b[3]);case 5:return new m(b[0],b[1],b[2],b[3],b[4]);case 6:return new m(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new m(b[0],b[1],b[2],b[3],b[4],b[5],b[6])}var E=ko(m.prototype),z=m.apply(E,b);return Or(z)?z:E}}function iy(m,b,E){var z=Tf(m);function ie(){for(var Ee=arguments.length,Ke=Mt(Ee),ot=Ee,mt=Fd(ie);ot--;)Ke[ot]=arguments[ot];var Wt=Ee<3&&Ke[0]!==mt&&Ke[Ee-1]!==mt?[]:Ao(Ke,mt);if(Ee-=Wt.length,Ee<E)return x0(m,b,o_,ie.placeholder,s,Ke,Wt,s,s,E-Ee);var Zt=this&&this!==bi&&this instanceof ie?z:m;return wi(Zt,this,Ke)}return ie}function np(m){return function(b,E,z){var ie=Es(b);if(!Nn(b)){var Ee=Xs(E,3);b=Gi(b),E=function(ot){return Ee(ie[ot],ot,ie)}}var Ke=m(b,E,z);return Ke>-1?ie[Ee?b[Ke]:Ke]:s}}function Za(m){return fc(function(b){var E=b.length,z=E,ie=ji.prototype.thru;for(m&&b.reverse();z--;){var Ee=b[z];if(typeof Ee!="function")throw new no(o);if(ie&&!Ke&&Mf(Ee)=="wrapper")var Ke=new ji([],!0)}for(z=Ke?z:E;++z<E;){Ee=b[z];var ot=Mf(Ee),mt=ot=="wrapper"?Bd(Ee):s;mt&&uy(mt[0])&&mt[1]==(ve|W|te|ee)&&!mt[4].length&&mt[9]==1?Ke=Ke[Mf(mt[0])].apply(Ke,mt[3]):Ke=Ee.length==1&&uy(Ee)?Ke[ot]():Ke.thru(Ee)}return function(){var Wt=arguments,Zt=Wt[0];if(Ke&&Wt.length==1&&Ys(Zt))return Ke.plant(Zt).value();for(var Jt=0,Ts=E?b[Jt].apply(this,Wt):Zt;++Jt<E;)Ts=b[Jt].call(this,Ts);return Ts}})}function o_(m,b,E,z,ie,Ee,Ke,ot,mt,Wt){var Zt=b&ve,Jt=b&q,Ts=b&ce,Gs=b&(W|Ce),ln=b&ne,Dn=Ts?s:Tf(m);function cn(){for(var Zn=arguments.length,rr=Mt(Zn),kl=Zn;kl--;)rr[kl]=arguments[kl];if(Gs)var Da=Fd(cn),Pl=Td(rr,Da);if(z&&(rr=m0(rr,z,ie,Gs)),Ee&&(rr=_0(rr,Ee,Ke,Gs)),Zn-=Pl,Gs&&Zn<Wt){var Wi=Ao(rr,Da);return x0(m,b,o_,cn.placeholder,E,rr,Wi,ot,mt,Wt-Zn)}var pu=Jt?E:this,Qd=Ts?pu[m]:m;return Zn=rr.length,ot?rr=k0(rr,ot):ln&&Zn>1&&rr.reverse(),Zt&&mt<Zn&&(rr.length=mt),this&&this!==bi&&this instanceof cn&&(Qd=Dn||Tf(Qd)),Qd.apply(pu,rr)}return cn}function v0(m,b){return function(E,z){return Bu(E,m,b(z),{})}}function a_(m,b){return function(E,z){var ie;if(E===s&&z===s)return b;if(E!==s&&(ie=E),z!==s){if(ie===s)return z;typeof E=="string"||typeof z=="string"?(E=Oa(E),z=Oa(z)):(E=e_(E),z=e_(z)),ie=m(E,z)}return ie}}function Dd(m){return fc(function(b){return b=Fr(b,To(Xs())),kn(function(E){var z=this;return m(b,function(ie){return wi(ie,z,E)})})})}function Af(m,b){b=b===s?" ":Oa(b);var E=b.length;if(E<2)return E?Sf(b,m):b;var z=Sf(b,ta(m/Ru(b)));return Ma(b)?dc(Mo(z),0,m).join(""):z.slice(0,m)}function Yx(m,b,E,z){var ie=b&q,Ee=Tf(m);function Ke(){for(var ot=-1,mt=arguments.length,Wt=-1,Zt=z.length,Jt=Mt(Zt+mt),Ts=this&&this!==bi&&this instanceof Ke?Ee:m;++Wt<Zt;)Jt[Wt]=z[Wt];for(;mt--;)Jt[Wt++]=arguments[++ot];return wi(Ts,ie?E:this,Jt)}return Ke}function b0(m){return function(b,E,z){return z&&typeof z!="number"&&$o(b,E,z)&&(E=z=s),b=gc(b),E===s?(E=b,b=0):E=gc(E),z=z===s?b<E?1:-1:gc(z),Ux(b,E,z,m)}}function l_(m){return function(b,E){return typeof b=="string"&&typeof E=="string"||(b=No(b),E=No(E)),m(b,E)}}function x0(m,b,E,z,ie,Ee,Ke,ot,mt,Wt){var Zt=b&W,Jt=Zt?Ke:s,Ts=Zt?s:Ke,Gs=Zt?Ee:s,ln=Zt?s:Ee;b|=Zt?te:oe,b&=~(Zt?oe:te),b&re||(b&=~(q|ce));var Dn=[m,b,ie,Gs,Jt,ln,Ts,ot,mt,Wt],cn=E.apply(s,Dn);return uy(m)&&py(cn,Dn),cn.placeholder=z,P0(cn,m,b)}function c_(m){var b=Er[m];return function(E,z){if(E=No(E),z=z==null?0:Rr(gn(z),292),z&&Zh(E)){var ie=(yr(E)+"e").split("e"),Ee=b(ie[0]+"e"+(+ie[1]+z));return ie=(yr(Ee)+"e").split("e"),+(ie[0]+"e"+(+ie[1]-z))}return b(E)}}var yo=Ss&&1/ec(new Ss([,-0]))[1]==_t?function(m){return new Ss(m)}:$w;function w0(m){return function(b){var E=Ro(b);return E==Je?zh(b):E==Ct?Uh(b):Zg(b,m(b))}}function pc(m,b,E,z,ie,Ee,Ke,ot){var mt=b&ce;if(!mt&&typeof m!="function")throw new no(o);var Wt=z?z.length:0;if(Wt||(b&=~(te|oe),z=ie=s),Ke=Ke===s?Ke:Bs(gn(Ke),0),ot=ot===s?ot:gn(ot),Wt-=ie?ie.length:0,b&oe){var Zt=z,Jt=ie;z=ie=s}var Ts=mt?s:Bd(m),Gs=[m,b,E,z,ie,Zt,Jt,Ee,Ke,ot];if(Ts&&oo(Gs,Ts),m=Gs[0],b=Gs[1],E=Gs[2],z=Gs[3],ie=Gs[4],ot=Gs[9]=Gs[9]===s?mt?0:m.length:Bs(Gs[9]-Wt,0),!ot&&b&(W|Ce)&&(b&=~(W|Ce)),!b||b==q)var ln=Wx(m,b,E);else b==W||b==Ce?ln=iy(m,b,ot):(b==te||b==(q|te))&&!ie.length?ln=Yx(m,b,E,z):ln=o_.apply(s,Gs);var Dn=Ts?Qh:py;return P0(Dn(ln,Gs),m,b)}function oy(m,b,E,z){return m===s||er(m,$u[E])&&!Wn.call(z,E)?b:m}function S0(m,b,E,z,ie,Ee){return Or(m)&&Or(b)&&(Ee.set(b,m),Il(m,b,s,S0,Ee),Ee.delete(b)),m}function C0(m){return du(m)?s:m}function I0(m,b,E,z,ie,Ee){var Ke=E&A,ot=m.length,mt=b.length;if(ot!=mt&&!(Ke&&mt>ot))return!1;var Wt=Ee.get(m),Zt=Ee.get(b);if(Wt&&Zt)return Wt==b&&Zt==m;var Jt=-1,Ts=!0,Gs=E&P?new M:s;for(Ee.set(m,b),Ee.set(b,m);++Jt<ot;){var ln=m[Jt],Dn=b[Jt];if(z)var cn=Ke?z(Dn,ln,Jt,b,m,Ee):z(ln,Dn,Jt,m,b,Ee);if(cn!==s){if(cn)continue;Ts=!1;break}if(Gs){if(!Bh(b,function(Zn,rr){if(!ku(Gs,rr)&&(ln===Zn||ie(ln,Zn,E,z,Ee)))return Gs.push(rr)})){Ts=!1;break}}else if(!(ln===Dn||ie(ln,Dn,E,z,Ee))){Ts=!1;break}}return Ee.delete(m),Ee.delete(b),Ts}function Zx(m,b,E,z,ie,Ee,Ke){switch(E){case B:if(m.byteLength!=b.byteLength||m.byteOffset!=b.byteOffset)return!1;m=m.buffer,b=b.buffer;case ue:return!(m.byteLength!=b.byteLength||!Ee(new bl(m),new bl(b)));case ct:case We:case at:return er(+m,+b);case rt:return m.name==b.name&&m.message==b.message;case St:case Bt:return m==b+"";case Je:var ot=zh;case Ct:var mt=z&A;if(ot||(ot=ec),m.size!=b.size&&!mt)return!1;var Wt=Ke.get(m);if(Wt)return Wt==b;z|=P,Ke.set(m,b);var Zt=I0(ot(m),ot(b),z,ie,Ee,Ke);return Ke.delete(m),Zt;case Kt:if(Lu)return Lu.call(m)==Lu.call(b)}return!1}function Xx(m,b,E,z,ie,Ee){var Ke=E&A,ot=ay(m),mt=ot.length,Wt=ay(b),Zt=Wt.length;if(mt!=Zt&&!Ke)return!1;for(var Jt=mt;Jt--;){var Ts=ot[Jt];if(!(Ke?Ts in b:Wn.call(b,Ts)))return!1}var Gs=Ee.get(m),ln=Ee.get(b);if(Gs&&ln)return Gs==b&&ln==m;var Dn=!0;Ee.set(m,b),Ee.set(b,m);for(var cn=Ke;++Jt<mt;){Ts=ot[Jt];var Zn=m[Ts],rr=b[Ts];if(z)var kl=Ke?z(rr,Zn,Ts,b,m,Ee):z(Zn,rr,Ts,m,b,Ee);if(!(kl===s?Zn===rr||ie(Zn,rr,E,z,Ee):kl)){Dn=!1;break}cn||(cn=Ts=="constructor")}if(Dn&&!cn){var Da=m.constructor,Pl=b.constructor;Da!=Pl&&"constructor"in m&&"constructor"in b&&!(typeof Da=="function"&&Da instanceof Da&&typeof Pl=="function"&&Pl instanceof Pl)&&(Dn=!1)}return Ee.delete(m),Ee.delete(b),Dn}function fc(m){return Ef(Oo(m,s,B0),m+"")}function ay(m){return _o(m,Gi,d_)}function ly(m){return _o(m,Oi,T0)}var Bd=Si?function(m){return Si.get(m)}:$w;function Mf(m){for(var b=m.name+"",E=ro[b],z=Wn.call(ro,b)?E.length:0;z--;){var ie=E[z],Ee=ie.func;if(Ee==null||Ee==m)return ie.name}return b}function Fd(m){var b=Wn.call(Ie,"placeholder")?Ie:m;return b.placeholder}function Xs(){var m=Ie.iteratee||Pw;return m=m===Pw?io:m,arguments.length?m(arguments[0],arguments[1]):m}function Jn(m,b){var E=m.__data__;return sw(b)?E[typeof b=="string"?"string":"hash"]:E.map}function u_(m){for(var b=Gi(m),E=b.length;E--;){var z=b[E],ie=m[z];b[E]=[z,ie,ip(ie)]}return b}function Ho(m,b){var E=Hm(m,b);return Sl(E)?E:s}function rp(m){var b=Wn.call(m,Pi),E=m[Pi];try{m[Pi]=s;var z=!0}catch{}var ie=nc.call(m);return z&&(b?m[Pi]=E:delete m[Pi]),ie}var d_=Jc?function(m){return m==null?[]:(m=Es(m),ml(Jc(m),function(b){return ss.call(m,b)}))}:Ow,T0=Jc?function(m){for(var b=[];m;)Aa(b,d_(m)),m=zi(m);return b}:Ow,Ro=lr;(jo&&Ro(new jo(new ArrayBuffer(1)))!=B||mi&&Ro(new mi)!=Je||Qc&&Ro(Qc.resolve())!=jt||Ss&&Ro(new Ss)!=Ct||gs&&Ro(new gs)!=ts)&&(Ro=function(m){var b=lr(m),E=b==Et?m.constructor:s,z=E?Vu(E):"";if(z)switch(z){case $i:return B;case ja:return Je;case yf:return jt;case Xh:return Ct;case Un:return ts}return b});function Kx(m,b,E){for(var z=-1,ie=E.length;++z<ie;){var Ee=E[z],Ke=Ee.size;switch(Ee.type){case"drop":m+=Ke;break;case"dropRight":b-=Ke;break;case"take":b=Rr(b,m+Ke);break;case"takeRight":m=Bs(m,b-Ke);break}}return{start:m,end:b}}function Jx(m){var b=m.match(Ft);return b?b[1].split(Ht):[]}function A0(m,b,E){b=ru(b,m);for(var z=-1,ie=b.length,Ee=!1;++z<ie;){var Ke=Ml(b[z]);if(!(Ee=m!=null&&E(m,Ke)))break;m=m[Ke]}return Ee||++z!=ie?Ee:(ie=m==null?0:m.length,!!ie&&Qa(ie)&&ca(Ke,ie)&&(Ys(m)||Lo(m)))}function Qx(m){var b=m.length,E=new m.constructor(b);return b&&typeof m[0]=="string"&&Wn.call(m,"index")&&(E.index=m.index,E.input=m.input),E}function M0(m){return typeof m.constructor=="function"&&!iu(m)?ko(zi(m)):{}}function ew(m,b,E){var z=m.constructor;switch(b){case ue:return Nd(m);case ct:case We:return new z(+m);case B:return Hx(m,E);case U:case Re:case nt:case gt:case kt:case Ds:case tn:case nn:case qn:return n_(m,E);case Je:return new z;case at:case Bt:return new z(m);case St:return sy(m);case Ct:return new z;case Kt:return Gx(m)}}function tw(m,b){var E=b.length;if(!E)return m;var z=E-1;return b[z]=(E>1?"& ":"")+b[z],b=b.join(E>2?", ":" "),m.replace(pt,`{
/* [wrapped with `+b+`] */
`)}function h_(m){return Ys(m)||Lo(m)||!!(Ed&&m&&m[Ed])}function ca(m,b){var E=typeof m;return b=b==null?F:b,!!b&&(E=="number"||E!="symbol"&&hs.test(m))&&m>-1&&m%1==0&&m<b}function $o(m,b,E){if(!Or(E))return!1;var z=typeof b;return(z=="number"?Nn(E)&&ca(b,E.length):z=="string"&&b in E)?er(E[b],m):!1}function cy(m,b){if(Ys(m))return!1;var E=typeof m;return E=="number"||E=="symbol"||E=="boolean"||m==null||co(m)?!0:Ae.test(m)||!me.test(m)||b!=null&&m in Es(b)}function sw(m){var b=typeof m;return b=="string"||b=="number"||b=="symbol"||b=="boolean"?m!=="__proto__":m===null}function uy(m){var b=Mf(m),E=Ie[b];if(typeof E!="function"||!(b in un.prototype))return!1;if(m===E)return!0;var z=Bd(E);return!!z&&m===z[0]}function E0(m){return!!Kr&&Kr in m}var p_=Hh?Ja:Lw;function iu(m){var b=m&&m.constructor,E=typeof b=="function"&&b.prototype||$u;return m===E}function ip(m){return m===m&&!Or(m)}function Go(m,b){return function(E){return E==null?!1:E[m]===b&&(b!==s||m in Es(E))}}function op(m){var b=Tr(m,function(z){return E.size===y&&E.clear(),z}),E=b.cache;return b}function oo(m,b){var E=m[1],z=b[1],ie=E|z,Ee=ie<(q|ce|ve),Ke=z==ve&&E==W||z==ve&&E==ee&&m[7].length<=b[8]||z==(ve|ee)&&b[7].length<=b[8]&&E==W;if(!(Ee||Ke))return m;z&q&&(m[2]=b[2],ie|=E&q?0:re);var ot=b[3];if(ot){var mt=m[3];m[3]=mt?m0(mt,ot,b[4]):ot,m[4]=mt?Ao(m[3],v):b[4]}return ot=b[5],ot&&(mt=m[5],m[5]=mt?_0(mt,ot,b[6]):ot,m[6]=mt?Ao(m[5],v):b[6]),ot=b[7],ot&&(m[7]=ot),z&ve&&(m[8]=m[8]==null?b[8]:Rr(m[8],b[8])),m[9]==null&&(m[9]=b[9]),m[0]=b[0],m[1]=ie,m}function f_(m){var b=[];if(m!=null)for(var E in Es(m))b.push(E);return b}function m_(m){return nc.call(m)}function Oo(m,b,E){return b=Bs(b===s?m.length-1:b,0),function(){for(var z=arguments,ie=-1,Ee=Bs(z.length-b,0),Ke=Mt(Ee);++ie<Ee;)Ke[ie]=z[b+ie];ie=-1;for(var ot=Mt(b+1);++ie<b;)ot[ie]=z[ie];return ot[b]=E(Ke),wi(m,this,ot)}}function dy(m,b){return b.length<2?m:ur(m,Ya(b,0,-1))}function k0(m,b){for(var E=m.length,z=Rr(b.length,E),ie=la(m);z--;){var Ee=b[z];m[z]=ca(Ee,E)?ie[Ee]:s}return m}function hy(m,b){if(!(b==="constructor"&&typeof m[b]=="function")&&b!="__proto__")return m[b]}var py=fy(Qh),zd=Eo||function(m,b){return bi.setTimeout(m,b)},Ef=fy(Vx);function P0(m,b,E){var z=b+"";return Ef(m,tw(z,nw(Jx(z),E)))}function fy(m){var b=0,E=0;return function(){var z=sa(),ie=Me-(z-E);if(E=z,ie>0){if(++b>=Qe)return arguments[0]}else b=0;return m.apply(s,arguments)}}function ou(m,b){var E=-1,z=m.length,ie=z-1;for(b=b===s?z:b;++E<b;){var Ee=Jg(E,ie),Ke=m[Ee];m[Ee]=m[E],m[E]=Ke}return m.length=b,m}var __=op(function(m){var b=[];return m.charCodeAt(0)===46&&b.push(""),m.replace(Fe,function(E,z,ie,Ee){b.push(ie?Ee.replace(xs,"$1"):z||E)}),b});function Ml(m){if(typeof m=="string"||co(m))return m;var b=m+"";return b=="0"&&1/m==-_t?"-0":b}function Vu(m){if(m!=null){try{return sc.call(m)}catch{}try{return m+""}catch{}}return""}function nw(m,b){return ki(be,function(E){var z="_."+E[0];b&E[1]&&!wd(m,z)&&m.push(z)}),m.sort()}function my(m){if(m instanceof un)return m.clone();var b=new ji(m.__wrapped__,m.__chain__);return b.__actions__=la(m.__actions__),b.__index__=m.__index__,b.__values__=m.__values__,b}function R0(m,b,E){(E?$o(m,b,E):b===s)?b=1:b=Bs(gn(b),0);var z=m==null?0:m.length;if(!z||b<1)return[];for(var ie=0,Ee=0,Ke=Mt(ta(z/b));ie<z;)Ke[Ee++]=Ya(m,ie,ie+=b);return Ke}function $0(m){for(var b=-1,E=m==null?0:m.length,z=0,ie=[];++b<E;){var Ee=m[b];Ee&&(ie[z++]=Ee)}return ie}function O0(){var m=arguments.length;if(!m)return[];for(var b=Mt(m-1),E=arguments[0],z=m;z--;)b[z-1]=arguments[z];return Aa(Ys(E)?la(E):[E],ws(b,1))}var rw=kn(function(m,b){return gr(m)?ps(m,ws(b,1,gr,!0)):[]}),iw=kn(function(m,b){var E=Xa(b);return gr(E)&&(E=s),gr(m)?ps(m,ws(b,1,gr,!0),Xs(E,2)):[]}),L0=kn(function(m,b){var E=Xa(b);return gr(E)&&(E=s),gr(m)?ps(m,ws(b,1,gr,!0),s,E):[]});function N0(m,b,E){var z=m==null?0:m.length;return z?(b=E||b===s?1:gn(b),Ya(m,b<0?0:b,z)):[]}function g_(m,b,E){var z=m==null?0:m.length;return z?(b=E||b===s?1:gn(b),b=z-b,Ya(m,0,b<0?0:b)):[]}function D0(m,b){return m&&m.length?Od(m,Xs(b,3),!0,!0):[]}function y_(m,b){return m&&m.length?Od(m,Xs(b,3),!0):[]}function v_(m,b,E,z){var ie=m==null?0:m.length;return ie?(E&&typeof E!="number"&&$o(m,b,E)&&(E=0,z=ie),en(m,b,E,z)):[]}function kf(m,b,E){var z=m==null?0:m.length;if(!z)return-1;var ie=E==null?0:gn(E);return ie<0&&(ie=Bs(z+ie,0)),Sd(m,Xs(b,3),ie)}function Ud(m,b,E){var z=m==null?0:m.length;if(!z)return-1;var ie=z-1;return E!==s&&(ie=gn(E),ie=E<0?Bs(z+ie,0):Rr(ie,z-1)),Sd(m,Xs(b,3),ie,!0)}function B0(m){var b=m==null?0:m.length;return b?ws(m,1):[]}function ow(m){var b=m==null?0:m.length;return b?ws(m,_t):[]}function aw(m,b){var E=m==null?0:m.length;return E?(b=b===s?1:gn(b),ws(m,b)):[]}function ap(m){for(var b=-1,E=m==null?0:m.length,z={};++b<E;){var ie=m[b];z[ie[0]]=ie[1]}return z}function b_(m){return m&&m.length?m[0]:s}function F0(m,b,E){var z=m==null?0:m.length;if(!z)return-1;var ie=E==null?0:gn(E);return ie<0&&(ie=Bs(z+ie,0)),Yc(m,b,ie)}function _y(m){var b=m==null?0:m.length;return b?Ya(m,0,-1):[]}var z0=kn(function(m){var b=Fr(m,Ld);return b.length&&b[0]===m[0]?tu(b):[]}),U0=kn(function(m){var b=Xa(m),E=Fr(m,Ld);return b===Xa(E)?b=s:E.pop(),E.length&&E[0]===m[0]?tu(E,Xs(b,2)):[]}),lw=kn(function(m){var b=Xa(m),E=Fr(m,Ld);return b=typeof b=="function"?b:s,b&&E.pop(),E.length&&E[0]===m[0]?tu(E,s,b):[]});function cw(m,b){return m==null?"":Pa.call(m,b)}function Xa(m){var b=m==null?0:m.length;return b?m[b-1]:s}function x_(m,b,E){var z=m==null?0:m.length;if(!z)return-1;var ie=z;return E!==s&&(ie=gn(E),ie=ie<0?Bs(z+ie,0):Rr(ie,z-1)),b===b?Vh(m,b,ie):Sd(m,Ql,ie,!0)}function gy(m,b){return m&&m.length?Km(m,gn(b)):s}var uw=kn(Vd);function Vd(m,b){return m&&m.length&&b&&b.length?Kg(m,b):m}function Pf(m,b,E){return m&&m.length&&b&&b.length?Kg(m,b,Xs(E,2)):m}function Qn(m,b,E){return m&&m.length&&b&&b.length?Kg(m,b,s,E):m}var dw=fc(function(m,b){var E=m==null?0:m.length,z=Xt(m,b);return d0(m,Fr(b,function(ie){return ca(ie,E)?+ie:ie}).sort(r_)),z});function yy(m,b){var E=[];if(!(m&&m.length))return E;var z=-1,ie=[],Ee=m.length;for(b=Xs(b,3);++z<Ee;){var Ke=m[z];b(Ke,z,m)&&(E.push(Ke),ie.push(z))}return d0(m,ie),E}function ju(m){return m==null?m:ic.call(m)}function hw(m,b,E){var z=m==null?0:m.length;return z?(E&&typeof E!="number"&&$o(m,b,E)?(b=0,E=z):(b=b==null?0:gn(b),E=E===s?z:gn(E)),Ya(m,b,E)):[]}function pw(m,b){return Qm(m,b)}function fw(m,b,E){return Qg(m,b,Xs(E,2))}function mw(m,b){var E=m==null?0:m.length;if(E){var z=Qm(m,b);if(z<E&&er(m[z],b))return z}return-1}function _w(m,b){return Qm(m,b,!0)}function gw(m,b,E){return Qg(m,b,Xs(E,2),!0)}function yw(m,b){var E=m==null?0:m.length;if(E){var z=Qm(m,b,!0)-1;if(er(m[z],b))return z}return-1}function V0(m){return m&&m.length?p0(m):[]}function j0(m,b){return m&&m.length?p0(m,Xs(b,2)):[]}function q0(m){var b=m==null?0:m.length;return b?Ya(m,1,b):[]}function H0(m,b,E){return m&&m.length?(b=E||b===s?1:gn(b),Ya(m,0,b<0?0:b)):[]}function w_(m,b,E){var z=m==null?0:m.length;return z?(b=E||b===s?1:gn(b),b=z-b,Ya(m,b<0?0:b,z)):[]}function jd(m,b){return m&&m.length?Od(m,Xs(b,3),!1,!0):[]}function vy(m,b){return m&&m.length?Od(m,Xs(b,3)):[]}var lp=kn(function(m){return La(ws(m,1,gr,!0))}),G0=kn(function(m){var b=Xa(m);return gr(b)&&(b=s),La(ws(m,1,gr,!0),Xs(b,2))}),ai=kn(function(m){var b=Xa(m);return b=typeof b=="function"?b:s,La(ws(m,1,gr,!0),s,b)});function Cr(m){return m&&m.length?La(m):[]}function W0(m,b){return m&&m.length?La(m,Xs(b,2)):[]}function Y0(m,b){return b=typeof b=="function"?b:s,m&&m.length?La(m,s,b):[]}function S_(m){if(!(m&&m.length))return[];var b=0;return m=ml(m,function(E){if(gr(E))return b=Bs(E.length,b),!0}),Eu(b,function(E){return Fr(m,_l(E))})}function by(m,b){if(!(m&&m.length))return[];var E=S_(m);return b==null?E:Fr(E,function(z){return wi(b,s,z)})}var Z0=kn(function(m,b){return gr(m)?ps(m,b):[]}),xy=kn(function(m){return ep(ml(m,gr))}),qd=kn(function(m){var b=Xa(m);return gr(b)&&(b=s),ep(ml(m,gr),Xs(b,2))}),Hd=kn(function(m){var b=Xa(m);return b=typeof b=="function"?b:s,ep(ml(m,gr),s,b)}),X0=kn(S_);function li(m,b){return Cf(m||[],b||[],ut)}function Rf(m,b){return Cf(m||[],b||[],Wa)}var au=kn(function(m){var b=m.length,E=b>1?m[b-1]:s;return E=typeof E=="function"?(m.pop(),E):s,by(m,E)});function $f(m){var b=Ie(m);return b.__chain__=!0,b}function C_(m,b){return b(m),m}function cp(m,b){return b(m)}var up=fc(function(m){var b=m.length,E=b?m[0]:0,z=this.__wrapped__,ie=function(Ee){return Xt(Ee,m)};return b>1||this.__actions__.length||!(z instanceof un)||!ca(E)?this.thru(ie):(z=z.slice(E,+E+(b?1:0)),z.__actions__.push({func:cp,args:[ie],thisArg:s}),new ji(z,this.__chain__).thru(function(Ee){return b&&!Ee.length&&Ee.push(s),Ee}))});function lu(){return $f(this)}function K0(){return new ji(this.value(),this.__chain__)}function J0(){this.__values__===s&&(this.__values__=k_(this.value()));var m=this.__index__>=this.__values__.length,b=m?s:this.__values__[this.__index__++];return{done:m,value:b}}function vw(){return this}function Ci(m){for(var b,E=this;E instanceof Vi;){var z=my(E);z.__index__=0,z.__values__=s,b?ie.__wrapped__=z:b=z;var ie=z;E=E.__wrapped__}return ie.__wrapped__=m,b}function qu(){var m=this.__wrapped__;if(m instanceof un){var b=m;return this.__actions__.length&&(b=new un(this)),b=b.reverse(),b.__actions__.push({func:cp,args:[ju],thisArg:s}),new ji(b,this.__chain__)}return this.thru(ju)}function Q0(){return ty(this.__wrapped__,this.__actions__)}var i=i_(function(m,b,E){Wn.call(m,E)?++m[E]:Gt(m,E,1)});function l(m,b,E){var z=Ys(m)?fl:qs;return E&&$o(m,b,E)&&(b=s),z(m,Xs(b,3))}function c(m,b){var E=Ys(m)?ml:Vs;return E(m,Xs(b,3))}var _=np(kf),x=np(Ud);function w(m,b){return ws(Oe(m,b),1)}function T(m,b){return ws(Oe(m,b),_t)}function $(m,b,E){return E=E===s?1:gn(E),ws(Oe(m,b),E)}function D(m,b){var E=Ys(m)?ki:Ls;return E(m,Xs(b,3))}function V(m,b){var E=Ys(m)?Gc:Qs;return E(m,Xs(b,3))}var Z=i_(function(m,b,E){Wn.call(m,E)?m[E].push(b):Gt(m,E,[b])});function K(m,b,E,z){m=Nn(m)?m:Jd(m),E=E&&!z?gn(E):0;var ie=m.length;return E<0&&(E=Bs(ie+E,0)),Zd(m)?E<=ie&&m.indexOf(b,E)>-1:!!ie&&Yc(m,b,E)>-1}var le=kn(function(m,b,E){var z=-1,ie=typeof b=="function",Ee=Nn(m)?Mt(m.length):[];return Ls(m,function(Ke){Ee[++z]=ie?wi(b,Ke,E):aa(Ke,b,E)}),Ee}),_e=i_(function(m,b,E){Gt(m,E,b)});function Oe(m,b){var E=Ys(m)?Fr:Xm;return E(m,Xs(b,3))}function Be(m,b,E,z){return m==null?[]:(Ys(b)||(b=b==null?[]:[b]),E=z?s:E,Ys(E)||(E=E==null?[]:[E]),Uu(m,b,E))}var Xe=i_(function(m,b,E){m[E?0:1].push(b)},function(){return[[],[]]});function He(m,b,E){var z=Ys(m)?Dh:df,ie=arguments.length<3;return z(m,Xs(b,4),E,ie,Ls)}function lt(m,b,E){var z=Ys(m)?jm:df,ie=arguments.length<3;return z(m,Xs(b,4),E,ie,Qs)}function ft(m,b){var E=Ys(m)?ml:Vs;return E(m,mr(Xs(b,3)))}function yt(m){var b=Ys(m)?Ye:Jm;return b(m)}function xt(m,b,E){(E?$o(m,b,E):b===s)?b=1:b=gn(b);var z=Ys(m)?Le:h0;return z(m,b)}function Pt(m){var b=Ys(m)?Ze:jx;return b(m)}function Yt(m){if(m==null)return 0;if(Nn(m))return Zd(m)?Ru(m):m.length;var b=Ro(m);return b==Je||b==Ct?m.size:Cl(m).length}function Qt(m,b,E){var z=Ys(m)?Bh:qx;return E&&$o(m,b,E)&&(b=s),z(m,Xs(b,3))}var Is=kn(function(m,b){if(m==null)return[];var E=b.length;return E>1&&$o(m,b[0],b[1])?b=[]:E>2&&$o(b[0],b[1],b[2])&&(b=[b[0]]),Uu(m,ws(b,1),[])}),ls=Yh||function(){return bi.Date.now()};function Ms(m,b){if(typeof b!="function")throw new no(o);return m=gn(m),function(){if(--m<1)return b.apply(this,arguments)}}function us(m,b,E){return b=E?s:b,b=m&&b==null?m.length:b,pc(m,ve,s,s,s,s,b)}function sn(m,b){var E;if(typeof b!="function")throw new no(o);return m=gn(m),function(){return--m>0&&(E=b.apply(this,arguments)),m<=1&&(b=s),E}}var Fs=kn(function(m,b,E){var z=q;if(E.length){var ie=Ao(E,Fd(Fs));z|=te}return pc(m,z,b,E,ie)}),bs=kn(function(m,b,E){var z=q|ce;if(E.length){var ie=Ao(E,Fd(bs));z|=te}return pc(b,z,m,E,ie)});function an(m,b,E){b=E?s:b;var z=pc(m,W,s,s,s,s,s,b);return z.placeholder=an.placeholder,z}function Ks(m,b,E){b=E?s:b;var z=pc(m,Ce,s,s,s,s,s,b);return z.placeholder=Ks.placeholder,z}function _n(m,b,E){var z,ie,Ee,Ke,ot,mt,Wt=0,Zt=!1,Jt=!1,Ts=!0;if(typeof m!="function")throw new no(o);b=No(b)||0,Or(E)&&(Zt=!!E.leading,Jt="maxWait"in E,Ee=Jt?Bs(No(E.maxWait)||0,b):Ee,Ts="trailing"in E?!!E.trailing:Ts);function Gs(Wi){var pu=z,Qd=ie;return z=ie=s,Wt=Wi,Ke=m.apply(Qd,pu),Ke}function ln(Wi){return Wt=Wi,ot=zd(Zn,b),Zt?Gs(Wi):Ke}function Dn(Wi){var pu=Wi-mt,Qd=Wi-Wt,LI=b-pu;return Jt?Rr(LI,Ee-Qd):LI}function cn(Wi){var pu=Wi-mt,Qd=Wi-Wt;return mt===s||pu>=b||pu<0||Jt&&Qd>=Ee}function Zn(){var Wi=ls();if(cn(Wi))return rr(Wi);ot=zd(Zn,Dn(Wi))}function rr(Wi){return ot=s,Ts&&z?Gs(Wi):(z=ie=s,Ke)}function kl(){ot!==s&&s_(ot),Wt=0,z=mt=ie=ot=s}function Da(){return ot===s?Ke:rr(ls())}function Pl(){var Wi=ls(),pu=cn(Wi);if(z=arguments,ie=this,mt=Wi,pu){if(ot===s)return ln(mt);if(Jt)return s_(ot),ot=zd(Zn,b),Gs(mt)}return ot===s&&(ot=zd(Zn,b)),Ke}return Pl.cancel=kl,Pl.flush=Da,Pl}var Ps=kn(function(m,b){return xn(m,1,b)}),Pn=kn(function(m,b,E){return xn(m,No(b)||0,E)});function Ir(m){return pc(m,ne)}function Tr(m,b){if(typeof m!="function"||b!=null&&typeof b!="function")throw new no(o);var E=function(){var z=arguments,ie=b?b.apply(this,z):z[0],Ee=E.cache;if(Ee.has(ie))return Ee.get(ie);var Ke=m.apply(this,z);return E.cache=Ee.set(ie,Ke)||Ee,Ke};return E.cache=new(Tr.Cache||ia),E}Tr.Cache=ia;function mr(m){if(typeof m!="function")throw new no(o);return function(){var b=arguments;switch(b.length){case 0:return!m.call(this);case 1:return!m.call(this,b[0]);case 2:return!m.call(this,b[0],b[1]);case 3:return!m.call(this,b[0],b[1],b[2])}return!m.apply(this,b)}}function Ar(m){return sn(2,m)}var zr=If(function(m,b){b=b.length==1&&Ys(b[0])?Fr(b[0],To(Xs())):Fr(ws(b,1),To(Xs()));var E=b.length;return kn(function(z){for(var ie=-1,Ee=Rr(z.length,E);++ie<Ee;)z[ie]=b[ie].call(this,z[ie]);return wi(m,this,z)})}),si=kn(function(m,b){var E=Ao(b,Fd(si));return pc(m,te,s,b,E)}),ci=kn(function(m,b){var E=Ao(b,Fd(ci));return pc(m,oe,s,b,E)}),ao=fc(function(m,b){return pc(m,ee,s,s,s,b)});function Ii(m,b){if(typeof m!="function")throw new no(o);return b=b===s?b:gn(b),kn(m,b)}function lo(m,b){if(typeof m!="function")throw new no(o);return b=b==null?0:Bs(gn(b),0),kn(function(E){var z=E[b],ie=dc(E,0,b);return z&&Aa(ie,z),wi(m,this,ie)})}function Hr(m,b,E){var z=!0,ie=!0;if(typeof m!="function")throw new no(o);return Or(E)&&(z="leading"in E?!!E.leading:z,ie="trailing"in E?!!E.trailing:ie),_n(m,b,{leading:z,maxWait:b,trailing:ie})}function Ti(m){return us(m,1)}function fn(m,b){return si(t_(b),m)}function nr(){if(!arguments.length)return[];var m=arguments[0];return Ys(m)?m:[m]}function Yn(m){return vs(m,O)}function In(m,b){return b=typeof b=="function"?b:s,vs(m,O,b)}function vo(m){return vs(m,C|O)}function qi(m,b){return b=typeof b=="function"?b:s,vs(m,C|O,b)}function _r(m,b){return b==null||ks(m,b,Gi(b))}function er(m,b){return m===b||m!==m&&b!==b}var Hi=l_(qa),Rn=l_(function(m,b){return m>=b}),Lo=su(function(){return arguments}())?su:function(m){return Lr(m)&&Wn.call(m,"callee")&&!ss.call(m,"callee")},Ys=Mt.isArray,mc=lf?To(lf):$d;function Nn(m){return m!=null&&Qa(m.length)&&!Ja(m)}function gr(m){return Lr(m)&&Nn(m)}function Ka(m){return m===!0||m===!1||Lr(m)&&lr(m)==ct}var Na=gf||Lw,Gd=xi?To(xi):Ha;function dp(m){return Lr(m)&&m.nodeType===1&&!du(m)}function cu(m){if(m==null)return!0;if(Nn(m)&&(Ys(m)||typeof m=="string"||typeof m.splice=="function"||Na(m)||_c(m)||Lo(m)))return!m.length;var b=Ro(m);if(b==Je||b==Ct)return!m.size;if(iu(m))return!Cl(m).length;for(var E in m)if(Wn.call(m,E))return!1;return!0}function hp(m,b){return wl(m,b)}function I_(m,b,E){E=typeof E=="function"?E:s;var z=E?E(m,b):s;return z===s?wl(m,b,s,E):!!z}function Hu(m){if(!Lr(m))return!1;var b=lr(m);return b==rt||b==ht||typeof m.message=="string"&&typeof m.name=="string"&&!du(m)}function Of(m){return typeof m=="number"&&Zh(m)}function Ja(m){if(!Or(m))return!1;var b=lr(m);return b==fe||b==ye||b==qe||b==Nt}function Lf(m){return typeof m=="number"&&m==gn(m)}function Qa(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=F}function Or(m){var b=typeof m;return m!=null&&(b=="object"||b=="function")}function Lr(m){return m!=null&&typeof m=="object"}var uu=Nh?To(Nh):_i;function pp(m,b){return m===b||$a(m,b,u_(b))}function T_(m,b,E){return E=typeof E=="function"?E:s,$a(m,b,u_(b),E)}function A_(m){return fp(m)&&m!=+m}function Nf(m){if(p_(m))throw new on(a);return Sl(m)}function Df(m){return m===null}function M_(m){return m==null}function fp(m){return typeof m=="number"||Lr(m)&&lr(m)==at}function du(m){if(!Lr(m)||lr(m)!=Et)return!1;var b=zi(m);if(b===null)return!0;var E=Wn.call(b,"constructor")&&b.constructor;return typeof E=="function"&&E instanceof E&&sc.call(E)==Zm}var Wd=hl?To(hl):nu;function E_(m){return Lf(m)&&m>=-F&&m<=F}var Yd=pl?To(pl):Ln;function Zd(m){return typeof m=="string"||!Ys(m)&&Lr(m)&&lr(m)==Bt}function co(m){return typeof m=="symbol"||Lr(m)&&lr(m)==Kt}var _c=Zl?To(Zl):qo;function Xd(m){return m===s}function Bf(m){return Lr(m)&&Ro(m)==ts}function mp(m){return Lr(m)&&lr(m)==Us}var wy=l_(Fu),e1=l_(function(m,b){return m<=b});function k_(m){if(!m)return[];if(Nn(m))return Zd(m)?Mo(m):la(m);if(Kc&&m[Kc])return Gm(m[Kc]());var b=Ro(m),E=b==Je?zh:b==Ct?ec:Jd;return E(m)}function gc(m){if(!m)return m===0?m:0;if(m=No(m),m===_t||m===-_t){var b=m<0?-1:1;return b*j}return m===m?m:0}function gn(m){var b=gc(m),E=b%1;return b===b?E?b-E:b:0}function t1(m){return m?as(gn(m),0,Y):0}function No(m){if(typeof m=="number")return m;if(co(m))return G;if(Or(m)){var b=typeof m.valueOf=="function"?m.valueOf():m;m=Or(b)?b+"":b}if(typeof m!="string")return m===0?m:+m;m=Zc(m);var E=ns.test(m);return E||rn.test(m)?of(m.slice(2),E?2:8):fs.test(m)?G:+m}function Ur(m){return hc(m,Oi(m))}function El(m){return m?as(gn(m),-F,F):m===0?m:0}function yr(m){return m==null?"":Oa(m)}var Gu=sp(function(m,b){if(iu(b)||Nn(b)){hc(b,Gi(b),m);return}for(var E in b)Wn.call(b,E)&&ut(m,E,b[E])}),P_=sp(function(m,b){hc(b,Oi(b),m)}),Ff=sp(function(m,b,E,z){hc(b,Oi(b),m,z)}),R_=sp(function(m,b,E,z){hc(b,Gi(b),m,z)}),yc=fc(Xt);function $_(m,b){var E=ko(m);return b==null?E:It(E,b)}var zf=kn(function(m,b){m=Es(m);var E=-1,z=b.length,ie=z>2?b[2]:s;for(ie&&$o(b[0],b[1],ie)&&(z=1);++E<z;)for(var Ee=b[E],Ke=Oi(Ee),ot=-1,mt=Ke.length;++ot<mt;){var Wt=Ke[ot],Zt=m[Wt];(Zt===s||er(Zt,$u[Wt])&&!Wn.call(m,Wt))&&(m[Wt]=Ee[Wt])}return m}),O_=kn(function(m){return m.push(s,S0),wi(Kd,s,m)});function L_(m,b){return Jl(m,Xs(b,3),kr)}function Sy(m,b){return Jl(m,Xs(b,3),oi)}function s1(m,b){return m==null?m:ei(m,Xs(b,3),Oi)}function Uf(m,b){return m==null?m:$r(m,Xs(b,3),Oi)}function n1(m,b){return m&&kr(m,Xs(b,3))}function r1(m,b){return m&&oi(m,Xs(b,3))}function i1(m){return m==null?[]:fr(m,Gi(m))}function o1(m){return m==null?[]:fr(m,Oi(m))}function N_(m,b,E){var z=m==null?s:ur(m,b);return z===s?E:z}function ua(m,b){return m!=null&&A0(m,b,go)}function _p(m,b){return m!=null&&A0(m,b,Ra)}var a1=v0(function(m,b,E){b!=null&&typeof b.toString!="function"&&(b=nc.call(b)),m[b]=E},kw(el)),vc=v0(function(m,b,E){b!=null&&typeof b.toString!="function"&&(b=nc.call(b)),Wn.call(m,b)?m[b].push(E):m[b]=[E]},Xs),bw=kn(aa);function Gi(m){return Nn(m)?De(m):Cl(m)}function Oi(m){return Nn(m)?De(m,!0):Xg(m)}function gp(m,b){var E={};return b=Xs(b,3),kr(m,function(z,ie,Ee){Gt(E,b(z,ie,Ee),z)}),E}function yp(m,b){var E={};return b=Xs(b,3),kr(m,function(z,ie,Ee){Gt(E,ie,b(z,ie,Ee))}),E}var vp=sp(function(m,b,E){Il(m,b,E)}),Kd=sp(function(m,b,E,z){Il(m,b,E,z)}),l1=fc(function(m,b){var E={};if(m==null)return E;var z=!1;b=Fr(b,function(Ee){return Ee=ru(Ee,m),z||(z=Ee.length>1),Ee}),hc(m,ly(m),E),z&&(E=vs(E,C|I|O,C0));for(var ie=b.length;ie--;)ey(E,b[ie]);return E});function c1(m,b){return Cy(m,mr(Xs(b)))}var u1=fc(function(m,b){return m==null?{}:Po(m,b)});function Cy(m,b){if(m==null)return{};var E=Fr(ly(m),function(z){return[z]});return b=Xs(b),c0(m,E,function(z,ie){return b(z,ie[0])})}function Iy(m,b,E){b=ru(b,m);var z=-1,ie=b.length;for(ie||(ie=1,m=s);++z<ie;){var Ee=m==null?s:m[Ml(b[z])];Ee===s&&(z=ie,Ee=E),m=Ja(Ee)?Ee.call(m):Ee}return m}function Ty(m,b,E){return m==null?m:Wa(m,b,E)}function hu(m,b,E,z){return z=typeof z=="function"?z:s,m==null?m:Wa(m,b,E,z)}var Ay=w0(Gi),D_=w0(Oi);function My(m,b,E){var z=Ys(m),ie=z||Na(m)||_c(m);if(b=Xs(b,4),E==null){var Ee=m&&m.constructor;ie?E=z?new Ee:[]:Or(m)?E=Ja(Ee)?ko(zi(m)):{}:E={}}return(ie?ki:kr)(m,function(Ke,ot,mt){return b(E,Ke,ot,mt)}),E}function d1(m,b){return m==null?!0:ey(m,b)}function Ey(m,b,E){return m==null?m:ti(m,b,t_(E))}function h1(m,b,E,z){return z=typeof z=="function"?z:s,m==null?m:ti(m,b,t_(E),z)}function Jd(m){return m==null?[]:hf(m,Gi(m))}function ky(m){return m==null?[]:hf(m,Oi(m))}function p1(m,b,E){return E===s&&(E=b,b=s),E!==s&&(E=No(E),E=E===E?E:0),b!==s&&(b=No(b),b=b===b?b:0),as(No(m),b,E)}function Vf(m,b,E){return b=gc(b),E===s?(E=b,b=0):E=gc(E),m=No(m),oa(m,b,E)}function f1(m,b,E){if(E&&typeof E!="boolean"&&$o(m,b,E)&&(b=E=s),E===s&&(typeof b=="boolean"?(E=b,b=s):typeof m=="boolean"&&(E=m,m=s)),m===s&&b===s?(m=0,b=1):(m=gc(m),b===s?(b=m,m=0):b=gc(b)),m>b){var z=m;m=b,b=z}if(E||m%1||b%1){var ie=rc();return Rr(m+ie*(b-m+Yg("1e-"+((ie+"").length-1))),b)}return Jg(m,b)}var B_=Al(function(m,b,E){return b=b.toLowerCase(),m+(E?m1(b):b)});function m1(m){return Ew(yr(m).toLowerCase())}function Py(m){return m=yr(m),m&&m.replace(mn,Fh).replace($h,"")}function xw(m,b,E){m=yr(m),b=Oa(b);var z=m.length;E=E===s?z:as(gn(E),0,z);var ie=E;return E-=b.length,E>=0&&m.slice(E,ie)==b}function ww(m){return m=yr(m),m&&yd.test(m)?m.replace(Va,Ad):m}function Sw(m){return m=yr(m),m&&st.test(m)?m.replace(et,"\\$&"):m}var Cw=Al(function(m,b,E){return m+(E?"-":"")+b.toLowerCase()}),Iw=Al(function(m,b,E){return m+(E?" ":"")+b.toLowerCase()}),Tw=y0("toLowerCase");function Aw(m,b,E){m=yr(m),b=gn(b);var z=b?Ru(m):0;if(!b||z>=b)return m;var ie=(b-z)/2;return Af(kd(ie),E)+m+Af(ta(ie),E)}function Mw(m,b,E){m=yr(m),b=gn(b);var z=b?Ru(m):0;return b&&z<b?m+Af(b-z,E):m}function bc(m,b,E){m=yr(m),b=gn(b);var z=b?Ru(m):0;return b&&z<b?Af(b-z,E)+m:m}function F_(m,b,E){return E||b==null?b=0:b&&(b=+b),Ri(yr(m).replace(xe,""),b||0)}function _1(m,b,E){return(E?$o(m,b,E):b===s)?b=1:b=gn(b),Sf(yr(m),b)}function jf(){var m=arguments,b=yr(m[0]);return m.length<3?b:b.replace(m[1],m[2])}var g1=Al(function(m,b,E){return m+(E?"_":"")+b.toLowerCase()});function X$(m,b,E){return E&&typeof E!="number"&&$o(m,b,E)&&(b=E=s),E=E===s?Y:E>>>0,E?(m=yr(m),m&&(typeof b=="string"||b!=null&&!Wd(b))&&(b=Oa(b),!b&&Ma(m))?dc(Mo(m),0,E):m.split(b,E)):[]}var K$=Al(function(m,b,E){return m+(E?" ":"")+Ew(b)});function J$(m,b,E){return m=yr(m),E=E==null?0:as(gn(E),0,m.length),b=Oa(b),m.slice(E,E+b.length)==b}function Q$(m,b,E){var z=Ie.templateSettings;E&&$o(m,b,E)&&(b=s),m=yr(m),b=Ff({},b,z,oy);var ie=Ff({},b.imports,z.imports,oy),Ee=Gi(ie),Ke=hf(ie,Ee),ot,mt,Wt=0,Zt=b.interpolate||Fn,Jt="__p += '",Ts=sr((b.escape||Fn).source+"|"+Zt.source+"|"+(Zt===ae?ms:Fn).source+"|"+(b.evaluate||Fn).source+"|$","g"),Gs="//# sourceURL="+(Wn.call(b,"sourceURL")?(b.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Wl+"]")+`
`;m.replace(Ts,function(cn,Zn,rr,kl,Da,Pl){return rr||(rr=kl),Jt+=m.slice(Wt,Pl).replace(hn,Pu),Zn&&(ot=!0,Jt+=`' +
__e(`+Zn+`) +
'`),Da&&(mt=!0,Jt+=`';
`+Da+`;
__p += '`),rr&&(Jt+=`' +
((__t = (`+rr+`)) == null ? '' : __t) +
'`),Wt=Pl+cn.length,cn}),Jt+=`';
`;var ln=Wn.call(b,"variable")&&b.variable;if(!ln)Jt=`with (obj) {
`+Jt+`
}
`;else if(Vt.test(ln))throw new on(d);Jt=(mt?Jt.replace(Kn,""):Jt).replace(Eh,"$1").replace(Vc,"$1;"),Jt="function("+(ln||"obj")+`) {
`+(ln?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(ot?", __e = _.escape":"")+(mt?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Jt+`return __p
}`;var Dn=$I(function(){return En(Ee,Gs+"return "+Jt).apply(s,Ke)});if(Dn.source=Jt,Hu(Dn))throw Dn;return Dn}function e5(m){return yr(m).toLowerCase()}function t5(m){return yr(m).toUpperCase()}function s5(m,b,E){if(m=yr(m),m&&(E||b===s))return Zc(m);if(!m||!(b=Oa(b)))return m;var z=Mo(m),ie=Mo(b),Ee=Id(z,ie),Ke=Xc(z,ie)+1;return dc(z,Ee,Ke).join("")}function n5(m,b,E){if(m=yr(m),m&&(E||b===s))return m.slice(0,jh(m)+1);if(!m||!(b=Oa(b)))return m;var z=Mo(m),ie=Xc(z,Mo(b))+1;return dc(z,0,ie).join("")}function r5(m,b,E){if(m=yr(m),m&&(E||b===s))return m.replace(xe,"");if(!m||!(b=Oa(b)))return m;var z=Mo(m),ie=Id(z,Mo(b));return dc(z,ie).join("")}function i5(m,b){var E=Se,z=Ue;if(Or(b)){var ie="separator"in b?b.separator:ie;E="length"in b?gn(b.length):E,z="omission"in b?Oa(b.omission):z}m=yr(m);var Ee=m.length;if(Ma(m)){var Ke=Mo(m);Ee=Ke.length}if(E>=Ee)return m;var ot=E-Ru(z);if(ot<1)return z;var mt=Ke?dc(Ke,0,ot).join(""):m.slice(0,ot);if(ie===s)return mt+z;if(Ke&&(ot+=mt.length-ot),Wd(ie)){if(m.slice(ot).search(ie)){var Wt,Zt=mt;for(ie.global||(ie=sr(ie.source,yr(At.exec(ie))+"g")),ie.lastIndex=0;Wt=ie.exec(Zt);)var Jt=Wt.index;mt=mt.slice(0,Jt===s?ot:Jt)}}else if(m.indexOf(Oa(ie),ot)!=ot){var Ts=mt.lastIndexOf(ie);Ts>-1&&(mt=mt.slice(0,Ts))}return mt+z}function o5(m){return m=yr(m),m&&Tu.test(m)?m.replace(Ua,Wm):m}var a5=Al(function(m,b,E){return m+(E?" ":"")+b.toUpperCase()}),Ew=y0("toUpperCase");function RI(m,b,E){return m=yr(m),b=E?s:b,b===s?Ea(m)?mf(m):Kl(m):m.match(b)||[]}var $I=kn(function(m,b){try{return wi(m,s,b)}catch(E){return Hu(E)?E:new on(E)}}),l5=fc(function(m,b){return ki(b,function(E){E=Ml(E),Gt(m,E,Fs(m[E],m))}),m});function c5(m){var b=m==null?0:m.length,E=Xs();return m=b?Fr(m,function(z){if(typeof z[1]!="function")throw new no(o);return[E(z[0]),z[1]]}):[],kn(function(z){for(var ie=-1;++ie<b;){var Ee=m[ie];if(wi(Ee[0],this,z))return wi(Ee[1],this,z)}})}function u5(m){return $s(vs(m,C))}function kw(m){return function(){return m}}function d5(m,b){return m==null||m!==m?b:m}var h5=Za(),p5=Za(!0);function el(m){return m}function Pw(m){return io(typeof m=="function"?m:vs(m,C))}function f5(m){return zu(vs(m,C))}function m5(m,b){return wf(m,vs(b,C))}var _5=kn(function(m,b){return function(E){return aa(E,m,b)}}),g5=kn(function(m,b){return function(E){return aa(m,E,b)}});function Rw(m,b,E){var z=Gi(b),ie=fr(b,z);E==null&&!(Or(b)&&(ie.length||!z.length))&&(E=b,b=m,m=this,ie=fr(b,Gi(b)));var Ee=!(Or(E)&&"chain"in E)||!!E.chain,Ke=Ja(m);return ki(ie,function(ot){var mt=b[ot];m[ot]=mt,Ke&&(m.prototype[ot]=function(){var Wt=this.__chain__;if(Ee||Wt){var Zt=m(this.__wrapped__),Jt=Zt.__actions__=la(this.__actions__);return Jt.push({func:mt,args:arguments,thisArg:m}),Zt.__chain__=Wt,Zt}return mt.apply(m,Aa([this.value()],arguments))})}),m}function y5(){return bi._===this&&(bi._=Jr),this}function $w(){}function v5(m){return m=gn(m),kn(function(b){return Km(b,m)})}var b5=Dd(Fr),x5=Dd(fl),w5=Dd(Bh);function OI(m){return cy(m)?_l(Ml(m)):u0(m)}function S5(m){return function(b){return m==null?s:ur(m,b)}}var C5=b0(),I5=b0(!0);function Ow(){return[]}function Lw(){return!1}function T5(){return{}}function A5(){return""}function M5(){return!0}function E5(m,b){if(m=gn(m),m<1||m>F)return[];var E=Y,z=Rr(m,Y);b=Xs(b),m-=Y;for(var ie=Eu(z,b);++E<m;)b(E);return ie}function k5(m){return Ys(m)?Fr(m,Ml):co(m)?[m]:la(__(yr(m)))}function P5(m){var b=++vl;return yr(m)+b}var R5=a_(function(m,b){return m+b},0),$5=c_("ceil"),O5=a_(function(m,b){return m/b},1),L5=c_("floor");function N5(m){return m&&m.length?zs(m,el,qa):s}function D5(m,b){return m&&m.length?zs(m,Xs(b,2),qa):s}function B5(m){return uf(m,el)}function F5(m,b){return uf(m,Xs(b,2))}function z5(m){return m&&m.length?zs(m,el,Fu):s}function U5(m,b){return m&&m.length?zs(m,Xs(b,2),Fu):s}var V5=a_(function(m,b){return m*b},1),j5=c_("round"),q5=a_(function(m,b){return m-b},0);function H5(m){return m&&m.length?tr(m,el):0}function G5(m,b){return m&&m.length?tr(m,Xs(b,2)):0}return Ie.after=Ms,Ie.ary=us,Ie.assign=Gu,Ie.assignIn=P_,Ie.assignInWith=Ff,Ie.assignWith=R_,Ie.at=yc,Ie.before=sn,Ie.bind=Fs,Ie.bindAll=l5,Ie.bindKey=bs,Ie.castArray=nr,Ie.chain=$f,Ie.chunk=R0,Ie.compact=$0,Ie.concat=O0,Ie.cond=c5,Ie.conforms=u5,Ie.constant=kw,Ie.countBy=i,Ie.create=$_,Ie.curry=an,Ie.curryRight=Ks,Ie.debounce=_n,Ie.defaults=zf,Ie.defaultsDeep=O_,Ie.defer=Ps,Ie.delay=Pn,Ie.difference=rw,Ie.differenceBy=iw,Ie.differenceWith=L0,Ie.drop=N0,Ie.dropRight=g_,Ie.dropRightWhile=D0,Ie.dropWhile=y_,Ie.fill=v_,Ie.filter=c,Ie.flatMap=w,Ie.flatMapDeep=T,Ie.flatMapDepth=$,Ie.flatten=B0,Ie.flattenDeep=ow,Ie.flattenDepth=aw,Ie.flip=Ir,Ie.flow=h5,Ie.flowRight=p5,Ie.fromPairs=ap,Ie.functions=i1,Ie.functionsIn=o1,Ie.groupBy=Z,Ie.initial=_y,Ie.intersection=z0,Ie.intersectionBy=U0,Ie.intersectionWith=lw,Ie.invert=a1,Ie.invertBy=vc,Ie.invokeMap=le,Ie.iteratee=Pw,Ie.keyBy=_e,Ie.keys=Gi,Ie.keysIn=Oi,Ie.map=Oe,Ie.mapKeys=gp,Ie.mapValues=yp,Ie.matches=f5,Ie.matchesProperty=m5,Ie.memoize=Tr,Ie.merge=vp,Ie.mergeWith=Kd,Ie.method=_5,Ie.methodOf=g5,Ie.mixin=Rw,Ie.negate=mr,Ie.nthArg=v5,Ie.omit=l1,Ie.omitBy=c1,Ie.once=Ar,Ie.orderBy=Be,Ie.over=b5,Ie.overArgs=zr,Ie.overEvery=x5,Ie.overSome=w5,Ie.partial=si,Ie.partialRight=ci,Ie.partition=Xe,Ie.pick=u1,Ie.pickBy=Cy,Ie.property=OI,Ie.propertyOf=S5,Ie.pull=uw,Ie.pullAll=Vd,Ie.pullAllBy=Pf,Ie.pullAllWith=Qn,Ie.pullAt=dw,Ie.range=C5,Ie.rangeRight=I5,Ie.rearg=ao,Ie.reject=ft,Ie.remove=yy,Ie.rest=Ii,Ie.reverse=ju,Ie.sampleSize=xt,Ie.set=Ty,Ie.setWith=hu,Ie.shuffle=Pt,Ie.slice=hw,Ie.sortBy=Is,Ie.sortedUniq=V0,Ie.sortedUniqBy=j0,Ie.split=X$,Ie.spread=lo,Ie.tail=q0,Ie.take=H0,Ie.takeRight=w_,Ie.takeRightWhile=jd,Ie.takeWhile=vy,Ie.tap=C_,Ie.throttle=Hr,Ie.thru=cp,Ie.toArray=k_,Ie.toPairs=Ay,Ie.toPairsIn=D_,Ie.toPath=k5,Ie.toPlainObject=Ur,Ie.transform=My,Ie.unary=Ti,Ie.union=lp,Ie.unionBy=G0,Ie.unionWith=ai,Ie.uniq=Cr,Ie.uniqBy=W0,Ie.uniqWith=Y0,Ie.unset=d1,Ie.unzip=S_,Ie.unzipWith=by,Ie.update=Ey,Ie.updateWith=h1,Ie.values=Jd,Ie.valuesIn=ky,Ie.without=Z0,Ie.words=RI,Ie.wrap=fn,Ie.xor=xy,Ie.xorBy=qd,Ie.xorWith=Hd,Ie.zip=X0,Ie.zipObject=li,Ie.zipObjectDeep=Rf,Ie.zipWith=au,Ie.entries=Ay,Ie.entriesIn=D_,Ie.extend=P_,Ie.extendWith=Ff,Rw(Ie,Ie),Ie.add=R5,Ie.attempt=$I,Ie.camelCase=B_,Ie.capitalize=m1,Ie.ceil=$5,Ie.clamp=p1,Ie.clone=Yn,Ie.cloneDeep=vo,Ie.cloneDeepWith=qi,Ie.cloneWith=In,Ie.conformsTo=_r,Ie.deburr=Py,Ie.defaultTo=d5,Ie.divide=O5,Ie.endsWith=xw,Ie.eq=er,Ie.escape=ww,Ie.escapeRegExp=Sw,Ie.every=l,Ie.find=_,Ie.findIndex=kf,Ie.findKey=L_,Ie.findLast=x,Ie.findLastIndex=Ud,Ie.findLastKey=Sy,Ie.floor=L5,Ie.forEach=D,Ie.forEachRight=V,Ie.forIn=s1,Ie.forInRight=Uf,Ie.forOwn=n1,Ie.forOwnRight=r1,Ie.get=N_,Ie.gt=Hi,Ie.gte=Rn,Ie.has=ua,Ie.hasIn=_p,Ie.head=b_,Ie.identity=el,Ie.includes=K,Ie.indexOf=F0,Ie.inRange=Vf,Ie.invoke=bw,Ie.isArguments=Lo,Ie.isArray=Ys,Ie.isArrayBuffer=mc,Ie.isArrayLike=Nn,Ie.isArrayLikeObject=gr,Ie.isBoolean=Ka,Ie.isBuffer=Na,Ie.isDate=Gd,Ie.isElement=dp,Ie.isEmpty=cu,Ie.isEqual=hp,Ie.isEqualWith=I_,Ie.isError=Hu,Ie.isFinite=Of,Ie.isFunction=Ja,Ie.isInteger=Lf,Ie.isLength=Qa,Ie.isMap=uu,Ie.isMatch=pp,Ie.isMatchWith=T_,Ie.isNaN=A_,Ie.isNative=Nf,Ie.isNil=M_,Ie.isNull=Df,Ie.isNumber=fp,Ie.isObject=Or,Ie.isObjectLike=Lr,Ie.isPlainObject=du,Ie.isRegExp=Wd,Ie.isSafeInteger=E_,Ie.isSet=Yd,Ie.isString=Zd,Ie.isSymbol=co,Ie.isTypedArray=_c,Ie.isUndefined=Xd,Ie.isWeakMap=Bf,Ie.isWeakSet=mp,Ie.join=cw,Ie.kebabCase=Cw,Ie.last=Xa,Ie.lastIndexOf=x_,Ie.lowerCase=Iw,Ie.lowerFirst=Tw,Ie.lt=wy,Ie.lte=e1,Ie.max=N5,Ie.maxBy=D5,Ie.mean=B5,Ie.meanBy=F5,Ie.min=z5,Ie.minBy=U5,Ie.stubArray=Ow,Ie.stubFalse=Lw,Ie.stubObject=T5,Ie.stubString=A5,Ie.stubTrue=M5,Ie.multiply=V5,Ie.nth=gy,Ie.noConflict=y5,Ie.noop=$w,Ie.now=ls,Ie.pad=Aw,Ie.padEnd=Mw,Ie.padStart=bc,Ie.parseInt=F_,Ie.random=f1,Ie.reduce=He,Ie.reduceRight=lt,Ie.repeat=_1,Ie.replace=jf,Ie.result=Iy,Ie.round=j5,Ie.runInContext=dt,Ie.sample=yt,Ie.size=Yt,Ie.snakeCase=g1,Ie.some=Qt,Ie.sortedIndex=pw,Ie.sortedIndexBy=fw,Ie.sortedIndexOf=mw,Ie.sortedLastIndex=_w,Ie.sortedLastIndexBy=gw,Ie.sortedLastIndexOf=yw,Ie.startCase=K$,Ie.startsWith=J$,Ie.subtract=q5,Ie.sum=H5,Ie.sumBy=G5,Ie.template=Q$,Ie.times=E5,Ie.toFinite=gc,Ie.toInteger=gn,Ie.toLength=t1,Ie.toLower=e5,Ie.toNumber=No,Ie.toSafeInteger=El,Ie.toString=yr,Ie.toUpper=t5,Ie.trim=s5,Ie.trimEnd=n5,Ie.trimStart=r5,Ie.truncate=i5,Ie.unescape=o5,Ie.uniqueId=P5,Ie.upperCase=a5,Ie.upperFirst=Ew,Ie.each=D,Ie.eachRight=V,Ie.first=b_,Rw(Ie,function(){var m={};return kr(Ie,function(b,E){Wn.call(Ie.prototype,E)||(m[E]=b)}),m}(),{chain:!1}),Ie.VERSION=n,ki(["bind","bindKey","curry","curryRight","partial","partialRight"],function(m){Ie[m].placeholder=Ie}),ki(["drop","take"],function(m,b){un.prototype[m]=function(E){E=E===s?1:Bs(gn(E),0);var z=this.__filtered__&&!b?new un(this):this.clone();return z.__filtered__?z.__takeCount__=Rr(E,z.__takeCount__):z.__views__.push({size:Rr(E,Y),type:m+(z.__dir__<0?"Right":"")}),z},un.prototype[m+"Right"]=function(E){return this.reverse()[m](E).reverse()}}),ki(["filter","map","takeWhile"],function(m,b){var E=b+1,z=E==vt||E==Rt;un.prototype[m]=function(ie){var Ee=this.clone();return Ee.__iteratees__.push({iteratee:Xs(ie,3),type:E}),Ee.__filtered__=Ee.__filtered__||z,Ee}}),ki(["head","last"],function(m,b){var E="take"+(b?"Right":"");un.prototype[m]=function(){return this[E](1).value()[0]}}),ki(["initial","tail"],function(m,b){var E="drop"+(b?"":"Right");un.prototype[m]=function(){return this.__filtered__?new un(this):this[E](1)}}),un.prototype.compact=function(){return this.filter(el)},un.prototype.find=function(m){return this.filter(m).head()},un.prototype.findLast=function(m){return this.reverse().find(m)},un.prototype.invokeMap=kn(function(m,b){return typeof m=="function"?new un(this):this.map(function(E){return aa(E,m,b)})}),un.prototype.reject=function(m){return this.filter(mr(Xs(m)))},un.prototype.slice=function(m,b){m=gn(m);var E=this;return E.__filtered__&&(m>0||b<0)?new un(E):(m<0?E=E.takeRight(-m):m&&(E=E.drop(m)),b!==s&&(b=gn(b),E=b<0?E.dropRight(-b):E.take(b-m)),E)},un.prototype.takeRightWhile=function(m){return this.reverse().takeWhile(m).reverse()},un.prototype.toArray=function(){return this.take(Y)},kr(un.prototype,function(m,b){var E=/^(?:filter|find|map|reject)|While$/.test(b),z=/^(?:head|last)$/.test(b),ie=Ie[z?"take"+(b=="last"?"Right":""):b],Ee=z||/^find/.test(b);!ie||(Ie.prototype[b]=function(){var Ke=this.__wrapped__,ot=z?[1]:arguments,mt=Ke instanceof un,Wt=ot[0],Zt=mt||Ys(Ke),Jt=function(Zn){var rr=ie.apply(Ie,Aa([Zn],ot));return z&&Ts?rr[0]:rr};Zt&&E&&typeof Wt=="function"&&Wt.length!=1&&(mt=Zt=!1);var Ts=this.__chain__,Gs=!!this.__actions__.length,ln=Ee&&!Ts,Dn=mt&&!Gs;if(!Ee&&Zt){Ke=Dn?Ke:new un(this);var cn=m.apply(Ke,ot);return cn.__actions__.push({func:cp,args:[Jt],thisArg:s}),new ji(cn,Ts)}return ln&&Dn?m.apply(this,ot):(cn=this.thru(Jt),ln?z?cn.value()[0]:cn.value():cn)})}),ki(["pop","push","shift","sort","splice","unshift"],function(m){var b=yl[m],E=/^(?:push|sort|unshift)$/.test(m)?"tap":"thru",z=/^(?:pop|shift)$/.test(m);Ie.prototype[m]=function(){var ie=arguments;if(z&&!this.__chain__){var Ee=this.value();return b.apply(Ys(Ee)?Ee:[],ie)}return this[E](function(Ke){return b.apply(Ys(Ke)?Ke:[],ie)})}}),kr(un.prototype,function(m,b){var E=Ie[b];if(E){var z=E.name+"";Wn.call(ro,z)||(ro[z]=[]),ro[z].push({name:b,func:E})}}),ro[o_(s,ce).name]=[{name:"wrapper",func:s}],un.prototype.clone=Kh,un.prototype.reverse=Nu,un.prototype.value=Pd,Ie.prototype.at=up,Ie.prototype.chain=lu,Ie.prototype.commit=K0,Ie.prototype.next=J0,Ie.prototype.plant=Ci,Ie.prototype.reverse=qu,Ie.prototype.toJSON=Ie.prototype.valueOf=Ie.prototype.value=Q0,Ie.prototype.first=Ie.prototype.head,Kc&&(Ie.prototype[Kc]=vw),Ie},tc=_f();Yl?((Yl.exports=tc)._=tc,Lh._=tc):bi._=tc}).call(Qu)})(p2,p2.exports);const FR=p2.exports,NX={name:"PillList",components:{Icon:yn,Tooltip:Fo},mixins:[Xo],props:{assistiveText:{type:Object,default:()=>({remove:"Press delete or backspace to remove.",listboxLabel:"Selected Options:",error:"Warning"})},containerBorder:Boolean,labels:{type:Object,default:()=>({removeTitle:"Remove",error:"Error"})},options:{type:Array,default:()=>[],validator(e){return e.every(t=>{const n=uk(t,["label","title"]);return n.length?(console.error(`Options object is missing required properties: ${n.toString()}`),!1):!0})}},pillBorder:{type:Boolean,default:!0},readonly:Boolean,wrap:{type:Boolean,default:!0}},data(){return{mutableOptionsArray:[],lastFocusedOptionIndex:0,tooltipText:"",tooltipSource:null}},watch:{options:{handler(e){this.mutableOptionsArray=e.map(t=>({$__guid:Vn(),...t}))},deep:!0,immediate:!0}},methods:{onFocus(e,t){this.lastFocusedOptionIndex=e,this.showTooltip(this.options[e],t)},showTooltip(e,t){!e.tooltipText||(this.tooltipText=e.tooltipText,this.tooltipSource=t.target)},focusLastFocusedOption(){const e=this.$refs[`option-${this.lastFocusedOptionIndex}`][0];e&&e.focus()},remove(e,t){if(this.readonly)return;const s=this.mutableOptionsArray.splice(e,1)[0];if(delete s.$__guid,this.$emit("update:options",this.mutableOptionsArray),this.$emit("remove",s,t),!this.mutableOptionsArray.length){this.$nextTick(this.$refs.listbox.focus.bind(this.$refs.listbox));return}this.lastFocusedOptionIndex>this.mutableOptionsArray.length-1&&this.lastFocusedOptionIndex--,this.$nextTick(this.focusLastFocusedOption.bind(this))},left(){this.lastFocusedOptionIndex>0?this.lastFocusedOptionIndex--:this.lastFocusedOptionIndex=this.mutableOptionsArray.length-1,this.focusLastFocusedOption()},right(){this.lastFocusedOptionIndex<this.mutableOptionsArray.length-1?this.lastFocusedOptionIndex++:this.lastFocusedOptionIndex=0,this.focusLastFocusedOption()}}},DX=["aria-label"],BX=["tabindex","onFocus","onMouseover"],FX=["title"];function zX(e,t,s,n,r,a){const o=pe("Icon"),d=pe("Tooltip");return L(),X("div",{class:$t({"slds-pill_container":e.$props.containerBorder,"slds-listbox_selection-group":!e.$props.containerBorder})},[k("ul",{ref:"listbox",class:$t(["slds-listbox slds-listbox_horizontal",{"slds-nowrap":!e.$props.wrap}]),role:"listbox","aria-label":s.assistiveText.listboxLabel,"aria-orientation":"horizontal",onKeydown:[t[0]||(t[0]=Zs((...p)=>a.left&&a.left(...p),["left"])),t[1]||(t[1]=Zs((...p)=>a.right&&a.right(...p),["right"])),t[2]||(t[2]=Zs(p=>a.remove(r.lastFocusedOptionIndex,p),["delete"]))]},[(L(!0),X(Lt,null,As(r.mutableOptionsArray,(p,y)=>(L(),X("li",{key:p.$__guid,class:"slds-listbox-item",role:"presentation"},[k("span",{ref_for:!0,ref:`option-${y}`,class:$t(["slds-pill",{"slds-pill_bare":!s.pillBorder,"slds-has-error":p.hasError,"read-only":p.readonly}]),role:"option",tabindex:r.lastFocusedOptionIndex===y?0:-1,"aria-selected":"true",onFocus:v=>a.onFocus(y,v),onMouseover:v=>{a.showTooltip(p,v)}},[p.swatchColor?(L(),X("span",{key:0,class:"slds-swatch slds-m-right_xx-small",style:br({backgroundColor:p.swatchColor})},null,4)):$e("",!0),p.hasError?(L(),Ge(o,{key:1,class:"slds-pill__icon_container",category:"utility",name:"error",variant:"error",assistiveText:s.assistiveText.error,title:s.labels.error},null,8,["assistiveText","title"])):$e("",!0),k("span",{class:"slds-pill__label",title:p.title},Pe(e.decodeHtml(p.label)),9,FX),!p.readonly&&!s.readonly?(L(),Ge(o,{key:2,class:"slds-pill__remove cursor-pointer",category:"utility",name:"close",size:"x-small",assistiveText:s.assistiveText.remove,onMousedown:Os(v=>a.remove(y,v),["prevent"])},null,8,["assistiveText","onMousedown"])):$e("",!0)],42,BX)]))),128))],42,DX),r.tooltipSource&&r.tooltipText?(L(),Ge(d,{key:0,text:r.tooltipText,source:r.tooltipSource},null,8,["text","source"])):$e("",!0)],2)}const UX=os(NX,[["render",zX],["__scopeId","data-v-14aff41b"]]),VX={name:"AssignmentCell",components:{ButtonIcon:vn,SLDSButton:Tn,PillList:UX,Popover:Uc,Tooltip:Fo},props:["cell"],emits:["rules-updated","loading"],data(){return{showAssignmentPopover:!1,popoverBindTo:null,tooltipSource:null}},computed:{assignments(){return this.$props.cell.data.value.split(", ").map(t=>{const s=this.$store.nodeMap[t],n={title:s.name,label:s.name,id:t,swatchColor:s.color};return(s==null?void 0:s.assignments.find(a=>a.sfsp__RecordId__c===this.$props.cell.row.id))||(n.readonly=!0,n.tooltipText="Assigned via rule"),n}).sort((t,s)=>s.hasOwnProperty("readonly")?-1:1)},overflowButtonText(){return`+ ${this.assignments.slice(2).length} more`}},methods:{showTooltip(e){this.tooltipSource=e.target},async onAssignmentNodeRemoval(e){SPM.Components.RecordExplorer.loadingMsg="Removing assignment...";const t=this.$store.nodeMap[e.id],s=t.assignments.findIndex(r=>r.sfsp__RecordId__c===this.$props.cell.row.id),n=t.assignments[s].sfsp__SalesAssignmentObject__c;await SPM.Utils.CRM.delete({records:[t.assignments[s]]}),t.assignments.splice(s,1),this.$emit("rules-updated",n),SPM.Components.RecordExplorer.reloadTable()},async openAssignmentPopover(e){this.popoverBindTo=e.target,this.showAssignmentPopover=!0},closeAssignmentPopover(){this.showAssignmentPopover=!1,this.popoverBindTo=null}}},jX={class:"slds-grid slds-grid_align-spread"},qX={key:0},HX={class:"slds-grid"},GX={class:"slds-m-left_x-small"};function WX(e,t,s,n,r,a){const o=pe("PillList"),d=pe("SLDSButton"),p=pe("ButtonIcon"),y=pe("Popover"),v=pe("Tooltip");return L(),X("div",jX,[de(o,{options:a.assignments.slice(0,2),wrap:!1,readonly:!e.$store.isEditor,onRemove:t[0]||(t[0]=C=>a.onAssignmentNodeRemoval(C))},null,8,["options","readonly"]),a.assignments.slice(2).length?(L(),X("div",qX,[de(d,{ref:"button",label:a.overflowButtonText,variant:"base",onClick:t[1]||(t[1]=C=>a.openAssignmentPopover(C))},null,8,["label"]),r.showAssignmentPopover?(L(),Ge(y,{key:0,bindTo:e.$refs.button.$el,position:"absolute",alignment:"bottom",closeOnClickOutside:"",onClose:a.closeAssignmentPopover},{header:je(()=>[es(" Assigned To ")]),content:je(()=>[(L(!0),X(Lt,null,As(a.assignments.slice(2),(C,I)=>(L(),X("div",{key:I,class:"slds-grid slds-grid_align-spread slds-p-vertical_x-small"},[k("div",HX,[k("span",{class:"slds-swatch",style:br({backgroundColor:C.swatchColor})},null,4),k("span",GX,Pe(C.label),1),C.readonly?(L(),Ge(p,{key:0,class:"slds-m-left_x-small","aria-disabled":"true",iconCategory:"utility",iconName:"info",iconSize:"xx-small",assistiveText:"Assigned via rule",title:"Assigned via rule",onFocus:t[2]||(t[2]=O=>a.showTooltip(O)),onMouseover:t[3]||(t[3]=O=>a.showTooltip(O))})):$e("",!0)]),C.readonly?$e("",!0):(L(),Ge(p,{key:0,iconCategory:"utility",iconName:"close",assistiveText:`Remove ${C.name}`,title:`Remove ${C.name}`,onClick:O=>a.onAssignmentNodeRemoval(C)},null,8,["assistiveText","title","onClick"]))]))),128))]),_:1},8,["bindTo","onClose"])):$e("",!0),r.tooltipSource?(L(),Ge(v,{key:1,source:r.tooltipSource,class:"slds-m-left_x-small",text:"Assigned via rule"},null,8,["source"])):$e("",!0)])):$e("",!0)])}const YX=os(VX,[["render",WX],["__scopeId","data-v-d0a4f4a7"]]),kA=()=>({mode:"Aggregation",loadingMsg:"",searchTerm:"",tooManyRecords:!1,record:{columns:[],rows:[]},aggregation:{columns:[],rows:[]},boundary:{columns:[],rows:[]},filteredRows:[],renderFieldSelectionModal:!1,selectableFields:[],preview:{show:!1,loadingMsg:"",columns:[],rows:[]},renderSplitBucketModal:!1,targetBindTo:null,showAutoGeneratePopup:!1,splitBucketContext:null,numRanges:2,ranges:[],selectedFieldId:null,selectedField:null,maxSplitDepth:0}),ZX={name:"RecordExplorer",components:{AssignmentCell:YX,Badge:lx,ColumnCell:NR,DuelingPicklist:PR,Icon:yn,SLDSButton:Tn,ButtonIcon:vn,DataTable:Rm,TextInput:Ko,Spinner:Vr,Picklist:Qi,Layout:xC,LayoutItem:wC,Modal:zc,Popover:Uc,Slider:BR,ActionMenu:wa,ActionMenuItem:Sa},props:["selectedObject","virtual"],emits:["select-assignment","show-assignment","rules-updated"],data(){return kA()},computed:{computedAllObjects(){return this.$store.allObjects.filter(e=>{var t;return((t=e.recordsDataset)==null?void 0:t.dimensions)||(e==null?void 0:e.containerSetId)})},recordsDataset(){return this.$props.selectedObject.recordsDataset},assignmentsDataset(){return this.$props.selectedObject.assignmentsDataset},computedDatasetFields(){return[{title:"Dimensions",options:this.mode==="Aggregation"?(this.recordsDataset.dimensions||[]).filter(e=>!Object.keys(this.$store.containerSets).some(t=>e.id.includes(t))):this.recordsDataset.dimensions||[]},{title:"Measures",options:this.recordsDataset.measures||[]}]},selectedColumns(){return this.$store.preferences.RecordExplorer.columns[`${this.selectedObject.id}:${this.mode}`]||(this.selectedObject.containerSetId?SPM.Utils.BoundaryObject.getDefaultColumns({boundaryObject:this.selectedObject}):SPM.Utils.AssignmentObject.getDefaultColumns({assignmentObject:this.selectedObject,mode:this.mode}))},selectionSummary(){const e=this.selectedObject.id;if(this.mode==="Aggregation"){const t=[],s=this.aggregation.columns.reduce((r,a)=>(r[a.id]=0,r),{}),n=r=>{var o,d;const a=r.filter(p=>p.selected);if((d=(o=a==null?void 0:a[0])==null?void 0:o.filters)!=null&&d.length){const p=this.$store.filterLogic?[`(${this.$store.filterLogic})`]:[],y=[...this.$store.filters.map(I=>SPM.Utils.Rule.RuleItem.fromRecordFilter(I))],v=a.map(I=>I.filters),C=SPM.Utils.Rule.fromFilterSet(v,e,y.length+1);p.push(`(${C.sfsp__BooleanFilter__c})`),y.push(...C.sfsp__SalesNodeRuleItems__r),t.push({sobjectType:"sfsp__SalesNodeRule__c",Name:`Generated Rule ${t.length+1}`,sfsp__SalesAssignmentObject__c:e,sfsp__FilterLogic__c:"custom",sfsp__BooleanFilter__c:p.join(" and "),sfsp__SalesNodeRuleItems__r:y.map((I,O)=>({...I,sfsp__SortOrder__c:O+1}))}),this.aggregation.columns.forEach((I,O)=>{switch(I.summaryType){case"Sum":s[I.id]+=a.reduce((A,P)=>A+(P.aggregates[I.id]||0),0);break;case"Group":s[I.id]+=a.filter(A=>A.depth===O).length;break;case"Bucket":s[I.id]+=a.reduce((A,P)=>A+P.aggregates[`unique__${this.selectedObject.id}__Id`],0);break}})}r.filter(p=>p.indeterminate||p.id==="root"&&p.children.every(y=>y.selected)).forEach(p=>n(p.children))};return n(this.aggregation.rows),{type:"Rules",rules:t,aggregates:s,counts:{records:s[`unique__${this.selectedObject.id}__Id`]||0,boundaries:0,[this.selectedObject.id]:s[`unique__${this.selectedObject.id}__Id`]||0}}}if(this.mode==="Record"){const t=this.record.columns.reduce((r,a)=>(r[a.id]=a.summaryType==="Sum"?0:new Set,r),{}),s=[],n=[];return this.record.rows.forEach(r=>{!r.selected||(n.push(r.record),s.push({sobjectType:"sfsp__SalesNodeAssignment__c",sfsp__SalesAssignmentObject__c:e,sfsp__RecordId__c:r.id,sfsp__Status__c:"Active"}),this.record.columns.forEach(a=>{switch(a.summaryType){case"Sum":t[a.id]+=r.record[a.id]||0;break;case"Unique":case"Assignment":t[a.id].add(r.record[a.id]);break}}))}),{type:"Assignments",records:n,assignments:s,aggregates:{...t,units:s.length},counts:{records:s.length,boundaries:0,[this.selectedObject.id]:s.length}}}if(this.mode==="Boundary"){const t=this.boundary.columns.reduce((n,r)=>(n[r.id]=r.summaryType==="Sum"?0:new Set,n),{}),s={records:0,boundaries:0,[this.selectedObject.id]:0};return this.boundary.rows.forEach(n=>{!n.selected||(s.boundaries++,s[this.selectedObject.id]++,this.boundary.columns.forEach(r=>{switch(r.summaryType){case"Sum":t[r.id]+=n.record[r.id]||0;break;case"Unique":t[r.id].add(n.record[r.id]);break}}),SPM.$store.assignmentObjects.forEach(r=>{n.record[`unique__${r.id}__Id`]&&(s[r.id]=(s[r.id]||0)+n.record[`unique__${r.id}__Id`],s.records+=n.record[`unique__${r.id}__Id`])}))}),{type:"Boundaries",boundaryObject:this.selectedObject,boundaries:this.boundary.rows.filter(n=>n.selected).map(n=>n.id),aggregates:t,counts:s}}return{}},filterCount(){return this.$store.filters.length+(this.$store.filteredNodeIds.length?1:0)}},watch:{selectedObject:{handler(){this.$store.filters.splice(0),this.$store.filterLogic="",this.resetTable()},immediate:!0},"$store.rootNode":{handler(){this.resetTable()}},"preview.searchTerm":{handler(e){e=e.toLowerCase(),this.preview.matchingRows=this.preview.rows.filter(t=>!e||Object.values(t.record).some(s=>String(s||"").toLowerCase().includes(e)))}},searchTerm:{handler(){this.debounceSearchRowsByTerm()}},mode:{handler(){["Aggregation","Record"].includes(this.mode)&&(this.$store.preferences.RecordExplorer.mode=this.mode,this.$store.savePreferences()),this.reloadTable({clearSplits:!0})}}},async mounted(){SPM.Components.RecordExplorer=this},methods:{debounceSearchRowsByTerm:FR.debounce(function(){this.searchRowsByTerm()},500),searchRowsByTerm(){const e=this.mode==="Record"?this.record.rows:this.boundary.rows;this.searchTerm.length||(this.filteredRows=e);const t=this.searchTerm.toLowerCase();this.filteredRows=e.filter(s=>Object.values(s.record).some(r=>String(r||"").toLowerCase().includes(t)))},async resetTable({mode:e}={}){var t,s;if(this.loadingMsg="Loading...",Object.assign(this.$data,kA()),this.selectedObject.containerSetId)await this.loadBoundaryTable();else{if(!this.recordsDataset||!((t=this.recordsDataset)!=null&&t.dimensions)||!((s=this.assignmentsDataset)!=null&&s.dimensions))return this.loadingMsg="Retrieving Dataset...";if(this.recordsDataset.dataflowStatus)return this.loadingMsg=`${this.recordsDataset.dataflowStatus}...`;this.mode=e||SPM.$store.preferences.RecordExplorer.mode,await(this.mode==="Record"?this.loadRecordsTable():this.loadRootAggregation())}},async reloadTable({clearSplits:e=!1}={}){if(this.mode==="Aggregation"){const t=[];if(!e){const s=n=>n.reduce((r,a)=>(a.splitField&&r.push({field:a.splitField,ranges:a.splitRanges,bucket:a.aggregates.bucket,nextSplits:s(a.children)}),r),[]);t.push(...s(this.aggregation.rows))}if(await this.loadRootAggregation(),t.length){const s=async(n,r)=>{await this.split({...n,parent:r}),n.nextSplits.forEach(a=>{const o=r.children.find(d=>a.bucket===d.aggregates.bucket);o&&s(a,o)})};s(t[0],this.aggregation.rows[0])}}this.mode==="Record"&&this.loadRecordsTable(),this.mode==="Boundary"&&this.loadBoundaryTable()},async loadRecordsTable(){this.tooManyRecords=!1,this.loadingMsg="Loading Records...";const e=this.$store.filteredNodeIds.map(r=>this.$store.nodeMap[r]);e.length===0&&e.push(this.$store.rootNode);const t=await SPM.Utils.Node.getAssignmentData({assignmentObject:this.selectedObject,nodes:e,filters:this.$store.filters,filterLogic:this.$store.filterLogic,type:"aggregates",isBurndown:this.$store.filteredNodeIds.includes(this.$store.rootNode.id)});if(t[`unique__${this.selectedObject.id}__Id`]>1e4){this.tooManyRecords=!0,this.loadingMsg="";return}const s=await SPM.Utils.Node.getAssignmentData({assignmentObject:this.selectedObject,nodes:e,filters:this.$store.filters,filterLogic:this.$store.filterLogic,type:"records",isBurndown:this.$store.filteredNodeIds.includes(this.$store.rootNode.id)}),n=SPM.Utils.AssignmentObject.getFieldOptions({assignmentObject:this.selectedObject,mode:"Record"});this.record.columns=[...this.selectedColumns.reduce((r,a)=>{const o=n.find(d=>d.id===a.id);return o&&r.push({...a,type:"custom",format:"None",name:o.label,fieldType:o.type,...(()=>{switch(o.type){case"Numeric":return{summaryType:"Sum",summaryValue:t[`sum__${o.id}`],alignment:"right",style:{"font-weight":"700"}};case"Text":return{summaryType:"Unique",summaryValue:t[`unique__${o.id}`]};case"Assignment":return{type:"Special",summaryType:"Assignment"}}return{}})()}),r},[])],this.record.rows=s.map(r=>({id:r[`${this.selectedObject.id}__Id`],record:r,data:this.record.columns.map(a=>({type:"custom",value:a.summaryType==="Sum"?this.$F("Numeric",r[a.id]):r[a.id]}))})),this.searchRowsByTerm(),this.loadingMsg=""},async loadBoundaryTable(){var d,p;this.loadingMsg="Loading Boundaries...",this.mode="Boundary";const e={},t=SPM.Utils.BoundaryObject.getFieldOptions({boundaryObject:this.selectedObject}),s=this.selectedColumns.reduce((y,v)=>{const C=t.find(I=>I.id===v.id);return C&&y.push({...v,type:"custom",format:"None",name:C.label,fieldType:C.type,summaryType:C.type==="Numeric"?"Sum":"Unique",summaryValue:new Set}),y},[]);s.forEach(y=>{y.type==="Numeric"&&Object.assign(y,{alignment:"right",style:{"font-weight":"700"}})});const n={};this.$store.scopeChildNodes.forEach(y=>{SPM.Utils.Node.getBoundaries({node:y,boundaryObject:this.selectedObject}).forEach(v=>{n[v]=n[v]||[],n[v].push(y)})});const r=this.$store.filteredNodeIds.map(y=>this.$store.nodeMap[y]);r.length===0&&r.push(this.$store.rootNode);const a=r.reduce((y,v)=>{if(v===this.$store.rootNode&&this.$store.filteredNodeIds.includes(v.id)){const C=SPM.Utils.Node.getBoundaries({node:v,boundaryObject:this.selectedObject,format:"map"});v.children.forEach(I=>{SPM.Utils.Node.getBoundaries({node:I,boundaryObject:this.selectedObject}).forEach(A=>delete C[A])}),y.push(...Object.keys(C))}else y.push(...SPM.Utils.Node.getBoundaries({node:v,boundaryObject:this.selectedObject}));return y},[]);a.forEach((y,v)=>{var O,A,P;const C=this.$store.containerMap[this.selectedObject.containerSetId][y].metadata;if(!SPM.Utils.Filter.evaluate({filters:this.$store.filters,filterLogic:this.$store.filterLogic,record:C}))return;const I=((A=(O=n[y])==null?void 0:O.map(q=>q.name))==null?void 0:A.join(", "))||"root or parent?";e[y]={id:y,selected:!1,data:s.map(q=>({type:"custom"})),record:{Name:y,AssignedTo:I,...Object.entries(C).reduce((q,[ce,re])=>(q[`BoundaryMetadata:${ce}`]=re,q),{})},node:(P=n[y])==null?void 0:P[0]},e[y].record[this.selectedObject.id]=y});const o=this.$store.assignmentObjects.filter(y=>{var v,C;return(C=(v=y.recordsDataset)==null?void 0:v.dimensions)==null?void 0:C.find(I=>I.id===this.selectedObject.name)});for(const y of o){let v="";r.forEach(P=>{v+=SPM.Utils.Node.generateSaql({node:P,assignmentObject:y,boundaryObjects:this.$store.boundaryObjects,nodeMap:this.$store.nodeMap,type:"cogroup",returnType:"records",prefix:"boundary",skipLoad:!!v})});let C="all_possible";r.length>1?v+=`
                        ------------------------------------------------------------------
                        -- Combine Filter Nodes
                        ------------------------------------------------------------------
                        all_possible = union ${r.map(P=>`boundary_${P.id}`).join(", ")};
                    `:C=`boundary_${r[0].id.replace("All Org","all_possible")}`;const I=(p=(d=y.recordsDataset)==null?void 0:d.dimensions)==null?void 0:p.find(P=>P.id===this.selectedObject.name),O=SPM.Utils.AssignmentObject.getReferenceMetadata({assignmentObject:y});v+=`
                    ------------------------------------------------------------------
                    -- Boundary Aggregation
                    ------------------------------------------------------------------
                    boundaries = group ${C} by ${I.id};
                    boundaries = foreach boundaries generate ${I.id} as BoundaryId, ${O.map(P=>["min","max"].includes(P.type)?`floor(${P.type}(${P.id})) as ${P.type}__${y.id}__${P.id}`:`${P.type}(${P.id}) as ${P.type}__${y.id}__${P.id}`).join(", ")};
                    boundaries = order boundaries by unique__${y.id}__Id desc;
                `;const{results:A}=await SPM.Utils.Rest.invoke("RunSaql",{query:v.replace(/^ */gm,"")});A.records.forEach((P,q)=>{const ce=e[P.BoundaryId];ce&&Object.keys(P).forEach(re=>ce.record[re]=P[re])})}s.forEach(y=>{switch(y.summaryType){case"Unique":a.forEach(C=>{var I;(I=e[C])!=null&&I.record&&y.summaryValue.add(e[C].record[y.id])});const v=y.summaryValue.size;y.summaryValue=`${this.$F("Numeric",v)} ${v===1?"value":"values"}`;break;case"Sum":y.summaryValue=0,a.forEach(C=>{var I;(I=e[C])!=null&&I.record&&(y.summaryValue+=e[C].record[y.id]||0)});break}}),this.boundary.columns=s,this.boundary.rows=Object.values(e),this.searchRowsByTerm(),this.loadingMsg=""},async loadRootAggregation(){this.loadingMsg="Loading...";const e=this.$store.filteredNodeIds.map(v=>this.$store.nodeMap[v]);e.length===0&&e.push(this.$store.rootNode);const t=await SPM.Utils.Node.getAssignmentData({assignmentObject:this.selectedObject,nodes:e,filters:this.$store.filters,filterLogic:this.$store.filterLogic,type:"aggregates",isBurndown:this.$store.filteredNodeIds.includes(this.$store.rootNode.id)}),s=SPM.Utils.AssignmentObject.getFieldOptions({assignmentObject:this.selectedObject,mode:"Aggregation"});this.aggregation.columns=[{id:"Bucket",name:"Bucket",summaryType:"Bucket"},{id:`unique__${this.selectedObject.id}__Id`,name:"Records",summaryType:"Sum"},...this.selectedColumns.reduce((v,C)=>{const I=s.find(O=>O.id===C.id);return I&&v.push({...C,type:"custom",format:"None",name:I.label,fieldType:I.type,summaryType:I.type==="Numeric"?"Sum":"Unique"}),v},[])],this.aggregation.columns.forEach(v=>{Object.assign(v,{alignment:"right",style:{"font-weight":"700"}})}),this.aggregation.rows=[{id:"root",children:[],data:[this.filterCount?"All (filtered)":"All",...this.aggregation.columns.slice(1).map(v=>v.summaryType==="Sum"?this.$F("Numeric",t[v.id]):t[v.id])],depth:0,filters:[],aggregates:t}],this.maxSplitDepth=0,await this.$nextTick();const n=this.$refs.aggregationTable.$el.querySelector(".summary-header").firstElementChild,a=n.innerText.match(/\d+/g).join(""),o=n.offsetWidth,p=document.createElement("canvas").getContext("2d");p.font="bold 13px arial";const y=p.measureText(a);n.style.width=`${o+y.width}px`,this.loadingMsg=""},async showPreview(){this.preview.loadingMsg="Loading...",this.preview.show=!0;const e=this.$store.filteredNodeIds.map(d=>this.$store.nodeMap[d]);e.length===0&&e.push(this.$store.rootNode);const{filters:t,filterLogic:s}=this.applyFilters({updateStore:!1}),n=await SPM.Utils.Node.getAssignmentData({assignmentObject:this.selectedObject,nodes:e,filters:t,filterLogic:s,type:"records",isBurndown:this.$store.filteredNodeIds.includes(this.$store.rootNode.id)}),r=await SPM.Utils.Node.getAssignmentData({assignmentObject:this.selectedObject,nodes:e,filters:t,filterLogic:s,type:"aggregates",isBurndown:this.$store.filteredNodeIds.includes(this.$store.rootNode.id)}),a=SPM.Utils.AssignmentObject.getFieldOptions({assignmentObject:this.selectedObject,mode:"Record"}),o=this.$store.preferences.RecordExplorer.columns[`${this.selectedObject.id}:Record`]||SPM.Utils.AssignmentObject.getDefaultColumns({assignmentObject:this.selectedObject,mode:"Record"});this.preview.columns=[...o.reduce((d,p)=>{const y=a.find(v=>v.id===p.id);return y&&d.push({...p,name:y.label,fieldType:y.type,...(()=>{switch(y.type){case"Numeric":return{summaryType:"Sum",summaryValue:r[`sum__${y.id}`],alignment:"right",style:{"font-weight":"700"}};case"Text":return{summaryType:"Unique",summaryValue:r[`unique__${y.id}`]};case"Assignment":return{type:"Special",summaryType:"Assignment"}}return{}})()}),d},[])],this.preview.matchingRows=this.preview.rows=n.map(d=>({id:d[`${this.selectedObject.id}__Id`],record:d,data:this.preview.columns.map(p=>({type:"custom",value:p.summaryType==="Sum"?this.$F("Numeric",d[p.id]):d[p.id]}))})),this.preview.loadingMsg=""},rulesUpdated(e){this.$emit("rules-updated",{assignmentObjectIds:[e]})},applyFilters({updateStore:e=!0}){const[{options:t},{options:s}]=this.computedDatasetFields,n=d=>s.find(p=>p.id===d)?"Numeric":"Text",r=[],a=[...this.$store.filters];this.selectionSummary.rules.forEach(d=>{const p=[];let y=a.length+1;d.sfsp__SalesNodeRuleItems__r.forEach(v=>{a.push({dataType:n(v.sfsp__Field__c),field:v.sfsp__Field__c,operator:v.sfsp__Operator__c,value:v.sfsp__Value__c}),p.push(y++)}),r.push(`(${p.join(" and ")})`)});let o=this.$store.filterLogic;return r.length&&(o+=o?` and (${r.join(" or ")})`:r.join(" or ")),e&&(this.$store.filters=a,this.$store.filterLogic=o,this.reloadTable({clearSplits:!0})),{filters:a,filterLogic:o}},toggleFilterPanel(){SPM.Components.Assignment.sidePanel=SPM.Components.Assignment.sidePanel==="FilterPanel"?"":"FilterPanel"},openFieldSelectModal(){const e=this.selectedObject.containerSetId?SPM.Utils.BoundaryObject.getFieldOptions({boundaryObject:this.selectedObject}):SPM.Utils.AssignmentObject.getFieldOptions({assignmentObject:this.selectedObject,mode:this.mode});this.selectableFields=e.map((t,s)=>({id:t.id,label:t.label,selected:this.selectedColumns.some(n=>n.id===t.id),order:this.selectedColumns.findIndex(n=>n.id===t.id)+1,active:!1})),this.renderFieldSelectionModal=!0},saveFieldSelection(){const e=this.selectedColumns.reduce((s,n)=>(s[n.id]=n,s),{}),t=this.selectableFields.reduce((s,n)=>(s[n.id]=n,s),{});Object.keys(e).filter(s=>{var n;return((n=t[s])==null?void 0:n.selected)===!1}).forEach(s=>delete e[s]),Object.keys(t).filter(s=>t[s].selected&&!e[s]).forEach(s=>e[s]=t[s]),this.$store.preferences.RecordExplorer.columns[`${this.selectedObject.id}:${this.mode}`]=Object.values(e).sort((s,n)=>{var o,d;const r=(o=this.selectableFields.find(p=>p.id===s.id))==null?void 0:o.order,a=(d=this.selectableFields.find(p=>p.id===n.id))==null?void 0:d.order;return r>a?1:r<a?-1:0}).map(s=>(delete s.selected,delete s.active,delete s.order,s)),this.$store.savePreferences(),this.reloadTable(),this.renderFieldSelectionModal=!1},handleColumnAction({action:e,column:t}){const s=this.selectedColumns,n=s.findIndex(r=>r.id===t.id);switch(e){case"MOVE_LEFT":case"MOVE_RIGHT":const r=this.mode==="Boundary"?this.boundary.columns:this.mode==="Record"?this.record.columns:this.aggregation.columns,o=r.findIndex(d=>d.id===t.id)+(e==="MOVE_LEFT"?-1:1);if(r[o]){const d=s.findIndex(p=>p.id===r[o].id);s.splice(d,0,s.splice(n,1)[0])}break;case"REMOVE_COLUMN":s.splice(n,1);break}this.$store.preferences.RecordExplorer.columns[`${this.selectedObject.id}:${this.mode}`]=s,this.$store.savePreferences(),this.reloadTable()},showSplitModal({row:e}){this.renderSplitBucketModal=!0,this.splitBucketContext=e,this.selectedFieldId=null,this.selectedField=null,this.ranges=[]},unsplit({row:e}){e.data[0]=e.data[0].split(" -> ")[0],e.selected=!1,e.indeterminate=!1,e.children.splice(0),delete e.query,delete e.splitField,delete e.splitRanges;let t=0;(function n(r){r.forEach(a=>{t=Math.max(t,a.depth),n(a.children||[])})})(this.aggregation.rows);const s=this.maxSplitDepth-t;s>0&&(this.aggregation.columns.splice(t+1,s),this.maxSplitDepth=t)},onFieldChange(e){this.selectedField=e,e.type==="measure"&&(this.ranges=[this.buildRange()])},async split({field:e=this.selectedField,parent:t=this.splitBucketContext,ranges:s=this.ranges||[]}){this.renderSplitBucketModal=!1;try{this.loadingMsg="Segmenting...";const n=({range:I,binding:O="q",rootStream:A="q"})=>{const P=[];if(t.filters.length){const q=t.filters.map(ce=>{if(typeof ce.value=="object"){const{from:re,to:W}=ce.value;return`(${ce.key} >= ${re} && ${ce.key} <= ${W})`}return`${ce.key} == "${ce.value}"`});P.push(q.join(" && "))}if(I){const{from:q,to:ce}=I;P.push(`(${e.id} >= ${q} && ${e.id} <= ${ce})`)}if(this.$store.filters.length){const q=SPM.Utils.Filter.mergeBooleanFilter(this.$store.filterLogic,this.$store.filters.map(ce=>SPM.Utils.Filter.toSaql(ce)));P.push(`(${q})`)}return P.length?`${O} = filter ${A} by ${P.join(" && ")};
`:""},r=this.$store.filteredNodeIds.map(I=>this.$store.nodeMap[I]);r.length===0&&r.push(this.$store.rootNode);let{saql:a,rootStream:o}=await SPM.Utils.Node.getAssignmentData({assignmentObject:this.selectedObject,nodes:r,filters:this.$store.filters,filterLogic:this.$store.filterLogic,type:"saql",isBurndown:this.$store.filteredNodeIds.includes(this.$store.rootNode.id)});const d=e.type==="dimension",p=e.type==="measure";if(d)a+=`
                        ------------------------------------------------------------------
                        -- Drill Down Filters
                        ------------------------------------------------------------------
                        ${n({binding:o,rootStream:o})}

                        ------------------------------------------------------------------
                        -- Measure Aggregation
                        ------------------------------------------------------------------
                        q = group ${o} by (${e.id});
                        q = foreach q generate ${this.recordsDataset.measures.reduce((I,O)=>[`sum(${O.id}) as sum__${this.selectedObject.id}__${O.id}`,`floor(min(${O.id})) as min__${this.selectedObject.id}__${O.id}`,`floor(max(${O.id})) as max__${this.selectedObject.id}__${O.id}`].concat(I),[`unique(Id) as unique__${this.selectedObject.id}__Id`,`${e.id} as bucket`]).join(", ")};
                        q = limit q 51;
                    `;else{let I="all = union ";s.forEach((O,A)=>{const P=`q${A}`;a+=n({range:O,binding:P,rootStream:o}),a+=`${P} = group ${P} by all;
`,a+=`${P} = foreach ${P} generate "${e.title} from ${parseInt(O.from).toLocaleString("en-US")} to ${parseInt(O.to).toLocaleString("en-US")}" as bucket, `,this.recordsDataset.measuresMetadata.forEach(q=>{a+=`sum(${q.field}) as sum__${this.selectedObject.id}__${q.field}, `,a+=`floor(min(${q.field})) as min__${this.selectedObject.id}__${q.field}, `,a+=`floor(max(${q.field})) as max__${this.selectedObject.id}__${q.field}, `}),a+=`unique(Id) as unique__${this.selectedObject.id}__Id`,a+=`, ${A} as range;`,I+=P,a+=`

`,A+1<s.length&&(I+=", ")}),a+=`${I};`}const{query:y,results:v}=await SPM.Utils.Rest.invoke("RunSaql",{query:a.replace(/^ */gm,"")})||{query:"",records:[]};if(v.records.length===0)return this.$store.toast({message:`Grouping by ${e.id} yielded no query results. Grouping operation aborted.`,state:"warning"});if(v.records.length>50)return this.$store.toast({message:"Select a dimension with less than 50 unique values.",state:"error"});const C=t.depth+1;C>this.maxSplitDepth&&(this.aggregation.columns.splice(C,0,{id:`Group ${C}`,name:`Group ${C}`,summaryType:"Group"}),this.maxSplitDepth=C),t.query=y,t.splitField=e,t.splitRanges=s,t.data[0]=`${t.data[0]} -> ${e.title}`,v.records.forEach((I,O)=>{let A=I.bucket;if(p){const{from:P,to:q}=s[I.range];A={from:P,to:q}}t.children.push({id:`${t.id}.${O}`,data:[I.bucket||"<blank>",...this.aggregation.columns.slice(this.maxSplitDepth+1).map(P=>P.summaryType==="Sum"?this.$F("Numeric",I[P.id]):I[P.id])],depth:t.depth+1,filters:[...t.filters,{key:e.id,value:A}],parent:t,aggregates:I,children:[]})}),t.indeterminate=!1,t.selected=!1}catch(n){this.$store.toast({message:n.message,state:"error"})}finally{this.loadingMsg=""}},generateRanges(){const e=this.splitBucketContext.aggregates[`min__${this.selectedObject.id}__${this.selectedField.id}`],t=this.splitBucketContext.aggregates[`max__${this.selectedObject.id}__${this.selectedField.id}`],s=Math.floor((t-e)/this.numRanges);let n=e;const r=[];for(let a=0;a<this.numRanges;a++){const o=n,d=a+1===this.numRanges?t:n+s-1;r.push(this.buildRange(o,d)),n+=s}this.ranges=r,this.closePopover()},addRange(){this.ranges.push(this.buildRange())},buildRange(e=0,t=this.splitBucketContext.aggregates[`max_${this.selectedField.id}`]){return{id:Vn(),from:e,to:t}},removeRange(e){this.ranges.splice(e,1)},openAutoGeneratePopup(e){this.targetBindTo=e.target,this.showAutoGeneratePopup=!0},closePopover(){this.targetBindTo=null,this.showAutoGeneratePopup=!1,this.numRanges=2},getQueryExpressionByFilterSets(e=[[]]){function t({key:r,value:a}){if(typeof a=="object"){const{from:o,to:d}=a;return`(${r} >= ${o} && ${r} <= ${d})`}return`${r} == "${a}"`}const s=[],n=[];for(let r=0;r<e[0].length-1;r++){const a=e[0][r];s.push(t(a))}return e.forEach(r=>{n.push(r.slice(r.length-1)[0])}),n.length&&(typeof n[0].value=="object"?s.push(`(${n.map(a=>t(a)).join(" || ")})`):s.push(`${n[0].key} in [${n.map(a=>`"${a.value}"`).join(", ")}]`)),`(${s.join(" && ")})`},formatSummaryColumn(e){switch(e.summaryType){case"Sum":return this.$F("Numeric",this.selectionSummary.aggregates[e.id]);case"Bucket":const t=this.selectionSummary.aggregates.Bucket,s=this.aggregation.rows[0].aggregates[`unique__${this.selectedObject.id}__Id`];return`${this.$F("Numeric",t)} of ${this.$F("Numeric",s)} ${s===1?"item":"items"} selected`;case"Group":const n=this.selectionSummary.aggregates[e.id];return`${this.$F("Numeric",n)} ${n===1?"group":"groups"} selected`;case"Unique":case"Assignment":const r=this.selectionSummary.aggregates[e.id].size;return`${this.$F("Numeric",r)} ${r===1?"value":"values"}`}},onGroupActionClick(e){var t;(t=e==null?void 0:e.children)!=null&&t.length?this.unsplit({row:e}):this.showSplitModal({row:e}),this.clearHighlightedCells()},clearHighlightedCells(){this.highlighted.forEach(e=>{e.classList.remove("spm-record-explorer-highlight-split"),e.classList.remove("spm-record-explorer-highlight-unsplit")}),this.highlighted=[]},onGroupActionMouseover(e,t){var r,a;if(((r=t.target)==null?void 0:r.nodeName)!=="BUTTON")return;const s=(a=e==null?void 0:e.children)!=null&&a.length?"Unsplit":"Split";this.highlighted=[];let n=t.target.closest("th");if(s==="Split")n.classList.add("spm-record-explorer-highlight-split"),this.highlighted.push(n);else{let o=t.target.closest("tr");const d=n.rowSpan;do n.classList.add("spm-record-explorer-highlight-unsplit"),this.highlighted.push(n),n=n.nextSibling;while(n&&n.nodeName==="TH");for(let p=0;p<d-2;p++){o=o.nextSibling;const y=o.querySelectorAll("th");for(let v=0;v<y.length;v++){const C=y[v];C.parentNode.className!=="spm-subtotal-row"&&(C.classList.add("spm-record-explorer-highlight-unsplit"),this.highlighted.push(C))}}}}}},zg=e=>(Nr("data-v-8b9e4dd9"),e=e(),Dr(),e),XX={class:"slds-grid slds-grid_vertical-align-center slds-grid_align-spread slds-p-around_small"},KX={class:"slds-grid slds-grid_vertical-align-center"},JX={class:"slds-grid slds-grid_vertical"},QX=zg(()=>k("span",null,"Object",-1)),eK={class:"slds-text-color_default slds-page-header__title"},tK={class:"slds-grid slds-grid_vertical-align-center"},sK={class:"slds-text-color_default"},nK={key:0,class:"slds-size_1-of-4 slds-shrink"},rK={class:"slds-grid"},iK={class:"slds-button-group slds-is-relative slds-m-right_x-small",role:"group"},oK={key:1,style:{position:"absolute",top:"-0.7rem",right:"-0.2rem","z-index":"5","border-radius":"50%",background:"red",color:"white",width:"1.2rem",height:"1.2rem","line-height":"1.2rem","text-align":"center"}},aK=["name"],lK={key:0,id:"too-many-records",class:"slds-align_absolute-center slds-grid slds-grid_vertical"},cK=zg(()=>k("span",{class:"slds-text-heading_medium slds-p-bottom_x-small"},"Too many records to show",-1)),uK=zg(()=>k("span",{class:"slds-text-body_regular"},"Please add a filter or use the \u201CSplit\u201D function in Group View.",-1)),dK=[cK,uK],hK=["name"],pK=["name"],fK=["onClick"],mK=["name"],_K=["name"],gK=["name"],yK=["name"],vK={key:0,class:"slds-grid slds-grid_vertical-align-center slds-p-around_x-small"},bK={style:{"border-radius":"23px",background:"#EEF1F6",padding:"2px 8px"}},xK={key:1},wK={key:2},SK={key:0},CK={key:1},IK={key:0},TK={key:1},AK={class:"slds-grid"},MK={class:"slds-col_bump-left"},EK=zg(()=>k("div",{style:{color:"#1b96ff"},class:"slds-m-right_large"},"Minimum",-1)),kK=zg(()=>k("div",{style:{color:"#1b96ff"},class:"slds-m-right_large"},"Maximum",-1)),PK=zg(()=>k("div",null," Auto-Generate Ranges ",-1)),RK={style:{width:"50%",margin:"1rem auto"}},$K={class:"slds-grid slds-grid_vertical",style:{height:"50vh",overflow:"hidden"}},OK={key:0,class:"slds-grid slds-grid_vertical-align-center slds-p-around_x-small"},LK={style:{"border-radius":"23px",background:"#EEF1F6",padding:"2px 8px"}},NK={key:1},DK={key:0},BK={key:1};function FK(e,t,s,n,r,a){var ee,ne,Se,Ue,Qe;const o=pe("Icon"),d=pe("SLDSButton"),p=pe("ActionMenuItem"),y=pe("ActionMenu"),v=pe("ButtonIcon"),C=pe("TextInput"),I=pe("Picklist"),O=pe("Spinner"),A=pe("ColumnCell"),P=pe("DataTable"),q=pe("AssignmentCell"),ce=pe("Badge"),re=pe("DuelingPicklist"),W=pe("Modal"),Ce=pe("Layout"),te=pe("LayoutItem"),oe=pe("Slider"),ve=pe("Popover");return L(),X("div",{class:"spm-box slds-grid slds-grid_vertical slds-grow slds-m-top_small",style:br(`border-top: 0.25rem solid ${s.selectedObject.icon.color};`)},[k("div",XX,[k("div",KX,[de(o,{category:(ee=e.$props.selectedObject)==null?void 0:ee.icon.category,name:(ne=e.$props.selectedObject)==null?void 0:ne.icon.name,class:"slds-m-right_small"},null,8,["category","name"]),k("div",JX,[QX,de(y,null,{button:je(()=>[de(d,{id:"change-object",style:{border:"none","margin-top":"-4px"},variant:"base",iconCategory:"utility",iconName:"down",iconPosition:"right",iconVariant:"default"},{default:je(()=>[k("span",eK,[k("strong",null,Pe(s.selectedObject.label),1)])]),_:1})]),default:je(()=>[(L(!0),X(Lt,null,As(a.computedAllObjects,Me=>(L(),Ge(p,{key:Me.id,label:Me.label,onClick:vt=>e.$emit("select-assignment",Me)},{default:je(()=>[k("div",tK,[de(o,{category:Me.icon.category,name:Me.icon.name,size:"small",class:"slds-m-right_x-small"},null,8,["category","name"]),k("span",sK,Pe(Me.label),1)])]),_:2},1032,["label","onClick"]))),128))]),_:1})])]),e.mode!=="Aggregation"?(L(),X("div",nK,[de(C,{modelValue:e.searchTerm,"onUpdate:modelValue":t[1]||(t[1]=Me=>e.searchTerm=Me),class:"slds-input-has-icon slds-input-has-icon_left-right slds-grow",labels:{placeholder:"Search..."}},{extend:je(()=>[de(o,{category:"utility",name:"search",iconClass:["slds-input__icon","slds-input__icon_left"]}),de(v,{iconCategory:"utility",iconName:"clear",assistiveText:"Clear",iconClass:["slds-button__icon","slds-icon-text-light"],class:"slds-button slds-button_icon slds-input__icon slds-input__icon_right",title:"Clear",onClick:t[0]||(t[0]=Me=>e.searchTerm="")})]),_:1},8,["modelValue","labels"])])):$e("",!0),k("div",rK,[e.mode!=="Boundary"?(L(),Ge(I,{key:0,id:"change-list-view",modelValue:e.mode,"onUpdate:modelValue":t[2]||(t[2]=Me=>e.mode=Me),options:[{id:"Aggregation",title:"Group View"},{id:"Record",title:"Record View"}],class:"slds-m-right_x-small",style:{width:"150px"}},null,8,["modelValue"])):$e("",!0),e.mode==="Aggregation"&&((Se=a.selectionSummary)==null?void 0:Se.rules.length)?(L(),Ge(d,{key:1,label:"Preview Selection",class:"slds-m-right_x-small",onClick:a.showPreview},null,8,["onClick"])):$e("",!0),k("div",iK,[(Qe=(Ue=a.selectionSummary)==null?void 0:Ue.rules)!=null&&Qe.length?(L(),Ge(d,{key:0,id:"apply-filters",label:`Apply Filters (${a.selectionSummary.rules.reduce((Me,vt)=>Me+vt.sfsp__SalesNodeRuleItems__r.length,0)})`,onClick:a.applyFilters},null,8,["label","onClick"])):$e("",!0),de(v,{id:"manage-filters",iconCategory:"utility",iconName:"filterList",variant:"border-filled",title:"filter",assistiveText:"filter",onClick:a.toggleFilterPanel},null,8,["onClick"]),a.filterCount?(L(),X("div",oK,Pe(a.filterCount),1)):$e("",!0)]),de(y,{class:"slds-m-right_x-small"},{button:je(()=>[de(v,{name:"list-view-controls",variant:"border-filled",iconCategory:"utility",iconName:"settings",assistiveText:"Column Settings",title:"Column Settings",more:""})]),default:je(()=>[de(p,{label:"Select Fields To Display",onClick:a.openFieldSelectModal},null,8,["onClick"])]),_:1}),e.$store.isEditor?(L(),Ge(d,{key:2,id:"manage-assignments",variant:"brand",label:"Assign",onClick:t[3]||(t[3]=Me=>e.$emit("show-assignment"))})):$e("",!0)])]),k("div",{class:$t(["slds-grid slds-grow slds-grid_vertical spm-data-table-wrapper",{"slds-border_top":e.tooManyRecords}]),style:{position:"relative"}},[e.loadingMsg?(L(),Ge(O,{key:0,theme:"brand"},{description:je(()=>[es(Pe(e.loadingMsg),1)]),_:1})):$e("",!0),e.mode==="Aggregation"?(L(),Ge(P,{key:1,id:"aggregation-table",ref:"aggregationTable",columns:e.aggregation.columns,rows:e.aggregation.rows,bordered:"",columnsBordered:"",multiselectable:"",treeGroup:"",summaryHeader:"",virtual:e.$props.virtual},{summaryHeader:je(({column:Me})=>[k("span",{name:`${Me.name.replaceAll(" ","-")}-summary`},Pe(a.formatSummaryColumn(Me)),9,aK)]),header:je(({column:Me})=>[de(A,{column:Me,onHandleColumnAction:a.handleColumnAction},null,8,["column","onHandleColumnAction"])]),groupActions:je(({row:Me})=>{var vt,Ut,Rt,_t;return[de(v,{name:(vt=Me==null?void 0:Me.children)!=null&&vt.length?"aggregation-table-unsplit":"aggregation-table-split",class:"slds-col_bump-left",iconCategory:"utility",iconName:(Ut=Me==null?void 0:Me.children)!=null&&Ut.length?"close":"rules",variant:"border-filled",size:"small",assistiveText:(Rt=Me==null?void 0:Me.children)!=null&&Rt.length?"Unsplit":"Split",title:(_t=Me==null?void 0:Me.children)!=null&&_t.length?"Unsplit":"Split",onClick:F=>a.onGroupActionClick(Me),onMouseover:F=>a.onGroupActionMouseover(Me,F),onMouseout:a.clearHighlightedCells},null,8,["name","iconName","assistiveText","title","onClick","onMouseover","onMouseout"])]}),_:1},8,["columns","rows","virtual"])):e.mode==="Record"?(L(),X(Lt,{key:2},[e.tooManyRecords?(L(),X("div",lK,dK)):(L(),Ge(P,{key:1,id:"record-table",columns:e.record.columns,rows:e.filteredRows,bordered:"",columnsBordered:"",multiselectable:"",summaryHeader:"",summaryFooter:"",virtual:""},{summaryHeader:je(({column:Me})=>[k("span",{name:`${Me.name.replaceAll(" ","-").toLowerCase()}-header`},Pe(a.formatSummaryColumn(Me)),9,hK)]),header:je(({column:Me})=>[de(A,{column:Me,onHandleColumnAction:a.handleColumnAction},null,8,["column","onHandleColumnAction"])]),cell:je(Me=>[Me.column.isNameField?(L(),X("div",{key:0,name:`${Me.row.id.replaceAll(" ","-").toLowerCase()}-value`,class:"slds-grid slds-grid_vertical-align-center slds-p-around_x-small"},[k("a",{onClick:vt=>e.$store.openRecordUrl(Me.row.id)},Pe(Me.data.value),9,fK)],8,pK)):Me.column.type==="Special"?(L(),X("div",{key:1,name:`${Me.row.id.replaceAll(" ","-").toLowerCase()}-assignedto-value`,class:"slds-grid slds-grid_vertical-align-center slds-p-around_x-small"},[Me.column.id==="AssignedTo"?(L(),Ge(q,{key:0,cell:Me,onRulesUpdated:a.rulesUpdated},null,8,["cell","onRulesUpdated"])):(L(!0),X(Lt,{key:1},As([...new Set(Me.data.value.split(", "))],(vt,Ut)=>(L(),Ge(ce,{key:Ut,content:vt},null,8,["content"]))),128))],8,mK)):(L(),X("div",{key:2,name:`${Me.row.id.replaceAll(" ","-").toLowerCase()}-value`},Pe(Me.data.value),9,_K))]),summaryFooter:je(Me=>[Me.column.summaryType==="Unique"?(L(),X("span",{key:0,name:`${Me.column.name.replaceAll(" ","-").toLowerCase()}-summary`},Pe(Me.column.summaryValue)+" values ",9,gK)):Me.column.summaryType==="Sum"?(L(),X("span",{key:1,name:`${Me.column.name.replaceAll(" ","-").toLowerCase()}-summary`},Pe(e.$F("Numeric",Me.column.summaryValue)),9,yK)):$e("",!0)]),_:1},8,["columns","rows"]))],64)):(L(),Ge(P,{key:3,columns:e.boundary.columns,rows:e.filteredRows,bordered:"",columnsBordered:"",multiselectable:"",summaryHeader:"",summaryFooter:"",virtual:s.virtual},{summaryHeader:je(({column:Me})=>[es(Pe(a.formatSummaryColumn(Me)),1)]),header:je(({column:Me})=>[de(A,{column:Me,onHandleColumnAction:a.handleColumnAction},null,8,["column","onHandleColumnAction"])]),cell:je(Me=>[Me.column.id==="AssignedTo"?(L(),X("div",vK,[k("div",bK,Pe(Me.row.record.AssignedTo),1)])):Me.column.fieldType==="Numeric"?(L(),X("div",xK,Pe(e.$F("Numeric",Me.row.record[Me.column.id]||0)),1)):(L(),X("div",wK,Pe(Me.row.record[Me.column.id]),1))]),summaryFooter:je(Me=>[Me.column.summaryType==="Unique"?(L(),X("span",SK,Pe(Me.column.summaryValue),1)):Me.column.summaryType==="Sum"?(L(),X("span",CK,Pe(e.$F("Numeric",Me.column.summaryValue)),1)):$e("",!0)]),_:1},8,["columns","rows","virtual"]))],2),e.renderFieldSelectionModal?(L(),Ge(W,{key:0,size:"small",title:"Select Fields to Display",onClose:t[5]||(t[5]=Me=>e.renderFieldSelectionModal=!1)},{tagline:je(()=>[e.mode==="Aggregation"?(L(),X("div",IK,"Add the fields that you want to aggregate for segmentation.")):(L(),X("div",TK,"Summarize your territories using aggregated data."))]),content:je(()=>[de(re,{fields:e.selectableFields,labels:{name:"Available Fields"}},null,8,["fields"])]),footer:je(()=>[k("div",AK,[k("div",MK,[de(d,{class:"slds-button slds-button_neutral",label:"Cancel",onClick:t[4]||(t[4]=Me=>e.renderFieldSelectionModal=!1)}),de(d,{class:"slds-button slds-button_brand",label:"Save",onClick:a.saveFieldSelection},null,8,["onClick"])])])]),_:1})):$e("",!0),e.renderSplitBucketModal?(L(),Ge(W,{key:1,size:"base",title:"Split",onClose:t[10]||(t[10]=Me=>e.renderSplitBucketModal=!1)},{content:je(()=>[k("div",null,[de(I,{id:"split-by-field",modelValue:e.selectedFieldId,"onUpdate:modelValue":t[6]||(t[6]=Me=>e.selectedFieldId=Me),labels:{name:"Split By Field"},options:a.computedDatasetFields,filterable:"",onSelectedOption:a.onFieldChange,onClear:t[7]||(t[7]=Me=>e.selectedField=null)},null,8,["modelValue","options","onSelectedOption"]),e.selectedField&&e.selectedField.type==="measure"?(L(),Ge(Ce,{key:0,class:"slds-m-top_large",multipleRows:""},{default:je(()=>[de(te,{size:"12",class:"slds-border_bottom slds-m-bottom_large"},{default:je(()=>[de(Ce,{class:"slds-m-bottom_xx-small"},{default:je(()=>[EK,k("div",null,Pe(e.$F("Numeric",e.splitBucketContext.aggregates[`min__${s.selectedObject.id}__${e.selectedField.id}`])),1)]),_:1}),de(Ce,null,{default:je(()=>[kK,k("div",null,Pe(e.$F("Numeric",e.splitBucketContext.aggregates[`max__${s.selectedObject.id}__${e.selectedField.id}`])),1)]),_:1})]),_:1}),de(te,{alignmentBump:"left"},{default:je(()=>[de(d,{label:"Generate",onClick:a.openAutoGeneratePopup},null,8,["onClick"]),e.ranges.length<50?(L(),Ge(d,{key:0,label:"Add Range",onClick:a.addRange},null,8,["onClick"])):$e("",!0)]),_:1}),(L(!0),X(Lt,null,As(e.ranges,(Me,vt)=>(L(),Ge(te,{key:Me.id,size:"12",class:$t(["slds-p-vertical_x-small slds-p-horizontal_x-small",{"slds-m-top_small":vt==0}])},{default:je(()=>[de(Ce,{verticalAlign:"end",class:"slds-box slds-gutters_xx-small",style:{border:"1px solid #ddd",padding:"0.5rem",background:"#eee"}},{default:je(()=>[de(te,{class:"slds-col slds-grow-none slds-m-horizontal_medium",style:{"margin-bottom":"5px"}},{default:je(()=>[k("strong",null,Pe(vt+1),1)]),_:2},1024),de(te,{class:"slds-col"},{default:je(()=>[de(C,{modelValue:Me.from,"onUpdate:modelValue":Ut=>Me.from=Ut,labels:{name:"From"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),de(te,{class:"slds-col"},{default:je(()=>[de(C,{modelValue:Me.to,"onUpdate:modelValue":Ut=>Me.to=Ut,labels:{name:"To"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),de(te,{class:"slds-col slds-grow-none"},{default:je(()=>[de(v,{iconCategory:"utility",iconName:"delete",variant:"border-filled",assistiveText:"Delete Range",title:"Delete Range",disabled:e.ranges.length===1,onClick:Ut=>a.removeRange(vt)},null,8,["disabled","onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})):$e("",!0),e.showAutoGeneratePopup?(L(),Ge(ve,{key:1,bindTo:e.targetBindTo,position:"fixed",onClose:a.closePopover},{header:je(()=>[PK]),content:je(()=>[k("div",null,[de(Ce,{multipleRows:""},{default:je(()=>[de(te,{class:"slds-grow"},{default:je(()=>[de(oe,{modelValue:e.numRanges,"onUpdate:modelValue":t[8]||(t[8]=Me=>e.numRanges=Me),label:"Number of Ranges",min:"2",max:"10"},null,8,["modelValue"])]),_:1}),de(te,{alignmentBump:"left",class:"slds-p-vertical_medium"},{default:je(()=>[de(d,{label:"Generate",variant:"brand",onClick:a.generateRanges},null,8,["onClick"])]),_:1})]),_:1})])]),_:1},8,["bindTo","onClose"])):$e("",!0)])]),footer:je(()=>[k("div",null,[de(d,{label:"Cancel",onClick:t[9]||(t[9]=Me=>e.renderSplitBucketModal=!1)}),de(d,{label:"Split",variant:"brand",onClick:a.split},null,8,["onClick"])])]),_:1})):$e("",!0),e.preview.show?(L(),Ge(W,{key:2,id:"preview-modal",size:"large",title:"Preview Selection",onClose:t[14]||(t[14]=Me=>e.preview.show=!1)},{content:je(()=>[e.preview.loadingMsg?(L(),Ge(O,{key:0},{description:je(()=>[k("div",null,Pe(e.preview.loadingMsg),1)]),_:1})):$e("",!0),k("div",RK,[de(C,{modelValue:e.preview.searchTerm,"onUpdate:modelValue":t[12]||(t[12]=Me=>e.preview.searchTerm=Me),class:"slds-input-has-icon slds-input-has-icon_left-right slds-grow",labels:{placeholder:"Search..."}},{extend:je(()=>[de(o,{category:"utility",name:"search",iconClass:["slds-input__icon","slds-input__icon_left"]}),de(v,{iconCategory:"utility",iconName:"clear",assistiveText:"Clear",iconClass:["slds-button__icon","slds-icon-text-light"],class:"slds-button slds-button_icon slds-input__icon slds-input__icon_right",title:"Clear",onClick:t[11]||(t[11]=Me=>e.preview.searchTerm="")})]),_:1},8,["modelValue","labels"])]),k("div",$K,[e.preview.loadingMsg?$e("",!0):(L(),Ge(P,{key:0,columns:e.preview.columns,rows:e.preview.matchingRows,bordered:"",columnsBordered:"",summaryFooter:"",virtual:""},{cell:je(Me=>[Me.column.type==="Special"?(L(),X("div",OK,[k("div",LK,Pe(Me.data.value),1)])):(L(),X("div",NK,Pe(Me.data.value),1))]),summaryFooter:je(Me=>[Me.column.summaryType==="Unique"?(L(),X("span",DK,Pe(Me.column.summaryValue)+" values ",1)):Me.column.summaryType==="Sum"?(L(),X("span",BK,Pe(e.$F("Numeric",Me.column.summaryValue)),1)):$e("",!0)]),_:1},8,["columns","rows"]))])]),footer:je(()=>[de(d,{label:"Close",onClick:t[13]||(t[13]=Me=>e.preview.show=!1)})]),_:1})):$e("",!0)],4)}const zK=os(ZX,[["render",FK],["__scopeId","data-v-8b9e4dd9"]]),UK={name:"ValuePicklist",components:{Picklist:Qi,SLDSButton:Tn},props:["field","values","assignmentObjectId","label"],emits:["values-selected","disable-picklist"],data(){return{selectedValues:[],valueOptions:[],showSelectedOptions:!1,picklistIsOpen:!1,isInitializing:!1}},computed:{showSelectedButton(){return this.selectedValues.length&&!this.showSelectedOptions},buttonLabel(){return this.showSelectedButton?`Show Selected (${this.computedSelectedValues.length})`:"Show All"},computedPlaceholder(){return this.isInitializing?"":this.picklistIsOpen?"Search...":`${this.computedSelectedValues.length} Values Selected`},computedSelectedValues(){return this.selectedValues.filter(e=>e!=="All")},picklistOptions(){let e=[...this.valueOptions];return this.showSelectedOptions?e=e.filter(t=>this.selectedValues.includes(t)&&t!=="All"):e.unshift("All"),e},allValuesSelected(){return this.picklistOptions.filter(e=>e!=="All").length===this.computedSelectedValues.length}},watch:{selectedValues:{handler(){this.convertValuesToString()},deep:!0}},mounted(){this.isInitializing=!0,this.$props.values&&(this.selectedValues=this.$props.values.split(",")),this.getValueOptions()},methods:{async getValueOptions(){var s;const e=this.$store.assignmentObjects.find(n=>n.id===this.$props.assignmentObjectId);if(!((s=e==null?void 0:e.recordsDataset)!=null&&s.dimensions)){this.$emit("disable-picklist");return}const t=this.$store.filteredNodeIds.map(n=>this.$store.nodeMap[n]);t.length===0&&t.push(this.$store.rootNode),SPM.Utils.Node.getAssignmentData({assignmentObject:e,nodes:t,type:"saql",isBurndown:this.$store.filteredNodeIds.includes(this.$store.rootNode.id)}).then(async({saql:n})=>{n+=`
                        q = group q by (${this.$props.field});
                        q = foreach q generate ${this.$props.field};
                        q = limit q 2001
                    `;const{results:r}=await SPM.Utils.Rest.invoke("RunSaql",{query:n.replace(/^ */gm,"")})||{query:"",records:[]};if(r.records.length>2e3){this.$emit("disable-picklist");return}this.isInitializing=!1,this.valueOptions=r.records.map(a=>a[this.$props.field]),this.allValuesSelected&&(this.selectedValues=[...this.selectedValues,"All"])})},async togglePicklist(){this.$refs.valuePicklist.reset(),this.showSelectedOptions=this.showSelectedButton,await this.$nextTick(),this.$refs.valuePicklist.activationHandler()},convertValuesToString(){const e=this.computedSelectedValues.join(",");this.$emit("values-selected",e)},onPicklistOpen(){this.picklistIsOpen=!0,this.showSelectedOptions||this.checkForAllSelectedOptions()},onPicklistClose(){this.showSelectedOptions=!1,this.picklistIsOpen=!1},async onOptionSelected(e){if(this.showSelectedOptions&&!this.selectedValues.includes(e.id)){this.$refs.valuePicklist.reset(),await this.$nextTick(),this.$refs.valuePicklist.activationHandler(),this.selectedValues.length===0&&(this.showSelectedOptions=!1);return}if(e.id==="All"){this.selectedValues.includes("All")?this.selectedValues=this.picklistOptions:this.selectedValues=[];return}this.checkForAllSelectedOptions()},checkForAllSelectedOptions(){this.allValuesSelected?this.selectedValues=[...this.selectedValues,"All"]:this.selectedValues=this.selectedValues.filter(e=>e!=="All")}}},VK={class:"slds-is-relative"},jK={key:0,class:"slds-is-absolute spm-show-button"};function qK(e,t,s,n,r,a){const o=pe("Picklist"),d=pe("SLDSButton");return L(),X("div",VK,[de(o,{ref:"valuePicklist",modelValue:r.selectedValues,"onUpdate:modelValue":t[0]||(t[0]=p=>r.selectedValues=p),labels:{name:e.$props.label,search:a.computedPlaceholder},minSearchLength:0,remainOpenOnSelect:"",multiselect:"",filterable:"",options:a.picklistOptions,disabled:r.isInitializing,onDetached:a.onPicklistOpen,onReset:a.onPicklistClose,onSelectedOption:a.onOptionSelected},null,8,["modelValue","labels","options","disabled","onDetached","onReset","onSelectedOption"]),r.isInitializing?$e("",!0):(L(),X("div",jK,[de(d,{label:a.buttonLabel,variant:"base",onClick:a.togglePicklist},null,8,["label","onClick"])]))])}const zR=os(UK,[["render",qK],["__scopeId","data-v-e67482b3"]]),HK={validateNumberInput(e){return!e.value||e.value.length===0?(e.valueErrors.push("Please enter a valid value"),!1):(e.value=e.value.replaceAll(",",""),e.value.match(/^[-+]?\d*\.?\d*$/)?!0:(e.valueErrors.push("Please remove invalid characters"),!1))}},GK={components:{SLDSButton:Tn,Condition:M6,Expression:h9,Picklist:Qi,Popover:Uc,ScopedNotification:yj,TextInput:Ko,ValuePicklist:zR},props:{bindTo:{type:HTMLElement,required:!0},rule:{type:Object,default:()=>{}}},emits:["close","update:useFilterLogic","update:filterLogic","rule-added"],data(){return{localRule:{conditions:[],customLogic:"",name:"",assignmentObjectId:"",mode:pa.ALL},conditionLabels:{deleteCondition:"Delete Condition",resource:"Field",operator:"Operator",value:"Value"},conditionAssistiveText:{title:"Condition",deleteIcon:"Delete"},expressionLabels:{addCondition:"Add Rule Criteria",and:"AND",customLogic:"Custom Logic",customLogicPlaceholder:"(1 or 2)",modeAll:"All",modeAny:"Any",modeCustom:"Custom",takeAction:"Filter Logic",title:"Rule Criteria"},resources:[],errors:{name:[],assignmentObject:[],numberConditions:[],customLogic:[]},numericOperands:[{id:"==",title:this.$L("Assignment.Rules.NumericOperands.Equals")},{id:"!=",title:this.$L("Assignment.Rules.NumericOperands.NotEqualTo")},{id:"<",title:this.$L("Assignment.Rules.NumericOperands.LessThan")},{id:"<=",title:this.$L("Assignment.Rules.NumericOperands.LessThanorEqualTo")},{id:">",title:this.$L("Assignment.Rules.NumericOperands.GreaterThan")},{id:">=",title:this.$L("Assignment.Rules.NumericOperands.GreaterThanorEqualTo")}],textOperands:[{id:"==",title:this.$L("Assignment.Rules.TextOperands.Equals")},{id:"!=",title:this.$L("Assignment.Rules.TextOperands.NotEqualTo")},{id:"like",title:this.$L("Assignment.Rules.TextOperands.Contains")},{id:"doesnotcontain",title:this.$L("Assignment.Rules.TextOperands.DoesNotContain")},{id:"startsWith",title:this.$L("Assignment.Rules.TextOperands.StartsWith")}],booleanOperands:[{id:"==",title:this.$L("Assignment.Rules.BooleanOperands.Equals")},{id:"!=",title:this.$L("Assignment.Rules.BooleanOperands.NotEqualTo")}],booleanOptions:[{id:"false",title:"false"},{id:"true",title:"true"}]}},computed:{computedPopoverHeader(){return this.$props.rule?"Edit Assignment Rule":"Add Assignment Rule"},scopedNotificationErrors(){return[...this.errors.numberConditions]},customLogicErrors(){return[...this.errors.customLogic]}},async created(){this.rule?(this.localRule={id:this.rule.Id,name:this.rule.Name,assignmentObjectId:this.rule.sfsp__SalesAssignmentObject__c,mode:Symbol.for(`slds-vue-expression-${this.rule.sfsp__FilterLogic__c||"all"}`),customLogic:this.rule.sfsp__BooleanFilter__c,conditions:[]},this.onAssignmentObjectSelection(),this.localRule.conditions=(this.rule.sfsp__SalesNodeRuleItems__r||[]).map(e=>({id:e.Id,resource:e.sfsp__Field__c,operator:e.sfsp__Operator__c,value:e.sfsp__Value__c,allowValuePicklist:!0,operatorErrors:[],resourceErrors:[],valueErrors:[]})),this.localRule.conditions.forEach(e=>this.getOperators(e))):this.$store.assignmentObjects.length===1&&(this.localRule.assignmentObjectId=this.$store.assignmentObjects[0].id,this.onAssignmentObjectSelection())},methods:{closePopover(){this.$emit("close")},onAddCondition(){this.validateAssignmentObject(),!this.errors.assignmentObject.length&&(this.errors.numberConditions=[],this.localRule.conditions.length<=10&&this.localRule.conditions.push({...XT(),allowValuePicklist:!0}))},onCustomLogicChange(){this.errors.customLogic=[]},showValuePicklist(e){return["==","!="].includes(e.operator)&&this.getResourceDataType(e.resource)==="String"&&e.allowValuePicklist},onModeChange(e){this.$emit("update:useFilterLogic",e===pa.CUSTOM),this.$emit("update:filterLogic",e===pa.CUSTOM?this.getDefaultFilterLogicString():""),e!==pa.CUSTOM&&(this.localRule.customLogic="")},onAssignmentObjectSelection(){this.errors.assignmentObject=[],this.resetExpressionComponent();const e=this.$store.assignmentObjects.find(t=>t.id===this.localRule.assignmentObjectId);if(!e)return this.resources=[];this.resources=e.referenceFields.map(t=>{let s;return t.soapType==="boolean"?s="Boolean":s=t.type==="Text"?"String":"Number",{id:t.id,title:t.name,dataType:s}})},buildDefaultCondition(){return{...XT(),resource:null,resources:this.resources,allowValuePicklist:!0,resourceErrors:[],operatorErrors:[],valueErrors:[]}},getDefaultFilterLogicString(){return this.localRule.conditions.reduce((e,t,s)=>s===0?e:`${e} AND ${s+1}`,"1")},onResourceChange({index:e}){const t=this.localRule.conditions[e],s=this.resources.find(n=>n.id===t.resource);if(t.resourceErrors=[],t.operatorErrors=[],t.valueErrors=[],!s){this.onResetCondition({index:e});return}this.getOperators(t)},onValueInput(e){e.value&&(e.valueErrors=[])},getTextInputType(e){return"text"},getResourceDataType(e){const t=this.resources.find(s=>s.id===e);return t?t.dataType:null},getOperators(e){const t=this.getResourceDataType(e.resource);!t||(t==="String"?e.operators=this.textOperands:t==="Number"?e.operators=this.numericOperands:t==="Boolean"&&(e.operators=this.booleanOperands))},onDeleteCondition({index:e}){this.localRule.conditions.splice(e,1)},onResetCondition({index:e}){this.localRule.conditions[e].operators=[],this.localRule.conditions[e].value="",this.localRule.conditions[e].allowValuePicklist=!0},resetExpressionComponent(){!this.localRule.conditions.length||(this.localRule.conditions.splice(0,this.localRule.conditions.length-1),this.localRule.conditions[0].resource="",this.onResetCondition({index:0}))},checkForCompleteCondition(e){return!!e.resource&&!!e.operator},addRule(){if(!this.validateRule())return;const t=this.localRule.conditions.filter(this.checkForCompleteCondition).map(a=>{var o;return{id:a.id,ruleId:(o=this==null?void 0:this.rule)==null?void 0:o.Id,operator:a.operator,resource:a.resource,value:a.value}}),s=this.localRule.mode.toString(),n=s.substring(27,s.indexOf(")")),r={name:this.localRule.name,conditions:t,mode:n,customLogic:this.localRule.customLogic,assignmentObjectId:this.localRule.assignmentObjectId,id:this.localRule.id||Vn()};this.$emit("rule-added",r)},validateName(){this.errors.name=[],this.localRule.name||this.errors.name.push("Please enter a rule name"),this.localRule.name.length>80&&this.errors.name.push("Rule name should be less than 80 characters long")},validateAssignmentObject(){this.errors.assignmentObject=[],this.localRule.assignmentObjectId||this.errors.assignmentObject.push("Please select an object")},validateCustomLogic(){var e;return!this.localRule.customLogic||!SPM.Utils.Rule.validateCustomLogic(this.localRule.customLogic,((e=this.localRule.conditions)==null?void 0:e.length)||0)?(this.errors.customLogic.push("Custom Logic is invalid"),!1):!0},validateRule(){let e=!0;return this.errors.customLogic=[],this.errors.numberConditions=[],this.validateName(),this.validateAssignmentObject(),(this.errors.name.length||this.errors.assignmentObject.length)&&(e=!1),this.localRule.conditions.length?this.localRule.conditions.forEach(t=>{if(t.resourceErrors=[],t.operatorErrors=[],t.valueErrors=[],!this.checkForCompleteCondition(t))e=!1,t.resource||t.resourceErrors.push("Please enter a field"),t.operator||t.operatorErrors.push("Please enter an operator");else{const s=this.resources.filter(n=>n.id===t.resource);s.length>0&&s[0].dataType==="Number"&&(e=HK.validateNumberInput(t))}}):(this.errors.numberConditions.push("Please add at least one condition to the rule"),e=!1),this.localRule.mode===Symbol.for("slds-vue-expression-custom")&&(e=this.validateCustomLogic()&&e),e}}},WK={class:"max-height slds-scrollable_y"},YK={class:"slds-form-element slds-form-element_compound slds-m-bottom_small"},ZK={class:"slds-form-element__control"},XK={class:"slds-form-element__row"},KK={class:"slds-grid slds-grid_vertical-align-center"};function JK(e,t,s,n,r,a){const o=pe("ScopedNotification"),d=pe("TextInput"),p=pe("Picklist"),y=pe("ValuePicklist"),v=pe("Condition"),C=pe("Expression"),I=pe("SLDSButton"),O=pe("Popover");return L(),Ge(O,{width:"x-large",bindTo:e.$props.bindTo,alignment:"left",position:"fixed",onClose:a.closePopover},{header:je(()=>[es(Pe(a.computedPopoverHeader),1)]),content:je(()=>[k("div",WK,[a.scopedNotificationErrors.length?(L(),Ge(o,{key:0,id:"assignmentRuleScopedError",class:"slds-m-vertical_x-small",theme:"error"},{content:je(()=>[(L(!0),X(Lt,null,As(a.scopedNotificationErrors,(A,P)=>(L(),X("div",{key:P},Pe(A),1))),128))]),_:1})):$e("",!0),k("fieldset",YK,[k("div",ZK,[k("div",XK,[de(d,{id:"assignmentRuleName",modelValue:r.localRule.name,"onUpdate:modelValue":t[0]||(t[0]=A=>r.localRule.name=A),class:"slds-size_1-of-2",labels:{name:"Name"},errors:r.errors.name,onChanged:a.validateName},null,8,["modelValue","errors","onChanged"]),de(p,{id:"assignmentRuleAssignmentObjectPicklist",modelValue:r.localRule.assignmentObjectId,"onUpdate:modelValue":t[1]||(t[1]=A=>r.localRule.assignmentObjectId=A),options:e.$store.assignmentObjects,idKey:"id",titleKey:"label",class:"slds-grow",labels:{name:"Object"},errors:r.errors.assignmentObject,onSelectedOption:a.onAssignmentObjectSelection},null,8,["modelValue","options","errors","onSelectedOption"])])])]),de(C,{id:"assignmentRuleCriteria",mode:r.localRule.mode,"onUpdate:mode":t[2]||(t[2]=A=>r.localRule.mode=A),customLogic:r.localRule.customLogic,"onUpdate:customLogic":t[3]||(t[3]=A=>r.localRule.customLogic=A),class:$t(["expression",{"maximum-conditions":r.localRule.conditions.length>=10}]),labels:r.expressionLabels,customLogicErrors:a.customLogicErrors,onCustomLogicChange:a.onCustomLogicChange,onModeChange:a.onModeChange,onAddCondition:a.onAddCondition},{default:je(()=>[(L(!0),X(Lt,null,As(r.localRule.conditions,(A,P)=>(L(),Ge(v,{id:P,key:P,resource:A.resource,"onUpdate:resource":q=>A.resource=q,operator:A.operator,"onUpdate:operator":q=>A.operator=q,resources:r.resources,resourceErrors:A.resourceErrors,operators:A.operators,operatorErrors:A.operatorErrors,labels:r.conditionLabels,onDeleteCondition:a.onDeleteCondition,onResetCondition:a.onResetCondition,onResourceChange:a.onResourceChange},{value:je(()=>[k("div",{class:$t(["slds-col margin-top-auto",{"slds-grow-none":a.showValuePicklist(A)}])},[a.getResourceDataType(A.resource)==="Boolean"?(L(),Ge(p,{key:0,modelValue:A.value,"onUpdate:modelValue":q=>A.value=q,options:r.booleanOptions,labels:{name:r.conditionLabels.value},onSelectedOption:q=>a.onValueInput(A)},null,8,["modelValue","onUpdate:modelValue","options","labels","onSelectedOption"])):a.showValuePicklist(A)?(L(),Ge(y,{key:1,values:A.value,field:A.resource,label:r.conditionLabels.value,assignmentObjectId:r.localRule.assignmentObjectId,class:"value-picklist",style:{"min-width":"0px"},onValuesSelected:q=>A.value=q,onDisablePicklist:q=>A.allowValuePicklist=!1},null,8,["values","field","label","assignmentObjectId","onValuesSelected","onDisablePicklist"])):(L(),Ge(d,{key:2,modelValue:A.value,"onUpdate:modelValue":q=>A.value=q,disabled:!A.resource,type:a.getTextInputType(A),labels:{name:r.conditionLabels.value},errors:A.valueErrors,class:"spm-value-input",onChanged:q=>a.onValueInput(A)},null,8,["modelValue","onUpdate:modelValue","disabled","type","labels","errors","onChanged"]))],2)]),_:2},1032,["id","resource","onUpdate:resource","operator","onUpdate:operator","resources","resourceErrors","operators","operatorErrors","labels","onDeleteCondition","onResetCondition","onResourceChange"]))),128))]),_:1},8,["mode","customLogic","class","labels","customLogicErrors","onCustomLogicChange","onModeChange","onAddCondition"])])]),footer:je(()=>[k("div",KK,[de(I,{id:"assignmentRulePopoverCancelButton",class:"slds-col_bump-left",variant:"neutral",label:"Cancel",onClick:a.closePopover},null,8,["onClick"]),de(I,{id:"assignmentRulePopoverApplyButton",class:"slds-col_bump-left",iconCategory:"utility",iconName:"preview",variant:"neutral",label:"Preview",onClick:a.addRule},null,8,["onClick"])])]),_:1},8,["bindTo","onClose"])}const QK=os(GK,[["render",JK],["__scopeId","data-v-14eccbcb"]]),eJ={name:"NodePanel",components:{AssignmentRulePopover:QK,Button:Tn,ButtonIcon:vn,DataTable:Rm,Picklist:Qi,Spinner:Vr,ActionMenu:wa,ActionMenuItem:Sa,Tooltip:Fo,TextInput:Ko},emits:["rules-updated"],data(){return{loadingMsg:"",assignmentRulePopoverBindTo:null,showAssignmentRulePopover:!1,assignmentNode:null,assignmentRule:null,objects:this.$store.allObjects.map(e=>({id:e.id,label:e.label,isBoundary:e.containerSetId,rules:[],logic:"",editingLogic:!1})),columns:[{id:"name",name:"Rule Name"},{id:"object",name:"Object"},{id:"actions",name:""}],actions:[{id:"edit",label:"Edit",ignore:[]},{id:"delete",label:"Delete",ignore:["deleted"]},{id:"restore",label:"Restore",ignore:["active"]}],errors:{ruleLogic:[]}}},computed:{allRules(){return this.objects.reduce((e,t)=>e.concat(t.rules),[])},ruleLogicErrors(){return[...this.errors.ruleLogic]}},watch:{assignmentNode:{handler(){const e=(this.assignmentNode.previewRules||this.assignmentNode.rules).reduce((t,s)=>{const n=s.sfsp__SalesAssignmentObject__c||s.sfsp__SalesNodeBoundary__c;return t[n]=t[n]||[],t[n].push({id:s.Id||s.id,objectId:n,state:s.state||"active",rule:s}),t},{});this.objects.forEach(t=>{var s,n,r,a,o,d;t.rules=e[t.id]||[],this.updateRuleIndices({obj:t}),t.logic=((n=(s=this.assignmentNode)==null?void 0:s.previewRuleLogics)==null?void 0:n[t.id])||((a=(r=this.assignmentNode)==null?void 0:r.ruleLogics)==null?void 0:a[t.id])||(t.rules.length?Array(t.rules.length).fill().map((p,y)=>y+1).join(" or "):""),t.logicDirty=typeof((d=(o=this.assignmentNode)==null?void 0:o.previewRuleLogics)==null?void 0:d[t.id])<"u",t.editingLogic=!1}),this.previewAssignments({silent:!0})}}},async mounted(){SPM.Components.NodePanel=this},methods:{previewAssignments({assignmentObjectIds:e=this.$store.assignmentObjects.map(s=>s.id),silent:t=!1}){SPM.Components.Assignment.loadingMsg="Preparing Preview...";const{rulesToDelete:s,ruleItemsToDelete:n,rulesToUpsert:r,ruleItemsToUpsert:a}=this.getRuleChanges({currentRules:[...this.assignmentNode.rules],newRules:this.allRules.filter(d=>d.state!=="deleted").map(d=>d.rule)}),o=[...s.map(d=>d.Id),...r.map(d=>d.Id),...n.map(d=>d.sfsp__SalesNodeRule__c),...a.map(d=>d.sfsp__SalesNodeRule__c)];this.allRules.forEach(d=>d.dirty=!d.rule.Id||d.state==="deleted"||o.includes(d.rule.Id)),t||(this.savePreviewRules(),this.$store.showPreview=this.$store.allNodes.find(d=>d.previewRules||Object.keys(d.previewRuleLogics).length),this.$emit("rules-previewed",{assignmentObjectIds:e})),SPM.Components.Assignment.loadingMsg=""},getRuleChanges({currentRules:e,newRules:t}){const s=[],n=[],r=[],a=[];for(let o=e.length-1;o>=0;o--){const d=e[o],p=t.findIndex(I=>I.Id===d.Id);if(p===-1){s.push(d);continue}const y=t.splice(p,1)[0];["Name","sfsp__SalesAssignmentObject__c","sfsp__FilterLogic__c","sfsp__BooleanFilter__c"].some(I=>d[I]!==y[I])&&r.push(y);const v=[...d.sfsp__SalesNodeRuleItems__r],C=[...y.sfsp__SalesNodeRuleItems__r];for(let I=v.length-1;I>=0;I--){const O=v[I],A=C.findIndex(q=>q.Id===O.Id);if(A===-1){n.push(O);continue}const P=C.splice(A,1)[0];["sfsp__Field__c","sfsp__Operator__c","sfsp__Value__c"].some(q=>O[q]!==P[q])&&a.push(P)}a.push(...C)}return r.push(...t),{rulesToDelete:s,ruleItemsToDelete:n,rulesToUpsert:r,ruleItemsToUpsert:a}},getRuleTooltipContent(e){return SPM.Utils.Rule.toString(e)},cancelAssignments(){this.$store.showPreview&&(this.$store.allNodes.forEach(e=>{delete e.previewRules,e.previewRuleLogics={}}),this.$store.showPreview=!1,this.$emit("rules-previewed")),this.closeAssignmentRulePopover(),SPM.Components.Assignment.sidePanel=""},addRule(e){const t=this.objects.find(r=>r.id===e.assignmentObjectId);let s=this.allRules.find(r=>r.id===e.id);s||(s={},t.rules.push(s),t.logic+=t.logic?` or ${t.rules.length}`:"1",this.saveRuleLogic({obj:t,silent:!0}));const n=this.assignmentNode.rules.find(r=>r.Id===e.id);Object.assign(s,{id:e.id,objectId:e.assignmentObjectId,state:"active",index:t.rules.length,rule:{sobjectType:"sfsp__SalesNodeRule__c",Id:n==null?void 0:n.Id,Name:e.name,sfsp__SalesNode__c:this.assignmentNode.id,sfsp__SalesAssignmentObject__c:e.assignmentObjectId,sfsp__SortOrder__c:t.rules.length,sfsp__FilterLogic__c:e.mode,sfsp__BooleanFilter__c:e.mode==="custom"?e.customLogic:e.conditions.map((r,a)=>a+1).join(` ${e.mode==="all"?"and":"or"} `),sfsp__SalesNodeRuleItems__r:e.conditions.map((r,a)=>{var o;return{sobjectType:"sfsp__SalesNodeRuleItem__c",Id:(o=((n==null?void 0:n.sfsp__SalesNodeRuleItems__r)||[]).find(d=>d.Id===r.id))==null?void 0:o.Id,sfsp__SalesNodeRule__c:r.ruleId,sfsp__SortOrder__c:a,sfsp__Field__c:r.resource,sfsp__Operator__c:r.operator,sfsp__Value__c:r.value}})}}),this.previewAssignments({assignmentObjectIds:[s.rule.sfsp__SalesAssignmentObject__c]}),this.closeAssignmentRulePopover()},deleteRule(e){const t=this.objects.find(s=>s.id===e.objectId);e.rule.Id?e.state="deleted":t.rules.splice(t.rules.indexOf(e),1),t.logic=SPM.Utils.Filter.removeBooleanFilterExpression(t.logic,e.index),this.updateRuleIndices({obj:t}),this.saveRuleLogic({obj:t,silent:!0}),this.previewAssignments({assignmentObjectIds:[e.rule.sfsp__SalesAssignmentObject__c]})},restoreRule(e){e.state="active",this.previewAssignments({assignmentObjectIds:[e.rule.sfsp__SalesAssignmentObject__c]})},updateRuleIndices({obj:e}){let t=1;e.rules.forEach(s=>{s.state!=="deleted"&&(s.index=t++)})},saveRuleLogicAction({obj:e}){var t;if(this.errors.ruleLogic=[],!SPM.Utils.Rule.validateCustomLogic(e.logic,((t=e.rules)==null?void 0:t.length)||0)){this.errors.ruleLogic.push("Rule logic is invalid");return}this.saveRuleLogic({obj:e})},saveRuleLogic({obj:e,silent:t=!1}){var n,r;const s=((r=(n=this.assignmentNode.ruleLogics)==null?void 0:n[e.id])==null?void 0:r.sfsp__BooleanFilter__c)||(e.rules.length?Array(e.rules.length).fill().map((a,o)=>o+1).join(" or "):"");e.logic===s?(delete this.assignmentNode.previewRuleLogics[e.id],e.logicDirty=!1):(this.assignmentNode.previewRuleLogics[e.id]=e.logic,e.logicDirty=!0),e.editingLogic=!1,t||this.previewAssignments({assignmentObjectIds:[e.id]})},savePreviewRules(){this.assignmentNode.previewRules=this.allRules.find(e=>e.dirty)?this.allRules.map(e=>({id:e.id,state:e.state,...e.rule})):null},async saveRules(){this.loadingMsg="Saving Rules...";const e=[],t=[],s=[],n=[],r=[];this.$store.allNodes.forEach(a=>{if(a.previewRules){a.previewRules=a.previewRules.filter(d=>d.state!=="deleted"),a.previewRules.forEach(d=>{delete d.id,delete d.state});const o=this.getRuleChanges({currentRules:[...a.rules],newRules:[...a.previewRules]});e.push(...o.rulesToDelete),t.push(...o.ruleItemsToDelete),s.push(...o.rulesToUpsert),n.push(...o.ruleItemsToUpsert),a.rules=a.previewRules,delete a.previewRules}JSON.stringify(a.previewRuleLogics)!==JSON.stringify(a.ruleLogics)&&(a.ruleLogics=a.previewRuleLogics,a.previewRuleLogics={},r.push({sobjectType:"sfsp__SalesNode__c",Id:a.id,sfsp__RuleLogics__c:JSON.stringify(a.ruleLogics||{},0,4)}))}),await SPM.Utils.CRM.delete({records:[...e,...t].map(a=>({Id:a.Id})),onProgress:a=>this.loadingMsg=`Deleting Rules...${a}%`}),await SPM.Utils.CRM.upsert({records:s,onProgress:a=>this.loadingMsg=`Saving Rules...${a}%`}),s.forEach(a=>{a.sfsp__SalesNodeRuleItems__r.forEach(o=>{o.sfsp__SalesNodeRule__c||(o.sfsp__SalesNodeRule__c=a.Id,n.push(o))})}),await SPM.Utils.CRM.upsert({records:n,onProgress:a=>this.loadingMsg=`Saving Rule Items...${a}%`}),await SPM.Utils.CRM.upsert({records:r,onProgress:a=>this.loadingMsg=`Saving Rule Logic...${a}%`}),this.$store.showPreview=!1,this.$emit("rules-updated"),SPM.Components.RecordExplorer.reloadTable(),SPM.Components.Assignment.sidePanel=""},openAssignmentRulePopover({bindTo:e,assignmentRule:t}){this.assignmentRulePopoverBindTo=e,this.assignmentRule=t,this.showAssignmentRulePopover=!0},closeAssignmentRulePopover(){this.showAssignmentRulePopover=!1}}},tJ={class:"slds-panel slds-size_medium slds-panel_docked slds-panel_docked-right slds-panel_drawer slds-is-open","aria-hidden":"false"},sJ={class:"slds-grid slds-grid_vertical",style:{height:"100%"}},nJ={class:"slds-panel__header"},rJ={class:"slds-panel__header-title slds-text-heading_small slds-truncate"},iJ={class:"slds-panel__header-actions"},oJ={class:"slds-panel__body slds-grid slds-grid_vertical slds-grow"},aJ=k("div",{class:"slds-text-heading_small slds-m-top_large slds-m-bottom_xx-small"},"Rules",-1),lJ={style:{"font-weight":"700"}},cJ={key:1,class:"slds-grid slds-grid_vertical slds-align_absolute-center slds-m-top_large"},uJ=k("div",{class:"slds-text-heading_small slds-m-bottom_xx-small"},"No Boundaries Yet",-1),dJ=k("div",{class:"slds-text-body"},"Assign boundaries from the grid or map",-1),hJ=[uJ,dJ],pJ={class:"slds-grid slds-grid_vertical-align-center"},fJ={style:{"font-weight":"700"}},mJ=["onClick"],_J=["onClick"],gJ={key:1,class:"slds-grid slds-grid_vertical slds-align_absolute-center slds-m-top_large"},yJ=k("div",{class:"slds-text-heading_small slds-m-bottom_xx-small"},"No assignment rules yet",-1),vJ=k("div",{class:"slds-text-body"},"Create rules to start assigning records.",-1),bJ=[yJ,vJ],xJ={class:"slds-col_bump-top slds-grid"};function wJ(e,t,s,n,r,a){var P;const o=pe("Spinner"),d=pe("ButtonIcon"),p=pe("Picklist"),y=pe("Tooltip"),v=pe("TextInput"),C=pe("ActionMenuItem"),I=pe("ActionMenu"),O=pe("Button"),A=pe("AssignmentRulePopover");return L(),X("div",tJ,[k("div",sJ,[r.loadingMsg?(L(),Ge(o,{key:0},{description:je(()=>[es(Pe(r.loadingMsg),1)]),_:1})):$e("",!0),k("div",nJ,[k("h2",rJ,Pe(`${e.$store.isEditor?"Manage":"View"} Assignment Rules`),1),k("div",iJ,[de(d,{iconCategory:"utility",iconName:"close",title:"Collapse Panel Header",assistiveText:"Collapse Panel Header",onClick:a.cancelAssignments},null,8,["onClick"])])]),k("div",oJ,[de(p,{modelValue:(P=r.assignmentNode)==null?void 0:P.name,options:e.$store.scopeChildNodes,idKey:"id",titleKey:"name",labels:{name:"Node"},onSelectedOption:t[0]||(t[0]=q=>r.assignmentNode=e.$store.scopeChildNodes.find(ce=>ce.id===q.id))},null,8,["modelValue","options"]),aJ,(L(!0),X(Lt,null,As(r.objects,(q,ce)=>(L(),X("div",{key:q.id,ref_for:!0,ref:"objectRules",class:"spm-box slds-p-around_small slds-m-bottom_small"},[q.isBoundary?(L(),X(Lt,{key:0},[k("div",lJ,Pe(q.label),1),q.rules.length?(L(),Ge(y,{key:0,text:a.getRuleTooltipContent(q.rules[0].rule),alignment:"left"},{source:je(()=>[es(" Generated Boundary Rule ")]),_:2},1032,["text"])):(L(),X("div",cJ,hJ))],64)):(L(),X(Lt,{key:1},[k("div",pJ,[k("span",fJ,Pe(q.label),1),e.$store.isEditor?(L(),X("span",{key:0,class:"slds-col_bump-left slds-text-link",onClick:re=>a.openAssignmentRulePopover({bindTo:e.$refs.objectRules[ce],assignmentRule:{sfsp__SalesAssignmentObject__c:q.id}})},"New",8,mJ)):$e("",!0)]),q.rules.length>0?(L(),X(Lt,{key:0},[k("div",{class:$t(["slds-m-vertical_small",{"slds-is-edited":q.logicDirty}])},[q.editingLogic?(L(),Ge(v,{key:1,modelValue:q.logic,"onUpdate:modelValue":re=>q.logic=re,class:"slds-input-has-icon slds-input-has-icon_right",readonly:!e.$store.isEditor,errors:a.ruleLogicErrors},{extend:je(()=>[de(d,{iconCategory:"utility",iconName:"check",iconClass:["slds-button__icon"],class:"slds-button slds-button_icon slds-input__icon slds-input__icon_right",title:"Save",assistiveText:"Save",onClick:re=>a.saveRuleLogicAction({obj:q})},null,8,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","readonly","errors"])):(L(),X("button",{key:0,class:"slds-button_reset slds-grid slds-grid_vertical-align-center slds-m-vertical_xx-small",onClick:re=>q.editingLogic=!0},[es(Pe(q.logic)+" ",1),de(d,{class:"slds-p-horizontal_small",iconCategory:"utility",iconName:"edit",title:"Edit Filter Logic",assistiveText:"Edit Filter Logic"})],8,_J))],2),(L(!0),X(Lt,null,As(q.rules,(re,W)=>(L(),X("div",{key:W,ref_for:!0,ref:`rule-${q.id}-${W}`,class:$t(["slds-grid slds-grid_vertical-align-center slds-m-vertical_x-small",{"slds-is-edited":re.dirty}])},[de(y,{text:a.getRuleTooltipContent(re.rule),alignment:"left"},{source:je(()=>[es(Pe(`${re.state==="deleted"?"(Deleted)":`${re.index}.`} ${re.rule.Name}`),1)]),_:2},1032,["text"]),e.$store.isEditor?(L(),Ge(I,{key:0,class:"slds-col_bump-left"},{button:je(()=>[de(d,{iconCategory:"utility",iconName:"down",variant:"border-filled",size:"x-small",assistiveText:`${re.rule.Name} Actions`,title:`${re.rule.Name} Actions`},null,8,["assistiveText","title"])]),default:je(()=>[de(C,{label:"Edit",onClick:Ce=>a.openAssignmentRulePopover({bindTo:e.$refs[`rule-${q.id}-${W}`][0],assignmentRule:{...re.rule,Id:re.rule.Id||re.id}})},null,8,["onClick"]),re.state!=="deleted"?(L(),Ge(C,{key:0,label:"Delete",onClick:Ce=>a.deleteRule(re)},null,8,["onClick"])):$e("",!0),re.state!=="active"?(L(),Ge(C,{key:1,label:"Restore",onClick:Ce=>a.restoreRule(re)},null,8,["onClick"])):$e("",!0)]),_:2},1024)):$e("",!0)],2))),128))],64)):(L(),X("div",gJ,bJ))],64))]))),128)),k("div",xJ,[de(O,{class:"slds-grow",label:"Cancel",onClick:a.cancelAssignments},null,8,["onClick"]),de(O,{disabled:!e.$store.showPreview,class:"slds-grow",variant:"brand",label:"Apply",onClick:a.saveRules},null,8,["disabled","onClick"])])]),r.showAssignmentRulePopover?(L(),Ge(A,{key:1,id:"assignmentRulePopover",ref:"assignmentRulesPopover",bindTo:r.assignmentRulePopoverBindTo,rule:r.assignmentRule,onClose:a.closeAssignmentRulePopover,onRuleAdded:a.addRule},null,8,["bindTo","rule","onClose","onRuleAdded"])):$e("",!0)])])}const SJ=os(eJ,[["render",wJ]]),CJ={name:"Selectlist",components:{Icon:yn},props:["labels","options","modelValue","size","disabled"],data(){return{id:Vn(),selectedOption:this.modelValue}},watch:{modelValue(){this.selectedOption=this.modelValue},selectedOption(){this.$emit("update:modelValue",this.selectedOption)}},methods:{selectOption(e){this.disabled||(this.selectedOption=e)}}},IJ={key:0},TJ={class:"slds-form-element__label"},AJ={class:"spm-selectlist"},MJ=["onClick"],EJ={class:"slds-grid slds-grid_vertical-align-center"},kJ={class:"slds-radio"},PJ=["name","id","value","disabled"],RJ=["for"],$J=k("span",{class:"slds-radio_faux"},null,-1),OJ=[$J],LJ={class:"slds-m-left_small"},NJ={key:0,style:{color:"#747474"}};function DJ(e,t,s,n,r,a){var d;const o=pe("Icon");return L(),X("div",null,[(d=s.labels)!=null&&d.name?(L(),X("div",IJ,[k("label",TJ,Pe(s.labels.name),1)])):$e("",!0),k("div",AJ,[(L(!0),X(Lt,null,As(s.options,p=>(L(),X("div",{key:p.id,class:$t(["slds-p-horizontal_medium",`slds-p-vertical_${s.size||"medium"}`]),onClick:y=>a.selectOption(p.id)},[k("div",EJ,[k("span",kJ,[Mn(k("input",{name:`assignment-distribution-method-${p.id}`,"onUpdate:modelValue":t[0]||(t[0]=y=>r.selectedOption=y),type:"radio",id:`${r.id}${p.id}`,value:p.id,disabled:!!s.disabled},null,8,PJ),[[Ng,r.selectedOption]]),k("label",{class:"slds-radio__label",for:`${r.id}${p.id}`},OJ,8,RJ)]),p.icon?(L(),Ge(o,{key:0,category:"utility",name:p.icon,size:"x-small",class:"slds-m-left_small"},null,8,["name"])):$e("",!0),k("div",LJ,[k("div",{class:"slds-form-element__label",style:br(p.description?"font-weight: 600":"")},Pe(p.label),5),p.description?(L(),X("div",NJ,Pe(p.description),1)):$e("",!0)])]),r.selectedOption===p.id?js(e.$slots,"selected",kp(Ji({key:0},{option:p}))):$e("",!0)],10,MJ))),128))])])}const UR=os(CJ,[["render",DJ]]),BJ="/resource/1730930622617/sfsp__NodeBuilder/dist/vennDiagramNone.svg",PA="/resource/1730930622617/sfsp__NodeBuilder/dist/vennDiagramBalance.svg",RA="/resource/1730930622617/sfsp__NodeBuilder/dist/vennDiagramCompactness.svg",$A="/resource/1730930622617/sfsp__NodeBuilder/dist/vennDiagramContinuity.svg",OA="/resource/1730930622617/sfsp__NodeBuilder/dist/vennDiagramContinuityBalance.svg",LA="/resource/1730930622617/sfsp__NodeBuilder/dist/vennDiagramBalanceCompactness.svg",NA="/resource/1730930622617/sfsp__NodeBuilder/dist/vennDiagramContinuityCompactness.svg",DA="/resource/1730930622617/sfsp__NodeBuilder/dist/vennDiagramContinuityBalanceCompactness.svg",FJ={name:"BalancerVenn",components:{Tooltip:Fo},data(){return{tooltipSource:null,tooltipText:"",selectedAttribute:"balance",images:{vennDiagramNoneUrl:BJ,vennDiagramBalanceUrl:PA,vennDiagramCompactnessUrl:RA,vennDiagramContinuityUrl:$A,vennDiagramContinuityBalanceUrl:OA,vennDiagramBalanceCompactnessUrl:LA,vennDiagramContinuityCompactnessUrl:NA,vennDiagramContinuityBalanceCompactnessUrl:DA},attributeOptions:{balance:{label:"Balance",src:PA,altDescription:"Venn Diagram Balance",htmlDescription:"Prioritize balance.",weights:{balance:80,compactness:10,continuity:10},objectives:["balance"],detailedDescription:"Distribute record assignments equally across nodes."},compactness:{label:"Compactness",src:RA,altDescription:"Venn Diagram Compactness",htmlDescription:"Prioritize compactness.",weights:{balance:10,compactness:80,continuity:10},objectives:["compactness"],detailedDescription:"Minimize distances between records and boundaries."},continuity:{label:"Continuity",src:$A,altDescription:"Venn Diagram Continuity",htmlDescription:"Prioritize continuity.",weights:{balance:10,compactness:10,continuity:80},objectives:["continuity"],detailedDescription:"Change assignments across nodes only when necessary."},balanceContinuity:{label:"Balance and Continuity",src:OA,altDescription:"Venn Diagram Continuity + Balance",htmlDescription:"Prioritize a mix of balance and continuity.",weights:{balance:45,compactness:10,continuity:45},objectives:["balance","continuity"],detailedDescription:""},balanceCompactness:{label:"Balance and Compactness",src:LA,altDescription:"Venn Diagram Balance + Compactness",htmlDescription:"Prioritize a mix of balance and compactness.",weights:{balance:45,compactness:45,continuity:10},objectives:["balance","compactness"],detailedDescription:""},continuityCompactness:{label:"Continuity and Compactness",src:NA,altDescription:"Venn Diagram Continuity + Compactness",htmlDescription:"Prioritize a mix of continuity and compactness.",weights:{balance:10,compactness:45,continuity:45},objectives:["continuity","compactness"],detailedDescription:""},balanceContinuityCompactness:{label:"Balance, Continuity, and Compactness",src:DA,altDescription:"Venn Diagram Continuity + Balance + Compactness",htmlDescription:"Prioritize balance, continuity, and compactness equally.",weights:{balance:33,compactness:33,continuity:33},objectives:["balance","continuity","compactness"],detailedDescription:""}}}},computed:{selectedAttributeLabel(){return this.attributeOptions[this.selectedAttribute].label},selectedAttributeWeights(){return this.attributeOptions[this.selectedAttribute].weights},selectedAttributeObjectives(){return this.attributeOptions[this.selectedAttribute].objectives}},methods:{onMouseOverTooltip(e,t){t&&(this.tooltipSource=e.target,this.tooltipText=t)}}},zJ={id:"vennContainer",class:"slds-align--absolute-center"},UJ={id:"vennImagePositioner"},VJ=["src"],jJ=["src"],qJ=["src"],HJ=["src"],GJ=["src"],WJ=["src"],YJ=["src"],ZJ=["src"],XJ=ex('<div id="balanceLabel" class="slds-form-element slds-grid slds-grid_align-center"><div class="slds-truncate" title="Balance">Balance</div></div><div id="continuityLabel" class="slds-form-element slds-grid slds-grid_align-end"><div class="slds-truncate slds-col" title="Continuity">Continuity</div></div><div id="compactnessLabel" class="slds-form-element slds-grid"><div title="Compactness">Compactness</div></div>',3),KJ={id:"vennRadioGroup",class:"slds-form-element"},JJ=k("legend",{class:"slds-form-element__legend slds-form-element__label"},"Radio Group Label",-1),QJ={class:"slds-form-element__control"},eQ=["id"],tQ=["id","value"],sQ=["for"],nQ=["onMouseover"],rQ={class:"slds-form-element__label"};function iQ(e,t,s,n,r,a){const o=pe("Tooltip");return L(),X("div",zJ,[k("div",UJ,[Mn(k("img",{class:"venn-image",src:r.images.vennDiagramNoneUrl,alt:"Venn Diagram Balance"},null,8,VJ),[[Ai,r.selectedAttribute==""]]),Mn(k("img",{class:"venn-image",src:r.images.vennDiagramBalanceUrl,alt:"Venn Diagram Balance"},null,8,jJ),[[Ai,r.selectedAttribute=="balance"]]),Mn(k("img",{class:"venn-image",src:r.images.vennDiagramContinuityBalanceUrl,alt:"Venn Diagram Continuity and Balance"},null,8,qJ),[[Ai,r.selectedAttribute=="balanceContinuity"]]),Mn(k("img",{class:"venn-image",src:r.images.vennDiagramContinuityBalanceCompactnessUrl,alt:"Venn Diagram Continuity, Balance, and Compactness"},null,8,HJ),[[Ai,r.selectedAttribute=="balanceContinuityCompactness"]]),Mn(k("img",{class:"venn-image",src:r.images.vennDiagramBalanceCompactnessUrl,alt:"Venn Diagram Balance and Compactness"},null,8,GJ),[[Ai,r.selectedAttribute=="balanceCompactness"]]),Mn(k("img",{class:"venn-image",src:r.images.vennDiagramContinuityUrl,alt:"Venn Diagram Continuity"},null,8,WJ),[[Ai,r.selectedAttribute=="continuity"]]),Mn(k("img",{class:"venn-image",src:r.images.vennDiagramContinuityCompactnessUrl,alt:"Venn Diagram Continuity and Compactness"},null,8,YJ),[[Ai,r.selectedAttribute=="continuityCompactness"]]),Mn(k("img",{class:"venn-image",src:r.images.vennDiagramCompactnessUrl,alt:"Venn Diagram Compactness"},null,8,ZJ),[[Ai,r.selectedAttribute=="compactness"]])]),XJ,k("fieldset",KJ,[JJ,k("div",QJ,[r.tooltipSource?(L(),Ge(o,{key:0,class:"slds-m-right_small",source:r.tooltipSource,text:r.tooltipText},null,8,["source","text"])):$e("",!0),(L(!0),X(Lt,null,As(r.attributeOptions,(d,p)=>(L(),X("span",{id:`${p}RadioPositioner`,key:`${p}RadioPositioner`,class:"slds-radio"},[Mn(k("input",{id:`${p}Radio`,"onUpdate:modelValue":t[0]||(t[0]=y=>r.selectedAttribute=y),type:"radio",value:p,name:"selectedAttribute"},null,8,tQ),[[Ng,r.selectedAttribute]]),k("label",{class:"slds-radio__label",for:`${p}Radio`},[k("span",{class:"slds-radio_faux",onMouseover:y=>a.onMouseOverTooltip(y,d.detailedDescription)},null,40,nQ),k("span",rQ,Pe(d.label),1)],8,sQ)],8,eQ))),128))])])])}const oQ=os(FJ,[["render",iQ]]),aQ={name:"AssignmentPanel",components:{BalancerVenn:oQ,Button:Tn,ButtonIcon:vn,Icon:yn,Checkbox:za,Picklist:Qi,TextInput:Ko,Tooltip:Fo,Spinner:Vr,Selectlist:UR},props:["selectedObject"],emits:["rules-previewed","rules-updated"],data(){var e,t;return{loadingMsg:"",method:"evenDistribution",methodOptions:[{id:"evenDistribution",label:"Equally across nodes"},{id:"fixedDistribution",label:"Limited amount across nodes"},{id:"relatedFieldDistribution",label:"Proportional to a field's value"}],isDirty:!1,maxVolume:0,balanceField:"Unit",enableGeoAssignment:this.$store.preferences.AssignmentExplorer.mode==="Map"&&((t=(e=SPM.Components)==null?void 0:e.AssignmentMap)==null?void 0:t.useBoundaries),selectedNodeIds:[]}},computed:{useAutoAssignment(){const e=this.$store.preferences.AssignmentExplorer.mode==="Map"?this.assignmentType==="Boundaries":["Assignments","Boundaries"].includes(this.assignmentType);return this.selectedNodeIds.length>1&&e},geoAssignmentDisabled(){return(!this.selectedObject.latitude||!this.selectedObject.longitude)&&!this.selectedObject.containerSetId},balanceFieldOptions(){var e;if(this.assignmentType==="Boundaries"){const s=this.$store.assignmentObjects.filter(n=>{var r,a;return(a=(r=n.recordsDataset)==null?void 0:r.dimensions)==null?void 0:a.find(o=>o.id===this.selectedObject.name)}).reduce((n,r)=>{var o;return(((o=r.recordsDataset)==null?void 0:o.measures)||[]).forEach(d=>n[d.id]=d),n},{});return[{id:"Unit",title:"Related Assignment Objects"},...Object.values(s)]}return[{id:"Unit",title:this.selectedObject.label},...((e=this.selectedObject.recordsDataset)==null?void 0:e.measures)||[]]},selectionSummary(){return this.$store.preferences.AssignmentExplorer.mode==="Map"?SPM.Components.AssignmentMap.selectionSummary:SPM.Components.RecordExplorer.selectionSummary},selectionCounts(){return this.$store.allObjects.reduce((e,{id:t,label:s,icon:n})=>(this.selectionSummary.counts[t]&&e.push({id:t,label:s,icon:n,count:this.selectionSummary.counts[t]}),e),[])},assignmentType(){return this.$store.preferences.AssignmentExplorer.mode==="Map"?SPM.Components.AssignmentMap.selectionSummary.type:SPM.Components.RecordExplorer.selectionSummary.type},isMapMode(){return this.$store.preferences.AssignmentExplorer.mode==="Map"},useSingleAssignmentNode(){return this.isMapMode&&!SPM.Components.AssignmentMap.useBoundaries},assignmentMap(){return SPM.Components.AssignmentMap}},watch:{method:{handler(){this.resetAutoAssignment()}},useAutoAssignment:{handler(){this.resetAutoAssignment()}},"selectionSummary.aggregates":{handler(){this.markAssignmentDirty()}},enableGeoAssignment:{handler(){this.markAssignmentDirty()}},selectedNodeIds(){this.markAssignmentDirty()}},mounted(){SPM.Components.AssignmentPanel=this},methods:{markAssignmentDirty(){this.$store.showPreview&&(this.isDirty=!0)},resetAutoAssignment(){this.balanceField=this.method==="evenDistribution"?"Unit":"",this.maxVolume=0,this.markAssignmentDirty()},getRuleTooltipContent(e){return SPM.Utils.Rule.toString(e)},validatePreview(){switch(this.selectionSummary.type){case"Rules":if(this.selectedNodeIds.length!==1)return"Please select a single node.";if(this.selectionSummary.rules.length===0)return"Please select at least one group to assign.";break;case"Assignments":if(this.selectedNodeIds.length===0)return"Please select at least a single node.";if(this.selectionSummary.assignments.length===0)return"Please select at least one record to assign.";if(this.useAutoAssignment&&!this.balanceField)return"Please select a balance field.";if(this.useAutoAssignment&&this.method==="fixedDistribution"&&this.maxVolume===0)return"Please use a positive fixed amount.";if(this.useAutoAssignment&&!this.$refs.balancerVenn.selectedAttribute)return"Please select an assignment priority.";break;case"Boundaries":if(this.selectedNodeIds.length===0)return"Please select at least a single node.";if(this.selectionSummary.boundaries.length===0)return"Please select at least one boundary to assign.";if(this.useAutoAssignment&&!this.balanceField)return"Please select a balance field.";if(this.useAutoAssignment&&this.method==="fixedDistribution"&&this.maxVolume===0)return"Please use a positive fixed amount.";if(this.useAutoAssignment&&!this.$refs.balancerVenn.selectedAttribute)return"Please select an assignment priority.";break}},async previewAssignment(){const e=this.validatePreview();if(e)return this.$store.toast({message:e,state:"warning"});const t={},s=Object.values(this.selectedNodeIds.reduce((a,o)=>{let d=a[o]=this.$store.nodeMap[o];for(t[o]=[d];(d=this.$store.nodeMap[d.parentId])&&d!==this.$store.rootNode;)a[d.id]=d,t[d.id]=t[d.id]||[],t[d.id].push(this.$store.nodeMap[o]);return a},{}));let n={assignmentObjectIds:[this.selectedObject.id]},r=!1;switch(this.selectionSummary.type){case"Rules":s.forEach(y=>{var I;y.previewRules=[...y.rules,...this.selectionSummary.rules.map(O=>JSON.parse(JSON.stringify(O)))];const v=y.rules.filter(O=>O.sfsp__SalesAssignmentObject__c===this.selectedObject.id).length;let C=((I=y.ruleLogics)==null?void 0:I[this.selectedObject.id])||(v?Array(v).fill().map((O,A)=>A+1).join(" or "):"");this.selectionSummary.rules.forEach((O,A)=>C+=C?` or ${v+A+1}`:"1"),y.previewRuleLogics[this.selectedObject.id]=C});break;case"Assignments":const a=this.selectionSummary.assignments.map(y=>y.sfsp__RecordId__c),o=this.selectedNodeIds.reduce((y,v)=>(y[v]=a,y),{});if(this.useAutoAssignment){this.loadingMsg="Uploading Assignments...";const y=this.enableGeoAssignment?"contiguous":"nonContiguous",{scus:v,containerSetIds:C}=await SPM.Utils.AutoAssignment.buildAssignmentObjectScus({balanceField:this.balanceField,geoAssignment:y,selectedObject:this.selectedObject,selectedRecords:this.selectionSummary.records,targetNodeIds:this.selectedNodeIds}),I=await SPM.Utils.Rest.invoke("UploadAutoAssignmentData",{scus:v});if(!I)return this.loadingMsg="";console.log(`maioRequestId: ${I}`),this.loadingMsg="Processing SCUs...",await SPM.Utils.Apex.invoke("ProcessSCUs",[I]),this.loadingMsg="Optimizing Assignments...";const O=[I,this.$refs.balancerVenn.selectedAttributeObjectives,y,this.selectedNodeIds,this.method==="fixedDistribution"?this.maxVolume:"",Array.from(C)],{matoJobId:A}=await SPM.Utils.Apex.invoke("RunAutoAssignment",O);if(!A)return this.loadingMsg="";console.log(`matoJobId: ${A}`),await async function P(q){const ce=await SPM.Utils.Apex.invoke("GetStatusMATO",[A]);if(ce.JobStatus==="Completed"){const W=(await SPM.Utils.HTTP.get({url:ce.Solution.summary_file})).data.solutions.map((te,oe)=>Object.assign(te,{url:ce.Solution.solution_files[oe]})),Ce=(await SPM.Utils.HTTP.get({url:W[0].url})).data;q.selectedNodeIds.forEach(te=>{var oe;return o[te]=((oe=Ce.areas.find(ve=>ve.area_id===te))==null?void 0:oe.scu_ids)||[]})}else if(ce.JobStatus!=="Failed")await SPM.Utils.Async.wait(5e3),await P(q);else return q.loadingMsg="",q.$store.toast({message:ce.JobMessage.comment||"Error Running Auto Assignment",state:"error",duration:null})}(this)}if(s.forEach(y=>{const C=t[y.id].reduce((O,A)=>O.concat(o[A.id]),[]),I=y.assignments.filter(O=>O.sfsp__AssignmentType__c);if(this.assignmentType==="Assignments"&&C.length+I.length>1e4)return r=!0,this.$store.toast({message:`Assign up to 10,000 records in ${y.name}`,state:"error",duration:null});y.previewAssignments=[...y.assignments,...this.selectionSummary.assignments.filter(O=>C.includes(O.sfsp__RecordId__c)).map(O=>JSON.parse(JSON.stringify({...O,sfsp__AssignmentType__c:"Manual",sfsp__SalesNode__c:y.id})))]}),r)break;if(this.$store.rootNode.assignmentBehavior==="Exclusive"){const y=this.$store.assignmentObjects.map(I=>I.id),v=[this.$store.rootNode.id.replace("All Org",""),...SPM.Utils.Node.getAncestors({node:this.$store.rootNode,nodeMap:this.$store.nodeMap}).map(I=>I.id.replace("All Org",""))],C=(await SPM.Utils.Apex.invoke("Query",[`
                                SELECT sfsp__SalesNode__c, sfsp__SalesAssignmentObject__c, sfsp__AssignmentType__c, sfsp__RecordId__c, sfsp__Status__c
                                FROM sfsp__SalesNodeAssignment__c
                                WHERE sfsp__SalesAssignmentObject__c IN ('${y.join("','")}') AND sfsp__RecordId__c IN ('${a.join("','")}') AND sfsp__SalesNode__c NOT IN ('${v.join("','")}')
                            `])).reduce((I,O)=>(I[O.sfsp__SalesNode__c]=I[O.sfsp__SalesNode__c]||[],I[O.sfsp__SalesNode__c].push(O),I),{});Object.keys(C).forEach(I=>{const O=C[I].map(P=>P.sfsp__RecordId__c),A=this.$store.nodeMap[I];!A||(A.previewAssignments=[...A.previewAssignments||A.assignments],A.previewAssignments.forEach(P=>{O.includes(P.sfsp__RecordId__c)&&P.Id&&(P.sfsp__Status__c="Deleted")}))})}n={assignmentObjectIds:[...new Set(this.selectionSummary.assignments.map(y=>y.sfsp__SalesAssignmentObject__c))]},this.isMapMode&&SPM.Components.AssignmentMap.applySelection({redraw:!0});break;case"Boundaries":const d={},p=new Set;if(this.isMapMode)this.selectionSummary.boundaries.forEach(({id:y,objectId:v,nodeId:C})=>{p.add(v),d[y]={id:y,objectId:v,nodeId:C,targetNodeId:this.selectedNodeIds[0]}});else{const y=new Map;SPM.Components.RecordExplorer.boundary.rows.forEach(v=>{var C;return y.set(v.id,((C=v==null?void 0:v.node)==null?void 0:C.id)||"")}),this.selectionSummary.boundaries.forEach(v=>{p.add(this.selectedObject.id),d[v]={id:v,objectId:this.selectedObject.id,nodeId:y.has(v)?y.get(v):"",targetNodeId:this.selectedNodeIds[0]}})}if(this.useAutoAssignment){this.loadingMsg="Uploading Assignments...";const y=[];await SPM.Utils.Async.forEachParallel([...p],async O=>{await SPM.Utils.Async.forEachParallel([this.$store.rootNode,...this.selectedNodeIds.map(A=>this.$store.nodeMap[A])],async A=>{(await SPM.Utils.AutoAssignment.buildBoundaryObjectScus({balanceField:this.balanceField,selectedObject:this.$store.boundaryObjects.find(({id:q})=>q===O),selectedBoundaries:Object.values(d).filter(({objectId:q})=>q===O).map(({id:q})=>q),node:A})).forEach(q=>{var re;const ce=(re=d[q.Id])==null?void 0:re.nodeId;this.selectedNodeIds.includes(ce)&&(q.Assignment=ce),y.push(q)})})});const v=await SPM.Utils.Rest.invoke("UploadAutoAssignmentData",{scus:y});if(!v)return this.loadingMsg="";console.log(`maioRequestId: ${v}`),this.loadingMsg="Processing SCUs...",await SPM.Utils.Apex.invoke("ProcessSCUs",[v]),this.loadingMsg="Optimizing Assignments...";const C=[v,this.$refs.balancerVenn.selectedAttributeObjectives,this.enableGeoAssignment?"contiguous":"nonContiguous",this.selectedNodeIds,this.method==="fixedDistribution"?this.maxVolume:"",[this.selectedObject.containerSetId]],{matoJobId:I}=await SPM.Utils.Apex.invoke("RunAutoAssignment",C);if(!I)return this.loadingMsg="";console.log(`matoJobId: ${I}`),await async function O(A){const P=await SPM.Utils.Apex.invoke("GetStatusMATO",[I]);if(P.JobStatus==="Completed"){const ce=(await SPM.Utils.HTTP.get({url:P.Solution.summary_file})).data.solutions.map((W,Ce)=>Object.assign(W,{url:P.Solution.solution_files[Ce]}));(await SPM.Utils.HTTP.get({url:ce[0].url})).data.areas.forEach(W=>{W.scu_ids.forEach(Ce=>{d[Ce]&&(d[Ce].targetNodeId=W.area_id)})})}else if(P.JobStatus!=="Failed")await SPM.Utils.Async.wait(5e3),await O(A);else return A.loadingMsg="",A.$store.toast({message:P.JobMessage.comment||"Error Running Auto Assignment",state:"error",duration:null})}(this)}[...p].forEach(y=>{SPM.Utils.AssignmentObject.reassignBoundaries({objectId:y,reassignments:Object.values(d).filter(({objectId:v})=>v===y).map(({id:v,targetNodeId:C})=>({boundary:v,targetId:C})),isPreview:!0})}),n={boundaryObjectIds:[...p]},this.isMapMode&&Object.values(d).forEach(({id:y,objectId:v,targetNodeId:C})=>{SPM.Components.AssignmentMap.boundaryRecords[v].find(I=>I.id===y).previewNodeId=C});break}if(r){this.loadingMsg="",this.isDirty=!1;return}this.$store.showPreview=!0,this.isDirty=!1,this.$emit("rules-previewed",n),this.loadingMsg=""},async applyAssignment(){switch(this.selectionSummary.type){case"Rules":case"Boundaries":this.loadingMsg="Saving Rules...";const e=[],t=[],s=[];this.$store.allNodes.forEach(o=>{var p;(p=o.previewRules)!=null&&p.length&&s.push(...o.rules.filter(y=>{const v=this.isMapMode?this.selectionSummary.boundaries.filter(C=>C.objectId===y.sfsp__SalesNodeBoundary__c).length:y.sfsp__SalesNodeBoundary__c===this.selectionSummary.boundaryObject.id;if(y.Id&&v)return y})),o.rules=o.previewRules||o.rules,delete o.previewRules;const d=o.rules.filter(y=>y.sfsp__SalesAssignmentObject__c===this.selectedObject.id).length;o.rules.filter(y=>!y.Id).forEach((y,v)=>{y.sfsp__SalesNode__c=o.id,y.sfsp__SortOrder__c=d+v+1,e.push(y)}),JSON.stringify(o.previewRuleLogics)!==JSON.stringify(o.ruleLogics)&&(o.ruleLogics=o.previewRuleLogics,o.previewRuleLogics={},t.push({sobjectType:"sfsp__SalesNode__c",Id:o.id,sfsp__RuleLogics__c:JSON.stringify(o.ruleLogics||{},0,4)}))}),this.isMapMode&&Object.values(SPM.Components.AssignmentMap.boundaryRecords).flat().forEach(o=>{o.selected=!1,o.nodeId=o.previewNodeId||o.nodeId,delete o.previewNodeId}),await SPM.Utils.CRM.upsert({records:e,onProgress:o=>this.loadingMsg=`Saving Rules...${o}%`});const n=[];e.forEach(o=>{o.sfsp__SalesNodeRuleItems__r.forEach(d=>{d.sfsp__SalesNodeRule__c||(d.sfsp__SalesNodeRule__c=o.Id,n.push(d))})}),await SPM.Utils.CRM.upsert({records:n,onProgress:o=>this.loadingMsg=`Saving Rule Items...${o}%`}),await SPM.Utils.CRM.upsert({records:t,onProgress:o=>this.loadingMsg=`Saving Rule Logic...${o}%`}),await SPM.Utils.CRM.delete({records:s||[],onProgress:o=>this.loadingMsg=`Cleaning Up...${o}%`});break;case"Assignments":this.loadingMsg="Saving Assignments...";const r=[],a=[];if(this.$store.allNodes.forEach(o=>{if(o.previewAssignments){const d=[];o.previewAssignments.forEach(p=>{p.sfsp__Status__c==="Deleted"||this.$store.rootNode.assignmentBehavior==="Non-Exclusive"&&o.assignments.includes(p)?a.push(p):(r.push(p),d.push(p))}),o.assignments=d,delete o.previewAssignments}}),this.isMapMode){const o={};this.selectionSummary.assignments.forEach(p=>{o[p.sfsp__SalesAssignmentObject__c]=o[p.sfsp__SalesAssignmentObject__c]||{},o[p.sfsp__SalesAssignmentObject__c][p.sfsp__RecordId__c]=p});const d=SPM.Components.AssignmentMap.targetId;this.$store.preferences.Map.layers.filter(p=>p.type==="object").forEach(p=>{SPM.Components.AssignmentMap.map.getSource(`${p.id}-object`)._data.features.forEach(v=>{var I;((I=o==null?void 0:o[p.id])==null?void 0:I[v.properties.id])&&(v.properties.nodeId=d,v.properties.AssignedTo=SPM.$store.nodeMap[d].name,v.properties.color=SPM.$store.nodeMap[d].color,SPM.Components.AssignmentMap.map.setFeatureState({source:`${p.id}-object`,id:v.properties.id},{selected:v.properties.selected,nodeId:v.properties.nodeId,color:v.properties.color}))})})}await SPM.Utils.CRM.delete({records:a}),await SPM.Utils.CRM.upsert({records:r});break}this.$store.showPreview=!1,this.isDirty=!1,SPM.Components.Assignment.sidePanel="",this.isMapMode?(SPM.Components.AssignmentMap.targetId="",SPM.Components.AssignmentMap.$refs.assignmentTable.updateTable(),SPM.Components.AssignmentMap.applySelection({selection:[],reset:!0})):SPM.Components.RecordExplorer.reloadTable(),this.$emit("rules-updated")},cancelAssignment(e=!1){var t,s;this.$store.showPreview&&(this.$store.allNodes.forEach(n=>{delete n.previewRules,delete n.previewAssignments,n.assignments.forEach(r=>r.sfsp__Status__c="Active")}),Object.values(((s=(t=SPM.Components)==null?void 0:t.AssignmentMap)==null?void 0:s.boundaryRecords)||[]).flat().forEach(n=>delete n.previewNodeId),this.isMapMode&&(SPM.Components.AssignmentMap.targetId="",SPM.Components.AssignmentMap.applySelection({redraw:!0})),this.$store.showPreview=!1,this.$emit("rules-previewed")),e||(SPM.Components.Assignment.sidePanel="")},async updateAssignment(){this.cancelAssignment(!0),await this.$nextTick(),this.previewAssignment()},isNumber(e){const t=["0","1","2","3","4","5","6","7","8","9"],s=e.key;t.includes(s)||e.preventDefault()}}},dI=e=>(Nr("data-v-7c790874"),e=e(),Dr(),e),lQ={class:"slds-panel slds-size_medium slds-panel_docked slds-panel_docked-right slds-panel_drawer slds-is-open","aria-hidden":"false"},cQ={class:"slds-grid slds-grid_vertical",style:{height:"100%"}},uQ={class:"slds-panel__header"},dQ=dI(()=>k("h2",{class:"slds-panel__header-title slds-text-heading_small slds-truncate",title:"Assignment Rules"},"Assignment",-1)),hQ={class:"slds-panel__header-actions"},pQ={class:"slds-panel__body slds-grid slds-grid_vertical slds-grow",style:{overflow:"hidden"}},fQ={class:"slds-scrollable_y"},mQ={class:"slds-p-around_small"},_Q={class:"slds-p-top_xx-small"},gQ=dI(()=>k("label",{class:"slds-form-element__label slds-m-top_medium"},"Selection",-1)),yQ={class:"spm-selectlist"},vQ={class:"slds-m-left_x-small"},bQ={class:"spm-selection-summary-badge slds-col_bump-left"},xQ={key:0,class:"slds-p-around_small"},wQ={key:0,class:"slds-p-vertical_small"},SQ={key:1,class:"slds-p-vertical_small"},CQ=dI(()=>k("label",{class:"slds-form-element__label slds-m-bottom_xx-small"},"Priority",-1)),IQ={class:"slds-box slds-grid slds-grid_vertical-align-center slds-grid_align-center"},TQ={class:"slds-text-align_center",style:{width:"100%"}},AQ={class:"panel-footer slds-col_bump-top slds-grid slds-grid_vertical-align-center slds-p-around_small"},MQ={key:1,class:"slds-grow",style:{"margin-left":".25rem"}};function EQ(e,t,s,n,r,a){const o=pe("Spinner"),d=pe("ButtonIcon"),p=pe("Picklist"),y=pe("Icon"),v=pe("TextInput"),C=pe("Selectlist"),I=pe("Checkbox"),O=pe("BalancerVenn"),A=pe("Button"),P=pe("Tooltip");return L(),X("div",lQ,[k("div",cQ,[r.loadingMsg?(L(),Ge(o,{key:0},{description:je(()=>[es(Pe(r.loadingMsg),1)]),_:1})):$e("",!0),k("div",uQ,[dQ,k("div",hQ,[de(d,{iconCategory:"utility",iconName:"close",title:"Collapse Panel Header",assistiveText:"Collapse Panel Header",onClick:t[0]||(t[0]=q=>a.cancelAssignment())})])]),k("div",pQ,[k("div",fQ,[k("div",mQ,[a.useSingleAssignmentNode?(L(),Ge(p,{key:0,id:"assignment-node-search",modelValue:a.assignmentMap.targetId,"onUpdate:modelValue":t[1]||(t[1]=q=>a.assignmentMap.targetId=q),labels:{name:"Node"},options:e.$store.scopeChildNodes,idKey:"id",titleKey:"name",onSelectedOption:t[2]||(t[2]=q=>r.selectedNodeIds=[a.assignmentMap.targetId])},null,8,["modelValue","options"])):(L(),X(Lt,{key:1},[de(p,{id:"selected-assignment-node",modelValue:r.selectedNodeIds,"onUpdate:modelValue":t[3]||(t[3]=q=>r.selectedNodeIds=q),filterable:"",multiselect:"",labels:{name:`Nodes (${r.selectedNodeIds.length})`},options:e.$store.scopeChildNodes,idKey:"id",titleKey:"name"},null,8,["modelValue","labels","options"]),k("div",_Q,[k("span",{id:"assignment-select-all",class:"slds-text-link",onClick:t[4]||(t[4]=q=>r.selectedNodeIds=e.$store.scopeChildNodes.map(ce=>ce.id))},"All"),es(" | "),k("span",{id:"assignment-select-none",class:"slds-text-link",onClick:t[5]||(t[5]=q=>r.selectedNodeIds=[])},"None")])],64)),a.selectionCounts.length?(L(),X(Lt,{key:2},[gQ,k("div",yQ,[(L(!0),X(Lt,null,As(a.selectionCounts,q=>(L(),X("div",{key:q.id,class:"slds-grid slds-grid_vertical-align-center slds-p-around_small"},[de(y,{category:q.icon.category,name:q.icon.name,size:"small"},null,8,["category","name"]),k("span",vQ,Pe(q.label),1),k("span",bQ,Pe(e.$F("Numeric",q.count)),1)]))),128))])],64)):$e("",!0)]),a.useAutoAssignment?(L(),X("div",xQ,[de(C,{modelValue:r.method,"onUpdate:modelValue":t[11]||(t[11]=q=>r.method=q),labels:{name:"Distribution Method"},options:r.methodOptions,class:"slds-m-bottom_medium"},{selected:je(({option:q})=>[q.id==="fixedDistribution"?(L(),X("div",wQ,[de(p,{modelValue:r.balanceField,"onUpdate:modelValue":t[6]||(t[6]=ce=>r.balanceField=ce),class:"slds-m-top_small",filterable:"",required:"",labels:{name:"Balance On",placeholder:"Search..."},options:a.balanceFieldOptions,idKey:"id",titleKey:"title"},null,8,["modelValue","labels","options"]),de(v,{modelValue:r.maxVolume,"onUpdate:modelValue":t[7]||(t[7]=ce=>r.maxVolume=ce),modelModifiers:{number:!0},class:"slds-m-top_small",required:"",labels:{name:"Maximum Value",placeholder:"Enter Number..."},onKeypress:t[8]||(t[8]=ce=>a.isNumber(ce)),"onUpdate:hasFocus":t[9]||(t[9]=()=>{r.maxVolume||(r.maxVolume=0)})},null,8,["modelValue","labels"])])):$e("",!0),q.id==="relatedFieldDistribution"?(L(),X("div",SQ,[de(p,{modelValue:r.balanceField,"onUpdate:modelValue":t[10]||(t[10]=ce=>r.balanceField=ce),class:"slds-m-top_small",filterable:"",required:"",labels:{name:"Balance On",placeholder:"Search..."},options:a.balanceFieldOptions.filter(ce=>ce.id!=="Unit"),idKey:"id",titleKey:"title"},null,8,["modelValue","labels","options"])])):$e("",!0)]),_:1},8,["modelValue","options"]),de(I,{id:"assignment-geographic-assignment",modelValue:r.enableGeoAssignment,"onUpdate:modelValue":t[12]||(t[12]=q=>r.enableGeoAssignment=q),class:"slds-m-bottom_small",labels:{name:"Allow geographic assignment"},disabled:a.geoAssignmentDisabled},null,8,["modelValue","disabled"]),CQ,k("div",IQ,[k("div",TQ,[de(O,{ref:"balancerVenn"},null,512)])])])):$e("",!0)]),k("div",AQ,[de(A,{class:"slds-grow",label:"Cancel",onClick:t[13]||(t[13]=q=>a.cancelAssignment())}),a.assignmentType==="Manual"&&e.$store.salesAsyncJobs.length>0?(L(),Ge(P,{key:0,class:"slds-grow",text:"Add manual assignments after planning elements finish processing.",alignment:"left",style:{"margin-left":".25rem"}},{source:je(()=>[e.$store.showPreview?$e("",!0):(L(),Ge(A,{key:0,class:"slds-grow",variant:"brand",label:"Preview",disabled:"",style:{width:"100%"},onClick:a.previewAssignment},null,8,["onClick"])),e.$store.showPreview&&!r.isDirty?(L(),Ge(A,{key:1,class:"slds-grow",variant:"brand",label:"Apply",disabled:"",style:{width:"100%"},onClick:a.applyAssignment},null,8,["onClick"])):$e("",!0),r.isDirty&&e.$store.showPreview?(L(),Ge(A,{key:2,class:"slds-grow",variant:"brand",label:"Update",disabled:"",style:{width:"100%"},onClick:a.updateAssignment},null,8,["onClick"])):$e("",!0)]),_:1},8,["text"])):(L(),X("div",MQ,[e.$store.showPreview?$e("",!0):(L(),Ge(A,{key:0,id:"assignment-preview",class:"slds-grow",variant:"brand",label:"Preview",style:{width:"100%"},onClick:a.previewAssignment},null,8,["onClick"])),e.$store.showPreview&&!r.isDirty?(L(),Ge(A,{key:1,id:"assignment-apply",class:"slds-grow",variant:"brand",label:"Apply",style:{width:"100%"},onClick:a.applyAssignment},null,8,["onClick"])):$e("",!0),r.isDirty&&e.$store.showPreview?(L(),Ge(A,{key:2,id:"assignment-update",class:"slds-grow",variant:"brand",label:"Update",style:{width:"100%"},onClick:a.updateAssignment},null,8,["onClick"])):$e("",!0)]))])])])])}const kQ=os(aQ,[["render",EQ],["__scopeId","data-v-7c790874"]]),PQ={name:"FilterPopover",components:{Button:Tn,Popover:Uc,Picklist:Qi,TextInput:Ko,ValuePicklist:zR},props:["bindTo","filter"],emits:["apply-filter"],data(){return{field:"",operator:"",value:"",numericOperands:[{id:"==",title:this.$L("Assignment.Rules.NumericOperands.Equals")},{id:"!=",title:this.$L("Assignment.Rules.NumericOperands.NotEqualTo")},{id:"<",title:this.$L("Assignment.Rules.NumericOperands.LessThan")},{id:"<=",title:this.$L("Assignment.Rules.NumericOperands.LessThanorEqualTo")},{id:">",title:this.$L("Assignment.Rules.NumericOperands.GreaterThan")},{id:">=",title:this.$L("Assignment.Rules.NumericOperands.GreaterThanorEqualTo")}],textOperands:[{id:"==",title:this.$L("Assignment.Rules.TextOperands.Equals")},{id:"!=",title:this.$L("Assignment.Rules.TextOperands.NotEqualTo")},{id:"like",title:this.$L("Assignment.Rules.TextOperands.Contains")},{id:"doesnotcontain",title:this.$L("Assignment.Rules.TextOperands.DoesNotContain")},{id:"startsWith",title:this.$L("Assignment.Rules.TextOperands.StartsWith")}],allowValuePicklist:!0}},computed:{assignmentObject(){return SPM.Components.RecordExplorer.selectedObject},showValuePicklist(){return["==","!="].includes(this.operator)&&this.dataType==="Text"&&this.allowValuePicklist},fields(){if(SPM.Components.RecordExplorer.mode==="Boundary"){const e=this.$store.containerSets[SPM.Components.RecordExplorer.selectedObject.containerSetId];return[{title:"Boundary",options:[{id:"label",title:e.label,type:"Text"},...Object.entries(e.metadata).filter(([t,s])=>s.visible).map(([t,s])=>({id:t,title:s.label,type:s.type==="string"?"Text":"Numeric"}))]}]}return SPM.Components.RecordExplorer.computedDatasetFields},dataType(){if(!this.field)return"";if(SPM.Components.RecordExplorer.mode==="Boundary")return this.fields[0].options.find(s=>s.id===this.field).type;const[{options:e},{options:t}]=this.fields;return e.find(s=>s.id===this.field)?"Text":t.find(s=>s.id===this.field)?"Numeric":""},operators(){return this.dataType==="Text"?this.textOperands:this.dataType==="Numeric"?this.numericOperands:[]}},beforeMount(){this.field=this.filter.field,this.operator=this.filter.operator,this.value=this.filter.value},mounted(){SPM.Components.FilterPopover=this},methods:{applyFilter(){Object.assign(this.filter,{field:this.field,operator:this.operator,value:this.value,dataType:this.dataType}),this.$emit("apply-filter")},onFieldPicklistClear(){this.value="",this.allowValuePicklist=!0}}},RQ={class:"max-height slds-scrollable_y"},$Q={class:"slds-grid slds-grid_vertical-align-center"};function OQ(e,t,s,n,r,a){const o=pe("Picklist"),d=pe("ValuePicklist"),p=pe("TextInput"),y=pe("Button"),v=pe("Popover");return L(),Ge(v,{id:"filter-popover",width:"x-large",bindTo:e.$props.bindTo,alignment:"left",position:"fixed",onClose:t[6]||(t[6]=C=>e.$emit("close"))},{header:je(()=>[es("Filter")]),content:je(()=>[k("div",RQ,[de(o,{id:"filter-by",modelValue:r.field,"onUpdate:modelValue":t[0]||(t[0]=C=>r.field=C),filterable:"",options:a.fields,labels:{name:"Filter By"},onClear:a.onFieldPicklistClear},null,8,["modelValue","options","onClear"]),de(o,{id:"filter-operator",modelValue:r.operator,"onUpdate:modelValue":t[1]||(t[1]=C=>r.operator=C),disabled:!r.field,options:a.operators,labels:{name:"Operator"}},null,8,["modelValue","disabled","options"]),a.showValuePicklist?(L(),Ge(d,{key:0,id:"filter-value",values:r.value,field:r.field,label:"Value",assignmentObjectId:a.assignmentObject.id,onValuesSelected:t[2]||(t[2]=C=>r.value=C),onDisablePicklist:t[3]||(t[3]=C=>r.allowValuePicklist=!1)},null,8,["values","field","assignmentObjectId"])):(L(),Ge(p,{key:1,id:"filter-value",modelValue:r.value,"onUpdate:modelValue":t[4]||(t[4]=C=>r.value=C),disabled:!r.field,labels:{name:"Value"}},null,8,["modelValue","disabled"]))])]),footer:je(()=>[k("div",$Q,[de(y,{class:"slds-col_bump-left",variant:"neutral",label:"Cancel",onClick:t[5]||(t[5]=C=>e.$emit("close"))}),de(y,{class:"slds-col_bump-left",variant:"brand",label:"Apply",onClick:a.applyFilter},null,8,["onClick"])])]),_:1},8,["bindTo"])}const LQ=os(PQ,[["render",OQ]]),NQ={name:"FilterPanel",components:{FilterPopover:LQ,Button:Tn,ButtonIcon:vn,TextInput:Ko,Picklist:Qi,Spinner:Vr},data(){return{loadingMsg:"",filterLogic:this.$store.filterLogic,editingFilterLogic:!1,filterPopoverBindTo:null,showFilterPopover:!1,selectedFilter:null}},watch:{"$store.filterLogic":{handler(e){this.filterLogic=e}}},async mounted(){SPM.Components.FilterPanel=this},methods:{closeFilters(){SPM.Components.Assignment.sidePanel=""},async openFilter({bindTo:e,filter:t}){this.showFilterPopover=!1,await this.$nextTick(),t=t||{field:"",operator:"",value:"",dataType:"Text"},this.filterPopoverBindTo=e,this.selectedFilter=t,this.showFilterPopover=!0},applyFilter(){const e=this.$store.filters.findIndex(t=>t===this.selectedFilter);e===-1?(this.$store.filters.push(this.selectedFilter),this.filterLogic=this.$store.filterLogic+=this.$store.filterLogic?` and ${this.$store.filters.length}`:"1"):this.$store.filters.splice(e,1,this.selectedFilter),this.showFilterPopover=!1,SPM.Components.RecordExplorer.reloadTable()},removeFilter(e){this.showFilterPopover=!1,this.$store.filters.splice(e,1),this.$store.filterLogic=SPM.Utils.Filter.removeBooleanFilterExpression(this.$store.filterLogic,e+1),SPM.Components.RecordExplorer.reloadTable()},removeAllFilters(){this.showFilterPopover=!1,this.$store.filters.splice(0),this.filterLogic=this.$store.filterLogic="",SPM.Components.RecordExplorer.reloadTable()},changeAssignedToSelection(){SPM.Components.RecordExplorer.reloadTable()},saveFilterLogic(){this.$store.filterLogic=this.filterLogic,this.editingFilterLogic=!1,SPM.Components.RecordExplorer.reloadTable()}}},Ug=e=>(Nr("data-v-6c99454f"),e=e(),Dr(),e),DQ={id:"filter-sidepanel",class:"slds-panel slds-size_medium slds-panel_docked slds-panel_docked-right slds-panel_drawer slds-is-open","aria-hidden":"false"},BQ={class:"slds-grid slds-grid_vertical",style:{height:"100%"}},FQ={class:"slds-panel__header"},zQ=Ug(()=>k("h2",{class:"slds-panel__header-title slds-text-heading_small slds-truncate",title:"Filter"},"Filter",-1)),UQ={class:"slds-panel__header-actions"},VQ={class:"slds-panel__body slds-grid slds-grid_vertical slds-grow"},jQ=Ug(()=>k("div",{class:"slds-text-heading_small slds-m-bottom_medium"},"Assigned To",-1)),qQ=Ug(()=>k("div",{class:"slds-text-heading_small slds-m-vertical_medium"},"Record Filters",-1)),HQ={key:0,class:"slds-grid slds-grid_vertical slds-align_absolute-center"},GQ=Ug(()=>k("div",{name:"no-filters-yet",class:"slds-text-heading_small slds-m-bottom_xx-small"},"No filters yet",-1)),WQ=Ug(()=>k("div",{name:"no-filters-yet",class:"slds-text-body"},"View specific records using filters.",-1)),YQ=Ug(()=>k("div",{class:"slds-text-body_small slds-text-title_caps"},"Include Rows Matching",-1)),ZQ={class:"slds-grid slds-grid_vertical-align-center slds-p-horizontal_x-small",style:{background:"#d9dbdd"}},XQ=["onClick"],KQ={class:"spm-filter-value"},JQ={ref:"filter-controls",class:"slds-grid slds-grid_align-spread slds-p-horizontal_small"};function QQ(e,t,s,n,r,a){const o=pe("Spinner"),d=pe("ButtonIcon"),p=pe("Picklist"),y=pe("Button"),v=pe("TextInput"),C=pe("FilterPopover");return L(),X("div",DQ,[k("div",BQ,[r.loadingMsg?(L(),Ge(o,{key:0},{description:je(()=>[es(Pe(r.loadingMsg),1)]),_:1})):$e("",!0),k("div",FQ,[zQ,k("div",UQ,[de(d,{iconCategory:"utility",iconName:"close",title:"Collapse Panel Header",assistiveText:"Collapse Panel Header",onClick:a.closeFilters},null,8,["onClick"])])]),k("div",VQ,[jQ,de(p,{id:"filter-node-search",modelValue:e.$store.filteredNodeIds,"onUpdate:modelValue":t[0]||(t[0]=I=>e.$store.filteredNodeIds=I),filterable:"",multiselect:"",options:e.$store.scopeNodes,idKey:"id",titleKey:"name",onSelectedOption:a.changeAssignedToSelection},null,8,["modelValue","options","onSelectedOption"]),qQ,e.$store.filters.length===0?(L(),X("div",HQ,[GQ,WQ,de(y,{id:"add-filter",class:"slds-grow slds-m-top_medium",label:"Add Filter",onClick:t[1]||(t[1]=I=>a.openFilter({bindTo:I.currentTarget}))})])):(L(),X(Lt,{key:1},[YQ,r.editingFilterLogic?(L(),Ge(v,{key:1,modelValue:r.filterLogic,"onUpdate:modelValue":t[3]||(t[3]=I=>r.filterLogic=I),class:"slds-input-has-icon slds-input-has-icon_right"},{extend:je(()=>[de(d,{iconCategory:"utility",iconName:"check",iconClass:["slds-button__icon"],class:"slds-button slds-button_icon slds-input__icon slds-input__icon_right",title:"Save",assistiveText:"Save",onClick:a.saveFilterLogic},null,8,["onClick"])]),_:1},8,["modelValue"])):(L(),X("button",{key:0,class:"slds-button_reset slds-grid slds-grid_vertical-align-center slds-m-vertical_xx-small",onClick:t[2]||(t[2]=I=>r.editingFilterLogic=!0)},[es(Pe(e.$store.filterLogic)+" ",1),de(d,{class:"slds-p-horizontal_small",iconCategory:"utility",iconName:"edit",title:"Edit Filter Logic",assistiveText:"Edit Filter Logic"})])),(L(!0),X(Lt,null,As(e.$store.filters,(I,O)=>(L(),X("div",{key:O,ref_for:!0,ref:`filter-${O}`,class:"spm-box slds-m-top_small slds-grid slds-grid_vertical_align_center"},[k("div",ZQ,Pe(O+1),1),k("button",{class:"slds-button_reset slds-grow slds-p-around_x-small",onClick:A=>a.openFilter({bindTo:e.$refs[`filter-${O}`][0],filter:I})},[k("div",null,Pe(I.field),1),k("div",KQ,Pe(I.operator)+" "+Pe(I.value),1)],8,XQ),de(d,{class:"slds-col_bump-left slds-p-horizontal_small",iconCategory:"utility",iconName:"delete",title:"Remove Filter",assistiveText:"Remove Filter",onClick:A=>a.removeFilter(O)},null,8,["onClick"])]))),128)),k("div",JQ,[k("button",{class:"slds-button",onClick:t[4]||(t[4]=I=>a.openFilter({bindTo:e.$refs["filter-controls"]}))},"Add Filter"),k("button",{class:"slds-button",onClick:t[5]||(t[5]=(...I)=>a.removeAllFilters&&a.removeAllFilters(...I))},"Remove All")],512)],64))]),r.showFilterPopover?(L(),Ge(C,{key:1,bindTo:r.filterPopoverBindTo,filter:r.selectedFilter,onApplyFilter:a.applyFilter,onClose:t[6]||(t[6]=I=>r.showFilterPopover=!1)},null,8,["bindTo","filter","onApplyFilter"])):$e("",!0)])])}const eee=os(NQ,[["render",QQ],["__scopeId","data-v-6c99454f"]]),tee={name:"Layer",components:{Icon:yn,Button:Tn,ButtonIcon:vn},props:["layer"],emits:["edit-layer"],data(){return{}},methods:{edit(){SPM.Components.LayersPanel.editLayer({layer:this.layer,bindTo:this.$refs.popoverAnchor})},toggleVisibility(){this.layer.styles.visible=!this.layer.styles.visible,SPM.Components.LayersPanel.refreshLayer({layer:this.layer}),this.$store.savePreferences()},getLayerSymbol(e){return SPM.Utils.Map.Symbols[e.styles.markerSymbol].svg}}},see={class:"slds-grid slds-grid_vertical-align-center slds-p-around_small slds-nowrap"},nee={ref:"popoverAnchor"},ree=["innerHTML"],iee={class:"slds-m-left_small"},oee={class:"slds-button-group-row slds-col_bump-left"},aee={key:0,class:"slds-button-group-item"},lee={class:"slds-button-group-item"};function cee(e,t,s,n,r,a){const o=pe("Icon"),d=pe("ButtonIcon");return L(),X("div",see,[k("div",nee,null,512),s.layer.icon?(L(),Ge(o,{key:0,category:"utility",name:s.layer.icon,size:"x-small"},null,8,["name"])):(L(),X("div",{key:1,class:"spm-layer-symbol slds-icon-text-default","aria-hidden":"true",innerHTML:a.getLayerSymbol(s.layer)},null,8,ree)),k("span",iee,Pe(s.layer.label),1),k("ul",oee,[["boundary","object"].includes(s.layer.type)?(L(),X("li",aee,[de(d,{iconCategory:"utility",iconName:"edit",class:"slds-button-spacing",size:"small",variant:"container",title:"Edit",assistiveText:"Edit",onClick:a.edit},null,8,["onClick"])])):$e("",!0),k("li",lee,[de(d,{iconCategory:"utility",iconName:"preview","aria-pressed":s.layer.styles.visible,size:"small",variant:"border-filled",class:$t(["slds-button-spacing",{"slds-is-selected":s.layer.styles.visible}]),title:s.layer.styles.visible?"Hide":"Show",assistiveText:s.layer.styles.visible?"Hide":"Show",onClick:a.toggleVisibility},null,8,["aria-pressed","class","title","assistiveText","onClick"])])])])}const uee=os(tee,[["render",cee],["__scopeId","data-v-3d99352e"]]),dee={name:"LayerPopover",components:{Button:Tn,Popover:Uc,Picklist:Qi,Slider:BR},props:["bindTo","layer"],emits:["close"],data(){return{currentStyles:{}}},computed:{markerSymbolOptions(){return Object.entries(SPM.Utils.Map.Symbols).map(([e,{label:t}])=>({id:e,label:t}))},markerSizeOptions(){return Array(43).fill("").map((e,t)=>t+6)}},watch:{"layer.styles":{handler(){SPM.Components.LayersPanel.refreshLayer({layer:this.layer})},deep:!0}},beforeMount(){this.currentStyles={...this.layer.styles}},mounted(){SPM.Components.LayerPopover=this},methods:{applyChanges(){this.$store.savePreferences(),this.$emit("close")},async cancel(){Object.assign(this.layer.styles,this.currentStyles),await this.$nextTick(),this.$emit("close")}}},hee={class:"max-height slds-scrollable_y"},pee={class:"slds-grid slds-grid_vertical-align-center"};function fee(e,t,s,n,r,a){const o=pe("Slider"),d=pe("Picklist"),p=pe("Button"),y=pe("Popover");return L(),Ge(y,{width:"x-large",bindTo:e.$props.bindTo,alignment:"left",position:"fixed",onClose:t[3]||(t[3]=v=>e.$emit("close"))},{header:je(()=>[es("Edit Layer")]),content:je(()=>[k("div",hee,[s.layer.type==="boundary"?(L(),Ge(o,{key:0,modelValue:s.layer.styles.opacity*100,label:"Opacity",hideRangeLabel:"",min:"1",max:"100",onChange:t[0]||(t[0]=v=>s.layer.styles.opacity=v.target.value/100)},null,8,["modelValue"])):$e("",!0),s.layer.type==="object"?(L(),X(Lt,{key:1},[de(d,{modelValue:s.layer.styles.markerSymbol,"onUpdate:modelValue":t[1]||(t[1]=v=>s.layer.styles.markerSymbol=v),labels:{name:"Marker "},options:a.markerSymbolOptions,idKey:"id",titleKey:"label"},null,8,["modelValue","options"]),de(d,{modelValue:s.layer.styles.markerSize,"onUpdate:modelValue":t[2]||(t[2]=v=>s.layer.styles.markerSize=v),modelModifiers:{number:!0},labels:{name:"Size "},options:a.markerSizeOptions},null,8,["modelValue","options"])],64)):$e("",!0)])]),footer:je(()=>[k("div",pee,[de(p,{class:"slds-col_bump-left",variant:"neutral",label:"Cancel",onClick:a.cancel},null,8,["onClick"]),de(p,{class:"slds-col_bump-left",variant:"brand",label:"Apply",onClick:a.applyChanges},null,8,["onClick"])])]),_:1},8,["bindTo"])}const mee=os(dee,[["render",fee]]),_ee={name:"FilterPanel",components:{Button:Tn,ButtonIcon:vn,Spinner:Vr,Layer:uee,LayerPopover:mee},data(){return{loadingMsg:"",layerPopover:{show:!1,bindTo:null,layer:null}}},computed:{useBoundaries(){return SPM.Components.AssignmentMap.useBoundaries}},async mounted(){SPM.Components.LayersPanel=this},methods:{async editLayer({layer:e,bindTo:t}){this.layerPopover.show=!1,await this.$nextTick(),Object.assign(this.layerPopover,{layer:e,bindTo:t,show:!0})},refreshLayer({layer:e}){switch(e.type){case"basemap":SPM.Components.AssignmentMap.updateBaseMapStyles();break;case"boundary":SPM.Components.AssignmentMap.updateBoundaryStyles({objectId:e.id,styles:e.styles});break;case"object":SPM.Components.AssignmentMap.updateObjectStyles({objectId:e.id,styles:e.styles});break}},close(){SPM.Components.Assignment.sidePanel=""}}},gee={class:"slds-panel slds-size_medium slds-panel_docked slds-panel_docked-right slds-panel_drawer slds-is-open","aria-hidden":"false"},yee={class:"slds-grid slds-grid_vertical",style:{height:"100%"}},vee={class:"slds-panel__header"},bee=k("h2",{class:"slds-panel__header-title slds-text-heading_small slds-truncate",title:"Layers"},"Layers",-1),xee={class:"slds-panel__header-actions"},wee={class:"slds-panel__body slds-grid slds-grid_vertical slds-p-around_none"},See=k("div",{class:"slds-text-title_caps slds-p-vertical_x-small slds-p-horizontal_small slds-theme_shade"},[k("strong",null,"Boundaries")],-1),Cee=k("div",{class:"slds-text-title_caps slds-p-vertical_x-small slds-p-horizontal_small slds-theme_shade"},[k("strong",null,"Objects")],-1),Iee=k("div",{class:"slds-text-title_caps slds-p-vertical_x-small slds-p-horizontal_small slds-theme_shade"},[k("strong",null,"Map")],-1);function Tee(e,t,s,n,r,a){const o=pe("Spinner"),d=pe("ButtonIcon"),p=pe("Layer"),y=pe("LayerPopover");return L(),X("div",gee,[k("div",yee,[r.loadingMsg?(L(),Ge(o,{key:0},{description:je(()=>[es(Pe(r.loadingMsg),1)]),_:1})):$e("",!0),k("div",vee,[bee,k("div",xee,[de(d,{iconCategory:"utility",iconName:"close",title:"Collapse Panel Header",assistiveText:"Collapse Panel Header",onClick:a.close},null,8,["onClick"])])]),k("div",wee,[a.useBoundaries?(L(),X(Lt,{key:0},[See,(L(!0),X(Lt,null,As(e.$store.boundaryLayers,v=>(L(),Ge(p,{key:v.id,layer:v},null,8,["layer"]))),128))],64)):(L(),X(Lt,{key:1},[Cee,(L(!0),X(Lt,null,As(e.$store.preferences.Map.layers.filter(v=>v.type==="object"),v=>(L(),Ge(p,{key:v.id,layer:v},null,8,["layer"]))),128))],64)),Iee,(L(!0),X(Lt,null,As(e.$store.preferences.Map.layers.filter(v=>v.type==="basemap"),v=>(L(),Ge(p,{key:v.id,layer:v},null,8,["layer"]))),128))]),r.layerPopover.show?(L(),Ge(y,{key:1,bindTo:r.layerPopover.bindTo,layer:r.layerPopover.layer,onClose:t[0]||(t[0]=v=>r.layerPopover.show=!1)},null,8,["bindTo","layer"])):$e("",!0)])])}const Aee=os(_ee,[["render",Tee]]);function Rc(e,t){const s=[];return SPM.$store.preferences.Map.layers.forEach(n=>{const r=n.id;n.type==="boundary"&&SPM.$store.boundaryObjects.some(a=>a.id===n.id)&&s.push(`${r}-boundary`),n.type==="object"&&s.push(`${r}-object`)}),e.queryRenderedFeatures([t.x,t.y],{layers:s})}var ha=63710088e-1,hI={centimeters:ha*100,centimetres:ha*100,degrees:ha/111325,feet:ha*3.28084,inches:ha*39.37,kilometers:ha/1e3,kilometres:ha/1e3,meters:ha,metres:ha,miles:ha/1609.344,millimeters:ha*1e3,millimetres:ha*1e3,nauticalmiles:ha/1852,radians:1,yards:ha*1.0936},Mee={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/ha,yards:1.0936133},f2={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function Dc(e,t,s){s===void 0&&(s={});var n={type:"Feature"};return(s.id===0||s.id)&&(n.id=s.id),s.bbox&&(n.bbox=s.bbox),n.properties=t||{},n.geometry=e,n}function Eee(e,t,s){switch(e){case"Point":return Ku(t).geometry;case"LineString":return yu(t).geometry;case"Polygon":return Ix(t).geometry;case"MultiPoint":return VR(t).geometry;case"MultiLineString":return pI(t).geometry;case"MultiPolygon":return jR(t).geometry;default:throw new Error(e+" is invalid")}}function Ku(e,t,s){if(s===void 0&&(s={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Rb(e[0])||!Rb(e[1]))throw new Error("coordinates must contain numbers");var n={type:"Point",coordinates:e};return Dc(n,t,s)}function kee(e,t,s){return s===void 0&&(s={}),Zp(e.map(function(n){return Ku(n,t)}),s)}function Ix(e,t,s){s===void 0&&(s={});for(var n=0,r=e;n<r.length;n++){var a=r[n];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<a[a.length-1].length;o++)if(a[a.length-1][o]!==a[0][o])throw new Error("First and last Position are not equivalent.")}var d={type:"Polygon",coordinates:e};return Dc(d,t,s)}function Pee(e,t,s){return s===void 0&&(s={}),Zp(e.map(function(n){return Ix(n,t)}),s)}function yu(e,t,s){if(s===void 0&&(s={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");var n={type:"LineString",coordinates:e};return Dc(n,t,s)}function Ree(e,t,s){return s===void 0&&(s={}),Zp(e.map(function(n){return yu(n,t)}),s)}function Zp(e,t){t===void 0&&(t={});var s={type:"FeatureCollection"};return t.id&&(s.id=t.id),t.bbox&&(s.bbox=t.bbox),s.features=e,s}function pI(e,t,s){s===void 0&&(s={});var n={type:"MultiLineString",coordinates:e};return Dc(n,t,s)}function VR(e,t,s){s===void 0&&(s={});var n={type:"MultiPoint",coordinates:e};return Dc(n,t,s)}function jR(e,t,s){s===void 0&&(s={});var n={type:"MultiPolygon",coordinates:e};return Dc(n,t,s)}function $ee(e,t,s){s===void 0&&(s={});var n={type:"GeometryCollection",geometries:e};return Dc(n,t,s)}function Oee(e,t){if(t===void 0&&(t=0),t&&!(t>=0))throw new Error("precision must be a positive number");var s=Math.pow(10,t||0);return Math.round(e*s)/s}function qR(e,t){t===void 0&&(t="kilometers");var s=hI[t];if(!s)throw new Error(t+" units is invalid");return e*s}function fI(e,t){t===void 0&&(t="kilometers");var s=hI[t];if(!s)throw new Error(t+" units is invalid");return e/s}function Lee(e,t){return HR(fI(e,t))}function Nee(e){var t=e%360;return t<0&&(t+=360),t}function HR(e){var t=e%(2*Math.PI);return t*180/Math.PI}function Dee(e){var t=e%360;return t*Math.PI/180}function Bee(e,t,s){if(t===void 0&&(t="kilometers"),s===void 0&&(s="kilometers"),!(e>=0))throw new Error("length must be a positive number");return qR(fI(e,t),s)}function Fee(e,t,s){if(t===void 0&&(t="meters"),s===void 0&&(s="kilometers"),!(e>=0))throw new Error("area must be a positive number");var n=f2[t];if(!n)throw new Error("invalid original units");var r=f2[s];if(!r)throw new Error("invalid final units");return e/n*r}function Rb(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function mI(e){return!!e&&e.constructor===Object}function zee(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(e.length!==4&&e.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(t){if(!Rb(t))throw new Error("bbox must only contain numbers")})}function Uee(e){if(!e)throw new Error("id is required");if(["string","number"].indexOf(typeof e)===-1)throw new Error("id must be a number or a string")}const Vee=Object.freeze(Object.defineProperty({__proto__:null,earthRadius:ha,factors:hI,unitsFactors:Mee,areaFactors:f2,feature:Dc,geometry:Eee,point:Ku,points:kee,polygon:Ix,polygons:Pee,lineString:yu,lineStrings:Ree,featureCollection:Zp,multiLineString:pI,multiPoint:VR,multiPolygon:jR,geometryCollection:$ee,round:Oee,radiansToLength:qR,lengthToRadians:fI,lengthToDegrees:Lee,bearingToAzimuth:Nee,radiansToDegrees:HR,degreesToRadians:Dee,convertLength:Bee,convertArea:Fee,isNumber:Rb,isObject:mI,validateBBox:zee,validateId:Uee},Symbol.toStringTag,{value:"Module"}));function Vg(e,t,s){if(e!==null)for(var n,r,a,o,d,p,y,v=0,C=0,I,O=e.type,A=O==="FeatureCollection",P=O==="Feature",q=A?e.features.length:1,ce=0;ce<q;ce++){y=A?e.features[ce].geometry:P?e.geometry:e,I=y?y.type==="GeometryCollection":!1,d=I?y.geometries.length:1;for(var re=0;re<d;re++){var W=0,Ce=0;if(o=I?y.geometries[re]:y,o!==null){p=o.coordinates;var te=o.type;switch(v=s&&(te==="Polygon"||te==="MultiPolygon")?1:0,te){case null:break;case"Point":if(t(p,C,ce,W,Ce)===!1)return!1;C++,W++;break;case"LineString":case"MultiPoint":for(n=0;n<p.length;n++){if(t(p[n],C,ce,W,Ce)===!1)return!1;C++,te==="MultiPoint"&&W++}te==="LineString"&&W++;break;case"Polygon":case"MultiLineString":for(n=0;n<p.length;n++){for(r=0;r<p[n].length-v;r++){if(t(p[n][r],C,ce,W,Ce)===!1)return!1;C++}te==="MultiLineString"&&W++,te==="Polygon"&&Ce++}te==="Polygon"&&W++;break;case"MultiPolygon":for(n=0;n<p.length;n++){for(Ce=0,r=0;r<p[n].length;r++){for(a=0;a<p[n][r].length-v;a++){if(t(p[n][r][a],C,ce,W,Ce)===!1)return!1;C++}Ce++}W++}break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(Vg(o.geometries[n],t,s)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function jee(e,t,s,n){var r=s;return Vg(e,function(a,o,d,p,y){o===0&&s===void 0?r=a:r=t(r,a,o,d,p,y)},n),r}function GR(e,t){var s;switch(e.type){case"FeatureCollection":for(s=0;s<e.features.length&&t(e.features[s].properties,s)!==!1;s++);break;case"Feature":t(e.properties,0);break}}function qee(e,t,s){var n=s;return GR(e,function(r,a){a===0&&s===void 0?n=r:n=t(n,r,a)}),n}function $b(e,t){if(e.type==="Feature")t(e,0);else if(e.type==="FeatureCollection")for(var s=0;s<e.features.length&&t(e.features[s],s)!==!1;s++);}function Hee(e,t,s){var n=s;return $b(e,function(r,a){a===0&&s===void 0?n=r:n=t(n,r,a)}),n}function Gee(e){var t=[];return Vg(e,function(s){t.push(s)}),t}function _I(e,t){var s,n,r,a,o,d,p,y,v,C,I=0,O=e.type==="FeatureCollection",A=e.type==="Feature",P=O?e.features.length:1;for(s=0;s<P;s++){for(d=O?e.features[s].geometry:A?e.geometry:e,y=O?e.features[s].properties:A?e.properties:{},v=O?e.features[s].bbox:A?e.bbox:void 0,C=O?e.features[s].id:A?e.id:void 0,p=d?d.type==="GeometryCollection":!1,o=p?d.geometries.length:1,r=0;r<o;r++){if(a=p?d.geometries[r]:d,a===null){if(t(null,I,y,v,C)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(a,I,y,v,C)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<a.geometries.length;n++)if(t(a.geometries[n],I,y,v,C)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}I++}}function Wee(e,t,s){var n=s;return _I(e,function(r,a,o,d,p){a===0&&s===void 0?n=r:n=t(n,r,a,o,d,p)}),n}function wh(e,t){_I(e,function(s,n,r,a,o){var d=s===null?null:s.type;switch(d){case null:case"Point":case"LineString":case"Polygon":return t(Dc(s,r,{bbox:a,id:o}),n,0)===!1?!1:void 0}var p;switch(d){case"MultiPoint":p="Point";break;case"MultiLineString":p="LineString";break;case"MultiPolygon":p="Polygon";break}for(var y=0;y<s.coordinates.length;y++){var v=s.coordinates[y],C={type:p,coordinates:v};if(t(Dc(C,r),n,y)===!1)return!1}})}function Yee(e,t,s){var n=s;return wh(e,function(r,a,o){a===0&&o===0&&s===void 0?n=r:n=t(n,r,a,o)}),n}function WR(e,t){wh(e,function(s,n,r){var a=0;if(!!s.geometry){var o=s.geometry.type;if(!(o==="Point"||o==="MultiPoint")){var d,p=0,y=0,v=0;if(Vg(s,function(C,I,O,A,P){if(d===void 0||n>p||A>y||P>v){d=C,p=n,y=A,v=P,a=0;return}var q=yu([d,C],s.properties);if(t(q,n,r,P,a)===!1)return!1;a++,d=C})===!1)return!1}}})}function Zee(e,t,s){var n=s,r=!1;return WR(e,function(a,o,d,p,y){r===!1&&s===void 0?n=a:n=t(n,a,o,d,p,y),r=!0}),n}function YR(e,t){if(!e)throw new Error("geojson is required");wh(e,function(s,n,r){if(s.geometry!==null){var a=s.geometry.type,o=s.geometry.coordinates;switch(a){case"LineString":if(t(s,n,r,0,0)===!1)return!1;break;case"Polygon":for(var d=0;d<o.length;d++)if(t(yu(o[d],s.properties),n,r,d)===!1)return!1;break}}})}function Xee(e,t,s){var n=s;return YR(e,function(r,a,o,d){a===0&&s===void 0?n=r:n=t(n,r,a,o,d)}),n}function Kee(e,t){if(t=t||{},!mI(t))throw new Error("options is invalid");var s=t.featureIndex||0,n=t.multiFeatureIndex||0,r=t.geometryIndex||0,a=t.segmentIndex||0,o=t.properties,d;switch(e.type){case"FeatureCollection":s<0&&(s=e.features.length+s),o=o||e.features[s].properties,d=e.features[s].geometry;break;case"Feature":o=o||e.properties,d=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":d=e;break;default:throw new Error("geojson is invalid")}if(d===null)return null;var p=d.coordinates;switch(d.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=p.length+a-1),yu([p[a],p[a+1]],o,t);case"Polygon":return r<0&&(r=p.length+r),a<0&&(a=p[r].length+a-1),yu([p[r][a],p[r][a+1]],o,t);case"MultiLineString":return n<0&&(n=p.length+n),a<0&&(a=p[n].length+a-1),yu([p[n][a],p[n][a+1]],o,t);case"MultiPolygon":return n<0&&(n=p.length+n),r<0&&(r=p[n].length+r),a<0&&(a=p[n][r].length-a-1),yu([p[n][r][a],p[n][r][a+1]],o,t)}throw new Error("geojson is invalid")}function Jee(e,t){if(t=t||{},!mI(t))throw new Error("options is invalid");var s=t.featureIndex||0,n=t.multiFeatureIndex||0,r=t.geometryIndex||0,a=t.coordIndex||0,o=t.properties,d;switch(e.type){case"FeatureCollection":s<0&&(s=e.features.length+s),o=o||e.features[s].properties,d=e.features[s].geometry;break;case"Feature":o=o||e.properties,d=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":d=e;break;default:throw new Error("geojson is invalid")}if(d===null)return null;var p=d.coordinates;switch(d.type){case"Point":return Ku(p,o,t);case"MultiPoint":return n<0&&(n=p.length+n),Ku(p[n],o,t);case"LineString":return a<0&&(a=p.length+a),Ku(p[a],o,t);case"Polygon":return r<0&&(r=p.length+r),a<0&&(a=p[r].length+a),Ku(p[r][a],o,t);case"MultiLineString":return n<0&&(n=p.length+n),a<0&&(a=p[n].length+a),Ku(p[n][a],o,t);case"MultiPolygon":return n<0&&(n=p.length+n),r<0&&(r=p[n].length+r),a<0&&(a=p[n][r].length-a),Ku(p[n][r][a],o,t)}throw new Error("geojson is invalid")}const Qee=Object.freeze(Object.defineProperty({__proto__:null,coordAll:Gee,coordEach:Vg,coordReduce:jee,featureEach:$b,featureReduce:Hee,findPoint:Jee,findSegment:Kee,flattenEach:wh,flattenReduce:Yee,geomEach:_I,geomReduce:Wee,lineEach:YR,lineReduce:Xee,propEach:GR,propReduce:qee,segmentEach:WR,segmentReduce:Zee},Symbol.toStringTag,{value:"Module"}));function m2(e){var t=[1/0,1/0,-1/0,-1/0];return Vg(e,function(s){t[0]>s[0]&&(t[0]=s[0]),t[1]>s[1]&&(t[1]=s[1]),t[2]<s[0]&&(t[2]=s[0]),t[3]<s[1]&&(t[3]=s[1])}),t}m2.default=m2;const ete=Object.freeze(Object.defineProperty({__proto__:null,default:m2},Symbol.toStringTag,{value:"Module"}));function tte(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Ev(e){if(Array.isArray(e))return e;if(e.type==="Feature"){if(e.geometry!==null)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Tx(e){return e.type==="Feature"?e.geometry:e}var ZR={exports:{}};(function(e,t){(function(s,n){e.exports=n()})(Qu,function(){function s(re,W,Ce,te,oe){(function ve(ee,ne,Se,Ue,Qe){for(;Ue>Se;){if(Ue-Se>600){var Me=Ue-Se+1,vt=ne-Se+1,Ut=Math.log(Me),Rt=.5*Math.exp(2*Ut/3),_t=.5*Math.sqrt(Ut*Rt*(Me-Rt)/Me)*(vt-Me/2<0?-1:1),F=Math.max(Se,Math.floor(ne-vt*Rt/Me+_t)),j=Math.min(Ue,Math.floor(ne+(Me-vt)*Rt/Me+_t));ve(ee,ne,F,j,Qe)}var G=ee[ne],Y=Se,J=Ue;for(n(ee,Se,ne),Qe(ee[Ue],G)>0&&n(ee,Se,Ue);Y<J;){for(n(ee,Y,J),Y++,J--;Qe(ee[Y],G)<0;)Y++;for(;Qe(ee[J],G)>0;)J--}Qe(ee[Se],G)===0?n(ee,Se,J):n(ee,++J,Ue),J<=ne&&(Se=J+1),ne<=J&&(Ue=J-1)}})(re,W,Ce||0,te||re.length-1,oe||r)}function n(re,W,Ce){var te=re[W];re[W]=re[Ce],re[Ce]=te}function r(re,W){return re<W?-1:re>W?1:0}var a=function(re){re===void 0&&(re=9),this._maxEntries=Math.max(4,re),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function o(re,W,Ce){if(!Ce)return W.indexOf(re);for(var te=0;te<W.length;te++)if(Ce(re,W[te]))return te;return-1}function d(re,W){p(re,0,re.children.length,W,re)}function p(re,W,Ce,te,oe){oe||(oe=q(null)),oe.minX=1/0,oe.minY=1/0,oe.maxX=-1/0,oe.maxY=-1/0;for(var ve=W;ve<Ce;ve++){var ee=re.children[ve];y(oe,re.leaf?te(ee):ee)}return oe}function y(re,W){return re.minX=Math.min(re.minX,W.minX),re.minY=Math.min(re.minY,W.minY),re.maxX=Math.max(re.maxX,W.maxX),re.maxY=Math.max(re.maxY,W.maxY),re}function v(re,W){return re.minX-W.minX}function C(re,W){return re.minY-W.minY}function I(re){return(re.maxX-re.minX)*(re.maxY-re.minY)}function O(re){return re.maxX-re.minX+(re.maxY-re.minY)}function A(re,W){return re.minX<=W.minX&&re.minY<=W.minY&&W.maxX<=re.maxX&&W.maxY<=re.maxY}function P(re,W){return W.minX<=re.maxX&&W.minY<=re.maxY&&W.maxX>=re.minX&&W.maxY>=re.minY}function q(re){return{children:re,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ce(re,W,Ce,te,oe){for(var ve=[W,Ce];ve.length;)if(!((Ce=ve.pop())-(W=ve.pop())<=te)){var ee=W+Math.ceil((Ce-W)/te/2)*te;s(re,ee,W,Ce,oe),ve.push(W,ee,ee,Ce)}}return a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(re){var W=this.data,Ce=[];if(!P(re,W))return Ce;for(var te=this.toBBox,oe=[];W;){for(var ve=0;ve<W.children.length;ve++){var ee=W.children[ve],ne=W.leaf?te(ee):ee;P(re,ne)&&(W.leaf?Ce.push(ee):A(re,ne)?this._all(ee,Ce):oe.push(ee))}W=oe.pop()}return Ce},a.prototype.collides=function(re){var W=this.data;if(!P(re,W))return!1;for(var Ce=[];W;){for(var te=0;te<W.children.length;te++){var oe=W.children[te],ve=W.leaf?this.toBBox(oe):oe;if(P(re,ve)){if(W.leaf||A(re,ve))return!0;Ce.push(oe)}}W=Ce.pop()}return!1},a.prototype.load=function(re){if(!re||!re.length)return this;if(re.length<this._minEntries){for(var W=0;W<re.length;W++)this.insert(re[W]);return this}var Ce=this._build(re.slice(),0,re.length-1,0);if(this.data.children.length)if(this.data.height===Ce.height)this._splitRoot(this.data,Ce);else{if(this.data.height<Ce.height){var te=this.data;this.data=Ce,Ce=te}this._insert(Ce,this.data.height-Ce.height-1,!0)}else this.data=Ce;return this},a.prototype.insert=function(re){return re&&this._insert(re,this.data.height-1),this},a.prototype.clear=function(){return this.data=q([]),this},a.prototype.remove=function(re,W){if(!re)return this;for(var Ce,te,oe,ve=this.data,ee=this.toBBox(re),ne=[],Se=[];ve||ne.length;){if(ve||(ve=ne.pop(),te=ne[ne.length-1],Ce=Se.pop(),oe=!0),ve.leaf){var Ue=o(re,ve.children,W);if(Ue!==-1)return ve.children.splice(Ue,1),ne.push(ve),this._condense(ne),this}oe||ve.leaf||!A(ve,ee)?te?(Ce++,ve=te.children[Ce],oe=!1):ve=null:(ne.push(ve),Se.push(Ce),Ce=0,te=ve,ve=ve.children[0])}return this},a.prototype.toBBox=function(re){return re},a.prototype.compareMinX=function(re,W){return re.minX-W.minX},a.prototype.compareMinY=function(re,W){return re.minY-W.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(re){return this.data=re,this},a.prototype._all=function(re,W){for(var Ce=[];re;)re.leaf?W.push.apply(W,re.children):Ce.push.apply(Ce,re.children),re=Ce.pop();return W},a.prototype._build=function(re,W,Ce,te){var oe,ve=Ce-W+1,ee=this._maxEntries;if(ve<=ee)return d(oe=q(re.slice(W,Ce+1)),this.toBBox),oe;te||(te=Math.ceil(Math.log(ve)/Math.log(ee)),ee=Math.ceil(ve/Math.pow(ee,te-1))),(oe=q([])).leaf=!1,oe.height=te;var ne=Math.ceil(ve/ee),Se=ne*Math.ceil(Math.sqrt(ee));ce(re,W,Ce,Se,this.compareMinX);for(var Ue=W;Ue<=Ce;Ue+=Se){var Qe=Math.min(Ue+Se-1,Ce);ce(re,Ue,Qe,ne,this.compareMinY);for(var Me=Ue;Me<=Qe;Me+=ne){var vt=Math.min(Me+ne-1,Qe);oe.children.push(this._build(re,Me,vt,te-1))}}return d(oe,this.toBBox),oe},a.prototype._chooseSubtree=function(re,W,Ce,te){for(;te.push(W),!W.leaf&&te.length-1!==Ce;){for(var oe=1/0,ve=1/0,ee=void 0,ne=0;ne<W.children.length;ne++){var Se=W.children[ne],Ue=I(Se),Qe=(Me=re,vt=Se,(Math.max(vt.maxX,Me.maxX)-Math.min(vt.minX,Me.minX))*(Math.max(vt.maxY,Me.maxY)-Math.min(vt.minY,Me.minY))-Ue);Qe<ve?(ve=Qe,oe=Ue<oe?Ue:oe,ee=Se):Qe===ve&&Ue<oe&&(oe=Ue,ee=Se)}W=ee||W.children[0]}var Me,vt;return W},a.prototype._insert=function(re,W,Ce){var te=Ce?re:this.toBBox(re),oe=[],ve=this._chooseSubtree(te,this.data,W,oe);for(ve.children.push(re),y(ve,te);W>=0&&oe[W].children.length>this._maxEntries;)this._split(oe,W),W--;this._adjustParentBBoxes(te,oe,W)},a.prototype._split=function(re,W){var Ce=re[W],te=Ce.children.length,oe=this._minEntries;this._chooseSplitAxis(Ce,oe,te);var ve=this._chooseSplitIndex(Ce,oe,te),ee=q(Ce.children.splice(ve,Ce.children.length-ve));ee.height=Ce.height,ee.leaf=Ce.leaf,d(Ce,this.toBBox),d(ee,this.toBBox),W?re[W-1].children.push(ee):this._splitRoot(Ce,ee)},a.prototype._splitRoot=function(re,W){this.data=q([re,W]),this.data.height=re.height+1,this.data.leaf=!1,d(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(re,W,Ce){for(var te,oe,ve,ee,ne,Se,Ue,Qe=1/0,Me=1/0,vt=W;vt<=Ce-W;vt++){var Ut=p(re,0,vt,this.toBBox),Rt=p(re,vt,Ce,this.toBBox),_t=(oe=Ut,ve=Rt,ee=void 0,ne=void 0,Se=void 0,Ue=void 0,ee=Math.max(oe.minX,ve.minX),ne=Math.max(oe.minY,ve.minY),Se=Math.min(oe.maxX,ve.maxX),Ue=Math.min(oe.maxY,ve.maxY),Math.max(0,Se-ee)*Math.max(0,Ue-ne)),F=I(Ut)+I(Rt);_t<Qe?(Qe=_t,te=vt,Me=F<Me?F:Me):_t===Qe&&F<Me&&(Me=F,te=vt)}return te||Ce-W},a.prototype._chooseSplitAxis=function(re,W,Ce){var te=re.leaf?this.compareMinX:v,oe=re.leaf?this.compareMinY:C;this._allDistMargin(re,W,Ce,te)<this._allDistMargin(re,W,Ce,oe)&&re.children.sort(te)},a.prototype._allDistMargin=function(re,W,Ce,te){re.children.sort(te);for(var oe=this.toBBox,ve=p(re,0,W,oe),ee=p(re,Ce-W,Ce,oe),ne=O(ve)+O(ee),Se=W;Se<Ce-W;Se++){var Ue=re.children[Se];y(ve,re.leaf?oe(Ue):Ue),ne+=O(ve)}for(var Qe=Ce-W-1;Qe>=W;Qe--){var Me=re.children[Qe];y(ee,re.leaf?oe(Me):Me),ne+=O(ee)}return ne},a.prototype._adjustParentBBoxes=function(re,W,Ce){for(var te=Ce;te>=0;te--)y(W[te],re)},a.prototype._condense=function(re){for(var W=re.length-1,Ce=void 0;W>=0;W--)re[W].children.length===0?W>0?(Ce=re[W-1].children).splice(Ce.indexOf(re[W]),1):this.clear():d(re[W],this.toBBox)},a})})(ZR);function kv(e,t,s){if(s===void 0&&(s={}),!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");var n=tte(e),r=Tx(t),a=r.type,o=t.bbox,d=r.coordinates;if(o&&ste(n,o)===!1)return!1;a==="Polygon"&&(d=[d]);for(var p=!1,y=0;y<d.length&&!p;y++)if(BA(n,d[y][0],s.ignoreBoundary)){for(var v=!1,C=1;C<d[y].length&&!v;)BA(n,d[y][C],!s.ignoreBoundary)&&(v=!0),C++;v||(p=!0)}return p}function BA(e,t,s){var n=!1;t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]&&(t=t.slice(0,t.length-1));for(var r=0,a=t.length-1;r<t.length;a=r++){var o=t[r][0],d=t[r][1],p=t[a][0],y=t[a][1],v=e[1]*(o-p)+d*(p-e[0])+y*(e[0]-o)===0&&(o-e[0])*(p-e[0])<=0&&(d-e[1])*(y-e[1])<=0;if(v)return!s;var C=d>e[1]!=y>e[1]&&e[0]<(p-o)*(e[1]-d)/(y-d)+o;C&&(n=!n)}return n}function ste(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]}function FA(e){if(!e)throw new Error("geojson is required");var t=[];return wh(e,function(s){nte(s,t)}),Zp(t)}function nte(e,t){var s=[],n=e.geometry;if(n!==null){switch(n.type){case"Polygon":s=Ev(n);break;case"LineString":s=[Ev(n)]}s.forEach(function(r){var a=rte(r,e.properties);a.forEach(function(o){o.id=t.length,t.push(o)})})}}function rte(e,t){var s=[];return e.reduce(function(n,r){var a=yu([n,r],t);return a.bbox=ite(n,r),s.push(a),r}),s}function ite(e,t){var s=e[0],n=e[1],r=t[0],a=t[1],o=s<r?s:r,d=n<a?n:a,p=s>r?s:r,y=n>a?n:a;return[o,d,p,y]}var gI={exports:{}};const ote=Q2(Vee),ate=Q2(Qee),lte=Q2(ete);var Zu=ZR.exports,XR=ote,KR=ate,G_=lte.default,cte=KR.featureEach;KR.coordEach;XR.polygon;var zA=XR.featureCollection;function JR(e){var t=new Zu(e);return t.insert=function(s){if(s.type!=="Feature")throw new Error("invalid feature");return s.bbox=s.bbox?s.bbox:G_(s),Zu.prototype.insert.call(this,s)},t.load=function(s){var n=[];return Array.isArray(s)?s.forEach(function(r){if(r.type!=="Feature")throw new Error("invalid features");r.bbox=r.bbox?r.bbox:G_(r),n.push(r)}):cte(s,function(r){if(r.type!=="Feature")throw new Error("invalid features");r.bbox=r.bbox?r.bbox:G_(r),n.push(r)}),Zu.prototype.load.call(this,n)},t.remove=function(s,n){if(s.type!=="Feature")throw new Error("invalid feature");return s.bbox=s.bbox?s.bbox:G_(s),Zu.prototype.remove.call(this,s,n)},t.clear=function(){return Zu.prototype.clear.call(this)},t.search=function(s){var n=Zu.prototype.search.call(this,this.toBBox(s));return zA(n)},t.collides=function(s){return Zu.prototype.collides.call(this,this.toBBox(s))},t.all=function(){var s=Zu.prototype.all.call(this);return zA(s)},t.toJSON=function(){return Zu.prototype.toJSON.call(this)},t.fromJSON=function(s){return Zu.prototype.fromJSON.call(this,s)},t.toBBox=function(s){var n;if(s.bbox)n=s.bbox;else if(Array.isArray(s)&&s.length===4)n=s;else if(Array.isArray(s)&&s.length===6)n=[s[0],s[1],s[3],s[4]];else if(s.type==="Feature")n=G_(s);else if(s.type==="FeatureCollection")n=G_(s);else throw new Error("invalid geojson");return{minX:n[0],minY:n[1],maxX:n[2],maxY:n[3]}},t}gI.exports=JR;gI.exports.default=JR;function yI(e,t){var s={},n=[];if(e.type==="LineString"&&(e=Dc(e)),t.type==="LineString"&&(t=Dc(t)),e.type==="Feature"&&t.type==="Feature"&&e.geometry!==null&&t.geometry!==null&&e.geometry.type==="LineString"&&t.geometry.type==="LineString"&&e.geometry.coordinates.length===2&&t.geometry.coordinates.length===2){var r=UA(e,t);return r&&n.push(r),Zp(n)}var a=gI.exports();return a.load(FA(t)),$b(FA(e),function(o){$b(a.search(o),function(d){var p=UA(o,d);if(p){var y=Ev(p).join(",");s[y]||(s[y]=!0,n.push(p))}})}),Zp(n)}function UA(e,t){var s=Ev(e),n=Ev(t);if(s.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(n.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var r=s[0][0],a=s[0][1],o=s[1][0],d=s[1][1],p=n[0][0],y=n[0][1],v=n[1][0],C=n[1][1],I=(C-y)*(o-r)-(v-p)*(d-a),O=(v-p)*(a-y)-(C-y)*(r-p),A=(o-r)*(a-y)-(d-a)*(r-p);if(I===0)return O===0&&A===0,null;var P=O/I,q=A/I;if(P>=0&&P<=1&&q>=0&&q<=1){var ce=r+P*(o-r),re=a+P*(d-a);return Ku([ce,re])}return null}function _2(e,t){t===void 0&&(t={});var s=Tx(e);switch(!t.properties&&e.type==="Feature"&&(t.properties=e.properties),s.type){case"Polygon":return ute(s,t);case"MultiPolygon":return dte(s,t);default:throw new Error("invalid poly")}}function ute(e,t){t===void 0&&(t={});var s=Tx(e),n=s.coordinates,r=t.properties?t.properties:e.type==="Feature"?e.properties:{};return QR(n,r)}function dte(e,t){t===void 0&&(t={});var s=Tx(e),n=s.coordinates,r=t.properties?t.properties:e.type==="Feature"?e.properties:{},a=[];return n.forEach(function(o){a.push(QR(o,r))}),Zp(a)}function QR(e,t){return e.length>1?pI(e,t):yu(e[0],t)}function hte(e,t){var s=!0;return wh(e,function(n){wh(t,function(r){if(s===!1)return!1;s=pte(n.geometry,r.geometry)})}),s}function pte(e,t){switch(e.type){case"Point":switch(t.type){case"Point":return!gte(e.coordinates,t.coordinates);case"LineString":return!VA(t,e);case"Polygon":return!kv(e,t)}break;case"LineString":switch(t.type){case"Point":return!VA(e,t);case"LineString":return!fte(e,t);case"Polygon":return!jA(t,e)}break;case"Polygon":switch(t.type){case"Point":return!kv(t,e);case"LineString":return!jA(e,t);case"Polygon":return!mte(t,e)}}return!1}function VA(e,t){for(var s=0;s<e.coordinates.length-1;s++)if(_te(e.coordinates[s],e.coordinates[s+1],t.coordinates))return!0;return!1}function fte(e,t){var s=yI(e,t);return s.features.length>0}function jA(e,t){for(var s=0,n=t.coordinates;s<n.length;s++){var r=n[s];if(kv(r,e))return!0}var a=yI(t,_2(e));return a.features.length>0}function mte(e,t){for(var s=0,n=e.coordinates[0];s<n.length;s++){var r=n[s];if(kv(r,t))return!0}for(var a=0,o=t.coordinates[0];a<o.length;a++){var d=o[a];if(kv(d,e))return!0}var p=yI(_2(e),_2(t));return p.features.length>0}function _te(e,t,s){var n=s[0]-e[0],r=s[1]-e[1],a=t[0]-e[0],o=t[1]-e[1],d=n*o-r*a;return d!==0?!1:Math.abs(a)>=Math.abs(o)?a>0?e[0]<=s[0]&&s[0]<=t[0]:t[0]<=s[0]&&s[0]<=e[0]:o>0?e[1]<=s[1]&&s[1]<=t[1]:t[1]<=s[1]&&s[1]<=e[1]}function gte(e,t){return e[0]===t[0]&&e[1]===t[1]}function yte(e,t){var s=!1;return wh(e,function(n){wh(t,function(r){if(s===!0)return!0;s=!hte(n.geometry,r.geometry)})}),s}function Ax(e,t){const s=t.computeEnvelopeInternal(),n=[];SPM.$store.preferences.Map.layers.forEach(o=>{const d=o.id;o.type==="boundary"&&SPM.$store.boundaryObjects.some(p=>p.id===o.id)&&n.push(`${d}-boundary`),o.type==="object"&&n.push(`${d}-object`)});const r=e.queryRenderedFeatures([e.project([s._minx,s._miny]),e.project([s._maxx,s._maxy])],{layers:n}),a=Ix([t.getCoordinates().map(o=>[o.x,o.y])]);return r.filter(o=>yte(o,a))}function fd(e){return e.some(t=>{var s,n,r;if((s=t.source)!=null&&s.endsWith("-object"))return(n=t.state)==null?void 0:n.selected;if((r=t.source)!=null&&r.endsWith("-vector"))return SPM.Components.AssignmentMap.selectionSummary.boundaries.some(a=>a.id===t.properties.id)})}function t0(e){let t;return e.some(n=>{var a,o,d;let r;if(((a=n.source)==null?void 0:a.endsWith("-object"))&&!((o=n.state)!=null&&o.selected)&&(r=n.state.nodeId||n.properties.nodeId),((d=n.source)==null?void 0:d.endsWith("-vector"))&&!SPM.Components.AssignmentMap.selectionSummary.boundaries.find(p=>p.id===n.properties.id)){const p=n.source.split("-")[0];r=SPM.Components.AssignmentMap.boundaryRecords[p].find(y=>y.id===n.properties.id).nodeId}if(!!r){if(t&&t!==r)return!0;t=r}})?null:t}let uo,Eg,uh;class vte{constructor(t){uo=t}enableSelect(){uo.getCanvas().style.cursor="pointer",uo.on("mousedown",qA),uo.on("mousemove",HA),uo.on("mouseout",GA),uo.on("mouseup",WA),uo.on("click",YA)}disableSelect(){uo.getCanvas().style.cursor=null,uo.off("mousedown",qA),uo.off("mousemove",HA),uo.off("mouseout",GA),uo.off("mouseup",WA),uo.off("click",YA)}}function qA(e){if(!e.originalEvent.shiftKey){const t=Rc(uo,e.point);fd(t)&&(Eg=!0,uh=null)}}function HA(e){if(Eg){const t=Rc(uo,e.point),s=fd(t)?null:t0(t);uh!==s&&(uh=s,uh?(uo.getCanvas().style.cursor="pointer",SPM.Components.AssignmentMap.targetId=uh):(uo.getCanvas().style.cursor="no-drop",SPM.Components.AssignmentMap.targetId=""),SPM.Components.AssignmentMap.applySelection({redraw:!0}))}}function GA(){Eg&&(uo.getCanvas().style.cursor="pointer",uh=null,Eg=!1)}async function WA(){Eg&&uh!=null&&(await SPM.Components.AssignmentMap.reassignSelection({targetId:uh}),SPM.Components.AssignmentMap.targetId=""),uo.getCanvas().style.cursor="pointer",uh=null,Eg=!1}function YA(e){const t=Rc(uo,e.point);SPM.Components.AssignmentMap.applySelection({selection:t,reset:!e.originalEvent.shiftKey})}class uS{static equalsWithTolerance(t,s,n){return Math.abs(t-s)<=n}}class ef extends Error{constructor(t){super(t),this.name=Object.keys({Exception:ef})[0]}toString(){return this.message}}class ii extends ef{constructor(t){super(t),this.name=Object.keys({IllegalArgumentException:ii})[0]}}class zy{constructor(t,s){this.low=s||0,this.high=t||0}static toBinaryString(t){let s,n="";for(s=2147483648;s>0;s>>>=1)n+=(t.high&s)===s?"1":"0";for(s=2147483648;s>0;s>>>=1)n+=(t.low&s)===s?"1":"0";return n}}function Xn(){}Xn.NaN=NaN;Xn.isNaN=e=>Number.isNaN(e);Xn.isInfinite=e=>!Number.isFinite(e);Xn.MAX_VALUE=Number.MAX_VALUE;Xn.POSITIVE_INFINITY=Number.POSITIVE_INFINITY;Xn.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY;typeof Float64Array=="function"&&typeof Int32Array=="function"?function(){const s=new Float64Array(1),n=new Int32Array(s.buffer);Xn.doubleToLongBits=function(r){s[0]=r;let a=n[0]|0,o=n[1]|0;return(o&2146435072)===2146435072&&(o&1048575)!==0&&a!==0&&(a=0,o=2146959360),new zy(o,a)},Xn.longBitsToDouble=function(r){return n[0]=r.low,n[1]=r.high,s[0]}}():function(){const t=Math.log2,s=Math.floor,n=Math.pow,r=function(){for(let a=53;a>0;a--){const o=n(2,a)-1;if(s(t(o))+1===a)return o}return 0}();Xn.doubleToLongBits=function(a){let o,d,p,y,v,C,I,O,A;if(a<0||1/a===Number.NEGATIVE_INFINITY?(C=1<<31,a=-a):C=0,a===0)return A=0,O=C,new zy(O,A);if(a===1/0)return A=0,O=C|2146435072,new zy(O,A);if(a!==a)return A=0,O=2146959360,new zy(O,A);if(y=0,A=0,o=s(a),o>1)if(o<=r)y=s(t(o)),y<=20?(A=0,O=o<<20-y&1048575):(p=y-20,d=n(2,p),A=o%d<<32-p,O=o/d&1048575);else for(p=o,A=0;d=p/2,p=s(d),p!==0;)y++,A>>>=1,A|=(O&1)<<31,O>>>=1,d!==p&&(O|=524288);if(I=y+1023,v=o===0,o=a-o,y<52&&o!==0)for(p=0;;){if(d=o*2,d>=1?(o=d-1,v?(I--,v=!1):(p<<=1,p|=1,y++)):(o=d,v?--I===0&&(y++,v=!1):(p<<=1,y++)),y===20)O|=p,p=0;else if(y===52){A|=p;break}if(d===1){y<20?O|=p<<20-y:y<52&&(A|=p<<52-y);break}}return O|=I<<20,O|=C,new zy(O,A)},Xn.longBitsToDouble=function(a){let o,d,p,y;const v=a.high,C=a.low,I=v&1<<31?-1:1;for(p=((v&2146435072)>>20)-1023,y=0,d=1<<19,o=1;o<=20;o++)v&d&&(y+=n(2,-o)),d>>>=1;for(d=1<<31,o=21;o<=52;o++)C&d&&(y+=n(2,-o)),d>>>=1;if(p===-1023){if(y===0)return I*0;p=-1022}else{if(p===1023+1)return y===0?I/0:NaN;y+=1}return I*y*n(2,p)}}();function s0(){}function Mx(){}function vI(){}function Mh(){}class iv extends ef{constructor(t){super(t),this.name=Object.keys({RuntimeException:iv})[0]}}class tg extends iv{constructor(){super(),tg.constructor_.apply(this,arguments)}static constructor_(){if(arguments.length===0)iv.constructor_.call(this);else if(arguments.length===1){const t=arguments[0];iv.constructor_.call(this,t)}}}class Vp{static shouldNeverReachHere(){if(arguments.length===0)Vp.shouldNeverReachHere(null);else if(arguments.length===1){const t=arguments[0];throw new tg("Should never reach here"+(t!==null?": "+t:""))}}static isTrue(){if(arguments.length===1){const t=arguments[0];Vp.isTrue(t,null)}else if(arguments.length===2){const t=arguments[0],s=arguments[1];if(!t)throw s===null?new tg:new tg(s)}}static equals(){if(arguments.length===2){const t=arguments[0],s=arguments[1];Vp.equals(t,s,null)}else if(arguments.length===3){const t=arguments[0],s=arguments[1],n=arguments[2];if(!s.equals(t))throw new tg("Expected "+t+" but encountered "+s+(n!==null?": "+n:""))}}}const e$=new ArrayBuffer(8),bte=new Float64Array(e$),ZA=new Int32Array(e$);class cs{constructor(){cs.constructor_.apply(this,arguments)}static constructor_(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)cs.constructor_.call(this,0,0);else if(arguments.length===1){const t=arguments[0];cs.constructor_.call(this,t.x,t.y,t.getZ())}else if(arguments.length===2){const t=arguments[0],s=arguments[1];cs.constructor_.call(this,t,s,cs.NULL_ORDINATE)}else if(arguments.length===3){const t=arguments[0],s=arguments[1],n=arguments[2];this.x=t,this.y=s,this.z=n}}static hashCode(t){return bte[0]=t,ZA[0]^ZA[1]}getM(){return Xn.NaN}setOrdinate(t,s){switch(t){case cs.X:this.x=s;break;case cs.Y:this.y=s;break;case cs.Z:this.setZ(s);break;default:throw new ii("Invalid ordinate index: "+t)}}equals2D(){if(arguments.length===1){const t=arguments[0];return!(this.x!==t.x||this.y!==t.y)}else if(arguments.length===2){const t=arguments[0],s=arguments[1];return!(!uS.equalsWithTolerance(this.x,t.x,s)||!uS.equalsWithTolerance(this.y,t.y,s))}}setM(t){throw new ii("Invalid ordinate index: "+cs.M)}getZ(){return this.z}getOrdinate(t){switch(t){case cs.X:return this.x;case cs.Y:return this.y;case cs.Z:return this.getZ()}throw new ii("Invalid ordinate index: "+t)}equals3D(t){return this.x===t.x&&this.y===t.y&&(this.getZ()===t.getZ()||Xn.isNaN(this.getZ())&&Xn.isNaN(t.getZ()))}equals(t){return t instanceof cs?this.equals2D(t):!1}equalInZ(t,s){return uS.equalsWithTolerance(this.getZ(),t.getZ(),s)}setX(t){this.x=t}compareTo(t){const s=t;return this.x<s.x?-1:this.x>s.x?1:this.y<s.y?-1:this.y>s.y?1:0}getX(){return this.x}setZ(t){this.z=t}clone(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return Vp.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw t}finally{}}copy(){return new cs(this)}toString(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}distance3D(t){const s=this.x-t.x,n=this.y-t.y,r=this.getZ()-t.getZ();return Math.sqrt(s*s+n*n+r*r)}getY(){return this.y}setY(t){this.y=t}distance(t){const s=this.x-t.x,n=this.y-t.y;return Math.sqrt(s*s+n*n)}hashCode(){let t=17;return t=37*t+cs.hashCode(this.x),t=37*t+cs.hashCode(this.y),t}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.getZ()}get interfaces_(){return[s0,Mx,Mh]}}class nm{constructor(){nm.constructor_.apply(this,arguments)}static constructor_(){if(this._dimensionsToTest=2,arguments.length===0)nm.constructor_.call(this,2);else if(arguments.length===1){const t=arguments[0];if(t!==2&&t!==3)throw new ii("only 2 or 3 dimensions may be specified");this._dimensionsToTest=t}}static compare(t,s){return t<s?-1:t>s?1:Xn.isNaN(t)?Xn.isNaN(s)?0:-1:Xn.isNaN(s)?1:0}compare(t,s){const n=nm.compare(t.x,s.x);if(n!==0)return n;const r=nm.compare(t.y,s.y);return r!==0?r:this._dimensionsToTest<=2?0:nm.compare(t.getZ(),s.getZ())}get interfaces_(){return[vI]}}cs.DimensionalComparator=nm;cs.NULL_ORDINATE=Xn.NaN;cs.X=0;cs.Y=1;cs.Z=2;cs.M=3;class Fa extends cs{constructor(){super(),Fa.constructor_.apply(this,arguments)}static constructor_(){if(arguments.length===0)cs.constructor_.call(this);else if(arguments.length===1){if(arguments[0]instanceof Fa){const t=arguments[0];cs.constructor_.call(this,t.x,t.y)}else if(arguments[0]instanceof cs){const t=arguments[0];cs.constructor_.call(this,t.x,t.y)}}else if(arguments.length===2){const t=arguments[0],s=arguments[1];cs.constructor_.call(this,t,s,cs.NULL_ORDINATE)}}setOrdinate(t,s){switch(t){case Fa.X:this.x=s;break;case Fa.Y:this.y=s;break;default:throw new ii("Invalid ordinate index: "+t)}}getZ(){return cs.NULL_ORDINATE}getOrdinate(t){switch(t){case Fa.X:return this.x;case Fa.Y:return this.y}throw new ii("Invalid ordinate index: "+t)}setZ(t){throw new ii("CoordinateXY dimension 2 does not support z-ordinate")}copy(){return new Fa(this)}toString(){return"("+this.x+", "+this.y+")"}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.getZ()}}Fa.X=0;Fa.Y=1;Fa.Z=-1;Fa.M=-1;class Wo extends cs{constructor(){super(),Wo.constructor_.apply(this,arguments)}static constructor_(){if(this._m=null,arguments.length===0)cs.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof Wo){const t=arguments[0];cs.constructor_.call(this,t.x,t.y),this._m=t._m}else if(arguments[0]instanceof cs){const t=arguments[0];cs.constructor_.call(this,t.x,t.y),this._m=this.getM()}}else if(arguments.length===3){const t=arguments[0],s=arguments[1],n=arguments[2];cs.constructor_.call(this,t,s,cs.NULL_ORDINATE),this._m=n}}getM(){return this._m}setOrdinate(t,s){switch(t){case Wo.X:this.x=s;break;case Wo.Y:this.y=s;break;case Wo.M:this._m=s;break;default:throw new ii("Invalid ordinate index: "+t)}}setM(t){this._m=t}getZ(){return cs.NULL_ORDINATE}getOrdinate(t){switch(t){case Wo.X:return this.x;case Wo.Y:return this.y;case Wo.M:return this._m}throw new ii("Invalid ordinate index: "+t)}setZ(t){throw new ii("CoordinateXY dimension 2 does not support z-ordinate")}copy(){return new Wo(this)}toString(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.getZ(),this._m=t.getM()}}Wo.X=0;Wo.Y=1;Wo.Z=-1;Wo.M=2;class vm extends cs{constructor(){super(),vm.constructor_.apply(this,arguments)}static constructor_(){if(this._m=null,arguments.length===0)cs.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof vm){const t=arguments[0];cs.constructor_.call(this,t),this._m=t._m}else if(arguments[0]instanceof cs){const t=arguments[0];cs.constructor_.call(this,t),this._m=this.getM()}}else if(arguments.length===4){const t=arguments[0],s=arguments[1],n=arguments[2],r=arguments[3];cs.constructor_.call(this,t,s,n),this._m=r}}getM(){return this._m}setOrdinate(t,s){switch(t){case cs.X:this.x=s;break;case cs.Y:this.y=s;break;case cs.Z:this.z=s;break;case cs.M:this._m=s;break;default:throw new ii("Invalid ordinate index: "+t)}}setM(t){this._m=t}getOrdinate(t){switch(t){case cs.X:return this.x;case cs.Y:return this.y;case cs.Z:return this.getZ();case cs.M:return this.getM()}throw new ii("Invalid ordinate index: "+t)}copy(){return new vm(this)}toString(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.getZ(),this._m=t.getM()}}function Mr(e,t){return e.interfaces_&&e.interfaces_.indexOf(t)>-1}class Tm{add(){}addAll(){}isEmpty(){}iterator(){}size(){}toArray(){}remove(){}}class bI extends ef{constructor(t){super(t),this.name=Object.keys({IndexOutOfBoundsException:bI})[0]}}class XA extends Tm{get(){}set(){}isEmpty(){}}class n0 extends ef{constructor(t){super(t),this.name=Object.keys({NoSuchElementException:n0})[0]}}class r0 extends XA{constructor(t){super(),this.array=[],t instanceof Tm&&this.addAll(t)}get interfaces_(){return[XA,Tm]}ensureCapacity(){}add(t){return arguments.length===1?this.array.push(t):this.array.splice(arguments[0],0,arguments[1]),!0}clear(){this.array=[]}addAll(t){for(const s of t)this.array.push(s)}set(t,s){const n=this.array[t];return this.array[t]=s,n}iterator(){return new xte(this)}get(t){if(t<0||t>=this.size())throw new bI;return this.array[t]}isEmpty(){return this.array.length===0}sort(t){t?this.array.sort((s,n)=>t.compare(s,n)):this.array.sort()}size(){return this.array.length}toArray(){return this.array.slice()}remove(t){for(let s=0,n=this.array.length;s<n;s++)if(this.array[s]===t)return!!this.array.splice(s,1);return!1}[Symbol.iterator](){return this.array.values()}}class xte{constructor(t){this.arrayList=t,this.position=0}next(){if(this.position===this.arrayList.size())throw new n0;return this.arrayList.get(this.position++)}hasNext(){return this.position<this.arrayList.size()}set(t){return this.arrayList.set(this.position-1,t)}remove(){this.arrayList.remove(this.arrayList.get(this.position))}}class bm extends r0{constructor(){super(),bm.constructor_.apply(this,arguments)}static constructor_(){if(arguments.length!==0){if(arguments.length===1){const t=arguments[0];this.ensureCapacity(t.length),this.add(t,!0)}else if(arguments.length===2){const t=arguments[0],s=arguments[1];this.ensureCapacity(t.length),this.add(t,s)}}}getCoordinate(t){return this.get(t)}addAll(){if(arguments.length===2&&typeof arguments[1]=="boolean"&&Mr(arguments[0],Tm)){const t=arguments[0],s=arguments[1];let n=!1;for(let r=t.iterator();r.hasNext();)this.add(r.next(),s),n=!0;return n}else return super.addAll.apply(this,arguments)}clone(){const t=super.clone.call(this);for(let s=0;s<this.size();s++)t.add(s,this.get(s).clone());return t}toCoordinateArray(){if(arguments.length===0)return this.toArray(bm.coordArrayType);if(arguments.length===1){if(arguments[0])return this.toArray(bm.coordArrayType);const s=this.size(),n=new Array(s).fill(null);for(let r=0;r<s;r++)n[r]=this.get(s-r-1);return n}}add(){if(arguments.length===1){const t=arguments[0];return super.add.call(this,t)}else if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){const t=arguments[0],s=arguments[1];return this.add(t,s,!0),!0}else if(arguments[0]instanceof cs&&typeof arguments[1]=="boolean"){const t=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(t))return null;super.add.call(this,t)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){const t=arguments[0],s=arguments[1];return this.add(t,s),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){const t=arguments[0],s=arguments[1];if(arguments[2])for(let r=0;r<t.length;r++)this.add(t[r],s);else for(let r=t.length-1;r>=0;r--)this.add(t[r],s);return!0}else if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof cs){const t=arguments[0],s=arguments[1];if(!arguments[2]){const r=this.size();if(r>0&&(t>0&&this.get(t-1).equals2D(s)||t<r&&this.get(t).equals2D(s)))return null}super.add.call(this,t,s)}}else if(arguments.length===4){const t=arguments[0],s=arguments[1],n=arguments[2],r=arguments[3];let a=1;n>r&&(a=-1);for(let o=n;o!==r;o+=a)this.add(t[o],s);return!0}}closeRing(){if(this.size()>0){const t=this.get(0).copy();this.add(t,!1)}}}bm.coordArrayType=new Array(0).fill(null);class Ex{filter(t,s){}isDone(){}isGeometryChanged(){}}class bo{constructor(){bo.constructor_.apply(this,arguments)}static constructor_(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof cs){const t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof bo){const t=arguments[0];this.init(t)}}else if(arguments.length===2){const t=arguments[0],s=arguments[1];this.init(t.x,s.x,t.y,s.y)}else if(arguments.length===4){const t=arguments[0],s=arguments[1],n=arguments[2],r=arguments[3];this.init(t,s,n,r)}}static intersects(){if(arguments.length===3){const t=arguments[0],s=arguments[1],n=arguments[2];return n.x>=(t.x<s.x?t.x:s.x)&&n.x<=(t.x>s.x?t.x:s.x)&&n.y>=(t.y<s.y?t.y:s.y)&&n.y<=(t.y>s.y?t.y:s.y)}else if(arguments.length===4){const t=arguments[0],s=arguments[1],n=arguments[2],r=arguments[3];let a=Math.min(n.x,r.x),o=Math.max(n.x,r.x),d=Math.min(t.x,s.x),p=Math.max(t.x,s.x);return!(d>o||p<a||(a=Math.min(n.y,r.y),o=Math.max(n.y,r.y),d=Math.min(t.y,s.y),p=Math.max(t.y,s.y),d>o)||p<a)}}getArea(){return this.getWidth()*this.getHeight()}equals(t){if(!(t instanceof bo))return!1;const s=t;return this.isNull()?s.isNull():this._maxx===s.getMaxX()&&this._maxy===s.getMaxY()&&this._minx===s.getMinX()&&this._miny===s.getMinY()}intersection(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new bo;const s=this._minx>t._minx?this._minx:t._minx,n=this._miny>t._miny?this._miny:t._miny,r=this._maxx<t._maxx?this._maxx:t._maxx,a=this._maxy<t._maxy?this._maxy:t._maxy;return new bo(s,r,n,a)}isNull(){return this._maxx<this._minx}getMaxX(){return this._maxx}covers(){if(arguments.length===1){if(arguments[0]instanceof cs){const t=arguments[0];return this.covers(t.x,t.y)}else if(arguments[0]instanceof bo){const t=arguments[0];return this.isNull()||t.isNull()?!1:t.getMinX()>=this._minx&&t.getMaxX()<=this._maxx&&t.getMinY()>=this._miny&&t.getMaxY()<=this._maxy}}else if(arguments.length===2){const t=arguments[0],s=arguments[1];return this.isNull()?!1:t>=this._minx&&t<=this._maxx&&s>=this._miny&&s<=this._maxy}}intersects(){if(arguments.length===1){if(arguments[0]instanceof bo){const t=arguments[0];return this.isNull()||t.isNull()?!1:!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}else if(arguments[0]instanceof cs){const t=arguments[0];return this.intersects(t.x,t.y)}}else if(arguments.length===2){if(arguments[0]instanceof cs&&arguments[1]instanceof cs){const t=arguments[0],s=arguments[1];return!(this.isNull()||(t.x<s.x?t.x:s.x)>this._maxx||(t.x>s.x?t.x:s.x)<this._minx||(t.y<s.y?t.y:s.y)>this._maxy||(t.y>s.y?t.y:s.y)<this._miny)}else if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){const t=arguments[0],s=arguments[1];return this.isNull()?!1:!(t>this._maxx||t<this._minx||s>this._maxy||s<this._miny)}}}getMinY(){return this._miny}getDiameter(){if(this.isNull())return 0;const t=this.getWidth(),s=this.getHeight();return Math.sqrt(t*t+s*s)}getMinX(){return this._minx}expandToInclude(){if(arguments.length===1){if(arguments[0]instanceof cs){const t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof bo){const t=arguments[0];if(t.isNull())return null;this.isNull()?(this._minx=t.getMinX(),this._maxx=t.getMaxX(),this._miny=t.getMinY(),this._maxy=t.getMaxY()):(t._minx<this._minx&&(this._minx=t._minx),t._maxx>this._maxx&&(this._maxx=t._maxx),t._miny<this._miny&&(this._miny=t._miny),t._maxy>this._maxy&&(this._maxy=t._maxy))}}else if(arguments.length===2){const t=arguments[0],s=arguments[1];this.isNull()?(this._minx=t,this._maxx=t,this._miny=s,this._maxy=s):(t<this._minx&&(this._minx=t),t>this._maxx&&(this._maxx=t),s<this._miny&&(this._miny=s),s>this._maxy&&(this._maxy=s))}}minExtent(){if(this.isNull())return 0;const t=this.getWidth(),s=this.getHeight();return t<s?t:s}getWidth(){return this.isNull()?0:this._maxx-this._minx}compareTo(t){const s=t;return this.isNull()?s.isNull()?0:-1:s.isNull()?1:this._minx<s._minx?-1:this._minx>s._minx?1:this._miny<s._miny?-1:this._miny>s._miny?1:this._maxx<s._maxx?-1:this._maxx>s._maxx?1:this._maxy<s._maxy?-1:this._maxy>s._maxy?1:0}translate(t,s){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+s,this.getMaxY()+s)}copy(){return new bo(this)}toString(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}setToNull(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}disjoint(t){return this.isNull()||t.isNull()?!0:t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny}getHeight(){return this.isNull()?0:this._maxy-this._miny}maxExtent(){if(this.isNull())return 0;const t=this.getWidth(),s=this.getHeight();return t>s?t:s}expandBy(){if(arguments.length===1){const t=arguments[0];this.expandBy(t,t)}else if(arguments.length===2){const t=arguments[0],s=arguments[1];if(this.isNull())return null;this._minx-=t,this._maxx+=t,this._miny-=s,this._maxy+=s,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}contains(){if(arguments.length===1){if(arguments[0]instanceof bo){const t=arguments[0];return this.covers(t)}else if(arguments[0]instanceof cs){const t=arguments[0];return this.covers(t)}}else if(arguments.length===2){const t=arguments[0],s=arguments[1];return this.covers(t,s)}}centre(){return this.isNull()?null:new cs((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}init(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof cs){const t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof bo){const t=arguments[0];this._minx=t._minx,this._maxx=t._maxx,this._miny=t._miny,this._maxy=t._maxy}}else if(arguments.length===2){const t=arguments[0],s=arguments[1];this.init(t.x,s.x,t.y,s.y)}else if(arguments.length===4){const t=arguments[0],s=arguments[1],n=arguments[2],r=arguments[3];t<s?(this._minx=t,this._maxx=s):(this._minx=s,this._maxx=t),n<r?(this._miny=n,this._maxy=r):(this._miny=r,this._maxy=n)}}getMaxY(){return this._maxy}distance(t){if(this.intersects(t))return 0;let s=0;this._maxx<t._minx?s=t._minx-this._maxx:this._minx>t._maxx&&(s=this._minx-t._maxx);let n=0;return this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),s===0?n:n===0?s:Math.sqrt(s*s+n*n)}hashCode(){let t=17;return t=37*t+cs.hashCode(this._minx),t=37*t+cs.hashCode(this._maxx),t=37*t+cs.hashCode(this._miny),t=37*t+cs.hashCode(this._maxy),t}get interfaces_(){return[s0,Mh]}}class KA{constructor(t){this.str=t}append(t){this.str+=t}setCharAt(t,s){this.str=this.str.substr(0,t)+s+this.str.substr(t+1)}toString(){return this.str}}class kx{constructor(t){this.value=t}intValue(){return this.value}compareTo(t){return this.value<t?-1:this.value>t?1:0}static compare(t,s){return t<s?-1:t>s?1:0}static isNan(t){return Number.isNaN(t)}static valueOf(t){return new kx(t)}}class g2{static isWhitespace(t){return t<=32&&t>=0||t===127}static toUpperCase(t){return t.toUpperCase()}}class Pv extends ef{constructor(t){super(t),this.name=Object.keys({IllegalStateException:Pv})[0]}}class zt{constructor(){zt.constructor_.apply(this,arguments)}static constructor_(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){const t=arguments[0];this.init(t)}else if(arguments[0]instanceof zt){const t=arguments[0];this.init(t)}else if(typeof arguments[0]=="string"){const t=arguments[0];zt.constructor_.call(this,zt.parse(t))}}else if(arguments.length===2){const t=arguments[0],s=arguments[1];this.init(t,s)}}static determinant(){if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){const t=arguments[0],s=arguments[1],n=arguments[2],r=arguments[3];return zt.determinant(zt.valueOf(t),zt.valueOf(s),zt.valueOf(n),zt.valueOf(r))}else if(arguments[3]instanceof zt&&arguments[2]instanceof zt&&arguments[0]instanceof zt&&arguments[1]instanceof zt){const t=arguments[0],s=arguments[1],n=arguments[2],r=arguments[3];return t.multiply(r).selfSubtract(s.multiply(n))}}static sqr(t){return zt.valueOf(t).selfMultiply(t)}static valueOf(){if(typeof arguments[0]=="string"){const t=arguments[0];return zt.parse(t)}else if(typeof arguments[0]=="number"){const t=arguments[0];return new zt(t)}}static sqrt(t){return zt.valueOf(t).sqrt()}static parse(t){let s=0;const n=t.length;for(;g2.isWhitespace(t.charAt(s));)s++;let r=!1;if(s<n){const I=t.charAt(s);(I==="-"||I==="+")&&(s++,I==="-"&&(r=!0))}const a=new zt;let o=0,d=0,p=0,y=!1;for(;!(s>=n);){const I=t.charAt(s);if(s++,g2.isDigit(I)){const O=I-"0";a.selfMultiply(zt.TEN),a.selfAdd(O),o++;continue}if(I==="."){d=o,y=!0;continue}if(I==="e"||I==="E"){const O=t.substring(s);try{p=kx.parseInt(O)}catch(A){throw A instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+O+" in string "+t):A}finally{}break}throw new NumberFormatException("Unexpected character '"+I+"' at position "+s+" in string "+t)}let v=a;y||(d=o);const C=o-d-p;if(C===0)v=a;else if(C>0){const I=zt.TEN.pow(C);v=a.divide(I)}else if(C<0){const I=zt.TEN.pow(-C);v=a.multiply(I)}return r?v.negate():v}static createNaN(){return new zt(Xn.NaN,Xn.NaN)}static copy(t){return new zt(t)}static magnitude(t){const s=Math.abs(t),n=Math.log(s)/Math.log(10);let r=Math.trunc(Math.floor(n));return Math.pow(10,r)*10<=s&&(r+=1),r}static stringOfChar(t,s){const n=new KA;for(let r=0;r<s;r++)n.append(t);return n.toString()}le(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<=t._lo}extractSignificantDigits(t,s){let n=this.abs(),r=zt.magnitude(n._hi);const a=zt.TEN.pow(r);n=n.divide(a),n.gt(zt.TEN)?(n=n.divide(zt.TEN),r+=1):n.lt(zt.ONE)&&(n=n.multiply(zt.TEN),r-=1);const o=r+1,d=new KA,p=zt.MAX_PRINT_DIGITS-1;for(let y=0;y<=p;y++){t&&y===o&&d.append(".");const v=Math.trunc(n._hi);if(v<0)break;let C=!1,I=0;v>9?(C=!0,I="9"):I="0"+v,d.append(I),n=n.subtract(zt.valueOf(v)).multiply(zt.TEN),C&&n.selfAdd(zt.TEN);let O=!0;const A=zt.magnitude(n._hi);if(A<0&&Math.abs(A)>=p-y&&(O=!1),!O)break}return s[0]=r,d.toString()}sqr(){return this.multiply(this)}doubleValue(){return this._hi+this._lo}subtract(){if(arguments[0]instanceof zt){const t=arguments[0];return this.add(t.negate())}else if(typeof arguments[0]=="number"){const t=arguments[0];return this.add(-t)}}equals(){if(arguments.length===1&&arguments[0]instanceof zt){const t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}}isZero(){return this._hi===0&&this._lo===0}selfSubtract(){if(arguments[0]instanceof zt){const t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}else if(typeof arguments[0]=="number"){const t=arguments[0];return this.isNaN()?this:this.selfAdd(-t,0)}}getSpecialNumberString(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}min(t){return this.le(t)?this:t}selfDivide(){if(arguments.length===1){if(arguments[0]instanceof zt){const t=arguments[0];return this.selfDivide(t._hi,t._lo)}else if(typeof arguments[0]=="number"){const t=arguments[0];return this.selfDivide(t,0)}}else if(arguments.length===2){const t=arguments[0],s=arguments[1];let n=null,r=null,a=null,o=null,d=null,p=null,y=null,v=null;return d=this._hi/t,p=zt.SPLIT*d,n=p-d,v=zt.SPLIT*t,n=p-n,r=d-n,a=v-t,y=d*t,a=v-a,o=t-a,v=n*a-y+n*o+r*a+r*o,p=(this._hi-y-v+this._lo-d*s)/t,v=d+p,this._hi=v,this._lo=d-v+p,this}}dump(){return"DD<"+this._hi+", "+this._lo+">"}divide(){if(arguments[0]instanceof zt){const t=arguments[0];let s=null,n=null,r=null,a=null,o=null,d=null,p=null,y=null;o=this._hi/t._hi,d=zt.SPLIT*o,s=d-o,y=zt.SPLIT*t._hi,s=d-s,n=o-s,r=y-t._hi,p=o*t._hi,r=y-r,a=t._hi-r,y=s*r-p+s*a+n*r+n*a,d=(this._hi-p-y+this._lo-o*t._lo)/t._hi,y=o+d;const v=y,C=o-y+d;return new zt(v,C)}else if(typeof arguments[0]=="number"){const t=arguments[0];return Xn.isNaN(t)?zt.createNaN():zt.copy(this).selfDivide(t,0)}}ge(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>=t._lo}pow(t){if(t===0)return zt.valueOf(1);let s=new zt(this),n=zt.valueOf(1),r=Math.abs(t);if(r>1)for(;r>0;)r%2===1&&n.selfMultiply(s),r/=2,r>0&&(s=s.sqr());else n=s;return t<0?n.reciprocal():n}ceil(){if(this.isNaN())return zt.NaN;const t=Math.ceil(this._hi);let s=0;return t===this._hi&&(s=Math.ceil(this._lo)),new zt(t,s)}compareTo(t){const s=t;return this._hi<s._hi?-1:this._hi>s._hi?1:this._lo<s._lo?-1:this._lo>s._lo?1:0}rint(){return this.isNaN()?this:this.add(.5).floor()}setValue(){if(arguments[0]instanceof zt){const t=arguments[0];return this.init(t),this}else if(typeof arguments[0]=="number"){const t=arguments[0];return this.init(t),this}}max(t){return this.ge(t)?this:t}sqrt(){if(this.isZero())return zt.valueOf(0);if(this.isNegative())return zt.NaN;const t=1/Math.sqrt(this._hi),s=this._hi*t,n=zt.valueOf(s),a=this.subtract(n.sqr())._hi*(t*.5);return n.add(a)}selfAdd(){if(arguments.length===1){if(arguments[0]instanceof zt){const t=arguments[0];return this.selfAdd(t._hi,t._lo)}else if(typeof arguments[0]=="number"){const t=arguments[0];let s=null,n=null,r=null,a=null,o=null,d=null;return r=this._hi+t,o=r-this._hi,a=r-o,a=t-o+(this._hi-a),d=a+this._lo,s=r+d,n=d+(r-s),this._hi=s+n,this._lo=n+(s-this._hi),this}}else if(arguments.length===2){const t=arguments[0],s=arguments[1];let n=null,r=null,a=null,o=null,d=null,p=null,y=null,v=null;d=this._hi+t,a=this._lo+s,y=d-this._hi,v=a-this._lo,p=d-y,o=a-v,p=t-y+(this._hi-p),o=s-v+(this._lo-o),y=p+a,n=d+y,r=y+(d-n),y=o+r;const C=n+y,I=y+(n-C);return this._hi=C,this._lo=I,this}}selfMultiply(){if(arguments.length===1){if(arguments[0]instanceof zt){const t=arguments[0];return this.selfMultiply(t._hi,t._lo)}else if(typeof arguments[0]=="number"){const t=arguments[0];return this.selfMultiply(t,0)}}else if(arguments.length===2){const t=arguments[0],s=arguments[1];let n=null,r=null,a=null,o=null,d=null,p=null;d=zt.SPLIT*this._hi,n=d-this._hi,p=zt.SPLIT*t,n=d-n,r=this._hi-n,a=p-t,d=this._hi*t,a=p-a,o=t-a,p=n*a-d+n*o+r*a+r*o+(this._hi*s+this._lo*t);const y=d+p;n=d-y;const v=p+n;return this._hi=y,this._lo=v,this}}selfSqr(){return this.selfMultiply(this)}floor(){if(this.isNaN())return zt.NaN;const t=Math.floor(this._hi);let s=0;return t===this._hi&&(s=Math.floor(this._lo)),new zt(t,s)}negate(){return this.isNaN()?this:new zt(-this._hi,-this._lo)}clone(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return null;throw t}finally{}}multiply(){if(arguments[0]instanceof zt){const t=arguments[0];return t.isNaN()?zt.createNaN():zt.copy(this).selfMultiply(t)}else if(typeof arguments[0]=="number"){const t=arguments[0];return Xn.isNaN(t)?zt.createNaN():zt.copy(this).selfMultiply(t,0)}}isNaN(){return Xn.isNaN(this._hi)}intValue(){return Math.trunc(this._hi)}toString(){const t=zt.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()}toStandardNotation(){const t=this.getSpecialNumberString();if(t!==null)return t;const s=new Array(1).fill(null),n=this.extractSignificantDigits(!0,s),r=s[0]+1;let a=n;if(n.charAt(0)===".")a="0"+n;else if(r<0)a="0."+zt.stringOfChar("0",-r)+n;else if(n.indexOf(".")===-1){const o=r-n.length,d=zt.stringOfChar("0",o);a=n+d+".0"}return this.isNegative()?"-"+a:a}reciprocal(){let t=null,s=null,n=null,r=null,a=null,o=null,d=null,p=null;a=1/this._hi,o=zt.SPLIT*a,t=o-a,p=zt.SPLIT*this._hi,t=o-t,s=a-t,n=p-this._hi,d=a*this._hi,n=p-n,r=this._hi-n,p=t*n-d+t*r+s*n+s*r,o=(1-d-p-a*this._lo)/this._hi;const y=a+o,v=a-y+o;return new zt(y,v)}toSciNotation(){if(this.isZero())return zt.SCI_NOT_ZERO;const t=this.getSpecialNumberString();if(t!==null)return t;const s=new Array(1).fill(null),n=this.extractSignificantDigits(!1,s),r=zt.SCI_NOT_EXPONENT_CHAR+s[0];if(n.charAt(0)==="0")throw new Pv("Found leading zero: "+n);let a="";n.length>1&&(a=n.substring(1));const o=n.charAt(0)+"."+a;return this.isNegative()?"-"+o+r:o+r}abs(){return this.isNaN()?zt.NaN:this.isNegative()?this.negate():new zt(this)}isPositive(){return this._hi>0||this._hi===0&&this._lo>0}lt(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<t._lo}add(){if(arguments[0]instanceof zt){const t=arguments[0];return zt.copy(this).selfAdd(t)}else if(typeof arguments[0]=="number"){const t=arguments[0];return zt.copy(this).selfAdd(t)}}init(){if(arguments.length===1){if(typeof arguments[0]=="number"){const t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof zt){const t=arguments[0];this._hi=t._hi,this._lo=t._lo}}else if(arguments.length===2){const t=arguments[0],s=arguments[1];this._hi=t,this._lo=s}}gt(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>t._lo}isNegative(){return this._hi<0||this._hi===0&&this._lo<0}trunc(){return this.isNaN()?zt.NaN:this.isPositive()?this.floor():this.ceil()}signum(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}get interfaces_(){return[Mh,s0,Mx]}}zt.PI=new zt(3.141592653589793,12246467991473532e-32);zt.TWO_PI=new zt(6.283185307179586,24492935982947064e-32);zt.PI_2=new zt(1.5707963267948966,6123233995736766e-32);zt.E=new zt(2.718281828459045,14456468917292502e-32);zt.NaN=new zt(Xn.NaN,Xn.NaN);zt.EPS=123259516440783e-46;zt.SPLIT=134217729;zt.MAX_PRINT_DIGITS=32;zt.TEN=zt.valueOf(10);zt.ONE=zt.valueOf(1);zt.SCI_NOT_EXPONENT_CHAR="E";zt.SCI_NOT_ZERO="0.0E0";class ah{static orientationIndex(t,s,n){const r=ah.orientationIndexFilter(t,s,n);if(r<=1)return r;const a=zt.valueOf(s.x).selfAdd(-t.x),o=zt.valueOf(s.y).selfAdd(-t.y),d=zt.valueOf(n.x).selfAdd(-s.x),p=zt.valueOf(n.y).selfAdd(-s.y);return a.selfMultiply(p).selfSubtract(o.selfMultiply(d)).signum()}static signOfDet2x2(){if(arguments[3]instanceof zt&&arguments[2]instanceof zt&&arguments[0]instanceof zt&&arguments[1]instanceof zt){const t=arguments[0],s=arguments[1],n=arguments[2],r=arguments[3];return t.multiply(r).selfSubtract(s.multiply(n)).signum()}else if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){const t=arguments[0],s=arguments[1],n=arguments[2],r=arguments[3],a=zt.valueOf(t),o=zt.valueOf(s),d=zt.valueOf(n),p=zt.valueOf(r);return a.multiply(p).selfSubtract(o.multiply(d)).signum()}}static intersection(t,s,n,r){const a=new zt(t.y).selfSubtract(s.y),o=new zt(s.x).selfSubtract(t.x),d=new zt(t.x).selfMultiply(s.y).selfSubtract(new zt(s.x).selfMultiply(t.y)),p=new zt(n.y).selfSubtract(r.y),y=new zt(r.x).selfSubtract(n.x),v=new zt(n.x).selfMultiply(r.y).selfSubtract(new zt(r.x).selfMultiply(n.y)),C=o.multiply(v).selfSubtract(y.multiply(d)),I=p.multiply(d).selfSubtract(a.multiply(v)),O=a.multiply(y).selfSubtract(p.multiply(o)),A=C.selfDivide(O).doubleValue(),P=I.selfDivide(O).doubleValue();return Xn.isNaN(A)||Xn.isInfinite(A)||Xn.isNaN(P)||Xn.isInfinite(P)?null:new cs(A,P)}static orientationIndexFilter(t,s,n){let r=null;const a=(t.x-n.x)*(s.y-n.y),o=(t.y-n.y)*(s.x-n.x),d=a-o;if(a>0){if(o<=0)return ah.signum(d);r=a+o}else if(a<0){if(o>=0)return ah.signum(d);r=-a-o}else return ah.signum(d);const p=ah.DP_SAFE_EPSILON*r;return d>=p||-d>=p?ah.signum(d):2}static signum(t){return t>0?1:t<0?-1:0}}ah.DP_SAFE_EPSILON=1e-15;class vr{getM(t){if(this.hasM()){const s=this.getDimension()-this.getMeasures();return this.getOrdinate(t,s)}else return Xn.NaN}setOrdinate(t,s,n){}getZ(t){return this.hasZ()?this.getOrdinate(t,2):Xn.NaN}size(){}getOrdinate(t,s){}getCoordinate(){}getCoordinateCopy(t){}createCoordinate(){}getDimension(){}hasM(){return this.getMeasures()>0}getX(t){}hasZ(){return this.getDimension()-this.getMeasures()>2}getMeasures(){return 0}expandEnvelope(t){}copy(){}getY(t){}toCoordinateArray(){}get interfaces_(){return[Mx]}}vr.X=0;vr.Y=1;vr.Z=2;vr.M=3;class zl{static index(t,s,n){return ah.orientationIndex(t,s,n)}static isCCW(){if(arguments[0]instanceof Array){const t=arguments[0],s=t.length-1;if(s<3)throw new ii("Ring has fewer than 4 points, so orientation cannot be determined");let n=t[0],r=0;for(let C=1;C<=s;C++){const I=t[C];I.y>n.y&&(n=I,r=C)}let a=r;do a=a-1,a<0&&(a=s);while(t[a].equals2D(n)&&a!==r);let o=r;do o=(o+1)%s;while(t[o].equals2D(n)&&o!==r);const d=t[a],p=t[o];if(d.equals2D(n)||p.equals2D(n)||d.equals2D(p))return!1;const y=zl.index(d,n,p);let v=null;return y===0?v=d.x>p.x:v=y>0,v}else if(Mr(arguments[0],vr)){const t=arguments[0],s=t.size()-1;if(s<3)throw new ii("Ring has fewer than 4 points, so orientation cannot be determined");let n=t.getCoordinate(0),r=0;for(let C=1;C<=s;C++){const I=t.getCoordinate(C);I.y>n.y&&(n=I,r=C)}let a=null,o=r;do o=o-1,o<0&&(o=s),a=t.getCoordinate(o);while(a.equals2D(n)&&o!==r);let d=null,p=r;do p=(p+1)%s,d=t.getCoordinate(p);while(d.equals2D(n)&&p!==r);if(a.equals2D(n)||d.equals2D(n)||a.equals2D(d))return!1;const y=zl.index(a,n,d);let v=null;return y===0?v=a.x>d.x:v=y>0,v}}}zl.CLOCKWISE=-1;zl.RIGHT=zl.CLOCKWISE;zl.COUNTERCLOCKWISE=1;zl.LEFT=zl.COUNTERCLOCKWISE;zl.COLLINEAR=0;zl.STRAIGHT=zl.COLLINEAR;class dS{static arraycopy(t,s,n,r,a){let o=0;for(let d=s;d<s+a;d++)n[r+o]=t[d],o++}static getProperty(t){return{"line.separator":`
`}[t]}}class Rv{static log10(t){const s=Math.log(t);return Xn.isInfinite(s)||Xn.isNaN(s)?s:s/Rv.LOG_10}static min(t,s,n,r){let a=t;return s<a&&(a=s),n<a&&(a=n),r<a&&(a=r),a}static clamp(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){const t=arguments[0],s=arguments[1],n=arguments[2];return t<s?s:t>n?n:t}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){const t=arguments[0],s=arguments[1],n=arguments[2];return t<s?s:t>n?n:t}}static wrap(t,s){return t<0?s- -t%s:t%s}static max(){if(arguments.length===3){const t=arguments[0],s=arguments[1],n=arguments[2];let r=t;return s>r&&(r=s),n>r&&(r=n),r}else if(arguments.length===4){const t=arguments[0],s=arguments[1],n=arguments[2],r=arguments[3];let a=t;return s>a&&(a=s),n>a&&(a=n),r>a&&(a=r),a}}static average(t,s){return(t+s)/2}}Rv.LOG_10=Math.log(10);class t${create(){if(arguments.length===1)arguments[0]instanceof Array||Mr(arguments[0],vr);else if(arguments.length!==2){if(arguments.length===3){const t=arguments[0],s=arguments[1];return this.create(t,s)}}}}class i0{filter(t){}}class Ws{constructor(){Ws.constructor_.apply(this,arguments)}isGeometryCollection(){return this.getTypeCode()===Ws.TYPECODE_GEOMETRYCOLLECTION}getFactory(){return this._factory}getGeometryN(t){return this}getArea(){return 0}isRectangle(){return!1}equalsExact(t){return this===t||this.equalsExact(t,0)}geometryChanged(){this.apply(Ws.geometryChangedFilter)}geometryChangedAction(){this._envelope=null}equalsNorm(t){return t===null?!1:this.norm().equalsExact(t.norm())}getLength(){return 0}getNumGeometries(){return 1}compareTo(){let t;if(arguments.length===1){const s=arguments[0];return t=s,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(s)}else if(arguments.length===2){const s=arguments[0],n=arguments[1];return t=s,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(s,n)}}getUserData(){return this._userData}getSRID(){return this._SRID}getEnvelope(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}static checkNotGeometryCollection(t){if(t.getTypeCode()===Ws.TYPECODE_GEOMETRYCOLLECTION)throw new ii("This method does not support GeometryCollection arguments")}equal(t,s,n){return n===0?t.equals(s):t.distance(s)<=n}norm(){const t=this.copy();return t.normalize(),t}reverse(){const t=this.reverseInternal();return this.envelope!=null&&(t.envelope=this.envelope.copy()),t.setSRID(this.getSRID()),t}copy(){const t=this.copyInternal();return t.envelope=this._envelope==null?null:this._envelope.copy(),t._SRID=this._SRID,t._userData=this._userData,t}getPrecisionModel(){return this._factory.getPrecisionModel()}getEnvelopeInternal(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new bo(this._envelope)}setSRID(t){this._SRID=t}setUserData(t){this._userData=t}compare(t,s){const n=t.iterator(),r=s.iterator();for(;n.hasNext()&&r.hasNext();){const a=n.next(),o=r.next(),d=a.compareTo(o);if(d!==0)return d}return n.hasNext()?1:r.hasNext()?-1:0}hashCode(){return this.getEnvelopeInternal().hashCode()}isEquivalentClass(t){return this.getTypeCode()==t.getTypeCode()}get interfaces_(){return[Mx,s0,Mh]}getClass(){return Ws}static hasNonEmptyElements(t){for(let s=0;s<t.length;s++)if(!t[s].isEmpty())return!0;return!1}static hasNullElements(t){for(let s=0;s<t.length;s++)if(t[s]===null)return!0;return!1}}Ws.constructor_=function(e){!e||(this._envelope=null,this._userData=null,this._factory=e,this._SRID=e.getSRID())};Ws.TYPECODE_POINT=0;Ws.TYPECODE_MULTIPOINT=1;Ws.TYPECODE_LINESTRING=2;Ws.TYPECODE_LINEARRING=3;Ws.TYPECODE_MULTILINESTRING=4;Ws.TYPECODE_POLYGON=5;Ws.TYPECODE_MULTIPOLYGON=6;Ws.TYPECODE_GEOMETRYCOLLECTION=7;Ws.TYPENAME_POINT="Point";Ws.TYPENAME_MULTIPOINT="MultiPoint";Ws.TYPENAME_LINESTRING="LineString";Ws.TYPENAME_LINEARRING="LinearRing";Ws.TYPENAME_MULTILINESTRING="MultiLineString";Ws.TYPENAME_POLYGON="Polygon";Ws.TYPENAME_MULTIPOLYGON="MultiPolygon";Ws.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection";Ws.geometryChangedFilter={get interfaces_(){return[i0]},filter(e){e.geometryChangedAction()}};class Px{filter(t){}}class wte{static ofLine(t){const s=t.size();if(s<=1)return 0;let n=0;const r=new cs;t.getCoordinate(0,r);let a=r.x,o=r.y;for(let d=1;d<s;d++){t.getCoordinate(d,r);const p=r.x,y=r.y,v=p-a,C=y-o;n+=Math.sqrt(v*v+C*C),a=p,o=y}return n}}class s${}class Yi{static copyCoord(t,s,n,r){const a=Math.min(t.getDimension(),n.getDimension());for(let o=0;o<a;o++)n.setOrdinate(r,o,t.getOrdinate(s,o))}static isRing(t){const s=t.size();return s===0?!0:s<=3?!1:t.getOrdinate(0,vr.X)===t.getOrdinate(s-1,vr.X)&&t.getOrdinate(0,vr.Y)===t.getOrdinate(s-1,vr.Y)}static scroll(){if(arguments.length===2){if(Mr(arguments[0],vr)&&Number.isInteger(arguments[1])){const t=arguments[0],s=arguments[1];Yi.scroll(t,s,Yi.isRing(t))}else if(Mr(arguments[0],vr)&&arguments[1]instanceof cs){const t=arguments[0],s=arguments[1],n=Yi.indexOf(s,t);if(n<=0)return null;Yi.scroll(t,n)}}else if(arguments.length===3){const t=arguments[0],s=arguments[1],n=arguments[2];if(s<=0)return null;const a=t.copy(),o=n?t.size()-1:t.size();for(let d=0;d<o;d++)for(let p=0;p<t.getDimension();p++)t.setOrdinate(d,p,a.getOrdinate((s+d)%o,p));if(n)for(let d=0;d<t.getDimension();d++)t.setOrdinate(o,d,t.getOrdinate(0,d))}}static isEqual(t,s){const n=t.size(),r=s.size();if(n!==r)return!1;const a=Math.min(t.getDimension(),s.getDimension());for(let o=0;o<n;o++)for(let d=0;d<a;d++){const p=t.getOrdinate(o,d),y=s.getOrdinate(o,d);if(t.getOrdinate(o,d)!==s.getOrdinate(o,d)&&!(Xn.isNaN(p)&&Xn.isNaN(y)))return!1}return!0}static minCoordinateIndex(){if(arguments.length===1){const t=arguments[0];return Yi.minCoordinateIndex(t,0,t.size()-1)}else if(arguments.length===3){const t=arguments[0],s=arguments[1],n=arguments[2];let r=-1,a=null;for(let o=s;o<=n;o++){const d=t.getCoordinate(o);(a===null||a.compareTo(d)>0)&&(a=d,r=o)}return r}}static extend(t,s,n){const r=t.create(n,s.getDimension()),a=s.size();if(Yi.copy(s,0,r,0,a),a>0)for(let o=a;o<n;o++)Yi.copy(s,a-1,r,o,1);return r}static reverse(t){const s=t.size()-1,n=Math.trunc(s/2);for(let r=0;r<=n;r++)Yi.swap(t,r,s-r)}static swap(t,s,n){if(s===n)return null;for(let r=0;r<t.getDimension();r++){const a=t.getOrdinate(s,r);t.setOrdinate(s,r,t.getOrdinate(n,r)),t.setOrdinate(n,r,a)}}static copy(t,s,n,r,a){for(let o=0;o<a;o++)Yi.copyCoord(t,s+o,n,r+o)}static ensureValidRing(t,s){const n=s.size();return n===0?s:n<=3?Yi.createClosedRing(t,s,4):s.getOrdinate(0,vr.X)===s.getOrdinate(n-1,vr.X)&&s.getOrdinate(0,vr.Y)===s.getOrdinate(n-1,vr.Y)?s:Yi.createClosedRing(t,s,n+1)}static indexOf(t,s){for(let n=0;n<s.size();n++)if(t.x===s.getOrdinate(n,vr.X)&&t.y===s.getOrdinate(n,vr.Y))return n;return-1}static createClosedRing(t,s,n){const r=t.create(n,s.getDimension()),a=s.size();Yi.copy(s,0,r,0,a);for(let o=a;o<n;o++)Yi.copy(s,0,r,o,1);return r}static minCoordinate(t){let s=null;for(let n=0;n<t.size();n++){const r=t.getCoordinate(n);(s===null||s.compareTo(r)>0)&&(s=r)}return s}}class tf extends ef{constructor(t){super(t),this.name=Object.keys({UnsupportedOperationException:tf})[0]}}class wn{static toDimensionSymbol(t){switch(t){case wn.FALSE:return wn.SYM_FALSE;case wn.TRUE:return wn.SYM_TRUE;case wn.DONTCARE:return wn.SYM_DONTCARE;case wn.P:return wn.SYM_P;case wn.L:return wn.SYM_L;case wn.A:return wn.SYM_A}throw new ii("Unknown dimension value: "+t)}static toDimensionValue(t){switch(g2.toUpperCase(t)){case wn.SYM_FALSE:return wn.FALSE;case wn.SYM_TRUE:return wn.TRUE;case wn.SYM_DONTCARE:return wn.DONTCARE;case wn.SYM_P:return wn.P;case wn.SYM_L:return wn.L;case wn.SYM_A:return wn.A}throw new ii("Unknown dimension symbol: "+t)}}wn.P=0;wn.L=1;wn.A=2;wn.FALSE=-1;wn.TRUE=-2;wn.DONTCARE=-3;wn.SYM_FALSE="F";wn.SYM_TRUE="T";wn.SYM_DONTCARE="*";wn.SYM_P="0";wn.SYM_L="1";wn.SYM_A="2";class Rx{filter(t){}}class jp extends Ws{constructor(){super(),jp.constructor_.apply(this,arguments)}static constructor_(){if(this._points=null,arguments.length!==0){if(arguments.length===2){const t=arguments[0],s=arguments[1];Ws.constructor_.call(this,s),this.init(t)}}}computeEnvelopeInternal(){return this.isEmpty()?new bo:this._points.expandEnvelope(new bo)}isRing(){return this.isClosed()&&this.isSimple()}getCoordinates(){return this._points.toCoordinateArray()}copyInternal(){return new jp(this._points.copy(),this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Ws){const t=arguments[0],s=arguments[1];if(!this.isEquivalentClass(t))return!1;const n=t;if(this._points.size()!==n._points.size())return!1;for(let r=0;r<this._points.size();r++)if(!this.equal(this._points.getCoordinate(r),n._points.getCoordinate(r),s))return!1;return!0}else return super.equalsExact.apply(this,arguments)}normalize(){for(let t=0;t<Math.trunc(this._points.size()/2);t++){const s=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(s))){if(this._points.getCoordinate(t).compareTo(this._points.getCoordinate(s))>0){const n=this._points.copy();Yi.reverse(n),this._points=n}return null}}}getCoordinate(){return this.isEmpty()?null:this._points.getCoordinate(0)}getBoundaryDimension(){return this.isClosed()?wn.FALSE:0}isClosed(){return this.isEmpty()?!1:this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}reverseInternal(){const t=this._points.copy();return Yi.reverse(t),this.getFactory().createLineString(t)}getEndPoint(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}getTypeCode(){return Ws.TYPECODE_LINESTRING}getDimension(){return 1}getLength(){return wte.ofLine(this._points)}getNumPoints(){return this._points.size()}compareToSameClass(){if(arguments.length===1){const s=arguments[0];let n=0,r=0;for(;n<this._points.size()&&r<s._points.size();){const a=this._points.getCoordinate(n).compareTo(s._points.getCoordinate(r));if(a!==0)return a;n++,r++}return n<this._points.size()?1:r<s._points.size()?-1:0}else if(arguments.length===2){const t=arguments[0],s=arguments[1],n=t;return s.compare(this._points,n._points)}}apply(){if(Mr(arguments[0],Px)){const t=arguments[0];for(let s=0;s<this._points.size();s++)t.filter(this._points.getCoordinate(s))}else if(Mr(arguments[0],Ex)){const t=arguments[0];if(this._points.size()===0)return null;for(let s=0;s<this._points.size()&&(t.filter(this._points,s),!t.isDone());s++);t.isGeometryChanged()&&this.geometryChanged()}else Mr(arguments[0],Rx)?arguments[0].filter(this):Mr(arguments[0],i0)&&arguments[0].filter(this)}getBoundary(){throw new tf}isEquivalentClass(t){return t instanceof jp}getCoordinateN(t){return this._points.getCoordinate(t)}getGeometryType(){return Ws.TYPENAME_LINESTRING}getCoordinateSequence(){return this._points}isEmpty(){return this._points.size()===0}init(t){if(t===null&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),t.size()===1)throw new ii("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t}isCoordinate(t){for(let s=0;s<this._points.size();s++)if(this._points.getCoordinate(s).equals(t))return!0;return!1}getStartPoint(){return this.isEmpty()?null:this.getPointN(0)}getPointN(t){return this.getFactory().createPoint(this._points.getCoordinate(t))}get interfaces_(){return[s$]}}class n${}class $v extends Ws{constructor(){super(),$v.constructor_.apply(this,arguments)}static constructor_(){this._coordinates=null;const t=arguments[0],s=arguments[1];Ws.constructor_.call(this,s),this.init(t)}computeEnvelopeInternal(){if(this.isEmpty())return new bo;const t=new bo;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t}getCoordinates(){return this.isEmpty()?[]:[this.getCoordinate()]}copyInternal(){return new $v(this._coordinates.copy(),this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Ws){const t=arguments[0],s=arguments[1];return this.isEquivalentClass(t)?this.isEmpty()&&t.isEmpty()?!0:this.isEmpty()!==t.isEmpty()?!1:this.equal(t.getCoordinate(),this.getCoordinate(),s):!1}else return super.equalsExact.apply(this,arguments)}normalize(){}getCoordinate(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null}getBoundaryDimension(){return wn.FALSE}reverseInternal(){return this.getFactory().createPoint(this._coordinates.copy())}getTypeCode(){return Ws.TYPECODE_POINT}getDimension(){return 0}getNumPoints(){return this.isEmpty()?0:1}getX(){if(this.getCoordinate()===null)throw new Pv("getX called on empty Point");return this.getCoordinate().x}compareToSameClass(){if(arguments.length===1){const s=arguments[0];return this.getCoordinate().compareTo(s.getCoordinate())}else if(arguments.length===2){const t=arguments[0],s=arguments[1],n=t;return s.compare(this._coordinates,n._coordinates)}}apply(){if(Mr(arguments[0],Px)){const t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(Mr(arguments[0],Ex)){const t=arguments[0];if(this.isEmpty())return null;t.filter(this._coordinates,0),t.isGeometryChanged()&&this.geometryChanged()}else Mr(arguments[0],Rx)?arguments[0].filter(this):Mr(arguments[0],i0)&&arguments[0].filter(this)}getBoundary(){return this.getFactory().createGeometryCollection()}getGeometryType(){return Ws.TYPENAME_POINT}getCoordinateSequence(){return this._coordinates}getY(){if(this.getCoordinate()===null)throw new Pv("getY called on empty Point");return this.getCoordinate().y}isEmpty(){return this._coordinates.size()===0}init(t){t===null&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),Vp.isTrue(t.size()<=1),this._coordinates=t}isSimple(){return!0}get interfaces_(){return[n$]}}class Ov{static ofRing(){if(arguments[0]instanceof Array){const t=arguments[0];return Math.abs(Ov.ofRingSigned(t))}else if(Mr(arguments[0],vr)){const t=arguments[0];return Math.abs(Ov.ofRingSigned(t))}}static ofRingSigned(){if(arguments[0]instanceof Array){const t=arguments[0];if(t.length<3)return 0;let s=0;const n=t[0].x;for(let r=1;r<t.length-1;r++){const a=t[r].x-n,o=t[r+1].y,d=t[r-1].y;s+=a*(d-o)}return s/2}else if(Mr(arguments[0],vr)){const t=arguments[0],s=t.size();if(s<3)return 0;const n=new cs,r=new cs,a=new cs;t.getCoordinate(0,r),t.getCoordinate(1,a);const o=r.x;a.x-=o;let d=0;for(let p=1;p<s-1;p++)n.y=r.y,r.x=a.x,r.y=a.y,t.getCoordinate(p+1,a),a.x-=o,d+=r.x*(n.y-a.y);return d/2}}}class Q1{static sort(){const t=arguments[0];if(arguments.length===1)t.sort((s,n)=>s.compareTo(n));else if(arguments.length===2)t.sort((s,n)=>arguments[1].compare(s,n));else if(arguments.length===3){const s=t.slice(arguments[1],arguments[2]);s.sort();const n=t.slice(0,arguments[1]).concat(s,t.slice(arguments[2],t.length));t.splice(0,t.length);for(const r of n)t.push(r)}else if(arguments.length===4){const s=t.slice(arguments[1],arguments[2]);s.sort((r,a)=>arguments[3].compare(r,a));const n=t.slice(0,arguments[1]).concat(s,t.slice(arguments[2],t.length));t.splice(0,t.length);for(const r of n)t.push(r)}}static asList(t){const s=new r0;for(const n of t)s.add(n);return s}static copyOf(t,s){return t.slice(0,s)}}class r${}class Lv extends Ws{constructor(){super(),Lv.constructor_.apply(this,arguments)}static constructor_(){this._shell=null,this._holes=null;let t=arguments[0],s=arguments[1],n=arguments[2];if(Ws.constructor_.call(this,n),t===null&&(t=this.getFactory().createLinearRing()),s===null&&(s=[]),Ws.hasNullElements(s))throw new ii("holes must not contain null elements");if(t.isEmpty()&&Ws.hasNonEmptyElements(s))throw new ii("shell is empty but holes are not");this._shell=t,this._holes=s}computeEnvelopeInternal(){return this._shell.getEnvelopeInternal()}getCoordinates(){if(this.isEmpty())return[];const t=new Array(this.getNumPoints()).fill(null);let s=-1;const n=this._shell.getCoordinates();for(let r=0;r<n.length;r++)s++,t[s]=n[r];for(let r=0;r<this._holes.length;r++){const a=this._holes[r].getCoordinates();for(let o=0;o<a.length;o++)s++,t[s]=a[o]}return t}getArea(){let t=0;t+=Ov.ofRing(this._shell.getCoordinateSequence());for(let s=0;s<this._holes.length;s++)t-=Ov.ofRing(this._holes[s].getCoordinateSequence());return t}copyInternal(){const t=this._shell.copy(),s=new Array(this._holes.length).fill(null);for(let n=0;n<this._holes.length;n++)s[n]=this._holes[n].copy();return new Lv(t,s,this._factory)}isRectangle(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;const t=this._shell.getCoordinateSequence(),s=this.getEnvelopeInternal();for(let a=0;a<5;a++){const o=t.getX(a);if(!(o===s.getMinX()||o===s.getMaxX()))return!1;const d=t.getY(a);if(!(d===s.getMinY()||d===s.getMaxY()))return!1}let n=t.getX(0),r=t.getY(0);for(let a=1;a<=4;a++){const o=t.getX(a),d=t.getY(a);if(o!==n===(d!==r))return!1;n=o,r=d}return!0}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Ws){const t=arguments[0],s=arguments[1];if(!this.isEquivalentClass(t))return!1;const n=t,r=this._shell,a=n._shell;if(!r.equalsExact(a,s)||this._holes.length!==n._holes.length)return!1;for(let o=0;o<this._holes.length;o++)if(!this._holes[o].equalsExact(n._holes[o],s))return!1;return!0}else return super.equalsExact.apply(this,arguments)}normalize(){if(arguments.length===0){this._shell=this.normalized(this._shell,!0);for(let t=0;t<this._holes.length;t++)this._holes[t]=this.normalized(this._holes[t],!1);Q1.sort(this._holes)}else if(arguments.length===2){const t=arguments[0],s=arguments[1];if(t.isEmpty())return null;const n=t.getCoordinateSequence(),r=Yi.minCoordinateIndex(n,0,n.size()-2);Yi.scroll(n,r,!0),zl.isCCW(n)===s&&Yi.reverse(n)}}getCoordinate(){return this._shell.getCoordinate()}getNumInteriorRing(){return this._holes.length}getBoundaryDimension(){return 1}reverseInternal(){const t=this.getExteriorRing().reverse(),s=new Array(this.getNumInteriorRing()).fill(null);for(let n=0;n<s.length;n++)s[n]=this.getInteriorRingN(n).reverse();return this.getFactory().createPolygon(t,s)}getTypeCode(){return Ws.TYPECODE_POLYGON}getDimension(){return 2}getLength(){let t=0;t+=this._shell.getLength();for(let s=0;s<this._holes.length;s++)t+=this._holes[s].getLength();return t}getNumPoints(){let t=this._shell.getNumPoints();for(let s=0;s<this._holes.length;s++)t+=this._holes[s].getNumPoints();return t}convexHull(){return this.getExteriorRing().convexHull()}normalized(t,s){const n=t.copy();return this.normalize(n,s),n}compareToSameClass(){if(arguments.length===1){const t=arguments[0],s=this._shell,n=t._shell;return s.compareToSameClass(n)}else if(arguments.length===2){const t=arguments[0],s=arguments[1],n=t,r=this._shell,a=n._shell,o=r.compareToSameClass(a,s);if(o!==0)return o;const d=this.getNumInteriorRing(),p=n.getNumInteriorRing();let y=0;for(;y<d&&y<p;){const v=this.getInteriorRingN(y),C=n.getInteriorRingN(y),I=v.compareToSameClass(C,s);if(I!==0)return I;y++}return y<d?1:y<p?-1:0}}apply(){if(Mr(arguments[0],Px)){const t=arguments[0];this._shell.apply(t);for(let s=0;s<this._holes.length;s++)this._holes[s].apply(t)}else if(Mr(arguments[0],Ex)){const t=arguments[0];if(this._shell.apply(t),!t.isDone())for(let s=0;s<this._holes.length&&(this._holes[s].apply(t),!t.isDone());s++);t.isGeometryChanged()&&this.geometryChanged()}else if(Mr(arguments[0],Rx))arguments[0].filter(this);else if(Mr(arguments[0],i0)){const t=arguments[0];t.filter(this),this._shell.apply(t);for(let s=0;s<this._holes.length;s++)this._holes[s].apply(t)}}getBoundary(){if(this.isEmpty())return this.getFactory().createMultiLineString();const t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(let s=0;s<this._holes.length;s++)t[s+1]=this._holes[s];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)}getGeometryType(){return Ws.TYPENAME_POLYGON}getExteriorRing(){return this._shell}isEmpty(){return this._shell.isEmpty()}getInteriorRingN(t){return this._holes[t]}get interfaces_(){return[r$]}}class i$ extends Tm{contains(){}}class Ste extends i${}class JA extends Ste{constructor(t){super(),this.array=[],t instanceof Tm&&this.addAll(t)}contains(t){for(const s of this.array)if(s.compareTo(t)===0)return!0;return!1}add(t){if(this.contains(t))return!1;for(let s=0,n=this.array.length;s<n;s++)if(this.array[s].compareTo(t)===1)return!!this.array.splice(s,0,t);return this.array.push(t),!0}addAll(t){for(const s of t)this.add(s);return!0}remove(){throw new tf}size(){return this.array.length}isEmpty(){return this.array.length===0}toArray(){return this.array.slice()}iterator(){return new Cte(this.array)}}class Cte{constructor(t){this.array=t,this.position=0}next(){if(this.position===this.array.length)throw new n0;return this.array[this.position++]}hasNext(){return this.position<this.array.length}remove(){throw new tf}}class $c extends Ws{constructor(){super(),$c.constructor_.apply(this,arguments)}static constructor_(){if(this._geometries=null,arguments.length!==0){if(arguments.length===2){let t=arguments[0],s=arguments[1];if(Ws.constructor_.call(this,s),t===null&&(t=[]),Ws.hasNullElements(t))throw new ii("geometries must not contain null elements");this._geometries=t}}}computeEnvelopeInternal(){const t=new bo;for(let s=0;s<this._geometries.length;s++)t.expandToInclude(this._geometries[s].getEnvelopeInternal());return t}getGeometryN(t){return this._geometries[t]}getCoordinates(){const t=new Array(this.getNumPoints()).fill(null);let s=-1;for(let n=0;n<this._geometries.length;n++){const r=this._geometries[n].getCoordinates();for(let a=0;a<r.length;a++)s++,t[s]=r[a]}return t}getArea(){let t=0;for(let s=0;s<this._geometries.length;s++)t+=this._geometries[s].getArea();return t}copyInternal(){const t=new Array(this._geometries.length).fill(null);for(let s=0;s<t.length;s++)t[s]=this._geometries[s].copy();return new $c(t,this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Ws){const t=arguments[0],s=arguments[1];if(!this.isEquivalentClass(t))return!1;const n=t;if(this._geometries.length!==n._geometries.length)return!1;for(let r=0;r<this._geometries.length;r++)if(!this._geometries[r].equalsExact(n._geometries[r],s))return!1;return!0}else return super.equalsExact.apply(this,arguments)}normalize(){for(let t=0;t<this._geometries.length;t++)this._geometries[t].normalize();Q1.sort(this._geometries)}getCoordinate(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}getBoundaryDimension(){let t=wn.FALSE;for(let s=0;s<this._geometries.length;s++)t=Math.max(t,this._geometries[s].getBoundaryDimension());return t}reverseInternal(){const t=this._geometries.length,s=new r0(t);for(let n=0;n<t;n++)s.add(this._geometries[n].reverse());return this.getFactory().buildGeometry(s)}getTypeCode(){return Ws.TYPECODE_GEOMETRYCOLLECTION}getDimension(){let t=wn.FALSE;for(let s=0;s<this._geometries.length;s++)t=Math.max(t,this._geometries[s].getDimension());return t}getLength(){let t=0;for(let s=0;s<this._geometries.length;s++)t+=this._geometries[s].getLength();return t}getNumPoints(){let t=0;for(let s=0;s<this._geometries.length;s++)t+=this._geometries[s].getNumPoints();return t}getNumGeometries(){return this._geometries.length}compareToSameClass(){if(arguments.length===1){const t=arguments[0],s=new JA(Q1.asList(this._geometries)),n=new JA(Q1.asList(t._geometries));return this.compare(s,n)}else if(arguments.length===2){const t=arguments[0],s=arguments[1],n=t,r=this.getNumGeometries(),a=n.getNumGeometries();let o=0;for(;o<r&&o<a;){const d=this.getGeometryN(o),p=n.getGeometryN(o),y=d.compareToSameClass(p,s);if(y!==0)return y;o++}return o<r?1:o<a?-1:0}}apply(){if(Mr(arguments[0],Px)){const t=arguments[0];for(let s=0;s<this._geometries.length;s++)this._geometries[s].apply(t)}else if(Mr(arguments[0],Ex)){const t=arguments[0];if(this._geometries.length===0)return null;for(let s=0;s<this._geometries.length&&(this._geometries[s].apply(t),!t.isDone());s++);t.isGeometryChanged()&&this.geometryChanged()}else if(Mr(arguments[0],Rx)){const t=arguments[0];t.filter(this);for(let s=0;s<this._geometries.length;s++)this._geometries[s].apply(t)}else if(Mr(arguments[0],i0)){const t=arguments[0];t.filter(this);for(let s=0;s<this._geometries.length;s++)this._geometries[s].apply(t)}}getBoundary(){return Ws.checkNotGeometryCollection(this),Vp.shouldNeverReachHere(),null}getGeometryType(){return Ws.TYPENAME_GEOMETRYCOLLECTION}isEmpty(){for(let t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0}}class Nv extends $c{constructor(){super(),Nv.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],s=arguments[1];$c.constructor_.call(this,t,s)}copyInternal(){const t=new Array(this._geometries.length).fill(null);for(let s=0;s<t.length;s++)t[s]=this._geometries[s].copy();return new Nv(t,this._factory)}isValid(){return!0}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Ws){const t=arguments[0],s=arguments[1];return this.isEquivalentClass(t)?super.equalsExact.call(this,t,s):!1}else return super.equalsExact.apply(this,arguments)}getCoordinate(){if(arguments.length===1&&Number.isInteger(arguments[0])){const t=arguments[0];return this._geometries[t].getCoordinate()}else return super.getCoordinate.apply(this,arguments)}getBoundaryDimension(){return wn.FALSE}getTypeCode(){return Ws.TYPECODE_MULTIPOINT}getDimension(){return 0}getBoundary(){return this.getFactory().createGeometryCollection()}getGeometryType(){return Ws.TYPENAME_MULTIPOINT}get interfaces_(){return[n$]}}class xm extends jp{constructor(){super(),xm.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],s=arguments[1];jp.constructor_.call(this,t,s),this.validateConstruction()}copyInternal(){return new xm(this._points.copy(),this._factory)}getBoundaryDimension(){return wn.FALSE}isClosed(){return this.isEmpty()?!0:super.isClosed.call(this)}reverseInternal(){const t=this._points.copy();return Yi.reverse(t),this.getFactory().createLinearRing(t)}getTypeCode(){return Ws.TYPECODE_LINEARRING}validateConstruction(){if(!this.isEmpty()&&!super.isClosed.call(this))throw new ii("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<xm.MINIMUM_VALID_SIZE)throw new ii("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}getGeometryType(){return Ws.TYPENAME_LINEARRING}}xm.MINIMUM_VALID_SIZE=4;class kg{static measures(t){return t instanceof Fa?0:t instanceof Wo||t instanceof vm?1:(t instanceof cs,0)}static dimension(t){return t instanceof Fa?2:t instanceof Wo?3:t instanceof vm?4:(t instanceof cs,3)}static create(){if(arguments.length===1){const t=arguments[0];return kg.create(t,0)}else if(arguments.length===2){const t=arguments[0],s=arguments[1];return t===2?new Fa:t===3&&s===0?new cs:t===3&&s===1?new Wo:t===4&&s===1?new vm:new cs}}}class ya{static isRing(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))}static ptNotInList(t,s){for(let n=0;n<t.length;n++){const r=t[n];if(ya.indexOf(r,s)<0)return r}return null}static scroll(t,s){const n=ya.indexOf(s,t);if(n<0)return null;const r=new Array(t.length).fill(null);dS.arraycopy(t,n,r,0,t.length-n),dS.arraycopy(t,0,r,t.length-n,n),dS.arraycopy(r,0,t,0,t.length)}static equals(){if(arguments.length===2){const t=arguments[0],s=arguments[1];if(t===s)return!0;if(t===null||s===null||t.length!==s.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].equals(s[n]))return!1;return!0}else if(arguments.length===3){const t=arguments[0],s=arguments[1],n=arguments[2];if(t===s)return!0;if(t===null||s===null||t.length!==s.length)return!1;for(let r=0;r<t.length;r++)if(n.compare(t[r],s[r])!==0)return!1;return!0}}static intersection(t,s){const n=new bm;for(let r=0;r<t.length;r++)s.intersects(t[r])&&n.add(t[r],!0);return n.toCoordinateArray()}static measures(t){if(t===null||t.length===0)return 0;let s=0;for(const n of t)s=Math.max(s,kg.measures(n));return s}static hasRepeatedPoints(t){for(let s=1;s<t.length;s++)if(t[s-1].equals(t[s]))return!0;return!1}static removeRepeatedPoints(t){return ya.hasRepeatedPoints(t)?new bm(t,!1).toCoordinateArray():t}static reverse(t){const s=t.length-1,n=Math.trunc(s/2);for(let r=0;r<=n;r++){const a=t[r];t[r]=t[s-r],t[s-r]=a}}static removeNull(t){let s=0;for(let a=0;a<t.length;a++)t[a]!==null&&s++;const n=new Array(s).fill(null);if(s===0)return n;let r=0;for(let a=0;a<t.length;a++)t[a]!==null&&(n[r++]=t[a]);return n}static copyDeep(){if(arguments.length===1){const t=arguments[0],s=new Array(t.length).fill(null);for(let n=0;n<t.length;n++)s[n]=t[n].copy();return s}else if(arguments.length===5){const t=arguments[0],s=arguments[1],n=arguments[2],r=arguments[3],a=arguments[4];for(let o=0;o<a;o++)n[r+o]=t[s+o].copy()}}static isEqualReversed(t,s){for(let n=0;n<t.length;n++){const r=t[n],a=s[t.length-n-1];if(r.compareTo(a)!==0)return!1}return!0}static envelope(t){const s=new bo;for(let n=0;n<t.length;n++)s.expandToInclude(t[n]);return s}static toCoordinateArray(t){return t.toArray(ya.coordArrayType)}static dimension(t){if(t===null||t.length===0)return 3;let s=0;for(const n of t)s=Math.max(s,kg.dimension(n));return s}static atLeastNCoordinatesOrNothing(t,s){return s.length>=t?s:[]}static indexOf(t,s){for(let n=0;n<s.length;n++)if(t.equals(s[n]))return n;return-1}static increasingDirection(t){for(let s=0;s<Math.trunc(t.length/2);s++){const n=t.length-1-s,r=t[s].compareTo(t[n]);if(r!==0)return r}return 1}static compare(t,s){let n=0;for(;n<t.length&&n<s.length;){const r=t[n].compareTo(s[n]);if(r!==0)return r;n++}return n<s.length?-1:n<t.length?1:0}static minCoordinate(t){let s=null;for(let n=0;n<t.length;n++)(s===null||s.compareTo(t[n])>0)&&(s=t[n]);return s}static extract(t,s,n){s=Rv.clamp(s,0,t.length),n=Rv.clamp(n,-1,t.length);let r=n-s+1;n<0&&(r=0),s>=t.length&&(r=0),n<s&&(r=0);const a=new Array(r).fill(null);if(r===0)return a;let o=0;for(let d=s;d<=n;d++)a[o++]=t[d];return a}}class Ite{compare(t,s){const n=t,r=s;return ya.compare(n,r)}get interfaces_(){return[vI]}}class Tte{compare(t,s){const n=t,r=s;if(n.length<r.length)return-1;if(n.length>r.length)return 1;if(n.length===0)return 0;const a=ya.compare(n,r);return ya.isEqualReversed(n,r)?0:a}OLDcompare(t,s){const n=t,r=s;if(n.length<r.length)return-1;if(n.length>r.length)return 1;if(n.length===0)return 0;const a=ya.increasingDirection(n),o=ya.increasingDirection(r);let d=a>0?0:n.length-1,p=o>0?0:n.length-1;for(let y=0;y<n.length;y++){const v=n[d].compareTo(r[p]);if(v!==0)return v;d+=a,p+=o}return 0}get interfaces_(){return[vI]}}ya.ForwardComparator=Ite;ya.BidirectionalComparator=Tte;ya.coordArrayType=new Array(0).fill(null);class Ate{constructor(t){this.str=t}append(t){this.str+=t}setCharAt(t,s){this.str=this.str.substr(0,t)+s+this.str.substr(t+1)}toString(){return this.str}}class dh{constructor(){dh.constructor_.apply(this,arguments)}static constructor_(){if(this._dimension=3,this._measures=0,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array){const t=arguments[0];dh.constructor_.call(this,t,ya.dimension(t),ya.measures(t))}else if(Number.isInteger(arguments[0])){const t=arguments[0];this._coordinates=new Array(t).fill(null);for(let s=0;s<t;s++)this._coordinates[s]=new cs}else if(Mr(arguments[0],vr)){const t=arguments[0];if(t===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=t.getDimension(),this._measures=t.getMeasures(),this._coordinates=new Array(t.size()).fill(null);for(let s=0;s<this._coordinates.length;s++)this._coordinates[s]=t.getCoordinateCopy(s)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){const t=arguments[0],s=arguments[1];dh.constructor_.call(this,t,s,ya.measures(t))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){const t=arguments[0],s=arguments[1];this._coordinates=new Array(t).fill(null),this._dimension=s;for(let n=0;n<t;n++)this._coordinates[n]=kg.create(s)}}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){const t=arguments[0],s=arguments[1],n=arguments[2];this._dimension=s,this._measures=n,t===null?this._coordinates=new Array(0).fill(null):this._coordinates=t}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){const t=arguments[0],s=arguments[1],n=arguments[2];this._coordinates=new Array(t).fill(null),this._dimension=s,this._measures=n;for(let r=0;r<t;r++)this._coordinates[r]=this.createCoordinate()}}}getM(t){return this.hasM()?this._coordinates[t].getM():Xn.NaN}setOrdinate(t,s,n){switch(s){case vr.X:this._coordinates[t].x=n;break;case vr.Y:this._coordinates[t].y=n;break;default:this._coordinates[t].setOrdinate(s,n)}}getZ(t){return this.hasZ()?this._coordinates[t].getZ():Xn.NaN}size(){return this._coordinates.length}getOrdinate(t,s){switch(s){case vr.X:return this._coordinates[t].x;case vr.Y:return this._coordinates[t].y;default:return this._coordinates[t].getOrdinate(s)}}getCoordinate(){if(arguments.length===1){const t=arguments[0];return this._coordinates[t]}else if(arguments.length===2){const t=arguments[0];arguments[1].setCoordinate(this._coordinates[t])}}getCoordinateCopy(t){const s=this.createCoordinate();return s.setCoordinate(this._coordinates[t]),s}createCoordinate(){return kg.create(this.getDimension(),this.getMeasures())}getDimension(){return this._dimension}getX(t){return this._coordinates[t].x}getMeasures(){return this._measures}expandEnvelope(t){for(let s=0;s<this._coordinates.length;s++)t.expandToInclude(this._coordinates[s]);return t}copy(){const t=new Array(this.size()).fill(null);for(let s=0;s<this._coordinates.length;s++){const n=this.createCoordinate();n.setCoordinate(this._coordinates[s]),t[s]=n}return new dh(t,this._dimension,this._measures)}toString(){if(this._coordinates.length>0){const t=new Ate(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(let s=1;s<this._coordinates.length;s++)t.append(", "),t.append(this._coordinates[s]);return t.append(")"),t.toString()}else return"()"}getY(t){return this._coordinates[t].y}toCoordinateArray(){return this._coordinates}get interfaces_(){return[vr,Mh]}}class Pg{static instance(){return Pg.instanceObject}readResolve(){return Pg.instance()}create(){if(arguments.length===1){if(arguments[0]instanceof Array){const t=arguments[0];return new dh(t)}else if(Mr(arguments[0],vr)){const t=arguments[0];return new dh(t)}}else if(arguments.length===2){let t=arguments[0],s=arguments[1];return s>3&&(s=3),s<2&&(s=2),new dh(t,s)}else if(arguments.length===3){let t=arguments[0],s=arguments[1],n=arguments[2],r=s-n;return n>1&&(n=1),r>3&&(r=3),r<2&&(r=2),new dh(t,r+n,n)}}get interfaces_(){return[t$,Mh]}}Pg.instanceObject=new Pg;class Dv extends $c{constructor(){super(),Dv.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],s=arguments[1];$c.constructor_.call(this,t,s)}copyInternal(){const t=new Array(this._geometries.length).fill(null);for(let s=0;s<t.length;s++)t[s]=this._geometries[s].copy();return new Dv(t,this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Ws){const t=arguments[0],s=arguments[1];return this.isEquivalentClass(t)?super.equalsExact.call(this,t,s):!1}else return super.equalsExact.apply(this,arguments)}getBoundaryDimension(){return 1}getTypeCode(){return Ws.TYPECODE_MULTIPOLYGON}getDimension(){return 2}getBoundary(){if(this.isEmpty())return this.getFactory().createMultiLineString();const t=new r0;for(let n=0;n<this._geometries.length;n++){const a=this._geometries[n].getBoundary();for(let o=0;o<a.getNumGeometries();o++)t.add(a.getGeometryN(o))}const s=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(s))}getGeometryType(){return Ws.TYPENAME_MULTIPOLYGON}get interfaces_(){return[r$]}}class Mte{get(){}put(){}size(){}values(){}entrySet(){}}class Ete extends i${constructor(t){super(),this.map=new Map,t instanceof Tm&&this.addAll(t)}contains(t){const s=t.hashCode?t.hashCode():t;return!!this.map.has(s)}add(t){const s=t.hashCode?t.hashCode():t;return this.map.has(s)?!1:!!this.map.set(s,t)}addAll(t){for(const s of t)this.add(s);return!0}remove(){throw new tf}size(){return this.map.size}isEmpty(){return this.map.size===0}toArray(){return Array.from(this.map.values())}iterator(){return new kte(this.map)}[Symbol.iterator](){return this.map}}class kte{constructor(t){this.iterator=t.values();const{done:s,value:n}=this.iterator.next();this.done=s,this.value=n}next(){if(this.done)throw new n0;const t=this.value,{done:s,value:n}=this.iterator.next();return this.done=s,this.value=n,t}hasNext(){return!this.done}remove(){throw new tf}}class Pte extends Mte{constructor(){super(),this.map=new Map}get(t){return this.map.get(t)||null}put(t,s){return this.map.set(t,s),s}values(){const t=new r0,s=this.map.values();let n=s.next();for(;!n.done;)t.add(n.value),n=s.next();return t}entrySet(){const t=new Ete;return this.map.entries().forEach(s=>t.add(s)),t}size(){return this.map.size()}}class ni{constructor(){ni.constructor_.apply(this,arguments)}static constructor_(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=ni.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof ld){const t=arguments[0];this._modelType=t,t===ni.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){const t=arguments[0];this._modelType=ni.FIXED,this.setScale(t)}else if(arguments[0]instanceof ni){const t=arguments[0];this._modelType=t._modelType,this._scale=t._scale}}}static mostPrecise(t,s){return t.compareTo(s)>=0?t:s}equals(t){if(!(t instanceof ni))return!1;const s=t;return this._modelType===s._modelType&&this._scale===s._scale}compareTo(t){const s=t,n=this.getMaximumSignificantDigits(),r=s.getMaximumSignificantDigits();return kx.compare(n,r)}getScale(){return this._scale}isFloating(){return this._modelType===ni.FLOATING||this._modelType===ni.FLOATING_SINGLE}getType(){return this._modelType}toString(){let t="UNKNOWN";return this._modelType===ni.FLOATING?t="Floating":this._modelType===ni.FLOATING_SINGLE?t="Floating-Single":this._modelType===ni.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t}makePrecise(){if(typeof arguments[0]=="number"){const t=arguments[0];return Xn.isNaN(t)||this._modelType===ni.FLOATING_SINGLE?t:this._modelType===ni.FIXED?Math.round(t*this._scale)/this._scale:t}else if(arguments[0]instanceof cs){const t=arguments[0];if(this._modelType===ni.FLOATING)return null;t.x=this.makePrecise(t.x),t.y=this.makePrecise(t.y)}}getMaximumSignificantDigits(){let t=16;return this._modelType===ni.FLOATING?t=16:this._modelType===ni.FLOATING_SINGLE?t=6:this._modelType===ni.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t}setScale(t){this._scale=Math.abs(t)}get interfaces_(){return[Mh,s0]}}class ld{constructor(){ld.constructor_.apply(this,arguments)}static constructor_(){this._name=null;const t=arguments[0];this._name=t,ld.nameToTypeMap.put(t,this)}readResolve(){return ld.nameToTypeMap.get(this._name)}toString(){return this._name}get interfaces_(){return[Mh]}}ld.nameToTypeMap=new Pte;ni.Type=ld;ni.FIXED=new ld("FIXED");ni.FLOATING=new ld("FLOATING");ni.FLOATING_SINGLE=new ld("FLOATING SINGLE");ni.maximumPreciseValue=9007199254740992;class Bv extends $c{constructor(){super(),Bv.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],s=arguments[1];$c.constructor_.call(this,t,s)}copyInternal(){const t=new Array(this._geometries.length).fill(null);for(let s=0;s<t.length;s++)t[s]=this._geometries[s].copy();return new Bv(t,this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Ws){const t=arguments[0],s=arguments[1];return this.isEquivalentClass(t)?super.equalsExact.call(this,t,s):!1}else return super.equalsExact.apply(this,arguments)}getBoundaryDimension(){return this.isClosed()?wn.FALSE:0}isClosed(){if(this.isEmpty())return!1;for(let t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0}getTypeCode(){return Ws.TYPECODE_MULTILINESTRING}getDimension(){return 1}getBoundary(){throw new tf}getGeometryType(){return Ws.TYPENAME_MULTILINESTRING}get interfaces_(){return[s$]}}class fa{constructor(){fa.constructor_.apply(this,arguments)}static constructor_(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,arguments.length===0)fa.constructor_.call(this,new ni,0);else if(arguments.length===1){if(Mr(arguments[0],t$)){const t=arguments[0];fa.constructor_.call(this,new ni,0,t)}else if(arguments[0]instanceof ni){const t=arguments[0];fa.constructor_.call(this,t,0,fa.getDefaultCoordinateSequenceFactory())}}else if(arguments.length===2){const t=arguments[0],s=arguments[1];fa.constructor_.call(this,t,s,fa.getDefaultCoordinateSequenceFactory())}else if(arguments.length===3){const t=arguments[0],s=arguments[1],n=arguments[2];this._precisionModel=t,this._coordinateSequenceFactory=n,this._SRID=s}}static toMultiPolygonArray(t){const s=new Array(t.size()).fill(null);return t.toArray(s)}static toGeometryArray(t){if(t===null)return null;const s=new Array(t.size()).fill(null);return t.toArray(s)}static getDefaultCoordinateSequenceFactory(){return Pg.instance()}static toMultiLineStringArray(t){const s=new Array(t.size()).fill(null);return t.toArray(s)}static toLineStringArray(t){const s=new Array(t.size()).fill(null);return t.toArray(s)}static toMultiPointArray(t){const s=new Array(t.size()).fill(null);return t.toArray(s)}static toLinearRingArray(t){const s=new Array(t.size()).fill(null);return t.toArray(s)}static toPointArray(t){const s=new Array(t.size()).fill(null);return t.toArray(s)}static toPolygonArray(t){const s=new Array(t.size()).fill(null);return t.toArray(s)}static createPointFromInternalCoord(t,s){return s.getPrecisionModel().makePrecise(t),s.getFactory().createPoint(t)}createEmpty(t){switch(t){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new ii("Invalid dimension: "+t)}}toGeometry(t){return t.isNull()?this.createPoint():t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new cs(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new cs(t.getMinX(),t.getMinY()),new cs(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new cs(t.getMinX(),t.getMinY()),new cs(t.getMinX(),t.getMaxY()),new cs(t.getMaxX(),t.getMaxY()),new cs(t.getMaxX(),t.getMinY()),new cs(t.getMinX(),t.getMinY())]),null)}createLineString(){if(arguments.length===0)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){const t=arguments[0];return this.createLineString(t!==null?this.getCoordinateSequenceFactory().create(t):null)}else if(Mr(arguments[0],vr)){const t=arguments[0];return new jp(t,this)}}}createMultiLineString(){if(arguments.length===0)return new Bv(null,this);if(arguments.length===1){const t=arguments[0];return new Bv(t,this)}}buildGeometry(t){let s=null,n=!1,r=!1;for(let d=t.iterator();d.hasNext();){const p=d.next(),y=p.getTypeCode();s===null&&(s=y),y!==s&&(n=!0),p instanceof $c&&(r=!0)}if(s===null)return this.createGeometryCollection();if(n||r)return this.createGeometryCollection(fa.toGeometryArray(t));const a=t.iterator().next();if(t.size()>1){if(a instanceof Lv)return this.createMultiPolygon(fa.toPolygonArray(t));if(a instanceof jp)return this.createMultiLineString(fa.toLineStringArray(t));if(a instanceof $v)return this.createMultiPoint(fa.toPointArray(t));Vp.shouldNeverReachHere("Unhandled geometry type: "+a.getGeometryType())}return a}createMultiPointFromCoords(t){return this.createMultiPoint(t!==null?this.getCoordinateSequenceFactory().create(t):null)}createPoint(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof cs){const t=arguments[0];return this.createPoint(t!==null?this.getCoordinateSequenceFactory().create([t]):null)}else if(Mr(arguments[0],vr)){const t=arguments[0];return new $v(t,this)}}}getCoordinateSequenceFactory(){return this._coordinateSequenceFactory}createPolygon(){if(arguments.length===0)return this.createPolygon(null,null);if(arguments.length===1){if(Mr(arguments[0],vr)){const t=arguments[0];return this.createPolygon(this.createLinearRing(t))}else if(arguments[0]instanceof Array){const t=arguments[0];return this.createPolygon(this.createLinearRing(t))}else if(arguments[0]instanceof xm){const t=arguments[0];return this.createPolygon(t,null)}}else if(arguments.length===2){const t=arguments[0],s=arguments[1];return new Lv(t,s,this)}}getSRID(){return this._SRID}createGeometryCollection(){if(arguments.length===0)return new $c(null,this);if(arguments.length===1){const t=arguments[0];return new $c(t,this)}}getPrecisionModel(){return this._precisionModel}createLinearRing(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){const t=arguments[0];return this.createLinearRing(t!==null?this.getCoordinateSequenceFactory().create(t):null)}else if(Mr(arguments[0],vr)){const t=arguments[0];return new xm(t,this)}}}createMultiPolygon(){if(arguments.length===0)return new Dv(null,this);if(arguments.length===1){const t=arguments[0];return new Dv(t,this)}}createMultiPoint(){if(arguments.length===0)return new Nv(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){const t=arguments[0];return new Nv(t,this)}else if(Mr(arguments[0],vr)){const t=arguments[0];if(t===null)return this.createMultiPoint(new Array(0).fill(null));const s=new Array(t.size()).fill(null);for(let n=0;n<t.size();n++){const r=this.getCoordinateSequenceFactory().create(1,t.getDimension(),t.getMeasures());Yi.copy(t,n,r,0,1),s[n]=this.createPoint(r)}return this.createMultiPoint(s)}}}get interfaces_(){return[Mh]}}const QA={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"};for(const e in QA)QA[e].toUpperCase();var Rte={value:()=>{}};function o$(){for(var e=0,t=arguments.length,s={},n;e<t;++e){if(!(n=arguments[e]+"")||n in s||/[\s.]/.test(n))throw new Error("illegal type: "+n);s[n]=[]}return new eb(s)}function eb(e){this._=e}function $te(e,t){return e.trim().split(/^|\s+/).map(function(s){var n="",r=s.indexOf(".");if(r>=0&&(n=s.slice(r+1),s=s.slice(0,r)),s&&!t.hasOwnProperty(s))throw new Error("unknown type: "+s);return{type:s,name:n}})}eb.prototype=o$.prototype={constructor:eb,on:function(e,t){var s=this._,n=$te(e+"",s),r,a=-1,o=n.length;if(arguments.length<2){for(;++a<o;)if((r=(e=n[a]).type)&&(r=Ote(s[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<o;)if(r=(e=n[a]).type)s[r]=eM(s[r],e.name,t);else if(t==null)for(r in s)s[r]=eM(s[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var s in t)e[s]=t[s].slice();return new eb(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var s=new Array(r),n=0,r,a;n<r;++n)s[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],n=0,r=a.length;n<r;++n)a[n].value.apply(t,s)},apply:function(e,t,s){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],r=0,a=n.length;r<a;++r)n[r].value.apply(t,s)}};function Ote(e,t){for(var s=0,n=e.length,r;s<n;++s)if((r=e[s]).name===t)return r.value}function eM(e,t,s){for(var n=0,r=e.length;n<r;++n)if(e[n].name===t){e[n]=Rte,e=e.slice(0,n).concat(e.slice(n+1));break}return s!=null&&e.push({name:t,value:s}),e}var y2="http://www.w3.org/1999/xhtml";const tM={svg:"http://www.w3.org/2000/svg",xhtml:y2,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function $x(e){var t=e+="",s=t.indexOf(":");return s>=0&&(t=e.slice(0,s))!=="xmlns"&&(e=e.slice(s+1)),tM.hasOwnProperty(t)?{space:tM[t],local:e}:e}function Lte(e){return function(){var t=this.ownerDocument,s=this.namespaceURI;return s===y2&&t.documentElement.namespaceURI===y2?t.createElement(e):t.createElementNS(s,e)}}function Nte(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function a$(e){var t=$x(e);return(t.local?Nte:Lte)(t)}function Dte(){}function xI(e){return e==null?Dte:function(){return this.querySelector(e)}}function Bte(e){typeof e!="function"&&(e=xI(e));for(var t=this._groups,s=t.length,n=new Array(s),r=0;r<s;++r)for(var a=t[r],o=a.length,d=n[r]=new Array(o),p,y,v=0;v<o;++v)(p=a[v])&&(y=e.call(p,p.__data__,v,a))&&("__data__"in p&&(y.__data__=p.__data__),d[v]=y);return new Ul(n,this._parents)}function Fte(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function zte(){return[]}function l$(e){return e==null?zte:function(){return this.querySelectorAll(e)}}function Ute(e){return function(){return Fte(e.apply(this,arguments))}}function Vte(e){typeof e=="function"?e=Ute(e):e=l$(e);for(var t=this._groups,s=t.length,n=[],r=[],a=0;a<s;++a)for(var o=t[a],d=o.length,p,y=0;y<d;++y)(p=o[y])&&(n.push(e.call(p,p.__data__,y,o)),r.push(p));return new Ul(n,r)}function c$(e){return function(){return this.matches(e)}}function u$(e){return function(t){return t.matches(e)}}var jte=Array.prototype.find;function qte(e){return function(){return jte.call(this.children,e)}}function Hte(){return this.firstElementChild}function Gte(e){return this.select(e==null?Hte:qte(typeof e=="function"?e:u$(e)))}var Wte=Array.prototype.filter;function Yte(){return Array.from(this.children)}function Zte(e){return function(){return Wte.call(this.children,e)}}function Xte(e){return this.selectAll(e==null?Yte:Zte(typeof e=="function"?e:u$(e)))}function Kte(e){typeof e!="function"&&(e=c$(e));for(var t=this._groups,s=t.length,n=new Array(s),r=0;r<s;++r)for(var a=t[r],o=a.length,d=n[r]=[],p,y=0;y<o;++y)(p=a[y])&&e.call(p,p.__data__,y,a)&&d.push(p);return new Ul(n,this._parents)}function d$(e){return new Array(e.length)}function Jte(){return new Ul(this._enter||this._groups.map(d$),this._parents)}function Ob(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Ob.prototype={constructor:Ob,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Qte(e){return function(){return e}}function ese(e,t,s,n,r,a){for(var o=0,d,p=t.length,y=a.length;o<y;++o)(d=t[o])?(d.__data__=a[o],n[o]=d):s[o]=new Ob(e,a[o]);for(;o<p;++o)(d=t[o])&&(r[o]=d)}function tse(e,t,s,n,r,a,o){var d,p,y=new Map,v=t.length,C=a.length,I=new Array(v),O;for(d=0;d<v;++d)(p=t[d])&&(I[d]=O=o.call(p,p.__data__,d,t)+"",y.has(O)?r[d]=p:y.set(O,p));for(d=0;d<C;++d)O=o.call(e,a[d],d,a)+"",(p=y.get(O))?(n[d]=p,p.__data__=a[d],y.delete(O)):s[d]=new Ob(e,a[d]);for(d=0;d<v;++d)(p=t[d])&&y.get(I[d])===p&&(r[d]=p)}function sse(e){return e.__data__}function nse(e,t){if(!arguments.length)return Array.from(this,sse);var s=t?tse:ese,n=this._parents,r=this._groups;typeof e!="function"&&(e=Qte(e));for(var a=r.length,o=new Array(a),d=new Array(a),p=new Array(a),y=0;y<a;++y){var v=n[y],C=r[y],I=C.length,O=rse(e.call(v,v&&v.__data__,y,n)),A=O.length,P=d[y]=new Array(A),q=o[y]=new Array(A),ce=p[y]=new Array(I);s(v,C,P,q,ce,O,t);for(var re=0,W=0,Ce,te;re<A;++re)if(Ce=P[re]){for(re>=W&&(W=re+1);!(te=q[W])&&++W<A;);Ce._next=te||null}}return o=new Ul(o,n),o._enter=d,o._exit=p,o}function rse(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ise(){return new Ul(this._exit||this._groups.map(d$),this._parents)}function ose(e,t,s){var n=this.enter(),r=this,a=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),t!=null&&(r=t(r),r&&(r=r.selection())),s==null?a.remove():s(a),n&&r?n.merge(r).order():r}function ase(e){for(var t=e.selection?e.selection():e,s=this._groups,n=t._groups,r=s.length,a=n.length,o=Math.min(r,a),d=new Array(r),p=0;p<o;++p)for(var y=s[p],v=n[p],C=y.length,I=d[p]=new Array(C),O,A=0;A<C;++A)(O=y[A]||v[A])&&(I[A]=O);for(;p<r;++p)d[p]=s[p];return new Ul(d,this._parents)}function lse(){for(var e=this._groups,t=-1,s=e.length;++t<s;)for(var n=e[t],r=n.length-1,a=n[r],o;--r>=0;)(o=n[r])&&(a&&o.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(o,a),a=o);return this}function cse(e){e||(e=use);function t(C,I){return C&&I?e(C.__data__,I.__data__):!C-!I}for(var s=this._groups,n=s.length,r=new Array(n),a=0;a<n;++a){for(var o=s[a],d=o.length,p=r[a]=new Array(d),y,v=0;v<d;++v)(y=o[v])&&(p[v]=y);p.sort(t)}return new Ul(r,this._parents).order()}function use(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function dse(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function hse(){return Array.from(this)}function pse(){for(var e=this._groups,t=0,s=e.length;t<s;++t)for(var n=e[t],r=0,a=n.length;r<a;++r){var o=n[r];if(o)return o}return null}function fse(){let e=0;for(const t of this)++e;return e}function mse(){return!this.node()}function _se(e){for(var t=this._groups,s=0,n=t.length;s<n;++s)for(var r=t[s],a=0,o=r.length,d;a<o;++a)(d=r[a])&&e.call(d,d.__data__,a,r);return this}function gse(e){return function(){this.removeAttribute(e)}}function yse(e){return function(){this.removeAttributeNS(e.space,e.local)}}function vse(e,t){return function(){this.setAttribute(e,t)}}function bse(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function xse(e,t){return function(){var s=t.apply(this,arguments);s==null?this.removeAttribute(e):this.setAttribute(e,s)}}function wse(e,t){return function(){var s=t.apply(this,arguments);s==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,s)}}function Sse(e,t){var s=$x(e);if(arguments.length<2){var n=this.node();return s.local?n.getAttributeNS(s.space,s.local):n.getAttribute(s)}return this.each((t==null?s.local?yse:gse:typeof t=="function"?s.local?wse:xse:s.local?bse:vse)(s,t))}function h$(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Cse(e){return function(){this.style.removeProperty(e)}}function Ise(e,t,s){return function(){this.style.setProperty(e,t,s)}}function Tse(e,t,s){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,s)}}function Ase(e,t,s){return arguments.length>1?this.each((t==null?Cse:typeof t=="function"?Tse:Ise)(e,t,s==null?"":s)):Rg(this.node(),e)}function Rg(e,t){return e.style.getPropertyValue(t)||h$(e).getComputedStyle(e,null).getPropertyValue(t)}function Mse(e){return function(){delete this[e]}}function Ese(e,t){return function(){this[e]=t}}function kse(e,t){return function(){var s=t.apply(this,arguments);s==null?delete this[e]:this[e]=s}}function Pse(e,t){return arguments.length>1?this.each((t==null?Mse:typeof t=="function"?kse:Ese)(e,t)):this.node()[e]}function p$(e){return e.trim().split(/^|\s+/)}function wI(e){return e.classList||new f$(e)}function f$(e){this._node=e,this._names=p$(e.getAttribute("class")||"")}f$.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function m$(e,t){for(var s=wI(e),n=-1,r=t.length;++n<r;)s.add(t[n])}function _$(e,t){for(var s=wI(e),n=-1,r=t.length;++n<r;)s.remove(t[n])}function Rse(e){return function(){m$(this,e)}}function $se(e){return function(){_$(this,e)}}function Ose(e,t){return function(){(t.apply(this,arguments)?m$:_$)(this,e)}}function Lse(e,t){var s=p$(e+"");if(arguments.length<2){for(var n=wI(this.node()),r=-1,a=s.length;++r<a;)if(!n.contains(s[r]))return!1;return!0}return this.each((typeof t=="function"?Ose:t?Rse:$se)(s,t))}function Nse(){this.textContent=""}function Dse(e){return function(){this.textContent=e}}function Bse(e){return function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}}function Fse(e){return arguments.length?this.each(e==null?Nse:(typeof e=="function"?Bse:Dse)(e)):this.node().textContent}function zse(){this.innerHTML=""}function Use(e){return function(){this.innerHTML=e}}function Vse(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}}function jse(e){return arguments.length?this.each(e==null?zse:(typeof e=="function"?Vse:Use)(e)):this.node().innerHTML}function qse(){this.nextSibling&&this.parentNode.appendChild(this)}function Hse(){return this.each(qse)}function Gse(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Wse(){return this.each(Gse)}function Yse(e){var t=typeof e=="function"?e:a$(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Zse(){return null}function Xse(e,t){var s=typeof e=="function"?e:a$(e),n=t==null?Zse:typeof t=="function"?t:xI(t);return this.select(function(){return this.insertBefore(s.apply(this,arguments),n.apply(this,arguments)||null)})}function Kse(){var e=this.parentNode;e&&e.removeChild(this)}function Jse(){return this.each(Kse)}function Qse(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function ene(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function tne(e){return this.select(e?ene:Qse)}function sne(e){return arguments.length?this.property("__data__",e):this.node().__data__}function nne(e){return function(t){e.call(this,t,this.__data__)}}function rne(e){return e.trim().split(/^|\s+/).map(function(t){var s="",n=t.indexOf(".");return n>=0&&(s=t.slice(n+1),t=t.slice(0,n)),{type:t,name:s}})}function ine(e){return function(){var t=this.__on;if(!!t){for(var s=0,n=-1,r=t.length,a;s<r;++s)a=t[s],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):t[++n]=a;++n?t.length=n:delete this.__on}}}function one(e,t,s){return function(){var n=this.__on,r,a=nne(t);if(n){for(var o=0,d=n.length;o<d;++o)if((r=n[o]).type===e.type&&r.name===e.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=a,r.options=s),r.value=t;return}}this.addEventListener(e.type,a,s),r={type:e.type,name:e.name,value:t,listener:a,options:s},n?n.push(r):this.__on=[r]}}function ane(e,t,s){var n=rne(e+""),r,a=n.length,o;if(arguments.length<2){var d=this.node().__on;if(d){for(var p=0,y=d.length,v;p<y;++p)for(r=0,v=d[p];r<a;++r)if((o=n[r]).type===v.type&&o.name===v.name)return v.value}return}for(d=t?one:ine,r=0;r<a;++r)this.each(d(n[r],t,s));return this}function g$(e,t,s){var n=h$(e),r=n.CustomEvent;typeof r=="function"?r=new r(t,s):(r=n.document.createEvent("Event"),s?(r.initEvent(t,s.bubbles,s.cancelable),r.detail=s.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function lne(e,t){return function(){return g$(this,e,t)}}function cne(e,t){return function(){return g$(this,e,t.apply(this,arguments))}}function une(e,t){return this.each((typeof t=="function"?cne:lne)(e,t))}function*dne(){for(var e=this._groups,t=0,s=e.length;t<s;++t)for(var n=e[t],r=0,a=n.length,o;r<a;++r)(o=n[r])&&(yield o)}var y$=[null];function Ul(e,t){this._groups=e,this._parents=t}function o0(){return new Ul([[document.documentElement]],y$)}function hne(){return this}Ul.prototype=o0.prototype={constructor:Ul,select:Bte,selectAll:Vte,selectChild:Gte,selectChildren:Xte,filter:Kte,data:nse,enter:Jte,exit:ise,join:ose,merge:ase,selection:hne,order:lse,sort:cse,call:dse,nodes:hse,node:pse,size:fse,empty:mse,each:_se,attr:Sse,style:Ase,property:Pse,classed:Lse,text:Fse,html:jse,raise:Hse,lower:Wse,append:Yse,insert:Xse,remove:Jse,clone:tne,datum:sne,on:ane,dispatch:une,[Symbol.iterator]:dne};function a0(e){return typeof e=="string"?new Ul([[document.querySelector(e)]],[document.documentElement]):new Ul([[e]],y$)}function pne(e){let t;for(;t=e.sourceEvent;)e=t;return e}function xu(e,t){if(e=pne(e),t===void 0&&(t=e.currentTarget),t){var s=t.ownerSVGElement||t;if(s.createSVGPoint){var n=s.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}function SI(e,t,s){e.prototype=t.prototype=s,s.constructor=e}function v$(e,t){var s=Object.create(e.prototype);for(var n in t)s[n]=t[n];return s}function l0(){}var Fv=.7,Lb=1/Fv,pg="\\s*([+-]?\\d+)\\s*",zv="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",cd="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",fne=/^#([0-9a-f]{3,8})$/,mne=new RegExp(`^rgb\\(${pg},${pg},${pg}\\)$`),_ne=new RegExp(`^rgb\\(${cd},${cd},${cd}\\)$`),gne=new RegExp(`^rgba\\(${pg},${pg},${pg},${zv}\\)$`),yne=new RegExp(`^rgba\\(${cd},${cd},${cd},${zv}\\)$`),vne=new RegExp(`^hsl\\(${zv},${cd},${cd}\\)$`),bne=new RegExp(`^hsla\\(${zv},${cd},${cd},${zv}\\)$`),sM={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};SI(l0,Uv,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:nM,formatHex:nM,formatHex8:xne,formatHsl:wne,formatRgb:rM,toString:rM});function nM(){return this.rgb().formatHex()}function xne(){return this.rgb().formatHex8()}function wne(){return b$(this).formatHsl()}function rM(){return this.rgb().formatRgb()}function Uv(e){var t,s;return e=(e+"").trim().toLowerCase(),(t=fne.exec(e))?(s=t[1].length,t=parseInt(t[1],16),s===6?iM(t):s===3?new rl(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):s===8?P1(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):s===4?P1(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=mne.exec(e))?new rl(t[1],t[2],t[3],1):(t=_ne.exec(e))?new rl(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=gne.exec(e))?P1(t[1],t[2],t[3],t[4]):(t=yne.exec(e))?P1(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=vne.exec(e))?lM(t[1],t[2]/100,t[3]/100,1):(t=bne.exec(e))?lM(t[1],t[2]/100,t[3]/100,t[4]):sM.hasOwnProperty(e)?iM(sM[e]):e==="transparent"?new rl(NaN,NaN,NaN,0):null}function iM(e){return new rl(e>>16&255,e>>8&255,e&255,1)}function P1(e,t,s,n){return n<=0&&(e=t=s=NaN),new rl(e,t,s,n)}function Sne(e){return e instanceof l0||(e=Uv(e)),e?(e=e.rgb(),new rl(e.r,e.g,e.b,e.opacity)):new rl}function v2(e,t,s,n){return arguments.length===1?Sne(e):new rl(e,t,s,n==null?1:n)}function rl(e,t,s,n){this.r=+e,this.g=+t,this.b=+s,this.opacity=+n}SI(rl,v2,v$(l0,{brighter(e){return e=e==null?Lb:Math.pow(Lb,e),new rl(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Fv:Math.pow(Fv,e),new rl(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new rl(wm(this.r),wm(this.g),wm(this.b),Nb(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:oM,formatHex:oM,formatHex8:Cne,formatRgb:aM,toString:aM}));function oM(){return`#${cm(this.r)}${cm(this.g)}${cm(this.b)}`}function Cne(){return`#${cm(this.r)}${cm(this.g)}${cm(this.b)}${cm((isNaN(this.opacity)?1:this.opacity)*255)}`}function aM(){const e=Nb(this.opacity);return`${e===1?"rgb(":"rgba("}${wm(this.r)}, ${wm(this.g)}, ${wm(this.b)}${e===1?")":`, ${e})`}`}function Nb(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function wm(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function cm(e){return e=wm(e),(e<16?"0":"")+e.toString(16)}function lM(e,t,s,n){return n<=0?e=t=s=NaN:s<=0||s>=1?e=t=NaN:t<=0&&(e=NaN),new mu(e,t,s,n)}function b$(e){if(e instanceof mu)return new mu(e.h,e.s,e.l,e.opacity);if(e instanceof l0||(e=Uv(e)),!e)return new mu;if(e instanceof mu)return e;e=e.rgb();var t=e.r/255,s=e.g/255,n=e.b/255,r=Math.min(t,s,n),a=Math.max(t,s,n),o=NaN,d=a-r,p=(a+r)/2;return d?(t===a?o=(s-n)/d+(s<n)*6:s===a?o=(n-t)/d+2:o=(t-s)/d+4,d/=p<.5?a+r:2-a-r,o*=60):d=p>0&&p<1?0:o,new mu(o,d,p,e.opacity)}function Ine(e,t,s,n){return arguments.length===1?b$(e):new mu(e,t,s,n==null?1:n)}function mu(e,t,s,n){this.h=+e,this.s=+t,this.l=+s,this.opacity=+n}SI(mu,Ine,v$(l0,{brighter(e){return e=e==null?Lb:Math.pow(Lb,e),new mu(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Fv:Math.pow(Fv,e),new mu(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,s=this.l,n=s+(s<.5?s:1-s)*t,r=2*s-n;return new rl(hS(e>=240?e-240:e+120,r,n),hS(e,r,n),hS(e<120?e+240:e-120,r,n),this.opacity)},clamp(){return new mu(cM(this.h),R1(this.s),R1(this.l),Nb(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Nb(this.opacity);return`${e===1?"hsl(":"hsla("}${cM(this.h)}, ${R1(this.s)*100}%, ${R1(this.l)*100}%${e===1?")":`, ${e})`}`}}));function cM(e){return e=(e||0)%360,e<0?e+360:e}function R1(e){return Math.max(0,Math.min(1,e||0))}function hS(e,t,s){return(e<60?t+(s-t)*e/60:e<180?s:e<240?t+(s-t)*(240-e)/60:t)*255}const x$=e=>()=>e;function Tne(e,t){return function(s){return e+s*t}}function Ane(e,t,s){return e=Math.pow(e,s),t=Math.pow(t,s)-e,s=1/s,function(n){return Math.pow(e+n*t,s)}}function Mne(e){return(e=+e)==1?w$:function(t,s){return s-t?Ane(t,s,e):x$(isNaN(t)?s:t)}}function w$(e,t){var s=t-e;return s?Tne(e,s):x$(isNaN(e)?t:e)}const uM=function e(t){var s=Mne(t);function n(r,a){var o=s((r=v2(r)).r,(a=v2(a)).r),d=s(r.g,a.g),p=s(r.b,a.b),y=w$(r.opacity,a.opacity);return function(v){return r.r=o(v),r.g=d(v),r.b=p(v),r.opacity=y(v),r+""}}return n.gamma=e,n}(1);function Mp(e,t){return e=+e,t=+t,function(s){return e*(1-s)+t*s}}var b2=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,pS=new RegExp(b2.source,"g");function Ene(e){return function(){return e}}function kne(e){return function(t){return e(t)+""}}function Pne(e,t){var s=b2.lastIndex=pS.lastIndex=0,n,r,a,o=-1,d=[],p=[];for(e=e+"",t=t+"";(n=b2.exec(e))&&(r=pS.exec(t));)(a=r.index)>s&&(a=t.slice(s,a),d[o]?d[o]+=a:d[++o]=a),(n=n[0])===(r=r[0])?d[o]?d[o]+=r:d[++o]=r:(d[++o]=null,p.push({i:o,x:Mp(n,r)})),s=pS.lastIndex;return s<t.length&&(a=t.slice(s),d[o]?d[o]+=a:d[++o]=a),d.length<2?p[0]?kne(p[0].x):Ene(t):(t=p.length,function(y){for(var v=0,C;v<t;++v)d[(C=p[v]).i]=C.x(y);return d.join("")})}var dM=180/Math.PI,x2={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function S$(e,t,s,n,r,a){var o,d,p;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(p=e*s+t*n)&&(s-=e*p,n-=t*p),(d=Math.sqrt(s*s+n*n))&&(s/=d,n/=d,p/=d),e*n<t*s&&(e=-e,t=-t,p=-p,o=-o),{translateX:r,translateY:a,rotate:Math.atan2(t,e)*dM,skewX:Math.atan(p)*dM,scaleX:o,scaleY:d}}var $1;function Rne(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?x2:S$(t.a,t.b,t.c,t.d,t.e,t.f)}function $ne(e){return e==null||($1||($1=document.createElementNS("http://www.w3.org/2000/svg","g")),$1.setAttribute("transform",e),!(e=$1.transform.baseVal.consolidate()))?x2:(e=e.matrix,S$(e.a,e.b,e.c,e.d,e.e,e.f))}function C$(e,t,s,n){function r(y){return y.length?y.pop()+" ":""}function a(y,v,C,I,O,A){if(y!==C||v!==I){var P=O.push("translate(",null,t,null,s);A.push({i:P-4,x:Mp(y,C)},{i:P-2,x:Mp(v,I)})}else(C||I)&&O.push("translate("+C+t+I+s)}function o(y,v,C,I){y!==v?(y-v>180?v+=360:v-y>180&&(y+=360),I.push({i:C.push(r(C)+"rotate(",null,n)-2,x:Mp(y,v)})):v&&C.push(r(C)+"rotate("+v+n)}function d(y,v,C,I){y!==v?I.push({i:C.push(r(C)+"skewX(",null,n)-2,x:Mp(y,v)}):v&&C.push(r(C)+"skewX("+v+n)}function p(y,v,C,I,O,A){if(y!==C||v!==I){var P=O.push(r(O)+"scale(",null,",",null,")");A.push({i:P-4,x:Mp(y,C)},{i:P-2,x:Mp(v,I)})}else(C!==1||I!==1)&&O.push(r(O)+"scale("+C+","+I+")")}return function(y,v){var C=[],I=[];return y=e(y),v=e(v),a(y.translateX,y.translateY,v.translateX,v.translateY,C,I),o(y.rotate,v.rotate,C,I),d(y.skewX,v.skewX,C,I),p(y.scaleX,y.scaleY,v.scaleX,v.scaleY,C,I),y=v=null,function(O){for(var A=-1,P=I.length,q;++A<P;)C[(q=I[A]).i]=q.x(O);return C.join("")}}}var One=C$(Rne,"px, ","px)","deg)"),Lne=C$($ne,", ",")",")"),$g=0,Hy=0,Uy=0,I$=1e3,Db,Gy,Bb=0,Am=0,Ox=0,Vv=typeof performance=="object"&&performance.now?performance:Date,T$=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function CI(){return Am||(T$(Nne),Am=Vv.now()+Ox)}function Nne(){Am=0}function Fb(){this._call=this._time=this._next=null}Fb.prototype=A$.prototype={constructor:Fb,restart:function(e,t,s){if(typeof e!="function")throw new TypeError("callback is not a function");s=(s==null?CI():+s)+(t==null?0:+t),!this._next&&Gy!==this&&(Gy?Gy._next=this:Db=this,Gy=this),this._call=e,this._time=s,w2()},stop:function(){this._call&&(this._call=null,this._time=1/0,w2())}};function A$(e,t,s){var n=new Fb;return n.restart(e,t,s),n}function Dne(){CI(),++$g;for(var e=Db,t;e;)(t=Am-e._time)>=0&&e._call.call(void 0,t),e=e._next;--$g}function hM(){Am=(Bb=Vv.now())+Ox,$g=Hy=0;try{Dne()}finally{$g=0,Fne(),Am=0}}function Bne(){var e=Vv.now(),t=e-Bb;t>I$&&(Ox-=t,Bb=e)}function Fne(){for(var e,t=Db,s,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(s=t._next,t._next=null,t=e?e._next=s:Db=s);Gy=e,w2(n)}function w2(e){if(!$g){Hy&&(Hy=clearTimeout(Hy));var t=e-Am;t>24?(e<1/0&&(Hy=setTimeout(hM,e-Vv.now()-Ox)),Uy&&(Uy=clearInterval(Uy))):(Uy||(Bb=Vv.now(),Uy=setInterval(Bne,I$)),$g=1,T$(hM))}}function pM(e,t,s){var n=new Fb;return t=t==null?0:+t,n.restart(r=>{n.stop(),e(r+t)},t,s),n}var zne=o$("start","end","cancel","interrupt"),Une=[],M$=0,fM=1,S2=2,tb=3,mM=4,C2=5,sb=6;function Lx(e,t,s,n,r,a){var o=e.__transition;if(!o)e.__transition={};else if(s in o)return;Vne(e,s,{name:t,index:n,group:r,on:zne,tween:Une,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:M$})}function II(e,t){var s=Iu(e,t);if(s.state>M$)throw new Error("too late; already scheduled");return s}function gd(e,t){var s=Iu(e,t);if(s.state>tb)throw new Error("too late; already running");return s}function Iu(e,t){var s=e.__transition;if(!s||!(s=s[t]))throw new Error("transition not found");return s}function Vne(e,t,s){var n=e.__transition,r;n[t]=s,s.timer=A$(a,0,s.time);function a(y){s.state=fM,s.timer.restart(o,s.delay,s.time),s.delay<=y&&o(y-s.delay)}function o(y){var v,C,I,O;if(s.state!==fM)return p();for(v in n)if(O=n[v],O.name===s.name){if(O.state===tb)return pM(o);O.state===mM?(O.state=sb,O.timer.stop(),O.on.call("interrupt",e,e.__data__,O.index,O.group),delete n[v]):+v<t&&(O.state=sb,O.timer.stop(),O.on.call("cancel",e,e.__data__,O.index,O.group),delete n[v])}if(pM(function(){s.state===tb&&(s.state=mM,s.timer.restart(d,s.delay,s.time),d(y))}),s.state=S2,s.on.call("start",e,e.__data__,s.index,s.group),s.state===S2){for(s.state=tb,r=new Array(I=s.tween.length),v=0,C=-1;v<I;++v)(O=s.tween[v].value.call(e,e.__data__,s.index,s.group))&&(r[++C]=O);r.length=C+1}}function d(y){for(var v=y<s.duration?s.ease.call(null,y/s.duration):(s.timer.restart(p),s.state=C2,1),C=-1,I=r.length;++C<I;)r[C].call(e,v);s.state===C2&&(s.on.call("end",e,e.__data__,s.index,s.group),p())}function p(){s.state=sb,s.timer.stop(),delete n[t];for(var y in n)return;delete e.__transition}}function jne(e,t){var s=e.__transition,n,r,a=!0,o;if(!!s){t=t==null?null:t+"";for(o in s){if((n=s[o]).name!==t){a=!1;continue}r=n.state>S2&&n.state<C2,n.state=sb,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete s[o]}a&&delete e.__transition}}function qne(e){return this.each(function(){jne(this,e)})}function Hne(e,t){var s,n;return function(){var r=gd(this,e),a=r.tween;if(a!==s){n=s=a;for(var o=0,d=n.length;o<d;++o)if(n[o].name===t){n=n.slice(),n.splice(o,1);break}}r.tween=n}}function Gne(e,t,s){var n,r;if(typeof s!="function")throw new Error;return function(){var a=gd(this,e),o=a.tween;if(o!==n){r=(n=o).slice();for(var d={name:t,value:s},p=0,y=r.length;p<y;++p)if(r[p].name===t){r[p]=d;break}p===y&&r.push(d)}a.tween=r}}function Wne(e,t){var s=this._id;if(e+="",arguments.length<2){for(var n=Iu(this.node(),s).tween,r=0,a=n.length,o;r<a;++r)if((o=n[r]).name===e)return o.value;return null}return this.each((t==null?Hne:Gne)(s,e,t))}function TI(e,t,s){var n=e._id;return e.each(function(){var r=gd(this,n);(r.value||(r.value={}))[t]=s.apply(this,arguments)}),function(r){return Iu(r,n).value[t]}}function E$(e,t){var s;return(typeof t=="number"?Mp:t instanceof Uv?uM:(s=Uv(t))?(t=s,uM):Pne)(e,t)}function Yne(e){return function(){this.removeAttribute(e)}}function Zne(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Xne(e,t,s){var n,r=s+"",a;return function(){var o=this.getAttribute(e);return o===r?null:o===n?a:a=t(n=o,s)}}function Kne(e,t,s){var n,r=s+"",a;return function(){var o=this.getAttributeNS(e.space,e.local);return o===r?null:o===n?a:a=t(n=o,s)}}function Jne(e,t,s){var n,r,a;return function(){var o,d=s(this),p;return d==null?void this.removeAttribute(e):(o=this.getAttribute(e),p=d+"",o===p?null:o===n&&p===r?a:(r=p,a=t(n=o,d)))}}function Qne(e,t,s){var n,r,a;return function(){var o,d=s(this),p;return d==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),p=d+"",o===p?null:o===n&&p===r?a:(r=p,a=t(n=o,d)))}}function ere(e,t){var s=$x(e),n=s==="transform"?Lne:E$;return this.attrTween(e,typeof t=="function"?(s.local?Qne:Jne)(s,n,TI(this,"attr."+e,t)):t==null?(s.local?Zne:Yne)(s):(s.local?Kne:Xne)(s,n,t))}function tre(e,t){return function(s){this.setAttribute(e,t.call(this,s))}}function sre(e,t){return function(s){this.setAttributeNS(e.space,e.local,t.call(this,s))}}function nre(e,t){var s,n;function r(){var a=t.apply(this,arguments);return a!==n&&(s=(n=a)&&sre(e,a)),s}return r._value=t,r}function rre(e,t){var s,n;function r(){var a=t.apply(this,arguments);return a!==n&&(s=(n=a)&&tre(e,a)),s}return r._value=t,r}function ire(e,t){var s="attr."+e;if(arguments.length<2)return(s=this.tween(s))&&s._value;if(t==null)return this.tween(s,null);if(typeof t!="function")throw new Error;var n=$x(e);return this.tween(s,(n.local?nre:rre)(n,t))}function ore(e,t){return function(){II(this,e).delay=+t.apply(this,arguments)}}function are(e,t){return t=+t,function(){II(this,e).delay=t}}function lre(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?ore:are)(t,e)):Iu(this.node(),t).delay}function cre(e,t){return function(){gd(this,e).duration=+t.apply(this,arguments)}}function ure(e,t){return t=+t,function(){gd(this,e).duration=t}}function dre(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?cre:ure)(t,e)):Iu(this.node(),t).duration}function hre(e,t){if(typeof t!="function")throw new Error;return function(){gd(this,e).ease=t}}function pre(e){var t=this._id;return arguments.length?this.each(hre(t,e)):Iu(this.node(),t).ease}function fre(e,t){return function(){var s=t.apply(this,arguments);if(typeof s!="function")throw new Error;gd(this,e).ease=s}}function mre(e){if(typeof e!="function")throw new Error;return this.each(fre(this._id,e))}function _re(e){typeof e!="function"&&(e=c$(e));for(var t=this._groups,s=t.length,n=new Array(s),r=0;r<s;++r)for(var a=t[r],o=a.length,d=n[r]=[],p,y=0;y<o;++y)(p=a[y])&&e.call(p,p.__data__,y,a)&&d.push(p);return new Sh(n,this._parents,this._name,this._id)}function gre(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,s=e._groups,n=t.length,r=s.length,a=Math.min(n,r),o=new Array(n),d=0;d<a;++d)for(var p=t[d],y=s[d],v=p.length,C=o[d]=new Array(v),I,O=0;O<v;++O)(I=p[O]||y[O])&&(C[O]=I);for(;d<n;++d)o[d]=t[d];return new Sh(o,this._parents,this._name,this._id)}function yre(e){return(e+"").trim().split(/^|\s+/).every(function(t){var s=t.indexOf(".");return s>=0&&(t=t.slice(0,s)),!t||t==="start"})}function vre(e,t,s){var n,r,a=yre(t)?II:gd;return function(){var o=a(this,e),d=o.on;d!==n&&(r=(n=d).copy()).on(t,s),o.on=r}}function bre(e,t){var s=this._id;return arguments.length<2?Iu(this.node(),s).on.on(e):this.each(vre(s,e,t))}function xre(e){return function(){var t=this.parentNode;for(var s in this.__transition)if(+s!==e)return;t&&t.removeChild(this)}}function wre(){return this.on("end.remove",xre(this._id))}function Sre(e){var t=this._name,s=this._id;typeof e!="function"&&(e=xI(e));for(var n=this._groups,r=n.length,a=new Array(r),o=0;o<r;++o)for(var d=n[o],p=d.length,y=a[o]=new Array(p),v,C,I=0;I<p;++I)(v=d[I])&&(C=e.call(v,v.__data__,I,d))&&("__data__"in v&&(C.__data__=v.__data__),y[I]=C,Lx(y[I],t,s,I,y,Iu(v,s)));return new Sh(a,this._parents,t,s)}function Cre(e){var t=this._name,s=this._id;typeof e!="function"&&(e=l$(e));for(var n=this._groups,r=n.length,a=[],o=[],d=0;d<r;++d)for(var p=n[d],y=p.length,v,C=0;C<y;++C)if(v=p[C]){for(var I=e.call(v,v.__data__,C,p),O,A=Iu(v,s),P=0,q=I.length;P<q;++P)(O=I[P])&&Lx(O,t,s,P,I,A);a.push(I),o.push(v)}return new Sh(a,o,t,s)}var Ire=o0.prototype.constructor;function Tre(){return new Ire(this._groups,this._parents)}function Are(e,t){var s,n,r;return function(){var a=Rg(this,e),o=(this.style.removeProperty(e),Rg(this,e));return a===o?null:a===s&&o===n?r:r=t(s=a,n=o)}}function k$(e){return function(){this.style.removeProperty(e)}}function Mre(e,t,s){var n,r=s+"",a;return function(){var o=Rg(this,e);return o===r?null:o===n?a:a=t(n=o,s)}}function Ere(e,t,s){var n,r,a;return function(){var o=Rg(this,e),d=s(this),p=d+"";return d==null&&(p=d=(this.style.removeProperty(e),Rg(this,e))),o===p?null:o===n&&p===r?a:(r=p,a=t(n=o,d))}}function kre(e,t){var s,n,r,a="style."+t,o="end."+a,d;return function(){var p=gd(this,e),y=p.on,v=p.value[a]==null?d||(d=k$(t)):void 0;(y!==s||r!==v)&&(n=(s=y).copy()).on(o,r=v),p.on=n}}function Pre(e,t,s){var n=(e+="")=="transform"?One:E$;return t==null?this.styleTween(e,Are(e,n)).on("end.style."+e,k$(e)):typeof t=="function"?this.styleTween(e,Ere(e,n,TI(this,"style."+e,t))).each(kre(this._id,e)):this.styleTween(e,Mre(e,n,t),s).on("end.style."+e,null)}function Rre(e,t,s){return function(n){this.style.setProperty(e,t.call(this,n),s)}}function $re(e,t,s){var n,r;function a(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&Rre(e,o,s)),n}return a._value=t,a}function Ore(e,t,s){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,$re(e,t,s==null?"":s))}function Lre(e){return function(){this.textContent=e}}function Nre(e){return function(){var t=e(this);this.textContent=t==null?"":t}}function Dre(e){return this.tween("text",typeof e=="function"?Nre(TI(this,"text",e)):Lre(e==null?"":e+""))}function Bre(e){return function(t){this.textContent=e.call(this,t)}}function Fre(e){var t,s;function n(){var r=e.apply(this,arguments);return r!==s&&(t=(s=r)&&Bre(r)),t}return n._value=e,n}function zre(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Fre(e))}function Ure(){for(var e=this._name,t=this._id,s=P$(),n=this._groups,r=n.length,a=0;a<r;++a)for(var o=n[a],d=o.length,p,y=0;y<d;++y)if(p=o[y]){var v=Iu(p,t);Lx(p,e,s,y,o,{time:v.time+v.delay+v.duration,delay:0,duration:v.duration,ease:v.ease})}return new Sh(n,this._parents,e,s)}function Vre(){var e,t,s=this,n=s._id,r=s.size();return new Promise(function(a,o){var d={value:o},p={value:function(){--r===0&&a()}};s.each(function(){var y=gd(this,n),v=y.on;v!==e&&(t=(e=v).copy(),t._.cancel.push(d),t._.interrupt.push(d),t._.end.push(p)),y.on=t}),r===0&&a()})}var jre=0;function Sh(e,t,s,n){this._groups=e,this._parents=t,this._name=s,this._id=n}function P$(){return++jre}var th=o0.prototype;Sh.prototype={constructor:Sh,select:Sre,selectAll:Cre,selectChild:th.selectChild,selectChildren:th.selectChildren,filter:_re,merge:gre,selection:Tre,transition:Ure,call:th.call,nodes:th.nodes,node:th.node,size:th.size,empty:th.empty,each:th.each,on:bre,attr:ere,attrTween:ire,style:Pre,styleTween:Ore,text:Dre,textTween:zre,remove:wre,tween:Wne,delay:lre,duration:dre,ease:pre,easeVarying:mre,end:Vre,[Symbol.iterator]:th[Symbol.iterator]};function qre(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Hre={time:null,delay:0,duration:250,ease:qre};function Gre(e,t){for(var s;!(s=e.__transition)||!(s=s[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return s}function Wre(e){var t,s;e instanceof Sh?(t=e._id,e=e._name):(t=P$(),(s=Hre).time=CI(),e=e==null?null:e+"");for(var n=this._groups,r=n.length,a=0;a<r;++a)for(var o=n[a],d=o.length,p,y=0;y<d;++y)(p=o[y])&&Lx(p,e,t,y,o,s||Gre(p,t));return new Sh(n,this._parents,e,t)}o0.prototype.interrupt=qne;o0.prototype.transition=Wre;const I2=Math.PI,T2=2*I2,Jf=1e-6,Yre=T2-Jf;function R$(e){this._+=e[0];for(let t=1,s=e.length;t<s;++t)this._+=arguments[t]+e[t]}function Zre(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return R$;const s=10**t;return function(n){this._+=n[0];for(let r=1,a=n.length;r<a;++r)this._+=Math.round(arguments[r]*s)/s+n[r]}}class Xre{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?R$:Zre(t)}moveTo(t,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+s}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,s){this._append`L${this._x1=+t},${this._y1=+s}`}quadraticCurveTo(t,s,n,r){this._append`Q${+t},${+s},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(t,s,n,r,a,o){this._append`C${+t},${+s},${+n},${+r},${this._x1=+a},${this._y1=+o}`}arcTo(t,s,n,r,a){if(t=+t,s=+s,n=+n,r=+r,a=+a,a<0)throw new Error(`negative radius: ${a}`);let o=this._x1,d=this._y1,p=n-t,y=r-s,v=o-t,C=d-s,I=v*v+C*C;if(this._x1===null)this._append`M${this._x1=t},${this._y1=s}`;else if(I>Jf)if(!(Math.abs(C*p-y*v)>Jf)||!a)this._append`L${this._x1=t},${this._y1=s}`;else{let O=n-o,A=r-d,P=p*p+y*y,q=O*O+A*A,ce=Math.sqrt(P),re=Math.sqrt(I),W=a*Math.tan((I2-Math.acos((P+I-q)/(2*ce*re)))/2),Ce=W/re,te=W/ce;Math.abs(Ce-1)>Jf&&this._append`L${t+Ce*v},${s+Ce*C}`,this._append`A${a},${a},0,0,${+(C*O>v*A)},${this._x1=t+te*p},${this._y1=s+te*y}`}}arc(t,s,n,r,a,o){if(t=+t,s=+s,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let d=n*Math.cos(r),p=n*Math.sin(r),y=t+d,v=s+p,C=1^o,I=o?r-a:a-r;this._x1===null?this._append`M${y},${v}`:(Math.abs(this._x1-y)>Jf||Math.abs(this._y1-v)>Jf)&&this._append`L${y},${v}`,n&&(I<0&&(I=I%T2+T2),I>Yre?this._append`A${n},${n},0,1,${C},${t-d},${s-p}A${n},${n},0,1,${C},${this._x1=y},${this._y1=v}`:I>Jf&&this._append`A${n},${n},0,${+(I>=I2)},${C},${this._x1=t+n*Math.cos(a)},${this._y1=s+n*Math.sin(a)}`)}rect(t,s,n,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+s}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}}function Kre(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function zb(e,t){if((s=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var s,n=e.slice(0,s);return[n.length>1?n[0]+n.slice(2):n,+e.slice(s+1)]}function Jre(e){return e=zb(Math.abs(e)),e?e[1]:NaN}function Qre(e,t){return function(s,n){for(var r=s.length,a=[],o=0,d=e[0],p=0;r>0&&d>0&&(p+d+1>n&&(d=Math.max(1,n-p)),a.push(s.substring(r-=d,r+d)),!((p+=d+1)>n));)d=e[o=(o+1)%e.length];return a.reverse().join(t)}}function eie(e){return function(t){return t.replace(/[0-9]/g,function(s){return e[+s]})}}var tie=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function A2(e){if(!(t=tie.exec(e)))throw new Error("invalid format: "+e);var t;return new AI({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}A2.prototype=AI.prototype;function AI(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}AI.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function sie(e){e:for(var t=e.length,s=1,n=-1,r;s<t;++s)switch(e[s]){case".":n=r=s;break;case"0":n===0&&(n=s),r=s;break;default:if(!+e[s])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(r+1):e}var $$;function nie(e,t){var s=zb(e,t);if(!s)return e+"";var n=s[0],r=s[1],a=r-($$=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=n.length;return a===o?n:a>o?n+new Array(a-o+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+zb(e,Math.max(0,t+a-1))[0]}function _M(e,t){var s=zb(e,t);if(!s)return e+"";var n=s[0],r=s[1];return r<0?"0."+new Array(-r).join("0")+n:n.length>r+1?n.slice(0,r+1)+"."+n.slice(r+1):n+new Array(r-n.length+2).join("0")}const gM={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Kre,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>_M(e*100,t),r:_M,s:nie,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function yM(e){return e}var vM=Array.prototype.map,bM=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function rie(e){var t=e.grouping===void 0||e.thousands===void 0?yM:Qre(vM.call(e.grouping,Number),e.thousands+""),s=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",r=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?yM:eie(vM.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",d=e.minus===void 0?"\u2212":e.minus+"",p=e.nan===void 0?"NaN":e.nan+"";function y(C){C=A2(C);var I=C.fill,O=C.align,A=C.sign,P=C.symbol,q=C.zero,ce=C.width,re=C.comma,W=C.precision,Ce=C.trim,te=C.type;te==="n"?(re=!0,te="g"):gM[te]||(W===void 0&&(W=12),Ce=!0,te="g"),(q||I==="0"&&O==="=")&&(q=!0,I="0",O="=");var oe=P==="$"?s:P==="#"&&/[boxX]/.test(te)?"0"+te.toLowerCase():"",ve=P==="$"?n:/[%p]/.test(te)?o:"",ee=gM[te],ne=/[defgprs%]/.test(te);W=W===void 0?6:/[gprs]/.test(te)?Math.max(1,Math.min(21,W)):Math.max(0,Math.min(20,W));function Se(Ue){var Qe=oe,Me=ve,vt,Ut,Rt;if(te==="c")Me=ee(Ue)+Me,Ue="";else{Ue=+Ue;var _t=Ue<0||1/Ue<0;if(Ue=isNaN(Ue)?p:ee(Math.abs(Ue),W),Ce&&(Ue=sie(Ue)),_t&&+Ue==0&&A!=="+"&&(_t=!1),Qe=(_t?A==="("?A:d:A==="-"||A==="("?"":A)+Qe,Me=(te==="s"?bM[8+$$/3]:"")+Me+(_t&&A==="("?")":""),ne){for(vt=-1,Ut=Ue.length;++vt<Ut;)if(Rt=Ue.charCodeAt(vt),48>Rt||Rt>57){Me=(Rt===46?r+Ue.slice(vt+1):Ue.slice(vt))+Me,Ue=Ue.slice(0,vt);break}}}re&&!q&&(Ue=t(Ue,1/0));var F=Qe.length+Ue.length+Me.length,j=F<ce?new Array(ce-F+1).join(I):"";switch(re&&q&&(Ue=t(j+Ue,j.length?ce-Me.length:1/0),j=""),O){case"<":Ue=Qe+Ue+Me+j;break;case"=":Ue=Qe+j+Ue+Me;break;case"^":Ue=j.slice(0,F=j.length>>1)+Qe+Ue+Me+j.slice(F);break;default:Ue=j+Qe+Ue+Me;break}return a(Ue)}return Se.toString=function(){return C+""},Se}function v(C,I){var O=y((C=A2(C),C.type="f",C)),A=Math.max(-8,Math.min(8,Math.floor(Jre(I)/3)))*3,P=Math.pow(10,-A),q=bM[8+A/3];return function(ce){return O(P*ce)+q}}return{format:y,formatPrefix:v}}var O1,MI;iie({thousands:",",grouping:[3],currency:["$",""]});function iie(e){return O1=rie(e),MI=O1.format,O1.formatPrefix,O1}function W_(e){return function(){return e}}function oie(e){let t=3;return e.digits=function(s){if(!arguments.length)return t;if(s==null)t=null;else{const n=Math.floor(s);if(!(n>=0))throw new RangeError(`invalid digits: ${s}`);t=n}return e},()=>new Xre(t)}function aie(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function O$(e){this._context=e}O$.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function lie(e){return new O$(e)}function cie(e){return e[0]}function uie(e){return e[1]}function Nx(e,t){var s=W_(!0),n=null,r=lie,a=null,o=oie(d);e=typeof e=="function"?e:e===void 0?cie:W_(e),t=typeof t=="function"?t:t===void 0?uie:W_(t);function d(p){var y,v=(p=aie(p)).length,C,I=!1,O;for(n==null&&(a=r(O=o())),y=0;y<=v;++y)!(y<v&&s(C=p[y],y,p))===I&&((I=!I)?a.lineStart():a.lineEnd()),I&&a.point(+e(C,y,p),+t(C,y,p));if(O)return a=null,O+""||null}return d.x=function(p){return arguments.length?(e=typeof p=="function"?p:W_(+p),d):e},d.y=function(p){return arguments.length?(t=typeof p=="function"?p:W_(+p),d):t},d.defined=function(p){return arguments.length?(s=typeof p=="function"?p:W_(!!p),d):s},d.curve=function(p){return arguments.length?(r=p,n!=null&&(a=r(n)),d):r},d.context=function(p){return arguments.length?(p==null?n=a=null:a=r(n=p),d):n},d}function sg(e,t,s){this.k=e,this.x=t,this.y=s}sg.prototype={constructor:sg,scale:function(e){return e===1?this:new sg(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new sg(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};new sg(1,0,0);sg.prototype;class die{constructor(t){this.map=t}enableSelect(){const t=MI(".1f");this.svg=a0(this.map.getCanvasContainer()).append("svg").style("cursor","crosshair").style("position","absolute").style("width","100%").style("height","100%").style("top","0px").style("left","0px"),this.svg.on("mousedown",s=>{if(s.button===2)return;const[n,r]=xu(s,this.svg.node());if(!s.shiftKey){const a=Rc(this.map,{x:n,y:r});fd(a)&&(this.draggingSelection=!0,this.targetId=null)}this.draggingSelection||(this.center=this.edge={x:n,y:r},this.circle=this.svg.append("circle").attr("stroke","#010").attr("fill","#010").attr("fill-opacity",.1).attr("stroke-dasharray","2 2"),this.line=this.svg.append("line").attr("stroke","#111").attr("stroke-dasharray","2 2"),this.draggingCircle=!0)}),this.svg.on("mousemove",s=>{const[n,r]=xu(s,this.svg.node());if(this.draggingSelection){const a=Rc(this.map,{x:n,y:r}),o=fd(a)?null:t0(a);this.targetId!==o&&(this.targetId=o,this.targetId?(this.svg.style.cursor="pointer",SPM.Components.AssignmentMap.targetId=this.targetId):(this.svg.style.cursor="no-drop",SPM.Components.AssignmentMap.targetId=""),SPM.Components.AssignmentMap.applySelection({redraw:!0}))}else if(this.draggingCircle){this.edge={x:n,y:r},this.circle.attr("cx",this.center.x).attr("cy",this.center.y).attr("r",hie(this.center,this.edge)),this.line.attr("x1",this.center.x).attr("y1",this.center.y).attr("x2",this.edge.x).attr("y2",this.edge.y);const a=this.map.unproject([n,r]),o=this.map.unproject([this.center.x,this.center.y]),d=t(pie(o,a),1);SPM.Components.AssignmentMap.distance=`Radius: ${t(d,1)}mi (${t(d*8/5,1)}km)`}}),this.svg.on("mouseup",async s=>{if(this.draggingSelection&&this.targetId!=null)await SPM.Components.AssignmentMap.reassignSelection({targetId:this.targetId}),SPM.Components.AssignmentMap.targetId="";else if(this.draggingCircle){const n=fie(this.map,this.center,this.edge);setTimeout(async()=>{const r=Ax(this.map,n);SPM.Components.AssignmentMap.applySelection({selection:r,reset:!s.shiftKey})},150),this.circle.remove(),this.line.remove()}this.targetId=null,this.draggingSelection=!1,this.draggingCircle=!1})}disableSelect(){this.svg&&(this.svg.on("mouseup",null),this.svg.on("mousemove",null),this.svg.on("mouseout",null),this.svg.on("mousedown",null),this.svg.remove()),SPM.Components.AssignmentMap.distance=""}}function hie(e,t){const s=t.x-e.x,n=t.y-e.y;return parseInt(Math.sqrt(s**2+n**2))}function pie(e,t){const s=t.lat-e.lat,n=t.lng-e.lng,r=69.04677,a=Math.PI/180,o=Math.cos(e.lat*a);return r*Math.sqrt(s**2+(n*o)**2)}function fie(e,t,s){const n=Math.sqrt((s.x-t.x)**2+(s.y-t.y)**2),r=15,a=2*Math.PI/r,o=[];for(let y=0;y<r;y++){const v=(Math.PI-y)*a,C=[t.x+n*Math.cos(v),t.y+n*Math.sin(v)],I=e.unproject(C);o.push(new cs(I.lng,I.lat))}o.push(o[0]);const d=new fa,p=d.createLinearRing(o);return d.createPolygon(p)}class mie{constructor(t){this.map=t}enableSelect(){this.svg=a0(this.map.getCanvasContainer()).append("svg"),this.svg.style("cursor","crosshair"),this.svg.style("position","absolute"),this.svg.style("width","100%"),this.svg.style("height","100%"),this.svg.style("top","0px"),this.svg.style("left","0px"),this.svg.on("mousedown",t=>{if(t.button===2)return;const[s,n]=xu(t,this.svg.node());if(!t.shiftKey){const r=Rc(this.map,{x:s,y:n});fd(r)&&(this.draggingSelection=!0,this.targetId=null)}this.draggingSelection||(this.rectangle=this.svg.append("path").attr("fill","#010").attr("stroke","#010").attr("fill-opacity",.1).attr("stroke-dasharray","2 2"),this.startPoint={x:s,y:n},this.draggingRect=!0)}),this.svg.on("mousemove",t=>{const[s,n]=xu(t,this.svg.node());if(this.draggingSelection){const r=Rc(this.map,{x:s,y:n}),a=fd(r)?null:t0(r);this.targetId!==a&&(this.targetId=a,this.targetId?(this.svg.style.cursor="pointer",SPM.Components.AssignmentMap.targetId=this.targetId):(this.svg.style.cursor="no-drop",SPM.Components.AssignmentMap.targetId=""),SPM.Components.AssignmentMap.applySelection({redraw:!0}))}else this.draggingRect&&this.rectangle.attr("d",Nx()([[this.startPoint.x,this.startPoint.y],[this.startPoint.x,n],[s,n],[s,this.startPoint.y],[this.startPoint.x,this.startPoint.y]]))}),this.svg.on("mouseup",async t=>{if(this.draggingSelection&&this.targetId!=null)await SPM.Components.AssignmentMap.reassignSelection({targetId:this.targetId}),SPM.Components.AssignmentMap.targetId="";else if(this.draggingRect){const[s,n]=xu(t,this.svg.node()),r=[];[[this.startPoint.x,this.startPoint.y],[this.startPoint.x,n],[s,n],[s,this.startPoint.y],[this.startPoint.x,this.startPoint.y]].forEach(p=>{const y={x:p[0],y:p[1]},v=this.map.unproject(y);r.push(new cs(v.lng,v.lat))});const a=new fa,o=a.createLinearRing(r),d=a.createPolygon(o);d.normalize(),setTimeout(()=>{const p=Ax(this.map,d);SPM.Components.AssignmentMap.applySelection({selection:p,reset:!t.shiftKey})},150),this.rectangle.remove()}this.targetId=null,this.draggingSelection=!1,this.draggingRect=!1})}disableSelect(){this.svg&&(this.svg.on("mouseup",null),this.svg.on("mousemove",null),this.svg.on("mouseout",null),this.svg.on("mousedown",null),this.svg.remove())}}class _ie{constructor(t){this.map=t}enableSelect(){this.points=[],this.svg=a0(this.map.getCanvasContainer()).append("svg"),this.svg.style("cursor","crosshair"),this.svg.style("position","absolute"),this.svg.style("width","100%"),this.svg.style("height","100%"),this.svg.style("top","0px"),this.svg.style("left","0px"),this.svg.on("mousedown",s=>{if(s.button===2)return;const[n,r]=xu(s,this.svg.node());if(this.buildingPolygon){this.points.length>=3&&Math.abs(n-this.points[0][0])<20&&Math.abs(r-this.points[0][1])<20?(this.buildingPolygon=!1,this.points.push([...this.points[0]]),t(!s.shiftKey)):(this.points.push([n,r]),this.polygon.attr("d",Nx()(this.points)));return}if(!s.shiftKey){const a=Rc(this.map,{x:n,y:r});fd(a)&&(this.draggingSelection=!0,this.targetId=null)}this.draggingSelection||(this.buildingPolygon=!0,this.points=[[n,r]],this.polygon=this.svg.append("path").attr("stroke","#010").attr("fill","#010").attr("fill-opacity",.1),this.guideline=this.svg.append("line").attr("stroke","#010").attr("fill","#010").attr("fill-opacity",.1).attr("stroke-dasharray","2 2"))}),this.svg.on("mousemove",s=>{const[n,r]=xu(s,this.svg.node());if(this.draggingSelection){const a=Rc(this.map,{x:n,y:r}),o=fd(a)?null:t0(a);this.targetId!==o&&(this.targetId=o,this.targetId?(this.svg.style.cursor="pointer",SPM.Components.AssignmentMap.targetId=this.targetId):(this.svg.style.cursor="no-drop",SPM.Components.AssignmentMap.targetId=""),SPM.Components.AssignmentMap.applySelection({redraw:!0}))}else this.buildingPolygon&&this.guideline.attr("x1",this.points.at(-1)[0]).attr("y1",this.points.at(-1)[1]).attr("x2",n).attr("y2",r)}),this.svg.on("mouseup",async()=>{this.draggingSelection&&this.targetId!=null&&(await SPM.Components.AssignmentMap.reassignSelection({targetId:this.targetId}),SPM.Components.AssignmentMap.targetId=""),this.targetId=null,this.draggingSelection=!1}),this.svg.on("dblclick",()=>{this.points.length>=3&&(this.buildingPolygon=!1,this.points.push([...this.points[0]]),t(!event.shiftKey))});const t=s=>{const n=[];this.points.forEach(d=>{const p={x:d[0],y:d[1]},y=this.map.unproject(p);n.push(new cs(y.lng,y.lat))});const r=new fa,a=r.createLinearRing(n),o=r.createPolygon(a);o.normalize(),setTimeout(async()=>{const d=Ax(this.map,o);SPM.Components.AssignmentMap.applySelection({selection:d,reset:s})},150),this.polygon.remove(),this.guideline.remove()}}disableSelect(){this.svg&&(this.svg.on("dblclick",null),this.svg.on("mouseup",null),this.svg.on("mousemove",null),this.svg.on("mouseout",null),this.svg.on("mousedown",null),this.svg.remove()),this.buildingPolygon=!1}}class gie{constructor(t){this.map=t}enableSelect(){this.points=[],this.svg=a0(this.map.getCanvasContainer()).append("svg"),this.svg.style("cursor","crosshair"),this.svg.style("position","absolute"),this.svg.style("width","100%"),this.svg.style("height","100%"),this.svg.style("top","0px"),this.svg.style("left","0px"),this.svg.on("mousedown",s=>{if(s.button===2)return;const[n,r]=xu(s,this.svg.node());if(!s.shiftKey){const a=Rc(this.map,{x:n,y:r});fd(a)&&(this.draggingSelection=!0,this.targetId=null)}this.draggingSelection||(this.draggingLasso=!0,this.points=[[n,r]],this.polygon=this.svg.append("path").attr("stroke","#010").attr("fill","#010").attr("fill-opacity",.1),this.guideline=this.svg.append("line").attr("stroke","#010").attr("fill","#010").attr("fill-opacity",.1).attr("stroke-dasharray","2 2"))}),this.svg.on("mousemove",s=>{const[n,r]=xu(s,this.svg.node());if(this.draggingSelection){const a=Rc(this.map,{x:n,y:r}),o=fd(a)?null:t0(a);this.targetId!==o&&(this.targetId=o,this.targetId?(this.svg.style.cursor="pointer",SPM.Components.AssignmentMap.targetId=this.targetId):(this.svg.style.cursor="no-drop",SPM.Components.AssignmentMap.targetId=""),SPM.Components.AssignmentMap.applySelection({redraw:!0}))}else this.draggingLasso&&(t({x:n,y:r},{x:this.points.at(-1)[0],y:this.points.at(-1)[1]})>10&&(this.points.push([n,r]),this.polygon.attr("d",Nx()(this.points))),this.guideline.attr("x1",this.points.at(-1)[0]).attr("y1",this.points.at(-1)[1]).attr("x2",this.points[0][0]).attr("y2",this.points[0][1]))}),this.svg.on("mouseup",async s=>{if(this.draggingSelection&&this.targetId!=null)await SPM.Components.AssignmentMap.reassignSelection({targetId:this.targetId}),SPM.Components.AssignmentMap.targetId="";else if(this.draggingLasso){if(this.points.length===1){const n=Rc(this.map,{x:this.points[0][0],y:this.points[0][1]});SPM.Components.AssignmentMap.applySelection({selection:n,reset:!s.shiftKey})}else{const n=[];this.points.push([...this.points[0]]),this.points.forEach(d=>{const p={x:d[0],y:d[1]},y=this.map.unproject(p);n.push(new cs(y.lng,y.lat))});const r=new fa,a=r.createLinearRing(n),o=r.createPolygon(a);o.normalize(),setTimeout(async()=>{const d=Ax(this.map,o);SPM.Components.AssignmentMap.applySelection({selection:d,reset:!s.shiftKey})},150)}this.polygon.remove(),this.guideline.remove()}this.targetId=null,this.draggingSelection=!1,this.draggingLasso=!1});function t(s,n){return parseInt(Math.sqrt((n.x-s.x)*(n.x-s.x)+(n.y-s.y)*(n.y-s.y)))}}disableSelect(){this.svg&&(this.svg.on("mousedown",null),this.svg.on("mousemove",null),this.svg.on("mouseup",null),this.svg.on("mouseup",null),this.svg.remove())}}class yie{constructor(t){this.map=t}enableSelect(){this.points=[],this.map.doubleClickZoom.disable(),this.svg=a0(this.map.getCanvasContainer()).append("svg"),this.svg.style("cursor","crosshair"),this.svg.style("position","absolute"),this.svg.style("width","100%"),this.svg.style("height","100%"),this.svg.style("top","0px"),this.svg.style("left","0px");const t=MI(".1f");SPM.Components.AssignmentMap.distance=`Total: ${t(0,1)} mi (${t(0,1)} km)`,this.svg.on("mousedown",s=>{if(s.button===2)return;this.points.length||(this.svg.selectAll("*").remove(),this.guideline=this.svg.append("line").attr("stroke","#010").attr("fill","#010").attr("fill-opacity",.1).attr("stroke-dasharray","2 2"),this.distanceLabel=this.svg.append("text").attr("font-family","sans-serif").attr("font-size","12px").attr("fill","blue").attr("font-weight","bold").attr("text-anchor","left"),this.rulerLine=this.svg.append("path").attr("stroke","#010").attr("fill","#010").attr("fill-opacity",0),SPM.Components.AssignmentMap.distance=`Total: ${t(0,1)} mi (${t(0,1)} km)`);const[n,r]=xu(s,this.svg.node());if(this.points.push([n,r]),this.svg.append("circle").attr("cx",n).attr("cy",r).attr("r",4).attr("fill","#010"),this.rulerLine.attr("d",Nx()(this.points)),this.distanceLabel.attr("x",n).attr("y",r).text("0mi"),this.points.length>1){let a=0;for(let o=0;o<this.points.length-1;o++)a+=this.earthDistance(this.points[o],this.points[o+1]);SPM.Components.AssignmentMap.distance=`Total: ${t(a,1)}mi (${t(a*8/5,1)}km)`}}),this.svg.on("mousemove",s=>{const[n,r]=xu(s,this.svg.node());if(this.points.length){this.guideline.attr("x1",this.points.at(-1)[0]).attr("y1",this.points.at(-1)[1]).attr("x2",n).attr("y2",r);const a=t(this.earthDistance(this.points.at(-1),[n,r]),1);this.distanceLabel.attr("x",n+5).attr("y",r-5).text(`${a}mi`)}}),this.svg.on("dblclick",()=>{this.points.length>=2&&(this.points=[],this.distanceLabel.remove())})}disableSelect(){this.map.doubleClickZoom.enable(),this.svg&&(this.svg.on("mousemove",null),this.svg.on("mousedown",null),this.svg.remove()),SPM.Components.AssignmentMap.distance=""}earthDistance([t,s],[n,r]){const{lat:a,lng:o}=this.map.unproject([t,s]),{lat:d,lng:p}=this.map.unproject([n,r]),y=d-a,v=p-o,C=69.04677,I=Math.PI/180,O=Math.cos(d*I);return C*Math.sqrt(y**2+(v*O)**2)}}const vie="/resource/1730930622617/sfsp__NodeBuilder/dist/hand.svg",bie="/resource/1730930622617/sfsp__NodeBuilder/dist/cursor-pointer.svg",xie="/resource/1730930622617/sfsp__NodeBuilder/dist/proximity.svg",wie="/resource/1730930622617/sfsp__NodeBuilder/dist/rectangle.svg",Sie="/resource/1730930622617/sfsp__NodeBuilder/dist/polygon.svg",Cie="/resource/1730930622617/sfsp__NodeBuilder/dist/lasso.svg",Iie="/resource/1730930622617/sfsp__NodeBuilder/dist/ruler.svg",Tie="/resource/1730930622617/sfsp__NodeBuilder/dist/zoom-to-fit.svg",Aie={name:"MapControls",components:{Icon:yn,ButtonIcon:vn},props:["map"],data(){return{activeTool:"Pan",lastTool:"",selectionTools:{Point:new vte(this.map),Circle:new die(this.map),Rectangle:new mie(this.map),Polygon:new _ie(this.map),Lasso:new gie(this.map),Ruler:new yie(this.map)},svg:{hand:vie,cursorPointer:bie,proximity:xie,rectangle:wie,polygon:Sie,lasso:Cie,ruler:Iie,zoomToFit:Tie}}},mounted(){SPM.Components.MapControls=this,window.addEventListener("keydown",this.onWindowKeydown),window.addEventListener("keyup",this.onWindowKeyup)},unmounted(){window.removeEventListener("keydown",this.onWindowKeydown),window.removeEventListener("keyup",this.onWindowKeyup)},methods:{enablePan(){this.activeTool="Pan",Object.values(this.selectionTools).forEach(e=>e.disableSelect()),this.map.dragPan.enable(),this.map.doubleClickZoom.enable(),this.map.boxZoom.enable()},enableSelectionTool(e){this.activeTool=e,Object.values(this.selectionTools).forEach(t=>t.disableSelect()),this.selectionTools[e].enableSelect(),this.map.dragPan.disable(),this.map.doubleClickZoom.disable(),this.map.boxZoom.disable()},clearSelection(){SPM.Components.AssignmentMap.applySelection({selection:[],reset:!0}),this.activeTool==="Ruler"&&(this.selectionTools[this.activeTool].disableSelect(),this.enableSelectionTool(this.activeTool))},toggleLayersPanel(){SPM.Components.Assignment.sidePanel=SPM.Components.Assignment.sidePanel==="LayersPanel"?"":"LayersPanel"},zoomToFit(){SPM.Components.AssignmentMap.zoomTo()},onWindowKeydown(e){e.keyCode===32&&this.activeTool!=="Pan"?(this.lastTool=this.activeTool,this.enablePan()):e.keyCode===27&&this.clearSelection()},onWindowKeyup(e){e.keyCode===32&&(this.selectionTools[this.lastTool]&&this.enableSelectionTool(this.lastTool),this.lastTool=null)}}},Mie={id:"mapControls",class:"slds-grid",role:"toolbar"},Eie={class:"spm-button-group slds-grid"},kie={class:"spm-button-group slds-grid slds-m-left_small"},Pie={class:"spm-button-group slds-grid slds-m-left_small"};function Rie(e,t,s,n,r,a){const o=pe("Icon"),d=pe("ButtonIcon");return L(),X("div",Mie,[k("div",Eie,[k("button",{class:$t(["slds-button slds-button_icon slds-button_icon-border-filled",{"slds-is-selected":r.activeTool==="Pan"}]),onClick:t[0]||(t[0]=(...p)=>a.enablePan&&a.enablePan(...p))},[de(o,{src:r.svg.hand,iconClass:"slds-button__icon",assistiveText:"Pan Map"},null,8,["src"])],2),k("button",{class:$t(["slds-button slds-button_icon slds-button_icon-border-filled",{"slds-is-selected":r.activeTool==="Point"}]),onClick:t[1]||(t[1]=p=>a.enableSelectionTool("Point"))},[de(o,{src:r.svg.cursorPointer,iconClass:"slds-button__icon",assistiveText:"Point Selection Tool"},null,8,["src"])],2),k("button",{class:$t(["slds-button slds-button_icon slds-button_icon-border-filled",{"slds-is-selected":r.activeTool==="Circle"}]),onClick:t[2]||(t[2]=p=>a.enableSelectionTool("Circle"))},[de(o,{src:r.svg.proximity,iconClass:"slds-button__icon",assistiveText:"Radius Selection Tool"},null,8,["src"])],2),k("button",{class:$t(["slds-button slds-button_icon slds-button_icon-border-filled",{"slds-is-selected":r.activeTool==="Rectangle"}]),onClick:t[3]||(t[3]=p=>a.enableSelectionTool("Rectangle"))},[de(o,{src:r.svg.rectangle,iconClass:"slds-button__icon",assistiveText:"Rectangle Selection Tool"},null,8,["src"])],2),k("button",{class:$t(["slds-button slds-button_icon slds-button_icon-border-filled",{"slds-is-selected":r.activeTool==="Polygon"}]),onClick:t[4]||(t[4]=p=>a.enableSelectionTool("Polygon"))},[de(o,{src:r.svg.polygon,iconClass:"slds-button__icon",assistiveText:"Polygon Selection Tool"},null,8,["src"])],2),k("button",{class:$t(["slds-button slds-button_icon slds-button_icon-border-filled",{"slds-is-selected":r.activeTool==="Lasso"}]),onClick:t[5]||(t[5]=p=>a.enableSelectionTool("Lasso"))},[de(o,{src:r.svg.lasso,iconClass:"slds-button__icon",assistiveText:"Lasso Selection Tool"},null,8,["src"])],2),k("button",{class:$t(["slds-button slds-button_icon slds-button_icon-border-filled",{"slds-is-selected":r.activeTool==="Ruler"}]),onClick:t[6]||(t[6]=p=>a.enableSelectionTool("Ruler"))},[de(o,{src:r.svg.ruler,iconClass:"slds-button__icon",assistiveText:"Ruler Tool"},null,8,["src"])],2),de(d,{iconCategory:"utility",iconName:"error",variant:"border",iconSize:"small",title:"Clear Selection",assistiveText:"Clear Selection",onClick:a.clearSelection},null,8,["onClick"])]),k("div",kie,[de(d,{iconCategory:"utility",iconName:"layers",variant:"border",iconSize:"small",title:"Layers",assistiveText:"Layers",onClick:a.toggleLayersPanel},null,8,["onClick"])]),k("div",Pie,[de(d,{iconCategory:"utility",iconName:"add",variant:"border",iconSize:"small",title:"Zoom In",assistiveText:"Zoom In",onClick:t[7]||(t[7]=p=>s.map.zoomIn())}),k("button",{class:"slds-button slds-button_icon slds-button_icon-border-filled",onClick:t[8]||(t[8]=(...p)=>a.zoomToFit&&a.zoomToFit(...p))},[de(o,{src:r.svg.zoomToFit,iconClass:"slds-button__icon",assistiveText:"Zoom To Fit"},null,8,["src"])]),de(d,{iconCategory:"utility",iconName:"dash",variant:"border",iconSize:"small",title:"Zoom Out",assistiveText:"Zoom Out",onClick:t[9]||(t[9]=p=>s.map.zoomOut())})])])}const $ie=os(Aie,[["render",Rie],["__scopeId","data-v-af4a1a25"]]);var L$={exports:{}};(function(e,t){(function(s,n){e.exports=n()})(Qu,function(){var s,n,r;function a(o,d){if(!s)s=d;else if(!n)n=d;else{var p="var sharedChunk = {}; ("+s+")(sharedChunk); ("+n+")(sharedChunk);",y={};s(y),r=d(y),typeof window<"u"&&(r.workerUrl=window.URL.createObjectURL(new Blob([p],{type:"text/javascript"})))}}return a(["exports"],function(o){function d(i,l){return i(l={exports:{}},l.exports),l.exports}var p=y;function y(i,l,c,_){this.cx=3*i,this.bx=3*(c-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(_-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=_,this.p2x=c,this.p2y=_}y.prototype.sampleCurveX=function(i){return((this.ax*i+this.bx)*i+this.cx)*i},y.prototype.sampleCurveY=function(i){return((this.ay*i+this.by)*i+this.cy)*i},y.prototype.sampleCurveDerivativeX=function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},y.prototype.solveCurveX=function(i,l){var c,_,x,w,T;for(l===void 0&&(l=1e-6),x=i,T=0;T<8;T++){if(w=this.sampleCurveX(x)-i,Math.abs(w)<l)return x;var $=this.sampleCurveDerivativeX(x);if(Math.abs($)<1e-6)break;x-=w/$}if((x=i)<(c=0))return c;if(x>(_=1))return _;for(;c<_;){if(w=this.sampleCurveX(x),Math.abs(w-i)<l)return x;i>w?c=x:_=x,x=.5*(_-c)+c}return x},y.prototype.solve=function(i,l){return this.sampleCurveY(this.solveCurveX(i,l))};var v=C;function C(i,l){this.x=i,this.y=l}C.prototype={clone:function(){return new C(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,l){return this.clone()._rotateAround(i,l)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var l=i.x-this.x,c=i.y-this.y;return l*l+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,l){return Math.atan2(this.x*l-this.y*i,this.x*i+this.y*l)},_matMult:function(i){var l=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=l,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var l=Math.cos(i),c=Math.sin(i),_=c*this.x+l*this.y;return this.x=l*this.x-c*this.y,this.y=_,this},_rotateAround:function(i,l){var c=Math.cos(i),_=Math.sin(i),x=l.y+_*(this.x-l.x)+c*(this.y-l.y);return this.x=l.x+c*(this.x-l.x)-_*(this.y-l.y),this.y=x,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},C.convert=function(i){return i instanceof C?i:Array.isArray(i)?new C(i[0],i[1]):i};var I=typeof self<"u"?self:{},O=Math.pow(2,53)-1;function A(i,l,c,_){var x=new p(i,l,c,_);return function(w){return x.solve(w)}}var P=A(.25,.1,.25,1);function q(i,l,c){return Math.min(c,Math.max(l,i))}function ce(i,l,c){var _=c-l,x=((i-l)%_+_)%_+l;return x===l?c:x}function re(i){for(var l=[],c=arguments.length-1;c-- >0;)l[c]=arguments[c+1];for(var _=0,x=l;_<x.length;_+=1){var w=x[_];for(var T in w)i[T]=w[T]}return i}var W=1;function Ce(){return W++}function te(){return function i(l){return l?(l^16*Math.random()>>l/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,i)}()}function oe(i){return!!i&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(i)}function ve(i,l){i.forEach(function(c){l[c]&&(l[c]=l[c].bind(l))})}function ee(i,l){return i.indexOf(l,i.length-l.length)!==-1}function ne(i,l,c){var _={};for(var x in i)_[x]=l.call(c||this,i[x],x,i);return _}function Se(i,l,c){var _={};for(var x in i)l.call(c||this,i[x],x,i)&&(_[x]=i[x]);return _}function Ue(i){return Array.isArray(i)?i.map(Ue):typeof i=="object"&&i?ne(i,Ue):i}var Qe={};function Me(i){Qe[i]||(typeof console<"u"&&console.warn(i),Qe[i]=!0)}function vt(i,l,c){return(c.y-i.y)*(l.x-i.x)>(l.y-i.y)*(c.x-i.x)}function Ut(i){for(var l=0,c=0,_=i.length,x=_-1,w=void 0,T=void 0;c<_;x=c++)l+=((T=i[x]).x-(w=i[c]).x)*(w.y+T.y);return l}function Rt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function _t(i){var l={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(_,x,w,T){var $=w||T;return l[x]=!$||$.toLowerCase(),""}),l["max-age"]){var c=parseInt(l["max-age"],10);isNaN(c)?delete l["max-age"]:l["max-age"]=c}return l}var F=null;function j(i){if(F==null){var l=i.navigator?i.navigator.userAgent:null;F=!!i.safari||!(!l||!(/\b(iPad|iPhone|iPod)\b/.test(l)||l.match("Safari")&&!l.match("Chrome")))}return F}function G(i){try{var l=I[i];return l.setItem("_mapbox_test_",1),l.removeItem("_mapbox_test_"),!0}catch{return!1}}var Y,J,he,be,Ne=I.performance&&I.performance.now?I.performance.now.bind(I.performance):Date.now.bind(Date),ke=I.requestAnimationFrame||I.mozRequestAnimationFrame||I.webkitRequestAnimationFrame||I.msRequestAnimationFrame,qe=I.cancelAnimationFrame||I.mozCancelAnimationFrame||I.webkitCancelAnimationFrame||I.msCancelAnimationFrame,ct={now:Ne,frame:function(i){var l=ke(i);return{cancel:function(){return qe(l)}}},getImageData:function(i,l){l===void 0&&(l=0);var c=I.document.createElement("canvas"),_=c.getContext("2d");if(!_)throw new Error("failed to create canvas 2d context");return c.width=i.width,c.height=i.height,_.drawImage(i,0,0,i.width,i.height),_.getImageData(-l,-l,i.width+2*l,i.height+2*l)},resolveURL:function(i){return Y||(Y=I.document.createElement("a")),Y.href=i,Y.href},hardwareConcurrency:I.navigator&&I.navigator.hardwareConcurrency||4,get devicePixelRatio(){return I.devicePixelRatio},get prefersReducedMotion(){return!!I.matchMedia&&(J==null&&(J=I.matchMedia("(prefers-reduced-motion: reduce)")),J.matches)}},We={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},ht={supported:!1,testSupport:function(i){!rt&&be&&(fe?ye(i):he=i)}},rt=!1,fe=!1;function ye(i){var l=i.createTexture();i.bindTexture(i.TEXTURE_2D,l);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,be),i.isContextLost())return;ht.supported=!0}catch{}i.deleteTexture(l),rt=!0}I.document&&((be=I.document.createElement("img")).onload=function(){he&&ye(he),he=null,fe=!0},be.onerror=function(){rt=!0,he=null},be.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var Je="01",at=function(i,l){this._transformRequestFn=i,this._customAccessToken=l,this._createSkuToken()};function it(i){return i.indexOf("mapbox:")===0}at.prototype._createSkuToken=function(){var i=function(){for(var l="",c=0;c<10;c++)l+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Je,l].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=i.token,this._skuTokenExpiresAt=i.tokenExpiresAt},at.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},at.prototype.transformRequest=function(i,l){return this._transformRequestFn&&this._transformRequestFn(i,l)||{url:i}},at.prototype.normalizeStyleURL=function(i,l){if(!it(i))return i;var c=St(i);return c.path="/styles/v1"+c.path,this._makeAPIURL(c,this._customAccessToken||l)},at.prototype.normalizeGlyphsURL=function(i,l){if(!it(i))return i;var c=St(i);return c.path="/fonts/v1"+c.path,this._makeAPIURL(c,this._customAccessToken||l)},at.prototype.normalizeSourceURL=function(i,l){if(!it(i))return i;var c=St(i);return c.path="/v4/"+c.authority+".json",c.params.push("secure"),this._makeAPIURL(c,this._customAccessToken||l)},at.prototype.normalizeSpriteURL=function(i,l,c,_){var x=St(i);return it(i)?(x.path="/styles/v1"+x.path+"/sprite"+l+c,this._makeAPIURL(x,this._customAccessToken||_)):(x.path+=""+l+c,Ct(x))},at.prototype.normalizeTileURL=function(i,l){if(this._isSkuTokenExpired()&&this._createSkuToken(),i&&!it(i))return i;var c=St(i);c.path=c.path.replace(/(\.(png|jpg)\d*)(?=$)/,(ct.devicePixelRatio>=2||l===512?"@2x":"")+(ht.supported?".webp":"$1")),c.path=c.path.replace(/^.+\/v4\//,"/"),c.path="/v4"+c.path;var _=this._customAccessToken||function(x){for(var w=0,T=x;w<T.length;w+=1){var $=T[w].match(/^access_token=(.*)$/);if($)return $[1]}return null}(c.params)||We.ACCESS_TOKEN;return We.REQUIRE_ACCESS_TOKEN&&_&&this._skuToken&&c.params.push("sku="+this._skuToken),this._makeAPIURL(c,_)},at.prototype.canonicalizeTileURL=function(i,l){var c=St(i);if(!c.path.match(/(^\/v4\/)/)||!c.path.match(/\.[\w]+$/))return i;var _="mapbox://tiles/";_+=c.path.replace("/v4/","");var x=c.params;return l&&(x=x.filter(function(w){return!w.match(/^access_token=/)})),x.length&&(_+="?"+x.join("&")),_},at.prototype.canonicalizeTileset=function(i,l){for(var c=!!l&&it(l),_=[],x=0,w=i.tiles||[];x<w.length;x+=1){var T=w[x];jt(T)?_.push(this.canonicalizeTileURL(T,c)):_.push(T)}return _},at.prototype._makeAPIURL=function(i,l){var c="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",_=St(We.API_URL);if(i.protocol=_.protocol,i.authority=_.authority,i.protocol==="http"){var x=i.params.indexOf("secure");x>=0&&i.params.splice(x,1)}if(_.path!=="/"&&(i.path=""+_.path+i.path),!We.REQUIRE_ACCESS_TOKEN)return Ct(i);if(!(l=l||We.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+c);if(l[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+c);return i.params=i.params.filter(function(w){return w.indexOf("access_token")===-1}),i.params.push("access_token="+l),Ct(i)};var Et=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function jt(i){return Et.test(i)}var Nt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function St(i){var l=i.match(Nt);if(!l)throw new Error("Unable to parse URL object");return{protocol:l[1],authority:l[2],path:l[3]||"/",params:l[4]?l[4].split("&"):[]}}function Ct(i){var l=i.params.length?"?"+i.params.join("&"):"";return i.protocol+"://"+i.authority+i.path+l}function Bt(i){if(!i)return null;var l=i.split(".");if(!l||l.length!==3)return null;try{return JSON.parse(decodeURIComponent(I.atob(l[1]).split("").map(function(c){return"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var Kt=function(i){this.type=i,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Kt.prototype.getStorageKey=function(i){var l,c=Bt(We.ACCESS_TOKEN);return l=c&&c.u?I.btoa(encodeURIComponent(c.u).replace(/%([0-9A-F]{2})/g,function(_,x){return String.fromCharCode(Number("0x"+x))})):We.ACCESS_TOKEN||"",i?"mapbox.eventData."+i+":"+l:"mapbox.eventData:"+l},Kt.prototype.fetchEventData=function(){var i=G("localStorage"),l=this.getStorageKey(),c=this.getStorageKey("uuid");if(i)try{var _=I.localStorage.getItem(l);_&&(this.eventData=JSON.parse(_));var x=I.localStorage.getItem(c);x&&(this.anonId=x)}catch{Me("Unable to read from LocalStorage")}},Kt.prototype.saveEventData=function(){var i=G("localStorage"),l=this.getStorageKey(),c=this.getStorageKey("uuid");if(i)try{I.localStorage.setItem(c,this.anonId),Object.keys(this.eventData).length>=1&&I.localStorage.setItem(l,JSON.stringify(this.eventData))}catch{Me("Unable to write to LocalStorage")}},Kt.prototype.processRequests=function(i){},Kt.prototype.postEvent=function(i,l,c,_){var x=this;if(We.EVENTS_URL){var w=St(We.EVENTS_URL);w.params.push("access_token="+(_||We.ACCESS_TOKEN||""));var T={event:this.type,created:new Date(i).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.3",skuId:Je,userId:this.anonId},$=l?re(T,l):T,D={url:Ct(w),headers:{"Content-Type":"text/plain"},body:JSON.stringify([$])};this.pendingRequest=qr(D,function(V){x.pendingRequest=null,c(V),x.saveEventData(),x.processRequests(_)})}},Kt.prototype.queueRequest=function(i,l){this.queue.push(i),this.processRequests(l)};var ys,ts,Us=function(i){function l(){i.call(this,"map.load"),this.success={},this.skuToken=""}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.postMapLoadEvent=function(c,_,x,w){this.skuToken=x;var T=!(!w&&!We.ACCESS_TOKEN),$=Array.isArray(c)&&c.some(function(D){return it(D)||jt(D)});We.EVENTS_URL&&T&&$&&this.queueRequest({id:_,timestamp:Date.now()},w)},l.prototype.processRequests=function(c){var _=this;if(!this.pendingRequest&&this.queue.length!==0){var x=this.queue.shift(),w=x.id,T=x.timestamp;w&&this.success[w]||(this.anonId||this.fetchEventData(),oe(this.anonId)||(this.anonId=te()),this.postEvent(T,{skuToken:this.skuToken},function($){$||w&&(_.success[w]=!0)},c))}},l}(Kt),ue=new(function(i){function l(c){i.call(this,"appUserTurnstile"),this._customAccessToken=c}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.postTurnstileEvent=function(c,_){We.EVENTS_URL&&We.ACCESS_TOKEN&&Array.isArray(c)&&c.some(function(x){return it(x)||jt(x)})&&this.queueRequest(Date.now(),_)},l.prototype.processRequests=function(c){var _=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var x=Bt(We.ACCESS_TOKEN),w=x?x.u:We.ACCESS_TOKEN,T=w!==this.eventData.tokenU;oe(this.anonId)||(this.anonId=te(),T=!0);var $=this.queue.shift();if(this.eventData.lastSuccess){var D=new Date(this.eventData.lastSuccess),V=new Date($),Z=($-this.eventData.lastSuccess)/864e5;T=T||Z>=1||Z<-1||D.getDate()!==V.getDate()}else T=!0;if(!T)return this.processRequests();this.postEvent($,{"enabled.telemetry":!1},function(K){K||(_.eventData.lastSuccess=$,_.eventData.tokenU=w)},c)}},l}(Kt)),B=ue.postTurnstileEvent.bind(ue),U=new Us,Re=U.postMapLoadEvent.bind(U),nt=500,gt=50;function kt(){I.caches&&!ys&&(ys=I.caches.open("mapbox-tiles"))}function Ds(i){var l=i.indexOf("?");return l<0?i:i.slice(0,l)}var tn,nn=1/0;function qn(){return tn==null&&(tn=I.OffscreenCanvas&&new I.OffscreenCanvas(1,1).getContext("2d")&&typeof I.createImageBitmap=="function"),tn}var Kn={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Kn);var Eh=function(i){function l(c,_,x){_===401&&jt(x)&&(c+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),i.call(this,c),this.status=_,this.url=x,this.name=this.constructor.name,this.message=c}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},l}(Error),Vc=Rt()?function(){return self.worker&&self.worker.referrer}:function(){return(I.location.protocol==="blob:"?I.parent:I).location.href},Ua,Va,Tu=function(i,l){if(!(/^file:/.test(c=i.url)||/^file:/.test(Vc())&&!/^\w+:/.test(c))){if(I.fetch&&I.Request&&I.AbortController&&I.Request.prototype.hasOwnProperty("signal"))return function(_,x){var w,T=new I.AbortController,$=new I.Request(_.url,{method:_.method||"GET",body:_.body,credentials:_.credentials,headers:_.headers,referrer:Vc(),signal:T.signal}),D=!1,V=!1,Z=(w=$.url).indexOf("sku=")>0&&jt(w);_.type==="json"&&$.headers.set("Accept","application/json");var K=function(_e,Oe,Be){if(!V){if(_e&&_e.message!=="SecurityError"&&Me(_e),Oe&&Be)return le(Oe);var Xe=Date.now();I.fetch($).then(function(He){if(He.ok){var lt=Z?He.clone():null;return le(He,lt,Xe)}return x(new Eh(He.statusText,He.status,_.url))}).catch(function(He){He.code!==20&&x(new Error(He.message))})}},le=function(_e,Oe,Be){(_.type==="arrayBuffer"?_e.arrayBuffer():_.type==="json"?_e.json():_e.text()).then(function(Xe){V||(Oe&&Be&&function(He,lt,ft){if(kt(),ys){var yt={status:lt.status,statusText:lt.statusText,headers:new I.Headers};lt.headers.forEach(function(Pt,Yt){return yt.headers.set(Yt,Pt)});var xt=_t(lt.headers.get("Cache-Control")||"");xt["no-store"]||(xt["max-age"]&&yt.headers.set("Expires",new Date(ft+1e3*xt["max-age"]).toUTCString()),new Date(yt.headers.get("Expires")).getTime()-ft<42e4||function(Pt,Yt){if(ts===void 0)try{new Response(new ReadableStream),ts=!0}catch{ts=!1}ts?Yt(Pt.body):Pt.blob().then(Yt)}(lt,function(Pt){var Yt=new I.Response(Pt,yt);kt(),ys&&ys.then(function(Qt){return Qt.put(Ds(He.url),Yt)}).catch(function(Qt){return Me(Qt.message)})}))}}($,Oe,Be),D=!0,x(null,Xe,_e.headers.get("Cache-Control"),_e.headers.get("Expires")))}).catch(function(Xe){V||x(new Error(Xe.message))})};return Z?function(_e,Oe){if(kt(),!ys)return Oe(null);var Be=Ds(_e.url);ys.then(function(Xe){Xe.match(Be).then(function(He){var lt=function(ft){if(!ft)return!1;var yt=new Date(ft.headers.get("Expires")||0),xt=_t(ft.headers.get("Cache-Control")||"");return yt>Date.now()&&!xt["no-cache"]}(He);Xe.delete(Be),lt&&Xe.put(Be,He.clone()),Oe(null,He,lt)}).catch(Oe)}).catch(Oe)}($,K):K(null,null),{cancel:function(){V=!0,D||T.abort()}}}(i,l);if(Rt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,l,void 0,!0)}var c;return function(_,x){var w=new I.XMLHttpRequest;for(var T in w.open(_.method||"GET",_.url,!0),_.type==="arrayBuffer"&&(w.responseType="arraybuffer"),_.headers)w.setRequestHeader(T,_.headers[T]);return _.type==="json"&&(w.responseType="text",w.setRequestHeader("Accept","application/json")),w.withCredentials=_.credentials==="include",w.onerror=function(){x(new Error(w.statusText))},w.onload=function(){if((w.status>=200&&w.status<300||w.status===0)&&w.response!==null){var $=w.response;if(_.type==="json")try{$=JSON.parse(w.response)}catch(D){return x(D)}x(null,$,w.getResponseHeader("Cache-Control"),w.getResponseHeader("Expires"))}else x(new Eh(w.statusText,w.status,_.url))},w.send(_.body),{cancel:function(){return w.abort()}}}(i,l)},yd=function(i,l){return Tu(re(i,{type:"arrayBuffer"}),l)},qr=function(i,l){return Tu(re(i,{method:"POST"}),l)},Q="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Ua=[],Va=0;var ae=function(i,l){if(ht.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),Va>=We.MAX_PARALLEL_IMAGE_REQUESTS){var c={requestParameters:i,callback:l,cancelled:!1,cancel:function(){this.cancelled=!0}};return Ua.push(c),c}Va++;var _=!1,x=function(){if(!_)for(_=!0,Va--;Ua.length&&Va<We.MAX_PARALLEL_IMAGE_REQUESTS;){var T=Ua.shift();T.cancelled||(T.cancel=ae(T.requestParameters,T.callback).cancel)}},w=yd(i,function(T,$,D,V){x(),T?l(T):$&&(qn()?function(Z,K){var le=new I.Blob([new Uint8Array(Z)],{type:"image/png"});I.createImageBitmap(le).then(function(_e){K(null,_e)}).catch(function(_e){K(new Error("Could not load image because of "+_e.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}($,l):function(Z,K,le,_e){var Oe=new I.Image,Be=I.URL;Oe.onload=function(){K(null,Oe),Be.revokeObjectURL(Oe.src),Oe.onload=null,I.requestAnimationFrame(function(){Oe.src=Q})},Oe.onerror=function(){return K(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Xe=new I.Blob([new Uint8Array(Z)],{type:"image/png"});Oe.cacheControl=le,Oe.expires=_e,Oe.src=Z.byteLength?Be.createObjectURL(Xe):Q}($,l,D,V))});return{cancel:function(){w.cancel(),x()}}};function me(i,l,c){c[i]&&c[i].indexOf(l)!==-1||(c[i]=c[i]||[],c[i].push(l))}function Ae(i,l,c){if(c&&c[i]){var _=c[i].indexOf(l);_!==-1&&c[i].splice(_,1)}}var Fe=function(i,l){l===void 0&&(l={}),re(this,l),this.type=i},et=function(i){function l(c,_){_===void 0&&(_={}),i.call(this,"error",re({error:c},_))}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l}(Fe),st=function(){};st.prototype.on=function(i,l){return this._listeners=this._listeners||{},me(i,l,this._listeners),this},st.prototype.off=function(i,l){return Ae(i,l,this._listeners),Ae(i,l,this._oneTimeListeners),this},st.prototype.once=function(i,l){return this._oneTimeListeners=this._oneTimeListeners||{},me(i,l,this._oneTimeListeners),this},st.prototype.fire=function(i,l){typeof i=="string"&&(i=new Fe(i,l||{}));var c=i.type;if(this.listens(c)){i.target=this;for(var _=0,x=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];_<x.length;_+=1)x[_].call(this,i);for(var w=0,T=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];w<T.length;w+=1){var $=T[w];Ae(c,$,this._oneTimeListeners),$.call(this,i)}var D=this._eventedParent;D&&(re(i,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),D.fire(i))}else i instanceof et&&console.error(i.error);return this},st.prototype.listens=function(i){return this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i)},st.prototype.setEventedParent=function(i,l){return this._eventedParent=i,this._eventedParentData=l,this};var xe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Ve=function(i,l,c,_){this.message=(i?i+": ":"")+c,_&&(this.identifier=_),l!=null&&l.__line__&&(this.line=l.__line__)};function pt(i){var l=i.value;return l?[new Ve(i.key,l,"constants have been deprecated as of v8")]:[]}function Ft(i){for(var l=[],c=arguments.length-1;c-- >0;)l[c]=arguments[c+1];for(var _=0,x=l;_<x.length;_+=1){var w=x[_];for(var T in w)i[T]=w[T]}return i}function Ht(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Tt(i){if(Array.isArray(i))return i.map(Tt);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){var l={};for(var c in i)l[c]=Tt(i[c]);return l}return Ht(i)}var Vt=function(i){function l(c,_){i.call(this,_),this.message=_,this.key=c}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l}(Error),xs=function(i,l){l===void 0&&(l=[]),this.parent=i,this.bindings={};for(var c=0,_=l;c<_.length;c+=1){var x=_[c];this.bindings[x[0]]=x[1]}};xs.prototype.concat=function(i){return new xs(this,i)},xs.prototype.get=function(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(i+" not found in scope.")},xs.prototype.has=function(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)};var ms={kind:"null"},At={kind:"number"},fs={kind:"string"},ns={kind:"boolean"},is={kind:"color"},rn={kind:"object"},hs={kind:"value"},mn={kind:"collator"},Fn={kind:"formatted"},hn={kind:"resolvedImage"};function Sn(i,l){return{kind:"array",itemType:i,N:l}}function bn(i){if(i.kind==="array"){var l=bn(i.itemType);return typeof i.N=="number"?"array<"+l+", "+i.N+">":i.itemType.kind==="value"?"array":"array<"+l+">"}return i.kind}var eo=[ms,At,fs,ns,is,Fn,rn,Sn(hs),hn];function zn(i,l){if(l.kind==="error")return null;if(i.kind==="array"){if(l.kind==="array"&&(l.N===0&&l.itemType.kind==="value"||!zn(i.itemType,l.itemType))&&(typeof i.N!="number"||i.N===l.N))return null}else{if(i.kind===l.kind)return null;if(i.kind==="value"){for(var c=0,_=eo;c<_.length;c+=1)if(!zn(_[c],l))return null}}return"Expected "+bn(i)+" but found "+bn(l)+" instead."}function Br(i,l){return l.some(function(c){return c.kind===i.kind})}function Hn(i,l){return l.some(function(c){return c==="null"?i===null:c==="array"?Array.isArray(i):c==="object"?i&&!Array.isArray(i)&&typeof i=="object":c===typeof i})}var pn=d(function(i,l){var c={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function _($){return($=Math.round($))<0?0:$>255?255:$}function x($){return _($[$.length-1]==="%"?parseFloat($)/100*255:parseInt($))}function w($){return(D=$[$.length-1]==="%"?parseFloat($)/100:parseFloat($))<0?0:D>1?1:D;var D}function T($,D,V){return V<0?V+=1:V>1&&(V-=1),6*V<1?$+(D-$)*V*6:2*V<1?D:3*V<2?$+(D-$)*(2/3-V)*6:$}try{l.parseCSSColor=function($){var D,V=$.replace(/ /g,"").toLowerCase();if(V in c)return c[V].slice();if(V[0]==="#")return V.length===4?(D=parseInt(V.substr(1),16))>=0&&D<=4095?[(3840&D)>>4|(3840&D)>>8,240&D|(240&D)>>4,15&D|(15&D)<<4,1]:null:V.length===7&&(D=parseInt(V.substr(1),16))>=0&&D<=16777215?[(16711680&D)>>16,(65280&D)>>8,255&D,1]:null;var Z=V.indexOf("("),K=V.indexOf(")");if(Z!==-1&&K+1===V.length){var le=V.substr(0,Z),_e=V.substr(Z+1,K-(Z+1)).split(","),Oe=1;switch(le){case"rgba":if(_e.length!==4)return null;Oe=w(_e.pop());case"rgb":return _e.length!==3?null:[x(_e[0]),x(_e[1]),x(_e[2]),Oe];case"hsla":if(_e.length!==4)return null;Oe=w(_e.pop());case"hsl":if(_e.length!==3)return null;var Be=(parseFloat(_e[0])%360+360)%360/360,Xe=w(_e[1]),He=w(_e[2]),lt=He<=.5?He*(Xe+1):He+Xe-He*Xe,ft=2*He-lt;return[_(255*T(ft,lt,Be+1/3)),_(255*T(ft,lt,Be)),_(255*T(ft,lt,Be-1/3)),Oe];default:return null}}return null}}catch{}}).parseCSSColor,On=function(i,l,c,_){_===void 0&&(_=1),this.r=i,this.g=l,this.b=c,this.a=_};On.parse=function(i){if(i){if(i instanceof On)return i;if(typeof i=="string"){var l=pn(i);if(l)return new On(l[0]/255*l[3],l[1]/255*l[3],l[2]/255*l[3],l[3])}}},On.prototype.toString=function(){var i=this.toArray(),l=i[1],c=i[2],_=i[3];return"rgba("+Math.round(i[0])+","+Math.round(l)+","+Math.round(c)+","+_+")"},On.prototype.toArray=function(){var i=this.a;return i===0?[0,0,0,0]:[255*this.r/i,255*this.g/i,255*this.b/i,i]},On.black=new On(0,0,0,1),On.white=new On(1,1,1,1),On.transparent=new On(0,0,0,0),On.red=new On(1,0,0,1);var po=function(i,l,c){this.sensitivity=i?l?"variant":"case":l?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};po.prototype.compare=function(i,l){return this.collator.compare(i,l)},po.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var vd=function(i,l,c,_,x){this.text=i,this.image=l,this.scale=c,this.fontStack=_,this.textColor=x},vi=function(i){this.sections=i};vi.fromString=function(i){return new vi([new vd(i,null,null,null,null)])},vi.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(i){return i.text.length!==0||i.image&&i.image.name.length!==0})},vi.factory=function(i){return i instanceof vi?i:vi.fromString(i)},vi.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(i){return i.text}).join("")},vi.prototype.serialize=function(){for(var i=["format"],l=0,c=this.sections;l<c.length;l+=1){var _=c[l];if(_.image)i.push(["image",_.image.name]);else{i.push(_.text);var x={};_.fontStack&&(x["text-font"]=["literal",_.fontStack.split(",")]),_.scale&&(x["font-scale"]=_.scale),_.textColor&&(x["text-color"]=["rgba"].concat(_.textColor.toArray())),i.push(x)}}return i};var to=function(i){this.name=i.name,this.available=i.available};function kh(i,l,c,_){return typeof i=="number"&&i>=0&&i<=255&&typeof l=="number"&&l>=0&&l<=255&&typeof c=="number"&&c>=0&&c<=255?_===void 0||typeof _=="number"&&_>=0&&_<=1?null:"Invalid rgba value ["+[i,l,c,_].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof _=="number"?[i,l,c,_]:[i,l,c]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Au(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof On||i instanceof po||i instanceof vi||i instanceof to)return!0;if(Array.isArray(i)){for(var l=0,c=i;l<c.length;l+=1)if(!Au(c[l]))return!1;return!0}if(typeof i=="object"){for(var _ in i)if(!Au(i[_]))return!1;return!0}return!1}function Pr(i){if(i===null)return ms;if(typeof i=="string")return fs;if(typeof i=="boolean")return ns;if(typeof i=="number")return At;if(i instanceof On)return is;if(i instanceof po)return mn;if(i instanceof vi)return Fn;if(i instanceof to)return hn;if(Array.isArray(i)){for(var l,c=i.length,_=0,x=i;_<x.length;_+=1){var w=Pr(x[_]);if(l){if(l===w)continue;l=hs;break}l=w}return Sn(l||hs,c)}return rn}function bd(i){var l=typeof i;return i===null?"":l==="string"||l==="number"||l==="boolean"?String(i):i instanceof On||i instanceof vi||i instanceof to?i.toString():JSON.stringify(i)}to.prototype.toString=function(){return this.name},to.fromString=function(i){return i?new to({name:i,available:!1}):null},to.prototype.serialize=function(){return["image",this.name]};var Di=function(i,l){this.type=i,this.value=l};Di.parse=function(i,l){if(i.length!==2)return l.error("'literal' expression requires exactly one argument, but found "+(i.length-1)+" instead.");if(!Au(i[1]))return l.error("invalid value");var c=i[1],_=Pr(c),x=l.expectedType;return _.kind!=="array"||_.N!==0||!x||x.kind!=="array"||typeof x.N=="number"&&x.N!==0||(_=x),new Di(_,c)},Di.prototype.evaluate=function(){return this.value},Di.prototype.eachChild=function(){},Di.prototype.outputDefined=function(){return!0},Di.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof On?["rgba"].concat(this.value.toArray()):this.value instanceof vi?this.value.serialize():this.value};var Zr=function(i){this.name="ExpressionEvaluationError",this.message=i};Zr.prototype.toJSON=function(){return this.message};var zo={string:fs,number:At,boolean:ns,object:rn},Sr=function(i,l){this.type=i,this.args=l};Sr.parse=function(i,l){if(i.length<2)return l.error("Expected at least one argument.");var c,_=1,x=i[0];if(x==="array"){var w,T;if(i.length>2){var $=i[1];if(typeof $!="string"||!($ in zo)||$==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);w=zo[$],_++}else w=hs;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return l.error('The length argument to "array" must be a positive integer literal',2);T=i[2],_++}c=Sn(w,T)}else c=zo[x];for(var D=[];_<i.length;_++){var V=l.parse(i[_],_,hs);if(!V)return null;D.push(V)}return new Sr(c,D)},Sr.prototype.evaluate=function(i){for(var l=0;l<this.args.length;l++){var c=this.args[l].evaluate(i);if(!zn(this.type,Pr(c)))return c;if(l===this.args.length-1)throw new Zr("Expected value to be of type "+bn(this.type)+", but found "+bn(Pr(c))+" instead.")}return null},Sr.prototype.eachChild=function(i){this.args.forEach(i)},Sr.prototype.outputDefined=function(){return this.args.every(function(i){return i.outputDefined()})},Sr.prototype.serialize=function(){var i=this.type,l=[i.kind];if(i.kind==="array"){var c=i.itemType;if(c.kind==="string"||c.kind==="number"||c.kind==="boolean"){l.push(c.kind);var _=i.N;(typeof _=="number"||this.args.length>1)&&l.push(_)}}return l.concat(this.args.map(function(x){return x.serialize()}))};var Jo=function(i){this.type=Fn,this.sections=i};Jo.parse=function(i,l){if(i.length<2)return l.error("Expected at least one argument.");var c=i[1];if(!Array.isArray(c)&&typeof c=="object")return l.error("First argument must be an image or text section.");for(var _=[],x=!1,w=1;w<=i.length-1;++w){var T=i[w];if(x&&typeof T=="object"&&!Array.isArray(T)){x=!1;var $=null;if(T["font-scale"]&&!($=l.parse(T["font-scale"],1,At)))return null;var D=null;if(T["text-font"]&&!(D=l.parse(T["text-font"],1,Sn(fs))))return null;var V=null;if(T["text-color"]&&!(V=l.parse(T["text-color"],1,is)))return null;var Z=_[_.length-1];Z.scale=$,Z.font=D,Z.textColor=V}else{var K=l.parse(i[w],1,hs);if(!K)return null;var le=K.type.kind;if(le!=="string"&&le!=="value"&&le!=="null"&&le!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");x=!0,_.push({content:K,scale:null,font:null,textColor:null})}}return new Jo(_)},Jo.prototype.evaluate=function(i){return new vi(this.sections.map(function(l){var c=l.content.evaluate(i);return Pr(c)===hn?new vd("",c,null,null,null):new vd(bd(c),null,l.scale?l.scale.evaluate(i):null,l.font?l.font.evaluate(i).join(","):null,l.textColor?l.textColor.evaluate(i):null)}))},Jo.prototype.eachChild=function(i){for(var l=0,c=this.sections;l<c.length;l+=1){var _=c[l];i(_.content),_.scale&&i(_.scale),_.font&&i(_.font),_.textColor&&i(_.textColor)}},Jo.prototype.outputDefined=function(){return!1},Jo.prototype.serialize=function(){for(var i=["format"],l=0,c=this.sections;l<c.length;l+=1){var _=c[l];i.push(_.content.serialize());var x={};_.scale&&(x["font-scale"]=_.scale.serialize()),_.font&&(x["text-font"]=_.font.serialize()),_.textColor&&(x["text-color"]=_.textColor.serialize()),i.push(x)}return i};var Co=function(i){this.type=hn,this.input=i};Co.parse=function(i,l){if(i.length!==2)return l.error("Expected two arguments.");var c=l.parse(i[1],1,fs);return c?new Co(c):l.error("No image name provided.")},Co.prototype.evaluate=function(i){var l=this.input.evaluate(i),c=to.fromString(l);return c&&i.availableImages&&(c.available=i.availableImages.indexOf(l)>-1),c},Co.prototype.eachChild=function(i){i(this.input)},Co.prototype.outputDefined=function(){return!1},Co.prototype.serialize=function(){return["image",this.input.serialize()]};var Ph={"to-boolean":ns,"to-color":is,"to-number":At,"to-string":fs},Qo=function(i,l){this.type=i,this.args=l};Qo.parse=function(i,l){if(i.length<2)return l.error("Expected at least one argument.");var c=i[0];if((c==="to-boolean"||c==="to-string")&&i.length!==2)return l.error("Expected one argument.");for(var _=Ph[c],x=[],w=1;w<i.length;w++){var T=l.parse(i[w],w,hs);if(!T)return null;x.push(T)}return new Qo(_,x)},Qo.prototype.evaluate=function(i){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(i));if(this.type.kind==="color"){for(var l,c,_=0,x=this.args;_<x.length;_+=1){if(c=null,(l=x[_].evaluate(i))instanceof On)return l;if(typeof l=="string"){var w=i.parseColor(l);if(w)return w}else if(Array.isArray(l)&&!(c=l.length<3||l.length>4?"Invalid rbga value "+JSON.stringify(l)+": expected an array containing either three or four numeric values.":kh(l[0],l[1],l[2],l[3])))return new On(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new Zr(c||"Could not parse color from value '"+(typeof l=="string"?l:String(JSON.stringify(l)))+"'")}if(this.type.kind==="number"){for(var T=null,$=0,D=this.args;$<D.length;$+=1){if((T=D[$].evaluate(i))===null)return 0;var V=Number(T);if(!isNaN(V))return V}throw new Zr("Could not convert "+JSON.stringify(T)+" to number.")}return this.type.kind==="formatted"?vi.fromString(bd(this.args[0].evaluate(i))):this.type.kind==="resolvedImage"?to.fromString(bd(this.args[0].evaluate(i))):bd(this.args[0].evaluate(i))},Qo.prototype.eachChild=function(i){this.args.forEach(i)},Qo.prototype.outputDefined=function(){return this.args.every(function(i){return i.outputDefined()})},Qo.prototype.serialize=function(){if(this.type.kind==="formatted")return new Jo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Co(this.args[0]).serialize();var i=["to-"+this.type.kind];return this.eachChild(function(l){i.push(l.serialize())}),i};var Lm=["Unknown","Point","LineString","Polygon"],Ta=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Ta.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Ta.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Lm[this.feature.type]:this.feature.type:null},Ta.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Ta.prototype.canonicalID=function(){return this.canonical},Ta.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Ta.prototype.parseColor=function(i){var l=this._parseColorCache[i];return l||(l=this._parseColorCache[i]=On.parse(i)),l};var fi=function(i,l,c,_){this.name=i,this.type=l,this._evaluate=c,this.args=_};fi.prototype.evaluate=function(i){return this._evaluate(i,this.args)},fi.prototype.eachChild=function(i){this.args.forEach(i)},fi.prototype.outputDefined=function(){return!1},fi.prototype.serialize=function(){return[this.name].concat(this.args.map(function(i){return i.serialize()}))},fi.parse=function(i,l){var c,_=i[0],x=fi.definitions[_];if(!x)return l.error('Unknown expression "'+_+'". If you wanted a literal array, use ["literal", [...]].',0);for(var w=Array.isArray(x)?x[0]:x.type,T=Array.isArray(x)?[[x[1],x[2]]]:x.overloads,$=T.filter(function(Ms){var us=Ms[0];return!Array.isArray(us)||us.length===i.length-1}),D=null,V=0,Z=$;V<Z.length;V+=1){var K=Z[V],le=K[0],_e=K[1];D=new Wl(l.registry,l.path,null,l.scope);for(var Oe=[],Be=!1,Xe=1;Xe<i.length;Xe++){var He=i[Xe],lt=Array.isArray(le)?le[Xe-1]:le.type,ft=D.parse(He,1+Oe.length,lt);if(!ft){Be=!0;break}Oe.push(ft)}if(!Be)if(Array.isArray(le)&&le.length!==Oe.length)D.error("Expected "+le.length+" arguments, but found "+Oe.length+" instead.");else{for(var yt=0;yt<Oe.length;yt++){var xt=Array.isArray(le)?le[yt]:le.type,Pt=Oe[yt];D.concat(yt+1).checkSubtype(xt,Pt.type)}if(D.errors.length===0)return new fi(_,w,_e,Oe)}}if($.length===1)(c=l.errors).push.apply(c,D.errors);else{for(var Yt=($.length?$:T).map(function(Ms){var us;return us=Ms[0],Array.isArray(us)?"("+us.map(bn).join(", ")+")":"("+bn(us.type)+"...)"}).join(" | "),Qt=[],Is=1;Is<i.length;Is++){var ls=l.parse(i[Is],1+Qt.length);if(!ls)return null;Qt.push(bn(ls.type))}l.error("Expected arguments of type "+Yt+", but found ("+Qt.join(", ")+") instead.")}return null},fi.register=function(i,l){for(var c in fi.definitions=l,l)i[c]=fi};var fo=function(i,l,c){this.type=mn,this.locale=c,this.caseSensitive=i,this.diacriticSensitive=l};function Bi(i,l){i[0]=Math.min(i[0],l[0]),i[1]=Math.min(i[1],l[1]),i[2]=Math.max(i[2],l[0]),i[3]=Math.max(i[3],l[1])}function jl(i,l){return!(i[0]<=l[0]||i[2]>=l[2]||i[1]<=l[1]||i[3]>=l[3])}function Hg(i,l){var c=(180+i[0])/360,_=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,x=Math.pow(2,l.z);return[Math.round(c*x*8192),Math.round(_*x*8192)]}function Nm(i,l,c){return l[1]>i[1]!=c[1]>i[1]&&i[0]<(c[0]-l[0])*(i[1]-l[1])/(c[1]-l[1])+l[0]}function Rh(i,l){for(var c,_,x,w,T,$,D,V=!1,Z=0,K=l.length;Z<K;Z++)for(var le=l[Z],_e=0,Oe=le.length;_e<Oe-1;_e++){if((w=(c=i)[0]-(_=le[_e])[0])*(D=c[1]-(x=le[_e+1])[1])-($=c[0]-x[0])*(T=c[1]-_[1])==0&&w*$<=0&&T*D<=0)return!1;Nm(i,le[_e],le[_e+1])&&(V=!V)}return V}function Dm(i,l){for(var c=0;c<l.length;c++)if(Rh(i,l[c]))return!0;return!1}function nf(i,l,c,_){var x=_[0]-c[0],w=_[1]-c[1],T=(i[0]-c[0])*w-x*(i[1]-c[1]),$=(l[0]-c[0])*w-x*(l[1]-c[1]);return T>0&&$<0||T<0&&$>0}function Gg(i,l,c){for(var _=0,x=c;_<x.length;_+=1)for(var w=x[_],T=0;T<w.length-1;++T)if((K=[(Z=w[T+1])[0]-(V=w[T])[0],Z[1]-V[1]])[0]*(le=[(D=l)[0]-($=i)[0],D[1]-$[1]])[1]-K[1]*le[0]!=0&&nf($,D,V,Z)&&nf(V,Z,$,D))return!0;var $,D,V,Z,K,le;return!1}function Bm(i,l){for(var c=0;c<i.length;++c)if(!Rh(i[c],l))return!1;for(var _=0;_<i.length-1;++_)if(Gg(i[_],i[_+1],l))return!1;return!0}function Fm(i,l){for(var c=0;c<l.length;c++)if(Bm(i,l[c]))return!0;return!1}function jc(i,l,c){for(var _=[],x=0;x<i.length;x++){for(var w=[],T=0;T<i[x].length;T++){var $=Hg(i[x][T],c);Bi(l,$),w.push($)}_.push(w)}return _}function rf(i,l,c){for(var _=[],x=0;x<i.length;x++){var w=jc(i[x],l,c);_.push(w)}return _}function xd(i,l,c,_){if(i[0]<c[0]||i[0]>c[2]){var x=.5*_,w=i[0]-c[0]>x?-_:c[0]-i[0]>x?_:0;w===0&&(w=i[0]-c[2]>x?-_:c[2]-i[0]>x?_:0),i[0]+=w}Bi(l,i)}function zm(i,l,c,_){for(var x=8192*Math.pow(2,_.z),w=[8192*_.x,8192*_.y],T=[],$=0,D=i;$<D.length;$+=1)for(var V=0,Z=D[$];V<Z.length;V+=1){var K=Z[V],le=[K.x+w[0],K.y+w[1]];xd(le,l,c,x),T.push(le)}return T}function $h(i,l,c,_){for(var x,w=8192*Math.pow(2,_.z),T=[8192*_.x,8192*_.y],$=[],D=0,V=i;D<V.length;D+=1){for(var Z=[],K=0,le=V[D];K<le.length;K+=1){var _e=le[K],Oe=[_e.x+T[0],_e.y+T[1]];Bi(l,Oe),Z.push(Oe)}$.push(Z)}if(l[2]-l[0]<=w/2){(x=l)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(var Be=0,Xe=$;Be<Xe.length;Be+=1)for(var He=0,lt=Xe[Be];He<lt.length;He+=1)xd(lt[He],l,c,w)}return $}fo.parse=function(i,l){if(i.length!==2)return l.error("Expected one argument.");var c=i[1];if(typeof c!="object"||Array.isArray(c))return l.error("Collator options argument must be an object.");var _=l.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,ns);if(!_)return null;var x=l.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,ns);if(!x)return null;var w=null;return c.locale&&!(w=l.parse(c.locale,1,fs))?null:new fo(_,x,w)},fo.prototype.evaluate=function(i){return new po(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)},fo.prototype.eachChild=function(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)},fo.prototype.outputDefined=function(){return!1},fo.prototype.serialize=function(){var i={};return i["case-sensitive"]=this.caseSensitive.serialize(),i["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(i.locale=this.locale.serialize()),["collator",i]};var Io=function(i,l){this.type=ns,this.geojson=i,this.geometries=l};function ql(i){if(i instanceof fi&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof Io)return!1;var l=!0;return i.eachChild(function(c){l&&!ql(c)&&(l=!1)}),l}function Hl(i){if(i instanceof fi&&i.name==="feature-state")return!1;var l=!0;return i.eachChild(function(c){l&&!Hl(c)&&(l=!1)}),l}function qc(i,l){if(i instanceof fi&&l.indexOf(i.name)>=0)return!1;var c=!0;return i.eachChild(function(_){c&&!qc(_,l)&&(c=!1)}),c}Io.parse=function(i,l){if(i.length!==2)return l.error("'within' expression requires exactly one argument, but found "+(i.length-1)+" instead.");if(Au(i[1])){var c=i[1];if(c.type==="FeatureCollection")for(var _=0;_<c.features.length;++_){var x=c.features[_].geometry.type;if(x==="Polygon"||x==="MultiPolygon")return new Io(c,c.features[_].geometry)}else if(c.type==="Feature"){var w=c.geometry.type;if(w==="Polygon"||w==="MultiPolygon")return new Io(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new Io(c,c)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Io.prototype.evaluate=function(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(l,c){var _=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],w=l.canonicalID();if(c.type==="Polygon"){var T=jc(c.coordinates,x,w),$=zm(l.geometry(),_,x,w);if(!jl(_,x))return!1;for(var D=0,V=$;D<V.length;D+=1)if(!Rh(V[D],T))return!1}if(c.type==="MultiPolygon"){var Z=rf(c.coordinates,x,w),K=zm(l.geometry(),_,x,w);if(!jl(_,x))return!1;for(var le=0,_e=K;le<_e.length;le+=1)if(!Dm(_e[le],Z))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(l,c){var _=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],w=l.canonicalID();if(c.type==="Polygon"){var T=jc(c.coordinates,x,w),$=$h(l.geometry(),_,x,w);if(!jl(_,x))return!1;for(var D=0,V=$;D<V.length;D+=1)if(!Bm(V[D],T))return!1}if(c.type==="MultiPolygon"){var Z=rf(c.coordinates,x,w),K=$h(l.geometry(),_,x,w);if(!jl(_,x))return!1;for(var le=0,_e=K;le<_e.length;le+=1)if(!Fm(_e[le],Z))return!1}return!0}(i,this.geometries)}return!1},Io.prototype.eachChild=function(){},Io.prototype.outputDefined=function(){return!0},Io.prototype.serialize=function(){return["within",this.geojson]};var Gl=function(i,l){this.type=l.type,this.name=i,this.boundExpression=l};Gl.parse=function(i,l){if(i.length!==2||typeof i[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");var c=i[1];return l.scope.has(c)?new Gl(c,l.scope.get(c)):l.error('Unknown variable "'+c+'". Make sure "'+c+'" has been bound in an enclosing "let" expression before using it.',1)},Gl.prototype.evaluate=function(i){return this.boundExpression.evaluate(i)},Gl.prototype.eachChild=function(){},Gl.prototype.outputDefined=function(){return!1},Gl.prototype.serialize=function(){return["var",this.name]};var Wl=function(i,l,c,_,x){l===void 0&&(l=[]),_===void 0&&(_=new xs),x===void 0&&(x=[]),this.registry=i,this.path=l,this.key=l.map(function(w){return"["+w+"]"}).join(""),this.scope=_,this.errors=x,this.expectedType=c};function pr(i,l){for(var c,_=i.length-1,x=0,w=_,T=0;x<=w;)if((c=i[T=Math.floor((x+w)/2)])<=l){if(T===_||l<i[T+1])return T;x=T+1}else{if(!(c>l))throw new Zr("Input is not a number.");w=T-1}return 0}Wl.prototype.parse=function(i,l,c,_,x){return x===void 0&&(x={}),l?this.concat(l,c,_)._parse(i,x):this._parse(i,x)},Wl.prototype._parse=function(i,l){function c(V,Z,K){return K==="assert"?new Sr(Z,[V]):K==="coerce"?new Qo(Z,[V]):V}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var _=i[0];if(typeof _!="string")return this.error("Expression name must be a string, but found "+typeof _+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var x=this.registry[_];if(x){var w=x.parse(i,this);if(!w)return null;if(this.expectedType){var T=this.expectedType,$=w.type;if(T.kind!=="string"&&T.kind!=="number"&&T.kind!=="boolean"&&T.kind!=="object"&&T.kind!=="array"||$.kind!=="value")if(T.kind!=="color"&&T.kind!=="formatted"&&T.kind!=="resolvedImage"||$.kind!=="value"&&$.kind!=="string"){if(this.checkSubtype(T,$))return null}else w=c(w,T,l.typeAnnotation||"coerce");else w=c(w,T,l.typeAnnotation||"assert")}if(!(w instanceof Di)&&w.type.kind!=="resolvedImage"&&function V(Z){if(Z instanceof Gl)return V(Z.boundExpression);if(Z instanceof fi&&Z.name==="error"||Z instanceof fo||Z instanceof Io)return!1;var K=Z instanceof Qo||Z instanceof Sr,le=!0;return Z.eachChild(function(_e){le=K?le&&V(_e):le&&_e instanceof Di}),!!le&&ql(Z)&&qc(Z,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(w)){var D=new Ta;try{w=new Di(w.type,w.evaluate(D))}catch(V){return this.error(V.message),null}}return w}return this.error('Unknown expression "'+_+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof i+" instead.")},Wl.prototype.concat=function(i,l,c){var _=typeof i=="number"?this.path.concat(i):this.path,x=c?this.scope.concat(c):this.scope;return new Wl(this.registry,_,l||null,x,this.errors)},Wl.prototype.error=function(i){for(var l=[],c=arguments.length-1;c-- >0;)l[c]=arguments[c+1];var _=""+this.key+l.map(function(x){return"["+x+"]"}).join("");this.errors.push(new Vt(_,i))},Wl.prototype.checkSubtype=function(i,l){var c=zn(i,l);return c&&this.error(c),c};var Cn=function(i,l,c){this.type=i,this.input=l,this.labels=[],this.outputs=[];for(var _=0,x=c;_<x.length;_+=1){var w=x[_],T=w[1];this.labels.push(w[0]),this.outputs.push(T)}};function Xr(i,l,c){return i*(1-c)+l*c}Cn.parse=function(i,l){if(i.length-1<4)return l.error("Expected at least 4 arguments, but found only "+(i.length-1)+".");if((i.length-1)%2!=0)return l.error("Expected an even number of arguments.");var c=l.parse(i[1],1,At);if(!c)return null;var _=[],x=null;l.expectedType&&l.expectedType.kind!=="value"&&(x=l.expectedType);for(var w=1;w<i.length;w+=2){var T=w===1?-1/0:i[w],$=i[w+1],D=w,V=w+1;if(typeof T!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(_.length&&_[_.length-1][0]>=T)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',D);var Z=l.parse($,V,x);if(!Z)return null;x=x||Z.type,_.push([T,Z])}return new Cn(x,c,_)},Cn.prototype.evaluate=function(i){var l=this.labels,c=this.outputs;if(l.length===1)return c[0].evaluate(i);var _=this.input.evaluate(i);if(_<=l[0])return c[0].evaluate(i);var x=l.length;return _>=l[x-1]?c[x-1].evaluate(i):c[pr(l,_)].evaluate(i)},Cn.prototype.eachChild=function(i){i(this.input);for(var l=0,c=this.outputs;l<c.length;l+=1)i(c[l])},Cn.prototype.outputDefined=function(){return this.outputs.every(function(i){return i.outputDefined()})},Cn.prototype.serialize=function(){for(var i=["step",this.input.serialize()],l=0;l<this.labels.length;l++)l>0&&i.push(this.labels[l]),i.push(this.outputs[l].serialize());return i};var Mu=Object.freeze({__proto__:null,number:Xr,color:function(i,l,c){return new On(Xr(i.r,l.r,c),Xr(i.g,l.g,c),Xr(i.b,l.b,c),Xr(i.a,l.a,c))},array:function(i,l,c){return i.map(function(_,x){return Xr(_,l[x],c)})}}),Um=6/29*3*(6/29),Wg=Math.PI/180,Yg=180/Math.PI;function of(i){return i>.008856451679035631?Math.pow(i,1/3):i/Um+4/29}function Oh(i){return i>6/29?i*i*i:Um*(i-4/29)}function af(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function bi(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Lh(i){var l=bi(i.r),c=bi(i.g),_=bi(i.b),x=of((.4124564*l+.3575761*c+.1804375*_)/.95047),w=of((.2126729*l+.7151522*c+.072175*_)/1);return{l:116*w-16,a:500*(x-w),b:200*(w-of((.0193339*l+.119192*c+.9503041*_)/1.08883)),alpha:i.a}}function Yl(i){var l=(i.l+16)/116,c=isNaN(i.a)?l:l+i.a/500,_=isNaN(i.b)?l:l-i.b/200;return l=1*Oh(l),c=.95047*Oh(c),_=1.08883*Oh(_),new On(af(3.2404542*c-1.5371385*l-.4985314*_),af(-.969266*c+1.8760108*l+.041556*_),af(.0556434*c-.2040259*l+1.0572252*_),i.alpha)}function Vm(i,l,c){var _=l-i;return i+c*(_>180||_<-180?_-360*Math.round(_/360):_)}var Hc={forward:Lh,reverse:Yl,interpolate:function(i,l,c){return{l:Xr(i.l,l.l,c),a:Xr(i.a,l.a,c),b:Xr(i.b,l.b,c),alpha:Xr(i.alpha,l.alpha,c)}}},so={forward:function(i){var l=Lh(i),c=l.l,_=l.a,x=l.b,w=Math.atan2(x,_)*Yg;return{h:w<0?w+360:w,c:Math.sqrt(_*_+x*x),l:c,alpha:i.a}},reverse:function(i){var l=i.h*Wg,c=i.c;return Yl({l:i.l,a:Math.cos(l)*c,b:Math.sin(l)*c,alpha:i.alpha})},interpolate:function(i,l,c){return{h:Vm(i.h,l.h,c),c:Xr(i.c,l.c,c),l:Xr(i.l,l.l,c),alpha:Xr(i.alpha,l.alpha,c)}}},lf=Object.freeze({__proto__:null,lab:Hc,hcl:so}),xi=function(i,l,c,_,x){this.type=i,this.operator=l,this.interpolation=c,this.input=_,this.labels=[],this.outputs=[];for(var w=0,T=x;w<T.length;w+=1){var $=T[w],D=$[1];this.labels.push($[0]),this.outputs.push(D)}};function Nh(i,l,c,_){var x=_-c,w=i-c;return x===0?0:l===1?w/x:(Math.pow(l,w)-1)/(Math.pow(l,x)-1)}xi.interpolationFactor=function(i,l,c,_){var x=0;if(i.name==="exponential")x=Nh(l,i.base,c,_);else if(i.name==="linear")x=Nh(l,1,c,_);else if(i.name==="cubic-bezier"){var w=i.controlPoints;x=new p(w[0],w[1],w[2],w[3]).solve(Nh(l,1,c,_))}return x},xi.parse=function(i,l){var c=i[0],_=i[1],x=i[2],w=i.slice(3);if(!Array.isArray(_)||_.length===0)return l.error("Expected an interpolation type expression.",1);if(_[0]==="linear")_={name:"linear"};else if(_[0]==="exponential"){var T=_[1];if(typeof T!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);_={name:"exponential",base:T}}else{if(_[0]!=="cubic-bezier")return l.error("Unknown interpolation type "+String(_[0]),1,0);var $=_.slice(1);if($.length!==4||$.some(function(Xe){return typeof Xe!="number"||Xe<0||Xe>1}))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);_={name:"cubic-bezier",controlPoints:$}}if(i.length-1<4)return l.error("Expected at least 4 arguments, but found only "+(i.length-1)+".");if((i.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(!(x=l.parse(x,2,At)))return null;var D=[],V=null;c==="interpolate-hcl"||c==="interpolate-lab"?V=is:l.expectedType&&l.expectedType.kind!=="value"&&(V=l.expectedType);for(var Z=0;Z<w.length;Z+=2){var K=w[Z],le=w[Z+1],_e=Z+3,Oe=Z+4;if(typeof K!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',_e);if(D.length&&D[D.length-1][0]>=K)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',_e);var Be=l.parse(le,Oe,V);if(!Be)return null;V=V||Be.type,D.push([K,Be])}return V.kind==="number"||V.kind==="color"||V.kind==="array"&&V.itemType.kind==="number"&&typeof V.N=="number"?new xi(V,c,_,x,D):l.error("Type "+bn(V)+" is not interpolatable.")},xi.prototype.evaluate=function(i){var l=this.labels,c=this.outputs;if(l.length===1)return c[0].evaluate(i);var _=this.input.evaluate(i);if(_<=l[0])return c[0].evaluate(i);var x=l.length;if(_>=l[x-1])return c[x-1].evaluate(i);var w=pr(l,_),T=xi.interpolationFactor(this.interpolation,_,l[w],l[w+1]),$=c[w].evaluate(i),D=c[w+1].evaluate(i);return this.operator==="interpolate"?Mu[this.type.kind.toLowerCase()]($,D,T):this.operator==="interpolate-hcl"?so.reverse(so.interpolate(so.forward($),so.forward(D),T)):Hc.reverse(Hc.interpolate(Hc.forward($),Hc.forward(D),T))},xi.prototype.eachChild=function(i){i(this.input);for(var l=0,c=this.outputs;l<c.length;l+=1)i(c[l])},xi.prototype.outputDefined=function(){return this.outputs.every(function(i){return i.outputDefined()})},xi.prototype.serialize=function(){var i;i=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var l=[this.operator,i,this.input.serialize()],c=0;c<this.labels.length;c++)l.push(this.labels[c],this.outputs[c].serialize());return l};var hl=function(i,l){this.type=i,this.args=l};hl.parse=function(i,l){if(i.length<2)return l.error("Expectected at least one argument.");var c=null,_=l.expectedType;_&&_.kind!=="value"&&(c=_);for(var x=[],w=0,T=i.slice(1);w<T.length;w+=1){var $=l.parse(T[w],1+x.length,c,void 0,{typeAnnotation:"omit"});if(!$)return null;c=c||$.type,x.push($)}var D=_&&x.some(function(V){return zn(_,V.type)});return new hl(D?hs:c,x)},hl.prototype.evaluate=function(i){for(var l,c=null,_=0,x=0,w=this.args;x<w.length&&(_++,(c=w[x].evaluate(i))&&c instanceof to&&!c.available&&(l||(l=c.name),c=null,_===this.args.length&&(c=l)),c===null);x+=1);return c},hl.prototype.eachChild=function(i){this.args.forEach(i)},hl.prototype.outputDefined=function(){return this.args.every(function(i){return i.outputDefined()})},hl.prototype.serialize=function(){var i=["coalesce"];return this.eachChild(function(l){i.push(l.serialize())}),i};var pl=function(i,l){this.type=l.type,this.bindings=[].concat(i),this.result=l};pl.prototype.evaluate=function(i){return this.result.evaluate(i)},pl.prototype.eachChild=function(i){for(var l=0,c=this.bindings;l<c.length;l+=1)i(c[l][1]);i(this.result)},pl.parse=function(i,l){if(i.length<4)return l.error("Expected at least 3 arguments, but found "+(i.length-1)+" instead.");for(var c=[],_=1;_<i.length-1;_+=2){var x=i[_];if(typeof x!="string")return l.error("Expected string, but found "+typeof x+" instead.",_);if(/[^a-zA-Z0-9_]/.test(x))return l.error("Variable names must contain only alphanumeric characters or '_'.",_);var w=l.parse(i[_+1],_+1);if(!w)return null;c.push([x,w])}var T=l.parse(i[i.length-1],i.length-1,l.expectedType,c);return T?new pl(c,T):null},pl.prototype.outputDefined=function(){return this.result.outputDefined()},pl.prototype.serialize=function(){for(var i=["let"],l=0,c=this.bindings;l<c.length;l+=1){var _=c[l];i.push(_[0],_[1].serialize())}return i.push(this.result.serialize()),i};var Zl=function(i,l,c){this.type=i,this.index=l,this.input=c};Zl.parse=function(i,l){if(i.length!==3)return l.error("Expected 2 arguments, but found "+(i.length-1)+" instead.");var c=l.parse(i[1],1,At),_=l.parse(i[2],2,Sn(l.expectedType||hs));return c&&_?new Zl(_.type.itemType,c,_):null},Zl.prototype.evaluate=function(i){var l=this.index.evaluate(i),c=this.input.evaluate(i);if(l<0)throw new Zr("Array index out of bounds: "+l+" < 0.");if(l>=c.length)throw new Zr("Array index out of bounds: "+l+" > "+(c.length-1)+".");if(l!==Math.floor(l))throw new Zr("Array index must be an integer, but found "+l+" instead.");return c[l]},Zl.prototype.eachChild=function(i){i(this.index),i(this.input)},Zl.prototype.outputDefined=function(){return!1},Zl.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var wi=function(i,l){this.type=ns,this.needle=i,this.haystack=l};wi.parse=function(i,l){if(i.length!==3)return l.error("Expected 2 arguments, but found "+(i.length-1)+" instead.");var c=l.parse(i[1],1,hs),_=l.parse(i[2],2,hs);return c&&_?Br(c.type,[ns,fs,At,ms,hs])?new wi(c,_):l.error("Expected first argument to be of type boolean, string, number or null, but found "+bn(c.type)+" instead"):null},wi.prototype.evaluate=function(i){var l=this.needle.evaluate(i),c=this.haystack.evaluate(i);if(!c)return!1;if(!Hn(l,["boolean","string","number","null"]))throw new Zr("Expected first argument to be of type boolean, string, number or null, but found "+bn(Pr(l))+" instead.");if(!Hn(c,["string","array"]))throw new Zr("Expected second argument to be of type array or string, but found "+bn(Pr(c))+" instead.");return c.indexOf(l)>=0},wi.prototype.eachChild=function(i){i(this.needle),i(this.haystack)},wi.prototype.outputDefined=function(){return!0},wi.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Xl=function(i,l,c){this.type=At,this.needle=i,this.haystack=l,this.fromIndex=c};Xl.parse=function(i,l){if(i.length<=2||i.length>=5)return l.error("Expected 3 or 4 arguments, but found "+(i.length-1)+" instead.");var c=l.parse(i[1],1,hs),_=l.parse(i[2],2,hs);if(!c||!_)return null;if(!Br(c.type,[ns,fs,At,ms,hs]))return l.error("Expected first argument to be of type boolean, string, number or null, but found "+bn(c.type)+" instead");if(i.length===4){var x=l.parse(i[3],3,At);return x?new Xl(c,_,x):null}return new Xl(c,_)},Xl.prototype.evaluate=function(i){var l=this.needle.evaluate(i),c=this.haystack.evaluate(i);if(!Hn(l,["boolean","string","number","null"]))throw new Zr("Expected first argument to be of type boolean, string, number or null, but found "+bn(Pr(l))+" instead.");if(!Hn(c,["string","array"]))throw new Zr("Expected second argument to be of type array or string, but found "+bn(Pr(c))+" instead.");if(this.fromIndex){var _=this.fromIndex.evaluate(i);return c.indexOf(l,_)}return c.indexOf(l)},Xl.prototype.eachChild=function(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)},Xl.prototype.outputDefined=function(){return!1},Xl.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var i=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),i]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var ki=function(i,l,c,_,x,w){this.inputType=i,this.type=l,this.input=c,this.cases=_,this.outputs=x,this.otherwise=w};ki.parse=function(i,l){if(i.length<5)return l.error("Expected at least 4 arguments, but found only "+(i.length-1)+".");if(i.length%2!=1)return l.error("Expected an even number of arguments.");var c,_;l.expectedType&&l.expectedType.kind!=="value"&&(_=l.expectedType);for(var x={},w=[],T=2;T<i.length-1;T+=2){var $=i[T],D=i[T+1];Array.isArray($)||($=[$]);var V=l.concat(T);if($.length===0)return V.error("Expected at least one branch label.");for(var Z=0,K=$;Z<K.length;Z+=1){var le=K[Z];if(typeof le!="number"&&typeof le!="string")return V.error("Branch labels must be numbers or strings.");if(typeof le=="number"&&Math.abs(le)>Number.MAX_SAFE_INTEGER)return V.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof le=="number"&&Math.floor(le)!==le)return V.error("Numeric branch labels must be integer values.");if(c){if(V.checkSubtype(c,Pr(le)))return null}else c=Pr(le);if(x[String(le)]!==void 0)return V.error("Branch labels must be unique.");x[String(le)]=w.length}var _e=l.parse(D,T,_);if(!_e)return null;_=_||_e.type,w.push(_e)}var Oe=l.parse(i[1],1,hs);if(!Oe)return null;var Be=l.parse(i[i.length-1],i.length-1,_);return Be?Oe.type.kind!=="value"&&l.concat(1).checkSubtype(c,Oe.type)?null:new ki(c,_,Oe,x,w,Be):null},ki.prototype.evaluate=function(i){var l=this.input.evaluate(i);return(Pr(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(i)},ki.prototype.eachChild=function(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)},ki.prototype.outputDefined=function(){return this.outputs.every(function(i){return i.outputDefined()})&&this.otherwise.outputDefined()},ki.prototype.serialize=function(){for(var i=this,l=["match",this.input.serialize()],c=[],_={},x=0,w=Object.keys(this.cases).sort();x<w.length;x+=1){var T=w[x];(K=_[this.cases[T]])===void 0?(_[this.cases[T]]=c.length,c.push([this.cases[T],[T]])):c[K][1].push(T)}for(var $=function(_e){return i.inputType.kind==="number"?Number(_e):_e},D=0,V=c;D<V.length;D+=1){var Z=V[D],K=Z[0],le=Z[1];l.push(le.length===1?$(le[0]):le.map($)),l.push(this.outputs[outputIndex$1].serialize())}return l.push(this.otherwise.serialize()),l};var Gc=function(i,l,c){this.type=i,this.branches=l,this.otherwise=c};Gc.parse=function(i,l){if(i.length<4)return l.error("Expected at least 3 arguments, but found only "+(i.length-1)+".");if(i.length%2!=0)return l.error("Expected an odd number of arguments.");var c;l.expectedType&&l.expectedType.kind!=="value"&&(c=l.expectedType);for(var _=[],x=1;x<i.length-1;x+=2){var w=l.parse(i[x],x,ns);if(!w)return null;var T=l.parse(i[x+1],x+1,c);if(!T)return null;_.push([w,T]),c=c||T.type}var $=l.parse(i[i.length-1],i.length-1,c);return $?new Gc(c,_,$):null},Gc.prototype.evaluate=function(i){for(var l=0,c=this.branches;l<c.length;l+=1){var _=c[l],x=_[1];if(_[0].evaluate(i))return x.evaluate(i)}return this.otherwise.evaluate(i)},Gc.prototype.eachChild=function(i){for(var l=0,c=this.branches;l<c.length;l+=1){var _=c[l],x=_[1];i(_[0]),i(x)}i(this.otherwise)},Gc.prototype.outputDefined=function(){return this.branches.every(function(i){return i[1].outputDefined()})&&this.otherwise.outputDefined()},Gc.prototype.serialize=function(){var i=["case"];return this.eachChild(function(l){i.push(l.serialize())}),i};var fl=function(i,l,c,_){this.type=i,this.input=l,this.beginIndex=c,this.endIndex=_};function ml(i,l){return i==="=="||i==="!="?l.kind==="boolean"||l.kind==="string"||l.kind==="number"||l.kind==="null"||l.kind==="value":l.kind==="string"||l.kind==="number"||l.kind==="value"}function wd(i,l,c,_){return _.compare(l,c)===0}function Gn(i,l,c){var _=i!=="=="&&i!=="!=";return function(){function x(w,T,$){this.type=ns,this.lhs=w,this.rhs=T,this.collator=$,this.hasUntypedArgument=w.type.kind==="value"||T.type.kind==="value"}return x.parse=function(w,T){if(w.length!==3&&w.length!==4)return T.error("Expected two or three arguments.");var $=w[0],D=T.parse(w[1],1,hs);if(!D)return null;if(!ml($,D.type))return T.concat(1).error('"'+$+`" comparisons are not supported for type '`+bn(D.type)+"'.");var V=T.parse(w[2],2,hs);if(!V)return null;if(!ml($,V.type))return T.concat(2).error('"'+$+`" comparisons are not supported for type '`+bn(V.type)+"'.");if(D.type.kind!==V.type.kind&&D.type.kind!=="value"&&V.type.kind!=="value")return T.error("Cannot compare types '"+bn(D.type)+"' and '"+bn(V.type)+"'.");_&&(D.type.kind==="value"&&V.type.kind!=="value"?D=new Sr(V.type,[D]):D.type.kind!=="value"&&V.type.kind==="value"&&(V=new Sr(D.type,[V])));var Z=null;if(w.length===4){if(D.type.kind!=="string"&&V.type.kind!=="string"&&D.type.kind!=="value"&&V.type.kind!=="value")return T.error("Cannot use collator to compare non-string types.");if(!(Z=T.parse(w[3],3,mn)))return null}return new x(D,V,Z)},x.prototype.evaluate=function(w){var T=this.lhs.evaluate(w),$=this.rhs.evaluate(w);if(_&&this.hasUntypedArgument){var D=Pr(T),V=Pr($);if(D.kind!==V.kind||D.kind!=="string"&&D.kind!=="number")throw new Zr('Expected arguments for "'+i+'" to be (string, string) or (number, number), but found ('+D.kind+", "+V.kind+") instead.")}if(this.collator&&!_&&this.hasUntypedArgument){var Z=Pr(T),K=Pr($);if(Z.kind!=="string"||K.kind!=="string")return l(w,T,$)}return this.collator?c(w,T,$,this.collator.evaluate(w)):l(w,T,$)},x.prototype.eachChild=function(w){w(this.lhs),w(this.rhs),this.collator&&w(this.collator)},x.prototype.outputDefined=function(){return!0},x.prototype.serialize=function(){var w=[i];return this.eachChild(function(T){w.push(T.serialize())}),w},x}()}fl.parse=function(i,l){if(i.length<=2||i.length>=5)return l.error("Expected 3 or 4 arguments, but found "+(i.length-1)+" instead.");var c=l.parse(i[1],1,hs),_=l.parse(i[2],2,At);if(!c||!_)return null;if(!Br(c.type,[Sn(hs),fs,hs]))return l.error("Expected first argument to be of type array or string, but found "+bn(c.type)+" instead");if(i.length===4){var x=l.parse(i[3],3,At);return x?new fl(c.type,c,_,x):null}return new fl(c.type,c,_)},fl.prototype.evaluate=function(i){var l=this.input.evaluate(i),c=this.beginIndex.evaluate(i);if(!Hn(l,["string","array"]))throw new Zr("Expected first argument to be of type array or string, but found "+bn(Pr(l))+" instead.");if(this.endIndex){var _=this.endIndex.evaluate(i);return l.slice(c,_)}return l.slice(c)},fl.prototype.eachChild=function(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)},fl.prototype.outputDefined=function(){return!1},fl.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var i=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),i]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Fr=Gn("==",function(i,l,c){return l===c},wd),Aa=Gn("!=",function(i,l,c){return l!==c},function(i,l,c,_){return!wd(0,l,c,_)}),Dh=Gn("<",function(i,l,c){return l<c},function(i,l,c,_){return _.compare(l,c)<0}),jm=Gn(">",function(i,l,c){return l>c},function(i,l,c,_){return _.compare(l,c)>0}),Bh=Gn("<=",function(i,l,c){return l<=c},function(i,l,c,_){return _.compare(l,c)<=0}),qm=Gn(">=",function(i,l,c){return l>=c},function(i,l,c,_){return _.compare(l,c)>=0}),Wc=function(i,l,c,_,x){this.type=fs,this.number=i,this.locale=l,this.currency=c,this.minFractionDigits=_,this.maxFractionDigits=x};Wc.parse=function(i,l){if(i.length!==3)return l.error("Expected two arguments.");var c=l.parse(i[1],1,At);if(!c)return null;var _=i[2];if(typeof _!="object"||Array.isArray(_))return l.error("NumberFormat options argument must be an object.");var x=null;if(_.locale&&!(x=l.parse(_.locale,1,fs)))return null;var w=null;if(_.currency&&!(w=l.parse(_.currency,1,fs)))return null;var T=null;if(_["min-fraction-digits"]&&!(T=l.parse(_["min-fraction-digits"],1,At)))return null;var $=null;return _["max-fraction-digits"]&&!($=l.parse(_["max-fraction-digits"],1,At))?null:new Wc(c,x,w,T,$)},Wc.prototype.evaluate=function(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))},Wc.prototype.eachChild=function(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)},Wc.prototype.outputDefined=function(){return!1},Wc.prototype.serialize=function(){var i={};return this.locale&&(i.locale=this.locale.serialize()),this.currency&&(i.currency=this.currency.serialize()),this.minFractionDigits&&(i["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(i["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),i]};var Kl=function(i){this.type=At,this.input=i};Kl.parse=function(i,l){if(i.length!==2)return l.error("Expected 1 argument, but found "+(i.length-1)+" instead.");var c=l.parse(i[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?l.error("Expected argument of type string or array, but found "+bn(c.type)+" instead."):new Kl(c):null},Kl.prototype.evaluate=function(i){var l=this.input.evaluate(i);if(typeof l=="string"||Array.isArray(l))return l.length;throw new Zr("Expected value to be of type string or array, but found "+bn(Pr(l))+" instead.")},Kl.prototype.eachChild=function(i){i(this.input)},Kl.prototype.outputDefined=function(){return!1},Kl.prototype.serialize=function(){var i=["length"];return this.eachChild(function(l){i.push(l.serialize())}),i};var Jl={"==":Fr,"!=":Aa,">":jm,"<":Dh,">=":qm,"<=":Bh,array:Sr,at:Zl,boolean:Sr,case:Gc,coalesce:hl,collator:fo,format:Jo,image:Co,in:wi,"index-of":Xl,interpolate:xi,"interpolate-hcl":xi,"interpolate-lab":xi,length:Kl,let:pl,literal:Di,match:ki,number:Sr,"number-format":Wc,object:Sr,slice:fl,step:Cn,string:Sr,"to-boolean":Qo,"to-color":Qo,"to-number":Qo,"to-string":Qo,var:Gl,within:Io};function Sd(i,l){var c=l[0],_=l[1],x=l[2],w=l[3];c=c.evaluate(i),_=_.evaluate(i),x=x.evaluate(i);var T=w?w.evaluate(i):1,$=kh(c,_,x,T);if($)throw new Zr($);return new On(c/255*T,_/255*T,x/255*T,T)}function Yc(i,l){return i in l}function cf(i,l){var c=l[i];return c===void 0?null:c}function Ql(i){return{type:i}}function uf(i){return{result:"success",value:i}}function _l(i){return{result:"error",value:i}}function gl(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function df(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function Cd(i){return!!i.expression&&i.expression.interpolated}function tr(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function Eu(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function Zg(i){return i}function Zc(i,l,c){return i!==void 0?i:l!==void 0?l:c!==void 0?c:void 0}function To(i,l,c,_,x){return Zc(typeof c===x?_[c]:void 0,i.default,l.default)}function hf(i,l,c){if(tr(c)!=="number")return Zc(i.default,l.default);var _=i.stops.length;if(_===1||c<=i.stops[0][0])return i.stops[0][1];if(c>=i.stops[_-1][0])return i.stops[_-1][1];var x=pr(i.stops.map(function(w){return w[0]}),c);return i.stops[x][1]}function ku(i,l,c){var _=i.base!==void 0?i.base:1;if(tr(c)!=="number")return Zc(i.default,l.default);var x=i.stops.length;if(x===1||c<=i.stops[0][0])return i.stops[0][1];if(c>=i.stops[x-1][0])return i.stops[x-1][1];var w=pr(i.stops.map(function(K){return K[0]}),c),T=function(K,le,_e,Oe){var Be=Oe-_e,Xe=K-_e;return Be===0?0:le===1?Xe/Be:(Math.pow(le,Xe)-1)/(Math.pow(le,Be)-1)}(c,_,i.stops[w][0],i.stops[w+1][0]),$=i.stops[w][1],D=i.stops[w+1][1],V=Mu[l.type]||Zg;if(i.colorSpace&&i.colorSpace!=="rgb"){var Z=lf[i.colorSpace];V=function(K,le){return Z.reverse(Z.interpolate(Z.forward(K),Z.forward(le),T))}}return typeof $.evaluate=="function"?{evaluate:function(){for(var K=[],le=arguments.length;le--;)K[le]=arguments[le];var _e=$.evaluate.apply(void 0,K),Oe=D.evaluate.apply(void 0,K);if(_e!==void 0&&Oe!==void 0)return V(_e,Oe,T)}}:V($,D,T)}function Id(i,l,c){return l.type==="color"?c=On.parse(c):l.type==="formatted"?c=vi.fromString(c.toString()):l.type==="resolvedImage"?c=to.fromString(c.toString()):tr(c)===l.type||l.type==="enum"&&l.values[c]||(c=void 0),Zc(c,i.default,l.default)}fi.register(Jl,{error:[{kind:"error"},[fs],function(i,l){throw new Zr(l[0].evaluate(i))}],typeof:[fs,[hs],function(i,l){return bn(Pr(l[0].evaluate(i)))}],"to-rgba":[Sn(At,4),[is],function(i,l){return l[0].evaluate(i).toArray()}],rgb:[is,[At,At,At],Sd],rgba:[is,[At,At,At,At],Sd],has:{type:ns,overloads:[[[fs],function(i,l){return Yc(l[0].evaluate(i),i.properties())}],[[fs,rn],function(i,l){var c=l[1];return Yc(l[0].evaluate(i),c.evaluate(i))}]]},get:{type:hs,overloads:[[[fs],function(i,l){return cf(l[0].evaluate(i),i.properties())}],[[fs,rn],function(i,l){var c=l[1];return cf(l[0].evaluate(i),c.evaluate(i))}]]},"feature-state":[hs,[fs],function(i,l){return cf(l[0].evaluate(i),i.featureState||{})}],properties:[rn,[],function(i){return i.properties()}],"geometry-type":[fs,[],function(i){return i.geometryType()}],id:[hs,[],function(i){return i.id()}],zoom:[At,[],function(i){return i.globals.zoom}],"heatmap-density":[At,[],function(i){return i.globals.heatmapDensity||0}],"line-progress":[At,[],function(i){return i.globals.lineProgress||0}],accumulated:[hs,[],function(i){return i.globals.accumulated===void 0?null:i.globals.accumulated}],"+":[At,Ql(At),function(i,l){for(var c=0,_=0,x=l;_<x.length;_+=1)c+=x[_].evaluate(i);return c}],"*":[At,Ql(At),function(i,l){for(var c=1,_=0,x=l;_<x.length;_+=1)c*=x[_].evaluate(i);return c}],"-":{type:At,overloads:[[[At,At],function(i,l){var c=l[1];return l[0].evaluate(i)-c.evaluate(i)}],[[At],function(i,l){return-l[0].evaluate(i)}]]},"/":[At,[At,At],function(i,l){var c=l[1];return l[0].evaluate(i)/c.evaluate(i)}],"%":[At,[At,At],function(i,l){var c=l[1];return l[0].evaluate(i)%c.evaluate(i)}],ln2:[At,[],function(){return Math.LN2}],pi:[At,[],function(){return Math.PI}],e:[At,[],function(){return Math.E}],"^":[At,[At,At],function(i,l){var c=l[1];return Math.pow(l[0].evaluate(i),c.evaluate(i))}],sqrt:[At,[At],function(i,l){return Math.sqrt(l[0].evaluate(i))}],log10:[At,[At],function(i,l){return Math.log(l[0].evaluate(i))/Math.LN10}],ln:[At,[At],function(i,l){return Math.log(l[0].evaluate(i))}],log2:[At,[At],function(i,l){return Math.log(l[0].evaluate(i))/Math.LN2}],sin:[At,[At],function(i,l){return Math.sin(l[0].evaluate(i))}],cos:[At,[At],function(i,l){return Math.cos(l[0].evaluate(i))}],tan:[At,[At],function(i,l){return Math.tan(l[0].evaluate(i))}],asin:[At,[At],function(i,l){return Math.asin(l[0].evaluate(i))}],acos:[At,[At],function(i,l){return Math.acos(l[0].evaluate(i))}],atan:[At,[At],function(i,l){return Math.atan(l[0].evaluate(i))}],min:[At,Ql(At),function(i,l){return Math.min.apply(Math,l.map(function(c){return c.evaluate(i)}))}],max:[At,Ql(At),function(i,l){return Math.max.apply(Math,l.map(function(c){return c.evaluate(i)}))}],abs:[At,[At],function(i,l){return Math.abs(l[0].evaluate(i))}],round:[At,[At],function(i,l){var c=l[0].evaluate(i);return c<0?-Math.round(-c):Math.round(c)}],floor:[At,[At],function(i,l){return Math.floor(l[0].evaluate(i))}],ceil:[At,[At],function(i,l){return Math.ceil(l[0].evaluate(i))}],"filter-==":[ns,[fs,hs],function(i,l){var c=l[0],_=l[1];return i.properties()[c.value]===_.value}],"filter-id-==":[ns,[hs],function(i,l){var c=l[0];return i.id()===c.value}],"filter-type-==":[ns,[fs],function(i,l){var c=l[0];return i.geometryType()===c.value}],"filter-<":[ns,[fs,hs],function(i,l){var c=l[0],_=l[1],x=i.properties()[c.value],w=_.value;return typeof x==typeof w&&x<w}],"filter-id-<":[ns,[hs],function(i,l){var c=l[0],_=i.id(),x=c.value;return typeof _==typeof x&&_<x}],"filter->":[ns,[fs,hs],function(i,l){var c=l[0],_=l[1],x=i.properties()[c.value],w=_.value;return typeof x==typeof w&&x>w}],"filter-id->":[ns,[hs],function(i,l){var c=l[0],_=i.id(),x=c.value;return typeof _==typeof x&&_>x}],"filter-<=":[ns,[fs,hs],function(i,l){var c=l[0],_=l[1],x=i.properties()[c.value],w=_.value;return typeof x==typeof w&&x<=w}],"filter-id-<=":[ns,[hs],function(i,l){var c=l[0],_=i.id(),x=c.value;return typeof _==typeof x&&_<=x}],"filter->=":[ns,[fs,hs],function(i,l){var c=l[0],_=l[1],x=i.properties()[c.value],w=_.value;return typeof x==typeof w&&x>=w}],"filter-id->=":[ns,[hs],function(i,l){var c=l[0],_=i.id(),x=c.value;return typeof _==typeof x&&_>=x}],"filter-has":[ns,[hs],function(i,l){return l[0].value in i.properties()}],"filter-has-id":[ns,[],function(i){return i.id()!==null&&i.id()!==void 0}],"filter-type-in":[ns,[Sn(fs)],function(i,l){return l[0].value.indexOf(i.geometryType())>=0}],"filter-id-in":[ns,[Sn(hs)],function(i,l){return l[0].value.indexOf(i.id())>=0}],"filter-in-small":[ns,[fs,Sn(hs)],function(i,l){var c=l[0];return l[1].value.indexOf(i.properties()[c.value])>=0}],"filter-in-large":[ns,[fs,Sn(hs)],function(i,l){var c=l[0],_=l[1];return function(x,w,T,$){for(;T<=$;){var D=T+$>>1;if(w[D]===x)return!0;w[D]>x?$=D-1:T=D+1}return!1}(i.properties()[c.value],_.value,0,_.value.length-1)}],all:{type:ns,overloads:[[[ns,ns],function(i,l){var c=l[1];return l[0].evaluate(i)&&c.evaluate(i)}],[Ql(ns),function(i,l){for(var c=0,_=l;c<_.length;c+=1)if(!_[c].evaluate(i))return!1;return!0}]]},any:{type:ns,overloads:[[[ns,ns],function(i,l){var c=l[1];return l[0].evaluate(i)||c.evaluate(i)}],[Ql(ns),function(i,l){for(var c=0,_=l;c<_.length;c+=1)if(_[c].evaluate(i))return!0;return!1}]]},"!":[ns,[ns],function(i,l){return!l[0].evaluate(i)}],"is-supported-script":[ns,[fs],function(i,l){var c=i.globals&&i.globals.isSupportedScript;return!c||c(l[0].evaluate(i))}],upcase:[fs,[fs],function(i,l){return l[0].evaluate(i).toUpperCase()}],downcase:[fs,[fs],function(i,l){return l[0].evaluate(i).toLowerCase()}],concat:[fs,Ql(hs),function(i,l){return l.map(function(c){return bd(c.evaluate(i))}).join("")}],"resolved-locale":[fs,[mn],function(i,l){return l[0].evaluate(i).resolvedLocale()}]});var Xc=function(i,l){this.expression=i,this._warningHistory={},this._evaluator=new Ta,this._defaultValue=l?function(c){return c.type==="color"&&Eu(c.default)?new On(0,0,0,0):c.type==="color"?On.parse(c.default)||null:c.default===void 0?null:c.default}(l):null,this._enumValues=l&&l.type==="enum"?l.values:null};function Td(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in Jl}function Fh(i,l){var c=new Wl(Jl,[],l?function(x){var w={color:is,string:fs,number:At,enum:fs,boolean:ns,formatted:Fn,resolvedImage:hn};return x.type==="array"?Sn(w[x.value]||hs,x.length):w[x.type]}(l):void 0),_=c.parse(i,void 0,void 0,void 0,l&&l.type==="string"?{typeAnnotation:"coerce"}:void 0);return _?uf(new Xc(_,l)):_l(c.errors)}Xc.prototype.evaluateWithoutErrorHandling=function(i,l,c,_,x,w){return this._evaluator.globals=i,this._evaluator.feature=l,this._evaluator.featureState=c,this._evaluator.canonical=_,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=w,this.expression.evaluate(this._evaluator)},Xc.prototype.evaluate=function(i,l,c,_,x,w){this._evaluator.globals=i,this._evaluator.feature=l||null,this._evaluator.featureState=c||null,this._evaluator.canonical=_,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=w||null;try{var T=this.expression.evaluate(this._evaluator);if(T==null||typeof T=="number"&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new Zr("Expected value to be one of "+Object.keys(this._enumValues).map(function($){return JSON.stringify($)}).join(", ")+", but found "+JSON.stringify(T)+" instead.");return T}catch($){return this._warningHistory[$.message]||(this._warningHistory[$.message]=!0,typeof console<"u"&&console.warn($.message)),this._defaultValue}};var Ad=function(i,l){this.kind=i,this._styleExpression=l,this.isStateDependent=i!=="constant"&&!Hl(l.expression)};Ad.prototype.evaluateWithoutErrorHandling=function(i,l,c,_,x,w){return this._styleExpression.evaluateWithoutErrorHandling(i,l,c,_,x,w)},Ad.prototype.evaluate=function(i,l,c,_,x,w){return this._styleExpression.evaluate(i,l,c,_,x,w)};var Pu=function(i,l,c,_){this.kind=i,this.zoomStops=c,this._styleExpression=l,this.isStateDependent=i!=="camera"&&!Hl(l.expression),this.interpolationType=_};function Hm(i,l){if((i=Fh(i,l)).result==="error")return i;var c=i.value.expression,_=ql(c);if(!_&&!gl(l))return _l([new Vt("","data expressions not supported")]);var x=qc(c,["zoom"]);if(!x&&!df(l))return _l([new Vt("","zoom expressions not supported")]);var w=function T($){var D=null;if($ instanceof pl)D=T($.result);else if($ instanceof hl)for(var V=0,Z=$.args;V<Z.length&&!(D=T(Z[V]));V+=1);else($ instanceof Cn||$ instanceof xi)&&$.input instanceof fi&&$.input.name==="zoom"&&(D=$);return D instanceof Vt||$.eachChild(function(K){var le=T(K);le instanceof Vt?D=le:!D&&le?D=new Vt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):D&&le&&D!==le&&(D=new Vt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),D}(c);return w||x?w instanceof Vt?_l([w]):w instanceof xi&&!Cd(l)?_l([new Vt("",'"interpolate" expressions cannot be used with this property')]):uf(w?new Pu(_?"camera":"composite",i.value,w.labels,w instanceof xi?w.interpolation:void 0):new Ad(_?"constant":"source",i.value)):_l([new Vt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Pu.prototype.evaluateWithoutErrorHandling=function(i,l,c,_,x,w){return this._styleExpression.evaluateWithoutErrorHandling(i,l,c,_,x,w)},Pu.prototype.evaluate=function(i,l,c,_,x,w){return this._styleExpression.evaluate(i,l,c,_,x,w)},Pu.prototype.interpolationFactor=function(i,l,c){return this.interpolationType?xi.interpolationFactor(this.interpolationType,i,l,c):0};var Ma=function(i,l){this._parameters=i,this._specification=l,Ft(this,function c(_,x){var w,T,$,D=x.type==="color",V=_.stops&&typeof _.stops[0][0]=="object",Z=V||!(V||_.property!==void 0),K=_.type||(Cd(x)?"exponential":"interval");if(D&&((_=Ft({},_)).stops&&(_.stops=_.stops.map(function(ls){return[ls[0],On.parse(ls[1])]})),_.default=On.parse(_.default?_.default:x.default)),_.colorSpace&&_.colorSpace!=="rgb"&&!lf[_.colorSpace])throw new Error("Unknown color space: "+_.colorSpace);if(K==="exponential")w=ku;else if(K==="interval")w=hf;else if(K==="categorical"){w=To,T=Object.create(null);for(var le=0,_e=_.stops;le<_e.length;le+=1){var Oe=_e[le];T[Oe[0]]=Oe[1]}$=typeof _.stops[0][0]}else{if(K!=="identity")throw new Error('Unknown function type "'+K+'"');w=Id}if(V){for(var Be={},Xe=[],He=0;He<_.stops.length;He++){var lt=_.stops[He],ft=lt[0].zoom;Be[ft]===void 0&&(Be[ft]={zoom:ft,type:_.type,property:_.property,default:_.default,stops:[]},Xe.push(ft)),Be[ft].stops.push([lt[0].value,lt[1]])}for(var yt=[],xt=0,Pt=Xe;xt<Pt.length;xt+=1){var Yt=Pt[xt];yt.push([Be[Yt].zoom,c(Be[Yt],x)])}var Qt={name:"linear"};return{kind:"composite",interpolationType:Qt,interpolationFactor:xi.interpolationFactor.bind(void 0,Qt),zoomStops:yt.map(function(ls){return ls[0]}),evaluate:function(ls,Ms){var us=ls.zoom;return ku({stops:yt,base:_.base},x,us).evaluate(us,Ms)}}}if(Z){var Is=K==="exponential"?{name:"exponential",base:_.base!==void 0?_.base:1}:null;return{kind:"camera",interpolationType:Is,interpolationFactor:xi.interpolationFactor.bind(void 0,Is),zoomStops:_.stops.map(function(ls){return ls[0]}),evaluate:function(ls){return w(_,x,ls.zoom,T,$)}}}return{kind:"source",evaluate:function(ls,Ms){var us=Ms&&Ms.properties?Ms.properties[_.property]:void 0;return us===void 0?Zc(_.default,x.default):w(_,x,us,T,$)}}}(this._parameters,this._specification))};function Ea(i){var l=i.key,c=i.value,_=i.valueSpec||{},x=i.objectElementValidators||{},w=i.style,T=i.styleSpec,$=[],D=tr(c);if(D!=="object")return[new Ve(l,c,"object expected, "+D+" found")];for(var V in c){var Z=V.split(".")[0],K=_[Z]||_["*"],le=void 0;if(x[Z])le=x[Z];else if(_[Z])le=Es;else if(x["*"])le=x["*"];else{if(!_["*"]){$.push(new Ve(l,c[V],'unknown property "'+V+'"'));continue}le=Es}$=$.concat(le({key:(l&&l+".")+V,value:c[V],valueSpec:K,style:w,styleSpec:T,object:c,objectKey:V},c))}for(var _e in _)x[_e]||_[_e].required&&_[_e].default===void 0&&c[_e]===void 0&&$.push(new Ve(l,c,'missing required property "'+_e+'"'));return $}function Gm(i){var l=i.value,c=i.valueSpec,_=i.style,x=i.styleSpec,w=i.key,T=i.arrayElementValidator||Es;if(tr(l)!=="array")return[new Ve(w,l,"array expected, "+tr(l)+" found")];if(c.length&&l.length!==c.length)return[new Ve(w,l,"array length "+c.length+" expected, length "+l.length+" found")];if(c["min-length"]&&l.length<c["min-length"])return[new Ve(w,l,"array length at least "+c["min-length"]+" expected, length "+l.length+" found")];var $={type:c.value,values:c.values};x.$version<7&&($.function=c.function),tr(c.value)==="object"&&($=c.value);for(var D=[],V=0;V<l.length;V++)D=D.concat(T({array:l,arrayIndex:V,value:l[V],valueSpec:$,style:_,styleSpec:x,key:w+"["+V+"]"}));return D}function zh(i){var l=i.key,c=i.value,_=i.valueSpec,x=tr(c);return x==="number"&&c!=c&&(x="NaN"),x!=="number"?[new Ve(l,c,"number expected, "+x+" found")]:"minimum"in _&&c<_.minimum?[new Ve(l,c,c+" is less than the minimum value "+_.minimum)]:"maximum"in _&&c>_.maximum?[new Ve(l,c,c+" is greater than the maximum value "+_.maximum)]:[]}function pf(i){var l,c,_,x=i.valueSpec,w=Ht(i.value.type),T={},$=w!=="categorical"&&i.value.property===void 0,D=!$,V=tr(i.value.stops)==="array"&&tr(i.value.stops[0])==="array"&&tr(i.value.stops[0][0])==="object",Z=Ea({key:i.key,value:i.value,valueSpec:i.styleSpec.function,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(_e){if(w==="identity")return[new Ve(_e.key,_e.value,'identity function may not have a "stops" property')];var Oe=[],Be=_e.value;return Oe=Oe.concat(Gm({key:_e.key,value:Be,valueSpec:_e.valueSpec,style:_e.style,styleSpec:_e.styleSpec,arrayElementValidator:K})),tr(Be)==="array"&&Be.length===0&&Oe.push(new Ve(_e.key,Be,"array must have at least one stop")),Oe},default:function(_e){return Es({key:_e.key,value:_e.value,valueSpec:x,style:_e.style,styleSpec:_e.styleSpec})}}});return w==="identity"&&$&&Z.push(new Ve(i.key,i.value,'missing required property "property"')),w==="identity"||i.value.stops||Z.push(new Ve(i.key,i.value,'missing required property "stops"')),w==="exponential"&&i.valueSpec.expression&&!Cd(i.valueSpec)&&Z.push(new Ve(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(D&&!gl(i.valueSpec)?Z.push(new Ve(i.key,i.value,"property functions not supported")):$&&!df(i.valueSpec)&&Z.push(new Ve(i.key,i.value,"zoom functions not supported"))),w!=="categorical"&&!V||i.value.property!==void 0||Z.push(new Ve(i.key,i.value,'"property" property is required')),Z;function K(_e){var Oe=[],Be=_e.value,Xe=_e.key;if(tr(Be)!=="array")return[new Ve(Xe,Be,"array expected, "+tr(Be)+" found")];if(Be.length!==2)return[new Ve(Xe,Be,"array length 2 expected, length "+Be.length+" found")];if(V){if(tr(Be[0])!=="object")return[new Ve(Xe,Be,"object expected, "+tr(Be[0])+" found")];if(Be[0].zoom===void 0)return[new Ve(Xe,Be,"object stop key must have zoom")];if(Be[0].value===void 0)return[new Ve(Xe,Be,"object stop key must have value")];if(_&&_>Ht(Be[0].zoom))return[new Ve(Xe,Be[0].zoom,"stop zoom values must appear in ascending order")];Ht(Be[0].zoom)!==_&&(_=Ht(Be[0].zoom),c=void 0,T={}),Oe=Oe.concat(Ea({key:Xe+"[0]",value:Be[0],valueSpec:{zoom:{}},style:_e.style,styleSpec:_e.styleSpec,objectElementValidators:{zoom:zh,value:le}}))}else Oe=Oe.concat(le({key:Xe+"[0]",value:Be[0],valueSpec:{},style:_e.style,styleSpec:_e.styleSpec},Be));return Td(Tt(Be[1]))?Oe.concat([new Ve(Xe+"[1]",Be[1],"expressions are not allowed in function stops.")]):Oe.concat(Es({key:Xe+"[1]",value:Be[1],valueSpec:x,style:_e.style,styleSpec:_e.styleSpec}))}function le(_e,Oe){var Be=tr(_e.value),Xe=Ht(_e.value),He=_e.value!==null?_e.value:Oe;if(l){if(Be!==l)return[new Ve(_e.key,He,Be+" stop domain type must match previous stop domain type "+l)]}else l=Be;if(Be!=="number"&&Be!=="string"&&Be!=="boolean")return[new Ve(_e.key,He,"stop domain value must be a number, string, or boolean")];if(Be!=="number"&&w!=="categorical"){var lt="number expected, "+Be+" found";return gl(x)&&w===void 0&&(lt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ve(_e.key,He,lt)]}return w!=="categorical"||Be!=="number"||isFinite(Xe)&&Math.floor(Xe)===Xe?w!=="categorical"&&Be==="number"&&c!==void 0&&Xe<c?[new Ve(_e.key,He,"stop domain values must appear in ascending order")]:(c=Xe,w==="categorical"&&Xe in T?[new Ve(_e.key,He,"stop domain values must be unique")]:(T[Xe]=!0,[])):[new Ve(_e.key,He,"integer expected, found "+Xe)]}}function Ao(i){var l=(i.expressionContext==="property"?Hm:Fh)(Tt(i.value),i.valueSpec);if(l.result==="error")return l.value.map(function(_){return new Ve(""+i.key+_.key,i.value,_.message)});var c=l.value.expression||l.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!c.outputDefined())return[new Ve(i.key,i.value,'Invalid data expression for "'+i.propertyKey+'". Output values must be contained as literals within the expression.')];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!Hl(c))return[new Ve(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!Hl(c))return[new Ve(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!qc(c,["zoom","feature-state"]))return[new Ve(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!ql(c))return[new Ve(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ec(i){var l=i.key,c=i.value,_=i.valueSpec,x=[];return Array.isArray(_.values)?_.values.indexOf(Ht(c))===-1&&x.push(new Ve(l,c,"expected one of ["+_.values.join(", ")+"], "+JSON.stringify(c)+" found")):Object.keys(_.values).indexOf(Ht(c))===-1&&x.push(new Ve(l,c,"expected one of ["+Object.keys(_.values).join(", ")+"], "+JSON.stringify(c)+" found")),x}function Uh(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(var l=0,c=i.slice(1);l<c.length;l+=1){var _=c[l];if(!Uh(_)&&typeof _!="boolean")return!1}return!0;default:return!0}}Ma.deserialize=function(i){return new Ma(i._parameters,i._specification)},Ma.serialize=function(i){return{_parameters:i._parameters,_specification:i._specification}};var ff={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Vh(i){if(i==null)return{filter:function(){return!0},needGeometry:!1};Uh(i)||(i=Mo(i));var l=Fh(i,ff);if(l.result==="error")throw new Error(l.value.map(function(c){return c.key+": "+c.message}).join(", "));return{filter:function(c,_,x){return l.value.evaluate(c,_,{},x)},needGeometry:function c(_){if(!Array.isArray(_))return!1;if(_[0]==="within")return!0;for(var x=1;x<_.length;x++)if(c(_[x]))return!0;return!1}(i)}}function Ru(i,l){return i<l?-1:i>l?1:0}function Mo(i){if(!i)return!0;var l,c=i[0];return i.length<=1?c!=="any":c==="=="?jh(i[1],i[2],"=="):c==="!="?qh(jh(i[1],i[2],"==")):c==="<"||c===">"||c==="<="||c===">="?jh(i[1],i[2],c):c==="any"?(l=i.slice(1),["any"].concat(l.map(Mo))):c==="all"?["all"].concat(i.slice(1).map(Mo)):c==="none"?["all"].concat(i.slice(1).map(Mo).map(qh)):c==="in"?Wm(i[1],i.slice(2)):c==="!in"?qh(Wm(i[1],i.slice(2))):c==="has"?Ym(i[1]):c==="!has"?qh(Ym(i[1])):c!=="within"||i}function jh(i,l,c){switch(i){case"$type":return["filter-type-"+c,l];case"$id":return["filter-id-"+c,l];default:return["filter-"+c,i,l]}}function Wm(i,l){if(l.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",l]];case"$id":return["filter-id-in",["literal",l]];default:return l.length>200&&!l.some(function(c){return typeof c!=typeof l[0]})?["filter-in-large",i,["literal",l.sort(Ru)]]:["filter-in-small",i,["literal",l]]}}function Ym(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function qh(i){return["!",i]}function mf(i){return Uh(Tt(i.value))?Ao(Ft({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function l(c){var _=c.value,x=c.key;if(tr(_)!=="array")return[new Ve(x,_,"array expected, "+tr(_)+" found")];var w,T=c.styleSpec,$=[];if(_.length<1)return[new Ve(x,_,"filter array must have at least 1 element")];switch($=$.concat(ec({key:x+"[0]",value:_[0],valueSpec:T.filter_operator,style:c.style,styleSpec:c.styleSpec})),Ht(_[0])){case"<":case"<=":case">":case">=":_.length>=2&&Ht(_[1])==="$type"&&$.push(new Ve(x,_,'"$type" cannot be use with operator "'+_[0]+'"'));case"==":case"!=":_.length!==3&&$.push(new Ve(x,_,'filter array for operator "'+_[0]+'" must have 3 elements'));case"in":case"!in":_.length>=2&&(w=tr(_[1]))!=="string"&&$.push(new Ve(x+"[1]",_[1],"string expected, "+w+" found"));for(var D=2;D<_.length;D++)w=tr(_[D]),Ht(_[1])==="$type"?$=$.concat(ec({key:x+"["+D+"]",value:_[D],valueSpec:T.geometry_type,style:c.style,styleSpec:c.styleSpec})):w!=="string"&&w!=="number"&&w!=="boolean"&&$.push(new Ve(x+"["+D+"]",_[D],"string, number, or boolean expected, "+w+" found"));break;case"any":case"all":case"none":for(var V=1;V<_.length;V++)$=$.concat(l({key:x+"["+V+"]",value:_[V],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":w=tr(_[1]),_.length!==2?$.push(new Ve(x,_,'filter array for "'+_[0]+'" operator must have 2 elements')):w!=="string"&&$.push(new Ve(x+"[1]",_[1],"string expected, "+w+" found"));break;case"within":w=tr(_[1]),_.length!==2?$.push(new Ve(x,_,'filter array for "'+_[0]+'" operator must have 2 elements')):w!=="object"&&$.push(new Ve(x+"[1]",_[1],"object expected, "+w+" found"))}return $}(i)}function _f(i,l){var c=i.key,_=i.style,x=i.styleSpec,w=i.value,T=i.objectKey,$=x[l+"_"+i.layerType];if(!$)return[];var D=T.match(/^(.*)-transition$/);if(l==="paint"&&D&&$[D[1]]&&$[D[1]].transition)return Es({key:c,value:w,valueSpec:x.transition,style:_,styleSpec:x});var V,Z=i.valueSpec||$[T];if(!Z)return[new Ve(c,w,'unknown property "'+T+'"')];if(tr(w)==="string"&&gl(Z)&&!Z.tokens&&(V=/^{([^}]+)}$/.exec(w)))return[new Ve(c,w,'"'+T+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(V[1])+" }`.")];var K=[];return i.layerType==="symbol"&&(T==="text-field"&&_&&!_.glyphs&&K.push(new Ve(c,w,'use of "text-field" requires a style "glyphs" property')),T==="text-font"&&Eu(Tt(w))&&Ht(w.type)==="identity"&&K.push(new Ve(c,w,'"text-font" does not support identity functions'))),K.concat(Es({key:i.key,value:w,valueSpec:Z,style:_,styleSpec:x,expressionContext:"property",propertyType:l,propertyKey:T}))}function tc(i){return _f(i,"paint")}function dt(i){return _f(i,"layout")}function Ot(i){var l=[],c=i.value,_=i.key,x=i.style,w=i.styleSpec;c.type||c.ref||l.push(new Ve(_,c,'either "type" or "ref" is required'));var T,$=Ht(c.type),D=Ht(c.ref);if(c.id)for(var V=Ht(c.id),Z=0;Z<i.arrayIndex;Z++){var K=x.layers[Z];Ht(K.id)===V&&l.push(new Ve(_,c.id,'duplicate layer id "'+c.id+'", previously used at line '+K.id.__line__))}if("ref"in c)["type","source","source-layer","filter","layout"].forEach(function(Oe){Oe in c&&l.push(new Ve(_,c[Oe],'"'+Oe+'" is prohibited for ref layers'))}),x.layers.forEach(function(Oe){Ht(Oe.id)===D&&(T=Oe)}),T?T.ref?l.push(new Ve(_,c.ref,"ref cannot reference another ref layer")):$=Ht(T.type):l.push(new Ve(_,c.ref,'ref layer "'+D+'" not found'));else if($!=="background")if(c.source){var le=x.sources&&x.sources[c.source],_e=le&&Ht(le.type);le?_e==="vector"&&$==="raster"?l.push(new Ve(_,c.source,'layer "'+c.id+'" requires a raster source')):_e==="raster"&&$!=="raster"?l.push(new Ve(_,c.source,'layer "'+c.id+'" requires a vector source')):_e!=="vector"||c["source-layer"]?_e==="raster-dem"&&$!=="hillshade"?l.push(new Ve(_,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):$!=="line"||!c.paint||!c.paint["line-gradient"]||_e==="geojson"&&le.lineMetrics||l.push(new Ve(_,c,'layer "'+c.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):l.push(new Ve(_,c,'layer "'+c.id+'" must specify a "source-layer"')):l.push(new Ve(_,c.source,'source "'+c.source+'" not found'))}else l.push(new Ve(_,c,'missing required property "source"'));return l=l.concat(Ea({key:_,value:c,valueSpec:w.layer,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Es({key:_+".type",value:c.type,valueSpec:w.layer.type,style:i.style,styleSpec:i.styleSpec,object:c,objectKey:"type"})},filter:mf,layout:function(Oe){return Ea({layer:c,key:Oe.key,value:Oe.value,style:Oe.style,styleSpec:Oe.styleSpec,objectElementValidators:{"*":function(Be){return dt(Ft({layerType:$},Be))}}})},paint:function(Oe){return Ea({layer:c,key:Oe.key,value:Oe.value,style:Oe.style,styleSpec:Oe.styleSpec,objectElementValidators:{"*":function(Be){return tc(Ft({layerType:$},Be))}}})}}}))}function Mt(i){var l=i.value,c=i.key,_=tr(l);return _!=="string"?[new Ve(c,l,"string expected, "+_+" found")]:[]}var rs={promoteId:function(i){var l=i.key,c=i.value;if(tr(c)==="string")return Mt({key:l,value:c});var _=[];for(var x in c)_.push.apply(_,Mt({key:l+"."+x,value:c[x]}));return _}};function on(i){var l=i.value,c=i.key,_=i.styleSpec,x=i.style;if(!l.type)return[new Ve(c,l,'"type" is required')];var w,T=Ht(l.type);switch(T){case"vector":case"raster":case"raster-dem":return Ea({key:c,value:l,valueSpec:_["source_"+T.replace("-","_")],style:i.style,styleSpec:_,objectElementValidators:rs});case"geojson":if(w=Ea({key:c,value:l,valueSpec:_.source_geojson,style:x,styleSpec:_,objectElementValidators:rs}),l.cluster)for(var $ in l.clusterProperties){var D=l.clusterProperties[$],V=D[0],Z=typeof V=="string"?[V,["accumulated"],["get",$]]:V;w.push.apply(w,Ao({key:c+"."+$+".map",value:D[1],expressionContext:"cluster-map"})),w.push.apply(w,Ao({key:c+"."+$+".reduce",value:Z,expressionContext:"cluster-reduce"}))}return w;case"video":return Ea({key:c,value:l,valueSpec:_.source_video,style:x,styleSpec:_});case"image":return Ea({key:c,value:l,valueSpec:_.source_image,style:x,styleSpec:_});case"canvas":return[new Ve(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ec({key:c+".type",value:l.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:x,styleSpec:_})}}function En(i){var l=i.value,c=i.styleSpec,_=c.light,x=i.style,w=[],T=tr(l);if(l===void 0)return w;if(T!=="object")return w.concat([new Ve("light",l,"object expected, "+T+" found")]);for(var $ in l){var D=$.match(/^(.*)-transition$/);w=w.concat(D&&_[D[1]]&&_[D[1]].transition?Es({key:$,value:l[$],valueSpec:c.transition,style:x,styleSpec:c}):_[$]?Es({key:$,value:l[$],valueSpec:_[$],style:x,styleSpec:c}):[new Ve($,l[$],'unknown property "'+$+'"')])}return w}var Er={"*":function(){return[]},array:Gm,boolean:function(i){var l=i.value,c=i.key,_=tr(l);return _!=="boolean"?[new Ve(c,l,"boolean expected, "+_+" found")]:[]},number:zh,color:function(i){var l=i.key,c=i.value,_=tr(c);return _!=="string"?[new Ve(l,c,"color expected, "+_+" found")]:pn(c)===null?[new Ve(l,c,'color expected, "'+c+'" found')]:[]},constants:pt,enum:ec,filter:mf,function:pf,layer:Ot,object:Ea,source:on,light:En,string:Mt,formatted:function(i){return Mt(i).length===0?[]:Ao(i)},resolvedImage:function(i){return Mt(i).length===0?[]:Ao(i)}};function Es(i){var l=i.value,c=i.valueSpec,_=i.styleSpec;return c.expression&&Eu(Ht(l))?pf(i):c.expression&&Td(Tt(l))?Ao(i):c.type&&Er[c.type]?Er[c.type](i):Ea(Ft({},i,{valueSpec:c.type?_[c.type]:c}))}function sr(i){var l=i.value,c=i.key,_=Mt(i);return _.length||(l.indexOf("{fontstack}")===-1&&_.push(new Ve(c,l,'"glyphs" url must include a "{fontstack}" token')),l.indexOf("{range}")===-1&&_.push(new Ve(c,l,'"glyphs" url must include a "{range}" token'))),_}function Uo(i,l){l===void 0&&(l=xe);var c=[];return c=c.concat(Es({key:"",value:i,valueSpec:l.$root,styleSpec:l,style:i,objectElementValidators:{glyphs:sr,"*":function(){return[]}}})),i.constants&&(c=c.concat(pt({key:"constants",value:i.constants,style:i,styleSpec:l}))),no(c)}function no(i){return[].concat(i).sort(function(l,c){return l.line-c.line})}function yl(i){return function(){for(var l=[],c=arguments.length;c--;)l[c]=arguments[c];return no(i.apply(this,l))}}Uo.source=yl(on),Uo.light=yl(En),Uo.layer=yl(Ot),Uo.filter=yl(mf),Uo.paintProperty=yl(tc),Uo.layoutProperty=yl(dt);var Md=Uo,$u=Md.light,Hh=Md.paintProperty,sc=Md.layoutProperty;function Wn(i,l){var c=!1;if(l&&l.length)for(var _=0,x=l;_<x.length;_+=1)i.fire(new et(new Error(x[_].message))),c=!0;return c}var vl=Kr;function Kr(i,l,c){var _=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;var x=new Int32Array(this.arrayBuffer);i=x[0],this.d=(l=x[1])+2*(c=x[2]);for(var w=0;w<this.d*this.d;w++){var T=x[3+w],$=x[3+w+1];_.push(T===$?null:x.subarray(T,$))}var D=x[3+_.length+1];this.keys=x.subarray(x[3+_.length],D),this.bboxes=x.subarray(D),this.insert=this._insertReadonly}else{this.d=l+2*c;for(var V=0;V<this.d*this.d;V++)_.push([]);this.keys=[],this.bboxes=[]}this.n=l,this.extent=i,this.padding=c,this.scale=l/i,this.uid=0;var Z=c/l*i;this.min=-Z,this.max=i+Z}Kr.prototype.insert=function(i,l,c,_,x){this._forEachCell(l,c,_,x,this._insertCell,this.uid++),this.keys.push(i),this.bboxes.push(l),this.bboxes.push(c),this.bboxes.push(_),this.bboxes.push(x)},Kr.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Kr.prototype._insertCell=function(i,l,c,_,x,w){this.cells[x].push(w)},Kr.prototype.query=function(i,l,c,_,x){var w=this.min,T=this.max;if(i<=w&&l<=w&&T<=c&&T<=_&&!x)return Array.prototype.slice.call(this.keys);var $=[];return this._forEachCell(i,l,c,_,this._queryCell,$,{},x),$},Kr.prototype._queryCell=function(i,l,c,_,x,w,T,$){var D=this.cells[x];if(D!==null)for(var V=this.keys,Z=this.bboxes,K=0;K<D.length;K++){var le=D[K];if(T[le]===void 0){var _e=4*le;($?$(Z[_e+0],Z[_e+1],Z[_e+2],Z[_e+3]):i<=Z[_e+2]&&l<=Z[_e+3]&&c>=Z[_e+0]&&_>=Z[_e+1])?(T[le]=!0,w.push(V[le])):T[le]=!1}}},Kr.prototype._forEachCell=function(i,l,c,_,x,w,T,$){for(var D=this._convertToCellCoord(i),V=this._convertToCellCoord(l),Z=this._convertToCellCoord(c),K=this._convertToCellCoord(_),le=D;le<=Z;le++)for(var _e=V;_e<=K;_e++){var Oe=this.d*_e+le;if((!$||$(this._convertFromCellCoord(le),this._convertFromCellCoord(_e),this._convertFromCellCoord(le+1),this._convertFromCellCoord(_e+1)))&&x.call(this,i,l,c,_,Oe,w,T,$))return}},Kr.prototype._convertFromCellCoord=function(i){return(i-this.padding)/this.scale},Kr.prototype._convertToCellCoord=function(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))},Kr.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var i=this.cells,l=3+this.cells.length+1+1,c=0,_=0;_<this.cells.length;_++)c+=this.cells[_].length;var x=new Int32Array(l+c+this.keys.length+this.bboxes.length);x[0]=this.extent,x[1]=this.n,x[2]=this.padding;for(var w=l,T=0;T<i.length;T++){var $=i[T];x[3+T]=w,x.set($,w),w+=$.length}return x[3+i.length]=w,x.set(this.keys,w),x[3+i.length+1]=w+=this.keys.length,x.set(this.bboxes,w),w+=this.bboxes.length,x.buffer};var nc=I.ImageData,Zm=I.ImageBitmap,Jr={};function _s(i,l,c){c===void 0&&(c={}),Object.defineProperty(l,"_classRegistryKey",{value:i,writeable:!1}),Jr[i]={klass:l,omit:c.omit||[],shallow:c.shallow||[]}}for(var Fi in _s("Object",Object),vl.serialize=function(i,l){var c=i.toArrayBuffer();return l&&l.push(c),{buffer:c}},vl.deserialize=function(i){return new vl(i.buffer)},_s("Grid",vl),_s("Color",On),_s("Error",Error),_s("ResolvedImage",to),_s("StylePropertyFunction",Ma),_s("StyleExpression",Xc,{omit:["_evaluator"]}),_s("ZoomDependentExpression",Pu),_s("ZoomConstantExpression",Ad),_s("CompoundExpression",fi,{omit:["_evaluate"]}),Jl)Jl[Fi]._classRegistryKey||_s("Expression_"+Fi,Jl[Fi]);function ka(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function bl(i){return Zm&&i instanceof Zm}function ea(i,l){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp)return i;if(ka(i)||bl(i))return l&&l.push(i),i;if(ArrayBuffer.isView(i)){var c=i;return l&&l.push(c.buffer),c}if(i instanceof nc)return l&&l.push(i.data.buffer),i;if(Array.isArray(i)){for(var _=[],x=0,w=i;x<w.length;x+=1)_.push(ea(w[x],l));return _}if(typeof i=="object"){var T=i.constructor,$=T._classRegistryKey;if(!$)throw new Error("can't serialize object of unregistered class");var D=T.serialize?T.serialize(i,l):{};if(!T.serialize){for(var V in i)if(i.hasOwnProperty(V)&&!(Jr[$].omit.indexOf(V)>=0)){var Z=i[V];D[V]=Jr[$].shallow.indexOf(V)>=0?Z:ea(Z,l)}i instanceof Error&&(D.message=i.message)}if(D.$name)throw new Error("$name property is reserved for worker serialization logic.");return $!=="Object"&&(D.$name=$),D}throw new Error("can't serialize object of type "+typeof i)}function zi(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||ka(i)||bl(i)||ArrayBuffer.isView(i)||i instanceof nc)return i;if(Array.isArray(i))return i.map(zi);if(typeof i=="object"){var l=i.$name||"Object",c=Jr[l].klass;if(!c)throw new Error("can't deserialize unregistered class "+l);if(c.deserialize)return c.deserialize(i);for(var _=Object.create(c.prototype),x=0,w=Object.keys(i);x<w.length;x+=1){var T=w[x];if(T!=="$name"){var $=i[T];_[T]=Jr[l].shallow.indexOf(T)>=0?$:zi($)}}return _}throw new Error("can't deserialize object of type "+typeof i)}var Gh=function(){this.first=!0};Gh.prototype.update=function(i,l){var c=Math.floor(i);return this.first?(this.first=!1,this.lastIntegerZoom=c,this.lastIntegerZoomTime=0,this.lastZoom=i,this.lastFloorZoom=c,!0):(this.lastFloorZoom>c?(this.lastIntegerZoom=c+1,this.lastIntegerZoomTime=l):this.lastFloorZoom<c&&(this.lastIntegerZoom=c,this.lastIntegerZoomTime=l),i!==this.lastZoom&&(this.lastZoom=i,this.lastFloorZoom=c,!0))};var ss={"Latin-1 Supplement":function(i){return i>=128&&i<=255},Arabic:function(i){return i>=1536&&i<=1791},"Arabic Supplement":function(i){return i>=1872&&i<=1919},"Arabic Extended-A":function(i){return i>=2208&&i<=2303},"Hangul Jamo":function(i){return i>=4352&&i<=4607},"Unified Canadian Aboriginal Syllabics":function(i){return i>=5120&&i<=5759},Khmer:function(i){return i>=6016&&i<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(i){return i>=6320&&i<=6399},"General Punctuation":function(i){return i>=8192&&i<=8303},"Letterlike Symbols":function(i){return i>=8448&&i<=8527},"Number Forms":function(i){return i>=8528&&i<=8591},"Miscellaneous Technical":function(i){return i>=8960&&i<=9215},"Control Pictures":function(i){return i>=9216&&i<=9279},"Optical Character Recognition":function(i){return i>=9280&&i<=9311},"Enclosed Alphanumerics":function(i){return i>=9312&&i<=9471},"Geometric Shapes":function(i){return i>=9632&&i<=9727},"Miscellaneous Symbols":function(i){return i>=9728&&i<=9983},"Miscellaneous Symbols and Arrows":function(i){return i>=11008&&i<=11263},"CJK Radicals Supplement":function(i){return i>=11904&&i<=12031},"Kangxi Radicals":function(i){return i>=12032&&i<=12255},"Ideographic Description Characters":function(i){return i>=12272&&i<=12287},"CJK Symbols and Punctuation":function(i){return i>=12288&&i<=12351},Hiragana:function(i){return i>=12352&&i<=12447},Katakana:function(i){return i>=12448&&i<=12543},Bopomofo:function(i){return i>=12544&&i<=12591},"Hangul Compatibility Jamo":function(i){return i>=12592&&i<=12687},Kanbun:function(i){return i>=12688&&i<=12703},"Bopomofo Extended":function(i){return i>=12704&&i<=12735},"CJK Strokes":function(i){return i>=12736&&i<=12783},"Katakana Phonetic Extensions":function(i){return i>=12784&&i<=12799},"Enclosed CJK Letters and Months":function(i){return i>=12800&&i<=13055},"CJK Compatibility":function(i){return i>=13056&&i<=13311},"CJK Unified Ideographs Extension A":function(i){return i>=13312&&i<=19903},"Yijing Hexagram Symbols":function(i){return i>=19904&&i<=19967},"CJK Unified Ideographs":function(i){return i>=19968&&i<=40959},"Yi Syllables":function(i){return i>=40960&&i<=42127},"Yi Radicals":function(i){return i>=42128&&i<=42191},"Hangul Jamo Extended-A":function(i){return i>=43360&&i<=43391},"Hangul Syllables":function(i){return i>=44032&&i<=55215},"Hangul Jamo Extended-B":function(i){return i>=55216&&i<=55295},"Private Use Area":function(i){return i>=57344&&i<=63743},"CJK Compatibility Ideographs":function(i){return i>=63744&&i<=64255},"Arabic Presentation Forms-A":function(i){return i>=64336&&i<=65023},"Vertical Forms":function(i){return i>=65040&&i<=65055},"CJK Compatibility Forms":function(i){return i>=65072&&i<=65103},"Small Form Variants":function(i){return i>=65104&&i<=65135},"Arabic Presentation Forms-B":function(i){return i>=65136&&i<=65279},"Halfwidth and Fullwidth Forms":function(i){return i>=65280&&i<=65519}};function Ou(i){for(var l=0,c=i;l<c.length;l+=1)if(Ed(c[l].charCodeAt(0)))return!0;return!1}function Ed(i){return!(i!==746&&i!==747&&(i<4352||!(ss["Bopomofo Extended"](i)||ss.Bopomofo(i)||ss["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||ss["CJK Compatibility Ideographs"](i)||ss["CJK Compatibility"](i)||ss["CJK Radicals Supplement"](i)||ss["CJK Strokes"](i)||!(!ss["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||ss["CJK Unified Ideographs Extension A"](i)||ss["CJK Unified Ideographs"](i)||ss["Enclosed CJK Letters and Months"](i)||ss["Hangul Compatibility Jamo"](i)||ss["Hangul Jamo Extended-A"](i)||ss["Hangul Jamo Extended-B"](i)||ss["Hangul Jamo"](i)||ss["Hangul Syllables"](i)||ss.Hiragana(i)||ss["Ideographic Description Characters"](i)||ss.Kanbun(i)||ss["Kangxi Radicals"](i)||ss["Katakana Phonetic Extensions"](i)||ss.Katakana(i)&&i!==12540||!(!ss["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!ss["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||ss["Unified Canadian Aboriginal Syllabics"](i)||ss["Unified Canadian Aboriginal Syllabics Extended"](i)||ss["Vertical Forms"](i)||ss["Yijing Hexagram Symbols"](i)||ss["Yi Syllables"](i)||ss["Yi Radicals"](i))))}function Kc(i){return!(Ed(i)||function(l){return!!(ss["Latin-1 Supplement"](l)&&(l===167||l===169||l===174||l===177||l===188||l===189||l===190||l===215||l===247)||ss["General Punctuation"](l)&&(l===8214||l===8224||l===8225||l===8240||l===8241||l===8251||l===8252||l===8258||l===8263||l===8264||l===8265||l===8273)||ss["Letterlike Symbols"](l)||ss["Number Forms"](l)||ss["Miscellaneous Technical"](l)&&(l>=8960&&l<=8967||l>=8972&&l<=8991||l>=8996&&l<=9e3||l===9003||l>=9085&&l<=9114||l>=9150&&l<=9165||l===9167||l>=9169&&l<=9179||l>=9186&&l<=9215)||ss["Control Pictures"](l)&&l!==9251||ss["Optical Character Recognition"](l)||ss["Enclosed Alphanumerics"](l)||ss["Geometric Shapes"](l)||ss["Miscellaneous Symbols"](l)&&!(l>=9754&&l<=9759)||ss["Miscellaneous Symbols and Arrows"](l)&&(l>=11026&&l<=11055||l>=11088&&l<=11097||l>=11192&&l<=11243)||ss["CJK Symbols and Punctuation"](l)||ss.Katakana(l)||ss["Private Use Area"](l)||ss["CJK Compatibility Forms"](l)||ss["Small Form Variants"](l)||ss["Halfwidth and Fullwidth Forms"](l)||l===8734||l===8756||l===8757||l>=9984&&l<=10087||l>=10102&&l<=10131||l===65532||l===65533)}(i))}function Pi(i){return i>=1424&&i<=2303||ss["Arabic Presentation Forms-A"](i)||ss["Arabic Presentation Forms-B"](i)}function Ui(i,l){return!(!l&&Pi(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||ss.Khmer(i))}function Wh(i){for(var l=0,c=i;l<c.length;l+=1)if(Pi(c[l].charCodeAt(0)))return!0;return!1}var Yh=null,Eo="unavailable",ta=null,kd=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(Eo="error"),Yh&&Yh(i)};function Jc(){gf.fire(new Fe("pluginStateChange",{pluginStatus:Eo,pluginURL:ta}))}var gf=new st,Zh=function(){return Eo},Pa=function(){if(Eo!=="deferred"||!ta)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Eo="loading",Jc(),ta&&yd({url:ta},function(i){i?kd(i):(Eo="loaded",Jc())})},Vo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Eo==="loaded"||Vo.applyArabicShaping!=null},isLoading:function(){return Eo==="loading"},setState:function(i){Eo=i.pluginStatus,ta=i.pluginURL},isParsed:function(){return Vo.applyArabicShaping!=null&&Vo.processBidirectionalText!=null&&Vo.processStyledBidirectionalText!=null},getPluginURL:function(){return ta}},Bs=function(i,l){this.zoom=i,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.zoomHistory=l.zoomHistory,this.transition=l.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Gh,this.transition={})};Bs.prototype.isSupportedScript=function(i){return function(l,c){for(var _=0,x=l;_<x.length;_+=1)if(!Ui(x[_].charCodeAt(0),c))return!1;return!0}(i,Vo.isLoaded())},Bs.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Bs.prototype.getCrossfadeParameters=function(){var i=this.zoom,l=i-Math.floor(i),c=this.crossFadingFactor();return i>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:l+(1-l)*c}:{fromScale:.5,toScale:1,t:1-(1-c)*l}};var Rr=function(i,l){this.property=i,this.value=l,this.expression=function(c,_){if(Eu(c))return new Ma(c,_);if(Td(c)){var x=Hm(c,_);if(x.result==="error")throw new Error(x.value.map(function(T){return T.key+": "+T.message}).join(", "));return x.value}var w=c;return typeof c=="string"&&_.type==="color"&&(w=On.parse(c)),{kind:"constant",evaluate:function(){return w}}}(l===void 0?i.specification.default:l,i.specification)};Rr.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Rr.prototype.possiblyEvaluate=function(i,l,c){return this.property.possiblyEvaluate(this,i,l,c)};var sa=function(i){this.property=i,this.value=new Rr(i,void 0)};sa.prototype.transitioned=function(i,l){return new rc(this.property,this.value,l,re({},i.transition,this.transition),i.now)},sa.prototype.untransitioned=function(){return new rc(this.property,this.value,null,{},0)};var Ri=function(i){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues)};Ri.prototype.getValue=function(i){return Ue(this._values[i].value.value)},Ri.prototype.setValue=function(i,l){this._values.hasOwnProperty(i)||(this._values[i]=new sa(this._values[i].property)),this._values[i].value=new Rr(this._values[i].property,l===null?void 0:Ue(l))},Ri.prototype.getTransition=function(i){return Ue(this._values[i].transition)},Ri.prototype.setTransition=function(i,l){this._values.hasOwnProperty(i)||(this._values[i]=new sa(this._values[i].property)),this._values[i].transition=Ue(l)||void 0},Ri.prototype.serialize=function(){for(var i={},l=0,c=Object.keys(this._values);l<c.length;l+=1){var _=c[l],x=this.getValue(_);x!==void 0&&(i[_]=x);var w=this.getTransition(_);w!==void 0&&(i[_+"-transition"]=w)}return i},Ri.prototype.transitioned=function(i,l){for(var c=new ic(this._properties),_=0,x=Object.keys(this._values);_<x.length;_+=1){var w=x[_];c._values[w]=this._values[w].transitioned(i,l._values[w])}return c},Ri.prototype.untransitioned=function(){for(var i=new ic(this._properties),l=0,c=Object.keys(this._values);l<c.length;l+=1){var _=c[l];i._values[_]=this._values[_].untransitioned()}return i};var rc=function(i,l,c,_,x){this.property=i,this.value=l,this.begin=x+_.delay||0,this.end=this.begin+_.duration||0,i.specification.transition&&(_.delay||_.duration)&&(this.prior=c)};rc.prototype.possiblyEvaluate=function(i,l,c){var _=i.now||0,x=this.value.possiblyEvaluate(i,l,c),w=this.prior;if(w){if(_>this.end)return this.prior=null,x;if(this.value.isDataDriven())return this.prior=null,x;if(_<this.begin)return w.possiblyEvaluate(i,l,c);var T=(_-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(i,l,c),x,function($){if($<=0)return 0;if($>=1)return 1;var D=$*$,V=D*$;return 4*($<.5?V:3*($-D)+V-.75)}(T))}return x};var ic=function(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)};ic.prototype.possiblyEvaluate=function(i,l,c){for(var _=new Qc(this._properties),x=0,w=Object.keys(this._values);x<w.length;x+=1){var T=w[x];_._values[T]=this._values[T].possiblyEvaluate(i,l,c)}return _},ic.prototype.hasTransition=function(){for(var i=0,l=Object.keys(this._values);i<l.length;i+=1)if(this._values[l[i]].prior)return!0;return!1};var jo=function(i){this._properties=i,this._values=Object.create(i.defaultPropertyValues)};jo.prototype.getValue=function(i){return Ue(this._values[i].value)},jo.prototype.setValue=function(i,l){this._values[i]=new Rr(this._values[i].property,l===null?void 0:Ue(l))},jo.prototype.serialize=function(){for(var i={},l=0,c=Object.keys(this._values);l<c.length;l+=1){var _=c[l],x=this.getValue(_);x!==void 0&&(i[_]=x)}return i},jo.prototype.possiblyEvaluate=function(i,l,c){for(var _=new Qc(this._properties),x=0,w=Object.keys(this._values);x<w.length;x+=1){var T=w[x];_._values[T]=this._values[T].possiblyEvaluate(i,l,c)}return _};var mi=function(i,l,c){this.property=i,this.value=l,this.parameters=c};mi.prototype.isConstant=function(){return this.value.kind==="constant"},mi.prototype.constantOr=function(i){return this.value.kind==="constant"?this.value.value:i},mi.prototype.evaluate=function(i,l,c,_){return this.property.evaluate(this.value,this.parameters,i,l,c,_)};var Qc=function(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)};Qc.prototype.get=function(i){return this._values[i]};var Ss=function(i){this.specification=i};Ss.prototype.possiblyEvaluate=function(i,l){return i.expression.evaluate(l)},Ss.prototype.interpolate=function(i,l,c){var _=Mu[this.specification.type];return _?_(i,l,c):i};var gs=function(i,l){this.specification=i,this.overrides=l};gs.prototype.possiblyEvaluate=function(i,l,c,_){return new mi(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(l,null,{},c,_)}:i.expression,l)},gs.prototype.interpolate=function(i,l,c){if(i.value.kind!=="constant"||l.value.kind!=="constant")return i;if(i.value.value===void 0||l.value.value===void 0)return new mi(this,{kind:"constant",value:void 0},i.parameters);var _=Mu[this.specification.type];return _?new mi(this,{kind:"constant",value:_(i.value.value,l.value.value,c)},i.parameters):i},gs.prototype.evaluate=function(i,l,c,_,x,w){return i.kind==="constant"?i.value:i.evaluate(l,c,_,x,w)};var oc=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.possiblyEvaluate=function(c,_,x,w){if(c.value===void 0)return new mi(this,{kind:"constant",value:void 0},_);if(c.expression.kind==="constant"){var T=c.expression.evaluate(_,null,{},x,w),$=c.property.specification.type==="resolvedImage"&&typeof T!="string"?T.name:T,D=this._calculate($,$,$,_);return new mi(this,{kind:"constant",value:D},_)}if(c.expression.kind==="camera"){var V=this._calculate(c.expression.evaluate({zoom:_.zoom-1}),c.expression.evaluate({zoom:_.zoom}),c.expression.evaluate({zoom:_.zoom+1}),_);return new mi(this,{kind:"constant",value:V},_)}return new mi(this,c.expression,_)},l.prototype.evaluate=function(c,_,x,w,T,$){if(c.kind==="source"){var D=c.evaluate(_,x,w,T,$);return this._calculate(D,D,D,_)}return c.kind==="composite"?this._calculate(c.evaluate({zoom:Math.floor(_.zoom)-1},x,w),c.evaluate({zoom:Math.floor(_.zoom)},x,w),c.evaluate({zoom:Math.floor(_.zoom)+1},x,w),_):c.value},l.prototype._calculate=function(c,_,x,w){return w.zoom>w.zoomHistory.lastIntegerZoom?{from:c,to:_}:{from:x,to:_}},l.prototype.interpolate=function(c){return c},l}(gs),Si=function(i){this.specification=i};Si.prototype.possiblyEvaluate=function(i,l,c,_){if(i.value!==void 0){if(i.expression.kind==="constant"){var x=i.expression.evaluate(l,null,{},c,_);return this._calculate(x,x,x,l)}return this._calculate(i.expression.evaluate(new Bs(Math.floor(l.zoom-1),l)),i.expression.evaluate(new Bs(Math.floor(l.zoom),l)),i.expression.evaluate(new Bs(Math.floor(l.zoom+1),l)),l)}},Si.prototype._calculate=function(i,l,c,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:i,to:l}:{from:c,to:l}},Si.prototype.interpolate=function(i){return i};var ro=function(i){this.specification=i};ro.prototype.possiblyEvaluate=function(i,l,c,_){return!!i.expression.evaluate(l,null,{},c,_)},ro.prototype.interpolate=function(){return!1};var $i=function(i){for(var l in this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],i){var c=i[l];c.specification.overridable&&this.overridableProperties.push(l);var _=this.defaultPropertyValues[l]=new Rr(c,void 0),x=this.defaultTransitionablePropertyValues[l]=new sa(c);this.defaultTransitioningPropertyValues[l]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=_.possiblyEvaluate({})}};_s("DataDrivenProperty",gs),_s("DataConstantProperty",Ss),_s("CrossFadedDataDrivenProperty",oc),_s("CrossFadedProperty",Si),_s("ColorRampProperty",ro);var ja=function(i){function l(c,_){if(i.call(this),this.id=c.id,this.type=c.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},c.type!=="custom"&&(this.metadata=(c=c).metadata,this.minzoom=c.minzoom,this.maxzoom=c.maxzoom,c.type!=="background"&&(this.source=c.source,this.sourceLayer=c["source-layer"],this.filter=c.filter),_.layout&&(this._unevaluatedLayout=new jo(_.layout)),_.paint)){for(var x in this._transitionablePaint=new Ri(_.paint),c.paint)this.setPaintProperty(x,c.paint[x],{validate:!1});for(var w in c.layout)this.setLayoutProperty(w,c.layout[w],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Qc(_.paint)}}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},l.prototype.getLayoutProperty=function(c){return c==="visibility"?this.visibility:this._unevaluatedLayout.getValue(c)},l.prototype.setLayoutProperty=function(c,_,x){x===void 0&&(x={}),_!=null&&this._validate(sc,"layers."+this.id+".layout."+c,c,_,x)||(c!=="visibility"?this._unevaluatedLayout.setValue(c,_):this.visibility=_)},l.prototype.getPaintProperty=function(c){return ee(c,"-transition")?this._transitionablePaint.getTransition(c.slice(0,-11)):this._transitionablePaint.getValue(c)},l.prototype.setPaintProperty=function(c,_,x){if(x===void 0&&(x={}),_!=null&&this._validate(Hh,"layers."+this.id+".paint."+c,c,_,x))return!1;if(ee(c,"-transition"))return this._transitionablePaint.setTransition(c.slice(0,-11),_||void 0),!1;var w=this._transitionablePaint._values[c],T=w.property.specification["property-type"]==="cross-faded-data-driven",$=w.value.isDataDriven(),D=w.value;this._transitionablePaint.setValue(c,_),this._handleSpecialPaintPropertyUpdate(c);var V=this._transitionablePaint._values[c].value;return V.isDataDriven()||$||T||this._handleOverridablePaintPropertyUpdate(c,D,V)},l.prototype._handleSpecialPaintPropertyUpdate=function(c){},l.prototype._handleOverridablePaintPropertyUpdate=function(c,_,x){return!1},l.prototype.isHidden=function(c){return!!(this.minzoom&&c<this.minzoom)||!!(this.maxzoom&&c>=this.maxzoom)||this.visibility==="none"},l.prototype.updateTransitions=function(c){this._transitioningPaint=this._transitionablePaint.transitioned(c,this._transitioningPaint)},l.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},l.prototype.recalculate=function(c,_){c.getCrossfadeParameters&&(this._crossfadeParameters=c.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(c,void 0,_)),this.paint=this._transitioningPaint.possiblyEvaluate(c,void 0,_)},l.prototype.serialize=function(){var c={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(c.layout=c.layout||{},c.layout.visibility=this.visibility),Se(c,function(_,x){return!(_===void 0||x==="layout"&&!Object.keys(_).length||x==="paint"&&!Object.keys(_).length)})},l.prototype._validate=function(c,_,x,w,T){return T===void 0&&(T={}),(!T||T.validate!==!1)&&Wn(this,c.call(Md,{key:_,layerType:this.type,objectKey:x,value:w,styleSpec:xe,style:{glyphs:!0,sprite:!0}}))},l.prototype.is3D=function(){return!1},l.prototype.isTileClipped=function(){return!1},l.prototype.hasOffscreenPass=function(){return!1},l.prototype.resize=function(){},l.prototype.isStateDependent=function(){for(var c in this.paint._values){var _=this.paint.get(c);if(_ instanceof mi&&gl(_.property.specification)&&(_.value.kind==="source"||_.value.kind==="composite")&&_.value.isStateDependent)return!0}return!1},l}(st),yf={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Xh=function(i,l){this._structArray=i,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Un=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Qr(i,l){l===void 0&&(l=1);var c=0,_=0;return{members:i.map(function(x){var w=yf[x.type].BYTES_PER_ELEMENT,T=c=Lu(c,Math.max(l,w)),$=x.components||1;return _=Math.max(_,w),c+=w*$,{name:x.name,type:x.type,components:$,offset:T}}),size:Lu(c,Math.max(_,l)),alignment:l}}function Lu(i,l){return Math.ceil(i/l)*l}Un.serialize=function(i,l){return i._trim(),l&&(i.isTransferred=!0,l.push(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}},Un.deserialize=function(i){var l=Object.create(this.prototype);return l.arrayBuffer=i.arrayBuffer,l.length=i.length,l.capacity=i.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l},Un.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Un.prototype.clear=function(){this.length=0},Un.prototype.resize=function(i){this.reserve(i),this.length=i},Un.prototype.reserve=function(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}},Un.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var ac=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(c,_){var x=this.length;return this.resize(x+1),this.emplace(x,c,_)},l.prototype.emplace=function(c,_,x){var w=2*c;return this.int16[w+0]=_,this.int16[w+1]=x,c},l}(Un);ac.prototype.bytesPerElement=4,_s("StructArrayLayout2i4",ac);var Ie=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(c,_,x,w){var T=this.length;return this.resize(T+1),this.emplace(T,c,_,x,w)},l.prototype.emplace=function(c,_,x,w,T){var $=4*c;return this.int16[$+0]=_,this.int16[$+1]=x,this.int16[$+2]=w,this.int16[$+3]=T,c},l}(Un);Ie.prototype.bytesPerElement=8,_s("StructArrayLayout4i8",Ie);var ko=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(c,_,x,w,T,$){var D=this.length;return this.resize(D+1),this.emplace(D,c,_,x,w,T,$)},l.prototype.emplace=function(c,_,x,w,T,$,D){var V=6*c;return this.int16[V+0]=_,this.int16[V+1]=x,this.int16[V+2]=w,this.int16[V+3]=T,this.int16[V+4]=$,this.int16[V+5]=D,c},l}(Un);ko.prototype.bytesPerElement=12,_s("StructArrayLayout2i4i12",ko);var Vi=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(c,_,x,w,T,$){var D=this.length;return this.resize(D+1),this.emplace(D,c,_,x,w,T,$)},l.prototype.emplace=function(c,_,x,w,T,$,D){var V=4*c,Z=8*c;return this.int16[V+0]=_,this.int16[V+1]=x,this.uint8[Z+4]=w,this.uint8[Z+5]=T,this.uint8[Z+6]=$,this.uint8[Z+7]=D,c},l}(Un);Vi.prototype.bytesPerElement=8,_s("StructArrayLayout2i4ub8",Vi);var ji=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(c,_){var x=this.length;return this.resize(x+1),this.emplace(x,c,_)},l.prototype.emplace=function(c,_,x){var w=2*c;return this.float32[w+0]=_,this.float32[w+1]=x,c},l}(Un);ji.prototype.bytesPerElement=8,_s("StructArrayLayout2f8",ji);var un=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(c,_,x,w,T,$,D,V,Z,K){var le=this.length;return this.resize(le+1),this.emplace(le,c,_,x,w,T,$,D,V,Z,K)},l.prototype.emplace=function(c,_,x,w,T,$,D,V,Z,K,le){var _e=10*c;return this.uint16[_e+0]=_,this.uint16[_e+1]=x,this.uint16[_e+2]=w,this.uint16[_e+3]=T,this.uint16[_e+4]=$,this.uint16[_e+5]=D,this.uint16[_e+6]=V,this.uint16[_e+7]=Z,this.uint16[_e+8]=K,this.uint16[_e+9]=le,c},l}(Un);un.prototype.bytesPerElement=20,_s("StructArrayLayout10ui20",un);var Kh=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(c,_,x,w,T,$,D,V,Z,K,le,_e){var Oe=this.length;return this.resize(Oe+1),this.emplace(Oe,c,_,x,w,T,$,D,V,Z,K,le,_e)},l.prototype.emplace=function(c,_,x,w,T,$,D,V,Z,K,le,_e,Oe){var Be=12*c;return this.int16[Be+0]=_,this.int16[Be+1]=x,this.int16[Be+2]=w,this.int16[Be+3]=T,this.uint16[Be+4]=$,this.uint16[Be+5]=D,this.uint16[Be+6]=V,this.uint16[Be+7]=Z,this.int16[Be+8]=K,this.int16[Be+9]=le,this.int16[Be+10]=_e,this.int16[Be+11]=Oe,c},l}(Un);Kh.prototype.bytesPerElement=24,_s("StructArrayLayout4i4ui4i24",Kh);var Nu=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(c,_,x){var w=this.length;return this.resize(w+1),this.emplace(w,c,_,x)},l.prototype.emplace=function(c,_,x,w){var T=3*c;return this.float32[T+0]=_,this.float32[T+1]=x,this.float32[T+2]=w,c},l}(Un);Nu.prototype.bytesPerElement=12,_s("StructArrayLayout3f12",Nu);var Pd=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(c){var _=this.length;return this.resize(_+1),this.emplace(_,c)},l.prototype.emplace=function(c,_){return this.uint32[1*c+0]=_,c},l}(Un);Pd.prototype.bytesPerElement=4,_s("StructArrayLayout1ul4",Pd);var xl=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(c,_,x,w,T,$,D,V,Z){var K=this.length;return this.resize(K+1),this.emplace(K,c,_,x,w,T,$,D,V,Z)},l.prototype.emplace=function(c,_,x,w,T,$,D,V,Z,K){var le=10*c,_e=5*c;return this.int16[le+0]=_,this.int16[le+1]=x,this.int16[le+2]=w,this.int16[le+3]=T,this.int16[le+4]=$,this.int16[le+5]=D,this.uint32[_e+3]=V,this.uint16[le+8]=Z,this.uint16[le+9]=K,c},l}(Un);xl.prototype.bytesPerElement=20,_s("StructArrayLayout6i1ul2ui20",xl);var Du=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(c,_,x,w,T,$){var D=this.length;return this.resize(D+1),this.emplace(D,c,_,x,w,T,$)},l.prototype.emplace=function(c,_,x,w,T,$,D){var V=6*c;return this.int16[V+0]=_,this.int16[V+1]=x,this.int16[V+2]=w,this.int16[V+3]=T,this.int16[V+4]=$,this.int16[V+5]=D,c},l}(Un);Du.prototype.bytesPerElement=12,_s("StructArrayLayout2i2i2i12",Du);var eu=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(c,_,x,w,T){var $=this.length;return this.resize($+1),this.emplace($,c,_,x,w,T)},l.prototype.emplace=function(c,_,x,w,T,$){var D=4*c,V=8*c;return this.float32[D+0]=_,this.float32[D+1]=x,this.float32[D+2]=w,this.int16[V+6]=T,this.int16[V+7]=$,c},l}(Un);eu.prototype.bytesPerElement=16,_s("StructArrayLayout2f1f2i16",eu);var vf=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(c,_,x,w){var T=this.length;return this.resize(T+1),this.emplace(T,c,_,x,w)},l.prototype.emplace=function(c,_,x,w,T){var $=12*c,D=3*c;return this.uint8[$+0]=_,this.uint8[$+1]=x,this.float32[D+1]=w,this.float32[D+2]=T,c},l}(Un);vf.prototype.bytesPerElement=12,_s("StructArrayLayout2ub2f12",vf);var lc=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(c,_,x){var w=this.length;return this.resize(w+1),this.emplace(w,c,_,x)},l.prototype.emplace=function(c,_,x,w){var T=3*c;return this.uint16[T+0]=_,this.uint16[T+1]=x,this.uint16[T+2]=w,c},l}(Un);lc.prototype.bytesPerElement=6,_s("StructArrayLayout3ui6",lc);var cc=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(c,_,x,w,T,$,D,V,Z,K,le,_e,Oe,Be,Xe,He,lt){var ft=this.length;return this.resize(ft+1),this.emplace(ft,c,_,x,w,T,$,D,V,Z,K,le,_e,Oe,Be,Xe,He,lt)},l.prototype.emplace=function(c,_,x,w,T,$,D,V,Z,K,le,_e,Oe,Be,Xe,He,lt,ft){var yt=24*c,xt=12*c,Pt=48*c;return this.int16[yt+0]=_,this.int16[yt+1]=x,this.uint16[yt+2]=w,this.uint16[yt+3]=T,this.uint32[xt+2]=$,this.uint32[xt+3]=D,this.uint32[xt+4]=V,this.uint16[yt+10]=Z,this.uint16[yt+11]=K,this.uint16[yt+12]=le,this.float32[xt+7]=_e,this.float32[xt+8]=Oe,this.uint8[Pt+36]=Be,this.uint8[Pt+37]=Xe,this.uint8[Pt+38]=He,this.uint32[xt+10]=lt,this.int16[yt+22]=ft,c},l}(Un);cc.prototype.bytesPerElement=48,_s("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",cc);var na=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(c,_,x,w,T,$,D,V,Z,K,le,_e,Oe,Be,Xe,He,lt,ft,yt,xt,Pt,Yt,Qt,Is,ls,Ms,us,sn){var Fs=this.length;return this.resize(Fs+1),this.emplace(Fs,c,_,x,w,T,$,D,V,Z,K,le,_e,Oe,Be,Xe,He,lt,ft,yt,xt,Pt,Yt,Qt,Is,ls,Ms,us,sn)},l.prototype.emplace=function(c,_,x,w,T,$,D,V,Z,K,le,_e,Oe,Be,Xe,He,lt,ft,yt,xt,Pt,Yt,Qt,Is,ls,Ms,us,sn,Fs){var bs=34*c,an=17*c;return this.int16[bs+0]=_,this.int16[bs+1]=x,this.int16[bs+2]=w,this.int16[bs+3]=T,this.int16[bs+4]=$,this.int16[bs+5]=D,this.int16[bs+6]=V,this.int16[bs+7]=Z,this.uint16[bs+8]=K,this.uint16[bs+9]=le,this.uint16[bs+10]=_e,this.uint16[bs+11]=Oe,this.uint16[bs+12]=Be,this.uint16[bs+13]=Xe,this.uint16[bs+14]=He,this.uint16[bs+15]=lt,this.uint16[bs+16]=ft,this.uint16[bs+17]=yt,this.uint16[bs+18]=xt,this.uint16[bs+19]=Pt,this.uint16[bs+20]=Yt,this.uint16[bs+21]=Qt,this.uint16[bs+22]=Is,this.uint32[an+12]=ls,this.float32[an+13]=Ms,this.float32[an+14]=us,this.float32[an+15]=sn,this.float32[an+16]=Fs,c},l}(Un);na.prototype.bytesPerElement=68,_s("StructArrayLayout8i15ui1ul4f68",na);var uc=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(c){var _=this.length;return this.resize(_+1),this.emplace(_,c)},l.prototype.emplace=function(c,_){return this.float32[1*c+0]=_,c},l}(Un);uc.prototype.bytesPerElement=4,_s("StructArrayLayout1f4",uc);var ra=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(c,_,x){var w=this.length;return this.resize(w+1),this.emplace(w,c,_,x)},l.prototype.emplace=function(c,_,x,w){var T=3*c;return this.int16[T+0]=_,this.int16[T+1]=x,this.int16[T+2]=w,c},l}(Un);ra.prototype.bytesPerElement=6,_s("StructArrayLayout3i6",ra);var bf=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(c,_,x){var w=this.length;return this.resize(w+1),this.emplace(w,c,_,x)},l.prototype.emplace=function(c,_,x,w){var T=4*c;return this.uint32[2*c+0]=_,this.uint16[T+2]=x,this.uint16[T+3]=w,c},l}(Un);bf.prototype.bytesPerElement=8,_s("StructArrayLayout1ul2ui8",bf);var Rd=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(c,_){var x=this.length;return this.resize(x+1),this.emplace(x,c,_)},l.prototype.emplace=function(c,_,x){var w=2*c;return this.uint16[w+0]=_,this.uint16[w+1]=x,c},l}(Un);Rd.prototype.bytesPerElement=4,_s("StructArrayLayout2ui4",Rd);var xf=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(c){var _=this.length;return this.resize(_+1),this.emplace(_,c)},l.prototype.emplace=function(c,_){return this.uint16[1*c+0]=_,c},l}(Un);xf.prototype.bytesPerElement=2,_s("StructArrayLayout1ui2",xf);var ia=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(c,_,x,w){var T=this.length;return this.resize(T+1),this.emplace(T,c,_,x,w)},l.prototype.emplace=function(c,_,x,w,T){var $=4*c;return this.float32[$+0]=_,this.float32[$+1]=x,this.float32[$+2]=w,this.float32[$+3]=T,c},l}(Un);ia.prototype.bytesPerElement=16,_s("StructArrayLayout4f16",ia);var u=function(i){function l(){i.apply(this,arguments)}i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l;var c={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return c.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},c.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},c.x1.get=function(){return this._structArray.int16[this._pos2+2]},c.y1.get=function(){return this._structArray.int16[this._pos2+3]},c.x2.get=function(){return this._structArray.int16[this._pos2+4]},c.y2.get=function(){return this._structArray.int16[this._pos2+5]},c.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},c.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},c.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},c.anchorPoint.get=function(){return new v(this.anchorPointX,this.anchorPointY)},Object.defineProperties(l.prototype,c),l}(Xh);u.prototype.size=20;var f=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.get=function(c){return new u(this,c)},l}(xl);_s("CollisionBoxArray",f);var h=function(i){function l(){i.apply(this,arguments)}i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l;var c={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return c.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},c.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},c.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},c.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},c.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},c.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},c.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},c.segment.get=function(){return this._structArray.uint16[this._pos2+10]},c.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},c.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},c.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},c.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},c.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},c.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},c.placedOrientation.set=function(_){this._structArray.uint8[this._pos1+37]=_},c.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},c.hidden.set=function(_){this._structArray.uint8[this._pos1+38]=_},c.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},c.crossTileID.set=function(_){this._structArray.uint32[this._pos4+10]=_},c.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(l.prototype,c),l}(Xh);h.prototype.size=48;var g=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.get=function(c){return new h(this,c)},l}(cc);_s("PlacedSymbolArray",g);var S=function(i){function l(){i.apply(this,arguments)}i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l;var c={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return c.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},c.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},c.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},c.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},c.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},c.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},c.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},c.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},c.key.get=function(){return this._structArray.uint16[this._pos2+8]},c.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},c.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},c.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},c.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},c.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},c.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},c.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},c.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},c.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},c.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},c.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},c.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},c.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},c.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},c.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},c.crossTileID.set=function(_){this._structArray.uint32[this._pos4+12]=_},c.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},c.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},c.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},c.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(l.prototype,c),l}(Xh);S.prototype.size=68;var M=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.get=function(c){return new S(this,c)},l}(na);_s("SymbolInstanceArray",M);var R=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.getoffsetX=function(c){return this.float32[1*c+0]},l}(uc);_s("GlyphOffsetArray",R);var N=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.getx=function(c){return this.int16[3*c+0]},l.prototype.gety=function(c){return this.int16[3*c+1]},l.prototype.gettileUnitDistanceFromAnchor=function(c){return this.int16[3*c+2]},l}(ra);_s("SymbolLineVertexArray",N);var H=function(i){function l(){i.apply(this,arguments)}i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l;var c={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return c.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},c.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},c.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(l.prototype,c),l}(Xh);H.prototype.size=8;var se=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.get=function(c){return new H(this,c)},l}(bf);_s("FeatureIndexArray",se);var ge=Qr([{name:"a_pos",components:2,type:"Int16"}],4).members,we=function(i){i===void 0&&(i=[]),this.segments=i};function Te(i,l){return 256*(i=q(Math.floor(i),0,255))+q(Math.floor(l),0,255)}we.prototype.prepareSegment=function(i,l,c,_){var x=this.segments[this.segments.length-1];return i>we.MAX_VERTEX_ARRAY_LENGTH&&Me("Max vertices per segment is "+we.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+i),(!x||x.vertexLength+i>we.MAX_VERTEX_ARRAY_LENGTH||x.sortKey!==_)&&(x={vertexOffset:l.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0},_!==void 0&&(x.sortKey=_),this.segments.push(x)),x},we.prototype.get=function(){return this.segments},we.prototype.destroy=function(){for(var i=0,l=this.segments;i<l.length;i+=1){var c=l[i];for(var _ in c.vaos)c.vaos[_].destroy()}},we.simpleSegment=function(i,l,c,_){return new we([{vertexOffset:i,primitiveOffset:l,vertexLength:c,primitiveLength:_,vaos:{},sortKey:0}])},we.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,_s("SegmentVector",we);var ze=Qr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),De=d(function(i){i.exports=function(l,c){var _,x,w,T,$,D,V,Z;for(x=l.length-(_=3&l.length),w=c,$=3432918353,D=461845907,Z=0;Z<x;)V=255&l.charCodeAt(Z)|(255&l.charCodeAt(++Z))<<8|(255&l.charCodeAt(++Z))<<16|(255&l.charCodeAt(++Z))<<24,++Z,w=27492+(65535&(T=5*(65535&(w=(w^=V=(65535&(V=(V=(65535&V)*$+(((V>>>16)*$&65535)<<16)&4294967295)<<15|V>>>17))*D+(((V>>>16)*D&65535)<<16)&4294967295)<<13|w>>>19))+((5*(w>>>16)&65535)<<16)&4294967295))+((58964+(T>>>16)&65535)<<16);switch(V=0,_){case 3:V^=(255&l.charCodeAt(Z+2))<<16;case 2:V^=(255&l.charCodeAt(Z+1))<<8;case 1:w^=V=(65535&(V=(V=(65535&(V^=255&l.charCodeAt(Z)))*$+(((V>>>16)*$&65535)<<16)&4294967295)<<15|V>>>17))*D+(((V>>>16)*D&65535)<<16)&4294967295}return w^=l.length,w=2246822507*(65535&(w^=w>>>16))+((2246822507*(w>>>16)&65535)<<16)&4294967295,w=3266489909*(65535&(w^=w>>>13))+((3266489909*(w>>>16)&65535)<<16)&4294967295,(w^=w>>>16)>>>0}}),Ye=d(function(i){i.exports=function(l,c){for(var _,x=l.length,w=c^x,T=0;x>=4;)_=1540483477*(65535&(_=255&l.charCodeAt(T)|(255&l.charCodeAt(++T))<<8|(255&l.charCodeAt(++T))<<16|(255&l.charCodeAt(++T))<<24))+((1540483477*(_>>>16)&65535)<<16),w=1540483477*(65535&w)+((1540483477*(w>>>16)&65535)<<16)^(_=1540483477*(65535&(_^=_>>>24))+((1540483477*(_>>>16)&65535)<<16)),x-=4,++T;switch(x){case 3:w^=(255&l.charCodeAt(T+2))<<16;case 2:w^=(255&l.charCodeAt(T+1))<<8;case 1:w=1540483477*(65535&(w^=255&l.charCodeAt(T)))+((1540483477*(w>>>16)&65535)<<16)}return w=1540483477*(65535&(w^=w>>>13))+((1540483477*(w>>>16)&65535)<<16),(w^=w>>>15)>>>0}}),Le=De,Ze=Ye;Le.murmur3=De,Le.murmur2=Ze;var tt=function(){this.ids=[],this.positions=[],this.indexed=!1};tt.prototype.add=function(i,l,c,_){this.ids.push(wt(i)),this.positions.push(l,c,_)},tt.prototype.getPositions=function(i){for(var l=wt(i),c=0,_=this.ids.length-1;c<_;){var x=c+_>>1;this.ids[x]>=l?_=x:c=x+1}for(var w=[];this.ids[c]===l;)w.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return w},tt.serialize=function(i,l){var c=new Float64Array(i.ids),_=new Uint32Array(i.positions);return function x(w,T,$,D){for(;$<D;){for(var V=w[$+D>>1],Z=$-1,K=D+1;;){do Z++;while(w[Z]<V);do K--;while(w[K]>V);if(Z>=K)break;bt(w,Z,K),bt(T,3*Z,3*K),bt(T,3*Z+1,3*K+1),bt(T,3*Z+2,3*K+2)}K-$<D-K?(x(w,T,$,K),$=K+1):(x(w,T,K+1,D),D=K)}}(c,_,0,c.length-1),l&&l.push(c.buffer,_.buffer),{ids:c,positions:_}},tt.deserialize=function(i){var l=new tt;return l.ids=i.ids,l.positions=i.positions,l.indexed=!0,l};var ut=Math.pow(2,53)-1;function wt(i){var l=+i;return!isNaN(l)&&l<=ut?l:Le(String(i))}function bt(i,l,c){var _=i[l];i[l]=i[c],i[c]=_}_s("FeaturePositionMap",tt);var It=function(i,l){this.gl=i.gl,this.location=l},Dt=function(i){function l(c,_){i.call(this,c,_),this.current=0}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.set=function(c){this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))},l}(It),Gt=function(i){function l(c,_){i.call(this,c,_),this.current=0}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.set=function(c){this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))},l}(It),Xt=function(i){function l(c,_){i.call(this,c,_),this.current=[0,0]}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.set=function(c){c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1]))},l}(It),as=function(i){function l(c,_){i.call(this,c,_),this.current=[0,0,0]}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.set=function(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2]))},l}(It),vs=function(i){function l(c,_){i.call(this,c,_),this.current=[0,0,0,0]}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.set=function(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3]))},l}(It),$s=function(i){function l(c,_){i.call(this,c,_),this.current=On.transparent}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.set=function(c){c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a))},l}(It),ks=new Float32Array(16),xn=function(i){function l(c,_){i.call(this,c,_),this.current=ks}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.set=function(c){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(var _=1;_<16;_++)if(c[_]!==this.current[_]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}},l}(It);function ps(i){return[Te(255*i.r,255*i.g),Te(255*i.b,255*i.a)]}var Ls=function(i,l,c){this.value=i,this.uniformNames=l.map(function(_){return"u_"+_}),this.type=c};Ls.prototype.setUniform=function(i,l,c){i.set(c.constantOr(this.value))},Ls.prototype.getBinding=function(i,l,c){return this.type==="color"?new $s(i,l):new Gt(i,l)};var Qs=function(i,l){this.uniformNames=l.map(function(c){return"u_"+c}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Qs.prototype.setConstantPatternPositions=function(i,l){this.pixelRatioFrom=l.pixelRatio,this.pixelRatioTo=i.pixelRatio,this.patternFrom=l.tlbr,this.patternTo=i.tlbr},Qs.prototype.setUniform=function(i,l,c,_){var x=_==="u_pattern_to"?this.patternTo:_==="u_pattern_from"?this.patternFrom:_==="u_pixel_ratio_to"?this.pixelRatioTo:_==="u_pixel_ratio_from"?this.pixelRatioFrom:null;x&&i.set(x)},Qs.prototype.getBinding=function(i,l,c){return c.substr(0,9)==="u_pattern"?new vs(i,l):new Gt(i,l)};var qs=function(i,l,c,_){this.expression=i,this.type=c,this.maxValue=0,this.paintVertexAttributes=l.map(function(x){return{name:"a_"+x,type:"Float32",components:c==="color"?2:1,offset:0}}),this.paintVertexArray=new _};qs.prototype.populatePaintArray=function(i,l,c,_,x){var w=this.paintVertexArray.length,T=this.expression.evaluate(new Bs(0),l,{},_,[],x);this.paintVertexArray.resize(i),this._setPaintValue(w,i,T)},qs.prototype.updatePaintArray=function(i,l,c,_){var x=this.expression.evaluate({zoom:0},c,_);this._setPaintValue(i,l,x)},qs.prototype._setPaintValue=function(i,l,c){if(this.type==="color")for(var _=ps(c),x=i;x<l;x++)this.paintVertexArray.emplace(x,_[0],_[1]);else{for(var w=i;w<l;w++)this.paintVertexArray.emplace(w,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}},qs.prototype.upload=function(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},qs.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var zs=function(i,l,c,_,x,w){this.expression=i,this.uniformNames=l.map(function(T){return"u_"+T+"_t"}),this.type=c,this.useIntegerZoom=_,this.zoom=x,this.maxValue=0,this.paintVertexAttributes=l.map(function(T){return{name:"a_"+T,type:"Float32",components:c==="color"?4:2,offset:0}}),this.paintVertexArray=new w};zs.prototype.populatePaintArray=function(i,l,c,_,x){var w=this.expression.evaluate(new Bs(this.zoom),l,{},_,[],x),T=this.expression.evaluate(new Bs(this.zoom+1),l,{},_,[],x),$=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue($,i,w,T)},zs.prototype.updatePaintArray=function(i,l,c,_){var x=this.expression.evaluate({zoom:this.zoom},c,_),w=this.expression.evaluate({zoom:this.zoom+1},c,_);this._setPaintValue(i,l,x,w)},zs.prototype._setPaintValue=function(i,l,c,_){if(this.type==="color")for(var x=ps(c),w=ps(_),T=i;T<l;T++)this.paintVertexArray.emplace(T,x[0],x[1],w[0],w[1]);else{for(var $=i;$<l;$++)this.paintVertexArray.emplace($,c,_);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(_))}},zs.prototype.upload=function(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},zs.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},zs.prototype.setUniform=function(i,l){var c=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,_=q(this.expression.interpolationFactor(c,this.zoom,this.zoom+1),0,1);i.set(_)},zs.prototype.getBinding=function(i,l,c){return new Gt(i,l)};var en=function(i,l,c,_,x,w){this.expression=i,this.type=l,this.useIntegerZoom=c,this.zoom=_,this.layerId=w,this.zoomInPaintVertexArray=new x,this.zoomOutPaintVertexArray=new x};en.prototype.populatePaintArray=function(i,l,c){var _=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(i),this.zoomOutPaintVertexArray.resize(i),this._setPaintValues(_,i,l.patterns&&l.patterns[this.layerId],c)},en.prototype.updatePaintArray=function(i,l,c,_,x){this._setPaintValues(i,l,c.patterns&&c.patterns[this.layerId],x)},en.prototype._setPaintValues=function(i,l,c,_){if(_&&c){var x=_[c.min],w=_[c.mid],T=_[c.max];if(x&&w&&T)for(var $=i;$<l;$++)this.zoomInPaintVertexArray.emplace($,w.tl[0],w.tl[1],w.br[0],w.br[1],x.tl[0],x.tl[1],x.br[0],x.br[1],w.pixelRatio,x.pixelRatio),this.zoomOutPaintVertexArray.emplace($,w.tl[0],w.tl[1],w.br[0],w.br[1],T.tl[0],T.tl[1],T.br[0],T.br[1],w.pixelRatio,T.pixelRatio)}},en.prototype.upload=function(i){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=i.createVertexBuffer(this.zoomInPaintVertexArray,ze.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=i.createVertexBuffer(this.zoomOutPaintVertexArray,ze.members,this.expression.isStateDependent))},en.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Vs=function(i,l,c){this.binders={},this._buffers=[];var _=[];for(var x in i.paint._values)if(c(x)){var w=i.paint.get(x);if(w instanceof mi&&gl(w.property.specification)){var T=ei(x,i.type),$=w.value,D=w.property.specification.type,V=w.property.useIntegerZoom,Z=w.property.specification["property-type"],K=Z==="cross-faded"||Z==="cross-faded-data-driven";if($.kind==="constant")this.binders[x]=K?new Qs($.value,T):new Ls($.value,T,D),_.push("/u_"+x);else if($.kind==="source"||K){var le=$r(x,D,"source");this.binders[x]=K?new en($,D,V,l,le,i.id):new qs($,T,D,le),_.push("/a_"+x)}else{var _e=$r(x,D,"composite");this.binders[x]=new zs($,T,D,V,l,_e),_.push("/z_"+x)}}}this.cacheKey=_.sort().join("")};Vs.prototype.getMaxValue=function(i){var l=this.binders[i];return l instanceof qs||l instanceof zs?l.maxValue:0},Vs.prototype.populatePaintArrays=function(i,l,c,_,x){for(var w in this.binders){var T=this.binders[w];(T instanceof qs||T instanceof zs||T instanceof en)&&T.populatePaintArray(i,l,c,_,x)}},Vs.prototype.setConstantPatternPositions=function(i,l){for(var c in this.binders){var _=this.binders[c];_ instanceof Qs&&_.setConstantPatternPositions(i,l)}},Vs.prototype.updatePaintArrays=function(i,l,c,_,x){var w=!1;for(var T in i)for(var $=0,D=l.getPositions(T);$<D.length;$+=1){var V=D[$],Z=c.feature(V.index);for(var K in this.binders){var le=this.binders[K];if((le instanceof qs||le instanceof zs||le instanceof en)&&le.expression.isStateDependent===!0){var _e=_.paint.get(K);le.expression=_e.value,le.updatePaintArray(V.start,V.end,Z,i[T],x),w=!0}}}return w},Vs.prototype.defines=function(){var i=[];for(var l in this.binders){var c=this.binders[l];(c instanceof Ls||c instanceof Qs)&&i.push.apply(i,c.uniformNames.map(function(_){return"#define HAS_UNIFORM_"+_}))}return i},Vs.prototype.getBinderAttributes=function(){var i=[];for(var l in this.binders){var c=this.binders[l];if(c instanceof qs||c instanceof zs)for(var _=0;_<c.paintVertexAttributes.length;_++)i.push(c.paintVertexAttributes[_].name);else if(c instanceof en)for(var x=0;x<ze.members.length;x++)i.push(ze.members[x].name)}return i},Vs.prototype.getBinderUniforms=function(){var i=[];for(var l in this.binders){var c=this.binders[l];if(c instanceof Ls||c instanceof Qs||c instanceof zs)for(var _=0,x=c.uniformNames;_<x.length;_+=1)i.push(x[_])}return i},Vs.prototype.getPaintVertexBuffers=function(){return this._buffers},Vs.prototype.getUniforms=function(i,l){var c=[];for(var _ in this.binders){var x=this.binders[_];if(x instanceof Ls||x instanceof Qs||x instanceof zs)for(var w=0,T=x.uniformNames;w<T.length;w+=1){var $=T[w];if(l[$]){var D=x.getBinding(i,l[$],$);c.push({name:$,property:_,binding:D})}}}return c},Vs.prototype.setUniforms=function(i,l,c,_){for(var x=0,w=l;x<w.length;x+=1){var T=w[x],$=T.name,D=T.property;this.binders[D].setUniform(T.binding,_,c.get(D),$)}},Vs.prototype.updatePaintBuffers=function(i){for(var l in this._buffers=[],this.binders){var c=this.binders[l];if(i&&c instanceof en){var _=i.fromScale===2?c.zoomInPaintVertexBuffer:c.zoomOutPaintVertexBuffer;_&&this._buffers.push(_)}else(c instanceof qs||c instanceof zs)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}},Vs.prototype.upload=function(i){for(var l in this.binders){var c=this.binders[l];(c instanceof qs||c instanceof zs||c instanceof en)&&c.upload(i)}this.updatePaintBuffers()},Vs.prototype.destroy=function(){for(var i in this.binders){var l=this.binders[i];(l instanceof qs||l instanceof zs||l instanceof en)&&l.destroy()}};var ws=function(i,l,c){c===void 0&&(c=function(){return!0}),this.programConfigurations={};for(var _=0,x=i;_<x.length;_+=1){var w=x[_];this.programConfigurations[w.id]=new Vs(w,l,c)}this.needsUpload=!1,this._featureMap=new tt,this._bufferOffset=0};function ei(i,l){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(l+"-","").replace(/-/g,"_")]}function $r(i,l,c){var _={color:{source:ji,composite:ia},number:{source:uc,composite:ji}},x=function(w){return{"line-pattern":{source:un,composite:un},"fill-pattern":{source:un,composite:un},"fill-extrusion-pattern":{source:un,composite:un}}[w]}(i);return x&&x[c]||_[l][c]}ws.prototype.populatePaintArrays=function(i,l,c,_,x,w){for(var T in this.programConfigurations)this.programConfigurations[T].populatePaintArrays(i,l,_,x,w);l.id!==void 0&&this._featureMap.add(l.id,c,this._bufferOffset,i),this._bufferOffset=i,this.needsUpload=!0},ws.prototype.updatePaintArrays=function(i,l,c,_){for(var x=0,w=c;x<w.length;x+=1){var T=w[x];this.needsUpload=this.programConfigurations[T.id].updatePaintArrays(i,this._featureMap,l,T,_)||this.needsUpload}},ws.prototype.get=function(i){return this.programConfigurations[i]},ws.prototype.upload=function(i){if(this.needsUpload){for(var l in this.programConfigurations)this.programConfigurations[l].upload(i);this.needsUpload=!1}},ws.prototype.destroy=function(){for(var i in this.programConfigurations)this.programConfigurations[i].destroy()},_s("ConstantBinder",Ls),_s("CrossFadedConstantBinder",Qs),_s("SourceExpressionBinder",qs),_s("CrossFadedCompositeBinder",en),_s("CompositeExpressionBinder",zs),_s("ProgramConfiguration",Vs,{omit:["_buffers"]}),_s("ProgramConfigurationSet",ws);var kr=Math.pow(2,14)-1,oi=-kr-1;function fr(i){for(var l=8192/i.extent,c=i.loadGeometry(),_=0;_<c.length;_++)for(var x=c[_],w=0;w<x.length;w++){var T=x[w],$=Math.round(T.x*l),D=Math.round(T.y*l);T.x=q($,oi,kr),T.y=q(D,oi,kr),($<T.x||$>T.x+1||D<T.y||D>T.y+1)&&Me("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return c}function ur(i,l){return{type:i.type,id:i.id,properties:i.properties,geometry:l?fr(i):[]}}function _o(i,l,c,_,x){i.emplaceBack(2*l+(_+1)/2,2*c+(x+1)/2)}var lr=function(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(function(l){return l.id}),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new ac,this.indexArray=new lc,this.segments=new we,this.programConfigurations=new ws(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(function(l){return l.isStateDependent()}).map(function(l){return l.id})};function qa(i,l){for(var c=0;c<i.length;c++)if(Ha(l,i[c]))return!0;for(var _=0;_<l.length;_++)if(Ha(i,l[_]))return!0;return!!tu(i,l)}function go(i,l,c){return!!Ha(i,l)||!!aa(l,i,c)}function Ra(i,l){if(i.length===1)return $d(l,i[0]);for(var c=0;c<l.length;c++)for(var _=l[c],x=0;x<_.length;x++)if(Ha(i,_[x]))return!0;for(var w=0;w<i.length;w++)if($d(l,i[w]))return!0;for(var T=0;T<l.length;T++)if(tu(i,l[T]))return!0;return!1}function oa(i,l,c){if(i.length>1){if(tu(i,l))return!0;for(var _=0;_<l.length;_++)if(aa(l[_],i,c))return!0}for(var x=0;x<i.length;x++)if(aa(i[x],l,c))return!0;return!1}function tu(i,l){if(i.length===0||l.length===0)return!1;for(var c=0;c<i.length-1;c++)for(var _=i[c],x=i[c+1],w=0;w<l.length-1;w++)if(Bu(_,x,l[w],l[w+1]))return!0;return!1}function Bu(i,l,c,_){return vt(i,c,_)!==vt(l,c,_)&&vt(i,l,c)!==vt(i,l,_)}function aa(i,l,c){var _=c*c;if(l.length===1)return i.distSqr(l[0])<_;for(var x=1;x<l.length;x++)if(su(i,l[x-1],l[x])<_)return!0;return!1}function su(i,l,c){var _=l.distSqr(c);if(_===0)return i.distSqr(l);var x=((i.x-l.x)*(c.x-l.x)+(i.y-l.y)*(c.y-l.y))/_;return i.distSqr(x<0?l:x>1?c:c.sub(l)._mult(x)._add(l))}function $d(i,l){for(var c,_,x,w=!1,T=0;T<i.length;T++)for(var $=0,D=(c=i[T]).length-1;$<c.length;D=$++)(_=c[$]).y>l.y!=(x=c[D]).y>l.y&&l.x<(x.x-_.x)*(l.y-_.y)/(x.y-_.y)+_.x&&(w=!w);return w}function Ha(i,l){for(var c=!1,_=0,x=i.length-1;_<i.length;x=_++){var w=i[_],T=i[x];w.y>l.y!=T.y>l.y&&l.x<(T.x-w.x)*(l.y-w.y)/(T.y-w.y)+w.x&&(c=!c)}return c}function wl(i,l,c){var _=c[0],x=c[2];if(i.x<_.x&&l.x<_.x||i.x>x.x&&l.x>x.x||i.y<_.y&&l.y<_.y||i.y>x.y&&l.y>x.y)return!1;var w=vt(i,l,c[0]);return w!==vt(i,l,c[1])||w!==vt(i,l,c[2])||w!==vt(i,l,c[3])}function Ga(i,l,c){var _=l.paint.get(i).value;return _.kind==="constant"?_.value:c.programConfigurations.get(l.id).getMaxValue(i)}function _i(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function $a(i,l,c,_,x){if(!l[0]&&!l[1])return i;var w=v.convert(l)._mult(x);c==="viewport"&&w._rotate(-_);for(var T=[],$=0;$<i.length;$++)T.push(i[$].sub(w));return T}lr.prototype.populate=function(i,l,c){var _=this.layers[0],x=[],w=null;_.type==="circle"&&(w=_.layout.get("circle-sort-key"));for(var T=0,$=i;T<$.length;T+=1){var D=$[T],V=D.feature,Z=D.id,K=D.index,le=D.sourceLayerIndex,_e=this.layers[0]._featureFilter.needGeometry,Oe=ur(V,_e);if(this.layers[0]._featureFilter.filter(new Bs(this.zoom),Oe,c)){var Be=w?w.evaluate(Oe,{},c):void 0,Xe={id:Z,properties:V.properties,type:V.type,sourceLayerIndex:le,index:K,geometry:_e?Oe.geometry:fr(V),patterns:{},sortKey:Be};x.push(Xe)}}w&&x.sort(function(Qt,Is){return Qt.sortKey-Is.sortKey});for(var He=0,lt=x;He<lt.length;He+=1){var ft=lt[He],yt=ft.geometry,xt=ft.index,Pt=ft.sourceLayerIndex,Yt=i[xt].feature;this.addFeature(ft,yt,xt,c),l.featureIndex.insert(Yt,yt,xt,Pt,this.index)}},lr.prototype.update=function(i,l,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,l,this.stateDependentLayers,c)},lr.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},lr.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},lr.prototype.upload=function(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,ge),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0},lr.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},lr.prototype.addFeature=function(i,l,c,_){for(var x=0,w=l;x<w.length;x+=1)for(var T=0,$=w[x];T<$.length;T+=1){var D=$[T],V=D.x,Z=D.y;if(!(V<0||V>=8192||Z<0||Z>=8192)){var K=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),le=K.vertexLength;_o(this.layoutVertexArray,V,Z,-1,-1),_o(this.layoutVertexArray,V,Z,1,-1),_o(this.layoutVertexArray,V,Z,1,1),_o(this.layoutVertexArray,V,Z,-1,1),this.indexArray.emplaceBack(le,le+1,le+2),this.indexArray.emplaceBack(le,le+3,le+2),K.vertexLength+=4,K.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,c,{},_)},_s("CircleBucket",lr,{omit:["layers"]});var Sl=new $i({"circle-sort-key":new gs(xe.layout_circle["circle-sort-key"])}),nu={paint:new $i({"circle-radius":new gs(xe.paint_circle["circle-radius"]),"circle-color":new gs(xe.paint_circle["circle-color"]),"circle-blur":new gs(xe.paint_circle["circle-blur"]),"circle-opacity":new gs(xe.paint_circle["circle-opacity"]),"circle-translate":new Ss(xe.paint_circle["circle-translate"]),"circle-translate-anchor":new Ss(xe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ss(xe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ss(xe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new gs(xe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new gs(xe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new gs(xe.paint_circle["circle-stroke-opacity"])}),layout:Sl},Ln=typeof Float32Array<"u"?Float32Array:Array;function qo(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function io(i,l,c){var _=l[0],x=l[1],w=l[2],T=l[3],$=l[4],D=l[5],V=l[6],Z=l[7],K=l[8],le=l[9],_e=l[10],Oe=l[11],Be=l[12],Xe=l[13],He=l[14],lt=l[15],ft=c[0],yt=c[1],xt=c[2],Pt=c[3];return i[0]=ft*_+yt*$+xt*K+Pt*Be,i[1]=ft*x+yt*D+xt*le+Pt*Xe,i[2]=ft*w+yt*V+xt*_e+Pt*He,i[3]=ft*T+yt*Z+xt*Oe+Pt*lt,i[4]=(ft=c[4])*_+(yt=c[5])*$+(xt=c[6])*K+(Pt=c[7])*Be,i[5]=ft*x+yt*D+xt*le+Pt*Xe,i[6]=ft*w+yt*V+xt*_e+Pt*He,i[7]=ft*T+yt*Z+xt*Oe+Pt*lt,i[8]=(ft=c[8])*_+(yt=c[9])*$+(xt=c[10])*K+(Pt=c[11])*Be,i[9]=ft*x+yt*D+xt*le+Pt*Xe,i[10]=ft*w+yt*V+xt*_e+Pt*He,i[11]=ft*T+yt*Z+xt*Oe+Pt*lt,i[12]=(ft=c[12])*_+(yt=c[13])*$+(xt=c[14])*K+(Pt=c[15])*Be,i[13]=ft*x+yt*D+xt*le+Pt*Xe,i[14]=ft*w+yt*V+xt*_e+Pt*He,i[15]=ft*T+yt*Z+xt*Oe+Pt*lt,i}Math.hypot||(Math.hypot=function(){for(var i=arguments,l=0,c=arguments.length;c--;)l+=i[c]*i[c];return Math.sqrt(l)});var Cl,Xg=io;function Fu(i,l,c){var _=l[0],x=l[1],w=l[2],T=l[3];return i[0]=c[0]*_+c[4]*x+c[8]*w+c[12]*T,i[1]=c[1]*_+c[5]*x+c[9]*w+c[13]*T,i[2]=c[2]*_+c[6]*x+c[10]*w+c[14]*T,i[3]=c[3]*_+c[7]*x+c[11]*w+c[15]*T,i}Cl=new Ln(3),Ln!=Float32Array&&(Cl[0]=0,Cl[1]=0,Cl[2]=0),function(){var i=new Ln(4);Ln!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0,i[3]=0)}();var Xm=(function(){var i=new Ln(2);Ln!=Float32Array&&(i[0]=0,i[1]=0)}(),function(i){function l(c){i.call(this,c,nu)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.createBucket=function(c){return new lr(c)},l.prototype.queryRadius=function(c){var _=c;return Ga("circle-radius",this,_)+Ga("circle-stroke-width",this,_)+_i(this.paint.get("circle-translate"))},l.prototype.queryIntersectsFeature=function(c,_,x,w,T,$,D,V){for(var Z=$a(c,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),$.angle,D),K=this.paint.get("circle-radius").evaluate(_,x)+this.paint.get("circle-stroke-width").evaluate(_,x),le=this.paint.get("circle-pitch-alignment")==="map",_e=le?Z:function(Yt,Qt){return Yt.map(function(Is){return zu(Is,Qt)})}(Z,V),Oe=le?K*D:K,Be=0,Xe=w;Be<Xe.length;Be+=1)for(var He=0,lt=Xe[Be];He<lt.length;He+=1){var ft=lt[He],yt=le?ft:zu(ft,V),xt=Oe,Pt=Fu([],[ft.x,ft.y,0,1],V);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?xt*=Pt[3]/$.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(xt*=$.cameraToCenterDistance/Pt[3]),go(_e,yt,xt))return!0}return!1},l}(ja));function zu(i,l){var c=Fu([],[i.x,i.y,0,1],l);return new v(c[0]/c[3],c[1]/c[3])}var wf=function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l}(lr);function Il(i,l,c,_){var x=l.width,w=l.height;if(_){if(_ instanceof Uint8ClampedArray)_=new Uint8Array(_.buffer);else if(_.length!==x*w*c)throw new RangeError("mismatched image size")}else _=new Uint8Array(x*w*c);return i.width=x,i.height=w,i.data=_,i}function Jh(i,l,c){var _=l.width,x=l.height;if(_!==i.width||x!==i.height){var w=Il({},{width:_,height:x},c);Km(i,w,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,_),height:Math.min(i.height,x)},c),i.width=_,i.height=x,i.data=w.data}}function Km(i,l,c,_,x,w){if(x.width===0||x.height===0)return l;if(x.width>i.width||x.height>i.height||c.x>i.width-x.width||c.y>i.height-x.height)throw new RangeError("out of range source coordinates for image copy");if(x.width>l.width||x.height>l.height||_.x>l.width-x.width||_.y>l.height-x.height)throw new RangeError("out of range destination coordinates for image copy");for(var T=i.data,$=l.data,D=0;D<x.height;D++)for(var V=((c.y+D)*i.width+c.x)*w,Z=((_.y+D)*l.width+_.x)*w,K=0;K<x.width*w;K++)$[Z+K]=T[V+K];return l}_s("HeatmapBucket",wf,{omit:["layers"]});var Uu=function(i,l){Il(this,i,1,l)};Uu.prototype.resize=function(i){Jh(this,i,1)},Uu.prototype.clone=function(){return new Uu({width:this.width,height:this.height},new Uint8Array(this.data))},Uu.copy=function(i,l,c,_,x){Km(i,l,c,_,x,1)};var Po=function(i,l){Il(this,i,4,l)};Po.prototype.resize=function(i){Jh(this,i,4)},Po.prototype.replace=function(i,l){l?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i},Po.prototype.clone=function(){return new Po({width:this.width,height:this.height},new Uint8Array(this.data))},Po.copy=function(i,l,c,_,x){Km(i,l,c,_,x,4)},_s("AlphaImage",Uu),_s("RGBAImage",Po);var c0={paint:new $i({"heatmap-radius":new gs(xe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new gs(xe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ss(xe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ro(xe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ss(xe.paint_heatmap["heatmap-opacity"])})};function u0(i){var l={},c=i.resolution||256,_=i.clips?i.clips.length:1,x=i.image||new Po({width:c,height:_}),w=function(Oe,Be,Xe){l[i.evaluationKey]=Xe;var He=i.expression.evaluate(l);x.data[Oe+Be+0]=Math.floor(255*He.r/He.a),x.data[Oe+Be+1]=Math.floor(255*He.g/He.a),x.data[Oe+Be+2]=Math.floor(255*He.b/He.a),x.data[Oe+Be+3]=Math.floor(255*He.a)};if(i.clips)for(var T=0,$=0;T<_;++T,$+=4*c)for(var D=0,V=0;D<c;D++,V+=4){var Z=D/(c-1),K=i.clips[T];w($,V,K.start*(1-Z)+K.end*Z)}else for(var le=0,_e=0;le<c;le++,_e+=4)w(0,_e,le/(c-1));return x}var Kg=function(i){function l(c){i.call(this,c,c0),this._updateColorRamp()}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.createBucket=function(c){return new wf(c)},l.prototype._handleSpecialPaintPropertyUpdate=function(c){c==="heatmap-color"&&this._updateColorRamp()},l.prototype._updateColorRamp=function(){this.colorRamp=u0({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},l.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},l.prototype.queryRadius=function(){return 0},l.prototype.queryIntersectsFeature=function(){return!1},l.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},l}(ja),d0={paint:new $i({"hillshade-illumination-direction":new Ss(xe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ss(xe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ss(xe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ss(xe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ss(xe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ss(xe.paint_hillshade["hillshade-accent-color"])})},Jg=function(i){function l(c){i.call(this,c,d0)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},l}(ja),Ux=Qr([{name:"a_pos",components:2,type:"Int16"}],4).members,Sf=Jm,kn=Jm;function Jm(i,l,c){c=c||2;var _,x,w,T,$,D,V,Z=l&&l.length,K=Z?l[0]*c:i.length,le=h0(i,0,K,c,!0),_e=[];if(!le||le.next===le.prev)return _e;if(Z&&(le=function(Be,Xe,He,lt){var ft,yt,xt,Pt=[];for(ft=0,yt=Xe.length;ft<yt;ft++)(xt=h0(Be,Xe[ft]*lt,ft<yt-1?Xe[ft+1]*lt:Be.length,lt,!1))===xt.next&&(xt.steiner=!0),Pt.push(Oa(xt));for(Pt.sort(Qm),ft=0;ft<Pt.length;ft++)Qg(Pt[ft],He),He=Wa(He,He.next);return He}(i,l,le,c)),i.length>80*c){_=w=i[0],x=T=i[1];for(var Oe=c;Oe<K;Oe+=c)($=i[Oe])<_&&(_=$),(D=i[Oe+1])<x&&(x=D),$>w&&(w=$),D>T&&(T=D);V=(V=Math.max(w-_,T-x))!==0?1/V:0}return Qh(le,_e,c,_,x,V),_e}function h0(i,l,c,_,x){var w,T;if(x===s_(i,l,c,_)>0)for(w=l;w<c;w+=_)T=ru(w,i[w],i[w+1],T);else for(w=c-_;w>=l;w-=_)T=ru(w,i[w],i[w+1],T);return T&&Od(T,T.next)&&(If(T),T=T.next),T}function Wa(i,l){if(!i)return i;l||(l=i);var c,_=i;do if(c=!1,_.steiner||!Od(_,_.next)&&ti(_.prev,_,_.next)!==0)_=_.next;else{if(If(_),(_=l=_.prev)===_.next)break;c=!0}while(c||_!==l);return l}function Qh(i,l,c,_,x,w,T){if(i){!T&&w&&function(Z,K,le,_e){var Oe=Z;do Oe.z===null&&(Oe.z=e_(Oe.x,Oe.y,K,le,_e)),Oe.prevZ=Oe.prev,Oe.nextZ=Oe.next,Oe=Oe.next;while(Oe!==Z);Oe.prevZ.nextZ=null,Oe.prevZ=null,function(Be){var Xe,He,lt,ft,yt,xt,Pt,Yt,Qt=1;do{for(He=Be,Be=null,yt=null,xt=0;He;){for(xt++,lt=He,Pt=0,Xe=0;Xe<Qt&&(Pt++,lt=lt.nextZ);Xe++);for(Yt=Qt;Pt>0||Yt>0&&lt;)Pt!==0&&(Yt===0||!lt||He.z<=lt.z)?(ft=He,He=He.nextZ,Pt--):(ft=lt,lt=lt.nextZ,Yt--),yt?yt.nextZ=ft:Be=ft,ft.prevZ=yt,yt=ft;He=lt}yt.nextZ=null,Qt*=2}while(xt>1)}(Oe)}(i,_,x,w);for(var $,D,V=i;i.prev!==i.next;)if($=i.prev,D=i.next,w?jx(i,_,x,w):Vx(i))l.push($.i/c),l.push(i.i/c),l.push(D.i/c),If(i),i=D.next,V=D.next;else if((i=D)===V){T?T===1?Qh(i=Ya(Wa(i),l,c),l,c,_,x,w,2):T===2&&qx(i,l,c,_,x,w):Qh(Wa(i),l,c,_,x,w,1);break}}}function Vx(i){var l=i.prev,c=i,_=i.next;if(ti(l,c,_)>=0)return!1;for(var x=i.next.next;x!==i.prev;){if(La(l.x,l.y,c.x,c.y,_.x,_.y,x.x,x.y)&&ti(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function jx(i,l,c,_){var x=i.prev,w=i,T=i.next;if(ti(x,w,T)>=0)return!1;for(var $=x.x>w.x?x.x>T.x?x.x:T.x:w.x>T.x?w.x:T.x,D=x.y>w.y?x.y>T.y?x.y:T.y:w.y>T.y?w.y:T.y,V=e_(x.x<w.x?x.x<T.x?x.x:T.x:w.x<T.x?w.x:T.x,x.y<w.y?x.y<T.y?x.y:T.y:w.y<T.y?w.y:T.y,l,c,_),Z=e_($,D,l,c,_),K=i.prevZ,le=i.nextZ;K&&K.z>=V&&le&&le.z<=Z;){if(K!==i.prev&&K!==i.next&&La(x.x,x.y,w.x,w.y,T.x,T.y,K.x,K.y)&&ti(K.prev,K,K.next)>=0||(K=K.prevZ,le!==i.prev&&le!==i.next&&La(x.x,x.y,w.x,w.y,T.x,T.y,le.x,le.y)&&ti(le.prev,le,le.next)>=0))return!1;le=le.nextZ}for(;K&&K.z>=V;){if(K!==i.prev&&K!==i.next&&La(x.x,x.y,w.x,w.y,T.x,T.y,K.x,K.y)&&ti(K.prev,K,K.next)>=0)return!1;K=K.prevZ}for(;le&&le.z<=Z;){if(le!==i.prev&&le!==i.next&&La(x.x,x.y,w.x,w.y,T.x,T.y,le.x,le.y)&&ti(le.prev,le,le.next)>=0)return!1;le=le.nextZ}return!0}function Ya(i,l,c){var _=i;do{var x=_.prev,w=_.next.next;!Od(x,w)&&ty(x,_,_.next,w)&&Ld(x,w)&&Ld(w,x)&&(l.push(x.i/c),l.push(_.i/c),l.push(w.i/c),If(_),If(_.next),_=i=w),_=_.next}while(_!==i);return Wa(_)}function qx(i,l,c,_,x,w){var T=i;do{for(var $=T.next.next;$!==T.prev;){if(T.i!==$.i&&ey(T,$)){var D=t_(T,$);return T=Wa(T,T.next),D=Wa(D,D.next),Qh(T,l,c,_,x,w),void Qh(D,l,c,_,x,w)}$=$.next}T=T.next}while(T!==i)}function Qm(i,l){return i.x-l.x}function Qg(i,l){if(l=function(_,x){var w,T=x,$=_.x,D=_.y,V=-1/0;do{if(D<=T.y&&D>=T.next.y&&T.next.y!==T.y){var Z=T.x+(D-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if(Z<=$&&Z>V){if(V=Z,Z===$){if(D===T.y)return T;if(D===T.next.y)return T.next}w=T.x<T.next.x?T:T.next}}T=T.next}while(T!==x);if(!w)return null;if($===V)return w;var K,le=w,_e=w.x,Oe=w.y,Be=1/0;T=w;do $>=T.x&&T.x>=_e&&$!==T.x&&La(D<Oe?$:V,D,_e,Oe,D<Oe?V:$,D,T.x,T.y)&&(K=Math.abs(D-T.y)/($-T.x),Ld(T,_)&&(K<Be||K===Be&&(T.x>w.x||T.x===w.x&&p0(w,T)))&&(w=T,Be=K)),T=T.next;while(T!==le);return w}(i,l)){var c=t_(l,i);Wa(l,l.next),Wa(c,c.next)}}function p0(i,l){return ti(i.prev,i,l.prev)<0&&ti(l.next,i,i.next)<0}function e_(i,l,c,_,x){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-c)*x)|i<<8))|i<<4))|i<<2))|i<<1))|(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=32767*(l-_)*x)|l<<8))|l<<4))|l<<2))|l<<1))<<1}function Oa(i){var l=i,c=i;do(l.x<c.x||l.x===c.x&&l.y<c.y)&&(c=l),l=l.next;while(l!==i);return c}function La(i,l,c,_,x,w,T,$){return(x-T)*(l-$)-(i-T)*(w-$)>=0&&(i-T)*(_-$)-(c-T)*(l-$)>=0&&(c-T)*(w-$)-(x-T)*(_-$)>=0}function ey(i,l){return i.next.i!==l.i&&i.prev.i!==l.i&&!function(c,_){var x=c;do{if(x.i!==c.i&&x.next.i!==c.i&&x.i!==_.i&&x.next.i!==_.i&&ty(x,x.next,c,_))return!0;x=x.next}while(x!==c);return!1}(i,l)&&(Ld(i,l)&&Ld(l,i)&&function(c,_){var x=c,w=!1,T=(c.x+_.x)/2,$=(c.y+_.y)/2;do x.y>$!=x.next.y>$&&x.next.y!==x.y&&T<(x.next.x-x.x)*($-x.y)/(x.next.y-x.y)+x.x&&(w=!w),x=x.next;while(x!==c);return w}(i,l)&&(ti(i.prev,i,l.prev)||ti(i,l.prev,l))||Od(i,l)&&ti(i.prev,i,i.next)>0&&ti(l.prev,l,l.next)>0)}function ti(i,l,c){return(l.y-i.y)*(c.x-l.x)-(l.x-i.x)*(c.y-l.y)}function Od(i,l){return i.x===l.x&&i.y===l.y}function ty(i,l,c,_){var x=Cf(ti(i,l,c)),w=Cf(ti(i,l,_)),T=Cf(ti(c,_,i)),$=Cf(ti(c,_,l));return x!==w&&T!==$||!(x!==0||!ep(i,c,l))||!(w!==0||!ep(i,_,l))||!(T!==0||!ep(c,i,_))||!($!==0||!ep(c,l,_))}function ep(i,l,c){return l.x<=Math.max(i.x,c.x)&&l.x>=Math.min(i.x,c.x)&&l.y<=Math.max(i.y,c.y)&&l.y>=Math.min(i.y,c.y)}function Cf(i){return i>0?1:i<0?-1:0}function Ld(i,l){return ti(i.prev,i,i.next)<0?ti(i,l,i.next)>=0&&ti(i,i.prev,l)>=0:ti(i,l,i.prev)<0||ti(i,i.next,l)<0}function t_(i,l){var c=new dc(i.i,i.x,i.y),_=new dc(l.i,l.x,l.y),x=i.next,w=l.prev;return i.next=l,l.prev=i,c.next=x,x.prev=c,_.next=c,c.prev=_,w.next=_,_.prev=w,_}function ru(i,l,c,_){var x=new dc(i,l,c);return _?(x.next=_.next,x.prev=_,_.next.prev=x,_.next=x):(x.prev=x,x.next=x),x}function If(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function dc(i,l,c){this.i=i,this.x=l,this.y=c,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function s_(i,l,c,_){for(var x=0,w=l,T=c-_;w<c;w+=_)x+=(i[T]-i[w])*(i[w+1]+i[T+1]),T=w;return x}function f0(i,l,c,_,x){(function w(T,$,D,V,Z){for(;V>D;){if(V-D>600){var K=V-D+1,le=$-D+1,_e=Math.log(K),Oe=.5*Math.exp(2*_e/3),Be=.5*Math.sqrt(_e*Oe*(K-Oe)/K)*(le-K/2<0?-1:1);w(T,$,Math.max(D,Math.floor($-le*Oe/K+Be)),Math.min(V,Math.floor($+(K-le)*Oe/K+Be)),Z)}var Xe=T[$],He=D,lt=V;for(Nd(T,D,$),Z(T[V],Xe)>0&&Nd(T,D,V);He<lt;){for(Nd(T,He,lt),He++,lt--;Z(T[He],Xe)<0;)He++;for(;Z(T[lt],Xe)>0;)lt--}Z(T[D],Xe)===0?Nd(T,D,lt):Nd(T,++lt,V),lt<=$&&(D=lt+1),$<=lt&&(V=lt-1)}})(i,l,c||0,_||i.length-1,x||Hx)}function Nd(i,l,c){var _=i[l];i[l]=i[c],i[c]=_}function Hx(i,l){return i<l?-1:i>l?1:0}function sy(i,l){var c=i.length;if(c<=1)return[i];for(var _,x,w=[],T=0;T<c;T++){var $=Ut(i[T]);$!==0&&(i[T].area=Math.abs($),x===void 0&&(x=$<0),x===$<0?(_&&w.push(_),_=[i[T]]):_.push(i[T]))}if(_&&w.push(_),l>1)for(var D=0;D<w.length;D++)w[D].length<=l||(f0(w[D],l,1,w[D].length-1,Gx),w[D]=w[D].slice(0,l));return w}function Gx(i,l){return l.area-i.area}function n_(i,l,c){for(var _=c.patternDependencies,x=!1,w=0,T=l;w<T.length;w+=1){var $=T[w].paint.get(i+"-pattern");$.isConstant()||(x=!0);var D=$.constantOr(null);D&&(x=!0,_[D.to]=!0,_[D.from]=!0)}return x}function r_(i,l,c,_,x){for(var w=x.patternDependencies,T=0,$=l;T<$.length;T+=1){var D=$[T],V=D.paint.get(i+"-pattern").value;if(V.kind!=="constant"){var Z=V.evaluate({zoom:_-1},c,{},x.availableImages),K=V.evaluate({zoom:_},c,{},x.availableImages),le=V.evaluate({zoom:_+1},c,{},x.availableImages);K=K&&K.name?K.name:K,le=le&&le.name?le.name:le,w[Z=Z&&Z.name?Z.name:Z]=!0,w[K]=!0,w[le]=!0,c.patterns[D.id]={min:Z,mid:K,max:le}}}return c}Jm.deviation=function(i,l,c,_){var x=l&&l.length,w=Math.abs(s_(i,0,x?l[0]*c:i.length,c));if(x)for(var T=0,$=l.length;T<$;T++)w-=Math.abs(s_(i,l[T]*c,T<$-1?l[T+1]*c:i.length,c));var D=0;for(T=0;T<_.length;T+=3){var V=_[T]*c,Z=_[T+1]*c,K=_[T+2]*c;D+=Math.abs((i[V]-i[K])*(i[Z+1]-i[V+1])-(i[V]-i[Z])*(i[K+1]-i[V+1]))}return w===0&&D===0?0:Math.abs((D-w)/w)},Jm.flatten=function(i){for(var l=i[0][0].length,c={vertices:[],holes:[],dimensions:l},_=0,x=0;x<i.length;x++){for(var w=0;w<i[x].length;w++)for(var T=0;T<l;T++)c.vertices.push(i[x][w][T]);x>0&&c.holes.push(_+=i[x-1].length)}return c},Sf.default=kn;var Tl=function(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(function(l){return l.id}),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ac,this.indexArray=new lc,this.indexArray2=new Rd,this.programConfigurations=new ws(i.layers,i.zoom),this.segments=new we,this.segments2=new we,this.stateDependentLayerIds=this.layers.filter(function(l){return l.isStateDependent()}).map(function(l){return l.id})};Tl.prototype.populate=function(i,l,c){this.hasPattern=n_("fill",this.layers,l);for(var _=this.layers[0].layout.get("fill-sort-key"),x=[],w=0,T=i;w<T.length;w+=1){var $=T[w],D=$.feature,V=$.id,Z=$.index,K=$.sourceLayerIndex,le=this.layers[0]._featureFilter.needGeometry,_e=ur(D,le);if(this.layers[0]._featureFilter.filter(new Bs(this.zoom),_e,c)){var Oe=_?_.evaluate(_e,{},c,l.availableImages):void 0,Be={id:V,properties:D.properties,type:D.type,sourceLayerIndex:K,index:Z,geometry:le?_e.geometry:fr(D),patterns:{},sortKey:Oe};x.push(Be)}}_&&x.sort(function(Yt,Qt){return Yt.sortKey-Qt.sortKey});for(var Xe=0,He=x;Xe<He.length;Xe+=1){var lt=He[Xe],ft=lt.geometry,yt=lt.index,xt=lt.sourceLayerIndex;if(this.hasPattern){var Pt=r_("fill",this.layers,lt,this.zoom,l);this.patternFeatures.push(Pt)}else this.addFeature(lt,ft,yt,c,{});l.featureIndex.insert(i[yt].feature,ft,yt,xt,this.index)}},Tl.prototype.update=function(i,l,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,l,this.stateDependentLayers,c)},Tl.prototype.addFeatures=function(i,l,c){for(var _=0,x=this.patternFeatures;_<x.length;_+=1){var w=x[_];this.addFeature(w,w.geometry,w.index,l,c)}},Tl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Tl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Tl.prototype.upload=function(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Ux),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0},Tl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Tl.prototype.addFeature=function(i,l,c,_,x){for(var w=0,T=sy(l,500);w<T.length;w+=1){for(var $=T[w],D=0,V=0,Z=$;V<Z.length;V+=1)D+=Z[V].length;for(var K=this.segments.prepareSegment(D,this.layoutVertexArray,this.indexArray),le=K.vertexLength,_e=[],Oe=[],Be=0,Xe=$;Be<Xe.length;Be+=1){var He=Xe[Be];if(He.length!==0){He!==$[0]&&Oe.push(_e.length/2);var lt=this.segments2.prepareSegment(He.length,this.layoutVertexArray,this.indexArray2),ft=lt.vertexLength;this.layoutVertexArray.emplaceBack(He[0].x,He[0].y),this.indexArray2.emplaceBack(ft+He.length-1,ft),_e.push(He[0].x),_e.push(He[0].y);for(var yt=1;yt<He.length;yt++)this.layoutVertexArray.emplaceBack(He[yt].x,He[yt].y),this.indexArray2.emplaceBack(ft+yt-1,ft+yt),_e.push(He[yt].x),_e.push(He[yt].y);lt.vertexLength+=He.length,lt.primitiveLength+=He.length}}for(var xt=Sf(_e,Oe),Pt=0;Pt<xt.length;Pt+=3)this.indexArray.emplaceBack(le+xt[Pt],le+xt[Pt+1],le+xt[Pt+2]);K.vertexLength+=D,K.primitiveLength+=xt.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,c,x,_)},_s("FillBucket",Tl,{omit:["layers","patternFeatures"]});var m0=new $i({"fill-sort-key":new gs(xe.layout_fill["fill-sort-key"])}),_0={paint:new $i({"fill-antialias":new Ss(xe.paint_fill["fill-antialias"]),"fill-opacity":new gs(xe.paint_fill["fill-opacity"]),"fill-color":new gs(xe.paint_fill["fill-color"]),"fill-outline-color":new gs(xe.paint_fill["fill-outline-color"]),"fill-translate":new Ss(xe.paint_fill["fill-translate"]),"fill-translate-anchor":new Ss(xe.paint_fill["fill-translate-anchor"]),"fill-pattern":new oc(xe.paint_fill["fill-pattern"])}),layout:m0},la=function(i){function l(c){i.call(this,c,_0)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.recalculate=function(c,_){i.prototype.recalculate.call(this,c,_);var x=this.paint._values["fill-outline-color"];x.value.kind==="constant"&&x.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},l.prototype.createBucket=function(c){return new Tl(c)},l.prototype.queryRadius=function(){return _i(this.paint.get("fill-translate"))},l.prototype.queryIntersectsFeature=function(c,_,x,w,T,$,D){return Ra($a(c,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),$.angle,D),w)},l.prototype.isTileClipped=function(){return!0},l}(ja),hc=Qr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,g0=tp;function tp(i,l,c,_,x){this.properties={},this.extent=c,this.type=0,this._pbf=i,this._geometry=-1,this._keys=_,this._values=x,i.readFields(i_,this,l)}function i_(i,l,c){i==1?l.id=c.readVarint():i==2?function(_,x){for(var w=_.readVarint()+_.pos;_.pos<w;){var T=x._keys[_.readVarint()],$=x._values[_.readVarint()];x.properties[T]=$}}(c,l):i==3?l.type=c.readVarint():i==4&&(l._geometry=c.pos)}function sp(i){for(var l,c,_=0,x=0,w=i.length,T=w-1;x<w;T=x++)_+=((c=i[T]).x-(l=i[x]).x)*(l.y+c.y);return _}tp.types=["Unknown","Point","LineString","Polygon"],tp.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var l,c=i.readVarint()+i.pos,_=1,x=0,w=0,T=0,$=[];i.pos<c;){if(x<=0){var D=i.readVarint();_=7&D,x=D>>3}if(x--,_===1||_===2)w+=i.readSVarint(),T+=i.readSVarint(),_===1&&(l&&$.push(l),l=[]),l.push(new v(w,T));else{if(_!==7)throw new Error("unknown command "+_);l&&l.push(l[0].clone())}}return l&&$.push(l),$},tp.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var l=i.readVarint()+i.pos,c=1,_=0,x=0,w=0,T=1/0,$=-1/0,D=1/0,V=-1/0;i.pos<l;){if(_<=0){var Z=i.readVarint();c=7&Z,_=Z>>3}if(_--,c===1||c===2)(x+=i.readSVarint())<T&&(T=x),x>$&&($=x),(w+=i.readSVarint())<D&&(D=w),w>V&&(V=w);else if(c!==7)throw new Error("unknown command "+c)}return[T,D,$,V]},tp.prototype.toGeoJSON=function(i,l,c){var _,x,w=this.extent*Math.pow(2,c),T=this.extent*i,$=this.extent*l,D=this.loadGeometry(),V=tp.types[this.type];function Z(_e){for(var Oe=0;Oe<_e.length;Oe++){var Be=_e[Oe];_e[Oe]=[360*(Be.x+T)/w-180,360/Math.PI*Math.atan(Math.exp((180-360*(Be.y+$)/w)*Math.PI/180))-90]}}switch(this.type){case 1:var K=[];for(_=0;_<D.length;_++)K[_]=D[_][0];Z(D=K);break;case 2:for(_=0;_<D.length;_++)Z(D[_]);break;case 3:for(D=function(_e){var Oe=_e.length;if(Oe<=1)return[_e];for(var Be,Xe,He=[],lt=0;lt<Oe;lt++){var ft=sp(_e[lt]);ft!==0&&(Xe===void 0&&(Xe=ft<0),Xe===ft<0?(Be&&He.push(Be),Be=[_e[lt]]):Be.push(_e[lt]))}return Be&&He.push(Be),He}(D),_=0;_<D.length;_++)for(x=0;x<D[_].length;x++)Z(D[_][x])}D.length===1?D=D[0]:V="Multi"+V;var le={type:"Feature",geometry:{type:V,coordinates:D},properties:this.properties};return"id"in this&&(le.id=this.id),le};var ny=ry;function ry(i,l){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(Wx,this,l),this.length=this._features.length}function Wx(i,l,c){i===15?l.version=c.readVarint():i===1?l.name=c.readString():i===5?l.extent=c.readVarint():i===2?l._features.push(c.pos):i===3?l._keys.push(c.readString()):i===4&&l._values.push(function(_){for(var x=null,w=_.readVarint()+_.pos;_.pos<w;){var T=_.readVarint()>>3;x=T===1?_.readString():T===2?_.readFloat():T===3?_.readDouble():T===4?_.readVarint64():T===5?_.readVarint():T===6?_.readSVarint():T===7?_.readBoolean():null}return x}(c))}function y0(i,l,c){if(i===3){var _=new ny(c,c.readVarint()+c.pos);_.length&&(l[_.name]=_)}}ry.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var l=this._pbf.readVarint()+this._pbf.pos;return new g0(this._pbf,l,this.extent,this._keys,this._values)};var Al={VectorTile:function(i,l){this.layers=i.readFields(y0,{},l)},VectorTileFeature:g0,VectorTileLayer:ny},Tf=Al.VectorTileFeature.types,iy=Math.pow(2,13);function np(i,l,c,_,x,w,T,$){i.emplaceBack(l,c,2*Math.floor(_*iy)+T,x*iy*2,w*iy*2,Math.round($))}var Za=function(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(function(l){return l.id}),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new ko,this.indexArray=new lc,this.programConfigurations=new ws(i.layers,i.zoom),this.segments=new we,this.stateDependentLayerIds=this.layers.filter(function(l){return l.isStateDependent()}).map(function(l){return l.id})};function o_(i,l){return i.x===l.x&&(i.x<0||i.x>8192)||i.y===l.y&&(i.y<0||i.y>8192)}Za.prototype.populate=function(i,l,c){this.features=[],this.hasPattern=n_("fill-extrusion",this.layers,l);for(var _=0,x=i;_<x.length;_+=1){var w=x[_],T=w.feature,$=w.id,D=w.index,V=w.sourceLayerIndex,Z=this.layers[0]._featureFilter.needGeometry,K=ur(T,Z);if(this.layers[0]._featureFilter.filter(new Bs(this.zoom),K,c)){var le={id:$,sourceLayerIndex:V,index:D,geometry:Z?K.geometry:fr(T),properties:T.properties,type:T.type,patterns:{}};this.hasPattern?this.features.push(r_("fill-extrusion",this.layers,le,this.zoom,l)):this.addFeature(le,le.geometry,D,c,{}),l.featureIndex.insert(T,le.geometry,D,V,this.index,!0)}}},Za.prototype.addFeatures=function(i,l,c){for(var _=0,x=this.features;_<x.length;_+=1){var w=x[_];this.addFeature(w,w.geometry,w.index,l,c)}},Za.prototype.update=function(i,l,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,l,this.stateDependentLayers,c)},Za.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Za.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Za.prototype.upload=function(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,hc),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0},Za.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Za.prototype.addFeature=function(i,l,c,_,x){for(var w=0,T=sy(l,500);w<T.length;w+=1){for(var $=T[w],D=0,V=0,Z=$;V<Z.length;V+=1)D+=Z[V].length;for(var K=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),le=0,_e=$;le<_e.length;le+=1){var Oe=_e[le];if(Oe.length!==0&&!((an=Oe).every(function(Ks){return Ks.x<0})||an.every(function(Ks){return Ks.x>8192})||an.every(function(Ks){return Ks.y<0})||an.every(function(Ks){return Ks.y>8192})))for(var Be=0,Xe=0;Xe<Oe.length;Xe++){var He=Oe[Xe];if(Xe>=1){var lt=Oe[Xe-1];if(!o_(He,lt)){K.vertexLength+4>we.MAX_VERTEX_ARRAY_LENGTH&&(K=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var ft=He.sub(lt)._perp()._unit(),yt=lt.dist(He);Be+yt>32768&&(Be=0),np(this.layoutVertexArray,He.x,He.y,ft.x,ft.y,0,0,Be),np(this.layoutVertexArray,He.x,He.y,ft.x,ft.y,0,1,Be),np(this.layoutVertexArray,lt.x,lt.y,ft.x,ft.y,0,0,Be+=yt),np(this.layoutVertexArray,lt.x,lt.y,ft.x,ft.y,0,1,Be);var xt=K.vertexLength;this.indexArray.emplaceBack(xt,xt+2,xt+1),this.indexArray.emplaceBack(xt+1,xt+2,xt+3),K.vertexLength+=4,K.primitiveLength+=2}}}}if(K.vertexLength+D>we.MAX_VERTEX_ARRAY_LENGTH&&(K=this.segments.prepareSegment(D,this.layoutVertexArray,this.indexArray)),Tf[i.type]==="Polygon"){for(var Pt=[],Yt=[],Qt=K.vertexLength,Is=0,ls=$;Is<ls.length;Is+=1){var Ms=ls[Is];if(Ms.length!==0){Ms!==$[0]&&Yt.push(Pt.length/2);for(var us=0;us<Ms.length;us++){var sn=Ms[us];np(this.layoutVertexArray,sn.x,sn.y,0,0,1,1,0),Pt.push(sn.x),Pt.push(sn.y)}}}for(var Fs=Sf(Pt,Yt),bs=0;bs<Fs.length;bs+=3)this.indexArray.emplaceBack(Qt+Fs[bs],Qt+Fs[bs+2],Qt+Fs[bs+1]);K.primitiveLength+=Fs.length/3,K.vertexLength+=D}}var an;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,c,x,_)},_s("FillExtrusionBucket",Za,{omit:["layers","features"]});var v0={paint:new $i({"fill-extrusion-opacity":new Ss(xe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new gs(xe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ss(xe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ss(xe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new oc(xe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new gs(xe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new gs(xe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ss(xe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},a_=function(i){function l(c){i.call(this,c,v0)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.createBucket=function(c){return new Za(c)},l.prototype.queryRadius=function(){return _i(this.paint.get("fill-extrusion-translate"))},l.prototype.is3D=function(){return!0},l.prototype.queryIntersectsFeature=function(c,_,x,w,T,$,D,V){var Z=$a(c,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),$.angle,D),K=this.paint.get("fill-extrusion-height").evaluate(_,x),le=this.paint.get("fill-extrusion-base").evaluate(_,x),_e=function(Be,Xe,He,lt){for(var ft=[],yt=0,xt=Be;yt<xt.length;yt+=1){var Pt=xt[yt],Yt=[Pt.x,Pt.y,0,1];Fu(Yt,Yt,Xe),ft.push(new v(Yt[0]/Yt[3],Yt[1]/Yt[3]))}return ft}(Z,V),Oe=function(Be,Xe,He,lt){for(var ft=[],yt=[],xt=lt[8]*Xe,Pt=lt[9]*Xe,Yt=lt[10]*Xe,Qt=lt[11]*Xe,Is=lt[8]*He,ls=lt[9]*He,Ms=lt[10]*He,us=lt[11]*He,sn=0,Fs=Be;sn<Fs.length;sn+=1){for(var bs=[],an=[],Ks=0,_n=Fs[sn];Ks<_n.length;Ks+=1){var Ps=_n[Ks],Pn=Ps.x,Ir=Ps.y,Tr=lt[0]*Pn+lt[4]*Ir+lt[12],mr=lt[1]*Pn+lt[5]*Ir+lt[13],Ar=lt[2]*Pn+lt[6]*Ir+lt[14],zr=lt[3]*Pn+lt[7]*Ir+lt[15],si=Ar+Yt,ci=zr+Qt,ao=Tr+Is,Ii=mr+ls,lo=Ar+Ms,Hr=zr+us,Ti=new v((Tr+xt)/ci,(mr+Pt)/ci);Ti.z=si/ci,bs.push(Ti);var fn=new v(ao/Hr,Ii/Hr);fn.z=lo/Hr,an.push(fn)}ft.push(bs),yt.push(an)}return[ft,yt]}(w,le,K,V);return function(Be,Xe,He){var lt=1/0;Ra(He,Xe)&&(lt=Af(He,Xe[0]));for(var ft=0;ft<Xe.length;ft++)for(var yt=Xe[ft],xt=Be[ft],Pt=0;Pt<yt.length-1;Pt++){var Yt=yt[Pt],Qt=[Yt,yt[Pt+1],xt[Pt+1],xt[Pt],Yt];qa(He,Qt)&&(lt=Math.min(lt,Af(He,Qt)))}return lt!==1/0&&lt}(Oe[0],Oe[1],_e)},l}(ja);function Dd(i,l){return i.x*l.x+i.y*l.y}function Af(i,l){if(i.length===1){for(var c,_=0,x=l[_++];!c||x.equals(c);)if(!(c=l[_++]))return 1/0;for(;_<l.length;_++){var w=l[_],T=i[0],$=c.sub(x),D=w.sub(x),V=T.sub(x),Z=Dd($,$),K=Dd($,D),le=Dd(D,D),_e=Dd(V,$),Oe=Dd(V,D),Be=Z*le-K*K,Xe=(le*_e-K*Oe)/Be,He=(Z*Oe-K*_e)/Be,lt=x.z*(1-Xe-He)+c.z*Xe+w.z*He;if(isFinite(lt))return lt}return 1/0}for(var ft=1/0,yt=0,xt=l;yt<xt.length;yt+=1)ft=Math.min(ft,xt[yt].z);return ft}var Yx=Qr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,b0=Qr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,l_=Al.VectorTileFeature.types,x0=Math.cos(Math.PI/180*37.5),c_=Math.pow(2,14)/.5,yo=function(i){var l=this;this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(function(c){return c.id}),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(c){l.gradients[c.id]={}}),this.layoutVertexArray=new Vi,this.layoutVertexArray2=new ji,this.indexArray=new lc,this.programConfigurations=new ws(i.layers,i.zoom),this.segments=new we,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(c){return c.isStateDependent()}).map(function(c){return c.id})};yo.prototype.populate=function(i,l,c){this.hasPattern=n_("line",this.layers,l);for(var _=this.layers[0].layout.get("line-sort-key"),x=[],w=0,T=i;w<T.length;w+=1){var $=T[w],D=$.feature,V=$.id,Z=$.index,K=$.sourceLayerIndex,le=this.layers[0]._featureFilter.needGeometry,_e=ur(D,le);if(this.layers[0]._featureFilter.filter(new Bs(this.zoom),_e,c)){var Oe=_?_.evaluate(_e,{},c):void 0,Be={id:V,properties:D.properties,type:D.type,sourceLayerIndex:K,index:Z,geometry:le?_e.geometry:fr(D),patterns:{},sortKey:Oe};x.push(Be)}}_&&x.sort(function(Yt,Qt){return Yt.sortKey-Qt.sortKey});for(var Xe=0,He=x;Xe<He.length;Xe+=1){var lt=He[Xe],ft=lt.geometry,yt=lt.index,xt=lt.sourceLayerIndex;if(this.hasPattern){var Pt=r_("line",this.layers,lt,this.zoom,l);this.patternFeatures.push(Pt)}else this.addFeature(lt,ft,yt,c,{});l.featureIndex.insert(i[yt].feature,ft,yt,xt,this.index)}},yo.prototype.update=function(i,l,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,l,this.stateDependentLayers,c)},yo.prototype.addFeatures=function(i,l,c){for(var _=0,x=this.patternFeatures;_<x.length;_+=1){var w=x[_];this.addFeature(w,w.geometry,w.index,l,c)}},yo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},yo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},yo.prototype.upload=function(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,b0)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Yx),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0},yo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},yo.prototype.lineFeatureClips=function(i){if(i.properties&&i.properties.hasOwnProperty("mapbox_clip_start")&&i.properties.hasOwnProperty("mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}},yo.prototype.addFeature=function(i,l,c,_,x){var w=this.layers[0].layout,T=w.get("line-join").evaluate(i,{}),$=w.get("line-cap"),D=w.get("line-miter-limit"),V=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(var Z=0,K=l;Z<K.length;Z+=1)this.addLine(K[Z],i,T,$,D,V);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,c,x,_)},yo.prototype.addLine=function(i,l,c,_,x,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var T=0;T<i.length-1;T++)this.totalDistance+=i[T].dist(i[T+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var $=l_[l.type]==="Polygon",D=i.length;D>=2&&i[D-1].equals(i[D-2]);)D--;for(var V=0;V<D-1&&i[V].equals(i[V+1]);)V++;if(!(D<($?3:2))){c==="bevel"&&(x=1.05);var Z,K=this.overscaling<=16?122880/(512*this.overscaling):0,le=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray),_e=void 0,Oe=void 0,Be=void 0,Xe=void 0;this.e1=this.e2=-1,$&&(Xe=i[V].sub(Z=i[D-2])._unit()._perp());for(var He=V;He<D;He++)if(!(Oe=He===D-1?$?i[V+1]:void 0:i[He+1])||!i[He].equals(Oe)){Xe&&(Be=Xe),Z&&(_e=Z),Z=i[He],Xe=Oe?Oe.sub(Z)._unit()._perp():Be;var lt=(Be=Be||Xe).add(Xe);lt.x===0&&lt.y===0||lt._unit();var ft=Be.x*Xe.x+Be.y*Xe.y,yt=lt.x*Xe.x+lt.y*Xe.y,xt=yt!==0?1/yt:1/0,Pt=2*Math.sqrt(2-2*yt),Yt=yt<x0&&_e&&Oe,Qt=Be.x*Xe.y-Be.y*Xe.x>0;if(Yt&&He>V){var Is=Z.dist(_e);if(Is>2*K){var ls=Z.sub(Z.sub(_e)._mult(K/Is)._round());this.updateDistance(_e,ls),this.addCurrentVertex(ls,Be,0,0,le),_e=ls}}var Ms=_e&&Oe,us=Ms?c:$?"butt":_;if(Ms&&us==="round"&&(xt<w?us="miter":xt<=2&&(us="fakeround")),us==="miter"&&xt>x&&(us="bevel"),us==="bevel"&&(xt>2&&(us="flipbevel"),xt<x&&(us="miter")),_e&&this.updateDistance(_e,Z),us==="miter")lt._mult(xt),this.addCurrentVertex(Z,lt,0,0,le);else if(us==="flipbevel"){if(xt>100)lt=Xe.mult(-1);else{var sn=xt*Be.add(Xe).mag()/Be.sub(Xe).mag();lt._perp()._mult(sn*(Qt?-1:1))}this.addCurrentVertex(Z,lt,0,0,le),this.addCurrentVertex(Z,lt.mult(-1),0,0,le)}else if(us==="bevel"||us==="fakeround"){var Fs=-Math.sqrt(xt*xt-1),bs=Qt?Fs:0,an=Qt?0:Fs;if(_e&&this.addCurrentVertex(Z,Be,bs,an,le),us==="fakeround")for(var Ks=Math.round(180*Pt/Math.PI/20),_n=1;_n<Ks;_n++){var Ps=_n/Ks;if(Ps!==.5){var Pn=Ps-.5;Ps+=Ps*Pn*(Ps-1)*((1.0904+ft*(ft*(3.55645-1.43519*ft)-3.2452))*Pn*Pn+(.848013+ft*(.215638*ft-1.06021)))}var Ir=Xe.sub(Be)._mult(Ps)._add(Be)._unit()._mult(Qt?-1:1);this.addHalfVertex(Z,Ir.x,Ir.y,!1,Qt,0,le)}Oe&&this.addCurrentVertex(Z,Xe,-bs,-an,le)}else if(us==="butt")this.addCurrentVertex(Z,lt,0,0,le);else if(us==="square"){var Tr=_e?1:-1;this.addCurrentVertex(Z,lt,Tr,Tr,le)}else us==="round"&&(_e&&(this.addCurrentVertex(Z,Be,0,0,le),this.addCurrentVertex(Z,Be,1,1,le,!0)),Oe&&(this.addCurrentVertex(Z,Xe,-1,-1,le,!0),this.addCurrentVertex(Z,Xe,0,0,le)));if(Yt&&He<D-1){var mr=Z.dist(Oe);if(mr>2*K){var Ar=Z.add(Oe.sub(Z)._mult(K/mr)._round());this.updateDistance(Z,Ar),this.addCurrentVertex(Ar,Xe,0,0,le),Z=Ar}}}}},yo.prototype.addCurrentVertex=function(i,l,c,_,x,w){w===void 0&&(w=!1);var T=l.y*_-l.x,$=-l.y-l.x*_;this.addHalfVertex(i,l.x+l.y*c,l.y-l.x*c,w,!1,c,x),this.addHalfVertex(i,T,$,w,!0,-_,x),this.distance>c_/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(i,l,c,_,x,w))},yo.prototype.addHalfVertex=function(i,l,c,_,x,w,T){var $=.5*(this.lineClips?this.scaledDistance*(c_-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((i.x<<1)+(_?1:0),(i.y<<1)+(x?1:0),Math.round(63*l)+128,Math.round(63*c)+128,1+(w===0?0:w<0?-1:1)|(63&$)<<2,$>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var D=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,D),T.primitiveLength++),x?this.e2=D:this.e1=D},yo.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},yo.prototype.updateDistance=function(i,l){this.distance+=i.dist(l),this.updateScaledDistance()},_s("LineBucket",yo,{omit:["layers","patternFeatures"]});var w0=new $i({"line-cap":new Ss(xe.layout_line["line-cap"]),"line-join":new gs(xe.layout_line["line-join"]),"line-miter-limit":new Ss(xe.layout_line["line-miter-limit"]),"line-round-limit":new Ss(xe.layout_line["line-round-limit"]),"line-sort-key":new gs(xe.layout_line["line-sort-key"])}),pc={paint:new $i({"line-opacity":new gs(xe.paint_line["line-opacity"]),"line-color":new gs(xe.paint_line["line-color"]),"line-translate":new Ss(xe.paint_line["line-translate"]),"line-translate-anchor":new Ss(xe.paint_line["line-translate-anchor"]),"line-width":new gs(xe.paint_line["line-width"]),"line-gap-width":new gs(xe.paint_line["line-gap-width"]),"line-offset":new gs(xe.paint_line["line-offset"]),"line-blur":new gs(xe.paint_line["line-blur"]),"line-dasharray":new Si(xe.paint_line["line-dasharray"]),"line-pattern":new oc(xe.paint_line["line-pattern"]),"line-gradient":new ro(xe.paint_line["line-gradient"])}),layout:w0},oy=new(function(i){function l(){i.apply(this,arguments)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.possiblyEvaluate=function(c,_){return _=new Bs(Math.floor(_.zoom),{now:_.now,fadeDuration:_.fadeDuration,zoomHistory:_.zoomHistory,transition:_.transition}),i.prototype.possiblyEvaluate.call(this,c,_)},l.prototype.evaluate=function(c,_,x,w){return _=re({},_,{zoom:Math.floor(_.zoom)}),i.prototype.evaluate.call(this,c,_,x,w)},l}(gs))(pc.paint.properties["line-width"].specification);oy.useIntegerZoom=!0;var S0=function(i){function l(c){i.call(this,c,pc),this.gradientVersion=0}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype._handleSpecialPaintPropertyUpdate=function(c){c==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Cn,this.gradientVersion=(this.gradientVersion+1)%O)},l.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},l.prototype.recalculate=function(c,_){i.prototype.recalculate.call(this,c,_),this.paint._values["line-floorwidth"]=oy.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)},l.prototype.createBucket=function(c){return new yo(c)},l.prototype.queryRadius=function(c){var _=c,x=C0(Ga("line-width",this,_),Ga("line-gap-width",this,_)),w=Ga("line-offset",this,_);return x/2+Math.abs(w)+_i(this.paint.get("line-translate"))},l.prototype.queryIntersectsFeature=function(c,_,x,w,T,$,D){var V=$a(c,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),$.angle,D),Z=D/2*C0(this.paint.get("line-width").evaluate(_,x),this.paint.get("line-gap-width").evaluate(_,x)),K=this.paint.get("line-offset").evaluate(_,x);return K&&(w=function(le,_e){for(var Oe=[],Be=new v(0,0),Xe=0;Xe<le.length;Xe++){for(var He=le[Xe],lt=[],ft=0;ft<He.length;ft++){var yt=He[ft],xt=He[ft+1],Pt=ft===0?Be:yt.sub(He[ft-1])._unit()._perp(),Yt=ft===He.length-1?Be:xt.sub(yt)._unit()._perp(),Qt=Pt._add(Yt)._unit();Qt._mult(1/(Qt.x*Yt.x+Qt.y*Yt.y)),lt.push(Qt._mult(_e)._add(yt))}Oe.push(lt)}return Oe}(w,K*D)),function(le,_e,Oe){for(var Be=0;Be<_e.length;Be++){var Xe=_e[Be];if(le.length>=3){for(var He=0;He<Xe.length;He++)if(Ha(le,Xe[He]))return!0}if(oa(le,Xe,Oe))return!0}return!1}(V,w,Z)},l.prototype.isTileClipped=function(){return!0},l}(ja);function C0(i,l){return l>0?l+2*i:i}var I0=Qr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Zx=Qr([{name:"a_projected_pos",components:3,type:"Float32"}],4),Xx=(Qr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Qr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),fc=(Qr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Qr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),ay=Qr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function ly(i,l,c){return i.sections.forEach(function(_){_.text=function(x,w,T){var $=w.layout.get("text-transform").evaluate(T,{});return $==="uppercase"?x=x.toLocaleUpperCase():$==="lowercase"&&(x=x.toLocaleLowerCase()),Vo.applyArabicShaping&&(x=Vo.applyArabicShaping(x)),x}(_.text,l,c)}),i}Qr([{name:"triangle",components:3,type:"Uint16"}]),Qr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Qr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Qr([{type:"Float32",name:"offsetX"}]),Qr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Bd={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Mf=function(i,l,c,_,x){var w,T,$=8*x-_-1,D=(1<<$)-1,V=D>>1,Z=-7,K=c?x-1:0,le=c?-1:1,_e=i[l+K];for(K+=le,w=_e&(1<<-Z)-1,_e>>=-Z,Z+=$;Z>0;w=256*w+i[l+K],K+=le,Z-=8);for(T=w&(1<<-Z)-1,w>>=-Z,Z+=_;Z>0;T=256*T+i[l+K],K+=le,Z-=8);if(w===0)w=1-V;else{if(w===D)return T?NaN:1/0*(_e?-1:1);T+=Math.pow(2,_),w-=V}return(_e?-1:1)*T*Math.pow(2,w-_)},Fd=function(i,l,c,_,x,w){var T,$,D,V=8*w-x-1,Z=(1<<V)-1,K=Z>>1,le=x===23?Math.pow(2,-24)-Math.pow(2,-77):0,_e=_?0:w-1,Oe=_?1:-1,Be=l<0||l===0&&1/l<0?1:0;for(l=Math.abs(l),isNaN(l)||l===1/0?($=isNaN(l)?1:0,T=Z):(T=Math.floor(Math.log(l)/Math.LN2),l*(D=Math.pow(2,-T))<1&&(T--,D*=2),(l+=T+K>=1?le/D:le*Math.pow(2,1-K))*D>=2&&(T++,D/=2),T+K>=Z?($=0,T=Z):T+K>=1?($=(l*D-1)*Math.pow(2,x),T+=K):($=l*Math.pow(2,K-1)*Math.pow(2,x),T=0));x>=8;i[c+_e]=255&$,_e+=Oe,$/=256,x-=8);for(T=T<<x|$,V+=x;V>0;i[c+_e]=255&T,_e+=Oe,T/=256,V-=8);i[c+_e-Oe]|=128*Be},Xs=Jn;function Jn(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}Jn.Varint=0,Jn.Fixed64=1,Jn.Bytes=2,Jn.Fixed32=5;var u_=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ho(i){return i.type===Jn.Bytes?i.readVarint()+i.pos:i.pos+1}function rp(i,l,c){return c?4294967296*l+(i>>>0):4294967296*(l>>>0)+(i>>>0)}function d_(i,l,c){var _=l<=16383?1:l<=2097151?2:l<=268435455?3:Math.floor(Math.log(l)/(7*Math.LN2));c.realloc(_);for(var x=c.pos-1;x>=i;x--)c.buf[x+_]=c.buf[x]}function T0(i,l){for(var c=0;c<i.length;c++)l.writeVarint(i[c])}function Ro(i,l){for(var c=0;c<i.length;c++)l.writeSVarint(i[c])}function Kx(i,l){for(var c=0;c<i.length;c++)l.writeFloat(i[c])}function Jx(i,l){for(var c=0;c<i.length;c++)l.writeDouble(i[c])}function A0(i,l){for(var c=0;c<i.length;c++)l.writeBoolean(i[c])}function Qx(i,l){for(var c=0;c<i.length;c++)l.writeFixed32(i[c])}function M0(i,l){for(var c=0;c<i.length;c++)l.writeSFixed32(i[c])}function ew(i,l){for(var c=0;c<i.length;c++)l.writeFixed64(i[c])}function tw(i,l){for(var c=0;c<i.length;c++)l.writeSFixed64(i[c])}function h_(i,l){return(i[l]|i[l+1]<<8|i[l+2]<<16)+16777216*i[l+3]}function ca(i,l,c){i[c]=l,i[c+1]=l>>>8,i[c+2]=l>>>16,i[c+3]=l>>>24}function $o(i,l){return(i[l]|i[l+1]<<8|i[l+2]<<16)+(i[l+3]<<24)}function cy(i,l,c){i===1&&c.readMessage(sw,l)}function sw(i,l,c){if(i===3){var _=c.readMessage(uy,{}),x=_.width,w=_.height,T=_.left,$=_.top,D=_.advance;l.push({id:_.id,bitmap:new Uu({width:x+6,height:w+6},_.bitmap),metrics:{width:x,height:w,left:T,top:$,advance:D}})}}function uy(i,l,c){i===1?l.id=c.readVarint():i===2?l.bitmap=c.readBytes():i===3?l.width=c.readVarint():i===4?l.height=c.readVarint():i===5?l.left=c.readSVarint():i===6?l.top=c.readSVarint():i===7&&(l.advance=c.readVarint())}function E0(i){for(var l=0,c=0,_=0,x=i;_<x.length;_+=1){var w=x[_];l+=w.w*w.h,c=Math.max(c,w.w)}i.sort(function(Be,Xe){return Xe.h-Be.h});for(var T=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(l/.95)),c),h:1/0}],$=0,D=0,V=0,Z=i;V<Z.length;V+=1)for(var K=Z[V],le=T.length-1;le>=0;le--){var _e=T[le];if(!(K.w>_e.w||K.h>_e.h)){if(K.x=_e.x,K.y=_e.y,D=Math.max(D,K.y+K.h),$=Math.max($,K.x+K.w),K.w===_e.w&&K.h===_e.h){var Oe=T.pop();le<T.length&&(T[le]=Oe)}else K.h===_e.h?(_e.x+=K.w,_e.w-=K.w):K.w===_e.w?(_e.y+=K.h,_e.h-=K.h):(T.push({x:_e.x+K.w,y:_e.y,w:_e.w-K.w,h:K.h}),_e.y+=K.h,_e.h-=K.h);break}}return{w:$,h:D,fill:l/($*D)||0}}Jn.prototype={destroy:function(){this.buf=null},readFields:function(i,l,c){for(c=c||this.length;this.pos<c;){var _=this.readVarint(),x=_>>3,w=this.pos;this.type=7&_,i(x,l,this),this.pos===w&&this.skip(_)}return l},readMessage:function(i,l){return this.readFields(i,l,this.readVarint()+this.pos)},readFixed32:function(){var i=h_(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=$o(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=h_(this.buf,this.pos)+4294967296*h_(this.buf,this.pos+4);return this.pos+=8,i},readSFixed64:function(){var i=h_(this.buf,this.pos)+4294967296*$o(this.buf,this.pos+4);return this.pos+=8,i},readFloat:function(){var i=Mf(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=Mf(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var l,c,_=this.buf;return l=127&(c=_[this.pos++]),c<128?l:(l|=(127&(c=_[this.pos++]))<<7,c<128?l:(l|=(127&(c=_[this.pos++]))<<14,c<128?l:(l|=(127&(c=_[this.pos++]))<<21,c<128?l:function(x,w,T){var $,D,V=T.buf;if($=(112&(D=V[T.pos++]))>>4,D<128||($|=(127&(D=V[T.pos++]))<<3,D<128)||($|=(127&(D=V[T.pos++]))<<10,D<128)||($|=(127&(D=V[T.pos++]))<<17,D<128)||($|=(127&(D=V[T.pos++]))<<24,D<128)||($|=(1&(D=V[T.pos++]))<<31,D<128))return rp(x,$,w);throw new Error("Expected varint not more than 10 bytes")}(l|=(15&(c=_[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var i=this.readVarint()+this.pos,l=this.pos;return this.pos=i,i-l>=12&&u_?function(c,_,x){return u_.decode(c.subarray(_,x))}(this.buf,l,i):function(c,_,x){for(var w="",T=_;T<x;){var $,D,V,Z=c[T],K=null,le=Z>239?4:Z>223?3:Z>191?2:1;if(T+le>x)break;le===1?Z<128&&(K=Z):le===2?(192&($=c[T+1]))==128&&(K=(31&Z)<<6|63&$)<=127&&(K=null):le===3?(D=c[T+2],(192&($=c[T+1]))==128&&(192&D)==128&&((K=(15&Z)<<12|(63&$)<<6|63&D)<=2047||K>=55296&&K<=57343)&&(K=null)):le===4&&(D=c[T+2],V=c[T+3],(192&($=c[T+1]))==128&&(192&D)==128&&(192&V)==128&&((K=(15&Z)<<18|(63&$)<<12|(63&D)<<6|63&V)<=65535||K>=1114112)&&(K=null)),K===null?(K=65533,le=1):K>65535&&(K-=65536,w+=String.fromCharCode(K>>>10&1023|55296),K=56320|1023&K),w+=String.fromCharCode(K),T+=le}return w}(this.buf,l,i)},readBytes:function(){var i=this.readVarint()+this.pos,l=this.buf.subarray(this.pos,i);return this.pos=i,l},readPackedVarint:function(i,l){if(this.type!==Jn.Bytes)return i.push(this.readVarint(l));var c=Ho(this);for(i=i||[];this.pos<c;)i.push(this.readVarint(l));return i},readPackedSVarint:function(i){if(this.type!==Jn.Bytes)return i.push(this.readSVarint());var l=Ho(this);for(i=i||[];this.pos<l;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==Jn.Bytes)return i.push(this.readBoolean());var l=Ho(this);for(i=i||[];this.pos<l;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==Jn.Bytes)return i.push(this.readFloat());var l=Ho(this);for(i=i||[];this.pos<l;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==Jn.Bytes)return i.push(this.readDouble());var l=Ho(this);for(i=i||[];this.pos<l;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==Jn.Bytes)return i.push(this.readFixed32());var l=Ho(this);for(i=i||[];this.pos<l;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==Jn.Bytes)return i.push(this.readSFixed32());var l=Ho(this);for(i=i||[];this.pos<l;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==Jn.Bytes)return i.push(this.readFixed64());var l=Ho(this);for(i=i||[];this.pos<l;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==Jn.Bytes)return i.push(this.readSFixed64());var l=Ho(this);for(i=i||[];this.pos<l;)i.push(this.readSFixed64());return i},skip:function(i){var l=7&i;if(l===Jn.Varint)for(;this.buf[this.pos++]>127;);else if(l===Jn.Bytes)this.pos=this.readVarint()+this.pos;else if(l===Jn.Fixed32)this.pos+=4;else{if(l!==Jn.Fixed64)throw new Error("Unimplemented type: "+l);this.pos+=8}},writeTag:function(i,l){this.writeVarint(i<<3|l)},realloc:function(i){for(var l=this.length||16;l<this.pos+i;)l*=2;if(l!==this.length){var c=new Uint8Array(l);c.set(this.buf),this.buf=c,this.length=l}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),ca(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),ca(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),ca(this.buf,-1&i,this.pos),ca(this.buf,Math.floor(i*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),ca(this.buf,-1&i,this.pos),ca(this.buf,Math.floor(i*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(l,c){var _,x;if(l>=0?(_=l%4294967296|0,x=l/4294967296|0):(x=~(-l/4294967296),4294967295^(_=~(-l%4294967296))?_=_+1|0:(_=0,x=x+1|0)),l>=18446744073709552e3||l<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),function(w,T,$){$.buf[$.pos++]=127&w|128,w>>>=7,$.buf[$.pos++]=127&w|128,w>>>=7,$.buf[$.pos++]=127&w|128,w>>>=7,$.buf[$.pos++]=127&w|128,$.buf[$.pos]=127&(w>>>=7)}(_,0,c),function(w,T){var $=(7&w)<<4;T.buf[T.pos++]|=$|((w>>>=3)?128:0),w&&(T.buf[T.pos++]=127&w|((w>>>=7)?128:0),w&&(T.buf[T.pos++]=127&w|((w>>>=7)?128:0),w&&(T.buf[T.pos++]=127&w|((w>>>=7)?128:0),w&&(T.buf[T.pos++]=127&w|((w>>>=7)?128:0),w&&(T.buf[T.pos++]=127&w)))))}(x,c)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(Boolean(i))},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var l=this.pos;this.pos=function(_,x,w){for(var T,$,D=0;D<x.length;D++){if((T=x.charCodeAt(D))>55295&&T<57344){if(!$){T>56319||D+1===x.length?(_[w++]=239,_[w++]=191,_[w++]=189):$=T;continue}if(T<56320){_[w++]=239,_[w++]=191,_[w++]=189,$=T;continue}T=$-55296<<10|T-56320|65536,$=null}else $&&(_[w++]=239,_[w++]=191,_[w++]=189,$=null);T<128?_[w++]=T:(T<2048?_[w++]=T>>6|192:(T<65536?_[w++]=T>>12|224:(_[w++]=T>>18|240,_[w++]=T>>12&63|128),_[w++]=T>>6&63|128),_[w++]=63&T|128)}return w}(this.buf,i,this.pos);var c=this.pos-l;c>=128&&d_(l,c,this),this.pos=l-1,this.writeVarint(c),this.pos+=c},writeFloat:function(i){this.realloc(4),Fd(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),Fd(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var l=i.length;this.writeVarint(l),this.realloc(l);for(var c=0;c<l;c++)this.buf[this.pos++]=i[c]},writeRawMessage:function(i,l){this.pos++;var c=this.pos;i(l,this);var _=this.pos-c;_>=128&&d_(c,_,this),this.pos=c-1,this.writeVarint(_),this.pos+=_},writeMessage:function(i,l,c){this.writeTag(i,Jn.Bytes),this.writeRawMessage(l,c)},writePackedVarint:function(i,l){l.length&&this.writeMessage(i,T0,l)},writePackedSVarint:function(i,l){l.length&&this.writeMessage(i,Ro,l)},writePackedBoolean:function(i,l){l.length&&this.writeMessage(i,A0,l)},writePackedFloat:function(i,l){l.length&&this.writeMessage(i,Kx,l)},writePackedDouble:function(i,l){l.length&&this.writeMessage(i,Jx,l)},writePackedFixed32:function(i,l){l.length&&this.writeMessage(i,Qx,l)},writePackedSFixed32:function(i,l){l.length&&this.writeMessage(i,M0,l)},writePackedFixed64:function(i,l){l.length&&this.writeMessage(i,ew,l)},writePackedSFixed64:function(i,l){l.length&&this.writeMessage(i,tw,l)},writeBytesField:function(i,l){this.writeTag(i,Jn.Bytes),this.writeBytes(l)},writeFixed32Field:function(i,l){this.writeTag(i,Jn.Fixed32),this.writeFixed32(l)},writeSFixed32Field:function(i,l){this.writeTag(i,Jn.Fixed32),this.writeSFixed32(l)},writeFixed64Field:function(i,l){this.writeTag(i,Jn.Fixed64),this.writeFixed64(l)},writeSFixed64Field:function(i,l){this.writeTag(i,Jn.Fixed64),this.writeSFixed64(l)},writeVarintField:function(i,l){this.writeTag(i,Jn.Varint),this.writeVarint(l)},writeSVarintField:function(i,l){this.writeTag(i,Jn.Varint),this.writeSVarint(l)},writeStringField:function(i,l){this.writeTag(i,Jn.Bytes),this.writeString(l)},writeFloatField:function(i,l){this.writeTag(i,Jn.Fixed32),this.writeFloat(l)},writeDoubleField:function(i,l){this.writeTag(i,Jn.Fixed64),this.writeDouble(l)},writeBooleanField:function(i,l){this.writeVarintField(i,Boolean(l))}};var p_=function(i,l){var c=l.pixelRatio,_=l.version,x=l.stretchX,w=l.stretchY,T=l.content;this.paddedRect=i,this.pixelRatio=c,this.stretchX=x,this.stretchY=w,this.content=T,this.version=_},iu={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};iu.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},iu.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},iu.tlbr.get=function(){return this.tl.concat(this.br)},iu.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(p_.prototype,iu);var ip=function(i,l){var c={},_={};this.haveRenderCallbacks=[];var x=[];this.addImages(i,c,x),this.addImages(l,_,x);var w=E0(x),T=new Po({width:w.w||1,height:w.h||1});for(var $ in i){var D=i[$],V=c[$].paddedRect;Po.copy(D.data,T,{x:0,y:0},{x:V.x+1,y:V.y+1},D.data)}for(var Z in l){var K=l[Z],le=_[Z].paddedRect,_e=le.x+1,Oe=le.y+1,Be=K.data.width,Xe=K.data.height;Po.copy(K.data,T,{x:0,y:0},{x:_e,y:Oe},K.data),Po.copy(K.data,T,{x:0,y:Xe-1},{x:_e,y:Oe-1},{width:Be,height:1}),Po.copy(K.data,T,{x:0,y:0},{x:_e,y:Oe+Xe},{width:Be,height:1}),Po.copy(K.data,T,{x:Be-1,y:0},{x:_e-1,y:Oe},{width:1,height:Xe}),Po.copy(K.data,T,{x:0,y:0},{x:_e+Be,y:Oe},{width:1,height:Xe})}this.image=T,this.iconPositions=c,this.patternPositions=_};ip.prototype.addImages=function(i,l,c){for(var _ in i){var x=i[_],w={x:0,y:0,w:x.data.width+2,h:x.data.height+2};c.push(w),l[_]=new p_(w,x),x.hasRenderCallback&&this.haveRenderCallbacks.push(_)}},ip.prototype.patchUpdatedImages=function(i,l){for(var c in i.dispatchRenderCallbacks(this.haveRenderCallbacks),i.updatedImages)this.patchUpdatedImage(this.iconPositions[c],i.getImage(c),l),this.patchUpdatedImage(this.patternPositions[c],i.getImage(c),l)},ip.prototype.patchUpdatedImage=function(i,l,c){if(i&&l&&i.version!==l.version){i.version=l.version;var _=i.tl;c.update(l.data,void 0,{x:_[0],y:_[1]})}},_s("ImagePosition",p_),_s("ImageAtlas",ip);var Go={horizontal:1,vertical:2,horizontalOnly:3},op=function(){this.scale=1,this.fontStack="",this.imageName=null};op.forText=function(i,l){var c=new op;return c.scale=i||1,c.fontStack=l,c},op.forImage=function(i){var l=new op;return l.imageName=i,l};var oo=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function f_(i,l,c,_,x,w,T,$,D,V,Z,K,le,_e,Oe,Be){var Xe,He=oo.fromFeature(i,x);K===Go.vertical&&He.verticalizePunctuation();var lt=Vo.processBidirectionalText,ft=Vo.processStyledBidirectionalText;if(lt&&He.sections.length===1){Xe=[];for(var yt=0,xt=lt(He.toString(),zd(He,V,w,l,_,_e,Oe));yt<xt.length;yt+=1){var Pt=xt[yt],Yt=new oo;Yt.text=Pt,Yt.sections=He.sections;for(var Qt=0;Qt<Pt.length;Qt++)Yt.sectionIndex.push(0);Xe.push(Yt)}}else if(ft){Xe=[];for(var Is=0,ls=ft(He.text,He.sectionIndex,zd(He,V,w,l,_,_e,Oe));Is<ls.length;Is+=1){var Ms=ls[Is],us=new oo;us.text=Ms[0],us.sectionIndex=Ms[1],us.sections=He.sections,Xe.push(us)}}else Xe=function(bs,an){for(var Ks=[],_n=bs.text,Ps=0,Pn=0,Ir=an;Pn<Ir.length;Pn+=1){var Tr=Ir[Pn];Ks.push(bs.substring(Ps,Tr)),Ps=Tr}return Ps<_n.length&&Ks.push(bs.substring(Ps,_n.length)),Ks}(He,zd(He,V,w,l,_,_e,Oe));var sn=[],Fs={positionedLines:sn,text:He.toString(),top:Z[1],bottom:Z[1],left:Z[0],right:Z[0],writingMode:K,iconsInText:!1,verticalizable:!1};return function(bs,an,Ks,_n,Ps,Pn,Ir,Tr,mr,Ar,zr,si){for(var ci=0,ao=-17,Ii=0,lo=0,Hr=Tr==="right"?1:Tr==="left"?0:.5,Ti=0,fn=0,nr=Ps;fn<nr.length;fn+=1){var Yn=nr[fn];Yn.trim();var In=Yn.getMaxScale(),vo=24*(In-1),qi={positionedGlyphs:[],lineOffset:0};bs.positionedLines[Ti]=qi;var _r=qi.positionedGlyphs,er=0;if(Yn.length()){for(var Hi=0;Hi<Yn.length();Hi++){var Rn=Yn.getSection(Hi),Lo=Yn.getSectionIndex(Hi),Ys=Yn.getCharCode(Hi),mc=0,Nn=null,gr=null,Ka=null,Na=24,Gd=!(mr===Go.horizontal||!zr&&!Ed(Ys)||zr&&(m_[Ys]||(Qa=Ys,ss.Arabic(Qa)||ss["Arabic Supplement"](Qa)||ss["Arabic Extended-A"](Qa)||ss["Arabic Presentation Forms-A"](Qa)||ss["Arabic Presentation Forms-B"](Qa))));if(Rn.imageName){var dp=_n[Rn.imageName];if(!dp)continue;Ka=Rn.imageName,bs.iconsInText=bs.iconsInText||!0,gr=dp.paddedRect;var cu=dp.displaySize;Rn.scale=24*Rn.scale/si,mc=vo+(24-cu[1]*Rn.scale),Na=(Nn={width:cu[0],height:cu[1],left:1,top:-3,advance:Gd?cu[1]:cu[0]}).advance;var hp=Gd?cu[0]*Rn.scale-24*In:cu[1]*Rn.scale-24*In;hp>0&&hp>er&&(er=hp)}else{var I_=Ks[Rn.fontStack],Hu=I_&&I_[Ys];if(Hu&&Hu.rect)gr=Hu.rect,Nn=Hu.metrics;else{var Of=an[Rn.fontStack],Ja=Of&&Of[Ys];if(!Ja)continue;Nn=Ja.metrics}mc=24*(In-Rn.scale)}Gd?(bs.verticalizable=!0,_r.push({glyph:Ys,imageName:Ka,x:ci,y:ao+mc,vertical:Gd,scale:Rn.scale,fontStack:Rn.fontStack,sectionIndex:Lo,metrics:Nn,rect:gr}),ci+=Na*Rn.scale+Ar):(_r.push({glyph:Ys,imageName:Ka,x:ci,y:ao+mc,vertical:Gd,scale:Rn.scale,fontStack:Rn.fontStack,sectionIndex:Lo,metrics:Nn,rect:gr}),ci+=Nn.advance*Rn.scale+Ar)}_r.length!==0&&(Ii=Math.max(ci-Ar,Ii),P0(_r,0,_r.length-1,Hr,er)),ci=0;var Lf=Pn*In+er;qi.lineOffset=Math.max(er,vo),ao+=Lf,lo=Math.max(Lf,lo),++Ti}else ao+=Pn,++Ti}var Qa,Or=ao- -17,Lr=Ef(Ir),uu=Lr.horizontalAlign,pp=Lr.verticalAlign;(function(T_,A_,Nf,Df,M_,fp,du,Wd,E_){var Yd,Zd=(A_-Nf)*M_;Yd=fp!==du?-Wd*Df- -17:(-Df*E_+.5)*du;for(var co=0,_c=T_;co<_c.length;co+=1)for(var Xd=0,Bf=_c[co].positionedGlyphs;Xd<Bf.length;Xd+=1){var mp=Bf[Xd];mp.x+=Zd,mp.y+=Yd}})(bs.positionedLines,Hr,uu,pp,Ii,lo,Pn,Or,Ps.length),bs.top+=-pp*Or,bs.bottom=bs.top+Or,bs.left+=-uu*Ii,bs.right=bs.left+Ii}(Fs,l,c,_,Xe,T,$,D,K,V,le,Be),!function(bs){for(var an=0,Ks=bs;an<Ks.length;an+=1)if(Ks[an].positionedGlyphs.length!==0)return!1;return!0}(sn)&&Fs}oo.fromFeature=function(i,l){for(var c=new oo,_=0;_<i.sections.length;_++){var x=i.sections[_];x.image?c.addImageSection(x):c.addTextSection(x,l)}return c},oo.prototype.length=function(){return this.text.length},oo.prototype.getSection=function(i){return this.sections[this.sectionIndex[i]]},oo.prototype.getSectionIndex=function(i){return this.sectionIndex[i]},oo.prototype.getCharCode=function(i){return this.text.charCodeAt(i)},oo.prototype.verticalizePunctuation=function(){this.text=function(i){for(var l="",c=0;c<i.length;c++){var _=i.charCodeAt(c+1)||null,x=i.charCodeAt(c-1)||null;l+=_&&Kc(_)&&!Bd[i[c+1]]||x&&Kc(x)&&!Bd[i[c-1]]||!Bd[i[c]]?i[c]:Bd[i[c]]}return l}(this.text)},oo.prototype.trim=function(){for(var i=0,l=0;l<this.text.length&&m_[this.text.charCodeAt(l)];l++)i++;for(var c=this.text.length,_=this.text.length-1;_>=0&&_>=i&&m_[this.text.charCodeAt(_)];_--)c--;this.text=this.text.substring(i,c),this.sectionIndex=this.sectionIndex.slice(i,c)},oo.prototype.substring=function(i,l){var c=new oo;return c.text=this.text.substring(i,l),c.sectionIndex=this.sectionIndex.slice(i,l),c.sections=this.sections,c},oo.prototype.toString=function(){return this.text},oo.prototype.getMaxScale=function(){var i=this;return this.sectionIndex.reduce(function(l,c){return Math.max(l,i.sections[c].scale)},0)},oo.prototype.addTextSection=function(i,l){this.text+=i.text,this.sections.push(op.forText(i.scale,i.fontStack||l));for(var c=this.sections.length-1,_=0;_<i.text.length;++_)this.sectionIndex.push(c)},oo.prototype.addImageSection=function(i){var l=i.image?i.image.name:"";if(l.length!==0){var c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(op.forImage(l)),this.sectionIndex.push(this.sections.length-1)):Me("Reached maximum number of images 6401")}else Me("Can't add FormattedSection with an empty image.")},oo.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var m_={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Oo={};function dy(i,l,c,_,x,w){if(l.imageName){var T=_[l.imageName];return T?T.displaySize[0]*l.scale*24/w+x:0}var $=c[l.fontStack],D=$&&$[i];return D?D.metrics.advance*l.scale+x:0}function k0(i,l,c,_){var x=Math.pow(i-l,2);return _?i<l?x/2:2*x:x+Math.abs(c)*c}function hy(i,l,c){var _=0;return i===10&&(_-=1e4),c&&(_+=150),i!==40&&i!==65288||(_+=50),l!==41&&l!==65289||(_+=50),_}function py(i,l,c,_,x,w){for(var T=null,$=k0(l,c,x,w),D=0,V=_;D<V.length;D+=1){var Z=V[D],K=k0(l-Z.x,c,x,w)+Z.badness;K<=$&&(T=Z,$=K)}return{index:i,x:l,priorBreak:T,badness:$}}function zd(i,l,c,_,x,w,T){if(w!=="point")return[];if(!i)return[];for(var $,D=[],V=function(Xe,He,lt,ft,yt,xt){for(var Pt=0,Yt=0;Yt<Xe.length();Yt++){var Qt=Xe.getSection(Yt);Pt+=dy(Xe.getCharCode(Yt),Qt,ft,yt,He,xt)}return Pt/Math.max(1,Math.ceil(Pt/lt))}(i,l,c,_,x,T),Z=i.text.indexOf("\u200B")>=0,K=0,le=0;le<i.length();le++){var _e=i.getSection(le),Oe=i.getCharCode(le);if(m_[Oe]||(K+=dy(Oe,_e,_,x,l,T)),le<i.length()-1){var Be=!(($=Oe)<11904||!(ss["Bopomofo Extended"]($)||ss.Bopomofo($)||ss["CJK Compatibility Forms"]($)||ss["CJK Compatibility Ideographs"]($)||ss["CJK Compatibility"]($)||ss["CJK Radicals Supplement"]($)||ss["CJK Strokes"]($)||ss["CJK Symbols and Punctuation"]($)||ss["CJK Unified Ideographs Extension A"]($)||ss["CJK Unified Ideographs"]($)||ss["Enclosed CJK Letters and Months"]($)||ss["Halfwidth and Fullwidth Forms"]($)||ss.Hiragana($)||ss["Ideographic Description Characters"]($)||ss["Kangxi Radicals"]($)||ss["Katakana Phonetic Extensions"]($)||ss.Katakana($)||ss["Vertical Forms"]($)||ss["Yi Radicals"]($)||ss["Yi Syllables"]($)));(Oo[Oe]||Be||_e.imageName)&&D.push(py(le+1,K,V,D,hy(Oe,i.getCharCode(le+1),Be&&Z),!1))}}return function Xe(He){return He?Xe(He.priorBreak).concat(He.index):[]}(py(i.length(),K,V,D,0,!0))}function Ef(i){var l=.5,c=.5;switch(i){case"right":case"top-right":case"bottom-right":l=1;break;case"left":case"top-left":case"bottom-left":l=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:l,verticalAlign:c}}function P0(i,l,c,_,x){if(_||x)for(var w=i[c],T=(i[c].x+w.metrics.advance*w.scale)*_,$=l;$<=c;$++)i[$].x-=T,i[$].y+=x}function fy(i,l,c,_,x,w){var T,$=i.image;if($.content){var D=$.content,V=$.pixelRatio||1;T=[D[0]/V,D[1]/V,$.displaySize[0]-D[2]/V,$.displaySize[1]-D[3]/V]}var Z,K,le,_e,Oe=l.left*w,Be=l.right*w;c==="width"||c==="both"?(_e=x[0]+Oe-_[3],K=x[0]+Be+_[1]):K=(_e=x[0]+(Oe+Be-$.displaySize[0])/2)+$.displaySize[0];var Xe=l.top*w,He=l.bottom*w;return c==="height"||c==="both"?(Z=x[1]+Xe-_[0],le=x[1]+He+_[2]):le=(Z=x[1]+(Xe+He-$.displaySize[1])/2)+$.displaySize[1],{image:$,top:Z,right:K,bottom:le,left:_e,collisionPadding:T}}Oo[10]=!0,Oo[32]=!0,Oo[38]=!0,Oo[40]=!0,Oo[41]=!0,Oo[43]=!0,Oo[45]=!0,Oo[47]=!0,Oo[173]=!0,Oo[183]=!0,Oo[8203]=!0,Oo[8208]=!0,Oo[8211]=!0,Oo[8231]=!0;var ou=function(i){function l(c,_,x,w){i.call(this,c,_),this.angle=x,w!==void 0&&(this.segment=w)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.clone=function(){return new l(this.x,this.y,this.angle,this.segment)},l}(v);function __(i,l){var c=l.expression;if(c.kind==="constant")return{kind:"constant",layoutSize:c.evaluate(new Bs(i+1))};if(c.kind==="source")return{kind:"source"};for(var _=c.zoomStops,x=c.interpolationType,w=0;w<_.length&&_[w]<=i;)w++;for(var T=w=Math.max(0,w-1);T<_.length&&_[T]<i+1;)T++;T=Math.min(_.length-1,T);var $=_[w],D=_[T];return c.kind==="composite"?{kind:"composite",minZoom:$,maxZoom:D,interpolationType:x}:{kind:"camera",minZoom:$,maxZoom:D,minSize:c.evaluate(new Bs($)),maxSize:c.evaluate(new Bs(D)),interpolationType:x}}function Ml(i,l,c){var _=l.uSize,x=c.lowerSize;return i.kind==="source"?x/128:i.kind==="composite"?Xr(x/128,c.upperSize/128,l.uSizeT):_}function Vu(i,l){var c=0,_=0;if(i.kind==="constant")_=i.layoutSize;else if(i.kind!=="source"){var x=i.interpolationType,w=x?q(xi.interpolationFactor(x,l,i.minZoom,i.maxZoom),0,1):0;i.kind==="camera"?_=Xr(i.minSize,i.maxSize,w):c=w}return{uSizeT:c,uSize:_}}_s("Anchor",ou);var nw=Object.freeze({__proto__:null,getSizeData:__,evaluateSizeForFeature:Ml,evaluateSizeForZoom:Vu,SIZE_PACK_FACTOR:128});function my(i,l,c,_,x){if(l.segment===void 0)return!0;for(var w=l,T=l.segment+1,$=0;$>-c/2;){if(--T<0)return!1;$-=i[T].dist(w),w=i[T]}$+=i[T].dist(i[T+1]),T++;for(var D=[],V=0;$<c/2;){var Z=i[T],K=i[T+1];if(!K)return!1;var le=i[T-1].angleTo(Z)-Z.angleTo(K);for(le=Math.abs((le+3*Math.PI)%(2*Math.PI)-Math.PI),D.push({distance:$,angleDelta:le}),V+=le;$-D[0].distance>_;)V-=D.shift().angleDelta;if(V>x)return!1;T++,$+=Z.dist(K)}return!0}function R0(i){for(var l=0,c=0;c<i.length-1;c++)l+=i[c].dist(i[c+1]);return l}function $0(i,l,c){return i?.6*l*c:0}function O0(i,l){return Math.max(i?i.right-i.left:0,l?l.right-l.left:0)}function rw(i,l,c,_,x,w){for(var T=$0(c,x,w),$=O0(c,_)*w,D=0,V=R0(i)/2,Z=0;Z<i.length-1;Z++){var K=i[Z],le=i[Z+1],_e=K.dist(le);if(D+_e>V){var Oe=(V-D)/_e,Be=Xr(K.x,le.x,Oe),Xe=Xr(K.y,le.y,Oe),He=new ou(Be,Xe,le.angleTo(K),Z);return He._round(),!T||my(i,He,$,T,l)?He:void 0}D+=_e}}function iw(i,l,c,_,x,w,T,$,D){var V=$0(_,w,T),Z=O0(_,x),K=Z*T,le=i[0].x===0||i[0].x===D||i[0].y===0||i[0].y===D;return l-K<l/4&&(l=K+l/4),function _e(Oe,Be,Xe,He,lt,ft,yt,xt,Pt){for(var Yt=ft/2,Qt=R0(Oe),Is=0,ls=Be-Xe,Ms=[],us=0;us<Oe.length-1;us++){for(var sn=Oe[us],Fs=Oe[us+1],bs=sn.dist(Fs),an=Fs.angleTo(sn);ls+Xe<Is+bs;){var Ks=((ls+=Xe)-Is)/bs,_n=Xr(sn.x,Fs.x,Ks),Ps=Xr(sn.y,Fs.y,Ks);if(_n>=0&&_n<Pt&&Ps>=0&&Ps<Pt&&ls-Yt>=0&&ls+Yt<=Qt){var Pn=new ou(_n,Ps,an,us);Pn._round(),He&&!my(Oe,Pn,ft,He,lt)||Ms.push(Pn)}}Is+=bs}return xt||Ms.length||yt||(Ms=_e(Oe,Is/2,Xe,He,lt,ft,yt,!0,Pt)),Ms}(i,le?l/2*$%l:(Z/2+2*w)*T*$%l,l,V,c,K,le,!1,D)}function L0(i,l,c,_,x){for(var w=[],T=0;T<i.length;T++)for(var $=i[T],D=void 0,V=0;V<$.length-1;V++){var Z=$[V],K=$[V+1];Z.x<l&&K.x<l||(Z.x<l?Z=new v(l,Z.y+(l-Z.x)/(K.x-Z.x)*(K.y-Z.y))._round():K.x<l&&(K=new v(l,Z.y+(l-Z.x)/(K.x-Z.x)*(K.y-Z.y))._round()),Z.y<c&&K.y<c||(Z.y<c?Z=new v(Z.x+(c-Z.y)/(K.y-Z.y)*(K.x-Z.x),c)._round():K.y<c&&(K=new v(Z.x+(c-Z.y)/(K.y-Z.y)*(K.x-Z.x),c)._round()),Z.x>=_&&K.x>=_||(Z.x>=_?Z=new v(_,Z.y+(_-Z.x)/(K.x-Z.x)*(K.y-Z.y))._round():K.x>=_&&(K=new v(_,Z.y+(_-Z.x)/(K.x-Z.x)*(K.y-Z.y))._round()),Z.y>=x&&K.y>=x||(Z.y>=x?Z=new v(Z.x+(x-Z.y)/(K.y-Z.y)*(K.x-Z.x),x)._round():K.y>=x&&(K=new v(Z.x+(x-Z.y)/(K.y-Z.y)*(K.x-Z.x),x)._round()),D&&Z.equals(D[D.length-1])||w.push(D=[Z]),D.push(K)))))}return w}function N0(i,l,c,_){var x=[],w=i.image,T=w.pixelRatio,$=w.paddedRect.w-2,D=w.paddedRect.h-2,V=i.right-i.left,Z=i.bottom-i.top,K=w.stretchX||[[0,$]],le=w.stretchY||[[0,D]],_e=function(_n,Ps){return _n+Ps[1]-Ps[0]},Oe=K.reduce(_e,0),Be=le.reduce(_e,0),Xe=$-Oe,He=D-Be,lt=0,ft=Oe,yt=0,xt=Be,Pt=0,Yt=Xe,Qt=0,Is=He;if(w.content&&_){var ls=w.content;lt=g_(K,0,ls[0]),yt=g_(le,0,ls[1]),ft=g_(K,ls[0],ls[2]),xt=g_(le,ls[1],ls[3]),Pt=ls[0]-lt,Qt=ls[1]-yt,Yt=ls[2]-ls[0]-ft,Is=ls[3]-ls[1]-xt}var Ms=function(_n,Ps,Pn,Ir){var Tr=y_(_n.stretch-lt,ft,V,i.left),mr=v_(_n.fixed-Pt,Yt,_n.stretch,Oe),Ar=y_(Ps.stretch-yt,xt,Z,i.top),zr=v_(Ps.fixed-Qt,Is,Ps.stretch,Be),si=y_(Pn.stretch-lt,ft,V,i.left),ci=v_(Pn.fixed-Pt,Yt,Pn.stretch,Oe),ao=y_(Ir.stretch-yt,xt,Z,i.top),Ii=v_(Ir.fixed-Qt,Is,Ir.stretch,Be),lo=new v(Tr,Ar),Hr=new v(si,Ar),Ti=new v(si,ao),fn=new v(Tr,ao),nr=new v(mr/T,zr/T),Yn=new v(ci/T,Ii/T),In=l*Math.PI/180;if(In){var vo=Math.sin(In),qi=Math.cos(In),_r=[qi,-vo,vo,qi];lo._matMult(_r),Hr._matMult(_r),fn._matMult(_r),Ti._matMult(_r)}var er=_n.stretch+_n.fixed,Hi=Ps.stretch+Ps.fixed;return{tl:lo,tr:Hr,bl:fn,br:Ti,tex:{x:w.paddedRect.x+1+er,y:w.paddedRect.y+1+Hi,w:Pn.stretch+Pn.fixed-er,h:Ir.stretch+Ir.fixed-Hi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:nr,pixelOffsetBR:Yn,minFontScaleX:Yt/T/V,minFontScaleY:Is/T/Z,isSDF:c}};if(_&&(w.stretchX||w.stretchY))for(var us=D0(K,Xe,Oe),sn=D0(le,He,Be),Fs=0;Fs<us.length-1;Fs++)for(var bs=us[Fs],an=us[Fs+1],Ks=0;Ks<sn.length-1;Ks++)x.push(Ms(bs,sn[Ks],an,sn[Ks+1]));else x.push(Ms({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:$+1},{fixed:0,stretch:D+1}));return x}function g_(i,l,c){for(var _=0,x=0,w=i;x<w.length;x+=1){var T=w[x];_+=Math.max(l,Math.min(c,T[1]))-Math.max(l,Math.min(c,T[0]))}return _}function D0(i,l,c){for(var _=[{fixed:-1,stretch:0}],x=0,w=i;x<w.length;x+=1){var T=w[x],$=T[0],D=T[1],V=_[_.length-1];_.push({fixed:$-V.stretch,stretch:V.stretch}),_.push({fixed:$-V.stretch,stretch:V.stretch+(D-$)})}return _.push({fixed:l+1,stretch:c}),_}function y_(i,l,c,_){return i/l*c+_}function v_(i,l,c,_){return i-l*c/_}var kf=function(i,l,c,_,x,w,T,$,D,V){if(this.boxStartIndex=i.length,D){var Z=w.top,K=w.bottom,le=w.collisionPadding;le&&(Z-=le[1],K+=le[3]);var _e=K-Z;_e>0&&(_e=Math.max(10,_e),this.circleDiameter=_e)}else{var Oe=w.top*T-$,Be=w.bottom*T+$,Xe=w.left*T-$,He=w.right*T+$,lt=w.collisionPadding;if(lt&&(Xe-=lt[0]*T,Oe-=lt[1]*T,He+=lt[2]*T,Be+=lt[3]*T),V){var ft=new v(Xe,Oe),yt=new v(He,Oe),xt=new v(Xe,Be),Pt=new v(He,Be),Yt=V*Math.PI/180;ft._rotate(Yt),yt._rotate(Yt),xt._rotate(Yt),Pt._rotate(Yt),Xe=Math.min(ft.x,yt.x,xt.x,Pt.x),He=Math.max(ft.x,yt.x,xt.x,Pt.x),Oe=Math.min(ft.y,yt.y,xt.y,Pt.y),Be=Math.max(ft.y,yt.y,xt.y,Pt.y)}i.emplaceBack(l.x,l.y,Xe,Oe,He,Be,c,_,x)}this.boxEndIndex=i.length},Ud=function(i,l){if(i===void 0&&(i=[]),l===void 0&&(l=B0),this.data=i,this.length=this.data.length,this.compare=l,this.length>0)for(var c=(this.length>>1)-1;c>=0;c--)this._down(c)};function B0(i,l){return i<l?-1:i>l?1:0}function ow(i,l,c){l===void 0&&(l=1),c===void 0&&(c=!1);for(var _=1/0,x=1/0,w=-1/0,T=-1/0,$=i[0],D=0;D<$.length;D++){var V=$[D];(!D||V.x<_)&&(_=V.x),(!D||V.y<x)&&(x=V.y),(!D||V.x>w)&&(w=V.x),(!D||V.y>T)&&(T=V.y)}var Z=Math.min(w-_,T-x),K=Z/2,le=new Ud([],aw);if(Z===0)return new v(_,x);for(var _e=_;_e<w;_e+=Z)for(var Oe=x;Oe<T;Oe+=Z)le.push(new ap(_e+K,Oe+K,K,i));for(var Be=function(lt){for(var ft=0,yt=0,xt=0,Pt=lt[0],Yt=0,Qt=Pt.length,Is=Qt-1;Yt<Qt;Is=Yt++){var ls=Pt[Yt],Ms=Pt[Is],us=ls.x*Ms.y-Ms.x*ls.y;yt+=(ls.x+Ms.x)*us,xt+=(ls.y+Ms.y)*us,ft+=3*us}return new ap(yt/ft,xt/ft,0,lt)}(i),Xe=le.length;le.length;){var He=le.pop();(He.d>Be.d||!Be.d)&&(Be=He,c&&console.log("found best %d after %d probes",Math.round(1e4*He.d)/1e4,Xe)),He.max-Be.d<=l||(le.push(new ap(He.p.x-(K=He.h/2),He.p.y-K,K,i)),le.push(new ap(He.p.x+K,He.p.y-K,K,i)),le.push(new ap(He.p.x-K,He.p.y+K,K,i)),le.push(new ap(He.p.x+K,He.p.y+K,K,i)),Xe+=4)}return c&&(console.log("num probes: "+Xe),console.log("best distance: "+Be.d)),Be.p}function aw(i,l){return l.max-i.max}function ap(i,l,c,_){this.p=new v(i,l),this.h=c,this.d=function(x,w){for(var T=!1,$=1/0,D=0;D<w.length;D++)for(var V=w[D],Z=0,K=V.length,le=K-1;Z<K;le=Z++){var _e=V[Z],Oe=V[le];_e.y>x.y!=Oe.y>x.y&&x.x<(Oe.x-_e.x)*(x.y-_e.y)/(Oe.y-_e.y)+_e.x&&(T=!T),$=Math.min($,su(x,_e,Oe))}return(T?1:-1)*Math.sqrt($)}(this.p,_),this.max=this.d+this.h*Math.SQRT2}Ud.prototype.push=function(i){this.data.push(i),this.length++,this._up(this.length-1)},Ud.prototype.pop=function(){if(this.length!==0){var i=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),i}},Ud.prototype.peek=function(){return this.data[0]},Ud.prototype._up=function(i){for(var l=this.data,c=this.compare,_=l[i];i>0;){var x=i-1>>1,w=l[x];if(c(_,w)>=0)break;l[i]=w,i=x}l[i]=_},Ud.prototype._down=function(i){for(var l=this.data,c=this.compare,_=this.length>>1,x=l[i];i<_;){var w=1+(i<<1),T=l[w],$=w+1;if($<this.length&&c(l[$],T)<0&&(w=$,T=l[$]),c(T,x)>=0)break;l[i]=T,i=w}l[i]=x};var b_=Number.POSITIVE_INFINITY;function F0(i,l){return l[1]!==b_?function(c,_,x){var w=0,T=0;switch(_=Math.abs(_),x=Math.abs(x),c){case"top-right":case"top-left":case"top":T=x-7;break;case"bottom-right":case"bottom-left":case"bottom":T=7-x}switch(c){case"top-right":case"bottom-right":case"right":w=-_;break;case"top-left":case"bottom-left":case"left":w=_}return[w,T]}(i,l[0],l[1]):function(c,_){var x=0,w=0;_<0&&(_=0);var T=_/Math.sqrt(2);switch(c){case"top-right":case"top-left":w=T-7;break;case"bottom-right":case"bottom-left":w=7-T;break;case"bottom":w=7-_;break;case"top":w=_-7}switch(c){case"top-right":case"bottom-right":x=-T;break;case"top-left":case"bottom-left":x=T;break;case"left":x=_;break;case"right":x=-_}return[x,w]}(i,l[0])}function _y(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function z0(i,l,c,_,x,w,T,$,D,V,Z,K,le,_e,Oe){var Be=function(yt,xt,Pt,Yt,Qt,Is,ls,Ms){for(var us=Yt.layout.get("text-rotate").evaluate(Is,{})*Math.PI/180,sn=[],Fs=0,bs=xt.positionedLines;Fs<bs.length;Fs+=1)for(var an=bs[Fs],Ks=0,_n=an.positionedGlyphs;Ks<_n.length;Ks+=1){var Ps=_n[Ks];if(Ps.rect){var Pn=Ps.rect||{},Ir=4,Tr=!0,mr=1,Ar=0,zr=(Qt||Ms)&&Ps.vertical,si=Ps.metrics.advance*Ps.scale/2;if(Ms&&xt.verticalizable&&(Ar=an.lineOffset/2-(Ps.imageName?-(24-Ps.metrics.width*Ps.scale)/2:24*(Ps.scale-1))),Ps.imageName){var ci=ls[Ps.imageName];Tr=ci.sdf,Ir=1/(mr=ci.pixelRatio)}var ao=Qt?[Ps.x+si,Ps.y]:[0,0],Ii=Qt?[0,0]:[Ps.x+si+Pt[0],Ps.y+Pt[1]-Ar],lo=[0,0];zr&&(lo=Ii,Ii=[0,0]);var Hr=(Ps.metrics.left-Ir)*Ps.scale-si+Ii[0],Ti=(-Ps.metrics.top-Ir)*Ps.scale+Ii[1],fn=Hr+Pn.w*Ps.scale/mr,nr=Ti+Pn.h*Ps.scale/mr,Yn=new v(Hr,Ti),In=new v(fn,Ti),vo=new v(Hr,nr),qi=new v(fn,nr);if(zr){var _r=new v(-si,si- -17),er=-Math.PI/2,Hi=12-si,Rn=new v(22-Hi,-(Ps.imageName?Hi:0)),Lo=new(Function.prototype.bind.apply(v,[null].concat(lo)));Yn._rotateAround(er,_r)._add(Rn)._add(Lo),In._rotateAround(er,_r)._add(Rn)._add(Lo),vo._rotateAround(er,_r)._add(Rn)._add(Lo),qi._rotateAround(er,_r)._add(Rn)._add(Lo)}if(us){var Ys=Math.sin(us),mc=Math.cos(us),Nn=[mc,-Ys,Ys,mc];Yn._matMult(Nn),In._matMult(Nn),vo._matMult(Nn),qi._matMult(Nn)}var gr=new v(0,0),Ka=new v(0,0);sn.push({tl:Yn,tr:In,bl:vo,br:qi,tex:Pn,writingMode:xt.writingMode,glyphOffset:ao,sectionIndex:Ps.sectionIndex,isSDF:Tr,pixelOffsetTL:gr,pixelOffsetBR:Ka,minFontScaleX:0,minFontScaleY:0})}}return sn}(0,c,$,x,w,T,_,i.allowVerticalPlacement),Xe=i.textSizeData,He=null;Xe.kind==="source"?(He=[128*x.layout.get("text-size").evaluate(T,{})])[0]>32640&&Me(i.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Xe.kind==="composite"&&((He=[128*_e.compositeTextSizes[0].evaluate(T,{},Oe),128*_e.compositeTextSizes[1].evaluate(T,{},Oe)])[0]>32640||He[1]>32640)&&Me(i.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),i.addSymbols(i.text,Be,He,$,w,T,V,l,D.lineStartIndex,D.lineLength,le,Oe);for(var lt=0,ft=Z;lt<ft.length;lt+=1)K[ft[lt]]=i.text.placedSymbolArray.length-1;return 4*Be.length}function U0(i){for(var l in i)return i[l];return null}function lw(i,l,c,_){var x=i.compareText;if(l in x){for(var w=x[l],T=w.length-1;T>=0;T--)if(_.dist(w[T])<c)return!0}else x[l]=[];return x[l].push(_),!1}var cw=Al.VectorTileFeature.types,Xa=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function x_(i,l,c,_,x,w,T,$,D,V,Z,K,le){var _e=$?Math.min(32640,Math.round($[0])):0,Oe=$?Math.min(32640,Math.round($[1])):0;i.emplaceBack(l,c,Math.round(32*_),Math.round(32*x),w,T,(_e<<1)+(D?1:0),Oe,16*V,16*Z,256*K,256*le)}function gy(i,l,c){i.emplaceBack(l.x,l.y,c),i.emplaceBack(l.x,l.y,c),i.emplaceBack(l.x,l.y,c),i.emplaceBack(l.x,l.y,c)}function uw(i){for(var l=0,c=i.sections;l<c.length;l+=1)if(Wh(c[l].text))return!0;return!1}var Vd=function(i){this.layoutVertexArray=new Kh,this.indexArray=new lc,this.programConfigurations=i,this.segments=new we,this.dynamicLayoutVertexArray=new Nu,this.opacityVertexArray=new Pd,this.placedSymbolArray=new g};Vd.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Vd.prototype.upload=function(i,l,c,_){this.isEmpty()||(c&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,I0.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,Zx.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,Xa,!0),this.opacityVertexBuffer.itemSize=1),(c||_)&&this.programConfigurations.upload(i))},Vd.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},_s("SymbolBuffers",Vd);var Pf=function(i,l,c){this.layoutVertexArray=new i,this.layoutAttributes=l,this.indexArray=new c,this.segments=new we,this.collisionVertexArray=new vf};Pf.prototype.upload=function(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,Xx.members,!0)},Pf.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},_s("CollisionBuffers",Pf);var Qn=function(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(function(w){return w.id}),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=qo([]),this.placementViewportMatrix=qo([]);var l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=__(this.zoom,l["text-size"]),this.iconSizeData=__(this.zoom,l["icon-size"]);var c=this.layers[0].layout,_=c.get("symbol-sort-key"),x=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=x!=="viewport-y"&&_.constantOr(1)!==void 0,this.sortFeaturesByY=(x==="viewport-y"||x==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,c.get("symbol-placement")==="point"&&(this.writingModes=c.get("text-writing-mode").map(function(w){return Go[w]})),this.stateDependentLayerIds=this.layers.filter(function(w){return w.isStateDependent()}).map(function(w){return w.id}),this.sourceID=i.sourceID};Qn.prototype.createArrays=function(){this.text=new Vd(new ws(this.layers,this.zoom,function(i){return/^text/.test(i)})),this.icon=new Vd(new ws(this.layers,this.zoom,function(i){return/^icon/.test(i)})),this.glyphOffsetArray=new R,this.lineVertexArray=new N,this.symbolInstances=new M},Qn.prototype.calculateGlyphDependencies=function(i,l,c,_,x){for(var w=0;w<i.length;w++)if(l[i.charCodeAt(w)]=!0,(c||_)&&x){var T=Bd[i.charAt(w)];T&&(l[T.charCodeAt(0)]=!0)}},Qn.prototype.populate=function(i,l,c){var _=this.layers[0],x=_.layout,w=x.get("text-font"),T=x.get("text-field"),$=x.get("icon-image"),D=(T.value.kind!=="constant"||T.value.value instanceof vi&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&(w.value.kind!=="constant"||w.value.value.length>0),V=$.value.kind!=="constant"||!!$.value.value||Object.keys($.parameters).length>0,Z=x.get("symbol-sort-key");if(this.features=[],D||V){for(var K=l.iconDependencies,le=l.glyphDependencies,_e=l.availableImages,Oe=new Bs(this.zoom),Be=0,Xe=i;Be<Xe.length;Be+=1){var He=Xe[Be],lt=He.feature,ft=He.id,yt=He.index,xt=He.sourceLayerIndex,Pt=_._featureFilter.needGeometry,Yt=ur(lt,Pt);if(_._featureFilter.filter(Oe,Yt,c)){Pt||(Yt.geometry=fr(lt));var Qt=void 0;if(D){var Is=_.getValueAndResolveTokens("text-field",Yt,c,_e),ls=vi.factory(Is);uw(ls)&&(this.hasRTLText=!0),(!this.hasRTLText||Zh()==="unavailable"||this.hasRTLText&&Vo.isParsed())&&(Qt=ly(ls,_,Yt))}var Ms=void 0;if(V){var us=_.getValueAndResolveTokens("icon-image",Yt,c,_e);Ms=us instanceof to?us:to.fromString(us)}if(Qt||Ms){var sn=this.sortFeaturesByKey?Z.evaluate(Yt,{},c):void 0;if(this.features.push({id:ft,text:Qt,icon:Ms,index:yt,sourceLayerIndex:xt,geometry:Yt.geometry,properties:lt.properties,type:cw[lt.type],sortKey:sn}),Ms&&(K[Ms.name]=!0),Qt){var Fs=w.evaluate(Yt,{},c).join(","),bs=x.get("text-rotation-alignment")==="map"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Go.vertical)>=0;for(var an=0,Ks=Qt.sections;an<Ks.length;an+=1){var _n=Ks[an];if(_n.image)K[_n.image.name]=!0;else{var Ps=Ou(Qt.toString()),Pn=_n.fontStack||Fs,Ir=le[Pn]=le[Pn]||{};this.calculateGlyphDependencies(_n.text,Ir,bs,this.allowVerticalPlacement,Ps)}}}}}}x.get("symbol-placement")==="line"&&(this.features=function(Tr){var mr={},Ar={},zr=[],si=0;function ci(_r){zr.push(Tr[_r]),si++}function ao(_r,er,Hi){var Rn=Ar[_r];return delete Ar[_r],Ar[er]=Rn,zr[Rn].geometry[0].pop(),zr[Rn].geometry[0]=zr[Rn].geometry[0].concat(Hi[0]),Rn}function Ii(_r,er,Hi){var Rn=mr[er];return delete mr[er],mr[_r]=Rn,zr[Rn].geometry[0].shift(),zr[Rn].geometry[0]=Hi[0].concat(zr[Rn].geometry[0]),Rn}function lo(_r,er,Hi){var Rn=Hi?er[0][er[0].length-1]:er[0][0];return _r+":"+Rn.x+":"+Rn.y}for(var Hr=0;Hr<Tr.length;Hr++){var Ti=Tr[Hr],fn=Ti.geometry,nr=Ti.text?Ti.text.toString():null;if(nr){var Yn=lo(nr,fn),In=lo(nr,fn,!0);if(Yn in Ar&&In in mr&&Ar[Yn]!==mr[In]){var vo=Ii(Yn,In,fn),qi=ao(Yn,In,zr[vo].geometry);delete mr[Yn],delete Ar[In],Ar[lo(nr,zr[qi].geometry,!0)]=qi,zr[vo].geometry=null}else Yn in Ar?ao(Yn,In,fn):In in mr?Ii(Yn,In,fn):(ci(Hr),mr[Yn]=si-1,Ar[In]=si-1)}else ci(Hr)}return zr.filter(function(_r){return _r.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Tr,mr){return Tr.sortKey-mr.sortKey})}},Qn.prototype.update=function(i,l,c){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(i,l,this.layers,c),this.icon.programConfigurations.updatePaintArrays(i,l,this.layers,c))},Qn.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Qn.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Qn.prototype.upload=function(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Qn.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Qn.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Qn.prototype.addToLineVertexArray=function(i,l){var c=this.lineVertexArray.length;if(i.segment!==void 0){for(var _=i.dist(l[i.segment+1]),x=i.dist(l[i.segment]),w={},T=i.segment+1;T<l.length;T++)w[T]={x:l[T].x,y:l[T].y,tileUnitDistanceFromAnchor:_},T<l.length-1&&(_+=l[T+1].dist(l[T]));for(var $=i.segment||0;$>=0;$--)w[$]={x:l[$].x,y:l[$].y,tileUnitDistanceFromAnchor:x},$>0&&(x+=l[$-1].dist(l[$]));for(var D=0;D<l.length;D++){var V=w[D];this.lineVertexArray.emplaceBack(V.x,V.y,V.tileUnitDistanceFromAnchor)}}return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}},Qn.prototype.addSymbols=function(i,l,c,_,x,w,T,$,D,V,Z,K){for(var le=i.indexArray,_e=i.layoutVertexArray,Oe=i.segments.prepareSegment(4*l.length,_e,le,this.canOverlap?w.sortKey:void 0),Be=this.glyphOffsetArray.length,Xe=Oe.vertexLength,He=this.allowVerticalPlacement&&T===Go.vertical?Math.PI/2:0,lt=w.text&&w.text.sections,ft=0;ft<l.length;ft++){var yt=l[ft],xt=yt.tl,Pt=yt.tr,Yt=yt.bl,Qt=yt.br,Is=yt.tex,ls=yt.pixelOffsetTL,Ms=yt.pixelOffsetBR,us=yt.minFontScaleX,sn=yt.minFontScaleY,Fs=yt.glyphOffset,bs=yt.isSDF,an=yt.sectionIndex,Ks=Oe.vertexLength,_n=Fs[1];x_(_e,$.x,$.y,xt.x,_n+xt.y,Is.x,Is.y,c,bs,ls.x,ls.y,us,sn),x_(_e,$.x,$.y,Pt.x,_n+Pt.y,Is.x+Is.w,Is.y,c,bs,Ms.x,ls.y,us,sn),x_(_e,$.x,$.y,Yt.x,_n+Yt.y,Is.x,Is.y+Is.h,c,bs,ls.x,Ms.y,us,sn),x_(_e,$.x,$.y,Qt.x,_n+Qt.y,Is.x+Is.w,Is.y+Is.h,c,bs,Ms.x,Ms.y,us,sn),gy(i.dynamicLayoutVertexArray,$,He),le.emplaceBack(Ks,Ks+1,Ks+2),le.emplaceBack(Ks+1,Ks+2,Ks+3),Oe.vertexLength+=4,Oe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Fs[0]),ft!==l.length-1&&an===l[ft+1].sectionIndex||i.programConfigurations.populatePaintArrays(_e.length,w,w.index,{},K,lt&&lt[an])}i.placedSymbolArray.emplaceBack($.x,$.y,Be,this.glyphOffsetArray.length-Be,Xe,D,V,$.segment,c?c[0]:0,c?c[1]:0,_[0],_[1],T,0,!1,0,Z)},Qn.prototype._addCollisionDebugVertex=function(i,l,c,_,x,w){return l.emplaceBack(0,0),i.emplaceBack(c.x,c.y,_,x,Math.round(w.x),Math.round(w.y))},Qn.prototype.addCollisionDebugVertices=function(i,l,c,_,x,w,T){var $=x.segments.prepareSegment(4,x.layoutVertexArray,x.indexArray),D=$.vertexLength,V=x.layoutVertexArray,Z=x.collisionVertexArray,K=T.anchorX,le=T.anchorY;this._addCollisionDebugVertex(V,Z,w,K,le,new v(i,l)),this._addCollisionDebugVertex(V,Z,w,K,le,new v(c,l)),this._addCollisionDebugVertex(V,Z,w,K,le,new v(c,_)),this._addCollisionDebugVertex(V,Z,w,K,le,new v(i,_)),$.vertexLength+=4;var _e=x.indexArray;_e.emplaceBack(D,D+1),_e.emplaceBack(D+1,D+2),_e.emplaceBack(D+2,D+3),_e.emplaceBack(D+3,D),$.primitiveLength+=4},Qn.prototype.addDebugCollisionBoxes=function(i,l,c,_){for(var x=i;x<l;x++){var w=this.collisionBoxArray.get(x);this.addCollisionDebugVertices(w.x1,w.y1,w.x2,w.y2,_?this.textCollisionBox:this.iconCollisionBox,w.anchorPoint,c)}},Qn.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Pf(Du,fc.members,Rd),this.iconCollisionBox=new Pf(Du,fc.members,Rd);for(var i=0;i<this.symbolInstances.length;i++){var l=this.symbolInstances.get(i);this.addDebugCollisionBoxes(l.textBoxStartIndex,l.textBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.iconBoxStartIndex,l.iconBoxEndIndex,l,!1),this.addDebugCollisionBoxes(l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex,l,!1)}},Qn.prototype._deserializeCollisionBoxesForSymbol=function(i,l,c,_,x,w,T,$,D){for(var V={},Z=l;Z<c;Z++){var K=i.get(Z);V.textBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},V.textFeatureIndex=K.featureIndex;break}for(var le=_;le<x;le++){var _e=i.get(le);V.verticalTextBox={x1:_e.x1,y1:_e.y1,x2:_e.x2,y2:_e.y2,anchorPointX:_e.anchorPointX,anchorPointY:_e.anchorPointY},V.verticalTextFeatureIndex=_e.featureIndex;break}for(var Oe=w;Oe<T;Oe++){var Be=i.get(Oe);V.iconBox={x1:Be.x1,y1:Be.y1,x2:Be.x2,y2:Be.y2,anchorPointX:Be.anchorPointX,anchorPointY:Be.anchorPointY},V.iconFeatureIndex=Be.featureIndex;break}for(var Xe=$;Xe<D;Xe++){var He=i.get(Xe);V.verticalIconBox={x1:He.x1,y1:He.y1,x2:He.x2,y2:He.y2,anchorPointX:He.anchorPointX,anchorPointY:He.anchorPointY},V.verticalIconFeatureIndex=He.featureIndex;break}return V},Qn.prototype.deserializeCollisionBoxes=function(i){this.collisionArrays=[];for(var l=0;l<this.symbolInstances.length;l++){var c=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}},Qn.prototype.hasTextData=function(){return this.text.segments.get().length>0},Qn.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Qn.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Qn.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Qn.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Qn.prototype.addIndicesForPlacedSymbol=function(i,l){for(var c=i.placedSymbolArray.get(l),_=c.vertexStartIndex+4*c.numGlyphs,x=c.vertexStartIndex;x<_;x+=4)i.indexArray.emplaceBack(x,x+1,x+2),i.indexArray.emplaceBack(x+1,x+2,x+3)},Qn.prototype.getSortedSymbolIndexes=function(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var l=Math.sin(i),c=Math.cos(i),_=[],x=[],w=[],T=0;T<this.symbolInstances.length;++T){w.push(T);var $=this.symbolInstances.get(T);_.push(0|Math.round(l*$.anchorX+c*$.anchorY)),x.push($.featureIndex)}return w.sort(function(D,V){return _[D]-_[V]||x[V]-x[D]}),w},Qn.prototype.addToSortKeyRanges=function(i,l){var c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===l?c.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:i,symbolInstanceEnd:i+1})},Qn.prototype.sortFeatures=function(i){var l=this;if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var c=0,_=this.symbolInstanceIndexes;c<_.length;c+=1){var x=this.symbolInstances.get(_[c]);this.featureSortOrder.push(x.featureIndex),[x.rightJustifiedTextSymbolIndex,x.centerJustifiedTextSymbolIndex,x.leftJustifiedTextSymbolIndex].forEach(function(w,T,$){w>=0&&$.indexOf(w)===T&&l.addIndicesForPlacedSymbol(l.text,w)}),x.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,x.verticalPlacedTextSymbolIndex),x.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,x.placedIconSymbolIndex),x.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,x.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},_s("SymbolBucket",Qn,{omit:["layers","collisionBoxArray","features","compareText"]}),Qn.MAX_GLYPHS=65535,Qn.addDynamicAttributes=gy;var dw=new $i({"symbol-placement":new Ss(xe.layout_symbol["symbol-placement"]),"symbol-spacing":new Ss(xe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ss(xe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new gs(xe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ss(xe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ss(xe.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ss(xe.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ss(xe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ss(xe.layout_symbol["icon-rotation-alignment"]),"icon-size":new gs(xe.layout_symbol["icon-size"]),"icon-text-fit":new Ss(xe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ss(xe.layout_symbol["icon-text-fit-padding"]),"icon-image":new gs(xe.layout_symbol["icon-image"]),"icon-rotate":new gs(xe.layout_symbol["icon-rotate"]),"icon-padding":new Ss(xe.layout_symbol["icon-padding"]),"icon-keep-upright":new Ss(xe.layout_symbol["icon-keep-upright"]),"icon-offset":new gs(xe.layout_symbol["icon-offset"]),"icon-anchor":new gs(xe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ss(xe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ss(xe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ss(xe.layout_symbol["text-rotation-alignment"]),"text-field":new gs(xe.layout_symbol["text-field"]),"text-font":new gs(xe.layout_symbol["text-font"]),"text-size":new gs(xe.layout_symbol["text-size"]),"text-max-width":new gs(xe.layout_symbol["text-max-width"]),"text-line-height":new Ss(xe.layout_symbol["text-line-height"]),"text-letter-spacing":new gs(xe.layout_symbol["text-letter-spacing"]),"text-justify":new gs(xe.layout_symbol["text-justify"]),"text-radial-offset":new gs(xe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ss(xe.layout_symbol["text-variable-anchor"]),"text-anchor":new gs(xe.layout_symbol["text-anchor"]),"text-max-angle":new Ss(xe.layout_symbol["text-max-angle"]),"text-writing-mode":new Ss(xe.layout_symbol["text-writing-mode"]),"text-rotate":new gs(xe.layout_symbol["text-rotate"]),"text-padding":new Ss(xe.layout_symbol["text-padding"]),"text-keep-upright":new Ss(xe.layout_symbol["text-keep-upright"]),"text-transform":new gs(xe.layout_symbol["text-transform"]),"text-offset":new gs(xe.layout_symbol["text-offset"]),"text-allow-overlap":new Ss(xe.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ss(xe.layout_symbol["text-ignore-placement"]),"text-optional":new Ss(xe.layout_symbol["text-optional"])}),yy={paint:new $i({"icon-opacity":new gs(xe.paint_symbol["icon-opacity"]),"icon-color":new gs(xe.paint_symbol["icon-color"]),"icon-halo-color":new gs(xe.paint_symbol["icon-halo-color"]),"icon-halo-width":new gs(xe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new gs(xe.paint_symbol["icon-halo-blur"]),"icon-translate":new Ss(xe.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ss(xe.paint_symbol["icon-translate-anchor"]),"text-opacity":new gs(xe.paint_symbol["text-opacity"]),"text-color":new gs(xe.paint_symbol["text-color"],{runtimeType:is,getOverride:function(i){return i.textColor},hasOverride:function(i){return!!i.textColor}}),"text-halo-color":new gs(xe.paint_symbol["text-halo-color"]),"text-halo-width":new gs(xe.paint_symbol["text-halo-width"]),"text-halo-blur":new gs(xe.paint_symbol["text-halo-blur"]),"text-translate":new Ss(xe.paint_symbol["text-translate"]),"text-translate-anchor":new Ss(xe.paint_symbol["text-translate-anchor"])}),layout:dw},ju=function(i){this.type=i.property.overrides?i.property.overrides.runtimeType:ms,this.defaultValue=i};ju.prototype.evaluate=function(i){if(i.formattedSection){var l=this.defaultValue.property.overrides;if(l&&l.hasOverride(i.formattedSection))return l.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default},ju.prototype.eachChild=function(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)},ju.prototype.outputDefined=function(){return!1},ju.prototype.serialize=function(){return null},_s("FormatSectionOverride",ju,{omit:["defaultValue"]});var hw=function(i){function l(c){i.call(this,c,yy)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.recalculate=function(c,_){if(i.prototype.recalculate.call(this,c,_),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var x=this.layout.get("text-writing-mode");if(x){for(var w=[],T=0,$=x;T<$.length;T+=1){var D=$[T];w.indexOf(D)<0&&w.push(D)}this.layout._values["text-writing-mode"]=w}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},l.prototype.getValueAndResolveTokens=function(c,_,x,w){var T=this.layout.get(c).evaluate(_,{},x,w),$=this._unevaluatedLayout._values[c];return $.isDataDriven()||Td($.value)||!T?T:function(D,V){return V.replace(/{([^{}]+)}/g,function(Z,K){return K in D?String(D[K]):""})}(_.properties,T)},l.prototype.createBucket=function(c){return new Qn(c)},l.prototype.queryRadius=function(){return 0},l.prototype.queryIntersectsFeature=function(){return!1},l.prototype._setPaintOverrides=function(){for(var c=0,_=yy.paint.overridableProperties;c<_.length;c+=1){var x=_[c];if(l.hasPaintOverride(this.layout,x)){var w,T=this.paint.get(x),$=new ju(T),D=new Xc($,T.property.specification);w=T.value.kind==="constant"||T.value.kind==="source"?new Ad("source",D):new Pu("composite",D,T.value.zoomStops,T.value._interpolationType),this.paint._values[x]=new mi(T.property,w,T.parameters)}}},l.prototype._handleOverridablePaintPropertyUpdate=function(c,_,x){return!(!this.layout||_.isDataDriven()||x.isDataDriven())&&l.hasPaintOverride(this.layout,c)},l.hasPaintOverride=function(c,_){var x=c.get("text-field"),w=yy.paint.properties[_],T=!1,$=function(Z){for(var K=0,le=Z;K<le.length;K+=1)if(w.overrides&&w.overrides.hasOverride(le[K]))return void(T=!0)};if(x.value.kind==="constant"&&x.value.value instanceof vi)$(x.value.value.sections);else if(x.value.kind==="source"){var D=function(Z){T||(Z instanceof Di&&Pr(Z.value)===Fn?$(Z.value.sections):Z instanceof Jo?$(Z.sections):Z.eachChild(D))},V=x.value;V._styleExpression&&D(V._styleExpression.expression)}return T},l}(ja),pw={paint:new $i({"background-color":new Ss(xe.paint_background["background-color"]),"background-pattern":new Si(xe.paint_background["background-pattern"]),"background-opacity":new Ss(xe.paint_background["background-opacity"])})},fw=function(i){function l(c){i.call(this,c,pw)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l}(ja),mw={paint:new $i({"raster-opacity":new Ss(xe.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ss(xe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ss(xe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ss(xe.paint_raster["raster-brightness-max"]),"raster-saturation":new Ss(xe.paint_raster["raster-saturation"]),"raster-contrast":new Ss(xe.paint_raster["raster-contrast"]),"raster-resampling":new Ss(xe.paint_raster["raster-resampling"]),"raster-fade-duration":new Ss(xe.paint_raster["raster-fade-duration"])})},_w=function(i){function l(c){i.call(this,c,mw)}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l}(ja),gw=function(i){function l(c){i.call(this,c,{}),this.implementation=c}return i&&(l.__proto__=i),(l.prototype=Object.create(i&&i.prototype)).constructor=l,l.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},l.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},l.prototype.recalculate=function(){},l.prototype.updateTransitions=function(){},l.prototype.hasTransition=function(){},l.prototype.serialize=function(){},l.prototype.onAdd=function(c){this.implementation.onAdd&&this.implementation.onAdd(c,c.painter.context.gl)},l.prototype.onRemove=function(c){this.implementation.onRemove&&this.implementation.onRemove(c,c.painter.context.gl)},l}(ja),yw={circle:Xm,heatmap:Kg,hillshade:Jg,fill:la,"fill-extrusion":a_,line:S0,symbol:hw,background:fw,raster:_w},V0=I.HTMLImageElement,j0=I.HTMLCanvasElement,q0=I.HTMLVideoElement,H0=I.ImageData,w_=I.ImageBitmap,jd=function(i,l,c,_){this.context=i,this.format=c,this.texture=i.gl.createTexture(),this.update(l,_)};jd.prototype.update=function(i,l,c){var _=i.width,x=i.height,w=!(this.size&&this.size[0]===_&&this.size[1]===x||c),T=this.context,$=T.gl;if(this.useMipmap=Boolean(l&&l.useMipmap),$.bindTexture($.TEXTURE_2D,this.texture),T.pixelStoreUnpackFlipY.set(!1),T.pixelStoreUnpack.set(1),T.pixelStoreUnpackPremultiplyAlpha.set(this.format===$.RGBA&&(!l||l.premultiply!==!1)),w)this.size=[_,x],i instanceof V0||i instanceof j0||i instanceof q0||i instanceof H0||w_&&i instanceof w_?$.texImage2D($.TEXTURE_2D,0,this.format,this.format,$.UNSIGNED_BYTE,i):$.texImage2D($.TEXTURE_2D,0,this.format,_,x,0,this.format,$.UNSIGNED_BYTE,i.data);else{var D=c||{x:0,y:0},V=D.x,Z=D.y;i instanceof V0||i instanceof j0||i instanceof q0||i instanceof H0||w_&&i instanceof w_?$.texSubImage2D($.TEXTURE_2D,0,V,Z,$.RGBA,$.UNSIGNED_BYTE,i):$.texSubImage2D($.TEXTURE_2D,0,V,Z,_,x,$.RGBA,$.UNSIGNED_BYTE,i.data)}this.useMipmap&&this.isSizePowerOfTwo()&&$.generateMipmap($.TEXTURE_2D)},jd.prototype.bind=function(i,l,c){var _=this.context.gl;_.bindTexture(_.TEXTURE_2D,this.texture),c!==_.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=_.LINEAR),i!==this.filter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,i),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,c||i),this.filter=i),l!==this.wrap&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,l),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,l),this.wrap=l)},jd.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},jd.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var vy=function(i){var l=this;this._callback=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){l._triggered=!1,l._callback()})};vy.prototype.trigger=function(){var i=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){i._triggered=!1,i._callback()},0))},vy.prototype.remove=function(){delete this._channel,this._callback=function(){}};var lp=function(i,l,c){this.target=i,this.parent=l,this.mapId=c,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},ve(["receive","process"],this),this.invoker=new vy(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Rt()?i:I};function G0(i,l,c){var _=2*Math.PI*6378137/256/Math.pow(2,c);return[i*_-2*Math.PI*6378137/2,l*_-2*Math.PI*6378137/2]}lp.prototype.send=function(i,l,c,_,x){var w=this;x===void 0&&(x=!1);var T=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(this.callbacks[T]=c);var $=j(this.globalScope)?void 0:[];return this.target.postMessage({id:T,type:i,hasCallback:!!c,targetMapId:_,mustQueue:x,sourceMapId:this.mapId,data:ea(l,$)},$),{cancel:function(){c&&delete w.callbacks[T],w.target.postMessage({id:T,type:"<cancel>",targetMapId:_,sourceMapId:w.mapId})}}},lp.prototype.receive=function(i){var l=i.data,c=l.id;if(c&&(!l.targetMapId||this.mapId===l.targetMapId))if(l.type==="<cancel>"){delete this.tasks[c];var _=this.cancelCallbacks[c];delete this.cancelCallbacks[c],_&&_()}else Rt()||l.mustQueue?(this.tasks[c]=l,this.taskQueue.push(c),this.invoker.trigger()):this.processTask(c,l)},lp.prototype.process=function(){if(this.taskQueue.length){var i=this.taskQueue.shift(),l=this.tasks[i];delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),l&&this.processTask(i,l)}},lp.prototype.processTask=function(i,l){var c=this;if(l.type==="<response>"){var _=this.callbacks[i];delete this.callbacks[i],_&&(l.error?_(zi(l.error)):_(null,zi(l.data)))}else{var x=!1,w=j(this.globalScope)?void 0:[],T=l.hasCallback?function(Z,K){x=!0,delete c.cancelCallbacks[i],c.target.postMessage({id:i,type:"<response>",sourceMapId:c.mapId,error:Z?ea(Z):null,data:ea(K,w)},w)}:function(Z){x=!0},$=null,D=zi(l.data);if(this.parent[l.type])$=this.parent[l.type](l.sourceMapId,D,T);else if(this.parent.getWorkerSource){var V=l.type.split(".");$=this.parent.getWorkerSource(l.sourceMapId,V[0],D.source)[V[1]](D,T)}else T(new Error("Could not find function "+l.type));!x&&$&&$.cancel&&(this.cancelCallbacks[i]=$.cancel)}},lp.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var ai=function(i,l){i&&(l?this.setSouthWest(i).setNorthEast(l):i.length===4?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1]))};ai.prototype.setNorthEast=function(i){return this._ne=i instanceof Cr?new Cr(i.lng,i.lat):Cr.convert(i),this},ai.prototype.setSouthWest=function(i){return this._sw=i instanceof Cr?new Cr(i.lng,i.lat):Cr.convert(i),this},ai.prototype.extend=function(i){var l,c,_=this._sw,x=this._ne;if(i instanceof Cr)l=i,c=i;else{if(!(i instanceof ai))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(ai.convert(i)):this.extend(Cr.convert(i)):this;if(c=i._ne,!(l=i._sw)||!c)return this}return _||x?(_.lng=Math.min(l.lng,_.lng),_.lat=Math.min(l.lat,_.lat),x.lng=Math.max(c.lng,x.lng),x.lat=Math.max(c.lat,x.lat)):(this._sw=new Cr(l.lng,l.lat),this._ne=new Cr(c.lng,c.lat)),this},ai.prototype.getCenter=function(){return new Cr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},ai.prototype.getSouthWest=function(){return this._sw},ai.prototype.getNorthEast=function(){return this._ne},ai.prototype.getNorthWest=function(){return new Cr(this.getWest(),this.getNorth())},ai.prototype.getSouthEast=function(){return new Cr(this.getEast(),this.getSouth())},ai.prototype.getWest=function(){return this._sw.lng},ai.prototype.getSouth=function(){return this._sw.lat},ai.prototype.getEast=function(){return this._ne.lng},ai.prototype.getNorth=function(){return this._ne.lat},ai.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},ai.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},ai.prototype.isEmpty=function(){return!(this._sw&&this._ne)},ai.prototype.contains=function(i){var l=Cr.convert(i),c=l.lng,_=l.lat,x=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(x=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=_&&_<=this._ne.lat&&x},ai.convert=function(i){return!i||i instanceof ai?i:new ai(i)};var Cr=function(i,l){if(isNaN(i)||isNaN(l))throw new Error("Invalid LngLat object: ("+i+", "+l+")");if(this.lng=+i,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Cr.prototype.wrap=function(){return new Cr(ce(this.lng,-180,180),this.lat)},Cr.prototype.toArray=function(){return[this.lng,this.lat]},Cr.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Cr.prototype.distanceTo=function(i){var l=Math.PI/180,c=this.lat*l,_=i.lat*l,x=Math.sin(c)*Math.sin(_)+Math.cos(c)*Math.cos(_)*Math.cos((i.lng-this.lng)*l);return 63710088e-1*Math.acos(Math.min(x,1))},Cr.prototype.toBounds=function(i){i===void 0&&(i=0);var l=360*i/40075017,c=l/Math.cos(Math.PI/180*this.lat);return new ai(new Cr(this.lng-c,this.lat-l),new Cr(this.lng+c,this.lat+l))},Cr.convert=function(i){if(i instanceof Cr)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new Cr(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new Cr(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var W0=2*Math.PI*63710088e-1;function Y0(i){return W0*Math.cos(i*Math.PI/180)}function S_(i){return(180+i)/360}function by(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function Z0(i,l){return i/Y0(l)}function xy(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}var qd=function(i,l,c){c===void 0&&(c=0),this.x=+i,this.y=+l,this.z=+c};qd.fromLngLat=function(i,l){l===void 0&&(l=0);var c=Cr.convert(i);return new qd(S_(c.lng),by(c.lat),Z0(l,c.lat))},qd.prototype.toLngLat=function(){return new Cr(360*this.x-180,xy(this.y))},qd.prototype.toAltitude=function(){return this.z*Y0(xy(this.y))},qd.prototype.meterInMercatorCoordinateUnits=function(){return 1/W0*(i=xy(this.y),1/Math.cos(i*Math.PI/180));var i};var Hd=function(i,l,c){this.z=i,this.x=l,this.y=c,this.key=Rf(0,i,i,l,c)};Hd.prototype.equals=function(i){return this.z===i.z&&this.x===i.x&&this.y===i.y},Hd.prototype.url=function(i,l){var c,_,x,w,T,$=(_=this.y,x=this.z,w=G0(256*(c=this.x),256*(_=Math.pow(2,x)-_-1),x),T=G0(256*(c+1),256*(_+1),x),w[0]+","+w[1]+","+T[0]+","+T[1]),D=function(V,Z,K){for(var le,_e="",Oe=V;Oe>0;Oe--)_e+=(Z&(le=1<<Oe-1)?1:0)+(K&le?2:0);return _e}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",D).replace("{bbox-epsg-3857}",$)},Hd.prototype.getTilePoint=function(i){var l=Math.pow(2,this.z);return new v(8192*(i.x*l-this.x),8192*(i.y*l-this.y))},Hd.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var X0=function(i,l){this.wrap=i,this.canonical=l,this.key=Rf(i,l.z,l.z,l.x,l.y)},li=function(i,l,c,_,x){this.overscaledZ=i,this.wrap=l,this.canonical=new Hd(c,+_,+x),this.key=Rf(l,i,c,_,x)};function Rf(i,l,c,_,x){(i*=2)<0&&(i=-1*i-1);var w=1<<c;return(w*w*i+w*x+_).toString(36)+c.toString(36)+l.toString(36)}li.prototype.equals=function(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)},li.prototype.scaledTo=function(i){var l=this.canonical.z-i;return i>this.canonical.z?new li(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new li(i,this.wrap,i,this.canonical.x>>l,this.canonical.y>>l)},li.prototype.calculateScaledKey=function(i,l){var c=this.canonical.z-i;return i>this.canonical.z?Rf(this.wrap*+l,i,this.canonical.z,this.canonical.x,this.canonical.y):Rf(this.wrap*+l,i,i,this.canonical.x>>c,this.canonical.y>>c)},li.prototype.isChildOf=function(i){if(i.wrap!==this.wrap)return!1;var l=this.canonical.z-i.canonical.z;return i.overscaledZ===0||i.overscaledZ<this.overscaledZ&&i.canonical.x===this.canonical.x>>l&&i.canonical.y===this.canonical.y>>l},li.prototype.children=function(i){if(this.overscaledZ>=i)return[new li(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var l=this.canonical.z+1,c=2*this.canonical.x,_=2*this.canonical.y;return[new li(l,this.wrap,l,c,_),new li(l,this.wrap,l,c+1,_),new li(l,this.wrap,l,c,_+1),new li(l,this.wrap,l,c+1,_+1)]},li.prototype.isLessThan=function(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))},li.prototype.wrapped=function(){return new li(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},li.prototype.unwrapTo=function(i){return new li(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)},li.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},li.prototype.toUnwrapped=function(){return new X0(this.wrap,this.canonical)},li.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},li.prototype.getTilePoint=function(i){return this.canonical.getTilePoint(new qd(i.x-this.wrap,i.y))},_s("CanonicalTileID",Hd),_s("OverscaledTileID",li,{omit:["posMatrix"]});var au=function(i,l,c){if(this.uid=i,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(c&&c!=="mapbox"&&c!=="terrarium")return Me('"'+c+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=l.height;var _=this.dim=l.height-2;this.data=new Uint32Array(l.data.buffer),this.encoding=c||"mapbox";for(var x=0;x<_;x++)this.data[this._idx(-1,x)]=this.data[this._idx(0,x)],this.data[this._idx(_,x)]=this.data[this._idx(_-1,x)],this.data[this._idx(x,-1)]=this.data[this._idx(x,0)],this.data[this._idx(x,_)]=this.data[this._idx(x,_-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(_,-1)]=this.data[this._idx(_-1,0)],this.data[this._idx(-1,_)]=this.data[this._idx(0,_-1)],this.data[this._idx(_,_)]=this.data[this._idx(_-1,_-1)]};au.prototype.get=function(i,l){var c=new Uint8Array(this.data.buffer),_=4*this._idx(i,l);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(c[_],c[_+1],c[_+2])},au.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},au.prototype._idx=function(i,l){if(i<-1||i>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(i+1)},au.prototype._unpackMapbox=function(i,l,c){return(256*i*256+256*l+c)/10-1e4},au.prototype._unpackTerrarium=function(i,l,c){return 256*i+l+c/256-32768},au.prototype.getPixels=function(){return new Po({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},au.prototype.backfillBorder=function(i,l,c){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");var _=l*this.dim,x=l*this.dim+this.dim,w=c*this.dim,T=c*this.dim+this.dim;switch(l){case-1:_=x-1;break;case 1:x=_+1}switch(c){case-1:w=T-1;break;case 1:T=w+1}for(var $=-l*this.dim,D=-c*this.dim,V=w;V<T;V++)for(var Z=_;Z<x;Z++)this.data[this._idx(Z,V)]=i.data[this._idx(Z+$,V+D)]},_s("DEMData",au);var $f=function(i){this._stringToNumber={},this._numberToString=[];for(var l=0;l<i.length;l++){var c=i[l];this._stringToNumber[c]=l,this._numberToString[l]=c}};$f.prototype.encode=function(i){return this._stringToNumber[i]},$f.prototype.decode=function(i){return this._numberToString[i]};var C_=function(i,l,c,_,x){this.type="Feature",this._vectorTileFeature=i,i._z=l,i._x=c,i._y=_,this.properties=i.properties,this.id=x},cp={geometry:{configurable:!0}};cp.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},cp.geometry.set=function(i){this._geometry=i},C_.prototype.toJSON=function(){var i={geometry:this.geometry};for(var l in this)l!=="_geometry"&&l!=="_vectorTileFeature"&&(i[l]=this[l]);return i},Object.defineProperties(C_.prototype,cp);var up=function(){this.state={},this.stateChanges={},this.deletedStates={}};up.prototype.updateState=function(i,l,c){var _=String(l);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][_]=this.stateChanges[i][_]||{},re(this.stateChanges[i][_],c),this.deletedStates[i]===null)for(var x in this.deletedStates[i]={},this.state[i])x!==_&&(this.deletedStates[i][x]=null);else if(this.deletedStates[i]&&this.deletedStates[i][_]===null)for(var w in this.deletedStates[i][_]={},this.state[i][_])c[w]||(this.deletedStates[i][_][w]=null);else for(var T in c)this.deletedStates[i]&&this.deletedStates[i][_]&&this.deletedStates[i][_][T]===null&&delete this.deletedStates[i][_][T]},up.prototype.removeFeatureState=function(i,l,c){if(this.deletedStates[i]!==null){var _=String(l);if(this.deletedStates[i]=this.deletedStates[i]||{},c&&l!==void 0)this.deletedStates[i][_]!==null&&(this.deletedStates[i][_]=this.deletedStates[i][_]||{},this.deletedStates[i][_][c]=null);else if(l!==void 0)if(this.stateChanges[i]&&this.stateChanges[i][_])for(c in this.deletedStates[i][_]={},this.stateChanges[i][_])this.deletedStates[i][_][c]=null;else this.deletedStates[i][_]=null;else this.deletedStates[i]=null}},up.prototype.getState=function(i,l){var c=String(l),_=re({},(this.state[i]||{})[c],(this.stateChanges[i]||{})[c]);if(this.deletedStates[i]===null)return{};if(this.deletedStates[i]){var x=this.deletedStates[i][l];if(x===null)return{};for(var w in x)delete _[w]}return _},up.prototype.initializeTileState=function(i,l){i.setFeatureState(this.state,l)},up.prototype.coalesceChanges=function(i,l){var c={};for(var _ in this.stateChanges){this.state[_]=this.state[_]||{};var x={};for(var w in this.stateChanges[_])this.state[_][w]||(this.state[_][w]={}),re(this.state[_][w],this.stateChanges[_][w]),x[w]=this.state[_][w];c[_]=x}for(var T in this.deletedStates){this.state[T]=this.state[T]||{};var $={};if(this.deletedStates[T]===null)for(var D in this.state[T])$[D]={},this.state[T][D]={};else for(var V in this.deletedStates[T]){if(this.deletedStates[T][V]===null)this.state[T][V]={};else for(var Z=0,K=Object.keys(this.deletedStates[T][V]);Z<K.length;Z+=1)delete this.state[T][V][K[Z]];$[V]=this.state[T][V]}c[T]=c[T]||{},re(c[T],$)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(var le in i)i[le].setFeatureState(c,l)};var lu=function(i,l){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new vl(8192,16,0),this.grid3D=new vl(8192,16,0),this.featureIndexArray=new se,this.promoteId=l};function K0(i,l,c,_,x){return ne(i,function(w,T){var $=l instanceof Qc?l.get(T):null;return $&&$.evaluate?$.evaluate(c,_,x):$})}function J0(i){for(var l=1/0,c=1/0,_=-1/0,x=-1/0,w=0,T=i;w<T.length;w+=1){var $=T[w];l=Math.min(l,$.x),c=Math.min(c,$.y),_=Math.max(_,$.x),x=Math.max(x,$.y)}return{minX:l,minY:c,maxX:_,maxY:x}}function vw(i,l){return l-i}lu.prototype.insert=function(i,l,c,_,x,w){var T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,_,x);for(var $=w?this.grid3D:this.grid,D=0;D<l.length;D++){for(var V=l[D],Z=[1/0,1/0,-1/0,-1/0],K=0;K<V.length;K++){var le=V[K];Z[0]=Math.min(Z[0],le.x),Z[1]=Math.min(Z[1],le.y),Z[2]=Math.max(Z[2],le.x),Z[3]=Math.max(Z[3],le.y)}Z[0]<8192&&Z[1]<8192&&Z[2]>=0&&Z[3]>=0&&$.insert(T,Z[0],Z[1],Z[2],Z[3])}},lu.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Al.VectorTile(new Xs(this.rawTileData)).layers,this.sourceLayerCoder=new $f(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},lu.prototype.query=function(i,l,c,_){var x=this;this.loadVTLayers();for(var w=i.params||{},T=8192/i.tileSize/i.scale,$=Vh(w.filter),D=i.queryGeometry,V=i.queryPadding*T,Z=J0(D),K=this.grid.query(Z.minX-V,Z.minY-V,Z.maxX+V,Z.maxY+V),le=J0(i.cameraQueryGeometry),_e=this.grid3D.query(le.minX-V,le.minY-V,le.maxX+V,le.maxY+V,function(yt,xt,Pt,Yt){return function(Qt,Is,ls,Ms,us){for(var sn=0,Fs=Qt;sn<Fs.length;sn+=1){var bs=Fs[sn];if(Is<=bs.x&&ls<=bs.y&&Ms>=bs.x&&us>=bs.y)return!0}var an=[new v(Is,ls),new v(Is,us),new v(Ms,us),new v(Ms,ls)];if(Qt.length>2){for(var Ks=0,_n=an;Ks<_n.length;Ks+=1)if(Ha(Qt,_n[Ks]))return!0}for(var Ps=0;Ps<Qt.length-1;Ps++)if(wl(Qt[Ps],Qt[Ps+1],an))return!0;return!1}(i.cameraQueryGeometry,yt-V,xt-V,Pt+V,Yt+V)}),Oe=0,Be=_e;Oe<Be.length;Oe+=1)K.push(Be[Oe]);K.sort(vw);for(var Xe,He={},lt=function(yt){var xt=K[yt];if(xt!==Xe){Xe=xt;var Pt=x.featureIndexArray.get(xt),Yt=null;x.loadMatchingFeature(He,Pt.bucketIndex,Pt.sourceLayerIndex,Pt.featureIndex,$,w.layers,w.availableImages,l,c,_,function(Qt,Is,ls){return Yt||(Yt=fr(Qt)),Is.queryIntersectsFeature(D,Qt,ls,Yt,x.z,i.transform,T,i.pixelPosMatrix)})}},ft=0;ft<K.length;ft++)lt(ft);return He},lu.prototype.loadMatchingFeature=function(i,l,c,_,x,w,T,$,D,V,Z){var K=this.bucketLayerIDs[l];if(!w||function(Qt,Is){for(var ls=0;ls<Qt.length;ls++)if(Is.indexOf(Qt[ls])>=0)return!0;return!1}(w,K)){var le=this.sourceLayerCoder.decode(c),_e=this.vtLayers[le].feature(_);if(x.needGeometry){var Oe=ur(_e,!0);if(!x.filter(new Bs(this.tileID.overscaledZ),Oe,this.tileID.canonical))return}else if(!x.filter(new Bs(this.tileID.overscaledZ),_e))return;for(var Be=this.getId(_e,le),Xe=0;Xe<K.length;Xe++){var He=K[Xe];if(!(w&&w.indexOf(He)<0)){var lt=$[He];if(lt){var ft={};Be!==void 0&&V&&(ft=V.getState(lt.sourceLayer||"_geojsonTileLayer",Be));var yt=re({},D[He]);yt.paint=K0(yt.paint,lt.paint,_e,ft,T),yt.layout=K0(yt.layout,lt.layout,_e,ft,T);var xt=!Z||Z(_e,lt,ft);if(xt){var Pt=new C_(_e,this.z,this.x,this.y,Be);Pt.layer=yt;var Yt=i[He];Yt===void 0&&(Yt=i[He]=[]),Yt.push({featureIndex:_,feature:Pt,intersectionZ:xt})}}}}}},lu.prototype.lookupSymbolFeatures=function(i,l,c,_,x,w,T,$){var D={};this.loadVTLayers();for(var V=Vh(x),Z=0,K=i;Z<K.length;Z+=1)this.loadMatchingFeature(D,c,_,K[Z],V,w,T,$,l);return D},lu.prototype.hasLayer=function(i){for(var l=0,c=this.bucketLayerIDs;l<c.length;l+=1)for(var _=0,x=c[l];_<x.length;_+=1)if(i===x[_])return!0;return!1},lu.prototype.getId=function(i,l){var c=i.id;return this.promoteId&&typeof(c=i.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[l]])=="boolean"&&(c=Number(c)),c},_s("FeatureIndex",lu,{omit:["rawTileData","sourceLayerCoder"]});var Ci=function(i,l){this.tileID=i,this.uid=Ce(),this.uses=0,this.tileSize=l,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Ci.prototype.registerFadeDuration=function(i){var l=i+this.timeAdded;l<ct.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)},Ci.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Ci.prototype.loadVectorData=function(i,l,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",i){for(var _ in i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=function(V,Z){var K={};if(!Z)return K;for(var le=function(){var Be=Oe[_e],Xe=Be.layerIds.map(function(ft){return Z.getLayer(ft)}).filter(Boolean);if(Xe.length!==0){Be.layers=Xe,Be.stateDependentLayerIds&&(Be.stateDependentLayers=Be.stateDependentLayerIds.map(function(ft){return Xe.filter(function(yt){return yt.id===ft})[0]}));for(var He=0,lt=Xe;He<lt.length;He+=1)K[lt[He].id]=Be}},_e=0,Oe=V;_e<Oe.length;_e+=1)le();return K}(i.buckets,l.style),this.hasSymbolBuckets=!1,this.buckets){var x=this.buckets[_];if(x instanceof Qn){if(this.hasSymbolBuckets=!0,!c)break;x.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var w in this.buckets){var T=this.buckets[w];if(T instanceof Qn&&T.hasRTLText){this.hasRTLText=!0,Vo.isLoading()||Vo.isLoaded()||Zh()!=="deferred"||Pa();break}}for(var $ in this.queryPadding=0,this.buckets){var D=this.buckets[$];this.queryPadding=Math.max(this.queryPadding,l.style.getLayer($).queryRadius(D))}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage)}else this.collisionBoxArray=new f},Ci.prototype.unloadVectorData=function(){for(var i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Ci.prototype.getBucket=function(i){return this.buckets[i.id]},Ci.prototype.upload=function(i){for(var l in this.buckets){var c=this.buckets[l];c.uploadPending()&&c.upload(i)}var _=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new jd(i,this.imageAtlas.image,_.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new jd(i,this.glyphAtlasImage,_.ALPHA),this.glyphAtlasImage=null)},Ci.prototype.prepare=function(i){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture)},Ci.prototype.queryRenderedFeatures=function(i,l,c,_,x,w,T,$,D,V){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:_,cameraQueryGeometry:x,scale:w,tileSize:this.tileSize,pixelPosMatrix:V,transform:$,params:T,queryPadding:this.queryPadding*D},i,l,c):{}},Ci.prototype.querySourceFeatures=function(i,l){var c=this.latestFeatureIndex;if(c&&c.rawTileData){var _=c.loadVTLayers(),x=l?l.sourceLayer:"",w=_._geojsonTileLayer||_[x];if(w)for(var T=Vh(l&&l.filter),$=this.tileID.canonical,D=$.z,V=$.x,Z=$.y,K={z:D,x:V,y:Z},le=0;le<w.length;le++){var _e=w.feature(le);if(T.needGeometry){var Oe=ur(_e,!0);if(!T.filter(new Bs(this.tileID.overscaledZ),Oe,this.tileID.canonical))continue}else if(!T.filter(new Bs(this.tileID.overscaledZ),_e))continue;var Be=c.getId(_e,x),Xe=new C_(_e,D,V,Z,Be);Xe.tile=K,i.push(Xe)}}},Ci.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Ci.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Ci.prototype.setExpiryData=function(i){var l=this.expirationTime;if(i.cacheControl){var c=_t(i.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){var _=Date.now(),x=!1;if(this.expirationTime>_)x=!1;else if(l)if(this.expirationTime<l)x=!0;else{var w=this.expirationTime-l;w?this.expirationTime=_+Math.max(w,3e4):x=!0}else x=!0;x?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Ci.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Ci.prototype.setFeatureState=function(i,l){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(i).length!==0){var c=this.latestFeatureIndex.loadVTLayers();for(var _ in this.buckets)if(l.style.hasLayer(_)){var x=this.buckets[_],w=x.layers[0].sourceLayer||"_geojsonTileLayer",T=c[w],$=i[w];if(T&&$&&Object.keys($).length!==0){x.update($,T,this.imageAtlas&&this.imageAtlas.patternPositions||{});var D=l&&l.style&&l.style.getLayer(_);D&&(this.queryPadding=Math.max(this.queryPadding,D.queryRadius(x)))}}}},Ci.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Ci.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ct.now()},Ci.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Ci.prototype.setHoldDuration=function(i){this.symbolFadeHoldUntil=ct.now()+i},Ci.prototype.setDependencies=function(i,l){for(var c={},_=0,x=l;_<x.length;_+=1)c[x[_]]=!0;this.dependencies[i]=c},Ci.prototype.hasDependency=function(i,l){for(var c=0,_=i;c<_.length;c+=1){var x=this.dependencies[_[c]];if(x){for(var w=0,T=l;w<T.length;w+=1)if(x[T[w]])return!0}}return!1};var qu=I.performance,Q0=function(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},qu.mark(this._marks.start)};Q0.prototype.finish=function(){qu.mark(this._marks.end);var i=qu.getEntriesByName(this._marks.measure);return i.length===0&&(qu.measure(this._marks.measure,this._marks.start,this._marks.end),i=qu.getEntriesByName(this._marks.measure),qu.clearMarks(this._marks.start),qu.clearMarks(this._marks.end),qu.clearMeasures(this._marks.measure)),i},o.Actor=lp,o.AlphaImage=Uu,o.CanonicalTileID=Hd,o.CollisionBoxArray=f,o.Color=On,o.DEMData=au,o.DataConstantProperty=Ss,o.DictionaryCoder=$f,o.EXTENT=8192,o.ErrorEvent=et,o.EvaluationParameters=Bs,o.Event=Fe,o.Evented=st,o.FeatureIndex=lu,o.FillBucket=Tl,o.FillExtrusionBucket=Za,o.ImageAtlas=ip,o.ImagePosition=p_,o.LineBucket=yo,o.LngLat=Cr,o.LngLatBounds=ai,o.MercatorCoordinate=qd,o.ONE_EM=24,o.OverscaledTileID=li,o.Point=v,o.Point$1=v,o.Properties=$i,o.Protobuf=Xs,o.RGBAImage=Po,o.RequestManager=at,o.RequestPerformance=Q0,o.ResourceType=Kn,o.SegmentVector=we,o.SourceFeatureState=up,o.StructArrayLayout1ui2=xf,o.StructArrayLayout2f1f2i16=eu,o.StructArrayLayout2i4=ac,o.StructArrayLayout3ui6=lc,o.StructArrayLayout4i8=Ie,o.SymbolBucket=Qn,o.Texture=jd,o.Tile=Ci,o.Transitionable=Ri,o.Uniform1f=Gt,o.Uniform1i=Dt,o.Uniform2f=Xt,o.Uniform3f=as,o.Uniform4f=vs,o.UniformColor=$s,o.UniformMatrix4f=xn,o.UnwrappedTileID=X0,o.ValidationError=Ve,o.WritingMode=Go,o.ZoomHistory=Gh,o.add=function(i,l,c){return i[0]=l[0]+c[0],i[1]=l[1]+c[1],i[2]=l[2]+c[2],i},o.addDynamicAttributes=gy,o.asyncAll=function(i,l,c){if(!i.length)return c(null,[]);var _=i.length,x=new Array(i.length),w=null;i.forEach(function(T,$){l(T,function(D,V){D&&(w=D),x[$]=V,--_==0&&c(w,x)})})},o.bezier=A,o.bindAll=ve,o.browser=ct,o.cacheEntryPossiblyAdded=function(i){++nn>gt&&(i.getActor().send("enforceCacheSizeLimit",nt),nn=0)},o.clamp=q,o.clearTileCache=function(i){var l=I.caches.delete("mapbox-tiles");i&&l.catch(i).then(function(){return i()})},o.clipLine=L0,o.clone=function(i){var l=new Ln(16);return l[0]=i[0],l[1]=i[1],l[2]=i[2],l[3]=i[3],l[4]=i[4],l[5]=i[5],l[6]=i[6],l[7]=i[7],l[8]=i[8],l[9]=i[9],l[10]=i[10],l[11]=i[11],l[12]=i[12],l[13]=i[13],l[14]=i[14],l[15]=i[15],l},o.clone$1=Ue,o.clone$2=function(i){var l=new Ln(3);return l[0]=i[0],l[1]=i[1],l[2]=i[2],l},o.collisionCircleLayout=ay,o.config=We,o.create=function(){var i=new Ln(16);return Ln!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},o.create$1=function(){var i=new Ln(9);return Ln!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i},o.create$2=function(){var i=new Ln(4);return Ln!=Float32Array&&(i[1]=0,i[2]=0),i[0]=1,i[3]=1,i},o.createCommonjsModule=d,o.createExpression=Fh,o.createLayout=Qr,o.createStyleLayer=function(i){return i.type==="custom"?new gw(i):new yw[i.type](i)},o.cross=function(i,l,c){var _=l[0],x=l[1],w=l[2],T=c[0],$=c[1],D=c[2];return i[0]=x*D-w*$,i[1]=w*T-_*D,i[2]=_*$-x*T,i},o.deepEqual=function i(l,c){if(Array.isArray(l)){if(!Array.isArray(c)||l.length!==c.length)return!1;for(var _=0;_<l.length;_++)if(!i(l[_],c[_]))return!1;return!0}if(typeof l=="object"&&l!==null&&c!==null){if(typeof c!="object"||Object.keys(l).length!==Object.keys(c).length)return!1;for(var x in l)if(!i(l[x],c[x]))return!1;return!0}return l===c},o.dot=function(i,l){return i[0]*l[0]+i[1]*l[1]+i[2]*l[2]},o.dot$1=function(i,l){return i[0]*l[0]+i[1]*l[1]+i[2]*l[2]+i[3]*l[3]},o.ease=P,o.emitValidationErrors=Wn,o.endsWith=ee,o.enforceCacheSizeLimit=function(i){kt(),ys&&ys.then(function(l){l.keys().then(function(c){for(var _=0;_<c.length-i;_++)l.delete(c[_])})})},o.evaluateSizeForFeature=Ml,o.evaluateSizeForZoom=Vu,o.evaluateVariableOffset=F0,o.evented=gf,o.extend=re,o.featureFilter=Vh,o.filterObject=Se,o.fromRotation=function(i,l){var c=Math.sin(l),_=Math.cos(l);return i[0]=_,i[1]=c,i[2]=0,i[3]=-c,i[4]=_,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},o.getAnchorAlignment=Ef,o.getAnchorJustification=_y,o.getArrayBuffer=yd,o.getImage=ae,o.getJSON=function(i,l){return Tu(re(i,{type:"json"}),l)},o.getRTLTextPluginStatus=Zh,o.getReferrer=Vc,o.getVideo=function(i,l){var c,_,x=I.document.createElement("video");x.muted=!0,x.onloadstart=function(){l(null,x)};for(var w=0;w<i.length;w++){var T=I.document.createElement("source");c=i[w],_=void 0,(_=I.document.createElement("a")).href=c,(_.protocol!==I.document.location.protocol||_.host!==I.document.location.host)&&(x.crossOrigin="Anonymous"),T.src=i[w],x.appendChild(T)}return{cancel:function(){}}},o.identity=qo,o.invert=function(i,l){var c=l[0],_=l[1],x=l[2],w=l[3],T=l[4],$=l[5],D=l[6],V=l[7],Z=l[8],K=l[9],le=l[10],_e=l[11],Oe=l[12],Be=l[13],Xe=l[14],He=l[15],lt=c*$-_*T,ft=c*D-x*T,yt=c*V-w*T,xt=_*D-x*$,Pt=_*V-w*$,Yt=x*V-w*D,Qt=Z*Be-K*Oe,Is=Z*Xe-le*Oe,ls=Z*He-_e*Oe,Ms=K*Xe-le*Be,us=K*He-_e*Be,sn=le*He-_e*Xe,Fs=lt*sn-ft*us+yt*Ms+xt*ls-Pt*Is+Yt*Qt;return Fs?(i[0]=($*sn-D*us+V*Ms)*(Fs=1/Fs),i[1]=(x*us-_*sn-w*Ms)*Fs,i[2]=(Be*Yt-Xe*Pt+He*xt)*Fs,i[3]=(le*Pt-K*Yt-_e*xt)*Fs,i[4]=(D*ls-T*sn-V*Is)*Fs,i[5]=(c*sn-x*ls+w*Is)*Fs,i[6]=(Xe*yt-Oe*Yt-He*ft)*Fs,i[7]=(Z*Yt-le*yt+_e*ft)*Fs,i[8]=(T*us-$*ls+V*Qt)*Fs,i[9]=(_*ls-c*us-w*Qt)*Fs,i[10]=(Oe*Pt-Be*yt+He*lt)*Fs,i[11]=(K*yt-Z*Pt-_e*lt)*Fs,i[12]=($*Is-T*Ms-D*Qt)*Fs,i[13]=(c*Ms-_*Is+x*Qt)*Fs,i[14]=(Be*ft-Oe*xt-Xe*lt)*Fs,i[15]=(Z*xt-K*ft+le*lt)*Fs,i):null},o.isChar=ss,o.isMapboxURL=it,o.keysDifference=function(i,l){var c=[];for(var _ in i)_ in l||c.push(_);return c},o.makeRequest=Tu,o.mapObject=ne,o.mercatorXfromLng=S_,o.mercatorYfromLat=by,o.mercatorZfromAltitude=Z0,o.mul=Xg,o.multiply=io,o.mvt=Al,o.nextPowerOfTwo=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},o.normalize=function(i,l){var c=l[0],_=l[1],x=l[2],w=c*c+_*_+x*x;return w>0&&(w=1/Math.sqrt(w)),i[0]=l[0]*w,i[1]=l[1]*w,i[2]=l[2]*w,i},o.number=Xr,o.offscreenCanvasSupported=qn,o.ortho=function(i,l,c,_,x,w,T){var $=1/(l-c),D=1/(_-x),V=1/(w-T);return i[0]=-2*$,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*D,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*V,i[11]=0,i[12]=(l+c)*$,i[13]=(x+_)*D,i[14]=(T+w)*V,i[15]=1,i},o.parseGlyphPBF=function(i){return new Xs(i).readFields(cy,[])},o.pbf=Xs,o.performSymbolLayout=function(i,l,c,_,x,w,T){i.createArrays(),i.tilePixelRatio=8192/(512*i.overscaling),i.compareText={},i.iconsNeedLinear=!1;var $=i.layers[0].layout,D=i.layers[0]._unevaluatedLayout._values,V={};if(i.textSizeData.kind==="composite"){var Z=i.textSizeData,K=Z.maxZoom;V.compositeTextSizes=[D["text-size"].possiblyEvaluate(new Bs(Z.minZoom),T),D["text-size"].possiblyEvaluate(new Bs(K),T)]}if(i.iconSizeData.kind==="composite"){var le=i.iconSizeData,_e=le.maxZoom;V.compositeIconSizes=[D["icon-size"].possiblyEvaluate(new Bs(le.minZoom),T),D["icon-size"].possiblyEvaluate(new Bs(_e),T)]}V.layoutTextSize=D["text-size"].possiblyEvaluate(new Bs(i.zoom+1),T),V.layoutIconSize=D["icon-size"].possiblyEvaluate(new Bs(i.zoom+1),T),V.textMaxSize=D["text-size"].possiblyEvaluate(new Bs(18));for(var Oe=24*$.get("text-line-height"),Be=$.get("text-rotation-alignment")==="map"&&$.get("symbol-placement")!=="point",Xe=$.get("text-keep-upright"),He=$.get("text-size"),lt=function(){var xt=yt[ft],Pt=$.get("text-font").evaluate(xt,{},T).join(","),Yt=He.evaluate(xt,{},T),Qt=V.layoutTextSize.evaluate(xt,{},T),Is=V.layoutIconSize.evaluate(xt,{},T),ls={horizontal:{},vertical:void 0},Ms=xt.text,us=[0,0];if(Ms){var sn=Ms.toString(),Fs=24*$.get("text-letter-spacing").evaluate(xt,{},T),bs=function(fn){for(var nr=0,Yn=fn;nr<Yn.length;nr+=1)if(In=Yn[nr].charCodeAt(0),ss.Arabic(In)||ss["Arabic Supplement"](In)||ss["Arabic Extended-A"](In)||ss["Arabic Presentation Forms-A"](In)||ss["Arabic Presentation Forms-B"](In))return!1;var In;return!0}(sn)?Fs:0,an=$.get("text-anchor").evaluate(xt,{},T),Ks=$.get("text-variable-anchor");if(!Ks){var _n=$.get("text-radial-offset").evaluate(xt,{},T);us=_n?F0(an,[24*_n,b_]):$.get("text-offset").evaluate(xt,{},T).map(function(fn){return 24*fn})}var Ps=Be?"center":$.get("text-justify").evaluate(xt,{},T),Pn=$.get("symbol-placement"),Ir=Pn==="point"?24*$.get("text-max-width").evaluate(xt,{},T):0,Tr=function(){i.allowVerticalPlacement&&Ou(sn)&&(ls.vertical=f_(Ms,l,c,x,Pt,Ir,Oe,an,"left",bs,us,Go.vertical,!0,Pn,Qt,Yt))};if(!Be&&Ks){for(var mr=Ps==="auto"?Ks.map(function(fn){return _y(fn)}):[Ps],Ar=!1,zr=0;zr<mr.length;zr++){var si=mr[zr];if(!ls.horizontal[si])if(Ar)ls.horizontal[si]=ls.horizontal[0];else{var ci=f_(Ms,l,c,x,Pt,Ir,Oe,"center",si,bs,us,Go.horizontal,!1,Pn,Qt,Yt);ci&&(ls.horizontal[si]=ci,Ar=ci.positionedLines.length===1)}}Tr()}else{Ps==="auto"&&(Ps=_y(an));var ao=f_(Ms,l,c,x,Pt,Ir,Oe,an,Ps,bs,us,Go.horizontal,!1,Pn,Qt,Yt);ao&&(ls.horizontal[Ps]=ao),Tr(),Ou(sn)&&Be&&Xe&&(ls.vertical=f_(Ms,l,c,x,Pt,Ir,Oe,an,Ps,bs,us,Go.vertical,!1,Pn,Qt,Yt))}}var Ii=void 0,lo=!1;if(xt.icon&&xt.icon.name){var Hr=_[xt.icon.name];Hr&&(Ii=function(fn,nr,Yn){var In=Ef(Yn),vo=nr[0]-fn.displaySize[0]*In.horizontalAlign,qi=nr[1]-fn.displaySize[1]*In.verticalAlign;return{image:fn,top:qi,bottom:qi+fn.displaySize[1],left:vo,right:vo+fn.displaySize[0]}}(x[xt.icon.name],$.get("icon-offset").evaluate(xt,{},T),$.get("icon-anchor").evaluate(xt,{},T)),lo=Hr.sdf,i.sdfIcons===void 0?i.sdfIcons=Hr.sdf:i.sdfIcons!==Hr.sdf&&Me("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Hr.pixelRatio!==i.pixelRatio||$.get("icon-rotate").constantOr(1)!==0)&&(i.iconsNeedLinear=!0))}var Ti=U0(ls.horizontal)||ls.vertical;i.iconsInText=!!Ti&&Ti.iconsInText,(Ti||Ii)&&function(fn,nr,Yn,In,vo,qi,_r,er,Hi,Rn,Lo){var Ys=qi.textMaxSize.evaluate(nr,{});Ys===void 0&&(Ys=_r);var mc,Nn=fn.layers[0].layout,gr=Nn.get("icon-offset").evaluate(nr,{},Lo),Ka=U0(Yn.horizontal),Na=_r/24,Gd=fn.tilePixelRatio*Na,dp=fn.tilePixelRatio*Ys/24,cu=fn.tilePixelRatio*er,hp=fn.tilePixelRatio*Nn.get("symbol-spacing"),I_=Nn.get("text-padding")*fn.tilePixelRatio,Hu=Nn.get("icon-padding")*fn.tilePixelRatio,Of=Nn.get("text-max-angle")/180*Math.PI,Ja=Nn.get("text-rotation-alignment")==="map"&&Nn.get("symbol-placement")!=="point",Lf=Nn.get("icon-rotation-alignment")==="map"&&Nn.get("symbol-placement")!=="point",Qa=Nn.get("symbol-placement"),Or=hp/2,Lr=Nn.get("icon-text-fit");In&&Lr!=="none"&&(fn.allowVerticalPlacement&&Yn.vertical&&(mc=fy(In,Yn.vertical,Lr,Nn.get("icon-text-fit-padding"),gr,Na)),Ka&&(In=fy(In,Ka,Lr,Nn.get("icon-text-fit-padding"),gr,Na)));var uu=function(t1,No){No.x<0||No.x>=8192||No.y<0||No.y>=8192||function(Ur,El,yr,Gu,P_,Ff,R_,yc,$_,zf,O_,L_,Sy,s1,Uf,n1,r1,i1,o1,N_,ua,_p,a1,vc,bw){var Gi,Oi,gp,yp,vp,Kd=Ur.addToLineVertexArray(El,yr),l1=0,c1=0,u1=0,Cy=0,Iy=-1,Ty=-1,hu={},Ay=Le(""),D_=0,My=0;if(yc._unevaluatedLayout.getValue("text-radial-offset")===void 0?(D_=(Gi=yc.layout.get("text-offset").evaluate(ua,{},vc).map(function(jf){return 24*jf}))[0],My=Gi[1]):(D_=24*yc.layout.get("text-radial-offset").evaluate(ua,{},vc),My=b_),Ur.allowVerticalPlacement&&Gu.vertical){var d1=yc.layout.get("text-rotate").evaluate(ua,{},vc)+90;yp=new kf($_,El,zf,O_,L_,Gu.vertical,Sy,s1,Uf,d1),R_&&(vp=new kf($_,El,zf,O_,L_,R_,r1,i1,Uf,d1))}if(P_){var Ey=yc.layout.get("icon-rotate").evaluate(ua,{}),h1=yc.layout.get("icon-text-fit")!=="none",Jd=N0(P_,Ey,a1,h1),ky=R_?N0(R_,Ey,a1,h1):void 0;gp=new kf($_,El,zf,O_,L_,P_,r1,i1,!1,Ey),l1=4*Jd.length;var p1=Ur.iconSizeData,Vf=null;p1.kind==="source"?(Vf=[128*yc.layout.get("icon-size").evaluate(ua,{})])[0]>32640&&Me(Ur.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):p1.kind==="composite"&&((Vf=[128*_p.compositeIconSizes[0].evaluate(ua,{},vc),128*_p.compositeIconSizes[1].evaluate(ua,{},vc)])[0]>32640||Vf[1]>32640)&&Me(Ur.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Ur.addSymbols(Ur.icon,Jd,Vf,N_,o1,ua,!1,El,Kd.lineStartIndex,Kd.lineLength,-1,vc),Iy=Ur.icon.placedSymbolArray.length-1,ky&&(c1=4*ky.length,Ur.addSymbols(Ur.icon,ky,Vf,N_,o1,ua,Go.vertical,El,Kd.lineStartIndex,Kd.lineLength,-1,vc),Ty=Ur.icon.placedSymbolArray.length-1)}for(var f1 in Gu.horizontal){var B_=Gu.horizontal[f1];if(!Oi){Ay=Le(B_.text);var m1=yc.layout.get("text-rotate").evaluate(ua,{},vc);Oi=new kf($_,El,zf,O_,L_,B_,Sy,s1,Uf,m1)}var Py=B_.positionedLines.length===1;if(u1+=z0(Ur,El,B_,Ff,yc,Uf,ua,n1,Kd,Gu.vertical?Go.horizontal:Go.horizontalOnly,Py?Object.keys(Gu.horizontal):[f1],hu,Iy,_p,vc),Py)break}Gu.vertical&&(Cy+=z0(Ur,El,Gu.vertical,Ff,yc,Uf,ua,n1,Kd,Go.vertical,["vertical"],hu,Ty,_p,vc));var xw=Oi?Oi.boxStartIndex:Ur.collisionBoxArray.length,ww=Oi?Oi.boxEndIndex:Ur.collisionBoxArray.length,Sw=yp?yp.boxStartIndex:Ur.collisionBoxArray.length,Cw=yp?yp.boxEndIndex:Ur.collisionBoxArray.length,Iw=gp?gp.boxStartIndex:Ur.collisionBoxArray.length,Tw=gp?gp.boxEndIndex:Ur.collisionBoxArray.length,Aw=vp?vp.boxStartIndex:Ur.collisionBoxArray.length,Mw=vp?vp.boxEndIndex:Ur.collisionBoxArray.length,bc=-1,F_=function(jf,g1){return jf&&jf.circleDiameter?Math.max(jf.circleDiameter,g1):g1};bc=F_(Oi,bc),bc=F_(yp,bc),bc=F_(gp,bc);var _1=(bc=F_(vp,bc))>-1?1:0;_1&&(bc*=bw/24),Ur.glyphOffsetArray.length>=Qn.MAX_GLYPHS&&Me("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ua.sortKey!==void 0&&Ur.addToSortKeyRanges(Ur.symbolInstances.length,ua.sortKey),Ur.symbolInstances.emplaceBack(El.x,El.y,hu.right>=0?hu.right:-1,hu.center>=0?hu.center:-1,hu.left>=0?hu.left:-1,hu.vertical||-1,Iy,Ty,Ay,xw,ww,Sw,Cw,Iw,Tw,Aw,Mw,zf,u1,Cy,l1,c1,_1,0,Sy,D_,My,bc)}(fn,No,t1,Yn,In,vo,mc,fn.layers[0],fn.collisionBoxArray,nr.index,nr.sourceLayerIndex,fn.index,Gd,I_,Ja,Hi,cu,Hu,Lf,gr,nr,qi,Rn,Lo,_r)};if(Qa==="line")for(var pp=0,T_=L0(nr.geometry,0,0,8192,8192);pp<T_.length;pp+=1)for(var A_=T_[pp],Nf=0,Df=iw(A_,hp,Of,Yn.vertical||Ka,In,24,dp,fn.overscaling,8192);Nf<Df.length;Nf+=1){var M_=Df[Nf];Ka&&lw(fn,Ka.text,Or,M_)||uu(A_,M_)}else if(Qa==="line-center")for(var fp=0,du=nr.geometry;fp<du.length;fp+=1){var Wd=du[fp];if(Wd.length>1){var E_=rw(Wd,Of,Yn.vertical||Ka,In,24,dp);E_&&uu(Wd,E_)}}else if(nr.type==="Polygon")for(var Yd=0,Zd=sy(nr.geometry,0);Yd<Zd.length;Yd+=1){var co=Zd[Yd],_c=ow(co,16);uu(co[0],new ou(_c.x,_c.y,0))}else if(nr.type==="LineString")for(var Xd=0,Bf=nr.geometry;Xd<Bf.length;Xd+=1){var mp=Bf[Xd];uu(mp,new ou(mp[0].x,mp[0].y,0))}else if(nr.type==="Point")for(var wy=0,e1=nr.geometry;wy<e1.length;wy+=1)for(var k_=0,gc=e1[wy];k_<gc.length;k_+=1){var gn=gc[k_];uu([gn],new ou(gn.x,gn.y,0))}}(i,xt,ls,Ii,_,V,Qt,Is,us,lo,T)},ft=0,yt=i.features;ft<yt.length;ft+=1)lt();w&&i.generateCollisionDebugBuffers()},o.perspective=function(i,l,c,_,x){var w,T=1/Math.tan(l/2);return i[0]=T/c,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=T,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,x!=null&&x!==1/0?(i[10]=(x+_)*(w=1/(_-x)),i[14]=2*x*_*w):(i[10]=-1,i[14]=-2*_),i},o.pick=function(i,l){for(var c={},_=0;_<l.length;_++){var x=l[_];x in i&&(c[x]=i[x])}return c},o.plugin=Vo,o.polygonIntersectsPolygon=qa,o.postMapLoadEvent=Re,o.postTurnstileEvent=B,o.potpack=E0,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.register=_s,o.registerForPluginStateChange=function(i){return i({pluginStatus:Eo,pluginURL:ta}),gf.on("pluginStateChange",i),i},o.renderColorRamp=u0,o.rotate=function(i,l,c){var _=l[0],x=l[1],w=l[2],T=l[3],$=Math.sin(c),D=Math.cos(c);return i[0]=_*D+w*$,i[1]=x*D+T*$,i[2]=_*-$+w*D,i[3]=x*-$+T*D,i},o.rotateX=function(i,l,c){var _=Math.sin(c),x=Math.cos(c),w=l[4],T=l[5],$=l[6],D=l[7],V=l[8],Z=l[9],K=l[10],le=l[11];return l!==i&&(i[0]=l[0],i[1]=l[1],i[2]=l[2],i[3]=l[3],i[12]=l[12],i[13]=l[13],i[14]=l[14],i[15]=l[15]),i[4]=w*x+V*_,i[5]=T*x+Z*_,i[6]=$*x+K*_,i[7]=D*x+le*_,i[8]=V*x-w*_,i[9]=Z*x-T*_,i[10]=K*x-$*_,i[11]=le*x-D*_,i},o.rotateZ=function(i,l,c){var _=Math.sin(c),x=Math.cos(c),w=l[0],T=l[1],$=l[2],D=l[3],V=l[4],Z=l[5],K=l[6],le=l[7];return l!==i&&(i[8]=l[8],i[9]=l[9],i[10]=l[10],i[11]=l[11],i[12]=l[12],i[13]=l[13],i[14]=l[14],i[15]=l[15]),i[0]=w*x+V*_,i[1]=T*x+Z*_,i[2]=$*x+K*_,i[3]=D*x+le*_,i[4]=V*x-w*_,i[5]=Z*x-T*_,i[6]=K*x-$*_,i[7]=le*x-D*_,i},o.scale=function(i,l,c){var _=c[0],x=c[1],w=c[2];return i[0]=l[0]*_,i[1]=l[1]*_,i[2]=l[2]*_,i[3]=l[3]*_,i[4]=l[4]*x,i[5]=l[5]*x,i[6]=l[6]*x,i[7]=l[7]*x,i[8]=l[8]*w,i[9]=l[9]*w,i[10]=l[10]*w,i[11]=l[11]*w,i[12]=l[12],i[13]=l[13],i[14]=l[14],i[15]=l[15],i},o.scale$1=function(i,l,c){return i[0]=l[0]*c,i[1]=l[1]*c,i[2]=l[2]*c,i[3]=l[3]*c,i},o.scale$2=function(i,l,c){return i[0]=l[0]*c,i[1]=l[1]*c,i[2]=l[2]*c,i},o.setCacheLimits=function(i,l){nt=i,gt=l},o.setRTLTextPlugin=function(i,l,c){if(c===void 0&&(c=!1),Eo==="deferred"||Eo==="loading"||Eo==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");ta=ct.resolveURL(i),Eo="deferred",Yh=l,Jc(),c||Pa()},o.sphericalToCartesian=function(i){var l=i[0],c=i[1],_=i[2];return c+=90,c*=Math.PI/180,_*=Math.PI/180,{x:l*Math.cos(c)*Math.sin(_),y:l*Math.sin(c)*Math.sin(_),z:l*Math.cos(_)}},o.sqrLen=function(i){var l=i[0],c=i[1];return l*l+c*c},o.styleSpec=xe,o.sub=function(i,l,c){return i[0]=l[0]-c[0],i[1]=l[1]-c[1],i[2]=l[2]-c[2],i},o.symbolSize=nw,o.transformMat3=function(i,l,c){var _=l[0],x=l[1],w=l[2];return i[0]=_*c[0]+x*c[3]+w*c[6],i[1]=_*c[1]+x*c[4]+w*c[7],i[2]=_*c[2]+x*c[5]+w*c[8],i},o.transformMat4=Fu,o.translate=function(i,l,c){var _,x,w,T,$,D,V,Z,K,le,_e,Oe,Be=c[0],Xe=c[1],He=c[2];return l===i?(i[12]=l[0]*Be+l[4]*Xe+l[8]*He+l[12],i[13]=l[1]*Be+l[5]*Xe+l[9]*He+l[13],i[14]=l[2]*Be+l[6]*Xe+l[10]*He+l[14],i[15]=l[3]*Be+l[7]*Xe+l[11]*He+l[15]):(x=l[1],w=l[2],T=l[3],$=l[4],D=l[5],V=l[6],Z=l[7],K=l[8],le=l[9],_e=l[10],Oe=l[11],i[0]=_=l[0],i[1]=x,i[2]=w,i[3]=T,i[4]=$,i[5]=D,i[6]=V,i[7]=Z,i[8]=K,i[9]=le,i[10]=_e,i[11]=Oe,i[12]=_*Be+$*Xe+K*He+l[12],i[13]=x*Be+D*Xe+le*He+l[13],i[14]=w*Be+V*Xe+_e*He+l[14],i[15]=T*Be+Z*Xe+Oe*He+l[15]),i},o.triggerPluginCompletionEvent=kd,o.uniqueId=Ce,o.validateCustomStyleLayer=function(i){var l=[],c=i.id;return c===void 0&&l.push({message:"layers."+c+': missing required property "id"'}),i.render===void 0&&l.push({message:"layers."+c+': missing required method "render"'}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&l.push({message:"layers."+c+': property "renderingMode" must be either "2d" or "3d"'}),l},o.validateLight=$u,o.validateStyle=Md,o.values=function(i){var l=[];for(var c in i)l.push(i[c]);return l},o.vectorTile=Al,o.version="1.13.3",o.warnOnce=Me,o.webpSupported=ht,o.window=I,o.wrap=ce}),a(["./shared"],function(o){function d(Q){var ae=typeof Q;if(ae==="number"||ae==="boolean"||ae==="string"||Q==null)return JSON.stringify(Q);if(Array.isArray(Q)){for(var me="[",Ae=0,Fe=Q;Ae<Fe.length;Ae+=1)me+=d(Fe[Ae])+",";return me+"]"}for(var et=Object.keys(Q).sort(),st="{",xe=0;xe<et.length;xe++)st+=JSON.stringify(et[xe])+":"+d(Q[et[xe]])+",";return st+"}"}function p(Q){for(var ae="",me=0,Ae=o.refProperties;me<Ae.length;me+=1)ae+="/"+d(Q[Ae[me]]);return ae}var y=function(Q){this.keyCache={},Q&&this.replace(Q)};y.prototype.replace=function(Q){this._layerConfigs={},this._layers={},this.update(Q,[])},y.prototype.update=function(Q,ae){for(var me=this,Ae=0,Fe=Q;Ae<Fe.length;Ae+=1){var et=Fe[Ae];this._layerConfigs[et.id]=et;var st=this._layers[et.id]=o.createStyleLayer(et);st._featureFilter=o.featureFilter(st.filter),this.keyCache[et.id]&&delete this.keyCache[et.id]}for(var xe=0,Ve=ae;xe<Ve.length;xe+=1){var pt=Ve[xe];delete this.keyCache[pt],delete this._layerConfigs[pt],delete this._layers[pt]}this.familiesBySource={};for(var Ft=0,Ht=function(ns,is){for(var rn={},hs=0;hs<ns.length;hs++){var mn=is&&is[ns[hs].id]||p(ns[hs]);is&&(is[ns[hs].id]=mn);var Fn=rn[mn];Fn||(Fn=rn[mn]=[]),Fn.push(ns[hs])}var hn=[];for(var Sn in rn)hn.push(rn[Sn]);return hn}(o.values(this._layerConfigs),this.keyCache);Ft<Ht.length;Ft+=1){var Tt=Ht[Ft].map(function(ns){return me._layers[ns.id]}),Vt=Tt[0];if(Vt.visibility!=="none"){var xs=Vt.source||"",ms=this.familiesBySource[xs];ms||(ms=this.familiesBySource[xs]={});var At=Vt.sourceLayer||"_geojsonTileLayer",fs=ms[At];fs||(fs=ms[At]=[]),fs.push(Tt)}}};var v=function(Q){var ae={},me=[];for(var Ae in Q){var Fe=Q[Ae],et=ae[Ae]={};for(var st in Fe){var xe=Fe[+st];if(xe&&xe.bitmap.width!==0&&xe.bitmap.height!==0){var Ve={x:0,y:0,w:xe.bitmap.width+2,h:xe.bitmap.height+2};me.push(Ve),et[st]={rect:Ve,metrics:xe.metrics}}}}var pt=o.potpack(me),Ft=new o.AlphaImage({width:pt.w||1,height:pt.h||1});for(var Ht in Q){var Tt=Q[Ht];for(var Vt in Tt){var xs=Tt[+Vt];if(xs&&xs.bitmap.width!==0&&xs.bitmap.height!==0){var ms=ae[Ht][Vt].rect;o.AlphaImage.copy(xs.bitmap,Ft,{x:0,y:0},{x:ms.x+1,y:ms.y+1},xs.bitmap)}}}this.image=Ft,this.positions=ae};o.register("GlyphAtlas",v);var C=function(Q){this.tileID=new o.OverscaledTileID(Q.tileID.overscaledZ,Q.tileID.wrap,Q.tileID.canonical.z,Q.tileID.canonical.x,Q.tileID.canonical.y),this.uid=Q.uid,this.zoom=Q.zoom,this.pixelRatio=Q.pixelRatio,this.tileSize=Q.tileSize,this.source=Q.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Q.showCollisionBoxes,this.collectResourceTiming=!!Q.collectResourceTiming,this.returnDependencies=!!Q.returnDependencies,this.promoteId=Q.promoteId};function I(Q,ae,me){for(var Ae=new o.EvaluationParameters(ae),Fe=0,et=Q;Fe<et.length;Fe+=1)et[Fe].recalculate(Ae,me)}function O(Q,ae){var me=o.getArrayBuffer(Q.request,function(Ae,Fe,et,st){Ae?ae(Ae):Fe&&ae(null,{vectorTile:new o.vectorTile.VectorTile(new o.pbf(Fe)),rawData:Fe,cacheControl:et,expires:st})});return function(){me.cancel(),ae()}}C.prototype.parse=function(Q,ae,me,Ae,Fe){var et=this;this.status="parsing",this.data=Q,this.collisionBoxArray=new o.CollisionBoxArray;var st=new o.DictionaryCoder(Object.keys(Q.layers).sort()),xe=new o.FeatureIndex(this.tileID,this.promoteId);xe.bucketLayerIDs=[];var Ve,pt,Ft,Ht,Tt={},Vt={featureIndex:xe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:me},xs=ae.familiesBySource[this.source];for(var ms in xs){var At=Q.layers[ms];if(At){At.version===1&&o.warnOnce('Vector tile source "'+this.source+'" layer "'+ms+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var fs=st.encode(ms),ns=[],is=0;is<At.length;is++){var rn=At.feature(is),hs=xe.getId(rn,ms);ns.push({feature:rn,id:hs,index:is,sourceLayerIndex:fs})}for(var mn=0,Fn=xs[ms];mn<Fn.length;mn+=1){var hn=Fn[mn],Sn=hn[0];Sn.minzoom&&this.zoom<Math.floor(Sn.minzoom)||Sn.maxzoom&&this.zoom>=Sn.maxzoom||Sn.visibility!=="none"&&(I(hn,this.zoom,me),(Tt[Sn.id]=Sn.createBucket({index:xe.bucketLayerIDs.length,layers:hn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:fs,sourceID:this.source})).populate(ns,Vt,this.tileID.canonical),xe.bucketLayerIDs.push(hn.map(function(Hn){return Hn.id})))}}}var bn=o.mapObject(Vt.glyphDependencies,function(Hn){return Object.keys(Hn).map(Number)});Object.keys(bn).length?Ae.send("getGlyphs",{uid:this.uid,stacks:bn},function(Hn,pn){Ve||(Ve=Hn,pt=pn,Br.call(et))}):pt={};var eo=Object.keys(Vt.iconDependencies);eo.length?Ae.send("getImages",{icons:eo,source:this.source,tileID:this.tileID,type:"icons"},function(Hn,pn){Ve||(Ve=Hn,Ft=pn,Br.call(et))}):Ft={};var zn=Object.keys(Vt.patternDependencies);function Br(){if(Ve)return Fe(Ve);if(pt&&Ft&&Ht){var Hn=new v(pt),pn=new o.ImageAtlas(Ft,Ht);for(var On in Tt){var po=Tt[On];po instanceof o.SymbolBucket?(I(po.layers,this.zoom,me),o.performSymbolLayout(po,pt,Hn.positions,Ft,pn.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):po.hasPattern&&(po instanceof o.LineBucket||po instanceof o.FillBucket||po instanceof o.FillExtrusionBucket)&&(I(po.layers,this.zoom,me),po.addFeatures(Vt,this.tileID.canonical,pn.patternPositions))}this.status="done",Fe(null,{buckets:o.values(Tt).filter(function(vd){return!vd.isEmpty()}),featureIndex:xe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Hn.image,imageAtlas:pn,glyphMap:this.returnDependencies?pt:null,iconMap:this.returnDependencies?Ft:null,glyphPositions:this.returnDependencies?Hn.positions:null})}}zn.length?Ae.send("getImages",{icons:zn,source:this.source,tileID:this.tileID,type:"patterns"},function(Hn,pn){Ve||(Ve=Hn,Ht=pn,Br.call(et))}):Ht={},Br.call(this)};var A=function(Q,ae,me,Ae){this.actor=Q,this.layerIndex=ae,this.availableImages=me,this.loadVectorData=Ae||O,this.loading={},this.loaded={}};A.prototype.loadTile=function(Q,ae){var me=this,Ae=Q.uid;this.loading||(this.loading={});var Fe=!!(Q&&Q.request&&Q.request.collectResourceTiming)&&new o.RequestPerformance(Q.request),et=this.loading[Ae]=new C(Q);et.abort=this.loadVectorData(Q,function(st,xe){if(delete me.loading[Ae],st||!xe)return et.status="done",me.loaded[Ae]=et,ae(st);var Ve=xe.rawData,pt={};xe.expires&&(pt.expires=xe.expires),xe.cacheControl&&(pt.cacheControl=xe.cacheControl);var Ft={};if(Fe){var Ht=Fe.finish();Ht&&(Ft.resourceTiming=JSON.parse(JSON.stringify(Ht)))}et.vectorTile=xe.vectorTile,et.parse(xe.vectorTile,me.layerIndex,me.availableImages,me.actor,function(Tt,Vt){if(Tt||!Vt)return ae(Tt);ae(null,o.extend({rawTileData:Ve.slice(0)},Vt,pt,Ft))}),me.loaded=me.loaded||{},me.loaded[Ae]=et})},A.prototype.reloadTile=function(Q,ae){var me=this,Ae=this.loaded,Fe=Q.uid,et=this;if(Ae&&Ae[Fe]){var st=Ae[Fe];st.showCollisionBoxes=Q.showCollisionBoxes;var xe=function(Ve,pt){var Ft=st.reloadCallback;Ft&&(delete st.reloadCallback,st.parse(st.vectorTile,et.layerIndex,me.availableImages,et.actor,Ft)),ae(Ve,pt)};st.status==="parsing"?st.reloadCallback=xe:st.status==="done"&&(st.vectorTile?st.parse(st.vectorTile,this.layerIndex,this.availableImages,this.actor,xe):xe())}},A.prototype.abortTile=function(Q,ae){var me=this.loading,Ae=Q.uid;me&&me[Ae]&&me[Ae].abort&&(me[Ae].abort(),delete me[Ae]),ae()},A.prototype.removeTile=function(Q,ae){var me=this.loaded,Ae=Q.uid;me&&me[Ae]&&delete me[Ae],ae()};var P=o.window.ImageBitmap,q=function(){this.loaded={}};function ce(Q,ae){if(Q.length!==0){re(Q[0],ae);for(var me=1;me<Q.length;me++)re(Q[me],!ae)}}function re(Q,ae){for(var me=0,Ae=0,Fe=0,et=Q.length,st=et-1;Fe<et;st=Fe++){var xe=(Q[Fe][0]-Q[st][0])*(Q[st][1]+Q[Fe][1]),Ve=me+xe;Ae+=Math.abs(me)>=Math.abs(xe)?me-Ve+xe:xe-Ve+me,me=Ve}me+Ae>=0!=!!ae&&Q.reverse()}q.prototype.loadTile=function(Q,ae){var me=Q.uid,Ae=Q.encoding,Fe=Q.rawImageData,et=P&&Fe instanceof P?this.getImageData(Fe):Fe,st=new o.DEMData(me,et,Ae);this.loaded=this.loaded||{},this.loaded[me]=st,ae(null,st)},q.prototype.getImageData=function(Q){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Q.width,Q.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Q.width,this.offscreenCanvas.height=Q.height,this.offscreenCanvasContext.drawImage(Q,0,0,Q.width,Q.height);var ae=this.offscreenCanvasContext.getImageData(-1,-1,Q.width+2,Q.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new o.RGBAImage({width:ae.width,height:ae.height},ae.data)},q.prototype.removeTile=function(Q){var ae=this.loaded,me=Q.uid;ae&&ae[me]&&delete ae[me]};var W=o.vectorTile.VectorTileFeature.prototype.toGeoJSON,Ce=function(Q){this._feature=Q,this.extent=o.EXTENT,this.type=Q.type,this.properties=Q.tags,"id"in Q&&!isNaN(Q.id)&&(this.id=parseInt(Q.id,10))};Ce.prototype.loadGeometry=function(){if(this._feature.type===1){for(var Q=[],ae=0,me=this._feature.geometry;ae<me.length;ae+=1){var Ae=me[ae];Q.push([new o.Point$1(Ae[0],Ae[1])])}return Q}for(var Fe=[],et=0,st=this._feature.geometry;et<st.length;et+=1){for(var xe=[],Ve=0,pt=st[et];Ve<pt.length;Ve+=1){var Ft=pt[Ve];xe.push(new o.Point$1(Ft[0],Ft[1]))}Fe.push(xe)}return Fe},Ce.prototype.toGeoJSON=function(Q,ae,me){return W.call(this,Q,ae,me)};var te=function(Q){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=Q.length,this._features=Q};te.prototype.feature=function(Q){return new Ce(this._features[Q])};var oe=o.vectorTile.VectorTileFeature,ve=ee;function ee(Q,ae){this.options=ae||{},this.features=Q,this.length=Q.length}function ne(Q,ae){this.id=typeof Q.id=="number"?Q.id:void 0,this.type=Q.type,this.rawGeometry=Q.type===1?[Q.geometry]:Q.geometry,this.properties=Q.tags,this.extent=ae||4096}ee.prototype.feature=function(Q){return new ne(this.features[Q],this.options.extent)},ne.prototype.loadGeometry=function(){var Q=this.rawGeometry;this.geometry=[];for(var ae=0;ae<Q.length;ae++){for(var me=Q[ae],Ae=[],Fe=0;Fe<me.length;Fe++)Ae.push(new o.Point$1(me[Fe][0],me[Fe][1]));this.geometry.push(Ae)}return this.geometry},ne.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Q=this.geometry,ae=1/0,me=-1/0,Ae=1/0,Fe=-1/0,et=0;et<Q.length;et++)for(var st=Q[et],xe=0;xe<st.length;xe++){var Ve=st[xe];ae=Math.min(ae,Ve.x),me=Math.max(me,Ve.x),Ae=Math.min(Ae,Ve.y),Fe=Math.max(Fe,Ve.y)}return[ae,Ae,me,Fe]},ne.prototype.toGeoJSON=oe.prototype.toGeoJSON;var Se=Qe,Ue=ve;function Qe(Q){var ae=new o.pbf;return function(me,Ae){for(var Fe in me.layers)Ae.writeMessage(3,Me,me.layers[Fe])}(Q,ae),ae.finish()}function Me(Q,ae){var me;ae.writeVarintField(15,Q.version||1),ae.writeStringField(1,Q.name||""),ae.writeVarintField(5,Q.extent||4096);var Ae={keys:[],values:[],keycache:{},valuecache:{}};for(me=0;me<Q.length;me++)Ae.feature=Q.feature(me),ae.writeMessage(2,vt,Ae);var Fe=Ae.keys;for(me=0;me<Fe.length;me++)ae.writeStringField(3,Fe[me]);var et=Ae.values;for(me=0;me<et.length;me++)ae.writeMessage(4,j,et[me])}function vt(Q,ae){var me=Q.feature;me.id!==void 0&&ae.writeVarintField(1,me.id),ae.writeMessage(2,Ut,Q),ae.writeVarintField(3,me.type),ae.writeMessage(4,F,me)}function Ut(Q,ae){var me=Q.feature,Ae=Q.keys,Fe=Q.values,et=Q.keycache,st=Q.valuecache;for(var xe in me.properties){var Ve=et[xe];Ve===void 0&&(Ae.push(xe),et[xe]=Ve=Ae.length-1),ae.writeVarint(Ve);var pt=me.properties[xe],Ft=typeof pt;Ft!=="string"&&Ft!=="boolean"&&Ft!=="number"&&(pt=JSON.stringify(pt));var Ht=Ft+":"+pt,Tt=st[Ht];Tt===void 0&&(Fe.push(pt),st[Ht]=Tt=Fe.length-1),ae.writeVarint(Tt)}}function Rt(Q,ae){return(ae<<3)+(7&Q)}function _t(Q){return Q<<1^Q>>31}function F(Q,ae){for(var me=Q.loadGeometry(),Ae=Q.type,Fe=0,et=0,st=me.length,xe=0;xe<st;xe++){var Ve=me[xe],pt=1;Ae===1&&(pt=Ve.length),ae.writeVarint(Rt(1,pt));for(var Ft=Ae===3?Ve.length-1:Ve.length,Ht=0;Ht<Ft;Ht++){Ht===1&&Ae!==1&&ae.writeVarint(Rt(2,Ft-1));var Tt=Ve[Ht].x-Fe,Vt=Ve[Ht].y-et;ae.writeVarint(_t(Tt)),ae.writeVarint(_t(Vt)),Fe+=Tt,et+=Vt}Ae===3&&ae.writeVarint(Rt(7,1))}}function j(Q,ae){var me=typeof Q;me==="string"?ae.writeStringField(1,Q):me==="boolean"?ae.writeBooleanField(7,Q):me==="number"&&(Q%1!=0?ae.writeDoubleField(3,Q):Q<0?ae.writeSVarintField(6,Q):ae.writeVarintField(5,Q))}function G(Q,ae,me,Ae){Y(Q,me,Ae),Y(ae,2*me,2*Ae),Y(ae,2*me+1,2*Ae+1)}function Y(Q,ae,me){var Ae=Q[ae];Q[ae]=Q[me],Q[me]=Ae}function J(Q,ae,me,Ae){var Fe=Q-me,et=ae-Ae;return Fe*Fe+et*et}Se.fromVectorTileJs=Qe,Se.fromGeojsonVt=function(Q,ae){ae=ae||{};var me={};for(var Ae in Q)me[Ae]=new ve(Q[Ae].features,ae),me[Ae].name=Ae,me[Ae].version=ae.version,me[Ae].extent=ae.extent;return Qe({layers:me})},Se.GeoJSONWrapper=Ue;var he=function(Q){return Q[0]},be=function(Q){return Q[1]},Ne=function(Q,ae,me,Ae,Fe){ae===void 0&&(ae=he),me===void 0&&(me=be),Ae===void 0&&(Ae=64),Fe===void 0&&(Fe=Float64Array),this.nodeSize=Ae,this.points=Q;for(var et=Q.length<65536?Uint16Array:Uint32Array,st=this.ids=new et(Q.length),xe=this.coords=new Fe(2*Q.length),Ve=0;Ve<Q.length;Ve++)st[Ve]=Ve,xe[2*Ve]=ae(Q[Ve]),xe[2*Ve+1]=me(Q[Ve]);(function pt(Ft,Ht,Tt,Vt,xs,ms){if(!(xs-Vt<=Tt)){var At=Vt+xs>>1;(function fs(ns,is,rn,hs,mn,Fn){for(;mn>hs;){if(mn-hs>600){var hn=mn-hs+1,Sn=rn-hs+1,bn=Math.log(hn),eo=.5*Math.exp(2*bn/3),zn=.5*Math.sqrt(bn*eo*(hn-eo)/hn)*(Sn-hn/2<0?-1:1);fs(ns,is,rn,Math.max(hs,Math.floor(rn-Sn*eo/hn+zn)),Math.min(mn,Math.floor(rn+(hn-Sn)*eo/hn+zn)),Fn)}var Br=is[2*rn+Fn],Hn=hs,pn=mn;for(G(ns,is,hs,rn),is[2*mn+Fn]>Br&&G(ns,is,hs,mn);Hn<pn;){for(G(ns,is,Hn,pn),Hn++,pn--;is[2*Hn+Fn]<Br;)Hn++;for(;is[2*pn+Fn]>Br;)pn--}is[2*hs+Fn]===Br?G(ns,is,hs,pn):G(ns,is,++pn,mn),pn<=rn&&(hs=pn+1),rn<=pn&&(mn=pn-1)}})(Ft,Ht,At,Vt,xs,ms%2),pt(Ft,Ht,Tt,Vt,At-1,ms+1),pt(Ft,Ht,Tt,At+1,xs,ms+1)}})(st,xe,Ae,0,st.length-1,0)};Ne.prototype.range=function(Q,ae,me,Ae){return function(Fe,et,st,xe,Ve,pt,Ft){for(var Ht,Tt,Vt=[0,Fe.length-1,0],xs=[];Vt.length;){var ms=Vt.pop(),At=Vt.pop(),fs=Vt.pop();if(At-fs<=Ft)for(var ns=fs;ns<=At;ns++)Tt=et[2*ns+1],(Ht=et[2*ns])>=st&&Ht<=Ve&&Tt>=xe&&Tt<=pt&&xs.push(Fe[ns]);else{var is=Math.floor((fs+At)/2);Tt=et[2*is+1],(Ht=et[2*is])>=st&&Ht<=Ve&&Tt>=xe&&Tt<=pt&&xs.push(Fe[is]);var rn=(ms+1)%2;(ms===0?st<=Ht:xe<=Tt)&&(Vt.push(fs),Vt.push(is-1),Vt.push(rn)),(ms===0?Ve>=Ht:pt>=Tt)&&(Vt.push(is+1),Vt.push(At),Vt.push(rn))}}return xs}(this.ids,this.coords,Q,ae,me,Ae,this.nodeSize)},Ne.prototype.within=function(Q,ae,me){return function(Ae,Fe,et,st,xe,Ve){for(var pt=[0,Ae.length-1,0],Ft=[],Ht=xe*xe;pt.length;){var Tt=pt.pop(),Vt=pt.pop(),xs=pt.pop();if(Vt-xs<=Ve)for(var ms=xs;ms<=Vt;ms++)J(Fe[2*ms],Fe[2*ms+1],et,st)<=Ht&&Ft.push(Ae[ms]);else{var At=Math.floor((xs+Vt)/2),fs=Fe[2*At],ns=Fe[2*At+1];J(fs,ns,et,st)<=Ht&&Ft.push(Ae[At]);var is=(Tt+1)%2;(Tt===0?et-xe<=fs:st-xe<=ns)&&(pt.push(xs),pt.push(At-1),pt.push(is)),(Tt===0?et+xe>=fs:st+xe>=ns)&&(pt.push(At+1),pt.push(Vt),pt.push(is))}}return Ft}(this.ids,this.coords,Q,ae,me,this.nodeSize)};var ke={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Q){return Q}},qe=function(Q){this.options=Je(Object.create(ke),Q),this.trees=new Array(this.options.maxZoom+1)};function ct(Q,ae,me,Ae,Fe){return{x:Q,y:ae,zoom:1/0,id:me,parentId:-1,numPoints:Ae,properties:Fe}}function We(Q,ae){var me=Q.geometry.coordinates,Ae=me[1];return{x:fe(me[0]),y:ye(Ae),zoom:1/0,index:ae,parentId:-1}}function ht(Q){return{type:"Feature",id:Q.id,properties:rt(Q),geometry:{type:"Point",coordinates:[(Ae=Q.x,360*(Ae-.5)),(ae=Q.y,me=(180-360*ae)*Math.PI/180,360*Math.atan(Math.exp(me))/Math.PI-90)]}};var ae,me,Ae}function rt(Q){var ae=Q.numPoints,me=ae>=1e4?Math.round(ae/1e3)+"k":ae>=1e3?Math.round(ae/100)/10+"k":ae;return Je(Je({},Q.properties),{cluster:!0,cluster_id:Q.id,point_count:ae,point_count_abbreviated:me})}function fe(Q){return Q/360+.5}function ye(Q){var ae=Math.sin(Q*Math.PI/180),me=.5-.25*Math.log((1+ae)/(1-ae))/Math.PI;return me<0?0:me>1?1:me}function Je(Q,ae){for(var me in ae)Q[me]=ae[me];return Q}function at(Q){return Q.x}function it(Q){return Q.y}function Et(Q,ae,me,Ae,Fe,et){var st=Fe-me,xe=et-Ae;if(st!==0||xe!==0){var Ve=((Q-me)*st+(ae-Ae)*xe)/(st*st+xe*xe);Ve>1?(me=Fe,Ae=et):Ve>0&&(me+=st*Ve,Ae+=xe*Ve)}return(st=Q-me)*st+(xe=ae-Ae)*xe}function jt(Q,ae,me,Ae){var Fe={id:Q===void 0?null:Q,type:ae,geometry:me,tags:Ae,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(et){var st=et.geometry,xe=et.type;if(xe==="Point"||xe==="MultiPoint"||xe==="LineString")Nt(et,st);else if(xe==="Polygon"||xe==="MultiLineString")for(var Ve=0;Ve<st.length;Ve++)Nt(et,st[Ve]);else if(xe==="MultiPolygon")for(Ve=0;Ve<st.length;Ve++)for(var pt=0;pt<st[Ve].length;pt++)Nt(et,st[Ve][pt])}(Fe),Fe}function Nt(Q,ae){for(var me=0;me<ae.length;me+=3)Q.minX=Math.min(Q.minX,ae[me]),Q.minY=Math.min(Q.minY,ae[me+1]),Q.maxX=Math.max(Q.maxX,ae[me]),Q.maxY=Math.max(Q.maxY,ae[me+1])}function St(Q,ae,me,Ae){if(ae.geometry){var Fe=ae.geometry.coordinates,et=ae.geometry.type,st=Math.pow(me.tolerance/((1<<me.maxZoom)*me.extent),2),xe=[],Ve=ae.id;if(me.promoteId?Ve=ae.properties[me.promoteId]:me.generateId&&(Ve=Ae||0),et==="Point")Ct(Fe,xe);else if(et==="MultiPoint")for(var pt=0;pt<Fe.length;pt++)Ct(Fe[pt],xe);else if(et==="LineString")Bt(Fe,xe,st,!1);else if(et==="MultiLineString"){if(me.lineMetrics){for(pt=0;pt<Fe.length;pt++)Bt(Fe[pt],xe=[],st,!1),Q.push(jt(Ve,"LineString",xe,ae.properties));return}Kt(Fe,xe,st,!1)}else if(et==="Polygon")Kt(Fe,xe,st,!0);else{if(et!=="MultiPolygon"){if(et==="GeometryCollection"){for(pt=0;pt<ae.geometry.geometries.length;pt++)St(Q,{id:Ve,geometry:ae.geometry.geometries[pt],properties:ae.properties},me,Ae);return}throw new Error("Input data is not a valid GeoJSON object.")}for(pt=0;pt<Fe.length;pt++){var Ft=[];Kt(Fe[pt],Ft,st,!0),xe.push(Ft)}}Q.push(jt(Ve,et,xe,ae.properties))}}function Ct(Q,ae){ae.push(ys(Q[0])),ae.push(ts(Q[1])),ae.push(0)}function Bt(Q,ae,me,Ae){for(var Fe,et,st=0,xe=0;xe<Q.length;xe++){var Ve=ys(Q[xe][0]),pt=ts(Q[xe][1]);ae.push(Ve),ae.push(pt),ae.push(0),xe>0&&(st+=Ae?(Fe*pt-Ve*et)/2:Math.sqrt(Math.pow(Ve-Fe,2)+Math.pow(pt-et,2))),Fe=Ve,et=pt}var Ft=ae.length-3;ae[2]=1,function Ht(Tt,Vt,xs,ms){for(var At,fs=ms,ns=xs-Vt>>1,is=xs-Vt,rn=Tt[Vt],hs=Tt[Vt+1],mn=Tt[xs],Fn=Tt[xs+1],hn=Vt+3;hn<xs;hn+=3){var Sn=Et(Tt[hn],Tt[hn+1],rn,hs,mn,Fn);if(Sn>fs)At=hn,fs=Sn;else if(Sn===fs){var bn=Math.abs(hn-ns);bn<is&&(At=hn,is=bn)}}fs>ms&&(At-Vt>3&&Ht(Tt,Vt,At,ms),Tt[At+2]=fs,xs-At>3&&Ht(Tt,At,xs,ms))}(ae,0,Ft,me),ae[Ft+2]=1,ae.size=Math.abs(st),ae.start=0,ae.end=ae.size}function Kt(Q,ae,me,Ae){for(var Fe=0;Fe<Q.length;Fe++){var et=[];Bt(Q[Fe],et,me,Ae),ae.push(et)}}function ys(Q){return Q/360+.5}function ts(Q){var ae=Math.sin(Q*Math.PI/180),me=.5-.25*Math.log((1+ae)/(1-ae))/Math.PI;return me<0?0:me>1?1:me}function Us(Q,ae,me,Ae,Fe,et,st,xe){if(Ae/=ae,et>=(me/=ae)&&st<Ae)return Q;if(st<me||et>=Ae)return null;for(var Ve=[],pt=0;pt<Q.length;pt++){var Ft=Q[pt],Ht=Ft.geometry,Tt=Ft.type,Vt=Fe===0?Ft.minX:Ft.minY,xs=Fe===0?Ft.maxX:Ft.maxY;if(Vt>=me&&xs<Ae)Ve.push(Ft);else if(!(xs<me||Vt>=Ae)){var ms=[];if(Tt==="Point"||Tt==="MultiPoint")ue(Ht,ms,me,Ae,Fe);else if(Tt==="LineString")B(Ht,ms,me,Ae,Fe,!1,xe.lineMetrics);else if(Tt==="MultiLineString")Re(Ht,ms,me,Ae,Fe,!1);else if(Tt==="Polygon")Re(Ht,ms,me,Ae,Fe,!0);else if(Tt==="MultiPolygon")for(var At=0;At<Ht.length;At++){var fs=[];Re(Ht[At],fs,me,Ae,Fe,!0),fs.length&&ms.push(fs)}if(ms.length){if(xe.lineMetrics&&Tt==="LineString"){for(At=0;At<ms.length;At++)Ve.push(jt(Ft.id,Tt,ms[At],Ft.tags));continue}Tt!=="LineString"&&Tt!=="MultiLineString"||(ms.length===1?(Tt="LineString",ms=ms[0]):Tt="MultiLineString"),Tt!=="Point"&&Tt!=="MultiPoint"||(Tt=ms.length===3?"Point":"MultiPoint"),Ve.push(jt(Ft.id,Tt,ms,Ft.tags))}}}return Ve.length?Ve:null}function ue(Q,ae,me,Ae,Fe){for(var et=0;et<Q.length;et+=3){var st=Q[et+Fe];st>=me&&st<=Ae&&(ae.push(Q[et]),ae.push(Q[et+1]),ae.push(Q[et+2]))}}function B(Q,ae,me,Ae,Fe,et,st){for(var xe,Ve,pt=U(Q),Ft=Fe===0?gt:kt,Ht=Q.start,Tt=0;Tt<Q.length-3;Tt+=3){var Vt=Q[Tt],xs=Q[Tt+1],ms=Q[Tt+2],At=Q[Tt+3],fs=Q[Tt+4],ns=Fe===0?Vt:xs,is=Fe===0?At:fs,rn=!1;st&&(xe=Math.sqrt(Math.pow(Vt-At,2)+Math.pow(xs-fs,2))),ns<me?is>me&&(Ve=Ft(pt,Vt,xs,At,fs,me),st&&(pt.start=Ht+xe*Ve)):ns>Ae?is<Ae&&(Ve=Ft(pt,Vt,xs,At,fs,Ae),st&&(pt.start=Ht+xe*Ve)):nt(pt,Vt,xs,ms),is<me&&ns>=me&&(Ve=Ft(pt,Vt,xs,At,fs,me),rn=!0),is>Ae&&ns<=Ae&&(Ve=Ft(pt,Vt,xs,At,fs,Ae),rn=!0),!et&&rn&&(st&&(pt.end=Ht+xe*Ve),ae.push(pt),pt=U(Q)),st&&(Ht+=xe)}var hs=Q.length-3;Vt=Q[hs],xs=Q[hs+1],ms=Q[hs+2],(ns=Fe===0?Vt:xs)>=me&&ns<=Ae&&nt(pt,Vt,xs,ms),hs=pt.length-3,et&&hs>=3&&(pt[hs]!==pt[0]||pt[hs+1]!==pt[1])&&nt(pt,pt[0],pt[1],pt[2]),pt.length&&ae.push(pt)}function U(Q){var ae=[];return ae.size=Q.size,ae.start=Q.start,ae.end=Q.end,ae}function Re(Q,ae,me,Ae,Fe,et){for(var st=0;st<Q.length;st++)B(Q[st],ae,me,Ae,Fe,et,!1)}function nt(Q,ae,me,Ae){Q.push(ae),Q.push(me),Q.push(Ae)}function gt(Q,ae,me,Ae,Fe,et){var st=(et-ae)/(Ae-ae);return Q.push(et),Q.push(me+(Fe-me)*st),Q.push(1),st}function kt(Q,ae,me,Ae,Fe,et){var st=(et-me)/(Fe-me);return Q.push(ae+(Ae-ae)*st),Q.push(et),Q.push(1),st}function Ds(Q,ae){for(var me=[],Ae=0;Ae<Q.length;Ae++){var Fe,et=Q[Ae],st=et.type;if(st==="Point"||st==="MultiPoint"||st==="LineString")Fe=tn(et.geometry,ae);else if(st==="MultiLineString"||st==="Polygon"){Fe=[];for(var xe=0;xe<et.geometry.length;xe++)Fe.push(tn(et.geometry[xe],ae))}else if(st==="MultiPolygon")for(Fe=[],xe=0;xe<et.geometry.length;xe++){for(var Ve=[],pt=0;pt<et.geometry[xe].length;pt++)Ve.push(tn(et.geometry[xe][pt],ae));Fe.push(Ve)}me.push(jt(et.id,st,Fe,et.tags))}return me}function tn(Q,ae){var me=[];me.size=Q.size,Q.start!==void 0&&(me.start=Q.start,me.end=Q.end);for(var Ae=0;Ae<Q.length;Ae+=3)me.push(Q[Ae]+ae,Q[Ae+1],Q[Ae+2]);return me}function nn(Q,ae){if(Q.transformed)return Q;var me,Ae,Fe,et=1<<Q.z,st=Q.x,xe=Q.y;for(me=0;me<Q.features.length;me++){var Ve=Q.features[me],pt=Ve.geometry,Ft=Ve.type;if(Ve.geometry=[],Ft===1)for(Ae=0;Ae<pt.length;Ae+=2)Ve.geometry.push(qn(pt[Ae],pt[Ae+1],ae,et,st,xe));else for(Ae=0;Ae<pt.length;Ae++){var Ht=[];for(Fe=0;Fe<pt[Ae].length;Fe+=2)Ht.push(qn(pt[Ae][Fe],pt[Ae][Fe+1],ae,et,st,xe));Ve.geometry.push(Ht)}}return Q.transformed=!0,Q}function qn(Q,ae,me,Ae,Fe,et){return[Math.round(me*(Q*Ae-Fe)),Math.round(me*(ae*Ae-et))]}function Kn(Q,ae,me,Ae,Fe){for(var et=ae===Fe.maxZoom?0:Fe.tolerance/((1<<ae)*Fe.extent),st={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:me,y:Ae,z:ae,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},xe=0;xe<Q.length;xe++){st.numFeatures++,Eh(st,Q[xe],et,Fe);var Ve=Q[xe].minX,pt=Q[xe].minY,Ft=Q[xe].maxX,Ht=Q[xe].maxY;Ve<st.minX&&(st.minX=Ve),pt<st.minY&&(st.minY=pt),Ft>st.maxX&&(st.maxX=Ft),Ht>st.maxY&&(st.maxY=Ht)}return st}function Eh(Q,ae,me,Ae){var Fe=ae.geometry,et=ae.type,st=[];if(et==="Point"||et==="MultiPoint")for(var xe=0;xe<Fe.length;xe+=3)st.push(Fe[xe]),st.push(Fe[xe+1]),Q.numPoints++,Q.numSimplified++;else if(et==="LineString")Vc(st,Fe,Q,me,!1,!1);else if(et==="MultiLineString"||et==="Polygon")for(xe=0;xe<Fe.length;xe++)Vc(st,Fe[xe],Q,me,et==="Polygon",xe===0);else if(et==="MultiPolygon")for(var Ve=0;Ve<Fe.length;Ve++){var pt=Fe[Ve];for(xe=0;xe<pt.length;xe++)Vc(st,pt[xe],Q,me,!0,xe===0)}if(st.length){var Ft=ae.tags||null;if(et==="LineString"&&Ae.lineMetrics){for(var Ht in Ft={},ae.tags)Ft[Ht]=ae.tags[Ht];Ft.mapbox_clip_start=Fe.start/Fe.size,Ft.mapbox_clip_end=Fe.end/Fe.size}var Tt={geometry:st,type:et==="Polygon"||et==="MultiPolygon"?3:et==="LineString"||et==="MultiLineString"?2:1,tags:Ft};ae.id!==null&&(Tt.id=ae.id),Q.features.push(Tt)}}function Vc(Q,ae,me,Ae,Fe,et){var st=Ae*Ae;if(Ae>0&&ae.size<(Fe?st:Ae))me.numPoints+=ae.length/3;else{for(var xe=[],Ve=0;Ve<ae.length;Ve+=3)(Ae===0||ae[Ve+2]>st)&&(me.numSimplified++,xe.push(ae[Ve]),xe.push(ae[Ve+1])),me.numPoints++;Fe&&function(pt,Ft){for(var Ht=0,Tt=0,Vt=pt.length,xs=Vt-2;Tt<Vt;xs=Tt,Tt+=2)Ht+=(pt[Tt]-pt[xs])*(pt[Tt+1]+pt[xs+1]);if(Ht>0===Ft)for(Tt=0,Vt=pt.length;Tt<Vt/2;Tt+=2){var ms=pt[Tt],At=pt[Tt+1];pt[Tt]=pt[Vt-2-Tt],pt[Tt+1]=pt[Vt-1-Tt],pt[Vt-2-Tt]=ms,pt[Vt-1-Tt]=At}}(xe,et),Q.push(xe)}}function Ua(Q,ae){var me=(ae=this.options=function(Fe,et){for(var st in et)Fe[st]=et[st];return Fe}(Object.create(this.options),ae)).debug;if(me&&console.time("preprocess data"),ae.maxZoom<0||ae.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ae.promoteId&&ae.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ae=function(Fe,et){var st=[];if(Fe.type==="FeatureCollection")for(var xe=0;xe<Fe.features.length;xe++)St(st,Fe.features[xe],et,xe);else St(st,Fe.type==="Feature"?Fe:{geometry:Fe},et);return st}(Q,ae);this.tiles={},this.tileCoords=[],me&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ae.indexMaxZoom,ae.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Ae=function(Fe,et){var st=et.buffer/et.extent,xe=Fe,Ve=Us(Fe,1,-1-st,st,0,-1,2,et),pt=Us(Fe,1,1-st,2+st,0,-1,2,et);return(Ve||pt)&&(xe=Us(Fe,1,-st,1+st,0,-1,2,et)||[],Ve&&(xe=Ds(Ve,1).concat(xe)),pt&&(xe=xe.concat(Ds(pt,-1)))),xe}(Ae,ae)).length&&this.splitTile(Ae,0,0,0),me&&(Ae.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Va(Q,ae,me){return 32*((1<<Q)*me+ae)+Q}function Tu(Q,ae){var me=Q.tileID.canonical;if(!this._geoJSONIndex)return ae(null,null);var Ae=this._geoJSONIndex.getTile(me.z,me.x,me.y);if(!Ae)return ae(null,null);var Fe=new te(Ae.features),et=Se(Fe);et.byteOffset===0&&et.byteLength===et.buffer.byteLength||(et=new Uint8Array(et)),ae(null,{vectorTile:Fe,rawData:et.buffer})}qe.prototype.load=function(Q){var ae=this.options,me=ae.log,Ae=ae.minZoom,Fe=ae.maxZoom,et=ae.nodeSize;me&&console.time("total time");var st="prepare "+Q.length+" points";me&&console.time(st),this.points=Q;for(var xe=[],Ve=0;Ve<Q.length;Ve++)Q[Ve].geometry&&xe.push(We(Q[Ve],Ve));this.trees[Fe+1]=new Ne(xe,at,it,et,Float32Array),me&&console.timeEnd(st);for(var pt=Fe;pt>=Ae;pt--){var Ft=+Date.now();xe=this._cluster(xe,pt),this.trees[pt]=new Ne(xe,at,it,et,Float32Array),me&&console.log("z%d: %d clusters in %dms",pt,xe.length,+Date.now()-Ft)}return me&&console.timeEnd("total time"),this},qe.prototype.getClusters=function(Q,ae){var me=((Q[0]+180)%360+360)%360-180,Ae=Math.max(-90,Math.min(90,Q[1])),Fe=Q[2]===180?180:((Q[2]+180)%360+360)%360-180,et=Math.max(-90,Math.min(90,Q[3]));if(Q[2]-Q[0]>=360)me=-180,Fe=180;else if(me>Fe){var st=this.getClusters([me,Ae,180,et],ae),xe=this.getClusters([-180,Ae,Fe,et],ae);return st.concat(xe)}for(var Ve=this.trees[this._limitZoom(ae)],pt=[],Ft=0,Ht=Ve.range(fe(me),ye(et),fe(Fe),ye(Ae));Ft<Ht.length;Ft+=1){var Tt=Ve.points[Ht[Ft]];pt.push(Tt.numPoints?ht(Tt):this.points[Tt.index])}return pt},qe.prototype.getChildren=function(Q){var ae=this._getOriginId(Q),me=this._getOriginZoom(Q),Ae="No cluster with the specified id.",Fe=this.trees[me];if(!Fe)throw new Error(Ae);var et=Fe.points[ae];if(!et)throw new Error(Ae);for(var st=this.options.radius/(this.options.extent*Math.pow(2,me-1)),xe=[],Ve=0,pt=Fe.within(et.x,et.y,st);Ve<pt.length;Ve+=1){var Ft=Fe.points[pt[Ve]];Ft.parentId===Q&&xe.push(Ft.numPoints?ht(Ft):this.points[Ft.index])}if(xe.length===0)throw new Error(Ae);return xe},qe.prototype.getLeaves=function(Q,ae,me){var Ae=[];return this._appendLeaves(Ae,Q,ae=ae||10,me=me||0,0),Ae},qe.prototype.getTile=function(Q,ae,me){var Ae=this.trees[this._limitZoom(Q)],Fe=Math.pow(2,Q),et=this.options,st=et.radius/et.extent,xe=(me-st)/Fe,Ve=(me+1+st)/Fe,pt={features:[]};return this._addTileFeatures(Ae.range((ae-st)/Fe,xe,(ae+1+st)/Fe,Ve),Ae.points,ae,me,Fe,pt),ae===0&&this._addTileFeatures(Ae.range(1-st/Fe,xe,1,Ve),Ae.points,Fe,me,Fe,pt),ae===Fe-1&&this._addTileFeatures(Ae.range(0,xe,st/Fe,Ve),Ae.points,-1,me,Fe,pt),pt.features.length?pt:null},qe.prototype.getClusterExpansionZoom=function(Q){for(var ae=this._getOriginZoom(Q)-1;ae<=this.options.maxZoom;){var me=this.getChildren(Q);if(ae++,me.length!==1)break;Q=me[0].properties.cluster_id}return ae},qe.prototype._appendLeaves=function(Q,ae,me,Ae,Fe){for(var et=0,st=this.getChildren(ae);et<st.length;et+=1){var xe=st[et],Ve=xe.properties;if(Ve&&Ve.cluster?Fe+Ve.point_count<=Ae?Fe+=Ve.point_count:Fe=this._appendLeaves(Q,Ve.cluster_id,me,Ae,Fe):Fe<Ae?Fe++:Q.push(xe),Q.length===me)break}return Fe},qe.prototype._addTileFeatures=function(Q,ae,me,Ae,Fe,et){for(var st=0,xe=Q;st<xe.length;st+=1){var Ve=ae[xe[st]],pt=Ve.numPoints,Ft={type:1,geometry:[[Math.round(this.options.extent*(Ve.x*Fe-me)),Math.round(this.options.extent*(Ve.y*Fe-Ae))]],tags:pt?rt(Ve):this.points[Ve.index].properties},Ht=void 0;pt?Ht=Ve.id:this.options.generateId?Ht=Ve.index:this.points[Ve.index].id&&(Ht=this.points[Ve.index].id),Ht!==void 0&&(Ft.id=Ht),et.features.push(Ft)}},qe.prototype._limitZoom=function(Q){return Math.max(this.options.minZoom,Math.min(+Q,this.options.maxZoom+1))},qe.prototype._cluster=function(Q,ae){for(var me=[],Ae=this.options,Fe=Ae.reduce,et=Ae.minPoints,st=Ae.radius/(Ae.extent*Math.pow(2,ae)),xe=0;xe<Q.length;xe++){var Ve=Q[xe];if(!(Ve.zoom<=ae)){Ve.zoom=ae;for(var pt=this.trees[ae+1],Ft=pt.within(Ve.x,Ve.y,st),Ht=Ve.numPoints||1,Tt=Ht,Vt=0,xs=Ft;Vt<xs.length;Vt+=1){var ms=pt.points[xs[Vt]];ms.zoom>ae&&(Tt+=ms.numPoints||1)}if(Tt>=et){for(var At=Ve.x*Ht,fs=Ve.y*Ht,ns=Fe&&Ht>1?this._map(Ve,!0):null,is=(xe<<5)+(ae+1)+this.points.length,rn=0,hs=Ft;rn<hs.length;rn+=1){var mn=pt.points[hs[rn]];if(!(mn.zoom<=ae)){mn.zoom=ae;var Fn=mn.numPoints||1;At+=mn.x*Fn,fs+=mn.y*Fn,mn.parentId=is,Fe&&(ns||(ns=this._map(Ve,!0)),Fe(ns,this._map(mn)))}}Ve.parentId=is,me.push(ct(At/Tt,fs/Tt,is,Tt,ns))}else if(me.push(Ve),Tt>1)for(var hn=0,Sn=Ft;hn<Sn.length;hn+=1){var bn=pt.points[Sn[hn]];bn.zoom<=ae||(bn.zoom=ae,me.push(bn))}}}return me},qe.prototype._getOriginId=function(Q){return Q-this.points.length>>5},qe.prototype._getOriginZoom=function(Q){return(Q-this.points.length)%32},qe.prototype._map=function(Q,ae){if(Q.numPoints)return ae?Je({},Q.properties):Q.properties;var me=this.points[Q.index].properties,Ae=this.options.map(me);return ae&&Ae===me?Je({},Ae):Ae},Ua.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ua.prototype.splitTile=function(Q,ae,me,Ae,Fe,et,st){for(var xe=[Q,ae,me,Ae],Ve=this.options,pt=Ve.debug;xe.length;){Ae=xe.pop(),me=xe.pop(),ae=xe.pop(),Q=xe.pop();var Ft=1<<ae,Ht=Va(ae,me,Ae),Tt=this.tiles[Ht];if(!Tt&&(pt>1&&console.time("creation"),Tt=this.tiles[Ht]=Kn(Q,ae,me,Ae,Ve),this.tileCoords.push({z:ae,x:me,y:Ae}),pt)){pt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ae,me,Ae,Tt.numFeatures,Tt.numPoints,Tt.numSimplified),console.timeEnd("creation"));var Vt="z"+ae;this.stats[Vt]=(this.stats[Vt]||0)+1,this.total++}if(Tt.source=Q,Fe){if(ae===Ve.maxZoom||ae===Fe)continue;var xs=1<<Fe-ae;if(me!==Math.floor(et/xs)||Ae!==Math.floor(st/xs))continue}else if(ae===Ve.indexMaxZoom||Tt.numPoints<=Ve.indexMaxPoints)continue;if(Tt.source=null,Q.length!==0){pt>1&&console.time("clipping");var ms,At,fs,ns,is,rn,hs=.5*Ve.buffer/Ve.extent,mn=.5-hs,Fn=.5+hs,hn=1+hs;ms=At=fs=ns=null,is=Us(Q,Ft,me-hs,me+Fn,0,Tt.minX,Tt.maxX,Ve),rn=Us(Q,Ft,me+mn,me+hn,0,Tt.minX,Tt.maxX,Ve),Q=null,is&&(ms=Us(is,Ft,Ae-hs,Ae+Fn,1,Tt.minY,Tt.maxY,Ve),At=Us(is,Ft,Ae+mn,Ae+hn,1,Tt.minY,Tt.maxY,Ve),is=null),rn&&(fs=Us(rn,Ft,Ae-hs,Ae+Fn,1,Tt.minY,Tt.maxY,Ve),ns=Us(rn,Ft,Ae+mn,Ae+hn,1,Tt.minY,Tt.maxY,Ve),rn=null),pt>1&&console.timeEnd("clipping"),xe.push(ms||[],ae+1,2*me,2*Ae),xe.push(At||[],ae+1,2*me,2*Ae+1),xe.push(fs||[],ae+1,2*me+1,2*Ae),xe.push(ns||[],ae+1,2*me+1,2*Ae+1)}}},Ua.prototype.getTile=function(Q,ae,me){var Ae=this.options,Fe=Ae.extent,et=Ae.debug;if(Q<0||Q>24)return null;var st=1<<Q,xe=Va(Q,ae=(ae%st+st)%st,me);if(this.tiles[xe])return nn(this.tiles[xe],Fe);et>1&&console.log("drilling down to z%d-%d-%d",Q,ae,me);for(var Ve,pt=Q,Ft=ae,Ht=me;!Ve&&pt>0;)pt--,Ft=Math.floor(Ft/2),Ht=Math.floor(Ht/2),Ve=this.tiles[Va(pt,Ft,Ht)];return Ve&&Ve.source?(et>1&&console.log("found parent tile z%d-%d-%d",pt,Ft,Ht),et>1&&console.time("drilling down"),this.splitTile(Ve.source,pt,Ft,Ht,Q,ae,me),et>1&&console.timeEnd("drilling down"),this.tiles[xe]?nn(this.tiles[xe],Fe):null):null};var yd=function(Q){function ae(me,Ae,Fe,et){Q.call(this,me,Ae,Fe,Tu),et&&(this.loadGeoJSON=et)}return Q&&(ae.__proto__=Q),(ae.prototype=Object.create(Q&&Q.prototype)).constructor=ae,ae.prototype.loadData=function(me,Ae){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=Ae,this._pendingLoadDataParams=me,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},ae.prototype._loadData=function(){var me=this;if(this._pendingCallback&&this._pendingLoadDataParams){var Ae=this._pendingCallback,Fe=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var et=!!(Fe&&Fe.request&&Fe.request.collectResourceTiming)&&new o.RequestPerformance(Fe.request);this.loadGeoJSON(Fe,function(st,xe){if(st||!xe)return Ae(st);if(typeof xe!="object")return Ae(new Error("Input data given to '"+Fe.source+"' is not a valid GeoJSON object."));(function Tt(Vt,xs){var ms,At=Vt&&Vt.type;if(At==="FeatureCollection")for(ms=0;ms<Vt.features.length;ms++)Tt(Vt.features[ms],xs);else if(At==="GeometryCollection")for(ms=0;ms<Vt.geometries.length;ms++)Tt(Vt.geometries[ms],xs);else if(At==="Feature")Tt(Vt.geometry,xs);else if(At==="Polygon")ce(Vt.coordinates,xs);else if(At==="MultiPolygon")for(ms=0;ms<Vt.coordinates.length;ms++)ce(Vt.coordinates[ms],xs);return Vt})(xe,!0);try{if(Fe.filter){var Ve=o.createExpression(Fe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ve.result==="error")throw new Error(Ve.value.map(function(Tt){return Tt.key+": "+Tt.message}).join(", "));var pt=xe.features.filter(function(Tt){return Ve.value.evaluate({zoom:0},Tt)});xe={type:"FeatureCollection",features:pt}}me._geoJSONIndex=Fe.cluster?new qe(function(Tt){var Vt=Tt.superclusterOptions,xs=Tt.clusterProperties;if(!xs||!Vt)return Vt;for(var ms={},At={},fs={accumulated:null,zoom:0},ns={properties:null},is=Object.keys(xs),rn=0,hs=is;rn<hs.length;rn+=1){var mn=hs[rn],Fn=xs[mn],hn=Fn[0],Sn=o.createExpression(Fn[1]),bn=o.createExpression(typeof hn=="string"?[hn,["accumulated"],["get",mn]]:hn);ms[mn]=Sn.value,At[mn]=bn.value}return Vt.map=function(eo){ns.properties=eo;for(var zn={},Br=0,Hn=is;Br<Hn.length;Br+=1){var pn=Hn[Br];zn[pn]=ms[pn].evaluate(fs,ns)}return zn},Vt.reduce=function(eo,zn){ns.properties=zn;for(var Br=0,Hn=is;Br<Hn.length;Br+=1){var pn=Hn[Br];fs.accumulated=eo[pn],eo[pn]=At[pn].evaluate(fs,ns)}},Vt}(Fe)).load(xe.features):function(Tt,Vt){return new Ua(Tt,Vt)}(xe,Fe.geojsonVtOptions)}catch(Tt){return Ae(Tt)}me.loaded={};var Ft={};if(et){var Ht=et.finish();Ht&&(Ft.resourceTiming={},Ft.resourceTiming[Fe.source]=JSON.parse(JSON.stringify(Ht)))}Ae(null,Ft)})}},ae.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},ae.prototype.reloadTile=function(me,Ae){var Fe=this.loaded;return Fe&&Fe[me.uid]?Q.prototype.reloadTile.call(this,me,Ae):this.loadTile(me,Ae)},ae.prototype.loadGeoJSON=function(me,Ae){if(me.request)o.getJSON(me.request,Ae);else{if(typeof me.data!="string")return Ae(new Error("Input data given to '"+me.source+"' is not a valid GeoJSON object."));try{return Ae(null,JSON.parse(me.data))}catch{return Ae(new Error("Input data given to '"+me.source+"' is not a valid GeoJSON object."))}}},ae.prototype.removeSource=function(me,Ae){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Ae()},ae.prototype.getClusterExpansionZoom=function(me,Ae){try{Ae(null,this._geoJSONIndex.getClusterExpansionZoom(me.clusterId))}catch(Fe){Ae(Fe)}},ae.prototype.getClusterChildren=function(me,Ae){try{Ae(null,this._geoJSONIndex.getChildren(me.clusterId))}catch(Fe){Ae(Fe)}},ae.prototype.getClusterLeaves=function(me,Ae){try{Ae(null,this._geoJSONIndex.getLeaves(me.clusterId,me.limit,me.offset))}catch(Fe){Ae(Fe)}},ae}(A),qr=function(Q){var ae=this;this.self=Q,this.actor=new o.Actor(Q,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:A,geojson:yd},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(me,Ae){if(ae.workerSourceTypes[me])throw new Error('Worker source with name "'+me+'" already registered.');ae.workerSourceTypes[me]=Ae},this.self.registerRTLTextPlugin=function(me){if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=me.applyArabicShaping,o.plugin.processBidirectionalText=me.processBidirectionalText,o.plugin.processStyledBidirectionalText=me.processStyledBidirectionalText}};return qr.prototype.setReferrer=function(Q,ae){this.referrer=ae},qr.prototype.setImages=function(Q,ae,me){for(var Ae in this.availableImages[Q]=ae,this.workerSources[Q]){var Fe=this.workerSources[Q][Ae];for(var et in Fe)Fe[et].availableImages=ae}me()},qr.prototype.setLayers=function(Q,ae,me){this.getLayerIndex(Q).replace(ae),me()},qr.prototype.updateLayers=function(Q,ae,me){this.getLayerIndex(Q).update(ae.layers,ae.removedIds),me()},qr.prototype.loadTile=function(Q,ae,me){this.getWorkerSource(Q,ae.type,ae.source).loadTile(ae,me)},qr.prototype.loadDEMTile=function(Q,ae,me){this.getDEMWorkerSource(Q,ae.source).loadTile(ae,me)},qr.prototype.reloadTile=function(Q,ae,me){this.getWorkerSource(Q,ae.type,ae.source).reloadTile(ae,me)},qr.prototype.abortTile=function(Q,ae,me){this.getWorkerSource(Q,ae.type,ae.source).abortTile(ae,me)},qr.prototype.removeTile=function(Q,ae,me){this.getWorkerSource(Q,ae.type,ae.source).removeTile(ae,me)},qr.prototype.removeDEMTile=function(Q,ae){this.getDEMWorkerSource(Q,ae.source).removeTile(ae)},qr.prototype.removeSource=function(Q,ae,me){if(this.workerSources[Q]&&this.workerSources[Q][ae.type]&&this.workerSources[Q][ae.type][ae.source]){var Ae=this.workerSources[Q][ae.type][ae.source];delete this.workerSources[Q][ae.type][ae.source],Ae.removeSource!==void 0?Ae.removeSource(ae,me):me()}},qr.prototype.loadWorkerSource=function(Q,ae,me){try{this.self.importScripts(ae.url),me()}catch(Ae){me(Ae.toString())}},qr.prototype.syncRTLPluginState=function(Q,ae,me){try{o.plugin.setState(ae);var Ae=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&Ae!=null){this.self.importScripts(Ae);var Fe=o.plugin.isParsed();me(Fe?void 0:new Error("RTL Text Plugin failed to import scripts from "+Ae),Fe)}}catch(et){me(et.toString())}},qr.prototype.getAvailableImages=function(Q){var ae=this.availableImages[Q];return ae||(ae=[]),ae},qr.prototype.getLayerIndex=function(Q){var ae=this.layerIndexes[Q];return ae||(ae=this.layerIndexes[Q]=new y),ae},qr.prototype.getWorkerSource=function(Q,ae,me){var Ae=this;return this.workerSources[Q]||(this.workerSources[Q]={}),this.workerSources[Q][ae]||(this.workerSources[Q][ae]={}),this.workerSources[Q][ae][me]||(this.workerSources[Q][ae][me]=new this.workerSourceTypes[ae]({send:function(Fe,et,st){Ae.actor.send(Fe,et,st,Q)}},this.getLayerIndex(Q),this.getAvailableImages(Q))),this.workerSources[Q][ae][me]},qr.prototype.getDEMWorkerSource=function(Q,ae){return this.demWorkerSources[Q]||(this.demWorkerSources[Q]={}),this.demWorkerSources[Q][ae]||(this.demWorkerSources[Q][ae]=new q),this.demWorkerSources[Q][ae]},qr.prototype.enforceCacheSizeLimit=function(Q,ae){o.enforceCacheSizeLimit(ae)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new qr(self)),qr}),a(["./shared"],function(o){var d=o.createCommonjsModule(function(u){function f(S){return!h(S)}function h(S){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var R,N,H=new Blob([""],{type:"text/javascript"}),se=URL.createObjectURL(H);try{N=new Worker(se),R=!0}catch{R=!1}return N&&N.terminate(),URL.revokeObjectURL(se),R}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var R=document.createElement("canvas");R.width=R.height=1;var N=R.getContext("2d");if(!N)return!1;var H=N.getImageData(0,0,1,1);return H&&H.width===R.width}()?(g[M=S&&S.failIfMajorPerformanceCaveat]===void 0&&(g[M]=function(R){var N=function(se){var ge=document.createElement("canvas"),we=Object.create(f.webGLContextAttributes);return we.failIfMajorPerformanceCaveat=se,ge.probablySupportsContext?ge.probablySupportsContext("webgl",we)||ge.probablySupportsContext("experimental-webgl",we):ge.supportsContext?ge.supportsContext("webgl",we)||ge.supportsContext("experimental-webgl",we):ge.getContext("webgl",we)||ge.getContext("experimental-webgl",we)}(R);if(!N)return!1;var H=N.createShader(N.VERTEX_SHADER);return!(!H||N.isContextLost())&&(N.shaderSource(H,"void main() {}"),N.compileShader(H),N.getShaderParameter(H,N.COMPILE_STATUS)===!0)}(M)),g[M]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var M}u.exports?u.exports=f:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=f,window.mapboxgl.notSupportedReason=h);var g={};f.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),p={create:function(u,f,h){var g=o.window.document.createElement(u);return f!==void 0&&(g.className=f),h&&h.appendChild(g),g},createNS:function(u,f){return o.window.document.createElementNS(u,f)}},y=o.window.document&&o.window.document.documentElement.style;function v(u){if(!y)return u[0];for(var f=0;f<u.length;f++)if(u[f]in y)return u[f];return u[0]}var C,I=v(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);p.disableDrag=function(){y&&I&&(C=y[I],y[I]="none")},p.enableDrag=function(){y&&I&&(y[I]=C)};var O=v(["transform","WebkitTransform"]);p.setTransform=function(u,f){u.style[O]=f};var A=!1;try{var P=Object.defineProperty({},"passive",{get:function(){A=!0}});o.window.addEventListener("test",P,P),o.window.removeEventListener("test",P,P)}catch{A=!1}p.addEventListener=function(u,f,h,g){g===void 0&&(g={}),u.addEventListener(f,h,"passive"in g&&A?g:g.capture)},p.removeEventListener=function(u,f,h,g){g===void 0&&(g={}),u.removeEventListener(f,h,"passive"in g&&A?g:g.capture)};var q=function(u){u.preventDefault(),u.stopPropagation(),o.window.removeEventListener("click",q,!0)};function ce(u){var f=u.userImage;return!!(f&&f.render&&f.render())&&(u.data.replace(new Uint8Array(f.data.buffer)),!0)}p.suppressClick=function(){o.window.addEventListener("click",q,!0),o.window.setTimeout(function(){o.window.removeEventListener("click",q,!0)},0)},p.mousePos=function(u,f){var h=u.getBoundingClientRect();return new o.Point(f.clientX-h.left-u.clientLeft,f.clientY-h.top-u.clientTop)},p.touchPos=function(u,f){for(var h=u.getBoundingClientRect(),g=[],S=0;S<f.length;S++)g.push(new o.Point(f[S].clientX-h.left-u.clientLeft,f[S].clientY-h.top-u.clientTop));return g},p.mouseButton=function(u){return o.window.InstallTrigger!==void 0&&u.button===2&&u.ctrlKey&&o.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:u.button},p.remove=function(u){u.parentNode&&u.parentNode.removeChild(u)};var re=function(u){function f(){u.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.isLoaded=function(){return this.loaded},f.prototype.setLoaded=function(h){if(this.loaded!==h&&(this.loaded=h,h)){for(var g=0,S=this.requestors;g<S.length;g+=1){var M=S[g];this._notify(M.ids,M.callback)}this.requestors=[]}},f.prototype.getImage=function(h){return this.images[h]},f.prototype.addImage=function(h,g){this._validate(h,g)&&(this.images[h]=g)},f.prototype._validate=function(h,g){var S=!0;return this._validateStretch(g.stretchX,g.data&&g.data.width)||(this.fire(new o.ErrorEvent(new Error('Image "'+h+'" has invalid "stretchX" value'))),S=!1),this._validateStretch(g.stretchY,g.data&&g.data.height)||(this.fire(new o.ErrorEvent(new Error('Image "'+h+'" has invalid "stretchY" value'))),S=!1),this._validateContent(g.content,g)||(this.fire(new o.ErrorEvent(new Error('Image "'+h+'" has invalid "content" value'))),S=!1),S},f.prototype._validateStretch=function(h,g){if(!h)return!0;for(var S=0,M=0,R=h;M<R.length;M+=1){var N=R[M];if(N[0]<S||N[1]<N[0]||g<N[1])return!1;S=N[1]}return!0},f.prototype._validateContent=function(h,g){return!(h&&(h.length!==4||h[0]<0||g.data.width<h[0]||h[1]<0||g.data.height<h[1]||h[2]<0||g.data.width<h[2]||h[3]<0||g.data.height<h[3]||h[2]<h[0]||h[3]<h[1]))},f.prototype.updateImage=function(h,g){g.version=this.images[h].version+1,this.images[h]=g,this.updatedImages[h]=!0},f.prototype.removeImage=function(h){var g=this.images[h];delete this.images[h],delete this.patterns[h],g.userImage&&g.userImage.onRemove&&g.userImage.onRemove()},f.prototype.listImages=function(){return Object.keys(this.images)},f.prototype.getImages=function(h,g){var S=!0;if(!this.isLoaded())for(var M=0,R=h;M<R.length;M+=1)this.images[R[M]]||(S=!1);this.isLoaded()||S?this._notify(h,g):this.requestors.push({ids:h,callback:g})},f.prototype._notify=function(h,g){for(var S={},M=0,R=h;M<R.length;M+=1){var N=R[M];this.images[N]||this.fire(new o.Event("styleimagemissing",{id:N}));var H=this.images[N];H?S[N]={data:H.data.clone(),pixelRatio:H.pixelRatio,sdf:H.sdf,version:H.version,stretchX:H.stretchX,stretchY:H.stretchY,content:H.content,hasRenderCallback:Boolean(H.userImage&&H.userImage.render)}:o.warnOnce('Image "'+N+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}g(null,S)},f.prototype.getPixelSize=function(){var h=this.atlasImage;return{width:h.width,height:h.height}},f.prototype.getPattern=function(h){var g=this.patterns[h],S=this.getImage(h);if(!S)return null;if(g&&g.position.version===S.version)return g.position;if(g)g.position.version=S.version;else{var M={w:S.data.width+2,h:S.data.height+2,x:0,y:0},R=new o.ImagePosition(M,S);this.patterns[h]={bin:M,position:R}}return this._updatePatternAtlas(),this.patterns[h].position},f.prototype.bind=function(h){var g=h.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.Texture(h,this.atlasImage,g.RGBA),this.atlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE)},f.prototype._updatePatternAtlas=function(){var h=[];for(var g in this.patterns)h.push(this.patterns[g].bin);var S=o.potpack(h),M=S.w,R=S.h,N=this.atlasImage;for(var H in N.resize({width:M||1,height:R||1}),this.patterns){var se=this.patterns[H].bin,ge=se.x+1,we=se.y+1,Te=this.images[H].data,ze=Te.width,De=Te.height;o.RGBAImage.copy(Te,N,{x:0,y:0},{x:ge,y:we},{width:ze,height:De}),o.RGBAImage.copy(Te,N,{x:0,y:De-1},{x:ge,y:we-1},{width:ze,height:1}),o.RGBAImage.copy(Te,N,{x:0,y:0},{x:ge,y:we+De},{width:ze,height:1}),o.RGBAImage.copy(Te,N,{x:ze-1,y:0},{x:ge-1,y:we},{width:1,height:De}),o.RGBAImage.copy(Te,N,{x:0,y:0},{x:ge+ze,y:we},{width:1,height:De})}this.dirty=!0},f.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},f.prototype.dispatchRenderCallbacks=function(h){for(var g=0,S=h;g<S.length;g+=1){var M=S[g];if(!this.callbackDispatchedThisFrame[M]){this.callbackDispatchedThisFrame[M]=!0;var R=this.images[M];ce(R)&&this.updateImage(M,R)}}},f}(o.Evented),W=oe,Ce=oe,te=1e20;function oe(u,f,h,g,S,M){this.fontSize=u||24,this.buffer=f===void 0?3:f,this.cutoff=g||.25,this.fontFamily=S||"sans-serif",this.fontWeight=M||"normal",this.radius=h||8;var R=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=R,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(R*R),this.gridInner=new Float64Array(R*R),this.f=new Float64Array(R),this.d=new Float64Array(R),this.z=new Float64Array(R+1),this.v=new Int16Array(R),this.middle=Math.round(R/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function ve(u,f,h,g,S,M,R){for(var N=0;N<f;N++){for(var H=0;H<h;H++)g[H]=u[H*f+N];for(ee(g,S,M,R,h),H=0;H<h;H++)u[H*f+N]=S[H]}for(H=0;H<h;H++){for(N=0;N<f;N++)g[N]=u[H*f+N];for(ee(g,S,M,R,f),N=0;N<f;N++)u[H*f+N]=Math.sqrt(S[N])}}function ee(u,f,h,g,S){h[0]=0,g[0]=-te,g[1]=+te;for(var M=1,R=0;M<S;M++){for(var N=(u[M]+M*M-(u[h[R]]+h[R]*h[R]))/(2*M-2*h[R]);N<=g[R];)R--,N=(u[M]+M*M-(u[h[R]]+h[R]*h[R]))/(2*M-2*h[R]);h[++R]=M,g[R]=N,g[R+1]=+te}for(M=0,R=0;M<S;M++){for(;g[R+1]<M;)R++;f[M]=(M-h[R])*(M-h[R])+u[h[R]]}}oe.prototype.draw=function(u){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(u,this.buffer,this.middle);for(var f=this.ctx.getImageData(0,0,this.size,this.size),h=new Uint8ClampedArray(this.size*this.size),g=0;g<this.size*this.size;g++){var S=f.data[4*g+3]/255;this.gridOuter[g]=S===1?0:S===0?te:Math.pow(Math.max(0,.5-S),2),this.gridInner[g]=S===1?te:S===0?0:Math.pow(Math.max(0,S-.5),2)}for(ve(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),ve(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),g=0;g<this.size*this.size;g++)h[g]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[g]-this.gridInner[g])/this.radius+this.cutoff))));return h},W.default=Ce;var ne=function(u,f){this.requestManager=u,this.localIdeographFontFamily=f,this.entries={}};ne.prototype.setURL=function(u){this.url=u},ne.prototype.getGlyphs=function(u,f){var h=this,g=[];for(var S in u)for(var M=0,R=u[S];M<R.length;M+=1)g.push({stack:S,id:R[M]});o.asyncAll(g,function(N,H){var se=N.stack,ge=N.id,we=h.entries[se];we||(we=h.entries[se]={glyphs:{},requests:{},ranges:{}});var Te=we.glyphs[ge];if(Te===void 0){if(Te=h._tinySDF(we,se,ge))return we.glyphs[ge]=Te,void H(null,{stack:se,id:ge,glyph:Te});var ze=Math.floor(ge/256);if(256*ze>65535)H(new Error("glyphs > 65535 not supported"));else if(we.ranges[ze])H(null,{stack:se,id:ge,glyph:Te});else{var De=we.requests[ze];De||(De=we.requests[ze]=[],ne.loadGlyphRange(se,ze,h.url,h.requestManager,function(Ye,Le){if(Le){for(var Ze in Le)h._doesCharSupportLocalGlyph(+Ze)||(we.glyphs[+Ze]=Le[+Ze]);we.ranges[ze]=!0}for(var tt=0,ut=De;tt<ut.length;tt+=1)(0,ut[tt])(Ye,Le);delete we.requests[ze]})),De.push(function(Ye,Le){Ye?H(Ye):Le&&H(null,{stack:se,id:ge,glyph:Le[ge]||null})})}}else H(null,{stack:se,id:ge,glyph:Te})},function(N,H){if(N)f(N);else if(H){for(var se={},ge=0,we=H;ge<we.length;ge+=1){var Te=we[ge],ze=Te.stack,De=Te.id,Ye=Te.glyph;(se[ze]||(se[ze]={}))[De]=Ye&&{id:Ye.id,bitmap:Ye.bitmap.clone(),metrics:Ye.metrics}}f(null,se)}})},ne.prototype._doesCharSupportLocalGlyph=function(u){return!!this.localIdeographFontFamily&&(o.isChar["CJK Unified Ideographs"](u)||o.isChar["Hangul Syllables"](u)||o.isChar.Hiragana(u)||o.isChar.Katakana(u))},ne.prototype._tinySDF=function(u,f,h){var g=this.localIdeographFontFamily;if(g&&this._doesCharSupportLocalGlyph(h)){var S=u.tinySDF;if(!S){var M="400";/bold/i.test(f)?M="900":/medium/i.test(f)?M="500":/light/i.test(f)&&(M="200"),S=u.tinySDF=new ne.TinySDF(24,3,8,.25,g,M)}return{id:h,bitmap:new o.AlphaImage({width:30,height:30},S.draw(String.fromCharCode(h))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},ne.loadGlyphRange=function(u,f,h,g,S){var M=256*f,R=M+255,N=g.transformRequest(g.normalizeGlyphsURL(h).replace("{fontstack}",u).replace("{range}",M+"-"+R),o.ResourceType.Glyphs);o.getArrayBuffer(N,function(H,se){if(H)S(H);else if(se){for(var ge={},we=0,Te=o.parseGlyphPBF(se);we<Te.length;we+=1){var ze=Te[we];ge[ze.id]=ze}S(null,ge)}})},ne.TinySDF=W;var Se=function(){this.specification=o.styleSpec.light.position};Se.prototype.possiblyEvaluate=function(u,f){return o.sphericalToCartesian(u.expression.evaluate(f))},Se.prototype.interpolate=function(u,f,h){return{x:o.number(u.x,f.x,h),y:o.number(u.y,f.y,h),z:o.number(u.z,f.z,h)}};var Ue=new o.Properties({anchor:new o.DataConstantProperty(o.styleSpec.light.anchor),position:new Se,color:new o.DataConstantProperty(o.styleSpec.light.color),intensity:new o.DataConstantProperty(o.styleSpec.light.intensity)}),Qe=function(u){function f(h){u.call(this),this._transitionable=new o.Transitionable(Ue),this.setLight(h),this._transitioning=this._transitionable.untransitioned()}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getLight=function(){return this._transitionable.serialize()},f.prototype.setLight=function(h,g){if(g===void 0&&(g={}),!this._validate(o.validateLight,h,g))for(var S in h){var M=h[S];o.endsWith(S,"-transition")?this._transitionable.setTransition(S.slice(0,-11),M):this._transitionable.setValue(S,M)}},f.prototype.updateTransitions=function(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)},f.prototype.hasTransition=function(){return this._transitioning.hasTransition()},f.prototype.recalculate=function(h){this.properties=this._transitioning.possiblyEvaluate(h)},f.prototype._validate=function(h,g,S){return(!S||S.validate!==!1)&&o.emitValidationErrors(this,h.call(o.validateStyle,o.extend({value:g,style:{glyphs:!0,sprite:!0},styleSpec:o.styleSpec})))},f}(o.Evented),Me=function(u,f){this.width=u,this.height=f,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Me.prototype.getDash=function(u,f){var h=u.join(",")+String(f);return this.dashEntry[h]||(this.dashEntry[h]=this.addDash(u,f)),this.dashEntry[h]},Me.prototype.getDashRanges=function(u,f,h){var g=[],S=u.length%2==1?-u[u.length-1]*h:0,M=u[0]*h,R=!0;g.push({left:S,right:M,isDash:R,zeroLength:u[0]===0});for(var N=u[0],H=1;H<u.length;H++){var se=u[H];g.push({left:S=N*h,right:M=(N+=se)*h,isDash:R=!R,zeroLength:se===0})}return g},Me.prototype.addRoundDash=function(u,f,h){for(var g=f/2,S=-h;S<=h;S++)for(var M=this.width*(this.nextRow+h+S),R=0,N=u[R],H=0;H<this.width;H++){H/N.right>1&&(N=u[++R]);var se=Math.abs(H-N.left),ge=Math.abs(H-N.right),we=Math.min(se,ge),Te=void 0,ze=S/h*(g+1);if(N.isDash){var De=g-Math.abs(ze);Te=Math.sqrt(we*we+De*De)}else Te=g-Math.sqrt(we*we+ze*ze);this.data[M+H]=Math.max(0,Math.min(255,Te+128))}},Me.prototype.addRegularDash=function(u){for(var f=u.length-1;f>=0;--f){var h=u[f],g=u[f+1];h.zeroLength?u.splice(f,1):g&&g.isDash===h.isDash&&(g.left=h.left,u.splice(f,1))}var S=u[0],M=u[u.length-1];S.isDash===M.isDash&&(S.left=M.left-this.width,M.right=S.right+this.width);for(var R=this.width*this.nextRow,N=0,H=u[N],se=0;se<this.width;se++){se/H.right>1&&(H=u[++N]);var ge=Math.abs(se-H.left),we=Math.abs(se-H.right),Te=Math.min(ge,we);this.data[R+se]=Math.max(0,Math.min(255,(H.isDash?Te:-Te)+128))}},Me.prototype.addDash=function(u,f){var h=f?7:0,g=2*h+1;if(this.nextRow+g>this.height)return o.warnOnce("LineAtlas out of space"),null;for(var S=0,M=0;M<u.length;M++)S+=u[M];if(S!==0){var R=this.width/S,N=this.getDashRanges(u,this.width,R);f?this.addRoundDash(N,R,h):this.addRegularDash(N)}var H={y:(this.nextRow+h+.5)/this.height,height:2*h/this.height,width:S};return this.nextRow+=g,this.dirty=!0,H},Me.prototype.bind=function(u){var f=u.gl;this.texture?(f.bindTexture(f.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,f.texSubImage2D(f.TEXTURE_2D,0,0,0,this.width,this.height,f.ALPHA,f.UNSIGNED_BYTE,this.data))):(this.texture=f.createTexture(),f.bindTexture(f.TEXTURE_2D,this.texture),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texImage2D(f.TEXTURE_2D,0,f.ALPHA,this.width,this.height,0,f.ALPHA,f.UNSIGNED_BYTE,this.data))};var vt=function u(f,h){this.workerPool=f,this.actors=[],this.currentActor=0,this.id=o.uniqueId();for(var g=this.workerPool.acquire(this.id),S=0;S<g.length;S++){var M=new u.Actor(g[S],h,this.id);M.name="Worker "+S,this.actors.push(M)}};function Ut(u,f,h){var g=function(S,M){if(S)return h(S);if(M){var R=o.pick(o.extend(M,u),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);M.vector_layers&&(R.vectorLayers=M.vector_layers,R.vectorLayerIds=R.vectorLayers.map(function(N){return N.id})),R.tiles=f.canonicalizeTileset(R,u.url),h(null,R)}};return u.url?o.getJSON(f.transformRequest(f.normalizeSourceURL(u.url),o.ResourceType.Source),g):o.browser.frame(function(){return g(null,u)})}vt.prototype.broadcast=function(u,f,h){o.asyncAll(this.actors,function(g,S){g.send(u,f,S)},h=h||function(){})},vt.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},vt.prototype.remove=function(){this.actors.forEach(function(u){u.remove()}),this.actors=[],this.workerPool.release(this.id)},vt.Actor=o.Actor;var Rt=function(u,f,h){this.bounds=o.LngLatBounds.convert(this.validateBounds(u)),this.minzoom=f||0,this.maxzoom=h||24};Rt.prototype.validateBounds=function(u){return Array.isArray(u)&&u.length===4?[Math.max(-180,u[0]),Math.max(-90,u[1]),Math.min(180,u[2]),Math.min(90,u[3])]:[-180,-90,180,90]},Rt.prototype.contains=function(u){var f=Math.pow(2,u.z),h=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*f),g=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*f),S=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*f),M=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*f);return u.x>=h&&u.x<S&&u.y>=g&&u.y<M};var _t=function(u){function f(h,g,S,M){if(u.call(this),this.id=h,this.dispatcher=S,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(g,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},g),this._collectResourceTiming=g.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(M)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.load=function(){var h=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ut(this._options,this.map._requestManager,function(g,S){h._tileJSONRequest=null,h._loaded=!0,g?h.fire(new o.ErrorEvent(g)):S&&(o.extend(h,S),S.bounds&&(h.tileBounds=new Rt(S.bounds,h.minzoom,h.maxzoom)),o.postTurnstileEvent(S.tiles,h.map._requestManager._customAccessToken),o.postMapLoadEvent(S.tiles,h.map._getMapId(),h.map._requestManager._skuToken,h.map._requestManager._customAccessToken),h.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),h.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})},f.prototype.loaded=function(){return this._loaded},f.prototype.hasTile=function(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)},f.prototype.onAdd=function(h){this.map=h,this.load()},f.prototype.setSourceProperty=function(h){this._tileJSONRequest&&this._tileJSONRequest.cancel(),h(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},f.prototype.setTiles=function(h){var g=this;return this.setSourceProperty(function(){g._options.tiles=h}),this},f.prototype.setUrl=function(h){var g=this;return this.setSourceProperty(function(){g.url=h,g._options.url=h}),this},f.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},f.prototype.serialize=function(){return o.extend({},this._options)},f.prototype.loadTile=function(h,g){var S=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme)),M={request:this.map._requestManager.transformRequest(S,o.ResourceType.Tile),uid:h.uid,tileID:h.tileID,zoom:h.tileID.overscaledZ,tileSize:this.tileSize*h.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:o.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function R(N,H){return delete h.request,h.aborted?g(null):N&&N.status!==404?g(N):(H&&H.resourceTiming&&(h.resourceTiming=H.resourceTiming),this.map._refreshExpiredTiles&&H&&h.setExpiryData(H),h.loadVectorData(H,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),g(null),void(h.reloadCallback&&(this.loadTile(h,h.reloadCallback),h.reloadCallback=null)))}M.request.collectResourceTiming=this._collectResourceTiming,h.actor&&h.state!=="expired"?h.state==="loading"?h.reloadCallback=g:h.request=h.actor.send("reloadTile",M,R.bind(this)):(h.actor=this.dispatcher.getActor(),h.request=h.actor.send("loadTile",M,R.bind(this)))},f.prototype.abortTile=function(h){h.request&&(h.request.cancel(),delete h.request),h.actor&&h.actor.send("abortTile",{uid:h.uid,type:this.type,source:this.id},void 0)},f.prototype.unloadTile=function(h){h.unloadVectorData(),h.actor&&h.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id},void 0)},f.prototype.hasTransition=function(){return!1},f}(o.Evented),F=function(u){function f(h,g,S,M){u.call(this),this.id=h,this.dispatcher=S,this.setEventedParent(M),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},g),o.extend(this,o.pick(g,["url","scheme","tileSize"]))}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.load=function(){var h=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ut(this._options,this.map._requestManager,function(g,S){h._tileJSONRequest=null,h._loaded=!0,g?h.fire(new o.ErrorEvent(g)):S&&(o.extend(h,S),S.bounds&&(h.tileBounds=new Rt(S.bounds,h.minzoom,h.maxzoom)),o.postTurnstileEvent(S.tiles),o.postMapLoadEvent(S.tiles,h.map._getMapId(),h.map._requestManager._skuToken),h.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),h.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})},f.prototype.loaded=function(){return this._loaded},f.prototype.onAdd=function(h){this.map=h,this.load()},f.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},f.prototype.serialize=function(){return o.extend({},this._options)},f.prototype.hasTile=function(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)},f.prototype.loadTile=function(h,g){var S=this,M=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);h.request=o.getImage(this.map._requestManager.transformRequest(M,o.ResourceType.Tile),function(R,N){if(delete h.request,h.aborted)h.state="unloaded",g(null);else if(R)h.state="errored",g(R);else if(N){S.map._refreshExpiredTiles&&h.setExpiryData(N),delete N.cacheControl,delete N.expires;var H=S.map.painter.context,se=H.gl;h.texture=S.map.painter.getTileTexture(N.width),h.texture?h.texture.update(N,{useMipmap:!0}):(h.texture=new o.Texture(H,N,se.RGBA,{useMipmap:!0}),h.texture.bind(se.LINEAR,se.CLAMP_TO_EDGE,se.LINEAR_MIPMAP_NEAREST),H.extTextureFilterAnisotropic&&se.texParameterf(se.TEXTURE_2D,H.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,H.extTextureFilterAnisotropicMax)),h.state="loaded",o.cacheEntryPossiblyAdded(S.dispatcher),g(null)}})},f.prototype.abortTile=function(h,g){h.request&&(h.request.cancel(),delete h.request),g()},f.prototype.unloadTile=function(h,g){h.texture&&this.map.painter.saveTileTexture(h.texture),g()},f.prototype.hasTransition=function(){return!1},f}(o.Evented),j=function(u){function f(h,g,S,M){u.call(this,h,g,S,M),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},g),this.encoding=g.encoding||"mapbox"}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},f.prototype.loadTile=function(h,g){var S=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function M(R,N){R&&(h.state="errored",g(R)),N&&(h.dem=N,h.needsHillshadePrepare=!0,h.state="loaded",g(null))}h.request=o.getImage(this.map._requestManager.transformRequest(S,o.ResourceType.Tile),function(R,N){if(delete h.request,h.aborted)h.state="unloaded",g(null);else if(R)h.state="errored",g(R);else if(N){this.map._refreshExpiredTiles&&h.setExpiryData(N),delete N.cacheControl,delete N.expires;var H=o.window.ImageBitmap&&N instanceof o.window.ImageBitmap&&o.offscreenCanvasSupported()?N:o.browser.getImageData(N,1),se={uid:h.uid,coord:h.tileID,source:this.id,rawImageData:H,encoding:this.encoding};h.actor&&h.state!=="expired"||(h.actor=this.dispatcher.getActor(),h.actor.send("loadDEMTile",se,M.bind(this)))}}.bind(this)),h.neighboringTiles=this._getNeighboringTiles(h.tileID)},f.prototype._getNeighboringTiles=function(h){var g=h.canonical,S=Math.pow(2,g.z),M=(g.x-1+S)%S,R=g.x===0?h.wrap-1:h.wrap,N=(g.x+1+S)%S,H=g.x+1===S?h.wrap+1:h.wrap,se={};return se[new o.OverscaledTileID(h.overscaledZ,R,g.z,M,g.y).key]={backfilled:!1},se[new o.OverscaledTileID(h.overscaledZ,H,g.z,N,g.y).key]={backfilled:!1},g.y>0&&(se[new o.OverscaledTileID(h.overscaledZ,R,g.z,M,g.y-1).key]={backfilled:!1},se[new o.OverscaledTileID(h.overscaledZ,h.wrap,g.z,g.x,g.y-1).key]={backfilled:!1},se[new o.OverscaledTileID(h.overscaledZ,H,g.z,N,g.y-1).key]={backfilled:!1}),g.y+1<S&&(se[new o.OverscaledTileID(h.overscaledZ,R,g.z,M,g.y+1).key]={backfilled:!1},se[new o.OverscaledTileID(h.overscaledZ,h.wrap,g.z,g.x,g.y+1).key]={backfilled:!1},se[new o.OverscaledTileID(h.overscaledZ,H,g.z,N,g.y+1).key]={backfilled:!1}),se},f.prototype.unloadTile=function(h){h.demTexture&&this.map.painter.saveTileTexture(h.demTexture),h.fbo&&(h.fbo.destroy(),delete h.fbo),h.dem&&delete h.dem,delete h.neighboringTiles,h.state="unloaded",h.actor&&h.actor.send("removeDEMTile",{uid:h.uid,source:this.id})},f}(F),G=function(u){function f(h,g,S,M){u.call(this),this.id=h,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=S.getActor(),this.setEventedParent(M),this._data=g.data,this._options=o.extend({},g),this._collectResourceTiming=g.collectResourceTiming,this._resourceTiming=[],g.maxzoom!==void 0&&(this.maxzoom=g.maxzoom),g.type&&(this.type=g.type),g.attribution&&(this.attribution=g.attribution),this.promoteId=g.promoteId;var R=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:g.cluster||!1,geojsonVtOptions:{buffer:(g.buffer!==void 0?g.buffer:128)*R,tolerance:(g.tolerance!==void 0?g.tolerance:.375)*R,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:g.lineMetrics||!1,generateId:g.generateId||!1},superclusterOptions:{maxZoom:g.clusterMaxZoom!==void 0?Math.min(g.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,g.clusterMinPoints||2),extent:o.EXTENT,radius:(g.clusterRadius||50)*R,log:!1,generateId:g.generateId||!1},clusterProperties:g.clusterProperties,filter:g.filter},g.workerOptions)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.load=function(){var h=this;this.fire(new o.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(g){if(g)h.fire(new o.ErrorEvent(g));else{var S={dataType:"source",sourceDataType:"metadata"};h._collectResourceTiming&&h._resourceTiming&&h._resourceTiming.length>0&&(S.resourceTiming=h._resourceTiming,h._resourceTiming=[]),h.fire(new o.Event("data",S))}})},f.prototype.onAdd=function(h){this.map=h,this.load()},f.prototype.setData=function(h){var g=this;return this._data=h,this.fire(new o.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(S){if(S)g.fire(new o.ErrorEvent(S));else{var M={dataType:"source",sourceDataType:"content"};g._collectResourceTiming&&g._resourceTiming&&g._resourceTiming.length>0&&(M.resourceTiming=g._resourceTiming,g._resourceTiming=[]),g.fire(new o.Event("data",M))}}),this},f.prototype.getClusterExpansionZoom=function(h,g){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:h,source:this.id},g),this},f.prototype.getClusterChildren=function(h,g){return this.actor.send("geojson.getClusterChildren",{clusterId:h,source:this.id},g),this},f.prototype.getClusterLeaves=function(h,g,S,M){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:h,limit:g,offset:S},M),this},f.prototype._updateWorkerData=function(h){var g=this;this._loaded=!1;var S=o.extend({},this.workerOptions),M=this._data;typeof M=="string"?(S.request=this.map._requestManager.transformRequest(o.browser.resolveURL(M),o.ResourceType.Source),S.request.collectResourceTiming=this._collectResourceTiming):S.data=JSON.stringify(M),this.actor.send(this.type+".loadData",S,function(R,N){g._removed||N&&N.abandoned||(g._loaded=!0,N&&N.resourceTiming&&N.resourceTiming[g.id]&&(g._resourceTiming=N.resourceTiming[g.id].slice(0)),g.actor.send(g.type+".coalesce",{source:S.source},null),h(R))})},f.prototype.loaded=function(){return this._loaded},f.prototype.loadTile=function(h,g){var S=this,M=h.actor?"reloadTile":"loadTile";h.actor=this.actor,h.request=this.actor.send(M,{type:this.type,uid:h.uid,tileID:h.tileID,zoom:h.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:o.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(R,N){return delete h.request,h.unloadVectorData(),h.aborted?g(null):R?g(R):(h.loadVectorData(N,S.map.painter,M==="reloadTile"),g(null))})},f.prototype.abortTile=function(h){h.request&&(h.request.cancel(),delete h.request),h.aborted=!0},f.prototype.unloadTile=function(h){h.unloadVectorData(),this.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})},f.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},f.prototype.serialize=function(){return o.extend({},this._options,{type:this.type,data:this._data})},f.prototype.hasTransition=function(){return!1},f}(o.Evented),Y=o.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),J=function(u){function f(h,g,S,M){u.call(this),this.id=h,this.dispatcher=S,this.coordinates=g.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(M),this.options=g}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.load=function(h,g){var S=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),function(M,R){S._loaded=!0,M?S.fire(new o.ErrorEvent(M)):R&&(S.image=R,h&&(S.coordinates=h),g&&g(),S._finishLoading())})},f.prototype.loaded=function(){return this._loaded},f.prototype.updateImage=function(h){var g=this;return this.image&&h.url?(this.options.url=h.url,this.load(h.coordinates,function(){g.texture=null}),this):this},f.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))},f.prototype.onAdd=function(h){this.map=h,this.load()},f.prototype.setCoordinates=function(h){var g=this;this.coordinates=h;var S=h.map(o.MercatorCoordinate.fromLngLat);this.tileID=function(R){for(var N=1/0,H=1/0,se=-1/0,ge=-1/0,we=0,Te=R;we<Te.length;we+=1){var ze=Te[we];N=Math.min(N,ze.x),H=Math.min(H,ze.y),se=Math.max(se,ze.x),ge=Math.max(ge,ze.y)}var De=Math.max(se-N,ge-H),Ye=Math.max(0,Math.floor(-Math.log(De)/Math.LN2)),Le=Math.pow(2,Ye);return new o.CanonicalTileID(Ye,Math.floor((N+se)/2*Le),Math.floor((H+ge)/2*Le))}(S),this.minzoom=this.maxzoom=this.tileID.z;var M=S.map(function(R){return g.tileID.getTilePoint(R)._round()});return this._boundsArray=new o.StructArrayLayout4i8,this._boundsArray.emplaceBack(M[0].x,M[0].y,0,0),this._boundsArray.emplaceBack(M[1].x,M[1].y,o.EXTENT,0),this._boundsArray.emplaceBack(M[3].x,M[3].y,0,o.EXTENT),this._boundsArray.emplaceBack(M[2].x,M[2].y,o.EXTENT,o.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this},f.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var h=this.map.painter.context,g=h.gl;for(var S in this.boundsBuffer||(this.boundsBuffer=h.createVertexBuffer(this._boundsArray,Y.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new o.Texture(h,this.image,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE)),this.tiles){var M=this.tiles[S];M.state!=="loaded"&&(M.state="loaded",M.texture=this.texture)}}},f.prototype.loadTile=function(h,g){this.tileID&&this.tileID.equals(h.tileID.canonical)?(this.tiles[String(h.tileID.wrap)]=h,h.buckets={},g(null)):(h.state="errored",g(null))},f.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},f.prototype.hasTransition=function(){return!1},f}(o.Evented),he=function(u){function f(h,g,S,M){u.call(this,h,g,S,M),this.roundZoom=!0,this.type="video",this.options=g}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.load=function(){var h=this;this._loaded=!1;var g=this.options;this.urls=[];for(var S=0,M=g.urls;S<M.length;S+=1)this.urls.push(this.map._requestManager.transformRequest(M[S],o.ResourceType.Source).url);o.getVideo(this.urls,function(R,N){h._loaded=!0,R?h.fire(new o.ErrorEvent(R)):N&&(h.video=N,h.video.loop=!0,h.video.setAttribute("playsinline",""),h.video.addEventListener("playing",function(){h.map.triggerRepaint()}),h.map&&h.video.play(),h._finishLoading())})},f.prototype.pause=function(){this.video&&this.video.pause()},f.prototype.play=function(){this.video&&this.video.play()},f.prototype.seek=function(h){if(this.video){var g=this.video.seekable;h<g.start(0)||h>g.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+g.start(0)+" and "+g.end(0)+"-second mark."))):this.video.currentTime=h}},f.prototype.getVideo=function(){return this.video},f.prototype.onAdd=function(h){this.map||(this.map=h,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},f.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var h=this.map.painter.context,g=h.gl;for(var S in this.boundsBuffer||(this.boundsBuffer=h.createVertexBuffer(this._boundsArray,Y.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE),g.texSubImage2D(g.TEXTURE_2D,0,0,0,g.RGBA,g.UNSIGNED_BYTE,this.video)):(this.texture=new o.Texture(h,this.video,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE)),this.tiles){var M=this.tiles[S];M.state!=="loaded"&&(M.state="loaded",M.texture=this.texture)}}},f.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},f.prototype.hasTransition=function(){return this.video&&!this.video.paused},f}(J),be=function(u){function f(h,g,S,M){u.call(this,h,g,S,M),g.coordinates?Array.isArray(g.coordinates)&&g.coordinates.length===4&&!g.coordinates.some(function(R){return!Array.isArray(R)||R.length!==2||R.some(function(N){return typeof N!="number"})})||this.fire(new o.ErrorEvent(new o.ValidationError("sources."+h,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError("sources."+h,null,'missing required property "coordinates"'))),g.animate&&typeof g.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError("sources."+h,null,'optional "animate" property must be a boolean value'))),g.canvas?typeof g.canvas=="string"||g.canvas instanceof o.window.HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError("sources."+h,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError("sources."+h,null,'missing required property "canvas"'))),this.options=g,this.animate=g.animate===void 0||g.animate}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof o.window.HTMLCanvasElement?this.options.canvas:o.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},f.prototype.getCanvas=function(){return this.canvas},f.prototype.onAdd=function(h){this.map=h,this.load(),this.canvas&&this.animate&&this.play()},f.prototype.onRemove=function(){this.pause()},f.prototype.prepare=function(){var h=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,h=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,h=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var g=this.map.painter.context,S=g.gl;for(var M in this.boundsBuffer||(this.boundsBuffer=g.createVertexBuffer(this._boundsArray,Y.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(h||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.Texture(g,this.canvas,S.RGBA,{premultiply:!0}),this.tiles){var R=this.tiles[M];R.state!=="loaded"&&(R.state="loaded",R.texture=this.texture)}}},f.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},f.prototype.hasTransition=function(){return this._playing},f.prototype._hasInvalidDimensions=function(){for(var h=0,g=[this.canvas.width,this.canvas.height];h<g.length;h+=1){var S=g[h];if(isNaN(S)||S<=0)return!0}return!1},f}(J),Ne={vector:_t,raster:F,"raster-dem":j,geojson:G,video:he,image:J,canvas:be};function ke(u,f){var h=o.identity([]);return o.translate(h,h,[1,1,0]),o.scale(h,h,[.5*u.width,.5*u.height,1]),o.multiply(h,h,u.calculatePosMatrix(f.toUnwrapped()))}function qe(u,f,h,g,S,M){var R=function(Ye,Le,Ze){if(Ye)for(var tt=0,ut=Ye;tt<ut.length;tt+=1){var wt=Le[ut[tt]];if(wt&&wt.source===Ze&&wt.type==="fill-extrusion")return!0}else for(var bt in Le){var It=Le[bt];if(It.source===Ze&&It.type==="fill-extrusion")return!0}return!1}(S&&S.layers,f,u.id),N=M.maxPitchScaleFactor(),H=u.tilesIn(g,N,R);H.sort(ct);for(var se=[],ge=0,we=H;ge<we.length;ge+=1){var Te=we[ge];se.push({wrappedTileID:Te.tileID.wrapped().key,queryResults:Te.tile.queryRenderedFeatures(f,h,u._state,Te.queryGeometry,Te.cameraQueryGeometry,Te.scale,S,M,N,ke(u.transform,Te.tileID))})}var ze=function(Ye){for(var Le={},Ze={},tt=0,ut=Ye;tt<ut.length;tt+=1){var wt=ut[tt],bt=wt.queryResults,It=wt.wrappedTileID,Dt=Ze[It]=Ze[It]||{};for(var Gt in bt)for(var Xt=bt[Gt],as=Dt[Gt]=Dt[Gt]||{},vs=Le[Gt]=Le[Gt]||[],$s=0,ks=Xt;$s<ks.length;$s+=1){var xn=ks[$s];as[xn.featureIndex]||(as[xn.featureIndex]=!0,vs.push(xn))}}return Le}(se);for(var De in ze)ze[De].forEach(function(Ye){var Le=Ye.feature,Ze=u.getFeatureState(Le.layer["source-layer"],Le.id);Le.source=Le.layer.source,Le.layer["source-layer"]&&(Le.sourceLayer=Le.layer["source-layer"]),Le.state=Ze});return ze}function ct(u,f){var h=u.tileID,g=f.tileID;return h.overscaledZ-g.overscaledZ||h.canonical.y-g.canonical.y||h.wrap-g.wrap||h.canonical.x-g.canonical.x}var We=function(u,f){this.max=u,this.onRemove=f,this.reset()};We.prototype.reset=function(){for(var u in this.data)for(var f=0,h=this.data[u];f<h.length;f+=1){var g=h[f];g.timeout&&clearTimeout(g.timeout),this.onRemove(g.value)}return this.data={},this.order=[],this},We.prototype.add=function(u,f,h){var g=this,S=u.wrapped().key;this.data[S]===void 0&&(this.data[S]=[]);var M={value:f,timeout:void 0};if(h!==void 0&&(M.timeout=setTimeout(function(){g.remove(u,M)},h)),this.data[S].push(M),this.order.push(S),this.order.length>this.max){var R=this._getAndRemoveByKey(this.order[0]);R&&this.onRemove(R)}return this},We.prototype.has=function(u){return u.wrapped().key in this.data},We.prototype.getAndRemove=function(u){return this.has(u)?this._getAndRemoveByKey(u.wrapped().key):null},We.prototype._getAndRemoveByKey=function(u){var f=this.data[u].shift();return f.timeout&&clearTimeout(f.timeout),this.data[u].length===0&&delete this.data[u],this.order.splice(this.order.indexOf(u),1),f.value},We.prototype.getByKey=function(u){var f=this.data[u];return f?f[0].value:null},We.prototype.get=function(u){return this.has(u)?this.data[u.wrapped().key][0].value:null},We.prototype.remove=function(u,f){if(!this.has(u))return this;var h=u.wrapped().key,g=f===void 0?0:this.data[h].indexOf(f),S=this.data[h][g];return this.data[h].splice(g,1),S.timeout&&clearTimeout(S.timeout),this.data[h].length===0&&delete this.data[h],this.onRemove(S.value),this.order.splice(this.order.indexOf(h),1),this},We.prototype.setMaxSize=function(u){for(this.max=u;this.order.length>this.max;){var f=this._getAndRemoveByKey(this.order[0]);f&&this.onRemove(f)}return this},We.prototype.filter=function(u){var f=[];for(var h in this.data)for(var g=0,S=this.data[h];g<S.length;g+=1){var M=S[g];u(M.value)||f.push(M)}for(var R=0,N=f;R<N.length;R+=1){var H=N[R];this.remove(H.value.tileID,H)}};var ht=function(u,f,h){this.context=u;var g=u.gl;this.buffer=g.createBuffer(),this.dynamicDraw=Boolean(h),this.context.unbindVAO(),u.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete f.arrayBuffer};ht.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},ht.prototype.updateData=function(u){var f=this.context.gl;this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,u.arrayBuffer)},ht.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var rt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},fe=function(u,f,h,g){this.length=f.length,this.attributes=h,this.itemSize=f.bytesPerElement,this.dynamicDraw=g,this.context=u;var S=u.gl;this.buffer=S.createBuffer(),u.bindVertexBuffer.set(this.buffer),S.bufferData(S.ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||delete f.arrayBuffer};fe.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},fe.prototype.updateData=function(u){var f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,u.arrayBuffer)},fe.prototype.enableAttributes=function(u,f){for(var h=0;h<this.attributes.length;h++){var g=f.attributes[this.attributes[h].name];g!==void 0&&u.enableVertexAttribArray(g)}},fe.prototype.setVertexAttribPointers=function(u,f,h){for(var g=0;g<this.attributes.length;g++){var S=this.attributes[g],M=f.attributes[S.name];M!==void 0&&u.vertexAttribPointer(M,S.components,u[rt[S.type]],!1,this.itemSize,S.offset+this.itemSize*(h||0))}},fe.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var ye=function(u){this.gl=u.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};ye.prototype.get=function(){return this.current},ye.prototype.set=function(u){},ye.prototype.getDefault=function(){return this.default},ye.prototype.setDefault=function(){this.set(this.default)};var Je=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return o.Color.transparent},f.prototype.set=function(h){var g=this.current;(h.r!==g.r||h.g!==g.g||h.b!==g.b||h.a!==g.a||this.dirty)&&(this.gl.clearColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)},f}(ye),at=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return 1},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.clearDepth(h),this.current=h,this.dirty=!1)},f}(ye),it=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return 0},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.clearStencil(h),this.current=h,this.dirty=!1)},f}(ye),Et=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return[!0,!0,!0,!0]},f.prototype.set=function(h){var g=this.current;(h[0]!==g[0]||h[1]!==g[1]||h[2]!==g[2]||h[3]!==g[3]||this.dirty)&&(this.gl.colorMask(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)},f}(ye),jt=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return!0},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.depthMask(h),this.current=h,this.dirty=!1)},f}(ye),Nt=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return 255},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.stencilMask(h),this.current=h,this.dirty=!1)},f}(ye),St=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},f.prototype.set=function(h){var g=this.current;(h.func!==g.func||h.ref!==g.ref||h.mask!==g.mask||this.dirty)&&(this.gl.stencilFunc(h.func,h.ref,h.mask),this.current=h,this.dirty=!1)},f}(ye),Ct=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){var h=this.gl;return[h.KEEP,h.KEEP,h.KEEP]},f.prototype.set=function(h){var g=this.current;(h[0]!==g[0]||h[1]!==g[1]||h[2]!==g[2]||this.dirty)&&(this.gl.stencilOp(h[0],h[1],h[2]),this.current=h,this.dirty=!1)},f}(ye),Bt=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;h?g.enable(g.STENCIL_TEST):g.disable(g.STENCIL_TEST),this.current=h,this.dirty=!1}},f}(ye),Kt=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return[0,1]},f.prototype.set=function(h){var g=this.current;(h[0]!==g[0]||h[1]!==g[1]||this.dirty)&&(this.gl.depthRange(h[0],h[1]),this.current=h,this.dirty=!1)},f}(ye),ys=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;h?g.enable(g.DEPTH_TEST):g.disable(g.DEPTH_TEST),this.current=h,this.dirty=!1}},f}(ye),ts=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.LESS},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.depthFunc(h),this.current=h,this.dirty=!1)},f}(ye),Us=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;h?g.enable(g.BLEND):g.disable(g.BLEND),this.current=h,this.dirty=!1}},f}(ye),ue=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){var h=this.gl;return[h.ONE,h.ZERO]},f.prototype.set=function(h){var g=this.current;(h[0]!==g[0]||h[1]!==g[1]||this.dirty)&&(this.gl.blendFunc(h[0],h[1]),this.current=h,this.dirty=!1)},f}(ye),B=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return o.Color.transparent},f.prototype.set=function(h){var g=this.current;(h.r!==g.r||h.g!==g.g||h.b!==g.b||h.a!==g.a||this.dirty)&&(this.gl.blendColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)},f}(ye),U=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.FUNC_ADD},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.blendEquation(h),this.current=h,this.dirty=!1)},f}(ye),Re=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;h?g.enable(g.CULL_FACE):g.disable(g.CULL_FACE),this.current=h,this.dirty=!1}},f}(ye),nt=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.BACK},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.cullFace(h),this.current=h,this.dirty=!1)},f}(ye),gt=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.CCW},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.frontFace(h),this.current=h,this.dirty=!1)},f}(ye),kt=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.useProgram(h),this.current=h,this.dirty=!1)},f}(ye),Ds=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.TEXTURE0},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.activeTexture(h),this.current=h,this.dirty=!1)},f}(ye),tn=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){var h=this.gl;return[0,0,h.drawingBufferWidth,h.drawingBufferHeight]},f.prototype.set=function(h){var g=this.current;(h[0]!==g[0]||h[1]!==g[1]||h[2]!==g[2]||h[3]!==g[3]||this.dirty)&&(this.gl.viewport(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)},f}(ye),nn=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.bindFramebuffer(g.FRAMEBUFFER,h),this.current=h,this.dirty=!1}},f}(ye),qn=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.bindRenderbuffer(g.RENDERBUFFER,h),this.current=h,this.dirty=!1}},f}(ye),Kn=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.bindTexture(g.TEXTURE_2D,h),this.current=h,this.dirty=!1}},f}(ye),Eh=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.bindBuffer(g.ARRAY_BUFFER,h),this.current=h,this.dirty=!1}},f}(ye),Vc=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(h){var g=this.gl;g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,h),this.current=h,this.dirty=!1},f}(ye),Ua=function(u){function f(h){u.call(this,h),this.vao=h.extVertexArrayObject}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(h){this.vao&&(h!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(h),this.current=h,this.dirty=!1)},f}(ye),Va=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return 4},f.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.pixelStorei(g.UNPACK_ALIGNMENT,h),this.current=h,this.dirty=!1}},f}(ye),Tu=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,h),this.current=h,this.dirty=!1}},f}(ye),yd=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,h),this.current=h,this.dirty=!1}},f}(ye),qr=function(u){function f(h,g){u.call(this,h),this.context=h,this.parent=g}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f}(ye),Q=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.setDirty=function(){this.dirty=!0},f.prototype.set=function(h){if(h!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var g=this.gl;g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,h,0),this.current=h,this.dirty=!1}},f}(qr),ae=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.set=function(h){if(h!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var g=this.gl;g.framebufferRenderbuffer(g.FRAMEBUFFER,g.DEPTH_ATTACHMENT,g.RENDERBUFFER,h),this.current=h,this.dirty=!1}},f}(qr),me=function(u,f,h,g){this.context=u,this.width=f,this.height=h;var S=this.framebuffer=u.gl.createFramebuffer();this.colorAttachment=new Q(u,S),g&&(this.depthAttachment=new ae(u,S))};me.prototype.destroy=function(){var u=this.context.gl,f=this.colorAttachment.get();if(f&&u.deleteTexture(f),this.depthAttachment){var h=this.depthAttachment.get();h&&u.deleteRenderbuffer(h)}u.deleteFramebuffer(this.framebuffer)};var Ae=function(u,f,h){this.func=u,this.mask=f,this.range=h};Ae.ReadOnly=!1,Ae.ReadWrite=!0,Ae.disabled=new Ae(519,Ae.ReadOnly,[0,1]);var Fe=function(u,f,h,g,S,M){this.test=u,this.ref=f,this.mask=h,this.fail=g,this.depthFail=S,this.pass=M};Fe.disabled=new Fe({func:519,mask:0},0,0,7680,7680,7680);var et=function(u,f,h){this.blendFunction=u,this.blendColor=f,this.mask=h};et.disabled=new et(et.Replace=[1,0],o.Color.transparent,[!1,!1,!1,!1]),et.unblended=new et(et.Replace,o.Color.transparent,[!0,!0,!0,!0]),et.alphaBlended=new et([1,771],o.Color.transparent,[!0,!0,!0,!0]);var st=function(u,f,h){this.enable=u,this.mode=f,this.frontFace=h};st.disabled=new st(!1,1029,2305),st.backCCW=new st(!0,1029,2305);var xe=function(u){this.gl=u,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Je(this),this.clearDepth=new at(this),this.clearStencil=new it(this),this.colorMask=new Et(this),this.depthMask=new jt(this),this.stencilMask=new Nt(this),this.stencilFunc=new St(this),this.stencilOp=new Ct(this),this.stencilTest=new Bt(this),this.depthRange=new Kt(this),this.depthTest=new ys(this),this.depthFunc=new ts(this),this.blend=new Us(this),this.blendFunc=new ue(this),this.blendColor=new B(this),this.blendEquation=new U(this),this.cullFace=new Re(this),this.cullFaceSide=new nt(this),this.frontFace=new gt(this),this.program=new kt(this),this.activeTexture=new Ds(this),this.viewport=new tn(this),this.bindFramebuffer=new nn(this),this.bindRenderbuffer=new qn(this),this.bindTexture=new Kn(this),this.bindVertexBuffer=new Eh(this),this.bindElementBuffer=new Vc(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Ua(this),this.pixelStoreUnpack=new Va(this),this.pixelStoreUnpackPremultiplyAlpha=new Tu(this),this.pixelStoreUnpackFlipY=new yd(this),this.extTextureFilterAnisotropic=u.getExtension("EXT_texture_filter_anisotropic")||u.getExtension("MOZ_EXT_texture_filter_anisotropic")||u.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=u.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=u.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(u.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=u.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=u.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=u.getParameter(u.MAX_TEXTURE_SIZE)};xe.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},xe.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},xe.prototype.createIndexBuffer=function(u,f){return new ht(this,u,f)},xe.prototype.createVertexBuffer=function(u,f,h){return new fe(this,u,f,h)},xe.prototype.createRenderbuffer=function(u,f,h){var g=this.gl,S=g.createRenderbuffer();return this.bindRenderbuffer.set(S),g.renderbufferStorage(g.RENDERBUFFER,u,f,h),this.bindRenderbuffer.set(null),S},xe.prototype.createFramebuffer=function(u,f,h){return new me(this,u,f,h)},xe.prototype.clear=function(u){var f=u.color,h=u.depth,g=this.gl,S=0;f&&(S|=g.COLOR_BUFFER_BIT,this.clearColor.set(f),this.colorMask.set([!0,!0,!0,!0])),h!==void 0&&(S|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),g.clear(S)},xe.prototype.setCullFace=function(u){u.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(u.mode),this.frontFace.set(u.frontFace))},xe.prototype.setDepthMode=function(u){u.func!==this.gl.ALWAYS||u.mask?(this.depthTest.set(!0),this.depthFunc.set(u.func),this.depthMask.set(u.mask),this.depthRange.set(u.range)):this.depthTest.set(!1)},xe.prototype.setStencilMode=function(u){u.test.func!==this.gl.ALWAYS||u.mask?(this.stencilTest.set(!0),this.stencilMask.set(u.mask),this.stencilOp.set([u.fail,u.depthFail,u.pass]),this.stencilFunc.set({func:u.test.func,ref:u.ref,mask:u.test.mask})):this.stencilTest.set(!1)},xe.prototype.setColorMode=function(u){o.deepEqual(u.blendFunction,et.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(u.blendFunction),this.blendColor.set(u.blendColor)),this.colorMask.set(u.mask)},xe.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Ve=function(u){function f(h,g,S){var M=this;u.call(this),this.id=h,this.dispatcher=S,this.on("data",function(R){R.dataType==="source"&&R.sourceDataType==="metadata"&&(M._sourceLoaded=!0),M._sourceLoaded&&!M._paused&&R.dataType==="source"&&R.sourceDataType==="content"&&(M.reload(),M.transform&&M.update(M.transform))}),this.on("error",function(){M._sourceErrored=!0}),this._source=function(R,N,H,se){var ge=new Ne[N.type](R,N,H,se);if(ge.id!==R)throw new Error("Expected Source id to be "+R+" instead of "+ge.id);return o.bindAll(["load","abort","unload","serialize","prepare"],ge),ge}(h,g,S,this),this._tiles={},this._cache=new We(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new o.SourceFeatureState}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.onAdd=function(h){this.map=h,this._maxTileCacheSize=h?h._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(h)},f.prototype.onRemove=function(h){this._source&&this._source.onRemove&&this._source.onRemove(h)},f.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var h in this._tiles){var g=this._tiles[h];if(g.state!=="loaded"&&g.state!=="errored")return!1}return!0},f.prototype.getSource=function(){return this._source},f.prototype.pause=function(){this._paused=!0},f.prototype.resume=function(){if(this._paused){var h=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,h&&this.reload(),this.transform&&this.update(this.transform)}},f.prototype._loadTile=function(h,g){return this._source.loadTile(h,g)},f.prototype._unloadTile=function(h){if(this._source.unloadTile)return this._source.unloadTile(h,function(){})},f.prototype._abortTile=function(h){if(this._source.abortTile)return this._source.abortTile(h,function(){})},f.prototype.serialize=function(){return this._source.serialize()},f.prototype.prepare=function(h){for(var g in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var S=this._tiles[g];S.upload(h),S.prepare(this.map.style.imageManager)}},f.prototype.getIds=function(){return o.values(this._tiles).map(function(h){return h.tileID}).sort(pt).map(function(h){return h.key})},f.prototype.getRenderableIds=function(h){var g=this,S=[];for(var M in this._tiles)this._isIdRenderable(M,h)&&S.push(this._tiles[M]);return h?S.sort(function(R,N){var H=R.tileID,se=N.tileID,ge=new o.Point(H.canonical.x,H.canonical.y)._rotate(g.transform.angle),we=new o.Point(se.canonical.x,se.canonical.y)._rotate(g.transform.angle);return H.overscaledZ-se.overscaledZ||we.y-ge.y||we.x-ge.x}).map(function(R){return R.tileID.key}):S.map(function(R){return R.tileID}).sort(pt).map(function(R){return R.key})},f.prototype.hasRenderableParent=function(h){var g=this.findLoadedParent(h,0);return!!g&&this._isIdRenderable(g.tileID.key)},f.prototype._isIdRenderable=function(h,g){return this._tiles[h]&&this._tiles[h].hasData()&&!this._coveredTiles[h]&&(g||!this._tiles[h].holdingForFade())},f.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var h in this._cache.reset(),this._tiles)this._tiles[h].state!=="errored"&&this._reloadTile(h,"reloading")},f.prototype._reloadTile=function(h,g){var S=this._tiles[h];S&&(S.state!=="loading"&&(S.state=g),this._loadTile(S,this._tileLoaded.bind(this,S,h,g)))},f.prototype._tileLoaded=function(h,g,S,M){if(M)return h.state="errored",void(M.status!==404?this._source.fire(new o.ErrorEvent(M,{tile:h})):this.update(this.transform));h.timeAdded=o.browser.now(),S==="expired"&&(h.refreshedUponExpiration=!0),this._setTileReloadTimer(g,h),this.getSource().type==="raster-dem"&&h.dem&&this._backfillDEM(h),this._state.initializeTileState(h,this.map?this.map.painter:null),this._source.fire(new o.Event("data",{dataType:"source",tile:h,coord:h.tileID}))},f.prototype._backfillDEM=function(h){for(var g=this.getRenderableIds(),S=0;S<g.length;S++){var M=g[S];if(h.neighboringTiles&&h.neighboringTiles[M]){var R=this.getTileByID(M);N(h,R),N(R,h)}}function N(H,se){H.needsHillshadePrepare=!0;var ge=se.tileID.canonical.x-H.tileID.canonical.x,we=se.tileID.canonical.y-H.tileID.canonical.y,Te=Math.pow(2,H.tileID.canonical.z),ze=se.tileID.key;ge===0&&we===0||Math.abs(we)>1||(Math.abs(ge)>1&&(Math.abs(ge+Te)===1?ge+=Te:Math.abs(ge-Te)===1&&(ge-=Te)),se.dem&&H.dem&&(H.dem.backfillBorder(se.dem,ge,we),H.neighboringTiles&&H.neighboringTiles[ze]&&(H.neighboringTiles[ze].backfilled=!0)))}},f.prototype.getTile=function(h){return this.getTileByID(h.key)},f.prototype.getTileByID=function(h){return this._tiles[h]},f.prototype._retainLoadedChildren=function(h,g,S,M){for(var R in this._tiles){var N=this._tiles[R];if(!(M[R]||!N.hasData()||N.tileID.overscaledZ<=g||N.tileID.overscaledZ>S)){for(var H=N.tileID;N&&N.tileID.overscaledZ>g+1;){var se=N.tileID.scaledTo(N.tileID.overscaledZ-1);(N=this._tiles[se.key])&&N.hasData()&&(H=se)}for(var ge=H;ge.overscaledZ>g;)if(h[(ge=ge.scaledTo(ge.overscaledZ-1)).key]){M[H.key]=H;break}}}},f.prototype.findLoadedParent=function(h,g){if(h.key in this._loadedParentTiles){var S=this._loadedParentTiles[h.key];return S&&S.tileID.overscaledZ>=g?S:null}for(var M=h.overscaledZ-1;M>=g;M--){var R=h.scaledTo(M),N=this._getLoadedTile(R);if(N)return N}},f.prototype._getLoadedTile=function(h){var g=this._tiles[h.key];return g&&g.hasData()?g:this._cache.getByKey(h.wrapped().key)},f.prototype.updateCacheSize=function(h){var g=Math.ceil(h.width/this._source.tileSize)+1,S=Math.ceil(h.height/this._source.tileSize)+1,M=Math.floor(g*S*5),R=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,M):M;this._cache.setMaxSize(R)},f.prototype.handleWrapJump=function(h){var g=Math.round((h-(this._prevLng===void 0?h:this._prevLng))/360);if(this._prevLng=h,g){var S={};for(var M in this._tiles){var R=this._tiles[M];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+g),S[R.tileID.key]=R}for(var N in this._tiles=S,this._timers)clearTimeout(this._timers[N]),delete this._timers[N];for(var H in this._tiles)this._setTileReloadTimer(H,this._tiles[H])}},f.prototype.update=function(h){var g=this;if(this.transform=h,this._sourceLoaded&&!this._paused){var S;this.updateCacheSize(h),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?S=h.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Dt){return new o.OverscaledTileID(Dt.canonical.z,Dt.wrap,Dt.canonical.z,Dt.canonical.x,Dt.canonical.y)}):(S=h.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(S=S.filter(function(Dt){return g._source.hasTile(Dt)}))):S=[];var M=h.coveringZoomLevel(this._source),R=Math.max(M-f.maxOverzooming,this._source.minzoom),N=Math.max(M+f.maxUnderzooming,this._source.minzoom),H=this._updateRetainedTiles(S,M);if(Ft(this._source.type)){for(var se={},ge={},we=0,Te=Object.keys(H);we<Te.length;we+=1){var ze=Te[we],De=H[ze],Ye=this._tiles[ze];if(Ye&&!(Ye.fadeEndTime&&Ye.fadeEndTime<=o.browser.now())){var Le=this.findLoadedParent(De,R);Le&&(this._addTile(Le.tileID),se[Le.tileID.key]=Le.tileID),ge[ze]=De}}for(var Ze in this._retainLoadedChildren(ge,M,N,H),se)H[Ze]||(this._coveredTiles[Ze]=!0,H[Ze]=se[Ze])}for(var tt in H)this._tiles[tt].clearFadeHold();for(var ut=0,wt=o.keysDifference(this._tiles,H);ut<wt.length;ut+=1){var bt=wt[ut],It=this._tiles[bt];It.hasSymbolBuckets&&!It.holdingForFade()?It.setHoldDuration(this.map._fadeDuration):It.hasSymbolBuckets&&!It.symbolFadeFinished()||this._removeTile(bt)}this._updateLoadedParentTileCache()}},f.prototype.releaseSymbolFadeTiles=function(){for(var h in this._tiles)this._tiles[h].holdingForFade()&&this._removeTile(h)},f.prototype._updateRetainedTiles=function(h,g){for(var S={},M={},R=Math.max(g-f.maxOverzooming,this._source.minzoom),N=Math.max(g+f.maxUnderzooming,this._source.minzoom),H={},se=0,ge=h;se<ge.length;se+=1){var we=ge[se],Te=this._addTile(we);S[we.key]=we,Te.hasData()||g<this._source.maxzoom&&(H[we.key]=we)}this._retainLoadedChildren(H,g,N,S);for(var ze=0,De=h;ze<De.length;ze+=1){var Ye=De[ze],Le=this._tiles[Ye.key];if(!Le.hasData()){if(g+1>this._source.maxzoom){var Ze=Ye.children(this._source.maxzoom)[0],tt=this.getTile(Ze);if(tt&&tt.hasData()){S[Ze.key]=Ze;continue}}else{var ut=Ye.children(this._source.maxzoom);if(S[ut[0].key]&&S[ut[1].key]&&S[ut[2].key]&&S[ut[3].key])continue}for(var wt=Le.wasRequested(),bt=Ye.overscaledZ-1;bt>=R;--bt){var It=Ye.scaledTo(bt);if(M[It.key]||(M[It.key]=!0,!(Le=this.getTile(It))&&wt&&(Le=this._addTile(It)),Le&&(S[It.key]=It,wt=Le.wasRequested(),Le.hasData())))break}}}return S},f.prototype._updateLoadedParentTileCache=function(){for(var h in this._loadedParentTiles={},this._tiles){for(var g=[],S=void 0,M=this._tiles[h].tileID;M.overscaledZ>0;){if(M.key in this._loadedParentTiles){S=this._loadedParentTiles[M.key];break}g.push(M.key);var R=M.scaledTo(M.overscaledZ-1);if(S=this._getLoadedTile(R))break;M=R}for(var N=0,H=g;N<H.length;N+=1)this._loadedParentTiles[H[N]]=S}},f.prototype._addTile=function(h){var g=this._tiles[h.key];if(g)return g;(g=this._cache.getAndRemove(h))&&(this._setTileReloadTimer(h.key,g),g.tileID=h,this._state.initializeTileState(g,this.map?this.map.painter:null),this._cacheTimers[h.key]&&(clearTimeout(this._cacheTimers[h.key]),delete this._cacheTimers[h.key],this._setTileReloadTimer(h.key,g)));var S=Boolean(g);return S||(g=new o.Tile(h,this._source.tileSize*h.overscaleFactor()),this._loadTile(g,this._tileLoaded.bind(this,g,h.key,g.state))),g?(g.uses++,this._tiles[h.key]=g,S||this._source.fire(new o.Event("dataloading",{tile:g,coord:g.tileID,dataType:"source"})),g):null},f.prototype._setTileReloadTimer=function(h,g){var S=this;h in this._timers&&(clearTimeout(this._timers[h]),delete this._timers[h]);var M=g.getExpiryTimeout();M&&(this._timers[h]=setTimeout(function(){S._reloadTile(h,"expired"),delete S._timers[h]},M))},f.prototype._removeTile=function(h){var g=this._tiles[h];g&&(g.uses--,delete this._tiles[h],this._timers[h]&&(clearTimeout(this._timers[h]),delete this._timers[h]),g.uses>0||(g.hasData()&&g.state!=="reloading"?this._cache.add(g.tileID,g,g.getExpiryTimeout()):(g.aborted=!0,this._abortTile(g),this._unloadTile(g))))},f.prototype.clearTiles=function(){for(var h in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(h);this._cache.reset()},f.prototype.tilesIn=function(h,g,S){var M=this,R=[],N=this.transform;if(!N)return R;for(var H=S?N.getCameraQueryGeometry(h):h,se=h.map(function(bt){return N.pointCoordinate(bt)}),ge=H.map(function(bt){return N.pointCoordinate(bt)}),we=this.getIds(),Te=1/0,ze=1/0,De=-1/0,Ye=-1/0,Le=0,Ze=ge;Le<Ze.length;Le+=1){var tt=Ze[Le];Te=Math.min(Te,tt.x),ze=Math.min(ze,tt.y),De=Math.max(De,tt.x),Ye=Math.max(Ye,tt.y)}for(var ut=function(bt){var It=M._tiles[we[bt]];if(!It.holdingForFade()){var Dt=It.tileID,Gt=Math.pow(2,N.zoom-It.tileID.overscaledZ),Xt=g*It.queryPadding*o.EXTENT/It.tileSize/Gt,as=[Dt.getTilePoint(new o.MercatorCoordinate(Te,ze)),Dt.getTilePoint(new o.MercatorCoordinate(De,Ye))];if(as[0].x-Xt<o.EXTENT&&as[0].y-Xt<o.EXTENT&&as[1].x+Xt>=0&&as[1].y+Xt>=0){var vs=se.map(function(ks){return Dt.getTilePoint(ks)}),$s=ge.map(function(ks){return Dt.getTilePoint(ks)});R.push({tile:It,tileID:Dt,queryGeometry:vs,cameraQueryGeometry:$s,scale:Gt})}}},wt=0;wt<we.length;wt++)ut(wt);return R},f.prototype.getVisibleCoordinates=function(h){for(var g=this,S=this.getRenderableIds(h).map(function(H){return g._tiles[H].tileID}),M=0,R=S;M<R.length;M+=1){var N=R[M];N.posMatrix=this.transform.calculatePosMatrix(N.toUnwrapped())}return S},f.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Ft(this._source.type))for(var h in this._tiles){var g=this._tiles[h];if(g.fadeEndTime!==void 0&&g.fadeEndTime>=o.browser.now())return!0}return!1},f.prototype.setFeatureState=function(h,g,S){this._state.updateState(h=h||"_geojsonTileLayer",g,S)},f.prototype.removeFeatureState=function(h,g,S){this._state.removeFeatureState(h=h||"_geojsonTileLayer",g,S)},f.prototype.getFeatureState=function(h,g){return this._state.getState(h=h||"_geojsonTileLayer",g)},f.prototype.setDependencies=function(h,g,S){var M=this._tiles[h];M&&M.setDependencies(g,S)},f.prototype.reloadTilesForDependencies=function(h,g){for(var S in this._tiles)this._tiles[S].hasDependency(h,g)&&this._reloadTile(S,"reloading");this._cache.filter(function(M){return!M.hasDependency(h,g)})},f}(o.Evented);function pt(u,f){var h=Math.abs(2*u.wrap)-+(u.wrap<0),g=Math.abs(2*f.wrap)-+(f.wrap<0);return u.overscaledZ-f.overscaledZ||g-h||f.canonical.y-u.canonical.y||f.canonical.x-u.canonical.x}function Ft(u){return u==="raster"||u==="image"||u==="video"}function Ht(){return new o.window.Worker(ia.workerUrl)}Ve.maxOverzooming=10,Ve.maxUnderzooming=3;var Tt="mapboxgl_preloaded_worker_pool",Vt=function(){this.active={}};Vt.prototype.acquire=function(u){if(!this.workers)for(this.workers=[];this.workers.length<Vt.workerCount;)this.workers.push(new Ht);return this.active[u]=!0,this.workers.slice()},Vt.prototype.release=function(u){delete this.active[u],this.numActive()===0&&(this.workers.forEach(function(f){f.terminate()}),this.workers=null)},Vt.prototype.isPreloaded=function(){return!!this.active[Tt]},Vt.prototype.numActive=function(){return Object.keys(this.active).length};var xs,ms=Math.floor(o.browser.hardwareConcurrency/2);function At(){return xs||(xs=new Vt),xs}function fs(u,f){var h={};for(var g in u)g!=="ref"&&(h[g]=u[g]);return o.refProperties.forEach(function(S){S in f&&(h[S]=f[S])}),h}function ns(u){u=u.slice();for(var f=Object.create(null),h=0;h<u.length;h++)f[u[h].id]=u[h];for(var g=0;g<u.length;g++)"ref"in u[g]&&(u[g]=fs(u[g],f[u[g].ref]));return u}Vt.workerCount=Math.max(Math.min(ms,6),1);var is={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function rn(u,f,h){h.push({command:is.addSource,args:[u,f[u]]})}function hs(u,f,h){f.push({command:is.removeSource,args:[u]}),h[u]=!0}function mn(u,f,h,g){hs(u,h,g),rn(u,f,h)}function Fn(u,f,h){var g;for(g in u[h])if(u[h].hasOwnProperty(g)&&g!=="data"&&!o.deepEqual(u[h][g],f[h][g]))return!1;for(g in f[h])if(f[h].hasOwnProperty(g)&&g!=="data"&&!o.deepEqual(u[h][g],f[h][g]))return!1;return!0}function hn(u,f,h,g,S,M){var R;for(R in f=f||{},u=u||{})u.hasOwnProperty(R)&&(o.deepEqual(u[R],f[R])||h.push({command:M,args:[g,R,f[R],S]}));for(R in f)f.hasOwnProperty(R)&&!u.hasOwnProperty(R)&&(o.deepEqual(u[R],f[R])||h.push({command:M,args:[g,R,f[R],S]}))}function Sn(u){return u.id}function bn(u,f){return u[f.id]=f,u}var eo=function(u,f){this.reset(u,f)};eo.prototype.reset=function(u,f){this.points=u||[],this._distances=[0];for(var h=1;h<this.points.length;h++)this._distances[h]=this._distances[h-1]+this.points[h].dist(this.points[h-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding},eo.prototype.lerp=function(u){if(this.points.length===1)return this.points[0];u=o.clamp(u,0,1);for(var f=1,h=this._distances[f],g=u*this.paddedLength+this.padding;h<g&&f<this._distances.length;)h=this._distances[++f];var S=f-1,M=this._distances[S],R=h-M,N=R>0?(g-M)/R:0;return this.points[S].mult(1-N).add(this.points[f].mult(N))};var zn=function(u,f,h){var g=this.boxCells=[],S=this.circleCells=[];this.xCellCount=Math.ceil(u/h),this.yCellCount=Math.ceil(f/h);for(var M=0;M<this.xCellCount*this.yCellCount;M++)g.push([]),S.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=u,this.height=f,this.xScale=this.xCellCount/u,this.yScale=this.yCellCount/f,this.boxUid=0,this.circleUid=0};function Br(u,f,h,g,S){var M=o.create();return f?(o.scale(M,M,[1/S,1/S,1]),h||o.rotateZ(M,M,g.angle)):o.multiply(M,g.labelPlaneMatrix,u),M}function Hn(u,f,h,g,S){if(f){var M=o.clone(u);return o.scale(M,M,[S,S,1]),h||o.rotateZ(M,M,-g.angle),M}return g.glCoordMatrix}function pn(u,f){var h=[u.x,u.y,0,1];Zr(h,h,f);var g=h[3];return{point:new o.Point(h[0]/g,h[1]/g),signedDistanceFromCamera:g}}function On(u,f){return .5+u/f*.5}function po(u,f){var h=u[0]/u[3],g=u[1]/u[3];return h>=-f[0]&&h<=f[0]&&g>=-f[1]&&g<=f[1]}function vd(u,f,h,g,S,M,R,N){var H=g?u.textSizeData:u.iconSizeData,se=o.evaluateSizeForZoom(H,h.transform.zoom),ge=[256/h.width*2+1,256/h.height*2+1],we=g?u.text.dynamicLayoutVertexArray:u.icon.dynamicLayoutVertexArray;we.clear();for(var Te=u.lineVertexArray,ze=g?u.text.placedSymbolArray:u.icon.placedSymbolArray,De=h.transform.width/h.transform.height,Ye=!1,Le=0;Le<ze.length;Le++){var Ze=ze.get(Le);if(Ze.hidden||Ze.writingMode===o.WritingMode.vertical&&!Ye)Di(Ze.numGlyphs,we);else{Ye=!1;var tt=[Ze.anchorX,Ze.anchorY,0,1];if(o.transformMat4(tt,tt,f),po(tt,ge)){var ut=On(h.transform.cameraToCenterDistance,tt[3]),wt=o.evaluateSizeForFeature(H,se,Ze),bt=R?wt/ut:wt*ut,It=new o.Point(Ze.anchorX,Ze.anchorY),Dt=pn(It,S).point,Gt={},Xt=kh(Ze,bt,!1,N,f,S,M,u.glyphOffsetArray,Te,we,Dt,It,Gt,De);Ye=Xt.useVertical,(Xt.notEnoughRoom||Ye||Xt.needsFlipping&&kh(Ze,bt,!0,N,f,S,M,u.glyphOffsetArray,Te,we,Dt,It,Gt,De).notEnoughRoom)&&Di(Ze.numGlyphs,we)}else Di(Ze.numGlyphs,we)}}g?u.text.dynamicLayoutVertexBuffer.updateData(we):u.icon.dynamicLayoutVertexBuffer.updateData(we)}function vi(u,f,h,g,S,M,R,N,H,se,ge){var we=N.glyphStartIndex+N.numGlyphs,Te=N.lineStartIndex,ze=N.lineStartIndex+N.lineLength,De=f.getoffsetX(N.glyphStartIndex),Ye=f.getoffsetX(we-1),Le=Pr(u*De,h,g,S,M,R,N.segment,Te,ze,H,se,ge);if(!Le)return null;var Ze=Pr(u*Ye,h,g,S,M,R,N.segment,Te,ze,H,se,ge);return Ze?{first:Le,last:Ze}:null}function to(u,f,h,g){return u===o.WritingMode.horizontal&&Math.abs(h.y-f.y)>Math.abs(h.x-f.x)*g?{useVertical:!0}:(u===o.WritingMode.vertical?f.y<h.y:f.x>h.x)?{needsFlipping:!0}:null}function kh(u,f,h,g,S,M,R,N,H,se,ge,we,Te,ze){var De,Ye=f/24,Le=u.lineOffsetX*Ye,Ze=u.lineOffsetY*Ye;if(u.numGlyphs>1){var tt=u.glyphStartIndex+u.numGlyphs,ut=u.lineStartIndex,wt=u.lineStartIndex+u.lineLength,bt=vi(Ye,N,Le,Ze,h,ge,we,u,H,M,Te);if(!bt)return{notEnoughRoom:!0};var It=pn(bt.first.point,R).point,Dt=pn(bt.last.point,R).point;if(g&&!h){var Gt=to(u.writingMode,It,Dt,ze);if(Gt)return Gt}De=[bt.first];for(var Xt=u.glyphStartIndex+1;Xt<tt-1;Xt++)De.push(Pr(Ye*N.getoffsetX(Xt),Le,Ze,h,ge,we,u.segment,ut,wt,H,M,Te));De.push(bt.last)}else{if(g&&!h){var as=pn(we,S).point,vs=u.lineStartIndex+u.segment+1,$s=new o.Point(H.getx(vs),H.gety(vs)),ks=pn($s,S),xn=ks.signedDistanceFromCamera>0?ks.point:Au(we,$s,as,1,S),ps=to(u.writingMode,as,xn,ze);if(ps)return ps}var Ls=Pr(Ye*N.getoffsetX(u.glyphStartIndex),Le,Ze,h,ge,we,u.segment,u.lineStartIndex,u.lineStartIndex+u.lineLength,H,M,Te);if(!Ls)return{notEnoughRoom:!0};De=[Ls]}for(var Qs=0,qs=De;Qs<qs.length;Qs+=1){var zs=qs[Qs];o.addDynamicAttributes(se,zs.point,zs.angle)}return{}}function Au(u,f,h,g,S){var M=pn(u.add(u.sub(f)._unit()),S).point,R=h.sub(M);return h.add(R._mult(g/R.mag()))}function Pr(u,f,h,g,S,M,R,N,H,se,ge,we){var Te=g?u-f:u+f,ze=Te>0?1:-1,De=0;g&&(ze*=-1,De=Math.PI),ze<0&&(De+=Math.PI);for(var Ye=ze>0?N+R:N+R+1,Le=S,Ze=S,tt=0,ut=0,wt=Math.abs(Te),bt=[];tt+ut<=wt;){if((Ye+=ze)<N||Ye>=H)return null;if(Ze=Le,bt.push(Le),(Le=we[Ye])===void 0){var It=new o.Point(se.getx(Ye),se.gety(Ye)),Dt=pn(It,ge);if(Dt.signedDistanceFromCamera>0)Le=we[Ye]=Dt.point;else{var Gt=Ye-ze;Le=Au(tt===0?M:new o.Point(se.getx(Gt),se.gety(Gt)),It,Ze,wt-tt+1,ge)}}tt+=ut,ut=Ze.dist(Le)}var Xt=(wt-tt)/ut,as=Le.sub(Ze),vs=as.mult(Xt)._add(Ze);vs._add(as._unit()._perp()._mult(h*ze));var $s=De+Math.atan2(Le.y-Ze.y,Le.x-Ze.x);return bt.push(vs),{point:vs,angle:$s,path:bt}}zn.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},zn.prototype.insert=function(u,f,h,g,S){this._forEachCell(f,h,g,S,this._insertBoxCell,this.boxUid++),this.boxKeys.push(u),this.bboxes.push(f),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(S)},zn.prototype.insertCircle=function(u,f,h,g){this._forEachCell(f-g,h-g,f+g,h+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(u),this.circles.push(f),this.circles.push(h),this.circles.push(g)},zn.prototype._insertBoxCell=function(u,f,h,g,S,M){this.boxCells[S].push(M)},zn.prototype._insertCircleCell=function(u,f,h,g,S,M){this.circleCells[S].push(M)},zn.prototype._query=function(u,f,h,g,S,M){if(h<0||u>this.width||g<0||f>this.height)return!S&&[];var R=[];if(u<=0&&f<=0&&this.width<=h&&this.height<=g){if(S)return!0;for(var N=0;N<this.boxKeys.length;N++)R.push({key:this.boxKeys[N],x1:this.bboxes[4*N],y1:this.bboxes[4*N+1],x2:this.bboxes[4*N+2],y2:this.bboxes[4*N+3]});for(var H=0;H<this.circleKeys.length;H++){var se=this.circles[3*H],ge=this.circles[3*H+1],we=this.circles[3*H+2];R.push({key:this.circleKeys[H],x1:se-we,y1:ge-we,x2:se+we,y2:ge+we})}return M?R.filter(M):R}return this._forEachCell(u,f,h,g,this._queryCell,R,{hitTest:S,seenUids:{box:{},circle:{}}},M),S?R.length>0:R},zn.prototype._queryCircle=function(u,f,h,g,S){var M=u-h,R=u+h,N=f-h,H=f+h;if(R<0||M>this.width||H<0||N>this.height)return!g&&[];var se=[];return this._forEachCell(M,N,R,H,this._queryCellCircle,se,{hitTest:g,circle:{x:u,y:f,radius:h},seenUids:{box:{},circle:{}}},S),g?se.length>0:se},zn.prototype.query=function(u,f,h,g,S){return this._query(u,f,h,g,!1,S)},zn.prototype.hitTest=function(u,f,h,g,S){return this._query(u,f,h,g,!0,S)},zn.prototype.hitTestCircle=function(u,f,h,g){return this._queryCircle(u,f,h,!0,g)},zn.prototype._queryCell=function(u,f,h,g,S,M,R,N){var H=R.seenUids,se=this.boxCells[S];if(se!==null)for(var ge=this.bboxes,we=0,Te=se;we<Te.length;we+=1){var ze=Te[we];if(!H.box[ze]){H.box[ze]=!0;var De=4*ze;if(u<=ge[De+2]&&f<=ge[De+3]&&h>=ge[De+0]&&g>=ge[De+1]&&(!N||N(this.boxKeys[ze]))){if(R.hitTest)return M.push(!0),!0;M.push({key:this.boxKeys[ze],x1:ge[De],y1:ge[De+1],x2:ge[De+2],y2:ge[De+3]})}}}var Ye=this.circleCells[S];if(Ye!==null)for(var Le=this.circles,Ze=0,tt=Ye;Ze<tt.length;Ze+=1){var ut=tt[Ze];if(!H.circle[ut]){H.circle[ut]=!0;var wt=3*ut;if(this._circleAndRectCollide(Le[wt],Le[wt+1],Le[wt+2],u,f,h,g)&&(!N||N(this.circleKeys[ut]))){if(R.hitTest)return M.push(!0),!0;var bt=Le[wt],It=Le[wt+1],Dt=Le[wt+2];M.push({key:this.circleKeys[ut],x1:bt-Dt,y1:It-Dt,x2:bt+Dt,y2:It+Dt})}}}},zn.prototype._queryCellCircle=function(u,f,h,g,S,M,R,N){var H=R.circle,se=R.seenUids,ge=this.boxCells[S];if(ge!==null)for(var we=this.bboxes,Te=0,ze=ge;Te<ze.length;Te+=1){var De=ze[Te];if(!se.box[De]){se.box[De]=!0;var Ye=4*De;if(this._circleAndRectCollide(H.x,H.y,H.radius,we[Ye+0],we[Ye+1],we[Ye+2],we[Ye+3])&&(!N||N(this.boxKeys[De])))return M.push(!0),!0}}var Le=this.circleCells[S];if(Le!==null)for(var Ze=this.circles,tt=0,ut=Le;tt<ut.length;tt+=1){var wt=ut[tt];if(!se.circle[wt]){se.circle[wt]=!0;var bt=3*wt;if(this._circlesCollide(Ze[bt],Ze[bt+1],Ze[bt+2],H.x,H.y,H.radius)&&(!N||N(this.circleKeys[wt])))return M.push(!0),!0}}},zn.prototype._forEachCell=function(u,f,h,g,S,M,R,N){for(var H=this._convertToXCellCoord(u),se=this._convertToYCellCoord(f),ge=this._convertToXCellCoord(h),we=this._convertToYCellCoord(g),Te=H;Te<=ge;Te++)for(var ze=se;ze<=we;ze++)if(S.call(this,u,f,h,g,this.xCellCount*ze+Te,M,R,N))return},zn.prototype._convertToXCellCoord=function(u){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(u*this.xScale)))},zn.prototype._convertToYCellCoord=function(u){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(u*this.yScale)))},zn.prototype._circlesCollide=function(u,f,h,g,S,M){var R=g-u,N=S-f,H=h+M;return H*H>R*R+N*N},zn.prototype._circleAndRectCollide=function(u,f,h,g,S,M,R){var N=(M-g)/2,H=Math.abs(u-(g+N));if(H>N+h)return!1;var se=(R-S)/2,ge=Math.abs(f-(S+se));if(ge>se+h)return!1;if(H<=N||ge<=se)return!0;var we=H-N,Te=ge-se;return we*we+Te*Te<=h*h};var bd=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Di(u,f){for(var h=0;h<u;h++){var g=f.length;f.resize(g+4),f.float32.set(bd,3*g)}}function Zr(u,f,h){var g=f[0],S=f[1];return u[0]=h[0]*g+h[4]*S+h[12],u[1]=h[1]*g+h[5]*S+h[13],u[3]=h[3]*g+h[7]*S+h[15],u}var zo=function(u,f,h){f===void 0&&(f=new zn(u.width+200,u.height+200,25)),h===void 0&&(h=new zn(u.width+200,u.height+200,25)),this.transform=u,this.grid=f,this.ignoredGrid=h,this.pitchfactor=Math.cos(u._pitch)*u.cameraToCenterDistance,this.screenRightBoundary=u.width+100,this.screenBottomBoundary=u.height+100,this.gridRightBoundary=u.width+200,this.gridBottomBoundary=u.height+200};function Sr(u,f,h){return f*(o.EXTENT/(u.tileSize*Math.pow(2,h-u.tileID.overscaledZ)))}zo.prototype.placeCollisionBox=function(u,f,h,g,S){var M=this.projectAndGetPerspectiveRatio(g,u.anchorPointX,u.anchorPointY),R=h*M.perspectiveRatio,N=u.x1*R+M.point.x,H=u.y1*R+M.point.y,se=u.x2*R+M.point.x,ge=u.y2*R+M.point.y;return!this.isInsideGrid(N,H,se,ge)||!f&&this.grid.hitTest(N,H,se,ge,S)?{box:[],offscreen:!1}:{box:[N,H,se,ge],offscreen:this.isOffscreen(N,H,se,ge)}},zo.prototype.placeCollisionCircles=function(u,f,h,g,S,M,R,N,H,se,ge,we,Te){var ze=[],De=new o.Point(f.anchorX,f.anchorY),Ye=pn(De,M),Le=On(this.transform.cameraToCenterDistance,Ye.signedDistanceFromCamera),Ze=(se?S/Le:S*Le)/o.ONE_EM,tt=pn(De,R).point,ut=vi(Ze,g,f.lineOffsetX*Ze,f.lineOffsetY*Ze,!1,tt,De,f,h,R,{}),wt=!1,bt=!1,It=!0;if(ut){for(var Dt=.5*we*Le+Te,Gt=new o.Point(-100,-100),Xt=new o.Point(this.screenRightBoundary,this.screenBottomBoundary),as=new eo,vs=ut.first,$s=ut.last,ks=[],xn=vs.path.length-1;xn>=1;xn--)ks.push(vs.path[xn]);for(var ps=1;ps<$s.path.length;ps++)ks.push($s.path[ps]);var Ls=2.5*Dt;if(N){var Qs=ks.map(function(oa){return pn(oa,N)});ks=Qs.some(function(oa){return oa.signedDistanceFromCamera<=0})?[]:Qs.map(function(oa){return oa.point})}var qs=[];if(ks.length>0){for(var zs=ks[0].clone(),en=ks[0].clone(),Vs=1;Vs<ks.length;Vs++)zs.x=Math.min(zs.x,ks[Vs].x),zs.y=Math.min(zs.y,ks[Vs].y),en.x=Math.max(en.x,ks[Vs].x),en.y=Math.max(en.y,ks[Vs].y);qs=zs.x>=Gt.x&&en.x<=Xt.x&&zs.y>=Gt.y&&en.y<=Xt.y?[ks]:en.x<Gt.x||zs.x>Xt.x||en.y<Gt.y||zs.y>Xt.y?[]:o.clipLine([ks],Gt.x,Gt.y,Xt.x,Xt.y)}for(var ws=0,ei=qs;ws<ei.length;ws+=1){var $r;as.reset(ei[ws],.25*Dt),$r=as.length<=.5*Dt?1:Math.ceil(as.paddedLength/Ls)+1;for(var kr=0;kr<$r;kr++){var oi=kr/Math.max($r-1,1),fr=as.lerp(oi),ur=fr.x+100,_o=fr.y+100;ze.push(ur,_o,Dt,0);var lr=ur-Dt,qa=_o-Dt,go=ur+Dt,Ra=_o+Dt;if(It=It&&this.isOffscreen(lr,qa,go,Ra),bt=bt||this.isInsideGrid(lr,qa,go,Ra),!u&&this.grid.hitTestCircle(ur,_o,Dt,ge)&&(wt=!0,!H))return{circles:[],offscreen:!1,collisionDetected:wt}}}}return{circles:!H&&wt||!bt?[]:ze,offscreen:It,collisionDetected:wt}},zo.prototype.queryRenderedSymbols=function(u){if(u.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var f=[],h=1/0,g=1/0,S=-1/0,M=-1/0,R=0,N=u;R<N.length;R+=1){var H=N[R],se=new o.Point(H.x+100,H.y+100);h=Math.min(h,se.x),g=Math.min(g,se.y),S=Math.max(S,se.x),M=Math.max(M,se.y),f.push(se)}for(var ge={},we={},Te=0,ze=this.grid.query(h,g,S,M).concat(this.ignoredGrid.query(h,g,S,M));Te<ze.length;Te+=1){var De=ze[Te],Ye=De.key;if(ge[Ye.bucketInstanceId]===void 0&&(ge[Ye.bucketInstanceId]={}),!ge[Ye.bucketInstanceId][Ye.featureIndex]){var Le=[new o.Point(De.x1,De.y1),new o.Point(De.x2,De.y1),new o.Point(De.x2,De.y2),new o.Point(De.x1,De.y2)];o.polygonIntersectsPolygon(f,Le)&&(ge[Ye.bucketInstanceId][Ye.featureIndex]=!0,we[Ye.bucketInstanceId]===void 0&&(we[Ye.bucketInstanceId]=[]),we[Ye.bucketInstanceId].push(Ye.featureIndex))}}return we},zo.prototype.insertCollisionBox=function(u,f,h,g,S){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:g,collisionGroupID:S},u[0],u[1],u[2],u[3])},zo.prototype.insertCollisionCircles=function(u,f,h,g,S){for(var M=f?this.ignoredGrid:this.grid,R={bucketInstanceId:h,featureIndex:g,collisionGroupID:S},N=0;N<u.length;N+=4)M.insertCircle(R,u[N],u[N+1],u[N+2])},zo.prototype.projectAndGetPerspectiveRatio=function(u,f,h){var g=[f,h,0,1];return Zr(g,g,u),{point:new o.Point((g[0]/g[3]+1)/2*this.transform.width+100,(-g[1]/g[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/g[3]*.5}},zo.prototype.isOffscreen=function(u,f,h,g){return h<100||u>=this.screenRightBoundary||g<100||f>this.screenBottomBoundary},zo.prototype.isInsideGrid=function(u,f,h,g){return h>=0&&u<this.gridRightBoundary&&g>=0&&f<this.gridBottomBoundary},zo.prototype.getViewportMatrix=function(){var u=o.identity([]);return o.translate(u,u,[-100,-100,0]),u};var Jo=function(u,f,h,g){this.opacity=u?Math.max(0,Math.min(1,u.opacity+(u.placed?f:-f))):g&&h?1:0,this.placed=h};Jo.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var Co=function(u,f,h,g,S){this.text=new Jo(u?u.text:null,f,h,S),this.icon=new Jo(u?u.icon:null,f,g,S)};Co.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Ph=function(u,f,h){this.text=u,this.icon=f,this.skipFade=h},Qo=function(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]},Lm=function(u,f,h,g,S){this.bucketInstanceId=u,this.featureIndex=f,this.sourceLayerIndex=h,this.bucketIndex=g,this.tileID=S},Ta=function(u){this.crossSourceCollisions=u,this.maxGroupID=0,this.collisionGroups={}};function fi(u,f,h,g,S){var M=o.getAnchorAlignment(u),R=-(M.horizontalAlign-.5)*f,N=-(M.verticalAlign-.5)*h,H=o.evaluateVariableOffset(u,g);return new o.Point(R+H[0]*S,N+H[1]*S)}function fo(u,f,h,g,S,M){var R=u.x1,N=u.x2,H=u.y1,se=u.y2,ge=u.anchorPointX,we=u.anchorPointY,Te=new o.Point(f,h);return g&&Te._rotate(S?M:-M),{x1:R+Te.x,y1:H+Te.y,x2:N+Te.x,y2:se+Te.y,anchorPointX:ge,anchorPointY:we}}Ta.prototype.get=function(u){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[u]){var f=++this.maxGroupID;this.collisionGroups[u]={ID:f,predicate:function(h){return h.collisionGroupID===f}}}return this.collisionGroups[u]};var Bi=function(u,f,h,g){this.transform=u.clone(),this.collisionIndex=new zo(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new Ta(h),this.collisionCircleArrays={},this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}};function jl(u,f,h,g,S){u.emplaceBack(f?1:0,h?1:0,g||0,S||0),u.emplaceBack(f?1:0,h?1:0,g||0,S||0),u.emplaceBack(f?1:0,h?1:0,g||0,S||0),u.emplaceBack(f?1:0,h?1:0,g||0,S||0)}Bi.prototype.getBucketParts=function(u,f,h,g){var S=h.getBucket(f),M=h.latestFeatureIndex;if(S&&M&&f.id===S.layerIds[0]){var R=h.collisionBoxArray,N=S.layers[0].layout,H=Math.pow(2,this.transform.zoom-h.tileID.overscaledZ),se=h.tileSize/o.EXTENT,ge=this.transform.calculatePosMatrix(h.tileID.toUnwrapped()),we=N.get("text-pitch-alignment")==="map",Te=N.get("text-rotation-alignment")==="map",ze=Sr(h,1,this.transform.zoom),De=Br(ge,we,Te,this.transform,ze),Ye=null;if(we){var Le=Hn(ge,we,Te,this.transform,ze);Ye=o.multiply([],this.transform.labelPlaneMatrix,Le)}this.retainedQueryData[S.bucketInstanceId]=new Lm(S.bucketInstanceId,M,S.sourceLayerIndex,S.index,h.tileID);var Ze={bucket:S,layout:N,posMatrix:ge,textLabelPlaneMatrix:De,labelToScreenMatrix:Ye,scale:H,textPixelRatio:se,holdingForFade:h.holdingForFade(),collisionBoxArray:R,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(S.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(S.sourceID)};if(g)for(var tt=0,ut=S.sortKeyRanges;tt<ut.length;tt+=1){var wt=ut[tt];u.push({sortKey:wt.sortKey,symbolInstanceStart:wt.symbolInstanceStart,symbolInstanceEnd:wt.symbolInstanceEnd,parameters:Ze})}else u.push({symbolInstanceStart:0,symbolInstanceEnd:S.symbolInstances.length,parameters:Ze})}},Bi.prototype.attemptAnchorPlacement=function(u,f,h,g,S,M,R,N,H,se,ge,we,Te,ze,De){var Ye,Le=[we.textOffset0,we.textOffset1],Ze=fi(u,h,g,Le,S),tt=this.collisionIndex.placeCollisionBox(fo(f,Ze.x,Ze.y,M,R,this.transform.angle),ge,N,H,se.predicate);if(!De||this.collisionIndex.placeCollisionBox(fo(De,Ze.x,Ze.y,M,R,this.transform.angle),ge,N,H,se.predicate).box.length!==0)return tt.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[we.crossTileID]&&this.prevPlacement.placements[we.crossTileID]&&this.prevPlacement.placements[we.crossTileID].text&&(Ye=this.prevPlacement.variableOffsets[we.crossTileID].anchor),this.variableOffsets[we.crossTileID]={textOffset:Le,width:h,height:g,anchor:u,textBoxScale:S,prevAnchor:Ye},this.markUsedJustification(Te,u,we,ze),Te.allowVerticalPlacement&&(this.markUsedOrientation(Te,ze,we),this.placedOrientations[we.crossTileID]=ze),{shift:Ze,placedGlyphBoxes:tt}):void 0},Bi.prototype.placeLayerBucketPart=function(u,f,h){var g=this,S=u.parameters,M=S.bucket,R=S.layout,N=S.posMatrix,H=S.textLabelPlaneMatrix,se=S.labelToScreenMatrix,ge=S.textPixelRatio,we=S.holdingForFade,Te=S.collisionBoxArray,ze=S.partiallyEvaluatedTextSize,De=S.collisionGroup,Ye=R.get("text-optional"),Le=R.get("icon-optional"),Ze=R.get("text-allow-overlap"),tt=R.get("icon-allow-overlap"),ut=R.get("text-rotation-alignment")==="map",wt=R.get("text-pitch-alignment")==="map",bt=R.get("icon-text-fit")!=="none",It=R.get("symbol-z-order")==="viewport-y",Dt=Ze&&(tt||!M.hasIconData()||Le),Gt=tt&&(Ze||!M.hasTextData()||Ye);!M.collisionArrays&&Te&&M.deserializeCollisionBoxes(Te);var Xt=function(ps,Ls){if(!f[ps.crossTileID])if(we)g.placements[ps.crossTileID]=new Ph(!1,!1,!1);else{var Qs,qs=!1,zs=!1,en=!0,Vs=null,ws={box:null,offscreen:null},ei={box:null,offscreen:null},$r=null,kr=null,oi=0,fr=0,ur=0;Ls.textFeatureIndex?oi=Ls.textFeatureIndex:ps.useRuntimeCollisionCircles&&(oi=ps.featureIndex),Ls.verticalTextFeatureIndex&&(fr=Ls.verticalTextFeatureIndex);var _o=Ls.textBox;if(_o){var lr=function(Ln){var qo=o.WritingMode.horizontal;if(M.allowVerticalPlacement&&!Ln&&g.prevPlacement){var io=g.prevPlacement.placedOrientations[ps.crossTileID];io&&(g.placedOrientations[ps.crossTileID]=io,g.markUsedOrientation(M,qo=io,ps))}return qo},qa=function(Ln,qo){if(M.allowVerticalPlacement&&ps.numVerticalGlyphVertices>0&&Ls.verticalTextBox)for(var io=0,Cl=M.writingModes;io<Cl.length&&(Cl[io]===o.WritingMode.vertical?(ws=qo(),ei=ws):ws=Ln(),!(ws&&ws.box&&ws.box.length));io+=1);else ws=Ln()};if(R.get("text-variable-anchor")){var go=R.get("text-variable-anchor");if(g.prevPlacement&&g.prevPlacement.variableOffsets[ps.crossTileID]){var Ra=g.prevPlacement.variableOffsets[ps.crossTileID];go.indexOf(Ra.anchor)>0&&(go=go.filter(function(Ln){return Ln!==Ra.anchor})).unshift(Ra.anchor)}var oa=function(Ln,qo,io){for(var Cl=Ln.x2-Ln.x1,Xg=Ln.y2-Ln.y1,Fu=ps.textBoxScale,Xm=bt&&!tt?qo:null,zu={box:[],offscreen:!1},wf=Ze?2*go.length:go.length,Il=0;Il<wf;++Il){var Jh=g.attemptAnchorPlacement(go[Il%go.length],Ln,Cl,Xg,Fu,ut,wt,ge,N,De,Il>=go.length,ps,M,io,Xm);if(Jh&&(zu=Jh.placedGlyphBoxes)&&zu.box&&zu.box.length){qs=!0,Vs=Jh.shift;break}}return zu};qa(function(){return oa(_o,Ls.iconBox,o.WritingMode.horizontal)},function(){var Ln=Ls.verticalTextBox;return M.allowVerticalPlacement&&!(ws&&ws.box&&ws.box.length)&&ps.numVerticalGlyphVertices>0&&Ln?oa(Ln,Ls.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null}}),ws&&(qs=ws.box,en=ws.offscreen);var tu=lr(ws&&ws.box);if(!qs&&g.prevPlacement){var Bu=g.prevPlacement.variableOffsets[ps.crossTileID];Bu&&(g.variableOffsets[ps.crossTileID]=Bu,g.markUsedJustification(M,Bu.anchor,ps,tu))}}else{var aa=function(Ln,qo){var io=g.collisionIndex.placeCollisionBox(Ln,Ze,ge,N,De.predicate);return io&&io.box&&io.box.length&&(g.markUsedOrientation(M,qo,ps),g.placedOrientations[ps.crossTileID]=qo),io};qa(function(){return aa(_o,o.WritingMode.horizontal)},function(){var Ln=Ls.verticalTextBox;return M.allowVerticalPlacement&&ps.numVerticalGlyphVertices>0&&Ln?aa(Ln,o.WritingMode.vertical):{box:null,offscreen:null}}),lr(ws&&ws.box&&ws.box.length)}}if(qs=(Qs=ws)&&Qs.box&&Qs.box.length>0,en=Qs&&Qs.offscreen,ps.useRuntimeCollisionCircles){var su=M.text.placedSymbolArray.get(ps.centerJustifiedTextSymbolIndex),$d=o.evaluateSizeForFeature(M.textSizeData,ze,su),Ha=R.get("text-padding");$r=g.collisionIndex.placeCollisionCircles(Ze,su,M.lineVertexArray,M.glyphOffsetArray,$d,N,H,se,h,wt,De.predicate,ps.collisionCircleDiameter,Ha),qs=Ze||$r.circles.length>0&&!$r.collisionDetected,en=en&&$r.offscreen}if(Ls.iconFeatureIndex&&(ur=Ls.iconFeatureIndex),Ls.iconBox){var wl=function(Ln){var qo=bt&&Vs?fo(Ln,Vs.x,Vs.y,ut,wt,g.transform.angle):Ln;return g.collisionIndex.placeCollisionBox(qo,tt,ge,N,De.predicate)};zs=ei&&ei.box&&ei.box.length&&Ls.verticalIconBox?(kr=wl(Ls.verticalIconBox)).box.length>0:(kr=wl(Ls.iconBox)).box.length>0,en=en&&kr.offscreen}var Ga=Ye||ps.numHorizontalGlyphVertices===0&&ps.numVerticalGlyphVertices===0,_i=Le||ps.numIconVertices===0;if(Ga||_i?_i?Ga||(zs=zs&&qs):qs=zs&&qs:zs=qs=zs&&qs,qs&&Qs&&Qs.box&&g.collisionIndex.insertCollisionBox(Qs.box,R.get("text-ignore-placement"),M.bucketInstanceId,ei&&ei.box&&fr?fr:oi,De.ID),zs&&kr&&g.collisionIndex.insertCollisionBox(kr.box,R.get("icon-ignore-placement"),M.bucketInstanceId,ur,De.ID),$r&&(qs&&g.collisionIndex.insertCollisionCircles($r.circles,R.get("text-ignore-placement"),M.bucketInstanceId,oi,De.ID),h)){var $a=M.bucketInstanceId,Sl=g.collisionCircleArrays[$a];Sl===void 0&&(Sl=g.collisionCircleArrays[$a]=new Qo);for(var nu=0;nu<$r.circles.length;nu+=4)Sl.circles.push($r.circles[nu+0]),Sl.circles.push($r.circles[nu+1]),Sl.circles.push($r.circles[nu+2]),Sl.circles.push($r.collisionDetected?1:0)}g.placements[ps.crossTileID]=new Ph(qs||Dt,zs||Gt,en||M.justReloaded),f[ps.crossTileID]=!0}};if(It)for(var as=M.getSortedSymbolIndexes(this.transform.angle),vs=as.length-1;vs>=0;--vs){var $s=as[vs];Xt(M.symbolInstances.get($s),M.collisionArrays[$s])}else for(var ks=u.symbolInstanceStart;ks<u.symbolInstanceEnd;ks++)Xt(M.symbolInstances.get(ks),M.collisionArrays[ks]);if(h&&M.bucketInstanceId in this.collisionCircleArrays){var xn=this.collisionCircleArrays[M.bucketInstanceId];o.invert(xn.invProjMatrix,N),xn.viewportMatrix=this.collisionIndex.getViewportMatrix()}M.justReloaded=!1},Bi.prototype.markUsedJustification=function(u,f,h,g){var S;S=g===o.WritingMode.vertical?h.verticalPlacedTextSymbolIndex:{left:h.leftJustifiedTextSymbolIndex,center:h.centerJustifiedTextSymbolIndex,right:h.rightJustifiedTextSymbolIndex}[o.getAnchorJustification(f)];for(var M=0,R=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex,h.verticalPlacedTextSymbolIndex];M<R.length;M+=1){var N=R[M];N>=0&&(u.text.placedSymbolArray.get(N).crossTileID=S>=0&&N!==S?0:h.crossTileID)}},Bi.prototype.markUsedOrientation=function(u,f,h){for(var g=f===o.WritingMode.horizontal||f===o.WritingMode.horizontalOnly?f:0,S=f===o.WritingMode.vertical?f:0,M=0,R=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex];M<R.length;M+=1)u.text.placedSymbolArray.get(R[M]).placedOrientation=g;h.verticalPlacedTextSymbolIndex&&(u.text.placedSymbolArray.get(h.verticalPlacedTextSymbolIndex).placedOrientation=S)},Bi.prototype.commit=function(u){this.commitTime=u,this.zoomAtLastRecencyCheck=this.transform.zoom;var f=this.prevPlacement,h=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;var g=f?f.symbolFadeChange(u):1,S=f?f.opacities:{},M=f?f.variableOffsets:{},R=f?f.placedOrientations:{};for(var N in this.placements){var H=this.placements[N],se=S[N];se?(this.opacities[N]=new Co(se,g,H.text,H.icon),h=h||H.text!==se.text.placed||H.icon!==se.icon.placed):(this.opacities[N]=new Co(null,g,H.text,H.icon,H.skipFade),h=h||H.text||H.icon)}for(var ge in S){var we=S[ge];if(!this.opacities[ge]){var Te=new Co(we,g,!1,!1);Te.isHidden()||(this.opacities[ge]=Te,h=h||we.text.placed||we.icon.placed)}}for(var ze in M)this.variableOffsets[ze]||!this.opacities[ze]||this.opacities[ze].isHidden()||(this.variableOffsets[ze]=M[ze]);for(var De in R)this.placedOrientations[De]||!this.opacities[De]||this.opacities[De].isHidden()||(this.placedOrientations[De]=R[De]);h?this.lastPlacementChangeTime=u:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:u)},Bi.prototype.updateLayerOpacities=function(u,f){for(var h={},g=0,S=f;g<S.length;g+=1){var M=S[g],R=M.getBucket(u);R&&M.latestFeatureIndex&&u.id===R.layerIds[0]&&this.updateBucketOpacities(R,h,M.collisionBoxArray)}},Bi.prototype.updateBucketOpacities=function(u,f,h){var g=this;u.hasTextData()&&u.text.opacityVertexArray.clear(),u.hasIconData()&&u.icon.opacityVertexArray.clear(),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexArray.clear(),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexArray.clear();var S=u.layers[0].layout,M=new Co(null,0,!1,!1,!0),R=S.get("text-allow-overlap"),N=S.get("icon-allow-overlap"),H=S.get("text-variable-anchor"),se=S.get("text-rotation-alignment")==="map",ge=S.get("text-pitch-alignment")==="map",we=S.get("icon-text-fit")!=="none",Te=new Co(null,0,R&&(N||!u.hasIconData()||S.get("icon-optional")),N&&(R||!u.hasTextData()||S.get("text-optional")),!0);!u.collisionArrays&&h&&(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData())&&u.deserializeCollisionBoxes(h);for(var ze=function(Ze,tt,ut){for(var wt=0;wt<tt/4;wt++)Ze.opacityVertexArray.emplaceBack(ut)},De=function(Ze){var tt=u.symbolInstances.get(Ze),ut=tt.numHorizontalGlyphVertices,wt=tt.numVerticalGlyphVertices,bt=tt.crossTileID,It=g.opacities[bt];f[bt]?It=M:It||(g.opacities[bt]=It=Te),f[bt]=!0;var Dt=tt.numIconVertices>0,Gt=g.placedOrientations[tt.crossTileID],Xt=Gt===o.WritingMode.vertical,as=Gt===o.WritingMode.horizontal||Gt===o.WritingMode.horizontalOnly;if(ut>0||wt>0){var vs=Fm(It.text);ze(u.text,ut,Xt?jc:vs),ze(u.text,wt,as?jc:vs);var $s=It.text.isHidden();[tt.rightJustifiedTextSymbolIndex,tt.centerJustifiedTextSymbolIndex,tt.leftJustifiedTextSymbolIndex].forEach(function(ws){ws>=0&&(u.text.placedSymbolArray.get(ws).hidden=$s||Xt?1:0)}),tt.verticalPlacedTextSymbolIndex>=0&&(u.text.placedSymbolArray.get(tt.verticalPlacedTextSymbolIndex).hidden=$s||as?1:0);var ks=g.variableOffsets[tt.crossTileID];ks&&g.markUsedJustification(u,ks.anchor,tt,Gt);var xn=g.placedOrientations[tt.crossTileID];xn&&(g.markUsedJustification(u,"left",tt,xn),g.markUsedOrientation(u,xn,tt))}if(Dt){var ps=Fm(It.icon),Ls=!(we&&tt.verticalPlacedIconSymbolIndex&&Xt);tt.placedIconSymbolIndex>=0&&(ze(u.icon,tt.numIconVertices,Ls?ps:jc),u.icon.placedSymbolArray.get(tt.placedIconSymbolIndex).hidden=It.icon.isHidden()),tt.verticalPlacedIconSymbolIndex>=0&&(ze(u.icon,tt.numVerticalIconVertices,Ls?jc:ps),u.icon.placedSymbolArray.get(tt.verticalPlacedIconSymbolIndex).hidden=It.icon.isHidden())}if(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData()){var Qs=u.collisionArrays[Ze];if(Qs){var qs=new o.Point(0,0);if(Qs.textBox||Qs.verticalTextBox){var zs=!0;if(H){var en=g.variableOffsets[bt];en?(qs=fi(en.anchor,en.width,en.height,en.textOffset,en.textBoxScale),se&&qs._rotate(ge?g.transform.angle:-g.transform.angle)):zs=!1}Qs.textBox&&jl(u.textCollisionBox.collisionVertexArray,It.text.placed,!zs||Xt,qs.x,qs.y),Qs.verticalTextBox&&jl(u.textCollisionBox.collisionVertexArray,It.text.placed,!zs||as,qs.x,qs.y)}var Vs=Boolean(!as&&Qs.verticalIconBox);Qs.iconBox&&jl(u.iconCollisionBox.collisionVertexArray,It.icon.placed,Vs,we?qs.x:0,we?qs.y:0),Qs.verticalIconBox&&jl(u.iconCollisionBox.collisionVertexArray,It.icon.placed,!Vs,we?qs.x:0,we?qs.y:0)}}},Ye=0;Ye<u.symbolInstances.length;Ye++)De(Ye);if(u.sortFeatures(this.transform.angle),this.retainedQueryData[u.bucketInstanceId]&&(this.retainedQueryData[u.bucketInstanceId].featureSortOrder=u.featureSortOrder),u.hasTextData()&&u.text.opacityVertexBuffer&&u.text.opacityVertexBuffer.updateData(u.text.opacityVertexArray),u.hasIconData()&&u.icon.opacityVertexBuffer&&u.icon.opacityVertexBuffer.updateData(u.icon.opacityVertexArray),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexBuffer&&u.iconCollisionBox.collisionVertexBuffer.updateData(u.iconCollisionBox.collisionVertexArray),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexBuffer&&u.textCollisionBox.collisionVertexBuffer.updateData(u.textCollisionBox.collisionVertexArray),u.bucketInstanceId in this.collisionCircleArrays){var Le=this.collisionCircleArrays[u.bucketInstanceId];u.placementInvProjMatrix=Le.invProjMatrix,u.placementViewportMatrix=Le.viewportMatrix,u.collisionCircleArray=Le.circles,delete this.collisionCircleArrays[u.bucketInstanceId]}},Bi.prototype.symbolFadeChange=function(u){return this.fadeDuration===0?1:(u-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Bi.prototype.zoomAdjustment=function(u){return Math.max(0,(this.transform.zoom-u)/1.5)},Bi.prototype.hasTransitions=function(u){return this.stale||u-this.lastPlacementChangeTime<this.fadeDuration},Bi.prototype.stillRecent=function(u,f){var h=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*h>u},Bi.prototype.setStale=function(){this.stale=!0};var Hg=Math.pow(2,25),Nm=Math.pow(2,24),Rh=Math.pow(2,17),Dm=Math.pow(2,16),nf=Math.pow(2,9),Gg=Math.pow(2,8),Bm=Math.pow(2,1);function Fm(u){if(u.opacity===0&&!u.placed)return 0;if(u.opacity===1&&u.placed)return 4294967295;var f=u.placed?1:0,h=Math.floor(127*u.opacity);return h*Hg+f*Nm+h*Rh+f*Dm+h*nf+f*Gg+h*Bm+f}var jc=0,rf=function(u){this._sortAcrossTiles=u.layout.get("symbol-z-order")!=="viewport-y"&&u.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};rf.prototype.continuePlacement=function(u,f,h,g,S){for(var M=this._bucketParts;this._currentTileIndex<u.length;)if(f.getBucketParts(M,g,u[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,S())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,M.sort(function(R,N){return R.sortKey-N.sortKey}));this._currentPartIndex<M.length;)if(f.placeLayerBucketPart(M[this._currentPartIndex],this._seenCrossTileIDs,h),this._currentPartIndex++,S())return!0;return!1};var xd=function(u,f,h,g,S,M,R){this.placement=new Bi(u,S,M,R),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=g,this._done=!1};xd.prototype.isDone=function(){return this._done},xd.prototype.continuePlacement=function(u,f,h){for(var g=this,S=o.browser.now(),M=function(){var H=o.browser.now()-S;return!g._forceFullPlacement&&H>2};this._currentPlacementIndex>=0;){var R=f[u[this._currentPlacementIndex]],N=this.placement.collisionIndex.transform.zoom;if(R.type==="symbol"&&(!R.minzoom||R.minzoom<=N)&&(!R.maxzoom||R.maxzoom>N)){if(this._inProgressLayer||(this._inProgressLayer=new rf(R)),this._inProgressLayer.continuePlacement(h[R.source],this.placement,this._showCollisionBoxes,R,M))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},xd.prototype.commit=function(u){return this.placement.commit(u),this.placement};var zm=512/o.EXTENT/2,$h=function(u,f,h){this.tileID=u,this.indexedSymbolInstances={},this.bucketInstanceId=h;for(var g=0;g<f.length;g++){var S=f.get(g),M=S.key;this.indexedSymbolInstances[M]||(this.indexedSymbolInstances[M]=[]),this.indexedSymbolInstances[M].push({crossTileID:S.crossTileID,coord:this.getScaledCoordinates(S,u)})}};$h.prototype.getScaledCoordinates=function(u,f){var h=zm/Math.pow(2,f.canonical.z-this.tileID.canonical.z);return{x:Math.floor((f.canonical.x*o.EXTENT+u.anchorX)*h),y:Math.floor((f.canonical.y*o.EXTENT+u.anchorY)*h)}},$h.prototype.findMatches=function(u,f,h){for(var g=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z),S=0;S<u.length;S++){var M=u.get(S);if(!M.crossTileID){var R=this.indexedSymbolInstances[M.key];if(R)for(var N=this.getScaledCoordinates(M,f),H=0,se=R;H<se.length;H+=1){var ge=se[H];if(Math.abs(ge.coord.x-N.x)<=g&&Math.abs(ge.coord.y-N.y)<=g&&!h[ge.crossTileID]){h[ge.crossTileID]=!0,M.crossTileID=ge.crossTileID;break}}}}};var Io=function(){this.maxCrossTileID=0};Io.prototype.generate=function(){return++this.maxCrossTileID};var ql=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};ql.prototype.handleWrapJump=function(u){var f=Math.round((u-this.lng)/360);if(f!==0)for(var h in this.indexes){var g=this.indexes[h],S={};for(var M in g){var R=g[M];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+f),S[R.tileID.key]=R}this.indexes[h]=S}this.lng=u},ql.prototype.addBucket=function(u,f,h){if(this.indexes[u.overscaledZ]&&this.indexes[u.overscaledZ][u.key]){if(this.indexes[u.overscaledZ][u.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(u.overscaledZ,this.indexes[u.overscaledZ][u.key])}for(var g=0;g<f.symbolInstances.length;g++)f.symbolInstances.get(g).crossTileID=0;this.usedCrossTileIDs[u.overscaledZ]||(this.usedCrossTileIDs[u.overscaledZ]={});var S=this.usedCrossTileIDs[u.overscaledZ];for(var M in this.indexes){var R=this.indexes[M];if(Number(M)>u.overscaledZ)for(var N in R){var H=R[N];H.tileID.isChildOf(u)&&H.findMatches(f.symbolInstances,u,S)}else{var se=R[u.scaledTo(Number(M)).key];se&&se.findMatches(f.symbolInstances,u,S)}}for(var ge=0;ge<f.symbolInstances.length;ge++){var we=f.symbolInstances.get(ge);we.crossTileID||(we.crossTileID=h.generate(),S[we.crossTileID]=!0)}return this.indexes[u.overscaledZ]===void 0&&(this.indexes[u.overscaledZ]={}),this.indexes[u.overscaledZ][u.key]=new $h(u,f.symbolInstances,f.bucketInstanceId),!0},ql.prototype.removeBucketCrossTileIDs=function(u,f){for(var h in f.indexedSymbolInstances)for(var g=0,S=f.indexedSymbolInstances[h];g<S.length;g+=1)delete this.usedCrossTileIDs[u][S[g].crossTileID]},ql.prototype.removeStaleBuckets=function(u){var f=!1;for(var h in this.indexes){var g=this.indexes[h];for(var S in g)u[g[S].bucketInstanceId]||(this.removeBucketCrossTileIDs(h,g[S]),delete g[S],f=!0)}return f};var Hl=function(){this.layerIndexes={},this.crossTileIDs=new Io,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Hl.prototype.addLayer=function(u,f,h){var g=this.layerIndexes[u.id];g===void 0&&(g=this.layerIndexes[u.id]=new ql);var S=!1,M={};g.handleWrapJump(h);for(var R=0,N=f;R<N.length;R+=1){var H=N[R],se=H.getBucket(u);se&&u.id===se.layerIds[0]&&(se.bucketInstanceId||(se.bucketInstanceId=++this.maxBucketInstanceId),g.addBucket(H.tileID,se,this.crossTileIDs)&&(S=!0),M[se.bucketInstanceId]=!0)}return g.removeStaleBuckets(M)&&(S=!0),S},Hl.prototype.pruneUnusedLayers=function(u){var f={};for(var h in u.forEach(function(g){f[g]=!0}),this.layerIndexes)f[h]||delete this.layerIndexes[h]};var qc=function(u,f){return o.emitValidationErrors(u,f&&f.filter(function(h){return h.identifier!=="source.canvas"}))},Gl=o.pick(is,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Wl=o.pick(is,["setCenter","setZoom","setBearing","setPitch"]),pr=function(){var u={},f=o.styleSpec.$version;for(var h in o.styleSpec.$root){var g,S=o.styleSpec.$root[h];S.required&&(g=h==="version"?f:S.type==="array"?[]:{})!=null&&(u[h]=g)}return u}(),Cn=function(u){function f(h,g){var S=this;g===void 0&&(g={}),u.call(this),this.map=h,this.dispatcher=new vt(At(),this),this.imageManager=new re,this.imageManager.setEventedParent(this),this.glyphManager=new ne(h._requestManager,g.localIdeographFontFamily),this.lineAtlas=new Me(256,512),this.crossTileSymbolIndex=new Hl,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());var M=this;this._rtlTextPluginCallback=f.registerForPluginStateChange(function(R){M.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:R.pluginStatus,pluginURL:R.pluginURL},function(N,H){if(o.triggerPluginCompletionEvent(N),H&&H.every(function(ge){return ge}))for(var se in M.sourceCaches)M.sourceCaches[se].reload()})}),this.on("data",function(R){if(R.dataType==="source"&&R.sourceDataType==="metadata"){var N=S.sourceCaches[R.sourceId];if(N){var H=N.getSource();if(H&&H.vectorLayerIds)for(var se in S._layers){var ge=S._layers[se];ge.source===H.id&&S._validateLayer(ge)}}}})}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.loadURL=function(h,g){var S=this;g===void 0&&(g={}),this.fire(new o.Event("dataloading",{dataType:"style"}));var M=typeof g.validate=="boolean"?g.validate:!o.isMapboxURL(h);h=this.map._requestManager.normalizeStyleURL(h,g.accessToken);var R=this.map._requestManager.transformRequest(h,o.ResourceType.Style);this._request=o.getJSON(R,function(N,H){S._request=null,N?S.fire(new o.ErrorEvent(N)):H&&S._load(H,M)})},f.prototype.loadJSON=function(h,g){var S=this;g===void 0&&(g={}),this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.browser.frame(function(){S._request=null,S._load(h,g.validate!==!1)})},f.prototype.loadEmpty=function(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(pr,!1)},f.prototype._load=function(h,g){if(!g||!qc(this,o.validateStyle(h))){for(var S in this._loaded=!0,this.stylesheet=h,h.sources)this.addSource(S,h.sources[S],{validate:!1});h.sprite?this._loadSprite(h.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(h.glyphs);var M=ns(this.stylesheet.layers);this._order=M.map(function(se){return se.id}),this._layers={},this._serializedLayers={};for(var R=0,N=M;R<N.length;R+=1){var H=N[R];(H=o.createStyleLayer(H)).setEventedParent(this,{layer:{id:H.id}}),this._layers[H.id]=H,this._serializedLayers[H.id]=H.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Qe(this.stylesheet.light),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}},f.prototype._loadSprite=function(h){var g=this;this._spriteRequest=function(S,M,R){var N,H,se,ge=o.browser.devicePixelRatio>1?"@2x":"",we=o.getJSON(M.transformRequest(M.normalizeSpriteURL(S,ge,".json"),o.ResourceType.SpriteJSON),function(De,Ye){we=null,se||(se=De,N=Ye,ze())}),Te=o.getImage(M.transformRequest(M.normalizeSpriteURL(S,ge,".png"),o.ResourceType.SpriteImage),function(De,Ye){Te=null,se||(se=De,H=Ye,ze())});function ze(){if(se)R(se);else if(N&&H){var De=o.browser.getImageData(H),Ye={};for(var Le in N){var Ze=N[Le],tt=Ze.width,ut=Ze.height,wt=Ze.x,bt=Ze.y,It=Ze.sdf,Dt=Ze.pixelRatio,Gt=Ze.stretchX,Xt=Ze.stretchY,as=Ze.content,vs=new o.RGBAImage({width:tt,height:ut});o.RGBAImage.copy(De,vs,{x:wt,y:bt},{x:0,y:0},{width:tt,height:ut}),Ye[Le]={data:vs,pixelRatio:Dt,sdf:It,stretchX:Gt,stretchY:Xt,content:as}}R(null,Ye)}}return{cancel:function(){we&&(we.cancel(),we=null),Te&&(Te.cancel(),Te=null)}}}(h,this.map._requestManager,function(S,M){if(g._spriteRequest=null,S)g.fire(new o.ErrorEvent(S));else if(M)for(var R in M)g.imageManager.addImage(R,M[R]);g.imageManager.setLoaded(!0),g._availableImages=g.imageManager.listImages(),g.dispatcher.broadcast("setImages",g._availableImages),g.fire(new o.Event("data",{dataType:"style"}))})},f.prototype._validateLayer=function(h){var g=this.sourceCaches[h.source];if(g){var S=h.sourceLayer;if(S){var M=g.getSource();(M.type==="geojson"||M.vectorLayerIds&&M.vectorLayerIds.indexOf(S)===-1)&&this.fire(new o.ErrorEvent(new Error('Source layer "'+S+'" does not exist on source "'+M.id+'" as specified by style layer "'+h.id+'"')))}}},f.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var h in this.sourceCaches)if(!this.sourceCaches[h].loaded())return!1;return!!this.imageManager.isLoaded()},f.prototype._serializeLayers=function(h){for(var g=[],S=0,M=h;S<M.length;S+=1){var R=this._layers[M[S]];R.type!=="custom"&&g.push(R.serialize())}return g},f.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var h in this.sourceCaches)if(this.sourceCaches[h].hasTransition())return!0;for(var g in this._layers)if(this._layers[g].hasTransition())return!0;return!1},f.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},f.prototype.update=function(h){if(this._loaded){var g=this._changed;if(this._changed){var S=Object.keys(this._updatedLayers),M=Object.keys(this._removedLayers);for(var R in(S.length||M.length)&&this._updateWorkerLayers(S,M),this._updatedSources){var N=this._updatedSources[R];N==="reload"?this._reloadSource(R):N==="clear"&&this._clearSource(R)}for(var H in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[H].updateTransitions(h);this.light.updateTransitions(h),this._resetUpdates()}var se={};for(var ge in this.sourceCaches){var we=this.sourceCaches[ge];se[ge]=we.used,we.used=!1}for(var Te=0,ze=this._order;Te<ze.length;Te+=1){var De=this._layers[ze[Te]];De.recalculate(h,this._availableImages),!De.isHidden(h.zoom)&&De.source&&(this.sourceCaches[De.source].used=!0)}for(var Ye in se){var Le=this.sourceCaches[Ye];se[Ye]!==Le.used&&Le.fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Ye}))}this.light.recalculate(h),this.z=h.zoom,g&&this.fire(new o.Event("data",{dataType:"style"}))}},f.prototype._updateTilesForChangedImages=function(){var h=Object.keys(this._changedImages);if(h.length){for(var g in this.sourceCaches)this.sourceCaches[g].reloadTilesForDependencies(["icons","patterns"],h);this._changedImages={}}},f.prototype._updateWorkerLayers=function(h,g){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(h),removedIds:g})},f.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},f.prototype.setState=function(h){var g=this;if(this._checkLoaded(),qc(this,o.validateStyle(h)))return!1;(h=o.clone$1(h)).layers=ns(h.layers);var S=function(R,N){if(!R)return[{command:is.setStyle,args:[N]}];var H=[];try{if(!o.deepEqual(R.version,N.version))return[{command:is.setStyle,args:[N]}];o.deepEqual(R.center,N.center)||H.push({command:is.setCenter,args:[N.center]}),o.deepEqual(R.zoom,N.zoom)||H.push({command:is.setZoom,args:[N.zoom]}),o.deepEqual(R.bearing,N.bearing)||H.push({command:is.setBearing,args:[N.bearing]}),o.deepEqual(R.pitch,N.pitch)||H.push({command:is.setPitch,args:[N.pitch]}),o.deepEqual(R.sprite,N.sprite)||H.push({command:is.setSprite,args:[N.sprite]}),o.deepEqual(R.glyphs,N.glyphs)||H.push({command:is.setGlyphs,args:[N.glyphs]}),o.deepEqual(R.transition,N.transition)||H.push({command:is.setTransition,args:[N.transition]}),o.deepEqual(R.light,N.light)||H.push({command:is.setLight,args:[N.light]});var se={},ge=[];(function(Te,ze,De,Ye){var Le;for(Le in ze=ze||{},Te=Te||{})Te.hasOwnProperty(Le)&&(ze.hasOwnProperty(Le)||hs(Le,De,Ye));for(Le in ze)ze.hasOwnProperty(Le)&&(Te.hasOwnProperty(Le)?o.deepEqual(Te[Le],ze[Le])||(Te[Le].type==="geojson"&&ze[Le].type==="geojson"&&Fn(Te,ze,Le)?De.push({command:is.setGeoJSONSourceData,args:[Le,ze[Le].data]}):mn(Le,ze,De,Ye)):rn(Le,ze,De))})(R.sources,N.sources,ge,se);var we=[];R.layers&&R.layers.forEach(function(Te){se[Te.source]?H.push({command:is.removeLayer,args:[Te.id]}):we.push(Te)}),H=H.concat(ge),function(Te,ze,De){ze=ze||[];var Ye,Le,Ze,tt,ut,wt,bt,It=(Te=Te||[]).map(Sn),Dt=ze.map(Sn),Gt=Te.reduce(bn,{}),Xt=ze.reduce(bn,{}),as=It.slice(),vs=Object.create(null);for(Ye=0,Le=0;Ye<It.length;Ye++)Xt.hasOwnProperty(Ze=It[Ye])?Le++:(De.push({command:is.removeLayer,args:[Ze]}),as.splice(as.indexOf(Ze,Le),1));for(Ye=0,Le=0;Ye<Dt.length;Ye++)as[as.length-1-Ye]!==(Ze=Dt[Dt.length-1-Ye])&&(Gt.hasOwnProperty(Ze)?(De.push({command:is.removeLayer,args:[Ze]}),as.splice(as.lastIndexOf(Ze,as.length-Le),1)):Le++,De.push({command:is.addLayer,args:[Xt[Ze],wt=as[as.length-Ye]]}),as.splice(as.length-Ye,0,Ze),vs[Ze]=!0);for(Ye=0;Ye<Dt.length;Ye++)if(tt=Gt[Ze=Dt[Ye]],ut=Xt[Ze],!vs[Ze]&&!o.deepEqual(tt,ut))if(o.deepEqual(tt.source,ut.source)&&o.deepEqual(tt["source-layer"],ut["source-layer"])&&o.deepEqual(tt.type,ut.type)){for(bt in hn(tt.layout,ut.layout,De,Ze,null,is.setLayoutProperty),hn(tt.paint,ut.paint,De,Ze,null,is.setPaintProperty),o.deepEqual(tt.filter,ut.filter)||De.push({command:is.setFilter,args:[Ze,ut.filter]}),o.deepEqual(tt.minzoom,ut.minzoom)&&o.deepEqual(tt.maxzoom,ut.maxzoom)||De.push({command:is.setLayerZoomRange,args:[Ze,ut.minzoom,ut.maxzoom]}),tt)tt.hasOwnProperty(bt)&&bt!=="layout"&&bt!=="paint"&&bt!=="filter"&&bt!=="metadata"&&bt!=="minzoom"&&bt!=="maxzoom"&&(bt.indexOf("paint.")===0?hn(tt[bt],ut[bt],De,Ze,bt.slice(6),is.setPaintProperty):o.deepEqual(tt[bt],ut[bt])||De.push({command:is.setLayerProperty,args:[Ze,bt,ut[bt]]}));for(bt in ut)ut.hasOwnProperty(bt)&&!tt.hasOwnProperty(bt)&&bt!=="layout"&&bt!=="paint"&&bt!=="filter"&&bt!=="metadata"&&bt!=="minzoom"&&bt!=="maxzoom"&&(bt.indexOf("paint.")===0?hn(tt[bt],ut[bt],De,Ze,bt.slice(6),is.setPaintProperty):o.deepEqual(tt[bt],ut[bt])||De.push({command:is.setLayerProperty,args:[Ze,bt,ut[bt]]}))}else De.push({command:is.removeLayer,args:[Ze]}),wt=as[as.lastIndexOf(Ze)+1],De.push({command:is.addLayer,args:[ut,wt]})}(we,N.layers,H)}catch(Te){console.warn("Unable to compute style diff:",Te),H=[{command:is.setStyle,args:[N]}]}return H}(this.serialize(),h).filter(function(R){return!(R.command in Wl)});if(S.length===0)return!1;var M=S.filter(function(R){return!(R.command in Gl)});if(M.length>0)throw new Error("Unimplemented: "+M.map(function(R){return R.command}).join(", ")+".");return S.forEach(function(R){R.command!=="setTransition"&&g[R.command].apply(g,R.args)}),this.stylesheet=h,!0},f.prototype.addImage=function(h,g){if(this.getImage(h))return this.fire(new o.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(h,g),this._afterImageUpdated(h)},f.prototype.updateImage=function(h,g){this.imageManager.updateImage(h,g)},f.prototype.getImage=function(h){return this.imageManager.getImage(h)},f.prototype.removeImage=function(h){if(!this.getImage(h))return this.fire(new o.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(h),this._afterImageUpdated(h)},f.prototype._afterImageUpdated=function(h){this._availableImages=this.imageManager.listImages(),this._changedImages[h]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))},f.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},f.prototype.addSource=function(h,g,S){var M=this;if(S===void 0&&(S={}),this._checkLoaded(),this.sourceCaches[h]!==void 0)throw new Error("There is already a source with this ID");if(!g.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(g).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(g.type)>=0&&this._validate(o.validateStyle.source,"sources."+h,g,null,S))){this.map&&this.map._collectResourceTiming&&(g.collectResourceTiming=!0);var R=this.sourceCaches[h]=new Ve(h,g,this.dispatcher);R.style=this,R.setEventedParent(this,function(){return{isSourceLoaded:M.loaded(),source:R.serialize(),sourceId:h}}),R.onAdd(this.map),this._changed=!0}},f.prototype.removeSource=function(h){if(this._checkLoaded(),this.sourceCaches[h]===void 0)throw new Error("There is no source with this ID");for(var g in this._layers)if(this._layers[g].source===h)return this.fire(new o.ErrorEvent(new Error('Source "'+h+'" cannot be removed while layer "'+g+'" is using it.')));var S=this.sourceCaches[h];delete this.sourceCaches[h],delete this._updatedSources[h],S.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:h})),S.setEventedParent(null),S.clearTiles(),S.onRemove&&S.onRemove(this.map),this._changed=!0},f.prototype.setGeoJSONSourceData=function(h,g){this._checkLoaded(),this.sourceCaches[h].getSource().setData(g),this._changed=!0},f.prototype.getSource=function(h){return this.sourceCaches[h]&&this.sourceCaches[h].getSource()},f.prototype.addLayer=function(h,g,S){S===void 0&&(S={}),this._checkLoaded();var M=h.id;if(this.getLayer(M))this.fire(new o.ErrorEvent(new Error('Layer with id "'+M+'" already exists on this map')));else{var R;if(h.type==="custom"){if(qc(this,o.validateCustomStyleLayer(h)))return;R=o.createStyleLayer(h)}else{if(typeof h.source=="object"&&(this.addSource(M,h.source),h=o.clone$1(h),h=o.extend(h,{source:M})),this._validate(o.validateStyle.layer,"layers."+M,h,{arrayIndex:-1},S))return;R=o.createStyleLayer(h),this._validateLayer(R),R.setEventedParent(this,{layer:{id:M}}),this._serializedLayers[R.id]=R.serialize()}var N=g?this._order.indexOf(g):this._order.length;if(g&&N===-1)this.fire(new o.ErrorEvent(new Error('Layer with id "'+g+'" does not exist on this map.')));else{if(this._order.splice(N,0,M),this._layerOrderChanged=!0,this._layers[M]=R,this._removedLayers[M]&&R.source&&R.type!=="custom"){var H=this._removedLayers[M];delete this._removedLayers[M],H.type!==R.type?this._updatedSources[R.source]="clear":(this._updatedSources[R.source]="reload",this.sourceCaches[R.source].pause())}this._updateLayer(R),R.onAdd&&R.onAdd(this.map)}}},f.prototype.moveLayer=function(h,g){if(this._checkLoaded(),this._changed=!0,this._layers[h]){if(h!==g){var S=this._order.indexOf(h);this._order.splice(S,1);var M=g?this._order.indexOf(g):this._order.length;g&&M===-1?this.fire(new o.ErrorEvent(new Error('Layer with id "'+g+'" does not exist on this map.'))):(this._order.splice(M,0,h),this._layerOrderChanged=!0)}}else this.fire(new o.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be moved.")))},f.prototype.removeLayer=function(h){this._checkLoaded();var g=this._layers[h];if(g){g.setEventedParent(null);var S=this._order.indexOf(h);this._order.splice(S,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[h]=g,delete this._layers[h],delete this._serializedLayers[h],delete this._updatedLayers[h],delete this._updatedPaintProps[h],g.onRemove&&g.onRemove(this.map)}else this.fire(new o.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be removed.")))},f.prototype.getLayer=function(h){return this._layers[h]},f.prototype.hasLayer=function(h){return h in this._layers},f.prototype.setLayerZoomRange=function(h,g,S){this._checkLoaded();var M=this.getLayer(h);M?M.minzoom===g&&M.maxzoom===S||(g!=null&&(M.minzoom=g),S!=null&&(M.maxzoom=S),this._updateLayer(M)):this.fire(new o.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot have zoom extent.")))},f.prototype.setFilter=function(h,g,S){S===void 0&&(S={}),this._checkLoaded();var M=this.getLayer(h);if(M){if(!o.deepEqual(M.filter,g))return g==null?(M.filter=void 0,void this._updateLayer(M)):void(this._validate(o.validateStyle.filter,"layers."+M.id+".filter",g,null,S)||(M.filter=o.clone$1(g),this._updateLayer(M)))}else this.fire(new o.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be filtered.")))},f.prototype.getFilter=function(h){return o.clone$1(this.getLayer(h).filter)},f.prototype.setLayoutProperty=function(h,g,S,M){M===void 0&&(M={}),this._checkLoaded();var R=this.getLayer(h);R?o.deepEqual(R.getLayoutProperty(g),S)||(R.setLayoutProperty(g,S,M),this._updateLayer(R)):this.fire(new o.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be styled.")))},f.prototype.getLayoutProperty=function(h,g){var S=this.getLayer(h);if(S)return S.getLayoutProperty(g);this.fire(new o.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style.")))},f.prototype.setPaintProperty=function(h,g,S,M){M===void 0&&(M={}),this._checkLoaded();var R=this.getLayer(h);R?o.deepEqual(R.getPaintProperty(g),S)||(R.setPaintProperty(g,S,M)&&this._updateLayer(R),this._changed=!0,this._updatedPaintProps[h]=!0):this.fire(new o.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be styled.")))},f.prototype.getPaintProperty=function(h,g){return this.getLayer(h).getPaintProperty(g)},f.prototype.setFeatureState=function(h,g){this._checkLoaded();var S=h.source,M=h.sourceLayer,R=this.sourceCaches[S];if(R!==void 0){var N=R.getSource().type;N==="geojson"&&M?this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):N!=="vector"||M?(h.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),R.setFeatureState(M,h.id,g)):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+S+"' does not exist in the map's style.")))},f.prototype.removeFeatureState=function(h,g){this._checkLoaded();var S=h.source,M=this.sourceCaches[S];if(M!==void 0){var R=M.getSource().type,N=R==="vector"?h.sourceLayer:void 0;R!=="vector"||N?g&&typeof h.id!="string"&&typeof h.id!="number"?this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):M.removeFeatureState(N,h.id,g):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+S+"' does not exist in the map's style.")))},f.prototype.getFeatureState=function(h){this._checkLoaded();var g=h.source,S=h.sourceLayer,M=this.sourceCaches[g];if(M!==void 0){if(M.getSource().type!=="vector"||S)return h.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),M.getFeatureState(S,h.id);this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+g+"' does not exist in the map's style.")))},f.prototype.getTransition=function(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},f.prototype.serialize=function(){return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:o.mapObject(this.sourceCaches,function(h){return h.serialize()}),layers:this._serializeLayers(this._order)},function(h){return h!==void 0})},f.prototype._updateLayer=function(h){this._updatedLayers[h.id]=!0,h.source&&!this._updatedSources[h.source]&&this.sourceCaches[h.source].getSource().type!=="raster"&&(this._updatedSources[h.source]="reload",this.sourceCaches[h.source].pause()),this._changed=!0},f.prototype._flattenAndSortRenderedFeatures=function(h){for(var g=this,S=function(Gt){return g._layers[Gt].type==="fill-extrusion"},M={},R=[],N=this._order.length-1;N>=0;N--){var H=this._order[N];if(S(H)){M[H]=N;for(var se=0,ge=h;se<ge.length;se+=1){var we=ge[se][H];if(we)for(var Te=0,ze=we;Te<ze.length;Te+=1)R.push(ze[Te])}}}R.sort(function(Gt,Xt){return Xt.intersectionZ-Gt.intersectionZ});for(var De=[],Ye=this._order.length-1;Ye>=0;Ye--){var Le=this._order[Ye];if(S(Le))for(var Ze=R.length-1;Ze>=0;Ze--){var tt=R[Ze].feature;if(M[tt.layer.id]<Ye)break;De.push(tt),R.pop()}else for(var ut=0,wt=h;ut<wt.length;ut+=1){var bt=wt[ut][Le];if(bt)for(var It=0,Dt=bt;It<Dt.length;It+=1)De.push(Dt[It].feature)}}return De},f.prototype.queryRenderedFeatures=function(h,g,S){g&&g.filter&&this._validate(o.validateStyle.filter,"queryRenderedFeatures.filter",g.filter,null,g);var M={};if(g&&g.layers){if(!Array.isArray(g.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var R=0,N=g.layers;R<N.length;R+=1){var H=N[R],se=this._layers[H];if(!se)return this.fire(new o.ErrorEvent(new Error("The layer '"+H+"' does not exist in the map's style and cannot be queried for features."))),[];M[se.source]=!0}}var ge=[];for(var we in g.availableImages=this._availableImages,this.sourceCaches)g.layers&&!M[we]||ge.push(qe(this.sourceCaches[we],this._layers,this._serializedLayers,h,g,S));return this.placement&&ge.push(function(Te,ze,De,Ye,Le,Ze,tt){for(var ut={},wt=Ze.queryRenderedSymbols(Ye),bt=[],It=0,Dt=Object.keys(wt).map(Number);It<Dt.length;It+=1)bt.push(tt[Dt[It]]);bt.sort(ct);for(var Gt=function(){var ks=as[Xt],xn=ks.featureIndex.lookupSymbolFeatures(wt[ks.bucketInstanceId],ze,ks.bucketIndex,ks.sourceLayerIndex,Le.filter,Le.layers,Le.availableImages,Te);for(var ps in xn){var Ls=ut[ps]=ut[ps]||[],Qs=xn[ps];Qs.sort(function(en,Vs){var ws=ks.featureSortOrder;if(ws){var ei=ws.indexOf(en.featureIndex);return ws.indexOf(Vs.featureIndex)-ei}return Vs.featureIndex-en.featureIndex});for(var qs=0,zs=Qs;qs<zs.length;qs+=1)Ls.push(zs[qs])}},Xt=0,as=bt;Xt<as.length;Xt+=1)Gt();var vs=function(ks){ut[ks].forEach(function(xn){var ps=xn.feature,Ls=De[Te[ks].source].getFeatureState(ps.layer["source-layer"],ps.id);ps.source=ps.layer.source,ps.layer["source-layer"]&&(ps.sourceLayer=ps.layer["source-layer"]),ps.state=Ls})};for(var $s in ut)vs($s);return ut}(this._layers,this._serializedLayers,this.sourceCaches,h,g,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(ge)},f.prototype.querySourceFeatures=function(h,g){g&&g.filter&&this._validate(o.validateStyle.filter,"querySourceFeatures.filter",g.filter,null,g);var S=this.sourceCaches[h];return S?function(M,R){for(var N=M.getRenderableIds().map(function(ze){return M.getTileByID(ze)}),H=[],se={},ge=0;ge<N.length;ge++){var we=N[ge],Te=we.tileID.canonical.key;se[Te]||(se[Te]=!0,we.querySourceFeatures(H,R))}return H}(S,g):[]},f.prototype.addSourceType=function(h,g,S){return f.getSourceType(h)?S(new Error('A source type called "'+h+'" already exists.')):(f.setSourceType(h,g),g.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:h,url:g.workerSourceURL},S):S(null,null))},f.prototype.getLight=function(){return this.light.getLight()},f.prototype.setLight=function(h,g){g===void 0&&(g={}),this._checkLoaded();var S=this.light.getLight(),M=!1;for(var R in h)if(!o.deepEqual(h[R],S[R])){M=!0;break}if(M){var N={now:o.browser.now(),transition:o.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(h,g),this.light.updateTransitions(N)}},f.prototype._validate=function(h,g,S,M,R){return R===void 0&&(R={}),(!R||R.validate!==!1)&&qc(this,h.call(o.validateStyle,o.extend({key:g,style:this.serialize(),value:S,styleSpec:o.styleSpec},M)))},f.prototype._remove=function(){for(var h in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[h].setEventedParent(null);for(var g in this.sourceCaches)this.sourceCaches[g].clearTiles(),this.sourceCaches[g].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},f.prototype._clearSource=function(h){this.sourceCaches[h].clearTiles()},f.prototype._reloadSource=function(h){this.sourceCaches[h].resume(),this.sourceCaches[h].reload()},f.prototype._updateSources=function(h){for(var g in this.sourceCaches)this.sourceCaches[g].update(h)},f.prototype._generateCollisionBoxes=function(){for(var h in this.sourceCaches)this._reloadSource(h)},f.prototype._updatePlacement=function(h,g,S,M,R){R===void 0&&(R=!1);for(var N=!1,H=!1,se={},ge=0,we=this._order;ge<we.length;ge+=1){var Te=this._layers[we[ge]];if(Te.type==="symbol"){if(!se[Te.source]){var ze=this.sourceCaches[Te.source];se[Te.source]=ze.getRenderableIds(!0).map(function(tt){return ze.getTileByID(tt)}).sort(function(tt,ut){return ut.tileID.overscaledZ-tt.tileID.overscaledZ||(tt.tileID.isLessThan(ut.tileID)?-1:1)})}var De=this.crossTileSymbolIndex.addLayer(Te,se[Te.source],h.center.lng);N=N||De}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((R=R||this._layerOrderChanged||S===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.browser.now(),h.zoom))&&(this.pauseablePlacement=new xd(h,this._order,R,g,S,M,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,se),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.browser.now()),H=!0),N&&this.pauseablePlacement.placement.setStale()),H||N)for(var Ye=0,Le=this._order;Ye<Le.length;Ye+=1){var Ze=this._layers[Le[Ye]];Ze.type==="symbol"&&this.placement.updateLayerOpacities(Ze,se[Ze.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.browser.now())},f.prototype._releaseSymbolFadeTiles=function(){for(var h in this.sourceCaches)this.sourceCaches[h].releaseSymbolFadeTiles()},f.prototype.getImages=function(h,g,S){this.imageManager.getImages(g.icons,S),this._updateTilesForChangedImages();var M=this.sourceCaches[g.source];M&&M.setDependencies(g.tileID.key,g.type,g.icons)},f.prototype.getGlyphs=function(h,g,S){this.glyphManager.getGlyphs(g.stacks,S)},f.prototype.getResource=function(h,g,S){return o.makeRequest(g,S)},f}(o.Evented);Cn.getSourceType=function(u){return Ne[u]},Cn.setSourceType=function(u,f){Ne[u]=f},Cn.registerForPluginStateChange=o.registerForPluginStateChange;var Xr=o.createLayout([{name:"a_pos",type:"Int16",components:2}]),Mu=Gn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Um=Gn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Wg=Gn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Yg=Gn(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),of=Gn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Oh=Gn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),af=Gn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),bi=Gn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Lh=Gn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Yl=Gn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Vm=Gn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Hc=Gn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),so=Gn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),lf=Gn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),xi=Gn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Nh=Gn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hl=Gn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),pl=Gn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Zl=Gn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),wi=Gn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Xl=Gn(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),ki=Gn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),Gc=Gn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),fl=Gn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),ml=Gn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),wd=Gn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Gn(u,f){var h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=f.match(/attribute ([\w]+) ([\w]+)/g),S=u.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),M=f.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),R=M?M.concat(S):S,N={};return{fragmentSource:u=u.replace(h,function(H,se,ge,we,Te){return N[Te]=!0,se==="define"?`
#ifndef HAS_UNIFORM_u_`+Te+`
varying `+ge+" "+we+" "+Te+`;
#else
uniform `+ge+" "+we+" u_"+Te+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+Te+`
    `+ge+" "+we+" "+Te+" = u_"+Te+`;
#endif
`}),vertexSource:f=f.replace(h,function(H,se,ge,we,Te){var ze=we==="float"?"vec2":"vec4",De=Te.match(/color/)?"color":ze;return N[Te]?se==="define"?`
#ifndef HAS_UNIFORM_u_`+Te+`
uniform lowp float u_`+Te+`_t;
attribute `+ge+" "+ze+" a_"+Te+`;
varying `+ge+" "+we+" "+Te+`;
#else
uniform `+ge+" "+we+" u_"+Te+`;
#endif
`:De==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Te+`
    `+Te+" = a_"+Te+`;
#else
    `+ge+" "+we+" "+Te+" = u_"+Te+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Te+`
    `+Te+" = unpack_mix_"+De+"(a_"+Te+", u_"+Te+`_t);
#else
    `+ge+" "+we+" "+Te+" = u_"+Te+`;
#endif
`:se==="define"?`
#ifndef HAS_UNIFORM_u_`+Te+`
uniform lowp float u_`+Te+`_t;
attribute `+ge+" "+ze+" a_"+Te+`;
#else
uniform `+ge+" "+we+" u_"+Te+`;
#endif
`:De==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Te+`
    `+ge+" "+we+" "+Te+" = a_"+Te+`;
#else
    `+ge+" "+we+" "+Te+" = u_"+Te+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Te+`
    `+ge+" "+we+" "+Te+" = unpack_mix_"+De+"(a_"+Te+", u_"+Te+`_t);
#else
    `+ge+" "+we+" "+Te+" = u_"+Te+`;
#endif
`}),staticAttributes:g,staticUniforms:R}}var Fr=Object.freeze({__proto__:null,prelude:Mu,background:Um,backgroundPattern:Wg,circle:Yg,clippingMask:of,heatmap:Oh,heatmapTexture:af,collisionBox:bi,collisionCircle:Lh,debug:Yl,fill:Vm,fillOutline:Hc,fillOutlinePattern:so,fillPattern:lf,fillExtrusion:xi,fillExtrusionPattern:Nh,hillshadePrepare:hl,hillshade:pl,line:Zl,lineGradient:wi,linePattern:Xl,lineSDF:ki,raster:Gc,symbolIcon:fl,symbolSDF:ml,symbolTextAndIcon:wd}),Aa=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Dh(u){for(var f=[],h=0;h<u.length;h++)if(u[h]!==null){var g=u[h].split(" ");f.push(g.pop())}return f}Aa.prototype.bind=function(u,f,h,g,S,M,R,N){this.context=u;for(var H=this.boundPaintVertexBuffers.length!==g.length,se=0;!H&&se<g.length;se++)this.boundPaintVertexBuffers[se]!==g[se]&&(H=!0);u.extVertexArrayObject&&this.vao&&this.boundProgram===f&&this.boundLayoutVertexBuffer===h&&!H&&this.boundIndexBuffer===S&&this.boundVertexOffset===M&&this.boundDynamicVertexBuffer===R&&this.boundDynamicVertexBuffer2===N?(u.bindVertexArrayOES.set(this.vao),R&&R.bind(),S&&S.dynamicDraw&&S.bind(),N&&N.bind()):this.freshBind(f,h,g,S,M,R,N)},Aa.prototype.freshBind=function(u,f,h,g,S,M,R){var N,H=u.numAttributes,se=this.context,ge=se.gl;if(se.extVertexArrayObject)this.vao&&this.destroy(),this.vao=se.extVertexArrayObject.createVertexArrayOES(),se.bindVertexArrayOES.set(this.vao),N=0,this.boundProgram=u,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=h,this.boundIndexBuffer=g,this.boundVertexOffset=S,this.boundDynamicVertexBuffer=M,this.boundDynamicVertexBuffer2=R;else{N=se.currentNumAttributes||0;for(var we=H;we<N;we++)ge.disableVertexAttribArray(we)}f.enableAttributes(ge,u);for(var Te=0,ze=h;Te<ze.length;Te+=1)ze[Te].enableAttributes(ge,u);M&&M.enableAttributes(ge,u),R&&R.enableAttributes(ge,u),f.bind(),f.setVertexAttribPointers(ge,u,S);for(var De=0,Ye=h;De<Ye.length;De+=1){var Le=Ye[De];Le.bind(),Le.setVertexAttribPointers(ge,u,S)}M&&(M.bind(),M.setVertexAttribPointers(ge,u,S)),g&&g.bind(),R&&(R.bind(),R.setVertexAttribPointers(ge,u,S)),se.currentNumAttributes=H},Aa.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var jm=function(u,f,h,g,S,M){var R=u.gl;this.program=R.createProgram();for(var N=Dh(h.staticAttributes),H=g?g.getBinderAttributes():[],se=N.concat(H),ge=h.staticUniforms?Dh(h.staticUniforms):[],we=g?g.getBinderUniforms():[],Te=[],ze=0,De=ge.concat(we);ze<De.length;ze+=1){var Ye=De[ze];Te.indexOf(Ye)<0&&Te.push(Ye)}var Le=g?g.defines():[];M&&Le.push("#define OVERDRAW_INSPECTOR;");var Ze=Le.concat(Mu.fragmentSource,h.fragmentSource).join(`
`),tt=Le.concat(Mu.vertexSource,h.vertexSource).join(`
`),ut=R.createShader(R.FRAGMENT_SHADER);if(R.isContextLost())this.failedToCreate=!0;else{R.shaderSource(ut,Ze),R.compileShader(ut),R.attachShader(this.program,ut);var wt=R.createShader(R.VERTEX_SHADER);if(R.isContextLost())this.failedToCreate=!0;else{R.shaderSource(wt,tt),R.compileShader(wt),R.attachShader(this.program,wt),this.attributes={};var bt={};this.numAttributes=se.length;for(var It=0;It<this.numAttributes;It++)se[It]&&(R.bindAttribLocation(this.program,It,se[It]),this.attributes[se[It]]=It);R.linkProgram(this.program),R.deleteShader(wt),R.deleteShader(ut);for(var Dt=0;Dt<Te.length;Dt++){var Gt=Te[Dt];if(Gt&&!bt[Gt]){var Xt=R.getUniformLocation(this.program,Gt);Xt&&(bt[Gt]=Xt)}}this.fixedUniforms=S(u,bt),this.binderUniforms=g?g.getUniforms(u,bt):[]}}};function Bh(u,f,h){var g=1/Sr(h,1,f.transform.tileZoom),S=Math.pow(2,h.tileID.overscaledZ),M=h.tileSize*Math.pow(2,f.transform.tileZoom)/S,R=M*(h.tileID.canonical.x+h.tileID.wrap*S),N=M*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_scale:[g,u.fromScale,u.toScale],u_fade:u.t,u_pixel_coord_upper:[R>>16,N>>16],u_pixel_coord_lower:[65535&R,65535&N]}}jm.prototype.draw=function(u,f,h,g,S,M,R,N,H,se,ge,we,Te,ze,De,Ye){var Le,Ze=u.gl;if(!this.failedToCreate){for(var tt in u.program.set(this.program),u.setDepthMode(h),u.setStencilMode(g),u.setColorMode(S),u.setCullFace(M),this.fixedUniforms)this.fixedUniforms[tt].set(R[tt]);ze&&ze.setUniforms(u,this.binderUniforms,we,{zoom:Te});for(var ut=(Le={},Le[Ze.LINES]=2,Le[Ze.TRIANGLES]=3,Le[Ze.LINE_STRIP]=1,Le)[f],wt=0,bt=ge.get();wt<bt.length;wt+=1){var It=bt[wt],Dt=It.vaos||(It.vaos={});(Dt[N]||(Dt[N]=new Aa)).bind(u,this,H,ze?ze.getPaintVertexBuffers():[],se,It.vertexOffset,De,Ye),Ze.drawElements(f,It.primitiveLength*ut,Ze.UNSIGNED_SHORT,It.primitiveOffset*ut*2)}}};var qm=function(u,f,h,g){var S=f.style.light,M=S.properties.get("position"),R=[M.x,M.y,M.z],N=o.create$1();S.properties.get("anchor")==="viewport"&&o.fromRotation(N,-f.transform.angle),o.transformMat3(R,R,N);var H=S.properties.get("color");return{u_matrix:u,u_lightpos:R,u_lightintensity:S.properties.get("intensity"),u_lightcolor:[H.r,H.g,H.b],u_vertical_gradient:+h,u_opacity:g}},Wc=function(u,f,h,g,S,M,R){return o.extend(qm(u,f,h,g),Bh(M,f,R),{u_height_factor:-Math.pow(2,S.overscaledZ)/R.tileSize/8})},Kl=function(u){return{u_matrix:u}},Jl=function(u,f,h,g){return o.extend(Kl(u),Bh(h,f,g))},Sd=function(u,f){return{u_matrix:u,u_world:f}},Yc=function(u,f,h,g,S){return o.extend(Jl(u,f,h,g),{u_world:S})},cf=function(u,f,h,g){var S,M,R=u.transform;if(g.paint.get("circle-pitch-alignment")==="map"){var N=Sr(h,1,R.zoom);S=!0,M=[N,N]}else S=!1,M=R.pixelsToGLUnits;return{u_camera_to_center_distance:R.cameraToCenterDistance,u_scale_with_map:+(g.paint.get("circle-pitch-scale")==="map"),u_matrix:u.translatePosMatrix(f.posMatrix,h,g.paint.get("circle-translate"),g.paint.get("circle-translate-anchor")),u_pitch_with_map:+S,u_device_pixel_ratio:o.browser.devicePixelRatio,u_extrude_scale:M}},Ql=function(u,f,h){var g=Sr(h,1,f.zoom),S=Math.pow(2,f.zoom-h.tileID.overscaledZ),M=h.tileID.overscaleFactor();return{u_matrix:u,u_camera_to_center_distance:f.cameraToCenterDistance,u_pixels_to_tile_units:g,u_extrude_scale:[f.pixelsToGLUnits[0]/(g*S),f.pixelsToGLUnits[1]/(g*S)],u_overscale_factor:M}},uf=function(u,f,h){return{u_matrix:u,u_inv_matrix:f,u_camera_to_center_distance:h.cameraToCenterDistance,u_viewport_size:[h.width,h.height]}},_l=function(u,f,h){return h===void 0&&(h=1),{u_matrix:u,u_color:f,u_overlay:0,u_overlay_scale:h}},gl=function(u){return{u_matrix:u}},df=function(u,f,h,g){return{u_matrix:u,u_extrude_scale:Sr(f,1,h),u_intensity:g}},Cd=function(u,f,h){var g=u.transform;return{u_matrix:To(u,f,h),u_ratio:1/Sr(f,1,g.zoom),u_device_pixel_ratio:o.browser.devicePixelRatio,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},tr=function(u,f,h,g){return o.extend(Cd(u,f,h),{u_image:0,u_image_height:g})},Eu=function(u,f,h,g){var S=u.transform,M=Zc(f,S);return{u_matrix:To(u,f,h),u_texsize:f.imageAtlasTexture.size,u_ratio:1/Sr(f,1,S.zoom),u_device_pixel_ratio:o.browser.devicePixelRatio,u_image:0,u_scale:[M,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/S.pixelsToGLUnits[0],1/S.pixelsToGLUnits[1]]}},Zg=function(u,f,h,g,S){var M=u.lineAtlas,R=Zc(f,u.transform),N=h.layout.get("line-cap")==="round",H=M.getDash(g.from,N),se=M.getDash(g.to,N),ge=H.width*S.fromScale,we=se.width*S.toScale;return o.extend(Cd(u,f,h),{u_patternscale_a:[R/ge,-H.height/2],u_patternscale_b:[R/we,-se.height/2],u_sdfgamma:M.width/(256*Math.min(ge,we)*o.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:H.y,u_tex_y_b:se.y,u_mix:S.t})};function Zc(u,f){return 1/Sr(u,1,f.tileZoom)}function To(u,f,h){return u.translatePosMatrix(f.tileID.posMatrix,f,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}var hf=function(u,f,h,g,S){return{u_matrix:u,u_tl_parent:f,u_scale_parent:h,u_buffer_scale:1,u_fade_t:g.mix,u_opacity:g.opacity*S.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:S.paint.get("raster-brightness-min"),u_brightness_high:S.paint.get("raster-brightness-max"),u_saturation_factor:(R=S.paint.get("raster-saturation"),R>0?1-1/(1.001-R):-R),u_contrast_factor:(M=S.paint.get("raster-contrast"),M>0?1/(1-M):1+M),u_spin_weights:ku(S.paint.get("raster-hue-rotate"))};var M,R};function ku(u){u*=Math.PI/180;var f=Math.sin(u),h=Math.cos(u);return[(2*h+1)/3,(-Math.sqrt(3)*f-h+1)/3,(Math.sqrt(3)*f-h+1)/3]}var Id,Xc=function(u,f,h,g,S,M,R,N,H,se){var ge=S.transform;return{u_is_size_zoom_constant:+(u==="constant"||u==="source"),u_is_size_feature_constant:+(u==="constant"||u==="camera"),u_size_t:f?f.uSizeT:0,u_size:f?f.uSize:0,u_camera_to_center_distance:ge.cameraToCenterDistance,u_pitch:ge.pitch/360*2*Math.PI,u_rotate_symbol:+h,u_aspect_ratio:ge.width/ge.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_matrix:M,u_label_plane_matrix:R,u_coord_matrix:N,u_is_text:+H,u_pitch_with_map:+g,u_texsize:se,u_texture:0}},Td=function(u,f,h,g,S,M,R,N,H,se,ge){var we=S.transform;return o.extend(Xc(u,f,h,g,S,M,R,N,H,se),{u_gamma_scale:g?Math.cos(we._pitch)*we.cameraToCenterDistance:1,u_device_pixel_ratio:o.browser.devicePixelRatio,u_is_halo:+ge})},Fh=function(u,f,h,g,S,M,R,N,H,se){return o.extend(Td(u,f,h,g,S,M,R,N,!0,H,!0),{u_texsize_icon:se,u_texture_icon:1})},Ad=function(u,f,h){return{u_matrix:u,u_opacity:f,u_color:h}},Pu=function(u,f,h,g,S,M){return o.extend(function(R,N,H,se){var ge=H.imageManager.getPattern(R.from.toString()),we=H.imageManager.getPattern(R.to.toString()),Te=H.imageManager.getPixelSize(),ze=Te.width,De=Te.height,Ye=Math.pow(2,se.tileID.overscaledZ),Le=se.tileSize*Math.pow(2,H.transform.tileZoom)/Ye,Ze=Le*(se.tileID.canonical.x+se.tileID.wrap*Ye),tt=Le*se.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:ge.tl,u_pattern_br_a:ge.br,u_pattern_tl_b:we.tl,u_pattern_br_b:we.br,u_texsize:[ze,De],u_mix:N.t,u_pattern_size_a:ge.displaySize,u_pattern_size_b:we.displaySize,u_scale_a:N.fromScale,u_scale_b:N.toScale,u_tile_units_to_pixels:1/Sr(se,1,H.transform.tileZoom),u_pixel_coord_upper:[Ze>>16,tt>>16],u_pixel_coord_lower:[65535&Ze,65535&tt]}}(g,M,h,S),{u_matrix:u,u_opacity:f})},Hm={fillExtrusion:function(u,f){return{u_matrix:new o.UniformMatrix4f(u,f.u_matrix),u_lightpos:new o.Uniform3f(u,f.u_lightpos),u_lightintensity:new o.Uniform1f(u,f.u_lightintensity),u_lightcolor:new o.Uniform3f(u,f.u_lightcolor),u_vertical_gradient:new o.Uniform1f(u,f.u_vertical_gradient),u_opacity:new o.Uniform1f(u,f.u_opacity)}},fillExtrusionPattern:function(u,f){return{u_matrix:new o.UniformMatrix4f(u,f.u_matrix),u_lightpos:new o.Uniform3f(u,f.u_lightpos),u_lightintensity:new o.Uniform1f(u,f.u_lightintensity),u_lightcolor:new o.Uniform3f(u,f.u_lightcolor),u_vertical_gradient:new o.Uniform1f(u,f.u_vertical_gradient),u_height_factor:new o.Uniform1f(u,f.u_height_factor),u_image:new o.Uniform1i(u,f.u_image),u_texsize:new o.Uniform2f(u,f.u_texsize),u_pixel_coord_upper:new o.Uniform2f(u,f.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(u,f.u_pixel_coord_lower),u_scale:new o.Uniform3f(u,f.u_scale),u_fade:new o.Uniform1f(u,f.u_fade),u_opacity:new o.Uniform1f(u,f.u_opacity)}},fill:function(u,f){return{u_matrix:new o.UniformMatrix4f(u,f.u_matrix)}},fillPattern:function(u,f){return{u_matrix:new o.UniformMatrix4f(u,f.u_matrix),u_image:new o.Uniform1i(u,f.u_image),u_texsize:new o.Uniform2f(u,f.u_texsize),u_pixel_coord_upper:new o.Uniform2f(u,f.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(u,f.u_pixel_coord_lower),u_scale:new o.Uniform3f(u,f.u_scale),u_fade:new o.Uniform1f(u,f.u_fade)}},fillOutline:function(u,f){return{u_matrix:new o.UniformMatrix4f(u,f.u_matrix),u_world:new o.Uniform2f(u,f.u_world)}},fillOutlinePattern:function(u,f){return{u_matrix:new o.UniformMatrix4f(u,f.u_matrix),u_world:new o.Uniform2f(u,f.u_world),u_image:new o.Uniform1i(u,f.u_image),u_texsize:new o.Uniform2f(u,f.u_texsize),u_pixel_coord_upper:new o.Uniform2f(u,f.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(u,f.u_pixel_coord_lower),u_scale:new o.Uniform3f(u,f.u_scale),u_fade:new o.Uniform1f(u,f.u_fade)}},circle:function(u,f){return{u_camera_to_center_distance:new o.Uniform1f(u,f.u_camera_to_center_distance),u_scale_with_map:new o.Uniform1i(u,f.u_scale_with_map),u_pitch_with_map:new o.Uniform1i(u,f.u_pitch_with_map),u_extrude_scale:new o.Uniform2f(u,f.u_extrude_scale),u_device_pixel_ratio:new o.Uniform1f(u,f.u_device_pixel_ratio),u_matrix:new o.UniformMatrix4f(u,f.u_matrix)}},collisionBox:function(u,f){return{u_matrix:new o.UniformMatrix4f(u,f.u_matrix),u_camera_to_center_distance:new o.Uniform1f(u,f.u_camera_to_center_distance),u_pixels_to_tile_units:new o.Uniform1f(u,f.u_pixels_to_tile_units),u_extrude_scale:new o.Uniform2f(u,f.u_extrude_scale),u_overscale_factor:new o.Uniform1f(u,f.u_overscale_factor)}},collisionCircle:function(u,f){return{u_matrix:new o.UniformMatrix4f(u,f.u_matrix),u_inv_matrix:new o.UniformMatrix4f(u,f.u_inv_matrix),u_camera_to_center_distance:new o.Uniform1f(u,f.u_camera_to_center_distance),u_viewport_size:new o.Uniform2f(u,f.u_viewport_size)}},debug:function(u,f){return{u_color:new o.UniformColor(u,f.u_color),u_matrix:new o.UniformMatrix4f(u,f.u_matrix),u_overlay:new o.Uniform1i(u,f.u_overlay),u_overlay_scale:new o.Uniform1f(u,f.u_overlay_scale)}},clippingMask:function(u,f){return{u_matrix:new o.UniformMatrix4f(u,f.u_matrix)}},heatmap:function(u,f){return{u_extrude_scale:new o.Uniform1f(u,f.u_extrude_scale),u_intensity:new o.Uniform1f(u,f.u_intensity),u_matrix:new o.UniformMatrix4f(u,f.u_matrix)}},heatmapTexture:function(u,f){return{u_matrix:new o.UniformMatrix4f(u,f.u_matrix),u_world:new o.Uniform2f(u,f.u_world),u_image:new o.Uniform1i(u,f.u_image),u_color_ramp:new o.Uniform1i(u,f.u_color_ramp),u_opacity:new o.Uniform1f(u,f.u_opacity)}},hillshade:function(u,f){return{u_matrix:new o.UniformMatrix4f(u,f.u_matrix),u_image:new o.Uniform1i(u,f.u_image),u_latrange:new o.Uniform2f(u,f.u_latrange),u_light:new o.Uniform2f(u,f.u_light),u_shadow:new o.UniformColor(u,f.u_shadow),u_highlight:new o.UniformColor(u,f.u_highlight),u_accent:new o.UniformColor(u,f.u_accent)}},hillshadePrepare:function(u,f){return{u_matrix:new o.UniformMatrix4f(u,f.u_matrix),u_image:new o.Uniform1i(u,f.u_image),u_dimension:new o.Uniform2f(u,f.u_dimension),u_zoom:new o.Uniform1f(u,f.u_zoom),u_unpack:new o.Uniform4f(u,f.u_unpack)}},line:function(u,f){return{u_matrix:new o.UniformMatrix4f(u,f.u_matrix),u_ratio:new o.Uniform1f(u,f.u_ratio),u_device_pixel_ratio:new o.Uniform1f(u,f.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(u,f.u_units_to_pixels)}},lineGradient:function(u,f){return{u_matrix:new o.UniformMatrix4f(u,f.u_matrix),u_ratio:new o.Uniform1f(u,f.u_ratio),u_device_pixel_ratio:new o.Uniform1f(u,f.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(u,f.u_units_to_pixels),u_image:new o.Uniform1i(u,f.u_image),u_image_height:new o.Uniform1f(u,f.u_image_height)}},linePattern:function(u,f){return{u_matrix:new o.UniformMatrix4f(u,f.u_matrix),u_texsize:new o.Uniform2f(u,f.u_texsize),u_ratio:new o.Uniform1f(u,f.u_ratio),u_device_pixel_ratio:new o.Uniform1f(u,f.u_device_pixel_ratio),u_image:new o.Uniform1i(u,f.u_image),u_units_to_pixels:new o.Uniform2f(u,f.u_units_to_pixels),u_scale:new o.Uniform3f(u,f.u_scale),u_fade:new o.Uniform1f(u,f.u_fade)}},lineSDF:function(u,f){return{u_matrix:new o.UniformMatrix4f(u,f.u_matrix),u_ratio:new o.Uniform1f(u,f.u_ratio),u_device_pixel_ratio:new o.Uniform1f(u,f.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(u,f.u_units_to_pixels),u_patternscale_a:new o.Uniform2f(u,f.u_patternscale_a),u_patternscale_b:new o.Uniform2f(u,f.u_patternscale_b),u_sdfgamma:new o.Uniform1f(u,f.u_sdfgamma),u_image:new o.Uniform1i(u,f.u_image),u_tex_y_a:new o.Uniform1f(u,f.u_tex_y_a),u_tex_y_b:new o.Uniform1f(u,f.u_tex_y_b),u_mix:new o.Uniform1f(u,f.u_mix)}},raster:function(u,f){return{u_matrix:new o.UniformMatrix4f(u,f.u_matrix),u_tl_parent:new o.Uniform2f(u,f.u_tl_parent),u_scale_parent:new o.Uniform1f(u,f.u_scale_parent),u_buffer_scale:new o.Uniform1f(u,f.u_buffer_scale),u_fade_t:new o.Uniform1f(u,f.u_fade_t),u_opacity:new o.Uniform1f(u,f.u_opacity),u_image0:new o.Uniform1i(u,f.u_image0),u_image1:new o.Uniform1i(u,f.u_image1),u_brightness_low:new o.Uniform1f(u,f.u_brightness_low),u_brightness_high:new o.Uniform1f(u,f.u_brightness_high),u_saturation_factor:new o.Uniform1f(u,f.u_saturation_factor),u_contrast_factor:new o.Uniform1f(u,f.u_contrast_factor),u_spin_weights:new o.Uniform3f(u,f.u_spin_weights)}},symbolIcon:function(u,f){return{u_is_size_zoom_constant:new o.Uniform1i(u,f.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(u,f.u_is_size_feature_constant),u_size_t:new o.Uniform1f(u,f.u_size_t),u_size:new o.Uniform1f(u,f.u_size),u_camera_to_center_distance:new o.Uniform1f(u,f.u_camera_to_center_distance),u_pitch:new o.Uniform1f(u,f.u_pitch),u_rotate_symbol:new o.Uniform1i(u,f.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(u,f.u_aspect_ratio),u_fade_change:new o.Uniform1f(u,f.u_fade_change),u_matrix:new o.UniformMatrix4f(u,f.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(u,f.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(u,f.u_coord_matrix),u_is_text:new o.Uniform1i(u,f.u_is_text),u_pitch_with_map:new o.Uniform1i(u,f.u_pitch_with_map),u_texsize:new o.Uniform2f(u,f.u_texsize),u_texture:new o.Uniform1i(u,f.u_texture)}},symbolSDF:function(u,f){return{u_is_size_zoom_constant:new o.Uniform1i(u,f.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(u,f.u_is_size_feature_constant),u_size_t:new o.Uniform1f(u,f.u_size_t),u_size:new o.Uniform1f(u,f.u_size),u_camera_to_center_distance:new o.Uniform1f(u,f.u_camera_to_center_distance),u_pitch:new o.Uniform1f(u,f.u_pitch),u_rotate_symbol:new o.Uniform1i(u,f.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(u,f.u_aspect_ratio),u_fade_change:new o.Uniform1f(u,f.u_fade_change),u_matrix:new o.UniformMatrix4f(u,f.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(u,f.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(u,f.u_coord_matrix),u_is_text:new o.Uniform1i(u,f.u_is_text),u_pitch_with_map:new o.Uniform1i(u,f.u_pitch_with_map),u_texsize:new o.Uniform2f(u,f.u_texsize),u_texture:new o.Uniform1i(u,f.u_texture),u_gamma_scale:new o.Uniform1f(u,f.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(u,f.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(u,f.u_is_halo)}},symbolTextAndIcon:function(u,f){return{u_is_size_zoom_constant:new o.Uniform1i(u,f.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(u,f.u_is_size_feature_constant),u_size_t:new o.Uniform1f(u,f.u_size_t),u_size:new o.Uniform1f(u,f.u_size),u_camera_to_center_distance:new o.Uniform1f(u,f.u_camera_to_center_distance),u_pitch:new o.Uniform1f(u,f.u_pitch),u_rotate_symbol:new o.Uniform1i(u,f.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(u,f.u_aspect_ratio),u_fade_change:new o.Uniform1f(u,f.u_fade_change),u_matrix:new o.UniformMatrix4f(u,f.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(u,f.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(u,f.u_coord_matrix),u_is_text:new o.Uniform1i(u,f.u_is_text),u_pitch_with_map:new o.Uniform1i(u,f.u_pitch_with_map),u_texsize:new o.Uniform2f(u,f.u_texsize),u_texsize_icon:new o.Uniform2f(u,f.u_texsize_icon),u_texture:new o.Uniform1i(u,f.u_texture),u_texture_icon:new o.Uniform1i(u,f.u_texture_icon),u_gamma_scale:new o.Uniform1f(u,f.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(u,f.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(u,f.u_is_halo)}},background:function(u,f){return{u_matrix:new o.UniformMatrix4f(u,f.u_matrix),u_opacity:new o.Uniform1f(u,f.u_opacity),u_color:new o.UniformColor(u,f.u_color)}},backgroundPattern:function(u,f){return{u_matrix:new o.UniformMatrix4f(u,f.u_matrix),u_opacity:new o.Uniform1f(u,f.u_opacity),u_image:new o.Uniform1i(u,f.u_image),u_pattern_tl_a:new o.Uniform2f(u,f.u_pattern_tl_a),u_pattern_br_a:new o.Uniform2f(u,f.u_pattern_br_a),u_pattern_tl_b:new o.Uniform2f(u,f.u_pattern_tl_b),u_pattern_br_b:new o.Uniform2f(u,f.u_pattern_br_b),u_texsize:new o.Uniform2f(u,f.u_texsize),u_mix:new o.Uniform1f(u,f.u_mix),u_pattern_size_a:new o.Uniform2f(u,f.u_pattern_size_a),u_pattern_size_b:new o.Uniform2f(u,f.u_pattern_size_b),u_scale_a:new o.Uniform1f(u,f.u_scale_a),u_scale_b:new o.Uniform1f(u,f.u_scale_b),u_pixel_coord_upper:new o.Uniform2f(u,f.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(u,f.u_pixel_coord_lower),u_tile_units_to_pixels:new o.Uniform1f(u,f.u_tile_units_to_pixels)}}};function Ma(u,f,h,g,S,M,R){for(var N=u.context,H=N.gl,se=u.useProgram("collisionBox"),ge=[],we=0,Te=0,ze=0;ze<g.length;ze++){var De=g[ze],Ye=f.getTile(De),Le=Ye.getBucket(h);if(Le){var Ze=De.posMatrix;S[0]===0&&S[1]===0||(Ze=u.translatePosMatrix(De.posMatrix,Ye,S,M));var tt=R?Le.textCollisionBox:Le.iconCollisionBox,ut=Le.collisionCircleArray;if(ut.length>0){var wt=o.create(),bt=Ze;o.mul(wt,Le.placementInvProjMatrix,u.transform.glCoordMatrix),o.mul(wt,wt,Le.placementViewportMatrix),ge.push({circleArray:ut,circleOffset:Te,transform:bt,invTransform:wt}),Te=we+=ut.length/4}tt&&se.draw(N,H.LINES,Ae.disabled,Fe.disabled,u.colorModeForRenderPass(),st.disabled,Ql(Ze,u.transform,Ye),h.id,tt.layoutVertexBuffer,tt.indexBuffer,tt.segments,null,u.transform.zoom,null,null,tt.collisionVertexBuffer)}}if(R&&ge.length){var It=u.useProgram("collisionCircle"),Dt=new o.StructArrayLayout2f1f2i16;Dt.resize(4*we),Dt._trim();for(var Gt=0,Xt=0,as=ge;Xt<as.length;Xt+=1)for(var vs=as[Xt],$s=0;$s<vs.circleArray.length/4;$s++){var ks=4*$s,xn=vs.circleArray[ks+0],ps=vs.circleArray[ks+1],Ls=vs.circleArray[ks+2],Qs=vs.circleArray[ks+3];Dt.emplace(Gt++,xn,ps,Ls,Qs,0),Dt.emplace(Gt++,xn,ps,Ls,Qs,1),Dt.emplace(Gt++,xn,ps,Ls,Qs,2),Dt.emplace(Gt++,xn,ps,Ls,Qs,3)}(!Id||Id.length<2*we)&&(Id=function($r){var kr=2*$r,oi=new o.StructArrayLayout3ui6;oi.resize(kr),oi._trim();for(var fr=0;fr<kr;fr++){var ur=6*fr;oi.uint16[ur+0]=4*fr+0,oi.uint16[ur+1]=4*fr+1,oi.uint16[ur+2]=4*fr+2,oi.uint16[ur+3]=4*fr+2,oi.uint16[ur+4]=4*fr+3,oi.uint16[ur+5]=4*fr+0}return oi}(we));for(var qs=N.createIndexBuffer(Id,!0),zs=N.createVertexBuffer(Dt,o.collisionCircleLayout.members,!0),en=0,Vs=ge;en<Vs.length;en+=1){var ws=Vs[en],ei=uf(ws.transform,ws.invTransform,u.transform);It.draw(N,H.TRIANGLES,Ae.disabled,Fe.disabled,u.colorModeForRenderPass(),st.disabled,ei,h.id,zs,qs,o.SegmentVector.simpleSegment(0,2*ws.circleOffset,ws.circleArray.length,ws.circleArray.length/2),null,u.transform.zoom,null,null,null)}zs.destroy(),qs.destroy()}}var Ea=o.identity(new Float32Array(16));function Gm(u,f,h,g,S,M){var R=o.getAnchorAlignment(u),N=-(R.horizontalAlign-.5)*f,H=-(R.verticalAlign-.5)*h,se=o.evaluateVariableOffset(u,g);return new o.Point((N/S+se[0])*M,(H/S+se[1])*M)}function zh(u,f,h,g,S,M,R,N,H,se,ge){var we=u.text.placedSymbolArray,Te=u.text.dynamicLayoutVertexArray,ze=u.icon.dynamicLayoutVertexArray,De={};Te.clear();for(var Ye=0;Ye<we.length;Ye++){var Le=we.get(Ye),Ze=Le.hidden||!Le.crossTileID||u.allowVerticalPlacement&&!Le.placedOrientation?null:g[Le.crossTileID];if(Ze){var tt=new o.Point(Le.anchorX,Le.anchorY),ut=pn(tt,h?N:R),wt=On(M.cameraToCenterDistance,ut.signedDistanceFromCamera),bt=S.evaluateSizeForFeature(u.textSizeData,se,Le)*wt/o.ONE_EM;h&&(bt*=u.tilePixelRatio/H);for(var It=Gm(Ze.anchor,Ze.width,Ze.height,Ze.textOffset,Ze.textBoxScale,bt),Dt=h?pn(tt.add(It),R).point:ut.point.add(f?It.rotate(-M.angle):It),Gt=u.allowVerticalPlacement&&Le.placedOrientation===o.WritingMode.vertical?Math.PI/2:0,Xt=0;Xt<Le.numGlyphs;Xt++)o.addDynamicAttributes(Te,Dt,Gt);ge&&Le.associatedIconIndex>=0&&(De[Le.associatedIconIndex]={shiftedAnchor:Dt,angle:Gt})}else Di(Le.numGlyphs,Te)}if(ge){ze.clear();for(var as=u.icon.placedSymbolArray,vs=0;vs<as.length;vs++){var $s=as.get(vs);if($s.hidden)Di($s.numGlyphs,ze);else{var ks=De[vs];if(ks)for(var xn=0;xn<$s.numGlyphs;xn++)o.addDynamicAttributes(ze,ks.shiftedAnchor,ks.angle);else Di($s.numGlyphs,ze)}}u.icon.dynamicLayoutVertexBuffer.updateData(ze)}u.text.dynamicLayoutVertexBuffer.updateData(Te)}function pf(u,f,h){return h.iconsInText&&f?"symbolTextAndIcon":u?"symbolSDF":"symbolIcon"}function Ao(u,f,h,g,S,M,R,N,H,se,ge,we){for(var Te=u.context,ze=Te.gl,De=u.transform,Ye=N==="map",Le=H==="map",Ze=Ye&&h.layout.get("symbol-placement")!=="point",tt=Ye&&!Le&&!Ze,ut=h.layout.get("symbol-sort-key").constantOr(1)!==void 0,wt=!1,bt=u.depthModeForSublayer(0,Ae.ReadOnly),It=h.layout.get("text-variable-anchor"),Dt=[],Gt=0,Xt=g;Gt<Xt.length;Gt+=1){var as=Xt[Gt],vs=f.getTile(as),$s=vs.getBucket(h);if($s){var ks=S?$s.text:$s.icon;if(ks&&ks.segments.get().length){var xn=ks.programConfigurations.get(h.id),ps=S||$s.sdfIcons,Ls=S?$s.textSizeData:$s.iconSizeData,Qs=Le||De.pitch!==0,qs=u.useProgram(pf(ps,S,$s),xn),zs=o.evaluateSizeForZoom(Ls,De.zoom),en=void 0,Vs=[0,0],ws=void 0,ei=void 0,$r=null,kr=void 0;if(S)ws=vs.glyphAtlasTexture,ei=ze.LINEAR,en=vs.glyphAtlasTexture.size,$s.iconsInText&&(Vs=vs.imageAtlasTexture.size,$r=vs.imageAtlasTexture,kr=Qs||u.options.rotating||u.options.zooming||Ls.kind==="composite"||Ls.kind==="camera"?ze.LINEAR:ze.NEAREST);else{var oi=h.layout.get("icon-size").constantOr(0)!==1||$s.iconsNeedLinear;ws=vs.imageAtlasTexture,ei=ps||u.options.rotating||u.options.zooming||oi||Qs?ze.LINEAR:ze.NEAREST,en=vs.imageAtlasTexture.size}var fr=Sr(vs,1,u.transform.zoom),ur=Br(as.posMatrix,Le,Ye,u.transform,fr),_o=Hn(as.posMatrix,Le,Ye,u.transform,fr),lr=It&&$s.hasTextData(),qa=h.layout.get("icon-text-fit")!=="none"&&lr&&$s.hasIconData();Ze&&vd($s,as.posMatrix,u,S,ur,_o,Le,se);var go=u.translatePosMatrix(as.posMatrix,vs,M,R),Ra=Ze||S&&It||qa?Ea:ur,oa=u.translatePosMatrix(_o,vs,M,R,!0),tu=ps&&h.paint.get(S?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Bu={program:qs,buffers:ks,uniformValues:ps?$s.iconsInText?Fh(Ls.kind,zs,tt,Le,u,go,Ra,oa,en,Vs):Td(Ls.kind,zs,tt,Le,u,go,Ra,oa,S,en,!0):Xc(Ls.kind,zs,tt,Le,u,go,Ra,oa,S,en),atlasTexture:ws,atlasTextureIcon:$r,atlasInterpolation:ei,atlasInterpolationIcon:kr,isSDF:ps,hasHalo:tu};if(ut&&$s.canOverlap){wt=!0;for(var aa=0,su=ks.segments.get();aa<su.length;aa+=1){var $d=su[aa];Dt.push({segments:new o.SegmentVector([$d]),sortKey:$d.sortKey,state:Bu})}}else Dt.push({segments:ks.segments,sortKey:0,state:Bu})}}}wt&&Dt.sort(function(Sl,nu){return Sl.sortKey-nu.sortKey});for(var Ha=0,wl=Dt;Ha<wl.length;Ha+=1){var Ga=wl[Ha],_i=Ga.state;if(Te.activeTexture.set(ze.TEXTURE0),_i.atlasTexture.bind(_i.atlasInterpolation,ze.CLAMP_TO_EDGE),_i.atlasTextureIcon&&(Te.activeTexture.set(ze.TEXTURE1),_i.atlasTextureIcon&&_i.atlasTextureIcon.bind(_i.atlasInterpolationIcon,ze.CLAMP_TO_EDGE)),_i.isSDF){var $a=_i.uniformValues;_i.hasHalo&&($a.u_is_halo=1,ec(_i.buffers,Ga.segments,h,u,_i.program,bt,ge,we,$a)),$a.u_is_halo=0}ec(_i.buffers,Ga.segments,h,u,_i.program,bt,ge,we,_i.uniformValues)}}function ec(u,f,h,g,S,M,R,N,H){var se=g.context;S.draw(se,se.gl.TRIANGLES,M,R,N,st.disabled,H,h.id,u.layoutVertexBuffer,u.indexBuffer,f,h.paint,g.transform.zoom,u.programConfigurations.get(h.id),u.dynamicLayoutVertexBuffer,u.opacityVertexBuffer)}function Uh(u,f,h,g,S,M,R){var N,H,se,ge,we,Te=u.context.gl,ze=h.paint.get("fill-pattern"),De=ze&&ze.constantOr(1),Ye=h.getCrossfadeParameters();R?(H=De&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",N=Te.LINES):(H=De?"fillPattern":"fill",N=Te.TRIANGLES);for(var Le=0,Ze=g;Le<Ze.length;Le+=1){var tt=Ze[Le],ut=f.getTile(tt);if(!De||ut.patternsLoaded()){var wt=ut.getBucket(h);if(wt){var bt=wt.programConfigurations.get(h.id),It=u.useProgram(H,bt);De&&(u.context.activeTexture.set(Te.TEXTURE0),ut.imageAtlasTexture.bind(Te.LINEAR,Te.CLAMP_TO_EDGE),bt.updatePaintBuffers(Ye));var Dt=ze.constantOr(null);if(Dt&&ut.imageAtlas){var Gt=ut.imageAtlas,Xt=Gt.patternPositions[Dt.to.toString()],as=Gt.patternPositions[Dt.from.toString()];Xt&&as&&bt.setConstantPatternPositions(Xt,as)}var vs=u.translatePosMatrix(tt.posMatrix,ut,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(R){ge=wt.indexBuffer2,we=wt.segments2;var $s=[Te.drawingBufferWidth,Te.drawingBufferHeight];se=H==="fillOutlinePattern"&&De?Yc(vs,u,Ye,ut,$s):Sd(vs,$s)}else ge=wt.indexBuffer,we=wt.segments,se=De?Jl(vs,u,Ye,ut):Kl(vs);It.draw(u.context,N,S,u.stencilModeForClipping(tt),M,st.disabled,se,h.id,wt.layoutVertexBuffer,ge,we,h.paint,u.transform.zoom,bt)}}}}function ff(u,f,h,g,S,M,R){for(var N=u.context,H=N.gl,se=h.paint.get("fill-extrusion-pattern"),ge=se.constantOr(1),we=h.getCrossfadeParameters(),Te=h.paint.get("fill-extrusion-opacity"),ze=0,De=g;ze<De.length;ze+=1){var Ye=De[ze],Le=f.getTile(Ye),Ze=Le.getBucket(h);if(Ze){var tt=Ze.programConfigurations.get(h.id),ut=u.useProgram(ge?"fillExtrusionPattern":"fillExtrusion",tt);ge&&(u.context.activeTexture.set(H.TEXTURE0),Le.imageAtlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),tt.updatePaintBuffers(we));var wt=se.constantOr(null);if(wt&&Le.imageAtlas){var bt=Le.imageAtlas,It=bt.patternPositions[wt.to.toString()],Dt=bt.patternPositions[wt.from.toString()];It&&Dt&&tt.setConstantPatternPositions(It,Dt)}var Gt=u.translatePosMatrix(Ye.posMatrix,Le,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),Xt=h.paint.get("fill-extrusion-vertical-gradient"),as=ge?Wc(Gt,u,Xt,Te,Ye,we,Le):qm(Gt,u,Xt,Te);ut.draw(N,N.gl.TRIANGLES,S,M,R,st.backCCW,as,h.id,Ze.layoutVertexBuffer,Ze.indexBuffer,Ze.segments,h.paint,u.transform.zoom,tt)}}}function Vh(u,f,h,g,S,M){var R=u.context,N=R.gl,H=f.fbo;if(H){var se=u.useProgram("hillshade");R.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,H.colorAttachment.get());var ge=function(we,Te,ze){var De=ze.paint.get("hillshade-shadow-color"),Ye=ze.paint.get("hillshade-highlight-color"),Le=ze.paint.get("hillshade-accent-color"),Ze=ze.paint.get("hillshade-illumination-direction")*(Math.PI/180);ze.paint.get("hillshade-illumination-anchor")==="viewport"&&(Ze-=we.transform.angle);var tt,ut,wt,bt=!we.options.moving;return{u_matrix:we.transform.calculatePosMatrix(Te.tileID.toUnwrapped(),bt),u_image:0,u_latrange:(tt=Te.tileID,ut=Math.pow(2,tt.canonical.z),wt=tt.canonical.y,[new o.MercatorCoordinate(0,wt/ut).toLngLat().lat,new o.MercatorCoordinate(0,(wt+1)/ut).toLngLat().lat]),u_light:[ze.paint.get("hillshade-exaggeration"),Ze],u_shadow:De,u_highlight:Ye,u_accent:Le}}(u,f,h);se.draw(R,N.TRIANGLES,g,S,M,st.disabled,ge,h.id,u.rasterBoundsBuffer,u.quadTriangleIndexBuffer,u.rasterBoundsSegments)}}function Ru(u,f,h,g,S,M){var R=u.context,N=R.gl,H=f.dem;if(H&&H.data){var se=H.dim,ge=H.stride,we=H.getPixels();if(R.activeTexture.set(N.TEXTURE1),R.pixelStoreUnpackPremultiplyAlpha.set(!1),f.demTexture=f.demTexture||u.getTileTexture(ge),f.demTexture){var Te=f.demTexture;Te.update(we,{premultiply:!1}),Te.bind(N.NEAREST,N.CLAMP_TO_EDGE)}else f.demTexture=new o.Texture(R,we,N.RGBA,{premultiply:!1}),f.demTexture.bind(N.NEAREST,N.CLAMP_TO_EDGE);R.activeTexture.set(N.TEXTURE0);var ze=f.fbo;if(!ze){var De=new o.Texture(R,{width:se,height:se,data:null},N.RGBA);De.bind(N.LINEAR,N.CLAMP_TO_EDGE),(ze=f.fbo=R.createFramebuffer(se,se,!0)).colorAttachment.set(De.texture)}R.bindFramebuffer.set(ze.framebuffer),R.viewport.set([0,0,se,se]),u.useProgram("hillshadePrepare").draw(R,N.TRIANGLES,g,S,M,st.disabled,function(Ye,Le){var Ze=Le.stride,tt=o.create();return o.ortho(tt,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(tt,tt,[0,-o.EXTENT,0]),{u_matrix:tt,u_image:1,u_dimension:[Ze,Ze],u_zoom:Ye.overscaledZ,u_unpack:Le.getUnpackVector()}}(f.tileID,H),h.id,u.rasterBoundsBuffer,u.quadTriangleIndexBuffer,u.rasterBoundsSegments),f.needsHillshadePrepare=!1}}function Mo(u,f,h,g,S){var M=g.paint.get("raster-fade-duration");if(M>0){var R=o.browser.now(),N=(R-u.timeAdded)/M,H=f?(R-f.timeAdded)/M:-1,se=h.getSource(),ge=S.coveringZoomLevel({tileSize:se.tileSize,roundZoom:se.roundZoom}),we=!f||Math.abs(f.tileID.overscaledZ-ge)>Math.abs(u.tileID.overscaledZ-ge),Te=we&&u.refreshedUponExpiration?1:o.clamp(we?N:1-H,0,1);return u.refreshedUponExpiration&&N>=1&&(u.refreshedUponExpiration=!1),f?{opacity:1,mix:1-Te}:{opacity:Te,mix:0}}return{opacity:1,mix:0}}var jh=new o.Color(1,0,0,1),Wm=new o.Color(0,1,0,1),Ym=new o.Color(0,0,1,1),qh=new o.Color(1,0,1,1),mf=new o.Color(0,1,1,1);function _f(u,f,h,g){dt(u,0,f+h/2,u.transform.width,h,g)}function tc(u,f,h,g){dt(u,f-h/2,0,h,u.transform.height,g)}function dt(u,f,h,g,S,M){var R=u.context,N=R.gl;N.enable(N.SCISSOR_TEST),N.scissor(f*o.browser.devicePixelRatio,h*o.browser.devicePixelRatio,g*o.browser.devicePixelRatio,S*o.browser.devicePixelRatio),R.clear({color:M}),N.disable(N.SCISSOR_TEST)}function Ot(u,f,h){var g=u.context,S=g.gl,M=h.posMatrix,R=u.useProgram("debug"),N=Ae.disabled,H=Fe.disabled,se=u.colorModeForRenderPass();g.activeTexture.set(S.TEXTURE0),u.emptyTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),R.draw(g,S.LINE_STRIP,N,H,se,st.disabled,_l(M,o.Color.red),"$debug",u.debugBuffer,u.tileBorderIndexBuffer,u.debugSegments);var ge=f.getTileByID(h.key).latestRawTileData,we=Math.floor((ge&&ge.byteLength||0)/1024),Te=f.getTile(h).tileSize,ze=512/Math.min(Te,512)*(h.overscaledZ/u.transform.zoom)*.5,De=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(De+=" => "+h.overscaledZ),function(Ye,Le){Ye.initDebugOverlayCanvas();var Ze=Ye.debugOverlayCanvas,tt=Ye.context.gl,ut=Ye.debugOverlayCanvas.getContext("2d");ut.clearRect(0,0,Ze.width,Ze.height),ut.shadowColor="white",ut.shadowBlur=2,ut.lineWidth=1.5,ut.strokeStyle="white",ut.textBaseline="top",ut.font="bold 36px Open Sans, sans-serif",ut.fillText(Le,5,5),ut.strokeText(Le,5,5),Ye.debugOverlayTexture.update(Ze),Ye.debugOverlayTexture.bind(tt.LINEAR,tt.CLAMP_TO_EDGE)}(u,De+" "+we+"kb"),R.draw(g,S.TRIANGLES,N,H,et.alphaBlended,st.disabled,_l(M,o.Color.transparent,ze),"$debug",u.debugBuffer,u.quadTriangleIndexBuffer,u.debugSegments)}var Mt={symbol:function(u,f,h,g,S){if(u.renderPass==="translucent"){var M=Fe.disabled,R=u.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&function(N,H,se,ge,we,Te,ze){for(var De=H.transform,Ye=we==="map",Le=Te==="map",Ze=0,tt=N;Ze<tt.length;Ze+=1){var ut=tt[Ze],wt=ge.getTile(ut),bt=wt.getBucket(se);if(bt&&bt.text&&bt.text.segments.get().length){var It=o.evaluateSizeForZoom(bt.textSizeData,De.zoom),Dt=Sr(wt,1,H.transform.zoom),Gt=Br(ut.posMatrix,Le,Ye,H.transform,Dt),Xt=se.layout.get("icon-text-fit")!=="none"&&bt.hasIconData();if(It){var as=Math.pow(2,De.zoom-wt.tileID.overscaledZ);zh(bt,Ye,Le,ze,o.symbolSize,De,Gt,ut.posMatrix,as,It,Xt)}}}}(g,u,h,f,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),S),h.paint.get("icon-opacity").constantOr(1)!==0&&Ao(u,f,h,g,!1,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),h.layout.get("icon-rotation-alignment"),h.layout.get("icon-pitch-alignment"),h.layout.get("icon-keep-upright"),M,R),h.paint.get("text-opacity").constantOr(1)!==0&&Ao(u,f,h,g,!0,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),h.layout.get("text-keep-upright"),M,R),f.map.showCollisionBoxes&&(Ma(u,f,h,g,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),Ma(u,f,h,g,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))}},circle:function(u,f,h,g){if(u.renderPass==="translucent"){var S=h.paint.get("circle-opacity"),M=h.paint.get("circle-stroke-width"),R=h.paint.get("circle-stroke-opacity"),N=h.layout.get("circle-sort-key").constantOr(1)!==void 0;if(S.constantOr(1)!==0||M.constantOr(1)!==0&&R.constantOr(1)!==0){for(var H=u.context,se=H.gl,ge=u.depthModeForSublayer(0,Ae.ReadOnly),we=Fe.disabled,Te=u.colorModeForRenderPass(),ze=[],De=0;De<g.length;De++){var Ye=g[De],Le=f.getTile(Ye),Ze=Le.getBucket(h);if(Ze){var tt=Ze.programConfigurations.get(h.id),ut={programConfiguration:tt,program:u.useProgram("circle",tt),layoutVertexBuffer:Ze.layoutVertexBuffer,indexBuffer:Ze.indexBuffer,uniformValues:cf(u,Ye,Le,h)};if(N)for(var wt=0,bt=Ze.segments.get();wt<bt.length;wt+=1){var It=bt[wt];ze.push({segments:new o.SegmentVector([It]),sortKey:It.sortKey,state:ut})}else ze.push({segments:Ze.segments,sortKey:0,state:ut})}}N&&ze.sort(function(vs,$s){return vs.sortKey-$s.sortKey});for(var Dt=0,Gt=ze;Dt<Gt.length;Dt+=1){var Xt=Gt[Dt],as=Xt.state;as.program.draw(H,se.TRIANGLES,ge,we,Te,st.disabled,as.uniformValues,h.id,as.layoutVertexBuffer,as.indexBuffer,Xt.segments,h.paint,u.transform.zoom,as.programConfiguration)}}}},heatmap:function(u,f,h,g){if(h.paint.get("heatmap-opacity")!==0)if(u.renderPass==="offscreen"){var S=u.context,M=S.gl,R=Fe.disabled,N=new et([M.ONE,M.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function(ze,De,Ye){var Le=ze.gl;ze.activeTexture.set(Le.TEXTURE1),ze.viewport.set([0,0,De.width/4,De.height/4]);var Ze=Ye.heatmapFbo;if(Ze)Le.bindTexture(Le.TEXTURE_2D,Ze.colorAttachment.get()),ze.bindFramebuffer.set(Ze.framebuffer);else{var tt=Le.createTexture();Le.bindTexture(Le.TEXTURE_2D,tt),Le.texParameteri(Le.TEXTURE_2D,Le.TEXTURE_WRAP_S,Le.CLAMP_TO_EDGE),Le.texParameteri(Le.TEXTURE_2D,Le.TEXTURE_WRAP_T,Le.CLAMP_TO_EDGE),Le.texParameteri(Le.TEXTURE_2D,Le.TEXTURE_MIN_FILTER,Le.LINEAR),Le.texParameteri(Le.TEXTURE_2D,Le.TEXTURE_MAG_FILTER,Le.LINEAR),Ze=Ye.heatmapFbo=ze.createFramebuffer(De.width/4,De.height/4,!1),function(ut,wt,bt,It){var Dt=ut.gl;Dt.texImage2D(Dt.TEXTURE_2D,0,Dt.RGBA,wt.width/4,wt.height/4,0,Dt.RGBA,ut.extRenderToTextureHalfFloat?ut.extTextureHalfFloat.HALF_FLOAT_OES:Dt.UNSIGNED_BYTE,null),It.colorAttachment.set(bt)}(ze,De,tt,Ze)}})(S,u,h),S.clear({color:o.Color.transparent});for(var H=0;H<g.length;H++){var se=g[H];if(!f.hasRenderableParent(se)){var ge=f.getTile(se),we=ge.getBucket(h);if(we){var Te=we.programConfigurations.get(h.id);u.useProgram("heatmap",Te).draw(S,M.TRIANGLES,Ae.disabled,R,N,st.disabled,df(se.posMatrix,ge,u.transform.zoom,h.paint.get("heatmap-intensity")),h.id,we.layoutVertexBuffer,we.indexBuffer,we.segments,h.paint,u.transform.zoom,Te)}}}S.viewport.set([0,0,u.width,u.height])}else u.renderPass==="translucent"&&(u.context.setColorMode(u.colorModeForRenderPass()),function(ze,De){var Ye=ze.context,Le=Ye.gl,Ze=De.heatmapFbo;if(Ze){Ye.activeTexture.set(Le.TEXTURE0),Le.bindTexture(Le.TEXTURE_2D,Ze.colorAttachment.get()),Ye.activeTexture.set(Le.TEXTURE1);var tt=De.colorRampTexture;tt||(tt=De.colorRampTexture=new o.Texture(Ye,De.colorRamp,Le.RGBA)),tt.bind(Le.LINEAR,Le.CLAMP_TO_EDGE),ze.useProgram("heatmapTexture").draw(Ye,Le.TRIANGLES,Ae.disabled,Fe.disabled,ze.colorModeForRenderPass(),st.disabled,function(ut,wt,bt,It){var Dt=o.create();o.ortho(Dt,0,ut.width,ut.height,0,0,1);var Gt=ut.context.gl;return{u_matrix:Dt,u_world:[Gt.drawingBufferWidth,Gt.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:wt.paint.get("heatmap-opacity")}}(ze,De),De.id,ze.viewportBuffer,ze.quadTriangleIndexBuffer,ze.viewportSegments,De.paint,ze.transform.zoom)}}(u,h))},line:function(u,f,h,g){if(u.renderPass==="translucent"){var S=h.paint.get("line-opacity"),M=h.paint.get("line-width");if(S.constantOr(1)!==0&&M.constantOr(1)!==0)for(var R=u.depthModeForSublayer(0,Ae.ReadOnly),N=u.colorModeForRenderPass(),H=h.paint.get("line-dasharray"),se=h.paint.get("line-pattern"),ge=se.constantOr(1),we=h.paint.get("line-gradient"),Te=h.getCrossfadeParameters(),ze=ge?"linePattern":H?"lineSDF":we?"lineGradient":"line",De=u.context,Ye=De.gl,Le=!0,Ze=0,tt=g;Ze<tt.length;Ze+=1){var ut=tt[Ze],wt=f.getTile(ut);if(!ge||wt.patternsLoaded()){var bt=wt.getBucket(h);if(bt){var It=bt.programConfigurations.get(h.id),Dt=u.context.program.get(),Gt=u.useProgram(ze,It),Xt=Le||Gt.program!==Dt,as=se.constantOr(null);if(as&&wt.imageAtlas){var vs=wt.imageAtlas,$s=vs.patternPositions[as.to.toString()],ks=vs.patternPositions[as.from.toString()];$s&&ks&&It.setConstantPatternPositions($s,ks)}var xn=ge?Eu(u,wt,h,Te):H?Zg(u,wt,h,H,Te):we?tr(u,wt,h,bt.lineClipsArray.length):Cd(u,wt,h);if(ge)De.activeTexture.set(Ye.TEXTURE0),wt.imageAtlasTexture.bind(Ye.LINEAR,Ye.CLAMP_TO_EDGE),It.updatePaintBuffers(Te);else if(H&&(Xt||u.lineAtlas.dirty))De.activeTexture.set(Ye.TEXTURE0),u.lineAtlas.bind(De);else if(we){var ps=bt.gradients[h.id],Ls=ps.texture;if(h.gradientVersion!==ps.version){var Qs=256;if(h.stepInterpolant){var qs=f.getSource().maxzoom,zs=ut.canonical.z===qs?Math.ceil(1<<u.transform.maxZoom-ut.canonical.z):1;Qs=o.clamp(o.nextPowerOfTwo(bt.maxLineLength/o.EXTENT*1024*zs),256,De.maxTextureSize)}ps.gradient=o.renderColorRamp({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:Qs,image:ps.gradient||void 0,clips:bt.lineClipsArray}),ps.texture?ps.texture.update(ps.gradient):ps.texture=new o.Texture(De,ps.gradient,Ye.RGBA),ps.version=h.gradientVersion,Ls=ps.texture}De.activeTexture.set(Ye.TEXTURE0),Ls.bind(h.stepInterpolant?Ye.NEAREST:Ye.LINEAR,Ye.CLAMP_TO_EDGE)}Gt.draw(De,Ye.TRIANGLES,R,u.stencilModeForClipping(ut),N,st.disabled,xn,h.id,bt.layoutVertexBuffer,bt.indexBuffer,bt.segments,h.paint,u.transform.zoom,It,bt.layoutVertexBuffer2),Le=!1}}}}},fill:function(u,f,h,g){var S=h.paint.get("fill-color"),M=h.paint.get("fill-opacity");if(M.constantOr(1)!==0){var R=u.colorModeForRenderPass(),N=h.paint.get("fill-pattern"),H=u.opaquePassEnabledForLayer()&&!N.constantOr(1)&&S.constantOr(o.Color.transparent).a===1&&M.constantOr(0)===1?"opaque":"translucent";if(u.renderPass===H){var se=u.depthModeForSublayer(1,u.renderPass==="opaque"?Ae.ReadWrite:Ae.ReadOnly);Uh(u,f,h,g,se,R,!1)}if(u.renderPass==="translucent"&&h.paint.get("fill-antialias")){var ge=u.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,Ae.ReadOnly);Uh(u,f,h,g,ge,R,!0)}}},"fill-extrusion":function(u,f,h,g){var S=h.paint.get("fill-extrusion-opacity");if(S!==0&&u.renderPass==="translucent"){var M=new Ae(u.context.gl.LEQUAL,Ae.ReadWrite,u.depthRangeFor3D);if(S!==1||h.paint.get("fill-extrusion-pattern").constantOr(1))ff(u,f,h,g,M,Fe.disabled,et.disabled),ff(u,f,h,g,M,u.stencilModeFor3D(),u.colorModeForRenderPass());else{var R=u.colorModeForRenderPass();ff(u,f,h,g,M,Fe.disabled,R)}}},hillshade:function(u,f,h,g){if(u.renderPass==="offscreen"||u.renderPass==="translucent"){for(var S=u.context,M=u.depthModeForSublayer(0,Ae.ReadOnly),R=u.colorModeForRenderPass(),N=u.renderPass==="translucent"?u.stencilConfigForOverlap(g):[{},g],H=N[0],se=0,ge=N[1];se<ge.length;se+=1){var we=ge[se],Te=f.getTile(we);Te.needsHillshadePrepare&&u.renderPass==="offscreen"?Ru(u,Te,h,M,Fe.disabled,R):u.renderPass==="translucent"&&Vh(u,Te,h,M,H[we.overscaledZ],R)}S.viewport.set([0,0,u.width,u.height])}},raster:function(u,f,h,g){if(u.renderPass==="translucent"&&h.paint.get("raster-opacity")!==0&&g.length)for(var S=u.context,M=S.gl,R=f.getSource(),N=u.useProgram("raster"),H=u.colorModeForRenderPass(),se=R instanceof J?[{},g]:u.stencilConfigForOverlap(g),ge=se[0],we=se[1],Te=we[we.length-1].overscaledZ,ze=!u.options.moving,De=0,Ye=we;De<Ye.length;De+=1){var Le=Ye[De],Ze=u.depthModeForSublayer(Le.overscaledZ-Te,h.paint.get("raster-opacity")===1?Ae.ReadWrite:Ae.ReadOnly,M.LESS),tt=f.getTile(Le),ut=u.transform.calculatePosMatrix(Le.toUnwrapped(),ze);tt.registerFadeDuration(h.paint.get("raster-fade-duration"));var wt=f.findLoadedParent(Le,0),bt=Mo(tt,wt,f,h,u.transform),It=void 0,Dt=void 0,Gt=h.paint.get("raster-resampling")==="nearest"?M.NEAREST:M.LINEAR;S.activeTexture.set(M.TEXTURE0),tt.texture.bind(Gt,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),S.activeTexture.set(M.TEXTURE1),wt?(wt.texture.bind(Gt,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),It=Math.pow(2,wt.tileID.overscaledZ-tt.tileID.overscaledZ),Dt=[tt.tileID.canonical.x*It%1,tt.tileID.canonical.y*It%1]):tt.texture.bind(Gt,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST);var Xt=hf(ut,Dt||[0,0],It||1,bt,h);R instanceof J?N.draw(S,M.TRIANGLES,Ze,Fe.disabled,H,st.disabled,Xt,h.id,R.boundsBuffer,u.quadTriangleIndexBuffer,R.boundsSegments):N.draw(S,M.TRIANGLES,Ze,ge[Le.overscaledZ],H,st.disabled,Xt,h.id,u.rasterBoundsBuffer,u.quadTriangleIndexBuffer,u.rasterBoundsSegments)}},background:function(u,f,h){var g=h.paint.get("background-color"),S=h.paint.get("background-opacity");if(S!==0){var M=u.context,R=M.gl,N=u.transform,H=N.tileSize,se=h.paint.get("background-pattern");if(!u.isPatternMissing(se)){var ge=!se&&g.a===1&&S===1&&u.opaquePassEnabledForLayer()?"opaque":"translucent";if(u.renderPass===ge){var we=Fe.disabled,Te=u.depthModeForSublayer(0,ge==="opaque"?Ae.ReadWrite:Ae.ReadOnly),ze=u.colorModeForRenderPass(),De=u.useProgram(se?"backgroundPattern":"background"),Ye=N.coveringTiles({tileSize:H});se&&(M.activeTexture.set(R.TEXTURE0),u.imageManager.bind(u.context));for(var Le=h.getCrossfadeParameters(),Ze=0,tt=Ye;Ze<tt.length;Ze+=1){var ut=tt[Ze],wt=u.transform.calculatePosMatrix(ut.toUnwrapped()),bt=se?Pu(wt,S,u,se,{tileID:ut,tileSize:H},Le):Ad(wt,S,g);De.draw(M,R.TRIANGLES,Te,we,ze,st.disabled,bt,h.id,u.tileExtentBuffer,u.quadTriangleIndexBuffer,u.tileExtentSegments)}}}}},debug:function(u,f,h){for(var g=0;g<h.length;g++)Ot(u,f,h[g])},custom:function(u,f,h){var g=u.context,S=h.implementation;if(u.renderPass==="offscreen"){var M=S.prerender;M&&(u.setCustomLayerDefaults(),g.setColorMode(u.colorModeForRenderPass()),M.call(S,g.gl,u.transform.customLayerMatrix()),g.setDirty(),u.setBaseState())}else if(u.renderPass==="translucent"){u.setCustomLayerDefaults(),g.setColorMode(u.colorModeForRenderPass()),g.setStencilMode(Fe.disabled);var R=S.renderingMode==="3d"?new Ae(u.context.gl.LEQUAL,Ae.ReadWrite,u.depthRangeFor3D):u.depthModeForSublayer(0,Ae.ReadOnly);g.setDepthMode(R),S.render(g.gl,u.transform.customLayerMatrix()),g.setDirty(),u.setBaseState(),g.bindFramebuffer.set(null)}}},rs=function(u,f){this.context=new xe(u),this.transform=f,this._tileTextures={},this.setup(),this.numSublayers=Ve.maxUnderzooming+Ve.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Hl,this.gpuTimers={}};rs.prototype.resize=function(u,f){if(this.width=u*o.browser.devicePixelRatio,this.height=f*o.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var h=0,g=this.style._order;h<g.length;h+=1)this.style._layers[g[h]].resize()},rs.prototype.setup=function(){var u=this.context,f=new o.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(o.EXTENT,0),f.emplaceBack(0,o.EXTENT),f.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=u.createVertexBuffer(f,Xr.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);var h=new o.StructArrayLayout2i4;h.emplaceBack(0,0),h.emplaceBack(o.EXTENT,0),h.emplaceBack(0,o.EXTENT),h.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=u.createVertexBuffer(h,Xr.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);var g=new o.StructArrayLayout4i8;g.emplaceBack(0,0,0,0),g.emplaceBack(o.EXTENT,0,o.EXTENT,0),g.emplaceBack(0,o.EXTENT,0,o.EXTENT),g.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.rasterBoundsBuffer=u.createVertexBuffer(g,Y.members),this.rasterBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);var S=new o.StructArrayLayout2i4;S.emplaceBack(0,0),S.emplaceBack(1,0),S.emplaceBack(0,1),S.emplaceBack(1,1),this.viewportBuffer=u.createVertexBuffer(S,Xr.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);var M=new o.StructArrayLayout1ui2;M.emplaceBack(0),M.emplaceBack(1),M.emplaceBack(3),M.emplaceBack(2),M.emplaceBack(0),this.tileBorderIndexBuffer=u.createIndexBuffer(M);var R=new o.StructArrayLayout3ui6;R.emplaceBack(0,1,2),R.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=u.createIndexBuffer(R),this.emptyTexture=new o.Texture(u,{width:1,height:1,data:new Uint8Array([0,0,0,0])},u.gl.RGBA);var N=this.context.gl;this.stencilClearMode=new Fe({func:N.ALWAYS,mask:0},0,255,N.ZERO,N.ZERO,N.ZERO)},rs.prototype.clearStencil=function(){var u=this.context,f=u.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var h=o.create();o.ortho(h,0,this.width,this.height,0,0,1),o.scale(h,h,[f.drawingBufferWidth,f.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(u,f.TRIANGLES,Ae.disabled,this.stencilClearMode,et.disabled,st.disabled,gl(h),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},rs.prototype._renderTileClippingMasks=function(u,f){if(this.currentStencilSource!==u.source&&u.isTileClipped()&&f&&f.length){this.currentStencilSource=u.source;var h=this.context,g=h.gl;this.nextStencilID+f.length>256&&this.clearStencil(),h.setColorMode(et.disabled),h.setDepthMode(Ae.disabled);var S=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var M=0,R=f;M<R.length;M+=1){var N=R[M],H=this._tileClippingMaskIDs[N.key]=this.nextStencilID++;S.draw(h,g.TRIANGLES,Ae.disabled,new Fe({func:g.ALWAYS,mask:0},H,255,g.KEEP,g.KEEP,g.REPLACE),et.disabled,st.disabled,gl(N.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},rs.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var u=this.nextStencilID++,f=this.context.gl;return new Fe({func:f.NOTEQUAL,mask:255},u,255,f.KEEP,f.KEEP,f.REPLACE)},rs.prototype.stencilModeForClipping=function(u){var f=this.context.gl;return new Fe({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[u.key],0,f.KEEP,f.KEEP,f.REPLACE)},rs.prototype.stencilConfigForOverlap=function(u){var f,h=this.context.gl,g=u.sort(function(H,se){return se.overscaledZ-H.overscaledZ}),S=g[g.length-1].overscaledZ,M=g[0].overscaledZ-S+1;if(M>1){this.currentStencilSource=void 0,this.nextStencilID+M>256&&this.clearStencil();for(var R={},N=0;N<M;N++)R[N+S]=new Fe({func:h.GEQUAL,mask:255},N+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=M,[R,g]}return[(f={},f[S]=Fe.disabled,f),g]},rs.prototype.colorModeForRenderPass=function(){var u=this.context.gl;return this._showOverdrawInspector?new et([u.CONSTANT_COLOR,u.ONE],new o.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?et.unblended:et.alphaBlended},rs.prototype.depthModeForSublayer=function(u,f,h){if(!this.opaquePassEnabledForLayer())return Ae.disabled;var g=1-((1+this.currentLayer)*this.numSublayers+u)*this.depthEpsilon;return new Ae(h||this.context.gl.LEQUAL,f,[g,g])},rs.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},rs.prototype.render=function(u,f){var h=this;this.style=u,this.options=f,this.lineAtlas=u.lineAtlas,this.imageManager=u.imageManager,this.glyphManager=u.glyphManager,this.symbolFadeChange=u.placement.symbolFadeChange(o.browser.now()),this.imageManager.beginFrame();var g=this.style._order,S=this.style.sourceCaches;for(var M in S){var R=S[M];R.used&&R.prepare(this.context)}var N,H,se={},ge={},we={};for(var Te in S){var ze=S[Te];se[Te]=ze.getVisibleCoordinates(),ge[Te]=se[Te].slice().reverse(),we[Te]=ze.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var De=0;De<g.length;De++)if(this.style._layers[g[De]].is3D()){this.opaquePassCutoff=De;break}this.renderPass="offscreen";for(var Ye=0,Le=g;Ye<Le.length;Ye+=1){var Ze=this.style._layers[Le[Ye]];if(Ze.hasOffscreenPass()&&!Ze.isHidden(this.transform.zoom)){var tt=ge[Ze.source];(Ze.type==="custom"||tt.length)&&this.renderLayer(this,S[Ze.source],Ze,tt)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:f.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=f.showOverdrawInspector,this.depthRangeFor3D=[0,1-(u._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){var ut=this.style._layers[g[this.currentLayer]],wt=S[ut.source],bt=se[ut.source];this._renderTileClippingMasks(ut,bt),this.renderLayer(this,wt,ut,bt)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){var It=this.style._layers[g[this.currentLayer]],Dt=S[It.source],Gt=(It.type==="symbol"?we:ge)[It.source];this._renderTileClippingMasks(It,se[It.source]),this.renderLayer(this,Dt,It,Gt)}this.options.showTileBoundaries&&(o.values(this.style._layers).forEach(function(Xt){Xt.source&&!Xt.isHidden(h.transform.zoom)&&(Xt.source!==(H&&H.id)&&(H=h.style.sourceCaches[Xt.source]),(!N||N.getSource().maxzoom<H.getSource().maxzoom)&&(N=H))}),N&&Mt.debug(this,N,N.getVisibleCoordinates())),this.options.showPadding&&function(Xt){var as=Xt.transform.padding;_f(Xt,Xt.transform.height-(as.top||0),3,jh),_f(Xt,as.bottom||0,3,Wm),tc(Xt,as.left||0,3,Ym),tc(Xt,Xt.transform.width-(as.right||0),3,qh);var vs=Xt.transform.centerPoint;(function($s,ks,xn,ps){dt($s,ks-1,xn-10,2,20,ps),dt($s,ks-10,xn-1,20,2,ps)})(Xt,vs.x,Xt.transform.height-vs.y,mf)}(this),this.context.setDefault()},rs.prototype.renderLayer=function(u,f,h,g){h.isHidden(this.transform.zoom)||(h.type==="background"||h.type==="custom"||g.length)&&(this.id=h.id,this.gpuTimingStart(h),Mt[h.type](u,f,h,g,this.style.placement.variableOffsets),this.gpuTimingEnd())},rs.prototype.gpuTimingStart=function(u){if(this.options.gpuTiming){var f=this.context.extTimerQuery,h=this.gpuTimers[u.id];h||(h=this.gpuTimers[u.id]={calls:0,cpuTime:0,query:f.createQueryEXT()}),h.calls++,f.beginQueryEXT(f.TIME_ELAPSED_EXT,h.query)}},rs.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var u=this.context.extTimerQuery;u.endQueryEXT(u.TIME_ELAPSED_EXT)}},rs.prototype.collectGpuTimers=function(){var u=this.gpuTimers;return this.gpuTimers={},u},rs.prototype.queryGpuTimers=function(u){var f={};for(var h in u){var g=u[h],S=this.context.extTimerQuery,M=S.getQueryObjectEXT(g.query,S.QUERY_RESULT_EXT)/1e6;S.deleteQueryEXT(g.query),f[h]=M}return f},rs.prototype.translatePosMatrix=function(u,f,h,g,S){if(!h[0]&&!h[1])return u;var M=S?g==="map"?this.transform.angle:0:g==="viewport"?-this.transform.angle:0;if(M){var R=Math.sin(M),N=Math.cos(M);h=[h[0]*N-h[1]*R,h[0]*R+h[1]*N]}var H=[S?h[0]:Sr(f,h[0],this.transform.zoom),S?h[1]:Sr(f,h[1],this.transform.zoom),0],se=new Float32Array(16);return o.translate(se,u,H),se},rs.prototype.saveTileTexture=function(u){var f=this._tileTextures[u.size[0]];f?f.push(u):this._tileTextures[u.size[0]]=[u]},rs.prototype.getTileTexture=function(u){var f=this._tileTextures[u];return f&&f.length>0?f.pop():null},rs.prototype.isPatternMissing=function(u){if(!u)return!1;if(!u.from||!u.to)return!0;var f=this.imageManager.getPattern(u.from.toString()),h=this.imageManager.getPattern(u.to.toString());return!f||!h},rs.prototype.useProgram=function(u,f){this.cache=this.cache||{};var h=""+u+(f?f.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[h]||(this.cache[h]=new jm(this.context,u,Fr[u],f,Hm[u],this._showOverdrawInspector)),this.cache[h]},rs.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},rs.prototype.setBaseState=function(){var u=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(u.FUNC_ADD)},rs.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=o.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},rs.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var on=function(u,f){this.points=u,this.planes=f};on.fromInvProjectionMatrix=function(u,f,h){var g=Math.pow(2,h),S=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(R){return o.transformMat4([],R,u)}).map(function(R){return o.scale$1([],R,1/R[3]/f*g)}),M=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(R){var N=o.sub([],S[R[0]],S[R[1]]),H=o.sub([],S[R[2]],S[R[1]]),se=o.normalize([],o.cross([],N,H)),ge=-o.dot(se,S[R[1]]);return se.concat(ge)});return new on(S,M)};var En=function(u,f){this.min=u,this.max=f,this.center=o.scale$2([],o.add([],this.min,this.max),.5)};En.prototype.quadrant=function(u){for(var f=[u%2==0,u<2],h=o.clone$2(this.min),g=o.clone$2(this.max),S=0;S<f.length;S++)h[S]=f[S]?this.min[S]:this.center[S],g[S]=f[S]?this.center[S]:this.max[S];return g[2]=this.max[2],new En(h,g)},En.prototype.distanceX=function(u){return Math.max(Math.min(this.max[0],u[0]),this.min[0])-u[0]},En.prototype.distanceY=function(u){return Math.max(Math.min(this.max[1],u[1]),this.min[1])-u[1]},En.prototype.intersects=function(u){for(var f=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],h=!0,g=0;g<u.planes.length;g++){for(var S=u.planes[g],M=0,R=0;R<f.length;R++)M+=o.dot$1(S,f[R])>=0;if(M===0)return 0;M!==f.length&&(h=!1)}if(h)return 2;for(var N=0;N<3;N++){for(var H=Number.MAX_VALUE,se=-Number.MAX_VALUE,ge=0;ge<u.points.length;ge++){var we=u.points[ge][N]-this.min[N];H=Math.min(H,we),se=Math.max(se,we)}if(se<0||H>this.max[N]-this.min[N])return 0}return 1};var Er=function(u,f,h,g){if(u===void 0&&(u=0),f===void 0&&(f=0),h===void 0&&(h=0),g===void 0&&(g=0),isNaN(u)||u<0||isNaN(f)||f<0||isNaN(h)||h<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=u,this.bottom=f,this.left=h,this.right=g};Er.prototype.interpolate=function(u,f,h){return f.top!=null&&u.top!=null&&(this.top=o.number(u.top,f.top,h)),f.bottom!=null&&u.bottom!=null&&(this.bottom=o.number(u.bottom,f.bottom,h)),f.left!=null&&u.left!=null&&(this.left=o.number(u.left,f.left,h)),f.right!=null&&u.right!=null&&(this.right=o.number(u.right,f.right,h)),this},Er.prototype.getCenter=function(u,f){var h=o.clamp((this.left+u-this.right)/2,0,u),g=o.clamp((this.top+f-this.bottom)/2,0,f);return new o.Point(h,g)},Er.prototype.equals=function(u){return this.top===u.top&&this.bottom===u.bottom&&this.left===u.left&&this.right===u.right},Er.prototype.clone=function(){return new Er(this.top,this.bottom,this.left,this.right)},Er.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Es=function(u,f,h,g,S){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=S===void 0||S,this._minZoom=u||0,this._maxZoom=f||22,this._minPitch=h==null?0:h,this._maxPitch=g==null?60:g,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Er,this._posMatrixCache={},this._alignedPosMatrixCache={}},sr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Es.prototype.clone=function(){var u=new Es(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return u.tileSize=this.tileSize,u.latRange=this.latRange,u.width=this.width,u.height=this.height,u._center=this._center,u.zoom=this.zoom,u.angle=this.angle,u._fov=this._fov,u._pitch=this._pitch,u._unmodified=this._unmodified,u._edgeInsets=this._edgeInsets.clone(),u._calcMatrices(),u},sr.minZoom.get=function(){return this._minZoom},sr.minZoom.set=function(u){this._minZoom!==u&&(this._minZoom=u,this.zoom=Math.max(this.zoom,u))},sr.maxZoom.get=function(){return this._maxZoom},sr.maxZoom.set=function(u){this._maxZoom!==u&&(this._maxZoom=u,this.zoom=Math.min(this.zoom,u))},sr.minPitch.get=function(){return this._minPitch},sr.minPitch.set=function(u){this._minPitch!==u&&(this._minPitch=u,this.pitch=Math.max(this.pitch,u))},sr.maxPitch.get=function(){return this._maxPitch},sr.maxPitch.set=function(u){this._maxPitch!==u&&(this._maxPitch=u,this.pitch=Math.min(this.pitch,u))},sr.renderWorldCopies.get=function(){return this._renderWorldCopies},sr.renderWorldCopies.set=function(u){u===void 0?u=!0:u===null&&(u=!1),this._renderWorldCopies=u},sr.worldSize.get=function(){return this.tileSize*this.scale},sr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},sr.size.get=function(){return new o.Point(this.width,this.height)},sr.bearing.get=function(){return-this.angle/Math.PI*180},sr.bearing.set=function(u){var f=-o.wrap(u,-180,180)*Math.PI/180;this.angle!==f&&(this._unmodified=!1,this.angle=f,this._calcMatrices(),this.rotationMatrix=o.create$2(),o.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},sr.pitch.get=function(){return this._pitch/Math.PI*180},sr.pitch.set=function(u){var f=o.clamp(u,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==f&&(this._unmodified=!1,this._pitch=f,this._calcMatrices())},sr.fov.get=function(){return this._fov/Math.PI*180},sr.fov.set=function(u){u=Math.max(.01,Math.min(60,u)),this._fov!==u&&(this._unmodified=!1,this._fov=u/180*Math.PI,this._calcMatrices())},sr.zoom.get=function(){return this._zoom},sr.zoom.set=function(u){var f=Math.min(Math.max(u,this.minZoom),this.maxZoom);this._zoom!==f&&(this._unmodified=!1,this._zoom=f,this.scale=this.zoomScale(f),this.tileZoom=Math.floor(f),this.zoomFraction=f-this.tileZoom,this._constrain(),this._calcMatrices())},sr.center.get=function(){return this._center},sr.center.set=function(u){u.lat===this._center.lat&&u.lng===this._center.lng||(this._unmodified=!1,this._center=u,this._constrain(),this._calcMatrices())},sr.padding.get=function(){return this._edgeInsets.toJSON()},sr.padding.set=function(u){this._edgeInsets.equals(u)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,u,1),this._calcMatrices())},sr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Es.prototype.isPaddingEqual=function(u){return this._edgeInsets.equals(u)},Es.prototype.interpolatePadding=function(u,f,h){this._unmodified=!1,this._edgeInsets.interpolate(u,f,h),this._constrain(),this._calcMatrices()},Es.prototype.coveringZoomLevel=function(u){var f=(u.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/u.tileSize));return Math.max(0,f)},Es.prototype.getVisibleUnwrappedCoordinates=function(u){var f=[new o.UnwrappedTileID(0,u)];if(this._renderWorldCopies)for(var h=this.pointCoordinate(new o.Point(0,0)),g=this.pointCoordinate(new o.Point(this.width,0)),S=this.pointCoordinate(new o.Point(this.width,this.height)),M=this.pointCoordinate(new o.Point(0,this.height)),R=Math.floor(Math.min(h.x,g.x,S.x,M.x)),N=Math.floor(Math.max(h.x,g.x,S.x,M.x)),H=R-1;H<=N+1;H++)H!==0&&f.push(new o.UnwrappedTileID(H,u));return f},Es.prototype.coveringTiles=function(u){var f=this.coveringZoomLevel(u),h=f;if(u.minzoom!==void 0&&f<u.minzoom)return[];u.maxzoom!==void 0&&f>u.maxzoom&&(f=u.maxzoom);var g=o.MercatorCoordinate.fromLngLat(this.center),S=Math.pow(2,f),M=[S*g.x,S*g.y,0],R=on.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,f),N=u.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(N=f);var H=function(Xt){return{aabb:new En([Xt*S,0,0],[(Xt+1)*S,S,0]),zoom:0,x:0,y:0,wrap:Xt,fullyVisible:!1}},se=[],ge=[],we=f,Te=u.reparseOverscaled?h:f;if(this._renderWorldCopies)for(var ze=1;ze<=3;ze++)se.push(H(-ze)),se.push(H(ze));for(se.push(H(0));se.length>0;){var De=se.pop(),Ye=De.x,Le=De.y,Ze=De.fullyVisible;if(!Ze){var tt=De.aabb.intersects(R);if(tt===0)continue;Ze=tt===2}var ut=De.aabb.distanceX(M),wt=De.aabb.distanceY(M),bt=Math.max(Math.abs(ut),Math.abs(wt));if(De.zoom===we||bt>3+(1<<we-De.zoom)-2&&De.zoom>=N)ge.push({tileID:new o.OverscaledTileID(De.zoom===we?Te:De.zoom,De.wrap,De.zoom,Ye,Le),distanceSq:o.sqrLen([M[0]-.5-Ye,M[1]-.5-Le])});else for(var It=0;It<4;It++){var Dt=(Ye<<1)+It%2,Gt=(Le<<1)+(It>>1);se.push({aabb:De.aabb.quadrant(It),zoom:De.zoom+1,x:Dt,y:Gt,wrap:De.wrap,fullyVisible:Ze})}}return ge.sort(function(Xt,as){return Xt.distanceSq-as.distanceSq}).map(function(Xt){return Xt.tileID})},Es.prototype.resize=function(u,f){this.width=u,this.height=f,this.pixelsToGLUnits=[2/u,-2/f],this._constrain(),this._calcMatrices()},sr.unmodified.get=function(){return this._unmodified},Es.prototype.zoomScale=function(u){return Math.pow(2,u)},Es.prototype.scaleZoom=function(u){return Math.log(u)/Math.LN2},Es.prototype.project=function(u){var f=o.clamp(u.lat,-this.maxValidLatitude,this.maxValidLatitude);return new o.Point(o.mercatorXfromLng(u.lng)*this.worldSize,o.mercatorYfromLat(f)*this.worldSize)},Es.prototype.unproject=function(u){return new o.MercatorCoordinate(u.x/this.worldSize,u.y/this.worldSize).toLngLat()},sr.point.get=function(){return this.project(this.center)},Es.prototype.setLocationAtPoint=function(u,f){var h=this.pointCoordinate(f),g=this.pointCoordinate(this.centerPoint),S=this.locationCoordinate(u),M=new o.MercatorCoordinate(S.x-(h.x-g.x),S.y-(h.y-g.y));this.center=this.coordinateLocation(M),this._renderWorldCopies&&(this.center=this.center.wrap())},Es.prototype.locationPoint=function(u){return this.coordinatePoint(this.locationCoordinate(u))},Es.prototype.pointLocation=function(u){return this.coordinateLocation(this.pointCoordinate(u))},Es.prototype.locationCoordinate=function(u){return o.MercatorCoordinate.fromLngLat(u)},Es.prototype.coordinateLocation=function(u){return u.toLngLat()},Es.prototype.pointCoordinate=function(u){var f=[u.x,u.y,0,1],h=[u.x,u.y,1,1];o.transformMat4(f,f,this.pixelMatrixInverse),o.transformMat4(h,h,this.pixelMatrixInverse);var g=f[3],S=h[3],M=f[1]/g,R=h[1]/S,N=f[2]/g,H=h[2]/S,se=N===H?0:(0-N)/(H-N);return new o.MercatorCoordinate(o.number(f[0]/g,h[0]/S,se)/this.worldSize,o.number(M,R,se)/this.worldSize)},Es.prototype.coordinatePoint=function(u){var f=[u.x*this.worldSize,u.y*this.worldSize,0,1];return o.transformMat4(f,f,this.pixelMatrix),new o.Point(f[0]/f[3],f[1]/f[3])},Es.prototype.getBounds=function(){return new o.LngLatBounds().extend(this.pointLocation(new o.Point(0,0))).extend(this.pointLocation(new o.Point(this.width,0))).extend(this.pointLocation(new o.Point(this.width,this.height))).extend(this.pointLocation(new o.Point(0,this.height)))},Es.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new o.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Es.prototype.setMaxBounds=function(u){u?(this.lngRange=[u.getWest(),u.getEast()],this.latRange=[u.getSouth(),u.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Es.prototype.calculatePosMatrix=function(u,f){f===void 0&&(f=!1);var h=u.key,g=f?this._alignedPosMatrixCache:this._posMatrixCache;if(g[h])return g[h];var S=u.canonical,M=this.worldSize/this.zoomScale(S.z),R=S.x+Math.pow(2,S.z)*u.wrap,N=o.identity(new Float64Array(16));return o.translate(N,N,[R*M,S.y*M,0]),o.scale(N,N,[M/o.EXTENT,M/o.EXTENT,1]),o.multiply(N,f?this.alignedProjMatrix:this.projMatrix,N),g[h]=new Float32Array(N),g[h]},Es.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Es.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var u,f,h,g,S=-90,M=90,R=-180,N=180,H=this.size,se=this._unmodified;if(this.latRange){var ge=this.latRange;S=o.mercatorYfromLat(ge[1])*this.worldSize,u=(M=o.mercatorYfromLat(ge[0])*this.worldSize)-S<H.y?H.y/(M-S):0}if(this.lngRange){var we=this.lngRange;R=o.mercatorXfromLng(we[0])*this.worldSize,f=(N=o.mercatorXfromLng(we[1])*this.worldSize)-R<H.x?H.x/(N-R):0}var Te=this.point,ze=Math.max(f||0,u||0);if(ze)return this.center=this.unproject(new o.Point(f?(N+R)/2:Te.x,u?(M+S)/2:Te.y)),this.zoom+=this.scaleZoom(ze),this._unmodified=se,void(this._constraining=!1);if(this.latRange){var De=Te.y,Ye=H.y/2;De-Ye<S&&(g=S+Ye),De+Ye>M&&(g=M-Ye)}if(this.lngRange){var Le=Te.x,Ze=H.x/2;Le-Ze<R&&(h=R+Ze),Le+Ze>N&&(h=N-Ze)}h===void 0&&g===void 0||(this.center=this.unproject(new o.Point(h!==void 0?h:Te.x,g!==void 0?g:Te.y))),this._unmodified=se,this._constraining=!1}},Es.prototype._calcMatrices=function(){if(this.height){var u=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var f=Math.PI/2+this._pitch,h=this._fov*(.5+u.y/this.height),g=Math.sin(h)*this.cameraToCenterDistance/Math.sin(o.clamp(Math.PI-f-h,.01,Math.PI-.01)),S=this.point,M=S.x,R=S.y,N=1.01*(Math.cos(Math.PI/2-this._pitch)*g+this.cameraToCenterDistance),H=this.height/50,se=new Float64Array(16);o.perspective(se,this._fov,this.width/this.height,H,N),se[8]=2*-u.x/this.width,se[9]=2*u.y/this.height,o.scale(se,se,[1,-1,1]),o.translate(se,se,[0,0,-this.cameraToCenterDistance]),o.rotateX(se,se,this._pitch),o.rotateZ(se,se,this.angle),o.translate(se,se,[-M,-R,0]),this.mercatorMatrix=o.scale([],se,[this.worldSize,this.worldSize,this.worldSize]),o.scale(se,se,[1,1,o.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=se,this.invProjMatrix=o.invert([],this.projMatrix);var ge=this.width%2/2,we=this.height%2/2,Te=Math.cos(this.angle),ze=Math.sin(this.angle),De=M-Math.round(M)+Te*ge+ze*we,Ye=R-Math.round(R)+Te*we+ze*ge,Le=new Float64Array(se);if(o.translate(Le,Le,[De>.5?De-1:De,Ye>.5?Ye-1:Ye,0]),this.alignedProjMatrix=Le,se=o.create(),o.scale(se,se,[this.width/2,-this.height/2,1]),o.translate(se,se,[1,-1,0]),this.labelPlaneMatrix=se,se=o.create(),o.scale(se,se,[1,-1,1]),o.translate(se,se,[-1,-1,0]),o.scale(se,se,[2/this.width,2/this.height,1]),this.glCoordMatrix=se,this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(se=o.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=se,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Es.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var u=this.pointCoordinate(new o.Point(0,0)),f=[u.x*this.worldSize,u.y*this.worldSize,0,1];return o.transformMat4(f,f,this.pixelMatrix)[3]/this.cameraToCenterDistance},Es.prototype.getCameraPoint=function(){var u=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.Point(0,u))},Es.prototype.getCameraQueryGeometry=function(u){var f=this.getCameraPoint();if(u.length===1)return[u[0],f];for(var h=f.x,g=f.y,S=f.x,M=f.y,R=0,N=u;R<N.length;R+=1){var H=N[R];h=Math.min(h,H.x),g=Math.min(g,H.y),S=Math.max(S,H.x),M=Math.max(M,H.y)}return[new o.Point(h,g),new o.Point(S,g),new o.Point(S,M),new o.Point(h,M),new o.Point(h,g)]},Object.defineProperties(Es.prototype,sr);var Uo=function(u){var f,h,g,S;this._hashName=u&&encodeURIComponent(u),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(f=this._updateHashUnthrottled.bind(this),h=!1,g=null,S=function(){g=null,h&&(f(),g=setTimeout(S,300),h=!1)},function(){return h=!0,g||S(),g})};Uo.prototype.addTo=function(u){return this._map=u,o.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Uo.prototype.remove=function(){return o.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Uo.prototype.getHashString=function(u){var f=this._map.getCenter(),h=Math.round(100*this._map.getZoom())/100,g=Math.ceil((h*Math.LN2+Math.log(512/360/.5))/Math.LN10),S=Math.pow(10,g),M=Math.round(f.lng*S)/S,R=Math.round(f.lat*S)/S,N=this._map.getBearing(),H=this._map.getPitch(),se="";if(se+=u?"/"+M+"/"+R+"/"+h:h+"/"+R+"/"+M,(N||H)&&(se+="/"+Math.round(10*N)/10),H&&(se+="/"+Math.round(H)),this._hashName){var ge=this._hashName,we=!1,Te=o.window.location.hash.slice(1).split("&").map(function(ze){var De=ze.split("=")[0];return De===ge?(we=!0,De+"="+se):ze}).filter(function(ze){return ze});return we||Te.push(ge+"="+se),"#"+Te.join("&")}return"#"+se},Uo.prototype._getCurrentHash=function(){var u,f=this,h=o.window.location.hash.replace("#","");return this._hashName?(h.split("&").map(function(g){return g.split("=")}).forEach(function(g){g[0]===f._hashName&&(u=g)}),(u&&u[1]||"").split("/")):h.split("/")},Uo.prototype._onHashChange=function(){var u=this._getCurrentHash();if(u.length>=3&&!u.some(function(h){return isNaN(h)})){var f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:f,pitch:+(u[4]||0)}),!0}return!1},Uo.prototype._updateHashUnthrottled=function(){var u=o.window.location.href.replace(/(#.+)?$/,this.getHashString());try{o.window.history.replaceState(o.window.history.state,null,u)}catch{}};var no={linearity:.3,easing:o.bezier(0,0,.3,1)},yl=o.extend({deceleration:2500,maxSpeed:1400},no),Md=o.extend({deceleration:20,maxSpeed:1400},no),$u=o.extend({deceleration:1e3,maxSpeed:360},no),Hh=o.extend({deceleration:1e3,maxSpeed:90},no),sc=function(u){this._map=u,this.clear()};function Wn(u,f){(!u.duration||u.duration<f.duration)&&(u.duration=f.duration,u.easing=f.easing)}function vl(u,f,h){var g=h.maxSpeed,S=h.linearity,M=h.deceleration,R=o.clamp(u*S/(f/1e3),-g,g),N=Math.abs(R)/(M*S);return{easing:h.easing,duration:1e3*N,amount:R*(N/2)}}sc.prototype.clear=function(){this._inertiaBuffer=[]},sc.prototype.record=function(u){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.browser.now(),settings:u})},sc.prototype._drainInertiaBuffer=function(){for(var u=this._inertiaBuffer,f=o.browser.now();u.length>0&&f-u[0].time>160;)u.shift()},sc.prototype._onMoveEnd=function(u){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var f={zoom:0,bearing:0,pitch:0,pan:new o.Point(0,0),pinchAround:void 0,around:void 0},h=0,g=this._inertiaBuffer;h<g.length;h+=1){var S=g[h].settings;f.zoom+=S.zoomDelta||0,f.bearing+=S.bearingDelta||0,f.pitch+=S.pitchDelta||0,S.panDelta&&f.pan._add(S.panDelta),S.around&&(f.around=S.around),S.pinchAround&&(f.pinchAround=S.pinchAround)}var M=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,R={};if(f.pan.mag()){var N=vl(f.pan.mag(),M,o.extend({},yl,u||{}));R.offset=f.pan.mult(N.amount/f.pan.mag()),R.center=this._map.transform.center,Wn(R,N)}if(f.zoom){var H=vl(f.zoom,M,Md);R.zoom=this._map.transform.zoom+H.amount,Wn(R,H)}if(f.bearing){var se=vl(f.bearing,M,$u);R.bearing=this._map.transform.bearing+o.clamp(se.amount,-179,179),Wn(R,se)}if(f.pitch){var ge=vl(f.pitch,M,Hh);R.pitch=this._map.transform.pitch+ge.amount,Wn(R,ge)}if(R.zoom||R.bearing){var we=f.pinchAround===void 0?f.around:f.pinchAround;R.around=we?this._map.unproject(we):this._map.getCenter()}return this.clear(),o.extend(R,{noMoveStart:!0})}};var Kr=function(u){function f(g,S,M,R){R===void 0&&(R={});var N=p.mousePos(S.getCanvasContainer(),M),H=S.unproject(N);u.call(this,g,o.extend({point:N,lngLat:H,originalEvent:M},R)),this._defaultPrevented=!1,this.target=S}u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f;var h={defaultPrevented:{configurable:!0}};return f.prototype.preventDefault=function(){this._defaultPrevented=!0},h.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(f.prototype,h),f}(o.Event),nc=function(u){function f(g,S,M){var R=g==="touchend"?M.changedTouches:M.touches,N=p.touchPos(S.getCanvasContainer(),R),H=N.map(function(we){return S.unproject(we)}),se=N.reduce(function(we,Te,ze,De){return we.add(Te.div(De.length))},new o.Point(0,0)),ge=S.unproject(se);u.call(this,g,{points:N,point:se,lngLats:H,lngLat:ge,originalEvent:M}),this._defaultPrevented=!1}u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f;var h={defaultPrevented:{configurable:!0}};return f.prototype.preventDefault=function(){this._defaultPrevented=!0},h.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(f.prototype,h),f}(o.Event),Zm=function(u){function f(g,S,M){u.call(this,g,{originalEvent:M}),this._defaultPrevented=!1}u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f;var h={defaultPrevented:{configurable:!0}};return f.prototype.preventDefault=function(){this._defaultPrevented=!0},h.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(f.prototype,h),f}(o.Event),Jr=function(u,f){this._map=u,this._clickTolerance=f.clickTolerance};Jr.prototype.reset=function(){delete this._mousedownPos},Jr.prototype.wheel=function(u){return this._firePreventable(new Zm(u.type,this._map,u))},Jr.prototype.mousedown=function(u,f){return this._mousedownPos=f,this._firePreventable(new Kr(u.type,this._map,u))},Jr.prototype.mouseup=function(u){this._map.fire(new Kr(u.type,this._map,u))},Jr.prototype.click=function(u,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||this._map.fire(new Kr(u.type,this._map,u))},Jr.prototype.dblclick=function(u){return this._firePreventable(new Kr(u.type,this._map,u))},Jr.prototype.mouseover=function(u){this._map.fire(new Kr(u.type,this._map,u))},Jr.prototype.mouseout=function(u){this._map.fire(new Kr(u.type,this._map,u))},Jr.prototype.touchstart=function(u){return this._firePreventable(new nc(u.type,this._map,u))},Jr.prototype.touchmove=function(u){this._map.fire(new nc(u.type,this._map,u))},Jr.prototype.touchend=function(u){this._map.fire(new nc(u.type,this._map,u))},Jr.prototype.touchcancel=function(u){this._map.fire(new nc(u.type,this._map,u))},Jr.prototype._firePreventable=function(u){if(this._map.fire(u),u.defaultPrevented)return{}},Jr.prototype.isEnabled=function(){return!0},Jr.prototype.isActive=function(){return!1},Jr.prototype.enable=function(){},Jr.prototype.disable=function(){};var _s=function(u){this._map=u};_s.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},_s.prototype.mousemove=function(u){this._map.fire(new Kr(u.type,this._map,u))},_s.prototype.mousedown=function(){this._delayContextMenu=!0},_s.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Kr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},_s.prototype.contextmenu=function(u){this._delayContextMenu?this._contextMenuEvent=u:this._map.fire(new Kr(u.type,this._map,u)),this._map.listens("contextmenu")&&u.preventDefault()},_s.prototype.isEnabled=function(){return!0},_s.prototype.isActive=function(){return!1},_s.prototype.enable=function(){},_s.prototype.disable=function(){};var Fi=function(u,f){this._map=u,this._el=u.getCanvasContainer(),this._container=u.getContainer(),this._clickTolerance=f.clickTolerance||1};function ka(u,f){for(var h={},g=0;g<u.length;g++)h[u[g].identifier]=f[g];return h}Fi.prototype.isEnabled=function(){return!!this._enabled},Fi.prototype.isActive=function(){return!!this._active},Fi.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Fi.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Fi.prototype.mousedown=function(u,f){this.isEnabled()&&u.shiftKey&&u.button===0&&(p.disableDrag(),this._startPos=this._lastPos=f,this._active=!0)},Fi.prototype.mousemoveWindow=function(u,f){if(this._active){var h=f;if(!(this._lastPos.equals(h)||!this._box&&h.dist(this._startPos)<this._clickTolerance)){var g=this._startPos;this._lastPos=h,this._box||(this._box=p.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",u));var S=Math.min(g.x,h.x),M=Math.max(g.x,h.x),R=Math.min(g.y,h.y),N=Math.max(g.y,h.y);p.setTransform(this._box,"translate("+S+"px,"+R+"px)"),this._box.style.width=M-S+"px",this._box.style.height=N-R+"px"}}},Fi.prototype.mouseupWindow=function(u,f){var h=this;if(this._active&&u.button===0){var g=this._startPos,S=f;if(this.reset(),p.suppressClick(),g.x!==S.x||g.y!==S.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:u})),{cameraAnimation:function(M){return M.fitScreenCoordinates(g,S,h._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",u)}},Fi.prototype.keydown=function(u){this._active&&u.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",u))},Fi.prototype.blur=function(){this.reset()},Fi.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(p.remove(this._box),this._box=null),p.enableDrag(),delete this._startPos,delete this._lastPos},Fi.prototype._fireEvent=function(u,f){return this._map.fire(new o.Event(u,{originalEvent:f}))};var bl=function(u){this.reset(),this.numTouches=u.numTouches};bl.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},bl.prototype.touchstart=function(u,f,h){(this.centroid||h.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=u.timeStamp),h.length===this.numTouches&&(this.centroid=function(g){for(var S=new o.Point(0,0),M=0,R=g;M<R.length;M+=1)S._add(R[M]);return S.div(g.length)}(f),this.touches=ka(h,f)))},bl.prototype.touchmove=function(u,f,h){if(!this.aborted&&this.centroid){var g=ka(h,f);for(var S in this.touches){var M=g[S];(!M||M.dist(this.touches[S])>30)&&(this.aborted=!0)}}},bl.prototype.touchend=function(u,f,h){if((!this.centroid||u.timeStamp-this.startTime>500)&&(this.aborted=!0),h.length===0){var g=!this.aborted&&this.centroid;if(this.reset(),g)return g}};var ea=function(u){this.singleTap=new bl(u),this.numTaps=u.numTaps,this.reset()};ea.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},ea.prototype.touchstart=function(u,f,h){this.singleTap.touchstart(u,f,h)},ea.prototype.touchmove=function(u,f,h){this.singleTap.touchmove(u,f,h)},ea.prototype.touchend=function(u,f,h){var g=this.singleTap.touchend(u,f,h);if(g){var S=u.timeStamp-this.lastTime<500,M=!this.lastTap||this.lastTap.dist(g)<30;if(S&&M||this.reset(),this.count++,this.lastTime=u.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}};var zi=function(){this._zoomIn=new ea({numTouches:1,numTaps:2}),this._zoomOut=new ea({numTouches:2,numTaps:1}),this.reset()};zi.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},zi.prototype.touchstart=function(u,f,h){this._zoomIn.touchstart(u,f,h),this._zoomOut.touchstart(u,f,h)},zi.prototype.touchmove=function(u,f,h){this._zoomIn.touchmove(u,f,h),this._zoomOut.touchmove(u,f,h)},zi.prototype.touchend=function(u,f,h){var g=this,S=this._zoomIn.touchend(u,f,h),M=this._zoomOut.touchend(u,f,h);return S?(this._active=!0,u.preventDefault(),setTimeout(function(){return g.reset()},0),{cameraAnimation:function(R){return R.easeTo({duration:300,zoom:R.getZoom()+1,around:R.unproject(S)},{originalEvent:u})}}):M?(this._active=!0,u.preventDefault(),setTimeout(function(){return g.reset()},0),{cameraAnimation:function(R){return R.easeTo({duration:300,zoom:R.getZoom()-1,around:R.unproject(M)},{originalEvent:u})}}):void 0},zi.prototype.touchcancel=function(){this.reset()},zi.prototype.enable=function(){this._enabled=!0},zi.prototype.disable=function(){this._enabled=!1,this.reset()},zi.prototype.isEnabled=function(){return this._enabled},zi.prototype.isActive=function(){return this._active};var Gh={0:1,2:2},ss=function(u){this.reset(),this._clickTolerance=u.clickTolerance||1};ss.prototype.blur=function(){this.reset()},ss.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},ss.prototype._correctButton=function(u,f){return!1},ss.prototype._move=function(u,f){return{}},ss.prototype.mousedown=function(u,f){if(!this._lastPoint){var h=p.mouseButton(u);this._correctButton(u,h)&&(this._lastPoint=f,this._eventButton=h)}},ss.prototype.mousemoveWindow=function(u,f){var h=this._lastPoint;if(h){if(u.preventDefault(),function(g,S){var M=Gh[S];return g.buttons===void 0||(g.buttons&M)!==M}(u,this._eventButton))this.reset();else if(this._moved||!(f.dist(h)<this._clickTolerance))return this._moved=!0,this._lastPoint=f,this._move(h,f)}},ss.prototype.mouseupWindow=function(u){this._lastPoint&&p.mouseButton(u)===this._eventButton&&(this._moved&&p.suppressClick(),this.reset())},ss.prototype.enable=function(){this._enabled=!0},ss.prototype.disable=function(){this._enabled=!1,this.reset()},ss.prototype.isEnabled=function(){return this._enabled},ss.prototype.isActive=function(){return this._active};var Ou=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.mousedown=function(h,g){u.prototype.mousedown.call(this,h,g),this._lastPoint&&(this._active=!0)},f.prototype._correctButton=function(h,g){return g===0&&!h.ctrlKey},f.prototype._move=function(h,g){return{around:g,panDelta:g.sub(h)}},f}(ss),Ed=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype._correctButton=function(h,g){return g===0&&h.ctrlKey||g===2},f.prototype._move=function(h,g){var S=.8*(g.x-h.x);if(S)return this._active=!0,{bearingDelta:S}},f.prototype.contextmenu=function(h){h.preventDefault()},f}(ss),Kc=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype._correctButton=function(h,g){return g===0&&h.ctrlKey||g===2},f.prototype._move=function(h,g){var S=-.5*(g.y-h.y);if(S)return this._active=!0,{pitchDelta:S}},f.prototype.contextmenu=function(h){h.preventDefault()},f}(ss),Pi=function(u){this._minTouches=1,this._clickTolerance=u.clickTolerance||1,this.reset()};Pi.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new o.Point(0,0)},Pi.prototype.touchstart=function(u,f,h){return this._calculateTransform(u,f,h)},Pi.prototype.touchmove=function(u,f,h){if(this._active&&!(h.length<this._minTouches))return u.preventDefault(),this._calculateTransform(u,f,h)},Pi.prototype.touchend=function(u,f,h){this._calculateTransform(u,f,h),this._active&&h.length<this._minTouches&&this.reset()},Pi.prototype.touchcancel=function(){this.reset()},Pi.prototype._calculateTransform=function(u,f,h){h.length>0&&(this._active=!0);var g=ka(h,f),S=new o.Point(0,0),M=new o.Point(0,0),R=0;for(var N in g){var H=g[N],se=this._touches[N];se&&(S._add(H),M._add(H.sub(se)),R++,g[N]=H)}if(this._touches=g,!(R<this._minTouches)&&M.mag()){var ge=M.div(R);if(this._sum._add(ge),!(this._sum.mag()<this._clickTolerance))return{around:S.div(R),panDelta:ge}}},Pi.prototype.enable=function(){this._enabled=!0},Pi.prototype.disable=function(){this._enabled=!1,this.reset()},Pi.prototype.isEnabled=function(){return this._enabled},Pi.prototype.isActive=function(){return this._active};var Ui=function(){this.reset()};function Wh(u,f,h){for(var g=0;g<u.length;g++)if(u[g].identifier===h)return f[g]}function Yh(u,f){return Math.log(u/f)/Math.LN2}Ui.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Ui.prototype._start=function(u){},Ui.prototype._move=function(u,f,h){return{}},Ui.prototype.touchstart=function(u,f,h){this._firstTwoTouches||h.length<2||(this._firstTwoTouches=[h[0].identifier,h[1].identifier],this._start([f[0],f[1]]))},Ui.prototype.touchmove=function(u,f,h){if(this._firstTwoTouches){u.preventDefault();var g=this._firstTwoTouches,S=g[1],M=Wh(h,f,g[0]),R=Wh(h,f,S);if(M&&R){var N=this._aroundCenter?null:M.add(R).div(2);return this._move([M,R],N,u)}}},Ui.prototype.touchend=function(u,f,h){if(this._firstTwoTouches){var g=this._firstTwoTouches,S=g[1],M=Wh(h,f,g[0]),R=Wh(h,f,S);M&&R||(this._active&&p.suppressClick(),this.reset())}},Ui.prototype.touchcancel=function(){this.reset()},Ui.prototype.enable=function(u){this._enabled=!0,this._aroundCenter=!!u&&u.around==="center"},Ui.prototype.disable=function(){this._enabled=!1,this.reset()},Ui.prototype.isEnabled=function(){return this._enabled},Ui.prototype.isActive=function(){return this._active};var Eo=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.reset=function(){u.prototype.reset.call(this),delete this._distance,delete this._startDistance},f.prototype._start=function(h){this._startDistance=this._distance=h[0].dist(h[1])},f.prototype._move=function(h,g){var S=this._distance;if(this._distance=h[0].dist(h[1]),this._active||!(Math.abs(Yh(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Yh(this._distance,S),pinchAround:g}},f}(Ui);function ta(u,f){return 180*u.angleWith(f)/Math.PI}var kd=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.reset=function(){u.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},f.prototype._start=function(h){this._startVector=this._vector=h[0].sub(h[1]),this._minDiameter=h[0].dist(h[1])},f.prototype._move=function(h,g){var S=this._vector;if(this._vector=h[0].sub(h[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ta(this._vector,S),pinchAround:g}},f.prototype._isBelowThreshold=function(h){this._minDiameter=Math.min(this._minDiameter,h.mag());var g=25/(Math.PI*this._minDiameter)*360,S=ta(h,this._startVector);return Math.abs(S)<g},f}(Ui);function Jc(u){return Math.abs(u.y)>Math.abs(u.x)}var gf=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.reset=function(){u.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},f.prototype._start=function(h){this._lastPoints=h,Jc(h[0].sub(h[1]))&&(this._valid=!1)},f.prototype._move=function(h,g,S){var M=h[0].sub(this._lastPoints[0]),R=h[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(M,R,S.timeStamp),this._valid)return this._lastPoints=h,this._active=!0,{pitchDelta:(M.y+R.y)/2*-.5}},f.prototype.gestureBeginsVertically=function(h,g,S){if(this._valid!==void 0)return this._valid;var M=h.mag()>=2,R=g.mag()>=2;if(M||R){if(!M||!R)return this._firstMove===void 0&&(this._firstMove=S),S-this._firstMove<100&&void 0;var N=h.y>0==g.y>0;return Jc(h)&&Jc(g)&&N}},f}(Ui),Zh={panStep:100,bearingStep:15,pitchStep:10},Pa=function(){var u=Zh;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1};function Vo(u){return u*(2-u)}Pa.prototype.blur=function(){this.reset()},Pa.prototype.reset=function(){this._active=!1},Pa.prototype.keydown=function(u){var f=this;if(!(u.altKey||u.ctrlKey||u.metaKey)){var h=0,g=0,S=0,M=0,R=0;switch(u.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:u.shiftKey?g=-1:(u.preventDefault(),M=-1);break;case 39:u.shiftKey?g=1:(u.preventDefault(),M=1);break;case 38:u.shiftKey?S=1:(u.preventDefault(),R=-1);break;case 40:u.shiftKey?S=-1:(u.preventDefault(),R=1);break;default:return}return this._rotationDisabled&&(g=0,S=0),{cameraAnimation:function(N){var H=N.getZoom();N.easeTo({duration:300,easeId:"keyboardHandler",easing:Vo,zoom:h?Math.round(H)+h*(u.shiftKey?2:1):H,bearing:N.getBearing()+g*f._bearingStep,pitch:N.getPitch()+S*f._pitchStep,offset:[-M*f._panStep,-R*f._panStep],center:N.getCenter()},{originalEvent:u})}}}},Pa.prototype.enable=function(){this._enabled=!0},Pa.prototype.disable=function(){this._enabled=!1,this.reset()},Pa.prototype.isEnabled=function(){return this._enabled},Pa.prototype.isActive=function(){return this._active},Pa.prototype.disableRotation=function(){this._rotationDisabled=!0},Pa.prototype.enableRotation=function(){this._rotationDisabled=!1};var Bs=function(u,f){this._map=u,this._el=u.getCanvasContainer(),this._handler=f,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,o.bindAll(["_onTimeout"],this)};Bs.prototype.setZoomRate=function(u){this._defaultZoomRate=u},Bs.prototype.setWheelZoomRate=function(u){this._wheelZoomRate=u},Bs.prototype.isEnabled=function(){return!!this._enabled},Bs.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Bs.prototype.isZooming=function(){return!!this._zooming},Bs.prototype.enable=function(u){this.isEnabled()||(this._enabled=!0,this._aroundCenter=u&&u.around==="center")},Bs.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Bs.prototype.wheel=function(u){if(this.isEnabled()){var f=u.deltaMode===o.window.WheelEvent.DOM_DELTA_LINE?40*u.deltaY:u.deltaY,h=o.browser.now(),g=h-(this._lastWheelEventTime||0);this._lastWheelEventTime=h,f!==0&&f%4.000244140625==0?this._type="wheel":f!==0&&Math.abs(f)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=f,this._timeout=setTimeout(this._onTimeout,40,u)):this._type||(this._type=Math.abs(g*f)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),u.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=u,this._delta-=f,this._active||this._start(u)),u.preventDefault()}},Bs.prototype._onTimeout=function(u){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)},Bs.prototype._start=function(u){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var f=p.mousePos(this._el,u);this._around=o.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(f)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Bs.prototype.renderFrame=function(){var u=this;if(this._frameId&&(this._frameId=null,this.isActive())){var f=this._map.transform;if(this._delta!==0){var h=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,g=2/(1+Math.exp(-Math.abs(this._delta*h)));this._delta<0&&g!==0&&(g=1/g);var S=typeof this._targetZoom=="number"?f.zoomScale(this._targetZoom):f.scale;this._targetZoom=Math.min(f.maxZoom,Math.max(f.minZoom,f.scaleZoom(S*g))),this._type==="wheel"&&(this._startZoom=f.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var M,R=typeof this._targetZoom=="number"?this._targetZoom:f.zoom,N=this._startZoom,H=this._easing,se=!1;if(this._type==="wheel"&&N&&H){var ge=Math.min((o.browser.now()-this._lastWheelEventTime)/200,1),we=H(ge);M=o.number(N,R,we),ge<1?this._frameId||(this._frameId=!0):se=!0}else M=R,se=!0;return this._active=!0,se&&(this._active=!1,this._finishTimeout=setTimeout(function(){u._zooming=!1,u._handler._triggerRenderFrame(),delete u._targetZoom,delete u._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!se,zoomDelta:M-f.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Bs.prototype._smoothOutEasing=function(u){var f=o.ease;if(this._prevEase){var h=this._prevEase,g=(o.browser.now()-h.start)/h.duration,S=h.easing(g+.01)-h.easing(g),M=.27/Math.sqrt(S*S+1e-4)*.01,R=Math.sqrt(.0729-M*M);f=o.bezier(M,R,.25,1)}return this._prevEase={start:o.browser.now(),duration:u,easing:f},f},Bs.prototype.blur=function(){this.reset()},Bs.prototype.reset=function(){this._active=!1};var Rr=function(u,f){this._clickZoom=u,this._tapZoom=f};Rr.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Rr.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Rr.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Rr.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var sa=function(){this.reset()};sa.prototype.reset=function(){this._active=!1},sa.prototype.blur=function(){this.reset()},sa.prototype.dblclick=function(u,f){return u.preventDefault(),{cameraAnimation:function(h){h.easeTo({duration:300,zoom:h.getZoom()+(u.shiftKey?-1:1),around:h.unproject(f)},{originalEvent:u})}}},sa.prototype.enable=function(){this._enabled=!0},sa.prototype.disable=function(){this._enabled=!1,this.reset()},sa.prototype.isEnabled=function(){return this._enabled},sa.prototype.isActive=function(){return this._active};var Ri=function(){this._tap=new ea({numTouches:1,numTaps:1}),this.reset()};Ri.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Ri.prototype.touchstart=function(u,f,h){this._swipePoint||(this._tapTime&&u.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?h.length>0&&(this._swipePoint=f[0],this._swipeTouch=h[0].identifier):this._tap.touchstart(u,f,h))},Ri.prototype.touchmove=function(u,f,h){if(this._tapTime){if(this._swipePoint){if(h[0].identifier!==this._swipeTouch)return;var g=f[0],S=g.y-this._swipePoint.y;return this._swipePoint=g,u.preventDefault(),this._active=!0,{zoomDelta:S/128}}}else this._tap.touchmove(u,f,h)},Ri.prototype.touchend=function(u,f,h){this._tapTime?this._swipePoint&&h.length===0&&this.reset():this._tap.touchend(u,f,h)&&(this._tapTime=u.timeStamp)},Ri.prototype.touchcancel=function(){this.reset()},Ri.prototype.enable=function(){this._enabled=!0},Ri.prototype.disable=function(){this._enabled=!1,this.reset()},Ri.prototype.isEnabled=function(){return this._enabled},Ri.prototype.isActive=function(){return this._active};var rc=function(u,f,h){this._el=u,this._mousePan=f,this._touchPan=h};rc.prototype.enable=function(u){this._inertiaOptions=u||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},rc.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},rc.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},rc.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var ic=function(u,f,h){this._pitchWithRotate=u.pitchWithRotate,this._mouseRotate=f,this._mousePitch=h};ic.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},ic.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},ic.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},ic.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var jo=function(u,f,h,g){this._el=u,this._touchZoom=f,this._touchRotate=h,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0};jo.prototype.enable=function(u){this._touchZoom.enable(u),this._rotationDisabled||this._touchRotate.enable(u),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},jo.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},jo.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},jo.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},jo.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},jo.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var mi=function(u){return u.zoom||u.drag||u.pitch||u.rotate},Qc=function(u){function f(){u.apply(this,arguments)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f}(o.Event);function Ss(u){return u.panDelta&&u.panDelta.mag()||u.zoomDelta||u.bearingDelta||u.pitchDelta}var gs=function(u,f){this._map=u,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new sc(u),this._bearingSnap=f.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(f),o.bindAll(["handleEvent","handleWindowEvent"],this);var h=this._el;this._listeners=[[h,"touchstart",{passive:!0}],[h,"touchmove",{passive:!1}],[h,"touchend",void 0],[h,"touchcancel",void 0],[h,"mousedown",void 0],[h,"mousemove",void 0],[h,"mouseup",void 0],[o.window.document,"mousemove",{capture:!0}],[o.window.document,"mouseup",void 0],[h,"mouseover",void 0],[h,"mouseout",void 0],[h,"dblclick",void 0],[h,"click",void 0],[h,"keydown",{capture:!1}],[h,"keyup",void 0],[h,"wheel",{passive:!1}],[h,"contextmenu",void 0],[o.window,"blur",void 0]];for(var g=0,S=this._listeners;g<S.length;g+=1){var M=S[g],R=M[0];p.addEventListener(R,M[1],R===o.window.document?this.handleWindowEvent:this.handleEvent,M[2])}};gs.prototype.destroy=function(){for(var u=0,f=this._listeners;u<f.length;u+=1){var h=f[u],g=h[0];p.removeEventListener(g,h[1],g===o.window.document?this.handleWindowEvent:this.handleEvent,h[2])}},gs.prototype._addDefaultHandlers=function(u){var f=this._map,h=f.getCanvasContainer();this._add("mapEvent",new Jr(f,u));var g=f.boxZoom=new Fi(f,u);this._add("boxZoom",g);var S=new zi,M=new sa;f.doubleClickZoom=new Rr(M,S),this._add("tapZoom",S),this._add("clickZoom",M);var R=new Ri;this._add("tapDragZoom",R);var N=f.touchPitch=new gf;this._add("touchPitch",N);var H=new Ed(u),se=new Kc(u);f.dragRotate=new ic(u,H,se),this._add("mouseRotate",H,["mousePitch"]),this._add("mousePitch",se,["mouseRotate"]);var ge=new Ou(u),we=new Pi(u);f.dragPan=new rc(h,ge,we),this._add("mousePan",ge),this._add("touchPan",we,["touchZoom","touchRotate"]);var Te=new kd,ze=new Eo;f.touchZoomRotate=new jo(h,ze,Te,R),this._add("touchRotate",Te,["touchPan","touchZoom"]),this._add("touchZoom",ze,["touchPan","touchRotate"]);var De=f.scrollZoom=new Bs(f,this);this._add("scrollZoom",De,["mousePan"]);var Ye=f.keyboard=new Pa;this._add("keyboard",Ye),this._add("blockableMapEvent",new _s(f));for(var Le=0,Ze=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Le<Ze.length;Le+=1){var tt=Ze[Le];u.interactive&&u[tt]&&f[tt].enable(u[tt])}},gs.prototype._add=function(u,f,h){this._handlers.push({handlerName:u,handler:f,allowed:h}),this._handlersById[u]=f},gs.prototype.stop=function(u){if(!this._updatingCamera){for(var f=0,h=this._handlers;f<h.length;f+=1)h[f].handler.reset();this._inertia.clear(),this._fireEvents({},{},u),this._changes=[]}},gs.prototype.isActive=function(){for(var u=0,f=this._handlers;u<f.length;u+=1)if(f[u].handler.isActive())return!0;return!1},gs.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},gs.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},gs.prototype.isMoving=function(){return Boolean(mi(this._eventsInProgress))||this.isZooming()},gs.prototype._blockedByActive=function(u,f,h){for(var g in u)if(g!==h&&(!f||f.indexOf(g)<0))return!0;return!1},gs.prototype.handleWindowEvent=function(u){this.handleEvent(u,u.type+"Window")},gs.prototype._getMapTouches=function(u){for(var f=[],h=0,g=u;h<g.length;h+=1){var S=g[h];this._el.contains(S.target)&&f.push(S)}return f},gs.prototype.handleEvent=function(u,f){this._updatingCamera=!0;for(var h=u.type==="renderFrame"?void 0:u,g={needsRenderFrame:!1},S={},M={},R=u.touches?this._getMapTouches(u.touches):void 0,N=R?p.touchPos(this._el,R):p.mousePos(this._el,u),H=0,se=this._handlers;H<se.length;H+=1){var ge=se[H],we=ge.handlerName,Te=ge.handler,ze=ge.allowed;if(Te.isEnabled()){var De=void 0;this._blockedByActive(M,ze,we)?Te.reset():Te[f||u.type]&&(De=Te[f||u.type](u,N,R),this.mergeHandlerResult(g,S,De,we,h),De&&De.needsRenderFrame&&this._triggerRenderFrame()),(De||Te.isActive())&&(M[we]=Te)}}var Ye={};for(var Le in this._previousActiveHandlers)M[Le]||(Ye[Le]=h);this._previousActiveHandlers=M,(Object.keys(Ye).length||Ss(g))&&(this._changes.push([g,S,Ye]),this._triggerRenderFrame()),(Object.keys(M).length||Ss(g))&&this._map._stop(!0),this._updatingCamera=!1;var Ze=g.cameraAnimation;Ze&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Ze(this._map))},gs.prototype.mergeHandlerResult=function(u,f,h,g,S){if(h){o.extend(u,h);var M={handlerName:g,originalEvent:h.originalEvent||S};h.zoomDelta!==void 0&&(f.zoom=M),h.panDelta!==void 0&&(f.drag=M),h.pitchDelta!==void 0&&(f.pitch=M),h.bearingDelta!==void 0&&(f.rotate=M)}},gs.prototype._applyChanges=function(){for(var u={},f={},h={},g=0,S=this._changes;g<S.length;g+=1){var M=S[g],R=M[0],N=M[1],H=M[2];R.panDelta&&(u.panDelta=(u.panDelta||new o.Point(0,0))._add(R.panDelta)),R.zoomDelta&&(u.zoomDelta=(u.zoomDelta||0)+R.zoomDelta),R.bearingDelta&&(u.bearingDelta=(u.bearingDelta||0)+R.bearingDelta),R.pitchDelta&&(u.pitchDelta=(u.pitchDelta||0)+R.pitchDelta),R.around!==void 0&&(u.around=R.around),R.pinchAround!==void 0&&(u.pinchAround=R.pinchAround),R.noInertia&&(u.noInertia=R.noInertia),o.extend(f,N),o.extend(h,H)}this._updateMapTransform(u,f,h),this._changes=[]},gs.prototype._updateMapTransform=function(u,f,h){var g=this._map,S=g.transform;if(!Ss(u))return this._fireEvents(f,h,!0);var M=u.panDelta,R=u.zoomDelta,N=u.bearingDelta,H=u.pitchDelta,se=u.around,ge=u.pinchAround;ge!==void 0&&(se=ge),g._stop(!0),se=se||g.transform.centerPoint;var we=S.pointLocation(M?se.sub(M):se);N&&(S.bearing+=N),H&&(S.pitch+=H),R&&(S.zoom+=R),S.setLocationAtPoint(we,se),this._map._update(),u.noInertia||this._inertia.record(u),this._fireEvents(f,h,!0)},gs.prototype._fireEvents=function(u,f,h){var g=this,S=mi(this._eventsInProgress),M=mi(u),R={};for(var N in u)this._eventsInProgress[N]||(R[N+"start"]=u[N].originalEvent),this._eventsInProgress[N]=u[N];for(var H in!S&&M&&this._fireEvent("movestart",M.originalEvent),R)this._fireEvent(H,R[H]);for(var se in M&&this._fireEvent("move",M.originalEvent),u)this._fireEvent(se,u[se].originalEvent);var ge,we={};for(var Te in this._eventsInProgress){var ze=this._eventsInProgress[Te],De=ze.handlerName,Ye=ze.originalEvent;this._handlersById[De].isActive()||(delete this._eventsInProgress[Te],we[Te+"end"]=ge=f[De]||Ye)}for(var Le in we)this._fireEvent(Le,we[Le]);var Ze=mi(this._eventsInProgress);if(h&&(S||M)&&!Ze){this._updatingCamera=!0;var tt=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ut=function(wt){return wt!==0&&-g._bearingSnap<wt&&wt<g._bearingSnap};tt?(ut(tt.bearing||this._map.getBearing())&&(tt.bearing=0),this._map.easeTo(tt,{originalEvent:ge})):(this._map.fire(new o.Event("moveend",{originalEvent:ge})),ut(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},gs.prototype._fireEvent=function(u,f){this._map.fire(new o.Event(u,f?{originalEvent:f}:{}))},gs.prototype._requestFrame=function(){var u=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(f){delete u._frameId,u.handleEvent(new Qc("renderFrame",{timeStamp:f})),u._applyChanges()})},gs.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var oc=function(u){function f(h,g){u.call(this),this._moving=!1,this._zooming=!1,this.transform=h,this._bearingSnap=g.bearingSnap,o.bindAll(["_renderFrameCallback"],this)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.getCenter=function(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)},f.prototype.setCenter=function(h,g){return this.jumpTo({center:h},g)},f.prototype.panBy=function(h,g,S){return h=o.Point.convert(h).mult(-1),this.panTo(this.transform.center,o.extend({offset:h},g),S)},f.prototype.panTo=function(h,g,S){return this.easeTo(o.extend({center:h},g),S)},f.prototype.getZoom=function(){return this.transform.zoom},f.prototype.setZoom=function(h,g){return this.jumpTo({zoom:h},g),this},f.prototype.zoomTo=function(h,g,S){return this.easeTo(o.extend({zoom:h},g),S)},f.prototype.zoomIn=function(h,g){return this.zoomTo(this.getZoom()+1,h,g),this},f.prototype.zoomOut=function(h,g){return this.zoomTo(this.getZoom()-1,h,g),this},f.prototype.getBearing=function(){return this.transform.bearing},f.prototype.setBearing=function(h,g){return this.jumpTo({bearing:h},g),this},f.prototype.getPadding=function(){return this.transform.padding},f.prototype.setPadding=function(h,g){return this.jumpTo({padding:h},g),this},f.prototype.rotateTo=function(h,g,S){return this.easeTo(o.extend({bearing:h},g),S)},f.prototype.resetNorth=function(h,g){return this.rotateTo(0,o.extend({duration:1e3},h),g),this},f.prototype.resetNorthPitch=function(h,g){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},h),g),this},f.prototype.snapToNorth=function(h,g){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(h,g):this},f.prototype.getPitch=function(){return this.transform.pitch},f.prototype.setPitch=function(h,g){return this.jumpTo({pitch:h},g),this},f.prototype.cameraForBounds=function(h,g){h=o.LngLatBounds.convert(h);var S=g&&g.bearing||0;return this._cameraForBoxAndBearing(h.getNorthWest(),h.getSouthEast(),S,g)},f.prototype._cameraForBoxAndBearing=function(h,g,S,M){var R={top:0,bottom:0,right:0,left:0};if(typeof(M=o.extend({padding:R,offset:[0,0],maxZoom:this.transform.maxZoom},M)).padding=="number"){var N=M.padding;M.padding={top:N,bottom:N,right:N,left:N}}M.padding=o.extend(R,M.padding);var H=this.transform,se=H.padding,ge=H.project(o.LngLat.convert(h)),we=H.project(o.LngLat.convert(g)),Te=ge.rotate(-S*Math.PI/180),ze=we.rotate(-S*Math.PI/180),De=new o.Point(Math.max(Te.x,ze.x),Math.max(Te.y,ze.y)),Ye=new o.Point(Math.min(Te.x,ze.x),Math.min(Te.y,ze.y)),Le=De.sub(Ye),Ze=(H.width-(se.left+se.right+M.padding.left+M.padding.right))/Le.x,tt=(H.height-(se.top+se.bottom+M.padding.top+M.padding.bottom))/Le.y;if(!(tt<0||Ze<0)){var ut=Math.min(H.scaleZoom(H.scale*Math.min(Ze,tt)),M.maxZoom),wt=typeof M.offset.x=="number"?new o.Point(M.offset.x,M.offset.y):o.Point.convert(M.offset),bt=new o.Point((M.padding.left-M.padding.right)/2,(M.padding.top-M.padding.bottom)/2).rotate(S*Math.PI/180),It=wt.add(bt).mult(H.scale/H.zoomScale(ut));return{center:H.unproject(ge.add(we).div(2).sub(It)),zoom:ut,bearing:S}}o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},f.prototype.fitBounds=function(h,g,S){return this._fitInternal(this.cameraForBounds(h,g),g,S)},f.prototype.fitScreenCoordinates=function(h,g,S,M,R){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.Point.convert(h)),this.transform.pointLocation(o.Point.convert(g)),S,M),M,R)},f.prototype._fitInternal=function(h,g,S){return h?(delete(g=o.extend(h,g)).padding,g.linear?this.easeTo(g,S):this.flyTo(g,S)):this},f.prototype.jumpTo=function(h,g){this.stop();var S=this.transform,M=!1,R=!1,N=!1;return"zoom"in h&&S.zoom!==+h.zoom&&(M=!0,S.zoom=+h.zoom),h.center!==void 0&&(S.center=o.LngLat.convert(h.center)),"bearing"in h&&S.bearing!==+h.bearing&&(R=!0,S.bearing=+h.bearing),"pitch"in h&&S.pitch!==+h.pitch&&(N=!0,S.pitch=+h.pitch),h.padding==null||S.isPaddingEqual(h.padding)||(S.padding=h.padding),this.fire(new o.Event("movestart",g)).fire(new o.Event("move",g)),M&&this.fire(new o.Event("zoomstart",g)).fire(new o.Event("zoom",g)).fire(new o.Event("zoomend",g)),R&&this.fire(new o.Event("rotatestart",g)).fire(new o.Event("rotate",g)).fire(new o.Event("rotateend",g)),N&&this.fire(new o.Event("pitchstart",g)).fire(new o.Event("pitch",g)).fire(new o.Event("pitchend",g)),this.fire(new o.Event("moveend",g))},f.prototype.easeTo=function(h,g){var S=this;this._stop(!1,h.easeId),((h=o.extend({offset:[0,0],duration:500,easing:o.ease},h)).animate===!1||!h.essential&&o.browser.prefersReducedMotion)&&(h.duration=0);var M=this.transform,R=this.getZoom(),N=this.getBearing(),H=this.getPitch(),se=this.getPadding(),ge="zoom"in h?+h.zoom:R,we="bearing"in h?this._normalizeBearing(h.bearing,N):N,Te="pitch"in h?+h.pitch:H,ze="padding"in h?h.padding:M.padding,De=o.Point.convert(h.offset),Ye=M.centerPoint.add(De),Le=M.pointLocation(Ye),Ze=o.LngLat.convert(h.center||Le);this._normalizeCenter(Ze);var tt,ut,wt=M.project(Le),bt=M.project(Ze).sub(wt),It=M.zoomScale(ge-R);h.around&&(tt=o.LngLat.convert(h.around),ut=M.locationPoint(tt));var Dt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||ge!==R,this._rotating=this._rotating||N!==we,this._pitching=this._pitching||Te!==H,this._padding=!M.isPaddingEqual(ze),this._easeId=h.easeId,this._prepareEase(g,h.noMoveStart,Dt),this._ease(function(Gt){if(S._zooming&&(M.zoom=o.number(R,ge,Gt)),S._rotating&&(M.bearing=o.number(N,we,Gt)),S._pitching&&(M.pitch=o.number(H,Te,Gt)),S._padding&&(M.interpolatePadding(se,ze,Gt),Ye=M.centerPoint.add(De)),tt)M.setLocationAtPoint(tt,ut);else{var Xt=M.zoomScale(M.zoom-R),as=ge>R?Math.min(2,It):Math.max(.5,It),vs=Math.pow(as,1-Gt),$s=M.unproject(wt.add(bt.mult(Gt*vs)).mult(Xt));M.setLocationAtPoint(M.renderWorldCopies?$s.wrap():$s,Ye)}S._fireMoveEvents(g)},function(Gt){S._afterEase(g,Gt)},h),this},f.prototype._prepareEase=function(h,g,S){S===void 0&&(S={}),this._moving=!0,g||S.moving||this.fire(new o.Event("movestart",h)),this._zooming&&!S.zooming&&this.fire(new o.Event("zoomstart",h)),this._rotating&&!S.rotating&&this.fire(new o.Event("rotatestart",h)),this._pitching&&!S.pitching&&this.fire(new o.Event("pitchstart",h))},f.prototype._fireMoveEvents=function(h){this.fire(new o.Event("move",h)),this._zooming&&this.fire(new o.Event("zoom",h)),this._rotating&&this.fire(new o.Event("rotate",h)),this._pitching&&this.fire(new o.Event("pitch",h))},f.prototype._afterEase=function(h,g){if(!this._easeId||!g||this._easeId!==g){delete this._easeId;var S=this._zooming,M=this._rotating,R=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,S&&this.fire(new o.Event("zoomend",h)),M&&this.fire(new o.Event("rotateend",h)),R&&this.fire(new o.Event("pitchend",h)),this.fire(new o.Event("moveend",h))}},f.prototype.flyTo=function(h,g){var S=this;if(!h.essential&&o.browser.prefersReducedMotion){var M=o.pick(h,["center","zoom","bearing","pitch","around"]);return this.jumpTo(M,g)}this.stop(),h=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},h);var R=this.transform,N=this.getZoom(),H=this.getBearing(),se=this.getPitch(),ge=this.getPadding(),we="zoom"in h?o.clamp(+h.zoom,R.minZoom,R.maxZoom):N,Te="bearing"in h?this._normalizeBearing(h.bearing,H):H,ze="pitch"in h?+h.pitch:se,De="padding"in h?h.padding:R.padding,Ye=R.zoomScale(we-N),Le=o.Point.convert(h.offset),Ze=R.centerPoint.add(Le),tt=R.pointLocation(Ze),ut=o.LngLat.convert(h.center||tt);this._normalizeCenter(ut);var wt=R.project(tt),bt=R.project(ut).sub(wt),It=h.curve,Dt=Math.max(R.width,R.height),Gt=Dt/Ye,Xt=bt.mag();if("minZoom"in h){var as=o.clamp(Math.min(h.minZoom,N,we),R.minZoom,R.maxZoom),vs=Dt/R.zoomScale(as-N);It=Math.sqrt(vs/Xt*2)}var $s=It*It;function ks(Vs){var ws=(Gt*Gt-Dt*Dt+(Vs?-1:1)*$s*$s*Xt*Xt)/(2*(Vs?Gt:Dt)*$s*Xt);return Math.log(Math.sqrt(ws*ws+1)-ws)}function xn(Vs){return(Math.exp(Vs)-Math.exp(-Vs))/2}function ps(Vs){return(Math.exp(Vs)+Math.exp(-Vs))/2}var Ls=ks(0),Qs=function(Vs){return ps(Ls)/ps(Ls+It*Vs)},qs=function(Vs){return Dt*((ps(Ls)*(xn(ws=Ls+It*Vs)/ps(ws))-xn(Ls))/$s)/Xt;var ws},zs=(ks(1)-Ls)/It;if(Math.abs(Xt)<1e-6||!isFinite(zs)){if(Math.abs(Dt-Gt)<1e-6)return this.easeTo(h,g);var en=Gt<Dt?-1:1;zs=Math.abs(Math.log(Gt/Dt))/It,qs=function(){return 0},Qs=function(Vs){return Math.exp(en*It*Vs)}}return h.duration="duration"in h?+h.duration:1e3*zs/("screenSpeed"in h?+h.screenSpeed/It:+h.speed),h.maxDuration&&h.duration>h.maxDuration&&(h.duration=0),this._zooming=!0,this._rotating=H!==Te,this._pitching=ze!==se,this._padding=!R.isPaddingEqual(De),this._prepareEase(g,!1),this._ease(function(Vs){var ws=Vs*zs,ei=1/Qs(ws);R.zoom=Vs===1?we:N+R.scaleZoom(ei),S._rotating&&(R.bearing=o.number(H,Te,Vs)),S._pitching&&(R.pitch=o.number(se,ze,Vs)),S._padding&&(R.interpolatePadding(ge,De,Vs),Ze=R.centerPoint.add(Le));var $r=Vs===1?ut:R.unproject(wt.add(bt.mult(qs(ws))).mult(ei));R.setLocationAtPoint(R.renderWorldCopies?$r.wrap():$r,Ze),S._fireMoveEvents(g)},function(){return S._afterEase(g)},h),this},f.prototype.isEasing=function(){return!!this._easeFrameId},f.prototype.stop=function(){return this._stop()},f.prototype._stop=function(h,g){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var S=this._onEaseEnd;delete this._onEaseEnd,S.call(this,g)}if(!h){var M=this.handlers;M&&M.stop(!1)}return this},f.prototype._ease=function(h,g,S){S.animate===!1||S.duration===0?(h(1),g()):(this._easeStart=o.browser.now(),this._easeOptions=S,this._onEaseFrame=h,this._onEaseEnd=g,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},f.prototype._renderFrameCallback=function(){var h=Math.min((o.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(h)),h<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},f.prototype._normalizeBearing=function(h,g){h=o.wrap(h,-180,180);var S=Math.abs(h-g);return Math.abs(h-360-g)<S&&(h-=360),Math.abs(h+360-g)<S&&(h+=360),h},f.prototype._normalizeCenter=function(h){var g=this.transform;if(g.renderWorldCopies&&!g.lngRange){var S=h.lng-g.center.lng;h.lng+=S>180?-360:S<-180?360:0}},f}(o.Evented),Si=function(u){u===void 0&&(u={}),this.options=u,o.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};Si.prototype.getDefaultPosition=function(){return"bottom-right"},Si.prototype.onAdd=function(u){var f=this.options&&this.options.compact;return this._map=u,this._container=p.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=p.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=p.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),f&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),f===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Si.prototype.onRemove=function(){p.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Si.prototype._setElementTitle=function(u,f){var h=this._map._getUIString("AttributionControl."+f);u.title=h,u.setAttribute("aria-label",h)},Si.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},Si.prototype._updateEditLink=function(){var u=this._editLink;u||(u=this._editLink=this._container.querySelector(".mapbox-improve-map"));var f=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.config.ACCESS_TOKEN}];if(u){var h=f.reduce(function(g,S,M){return S.value&&(g+=S.key+"="+S.value+(M<f.length-1?"&":"")),g},"?");u.href=o.config.FEEDBACK_URL+"/"+h+(this._map._hash?this._map._hash.getHashString(!0):""),u.rel="noopener nofollow",this._setElementTitle(u,"MapFeedback")}},Si.prototype._updateData=function(u){!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Si.prototype._updateAttributions=function(){if(this._map.style){var u=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?u=u.concat(this.options.customAttribution.map(function(N){return typeof N!="string"?"":N})):typeof this.options.customAttribution=="string"&&u.push(this.options.customAttribution)),this._map.style.stylesheet){var f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}var h=this._map.style.sourceCaches;for(var g in h){var S=h[g];if(S.used){var M=S.getSource();M.attribution&&u.indexOf(M.attribution)<0&&u.push(M.attribution)}}u.sort(function(N,H){return N.length-H.length});var R=(u=u.filter(function(N,H){for(var se=H+1;se<u.length;se++)if(u[se].indexOf(N)>=0)return!1;return!0})).join(" | ");R!==this._attribHTML&&(this._attribHTML=R,u.length?(this._innerContainer.innerHTML=R,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Si.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var ro=function(){o.bindAll(["_updateLogo"],this),o.bindAll(["_updateCompact"],this)};ro.prototype.onAdd=function(u){this._map=u,this._container=p.create("div","mapboxgl-ctrl");var f=p.create("a","mapboxgl-ctrl-logo");return f.target="_blank",f.rel="noopener nofollow",f.href="https://www.mapbox.com/",f.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),f.setAttribute("rel","noopener nofollow"),this._container.appendChild(f),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},ro.prototype.onRemove=function(){p.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},ro.prototype.getDefaultPosition=function(){return"bottom-left"},ro.prototype._updateLogo=function(u){u&&u.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},ro.prototype._logoRequired=function(){if(this._map.style){var u=this._map.style.sourceCaches;for(var f in u)if(u[f].getSource().mapbox_logo)return!0;return!1}},ro.prototype._updateCompact=function(){var u=this._container.children;if(u.length){var f=u[0];this._map.getCanvasContainer().offsetWidth<250?f.classList.add("mapboxgl-compact"):f.classList.remove("mapboxgl-compact")}};var $i=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};$i.prototype.add=function(u){var f=++this._id;return this._queue.push({callback:u,id:f,cancelled:!1}),f},$i.prototype.remove=function(u){for(var f=this._currentlyRunning,h=0,g=f?this._queue.concat(f):this._queue;h<g.length;h+=1){var S=g[h];if(S.id===u)return void(S.cancelled=!0)}},$i.prototype.run=function(u){u===void 0&&(u=0);var f=this._currentlyRunning=this._queue;this._queue=[];for(var h=0,g=f;h<g.length;h+=1){var S=g[h];if(!S.cancelled&&(S.callback(u),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},$i.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var ja={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},yf=o.window.HTMLImageElement,Xh=o.window.HTMLElement,Un=o.window.ImageBitmap,Qr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Lu=function(u){function f(g){var S=this;if((g=o.extend({},Qr,g)).minZoom!=null&&g.maxZoom!=null&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(g.minPitch!=null&&g.maxPitch!=null&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(g.minPitch!=null&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(g.maxPitch!=null&&g.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var M=new Es(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies);if(u.call(this,M,g),this._interactive=g.interactive,this._maxTileCacheSize=g.maxTileCacheSize,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._crossSourceCollisions=g.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=g.collectResourceTiming,this._renderTaskQueue=new $i,this._controls=[],this._mapId=o.uniqueId(),this._locale=o.extend({},ja,g.locale),this._clickTolerance=g.clickTolerance,this._requestManager=new o.RequestManager(g.transformRequest,g.accessToken),typeof g.container=="string"){if(this._container=o.window.document.getElementById(g.container),!this._container)throw new Error("Container '"+g.container+"' not found.")}else{if(!(g.container instanceof Xh))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(g.maxBounds&&this.setMaxBounds(g.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return S._update(!1)}),this.on("moveend",function(){return S._update(!1)}),this.on("zoom",function(){return S._update(!0)}),o.window!==void 0&&(o.window.addEventListener("online",this._onWindowOnline,!1),o.window.addEventListener("resize",this._onWindowResize,!1),o.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new gs(this,g),this._hash=g.hash&&new Uo(typeof g.hash=="string"&&g.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch}),g.bounds&&(this.resize(),this.fitBounds(g.bounds,o.extend({},g.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=g.localIdeographFontFamily,g.style&&this.setStyle(g.style,{localIdeographFontFamily:g.localIdeographFontFamily}),g.attributionControl&&this.addControl(new Si({customAttribution:g.customAttribution})),this.addControl(new ro,g.logoPosition),this.on("style.load",function(){S.transform.unmodified&&S.jumpTo(S.style.stylesheet)}),this.on("data",function(R){S._update(R.dataType==="style"),S.fire(new o.Event(R.dataType+"data",R))}),this.on("dataloading",function(R){S.fire(new o.Event(R.dataType+"dataloading",R))})}u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f;var h={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return f.prototype._getMapId=function(){return this._mapId},f.prototype.addControl=function(g,S){if(S===void 0&&(S=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var M=g.onAdd(this);this._controls.push(g);var R=this._controlPositions[S];return S.indexOf("bottom")!==-1?R.insertBefore(M,R.firstChild):R.appendChild(M),this},f.prototype.removeControl=function(g){if(!g||!g.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var S=this._controls.indexOf(g);return S>-1&&this._controls.splice(S,1),g.onRemove(this),this},f.prototype.hasControl=function(g){return this._controls.indexOf(g)>-1},f.prototype.resize=function(g){var S=this._containerDimensions(),M=S[0],R=S[1];if(M===this.transform.width&&R===this.transform.height)return this;this._resizeCanvas(M,R),this.transform.resize(M,R),this.painter.resize(M,R);var N=!this._moving;return N&&this.fire(new o.Event("movestart",g)).fire(new o.Event("move",g)),this.fire(new o.Event("resize",g)),N&&this.fire(new o.Event("moveend",g)),this},f.prototype.getBounds=function(){return this.transform.getBounds()},f.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},f.prototype.setMaxBounds=function(g){return this.transform.setMaxBounds(o.LngLatBounds.convert(g)),this._update()},f.prototype.setMinZoom=function(g){if((g=g==null?-2:g)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},f.prototype.getMinZoom=function(){return this.transform.minZoom},f.prototype.setMaxZoom=function(g){if((g=g==null?22:g)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")},f.prototype.getMaxZoom=function(){return this.transform.maxZoom},f.prototype.setMinPitch=function(g){if((g=g==null?0:g)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},f.prototype.getMinPitch=function(){return this.transform.minPitch},f.prototype.setMaxPitch=function(g){if((g=g==null?60:g)>60)throw new Error("maxPitch must be less than or equal to 60");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")},f.prototype.getMaxPitch=function(){return this.transform.maxPitch},f.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},f.prototype.setRenderWorldCopies=function(g){return this.transform.renderWorldCopies=g,this._update()},f.prototype.project=function(g){return this.transform.locationPoint(o.LngLat.convert(g))},f.prototype.unproject=function(g){return this.transform.pointLocation(o.Point.convert(g))},f.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},f.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},f.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},f.prototype._createDelegatedListener=function(g,S,M){var R,N=this;if(g==="mouseenter"||g==="mouseover"){var H=!1;return{layer:S,listener:M,delegates:{mousemove:function(ge){var we=N.getLayer(S)?N.queryRenderedFeatures(ge.point,{layers:[S]}):[];we.length?H||(H=!0,M.call(N,new Kr(g,N,ge.originalEvent,{features:we}))):H=!1},mouseout:function(){H=!1}}}}if(g==="mouseleave"||g==="mouseout"){var se=!1;return{layer:S,listener:M,delegates:{mousemove:function(ge){(N.getLayer(S)?N.queryRenderedFeatures(ge.point,{layers:[S]}):[]).length?se=!0:se&&(se=!1,M.call(N,new Kr(g,N,ge.originalEvent)))},mouseout:function(ge){se&&(se=!1,M.call(N,new Kr(g,N,ge.originalEvent)))}}}}return{layer:S,listener:M,delegates:(R={},R[g]=function(ge){var we=N.getLayer(S)?N.queryRenderedFeatures(ge.point,{layers:[S]}):[];we.length&&(ge.features=we,M.call(N,ge),delete ge.features)},R)}},f.prototype.on=function(g,S,M){if(M===void 0)return u.prototype.on.call(this,g,S);var R=this._createDelegatedListener(g,S,M);for(var N in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(R),R.delegates)this.on(N,R.delegates[N]);return this},f.prototype.once=function(g,S,M){if(M===void 0)return u.prototype.once.call(this,g,S);var R=this._createDelegatedListener(g,S,M);for(var N in R.delegates)this.once(N,R.delegates[N]);return this},f.prototype.off=function(g,S,M){var R=this;return M===void 0?u.prototype.off.call(this,g,S):(this._delegatedListeners&&this._delegatedListeners[g]&&function(N){for(var H=N[g],se=0;se<H.length;se++){var ge=H[se];if(ge.layer===S&&ge.listener===M){for(var we in ge.delegates)R.off(we,ge.delegates[we]);return H.splice(se,1),R}}}(this._delegatedListeners),this)},f.prototype.queryRenderedFeatures=function(g,S){if(!this.style)return[];var M;if(S!==void 0||g===void 0||g instanceof o.Point||Array.isArray(g)||(S=g,g=void 0),S=S||{},(g=g||[[0,0],[this.transform.width,this.transform.height]])instanceof o.Point||typeof g[0]=="number")M=[o.Point.convert(g)];else{var R=o.Point.convert(g[0]),N=o.Point.convert(g[1]);M=[R,new o.Point(N.x,R.y),N,new o.Point(R.x,N.y),R]}return this.style.queryRenderedFeatures(M,S,this.transform)},f.prototype.querySourceFeatures=function(g,S){return this.style.querySourceFeatures(g,S)},f.prototype.setStyle=function(g,S){return(S=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},S)).diff!==!1&&S.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&g?(this._diffStyle(g,S),this):(this._localIdeographFontFamily=S.localIdeographFontFamily,this._updateStyle(g,S))},f.prototype._getUIString=function(g){var S=this._locale[g];if(S==null)throw new Error("Missing UI string '"+g+"'");return S},f.prototype._updateStyle=function(g,S){return this.style&&(this.style.setEventedParent(null),this.style._remove()),g?(this.style=new Cn(this,S||{}),this.style.setEventedParent(this,{style:this.style}),typeof g=="string"?this.style.loadURL(g):this.style.loadJSON(g),this):(delete this.style,this)},f.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Cn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},f.prototype._diffStyle=function(g,S){var M=this;if(typeof g=="string"){var R=this._requestManager.normalizeStyleURL(g),N=this._requestManager.transformRequest(R,o.ResourceType.Style);o.getJSON(N,function(H,se){H?M.fire(new o.ErrorEvent(H)):se&&M._updateDiff(se,S)})}else typeof g=="object"&&this._updateDiff(g,S)},f.prototype._updateDiff=function(g,S){try{this.style.setState(g)&&this._update(!0)}catch(M){o.warnOnce("Unable to perform style diff: "+(M.message||M.error||M)+".  Rebuilding the style from scratch."),this._updateStyle(g,S)}},f.prototype.getStyle=function(){if(this.style)return this.style.serialize()},f.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():o.warnOnce("There is no style added to the map.")},f.prototype.addSource=function(g,S){return this._lazyInitEmptyStyle(),this.style.addSource(g,S),this._update(!0)},f.prototype.isSourceLoaded=function(g){var S=this.style&&this.style.sourceCaches[g];if(S!==void 0)return S.loaded();this.fire(new o.ErrorEvent(new Error("There is no source with ID '"+g+"'")))},f.prototype.areTilesLoaded=function(){var g=this.style&&this.style.sourceCaches;for(var S in g){var M=g[S]._tiles;for(var R in M){var N=M[R];if(N.state!=="loaded"&&N.state!=="errored")return!1}}return!0},f.prototype.addSourceType=function(g,S,M){return this._lazyInitEmptyStyle(),this.style.addSourceType(g,S,M)},f.prototype.removeSource=function(g){return this.style.removeSource(g),this._update(!0)},f.prototype.getSource=function(g){return this.style.getSource(g)},f.prototype.addImage=function(g,S,M){M===void 0&&(M={});var R=M.pixelRatio;R===void 0&&(R=1);var N=M.sdf;N===void 0&&(N=!1);var H=M.stretchX,se=M.stretchY,ge=M.content;if(this._lazyInitEmptyStyle(),S instanceof yf||Un&&S instanceof Un){var we=o.browser.getImageData(S);this.style.addImage(g,{data:new o.RGBAImage({width:we.width,height:we.height},we.data),pixelRatio:R,stretchX:H,stretchY:se,content:ge,sdf:N,version:0})}else{if(S.width===void 0||S.height===void 0)return this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Te=S;this.style.addImage(g,{data:new o.RGBAImage({width:S.width,height:S.height},new Uint8Array(S.data)),pixelRatio:R,stretchX:H,stretchY:se,content:ge,sdf:N,version:0,userImage:Te}),Te.onAdd&&Te.onAdd(this,g)}},f.prototype.updateImage=function(g,S){var M=this.style.getImage(g);if(!M)return this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var R=S instanceof yf||Un&&S instanceof Un?o.browser.getImageData(S):S,N=R.width,H=R.height,se=R.data;return N===void 0||H===void 0?this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):N!==M.data.width||H!==M.data.height?this.fire(new o.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(M.data.replace(se,!(S instanceof yf||Un&&S instanceof Un)),void this.style.updateImage(g,M))},f.prototype.hasImage=function(g){return g?!!this.style.getImage(g):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)},f.prototype.removeImage=function(g){this.style.removeImage(g)},f.prototype.loadImage=function(g,S){o.getImage(this._requestManager.transformRequest(g,o.ResourceType.Image),S)},f.prototype.listImages=function(){return this.style.listImages()},f.prototype.addLayer=function(g,S){return this._lazyInitEmptyStyle(),this.style.addLayer(g,S),this._update(!0)},f.prototype.moveLayer=function(g,S){return this.style.moveLayer(g,S),this._update(!0)},f.prototype.removeLayer=function(g){return this.style.removeLayer(g),this._update(!0)},f.prototype.getLayer=function(g){return this.style.getLayer(g)},f.prototype.setLayerZoomRange=function(g,S,M){return this.style.setLayerZoomRange(g,S,M),this._update(!0)},f.prototype.setFilter=function(g,S,M){return M===void 0&&(M={}),this.style.setFilter(g,S,M),this._update(!0)},f.prototype.getFilter=function(g){return this.style.getFilter(g)},f.prototype.setPaintProperty=function(g,S,M,R){return R===void 0&&(R={}),this.style.setPaintProperty(g,S,M,R),this._update(!0)},f.prototype.getPaintProperty=function(g,S){return this.style.getPaintProperty(g,S)},f.prototype.setLayoutProperty=function(g,S,M,R){return R===void 0&&(R={}),this.style.setLayoutProperty(g,S,M,R),this._update(!0)},f.prototype.getLayoutProperty=function(g,S){return this.style.getLayoutProperty(g,S)},f.prototype.setLight=function(g,S){return S===void 0&&(S={}),this._lazyInitEmptyStyle(),this.style.setLight(g,S),this._update(!0)},f.prototype.getLight=function(){return this.style.getLight()},f.prototype.setFeatureState=function(g,S){return this.style.setFeatureState(g,S),this._update()},f.prototype.removeFeatureState=function(g,S){return this.style.removeFeatureState(g,S),this._update()},f.prototype.getFeatureState=function(g){return this.style.getFeatureState(g)},f.prototype.getContainer=function(){return this._container},f.prototype.getCanvasContainer=function(){return this._canvasContainer},f.prototype.getCanvas=function(){return this._canvas},f.prototype._containerDimensions=function(){var g=0,S=0;return this._container&&(g=this._container.clientWidth||400,S=this._container.clientHeight||300),[g,S]},f.prototype._detectMissingCSS=function(){o.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},f.prototype._setupContainer=function(){var g=this._container;g.classList.add("mapboxgl-map"),(this._missingCSSCanary=p.create("div","mapboxgl-canary",g)).style.visibility="hidden",this._detectMissingCSS();var S=this._canvasContainer=p.create("div","mapboxgl-canvas-container",g);this._interactive&&S.classList.add("mapboxgl-interactive"),this._canvas=p.create("canvas","mapboxgl-canvas",S),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var M=this._containerDimensions();this._resizeCanvas(M[0],M[1]);var R=this._controlContainer=p.create("div","mapboxgl-control-container",g),N=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(H){N[H]=p.create("div","mapboxgl-ctrl-"+H,R)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},f.prototype._resizeCanvas=function(g,S){var M=o.browser.devicePixelRatio||1;this._canvas.width=M*g,this._canvas.height=M*S,this._canvas.style.width=g+"px",this._canvas.style.height=S+"px"},f.prototype._setupPainter=function(){var g=o.extend({},d.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),S=this._canvas.getContext("webgl",g)||this._canvas.getContext("experimental-webgl",g);S?(this.painter=new rs(S,this.transform),o.webpSupported.testSupport(S)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))},f.prototype._contextLost=function(g){g.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:g}))},f.prototype._contextRestored=function(g){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:g}))},f.prototype._onMapScroll=function(g){if(g.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},f.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},f.prototype._update=function(g){return this.style?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this},f.prototype._requestRenderFrame=function(g){return this._update(),this._renderTaskQueue.add(g)},f.prototype._cancelRenderFrame=function(g){this._renderTaskQueue.remove(g)},f.prototype._render=function(g){var S,M=this,R=0,N=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(S=N.createQueryEXT(),N.beginQueryEXT(N.TIME_ELAPSED_EXT,S),R=o.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),!this._removed){var H=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var se=this.transform.zoom,ge=o.browser.now();this.style.zoomHistory.update(se,ge);var we=new o.EvaluationParameters(se,{now:ge,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Te=we.crossFadingFactor();Te===1&&Te===this._crossFadingFactor||(H=!0,this._crossFadingFactor=Te),this.style.update(we)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new o.Event("load"))),this.style&&(this.style.hasTransitions()||H)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var ze=o.browser.now()-R;N.endQueryEXT(N.TIME_ELAPSED_EXT,S),setTimeout(function(){var Le=N.getQueryObjectEXT(S,N.QUERY_RESULT_EXT)/1e6;N.deleteQueryEXT(S),M.fire(new o.Event("gpu-timing-frame",{cpuTime:ze,gpuTime:Le}))},50)}if(this.listens("gpu-timing-layer")){var De=this.painter.collectGpuTimers();setTimeout(function(){var Le=M.painter.queryGpuTimers(De);M.fire(new o.Event("gpu-timing-layer",{layerTimes:Le}))},50)}var Ye=this._sourcesDirty||this._styleDirty||this._placementDirty;return Ye||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.Event("idle")),!this._loaded||this._fullyLoaded||Ye||(this._fullyLoaded=!0),this}},f.prototype.remove=function(){this._hash&&this._hash.remove();for(var g=0,S=this._controls;g<S.length;g+=1)S[g].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),o.window!==void 0&&(o.window.removeEventListener("resize",this._onWindowResize,!1),o.window.removeEventListener("orientationchange",this._onWindowResize,!1),o.window.removeEventListener("online",this._onWindowOnline,!1));var M=this.painter.context.gl.getExtension("WEBGL_lose_context");M&&M.loseContext(),ac(this._canvasContainer),ac(this._controlContainer),ac(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new o.Event("remove"))},f.prototype.triggerRepaint=function(){var g=this;this.style&&!this._frame&&(this._frame=o.browser.frame(function(S){g._frame=null,g._render(S)}))},f.prototype._onWindowOnline=function(){this._update()},f.prototype._onWindowResize=function(g){this._trackResize&&this.resize({originalEvent:g})._update()},h.showTileBoundaries.get=function(){return!!this._showTileBoundaries},h.showTileBoundaries.set=function(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())},h.showPadding.get=function(){return!!this._showPadding},h.showPadding.set=function(g){this._showPadding!==g&&(this._showPadding=g,this._update())},h.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},h.showCollisionBoxes.set=function(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())},h.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},h.showOverdrawInspector.set=function(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())},h.repaint.get=function(){return!!this._repaint},h.repaint.set=function(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())},h.vertices.get=function(){return!!this._vertices},h.vertices.set=function(g){this._vertices=g,this._update()},f.prototype._setCacheLimits=function(g,S){o.setCacheLimits(g,S)},h.version.get=function(){return o.version},Object.defineProperties(f.prototype,h),f}(oc);function ac(u){u.parentNode&&u.parentNode.removeChild(u)}var Ie={showCompass:!0,showZoom:!0,visualizePitch:!1},ko=function(u){var f=this;this.options=o.extend({},Ie,u),this._container=p.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(h){return h.preventDefault()}),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(h){return f._map.zoomIn({},{originalEvent:h})}),p.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(h){return f._map.zoomOut({},{originalEvent:h})}),p.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(h){f.options.visualizePitch?f._map.resetNorthPitch({},{originalEvent:h}):f._map.resetNorth({},{originalEvent:h})}),this._compassIcon=p.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};ko.prototype._updateZoomButtons=function(){var u=this._map.getZoom(),f=u===this._map.getMaxZoom(),h=u===this._map.getMinZoom();this._zoomInButton.disabled=f,this._zoomOutButton.disabled=h,this._zoomInButton.setAttribute("aria-disabled",f.toString()),this._zoomOutButton.setAttribute("aria-disabled",h.toString())},ko.prototype._rotateCompassArrow=function(){var u=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=u},ko.prototype.onAdd=function(u){return this._map=u,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Vi(this._map,this._compass,this.options.visualizePitch)),this._container},ko.prototype.onRemove=function(){p.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},ko.prototype._createButton=function(u,f){var h=p.create("button",u,this._container);return h.type="button",h.addEventListener("click",f),h},ko.prototype._setButtonTitle=function(u,f){var h=this._map._getUIString("NavigationControl."+f);u.title=h,u.setAttribute("aria-label",h)};var Vi=function(u,f,h){h===void 0&&(h=!1),this._clickTolerance=10,this.element=f,this.mouseRotate=new Ed({clickTolerance:u.dragRotate._mouseRotate._clickTolerance}),this.map=u,h&&(this.mousePitch=new Kc({clickTolerance:u.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),p.addEventListener(f,"mousedown",this.mousedown),p.addEventListener(f,"touchstart",this.touchstart,{passive:!1}),p.addEventListener(f,"touchmove",this.touchmove),p.addEventListener(f,"touchend",this.touchend),p.addEventListener(f,"touchcancel",this.reset)};function ji(u,f,h){if(u=new o.LngLat(u.lng,u.lat),f){var g=new o.LngLat(u.lng-360,u.lat),S=new o.LngLat(u.lng+360,u.lat),M=h.locationPoint(u).distSqr(f);h.locationPoint(g).distSqr(f)<M?u=g:h.locationPoint(S).distSqr(f)<M&&(u=S)}for(;Math.abs(u.lng-h.center.lng)>180;){var R=h.locationPoint(u);if(R.x>=0&&R.y>=0&&R.x<=h.width&&R.y<=h.height)break;u.lng>h.center.lng?u.lng-=360:u.lng+=360}return u}Vi.prototype.down=function(u,f){this.mouseRotate.mousedown(u,f),this.mousePitch&&this.mousePitch.mousedown(u,f),p.disableDrag()},Vi.prototype.move=function(u,f){var h=this.map,g=this.mouseRotate.mousemoveWindow(u,f);if(g&&g.bearingDelta&&h.setBearing(h.getBearing()+g.bearingDelta),this.mousePitch){var S=this.mousePitch.mousemoveWindow(u,f);S&&S.pitchDelta&&h.setPitch(h.getPitch()+S.pitchDelta)}},Vi.prototype.off=function(){var u=this.element;p.removeEventListener(u,"mousedown",this.mousedown),p.removeEventListener(u,"touchstart",this.touchstart,{passive:!1}),p.removeEventListener(u,"touchmove",this.touchmove),p.removeEventListener(u,"touchend",this.touchend),p.removeEventListener(u,"touchcancel",this.reset),this.offTemp()},Vi.prototype.offTemp=function(){p.enableDrag(),p.removeEventListener(o.window,"mousemove",this.mousemove),p.removeEventListener(o.window,"mouseup",this.mouseup)},Vi.prototype.mousedown=function(u){this.down(o.extend({},u,{ctrlKey:!0,preventDefault:function(){return u.preventDefault()}}),p.mousePos(this.element,u)),p.addEventListener(o.window,"mousemove",this.mousemove),p.addEventListener(o.window,"mouseup",this.mouseup)},Vi.prototype.mousemove=function(u){this.move(u,p.mousePos(this.element,u))},Vi.prototype.mouseup=function(u){this.mouseRotate.mouseupWindow(u),this.mousePitch&&this.mousePitch.mouseupWindow(u),this.offTemp()},Vi.prototype.touchstart=function(u){u.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=p.touchPos(this.element,u.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return u.preventDefault()}},this._startPos))},Vi.prototype.touchmove=function(u){u.targetTouches.length!==1?this.reset():(this._lastPos=p.touchPos(this.element,u.targetTouches)[0],this.move({preventDefault:function(){return u.preventDefault()}},this._lastPos))},Vi.prototype.touchend=function(u){u.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Vi.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var un={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Kh(u,f,h){var g=u.classList;for(var S in un)g.remove("mapboxgl-"+h+"-anchor-"+S);g.add("mapboxgl-"+h+"-anchor-"+f)}var Nu,Pd=function(u){function f(h,g){if(u.call(this),(h instanceof o.window.HTMLElement||g)&&(h=o.extend({element:h},g)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=h&&h.anchor||"center",this._color=h&&h.color||"#3FB1CE",this._scale=h&&h.scale||1,this._draggable=h&&h.draggable||!1,this._clickTolerance=h&&h.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=h&&h.rotation||0,this._rotationAlignment=h&&h.rotationAlignment||"auto",this._pitchAlignment=h&&h.pitchAlignment&&h.pitchAlignment!=="auto"?h.pitchAlignment:this._rotationAlignment,h&&h.element)this._element=h.element,this._offset=o.Point.convert(h&&h.offset||[0,0]);else{this._defaultMarker=!0,this._element=p.create("div"),this._element.setAttribute("aria-label","Map marker");var S=p.createNS("http://www.w3.org/2000/svg","svg");S.setAttributeNS(null,"display","block"),S.setAttributeNS(null,"height","41px"),S.setAttributeNS(null,"width","27px"),S.setAttributeNS(null,"viewBox","0 0 27 41");var M=p.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"stroke","none"),M.setAttributeNS(null,"stroke-width","1"),M.setAttributeNS(null,"fill","none"),M.setAttributeNS(null,"fill-rule","evenodd");var R=p.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"fill-rule","nonzero");var N=p.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"transform","translate(3.0, 29.0)"),N.setAttributeNS(null,"fill","#000000");for(var H=0,se=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];H<se.length;H+=1){var ge=se[H],we=p.createNS("http://www.w3.org/2000/svg","ellipse");we.setAttributeNS(null,"opacity","0.04"),we.setAttributeNS(null,"cx","10.5"),we.setAttributeNS(null,"cy","5.80029008"),we.setAttributeNS(null,"rx",ge.rx),we.setAttributeNS(null,"ry",ge.ry),N.appendChild(we)}var Te=p.createNS("http://www.w3.org/2000/svg","g");Te.setAttributeNS(null,"fill",this._color);var ze=p.createNS("http://www.w3.org/2000/svg","path");ze.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Te.appendChild(ze);var De=p.createNS("http://www.w3.org/2000/svg","g");De.setAttributeNS(null,"opacity","0.25"),De.setAttributeNS(null,"fill","#000000");var Ye=p.createNS("http://www.w3.org/2000/svg","path");Ye.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),De.appendChild(Ye);var Le=p.createNS("http://www.w3.org/2000/svg","g");Le.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Le.setAttributeNS(null,"fill","#FFFFFF");var Ze=p.createNS("http://www.w3.org/2000/svg","g");Ze.setAttributeNS(null,"transform","translate(8.0, 8.0)");var tt=p.createNS("http://www.w3.org/2000/svg","circle");tt.setAttributeNS(null,"fill","#000000"),tt.setAttributeNS(null,"opacity","0.25"),tt.setAttributeNS(null,"cx","5.5"),tt.setAttributeNS(null,"cy","5.5"),tt.setAttributeNS(null,"r","5.4999962");var ut=p.createNS("http://www.w3.org/2000/svg","circle");ut.setAttributeNS(null,"fill","#FFFFFF"),ut.setAttributeNS(null,"cx","5.5"),ut.setAttributeNS(null,"cy","5.5"),ut.setAttributeNS(null,"r","5.4999962"),Ze.appendChild(tt),Ze.appendChild(ut),R.appendChild(N),R.appendChild(Te),R.appendChild(De),R.appendChild(Le),R.appendChild(Ze),S.appendChild(R),S.setAttributeNS(null,"height",41*this._scale+"px"),S.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(S),this._offset=o.Point.convert(h&&h.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(wt){wt.preventDefault()}),this._element.addEventListener("mousedown",function(wt){wt.preventDefault()}),Kh(this._element,this._anchor,"marker"),this._popup=null}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.addTo=function(h){return this.remove(),this._map=h,h.getCanvasContainer().appendChild(this._element),h.on("move",this._update),h.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},f.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),p.remove(this._element),this._popup&&this._popup.remove(),this},f.prototype.getLngLat=function(){return this._lngLat},f.prototype.setLngLat=function(h){return this._lngLat=o.LngLat.convert(h),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},f.prototype.getElement=function(){return this._element},f.prototype.setPopup=function(h){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),h){if(!("offset"in h.options)){var g=Math.sqrt(Math.pow(13.5,2)/2);h.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[g,-1*(24.6+g)],"bottom-right":[-g,-1*(24.6+g)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=h,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},f.prototype._onKeyPress=function(h){var g=h.code,S=h.charCode||h.keyCode;g!=="Space"&&g!=="Enter"&&S!==32&&S!==13||this.togglePopup()},f.prototype._onMapClick=function(h){var g=h.originalEvent.target,S=this._element;this._popup&&(g===S||S.contains(g))&&this.togglePopup()},f.prototype.getPopup=function(){return this._popup},f.prototype.togglePopup=function(){var h=this._popup;return h?(h.isOpen()?h.remove():h.addTo(this._map),this):this},f.prototype._update=function(h){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=ji(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var g="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?g="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(g="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var S="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?S="rotateX(0deg)":this._pitchAlignment==="map"&&(S="rotateX("+this._map.getPitch()+"deg)"),h&&h.type!=="moveend"||(this._pos=this._pos.round()),p.setTransform(this._element,un[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+S+" "+g)}},f.prototype.getOffset=function(){return this._offset},f.prototype.setOffset=function(h){return this._offset=o.Point.convert(h),this._update(),this},f.prototype._onMove=function(h){if(!this._isDragging){var g=this._clickTolerance||this._map._clickTolerance;this._isDragging=h.point.dist(this._pointerdownPos)>=g}this._isDragging&&(this._pos=h.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag")))},f.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"},f.prototype._addDragHandler=function(h){this._element.contains(h.originalEvent.target)&&(h.preventDefault(),this._positionDelta=h.point.sub(this._pos).add(this._offset),this._pointerdownPos=h.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},f.prototype.setDraggable=function(h){return this._draggable=!!h,this._map&&(h?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},f.prototype.isDraggable=function(){return this._draggable},f.prototype.setRotation=function(h){return this._rotation=h||0,this._update(),this},f.prototype.getRotation=function(){return this._rotation},f.prototype.setRotationAlignment=function(h){return this._rotationAlignment=h||"auto",this._update(),this},f.prototype.getRotationAlignment=function(){return this._rotationAlignment},f.prototype.setPitchAlignment=function(h){return this._pitchAlignment=h&&h!=="auto"?h:this._rotationAlignment,this._update(),this},f.prototype.getPitchAlignment=function(){return this._pitchAlignment},f}(o.Evented),xl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Du=0,eu=!1,vf=function(u){function f(h){u.call(this),this.options=o.extend({},xl,h),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.onAdd=function(h){var g;return this._map=h,this._container=p.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),g=this._setupUI,Nu!==void 0?g(Nu):o.window.navigator.permissions!==void 0?o.window.navigator.permissions.query({name:"geolocation"}).then(function(S){g(Nu=S.state!=="denied")}):g(Nu=!!o.window.navigator.geolocation),this._container},f.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(o.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),p.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Du=0,eu=!1},f.prototype._isOutOfMapMaxBounds=function(h){var g=this._map.getMaxBounds(),S=h.coords;return g&&(S.longitude<g.getWest()||S.longitude>g.getEast()||S.latitude<g.getSouth()||S.latitude>g.getNorth())},f.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},f.prototype._onSuccess=function(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(h),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(h),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",h)),this._finish()}},f.prototype._updateCamera=function(h){var g=new o.LngLat(h.coords.longitude,h.coords.latitude),S=h.coords.accuracy,M=this._map.getBearing(),R=o.extend({bearing:M},this.options.fitBoundsOptions);this._map.fitBounds(g.toBounds(S),R,{geolocateSource:!0})},f.prototype._updateMarker=function(h){if(h){var g=new o.LngLat(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(g).addTo(this._map),this._userLocationDotMarker.setLngLat(g).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},f.prototype._updateCircleRadius=function(){var h=this._map._container.clientHeight/2,g=this._map.unproject([0,h]),S=this._map.unproject([1,h]),M=g.distanceTo(S),R=Math.ceil(2*this._accuracy/M);this._circleElement.style.width=R+"px",this._circleElement.style.height=R+"px"},f.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},f.prototype._onError=function(h){if(this._map){if(this.options.trackUserLocation)if(h.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var g=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=g,this._geolocateButton.setAttribute("aria-label",g),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(h.code===3&&eu)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",h)),this._finish()}},f.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},f.prototype._setupUI=function(h){var g=this;if(this._container.addEventListener("contextmenu",function(R){return R.preventDefault()}),this._geolocateButton=p.create("button","mapboxgl-ctrl-geolocate",this._container),p.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",h===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var S=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=S,this._geolocateButton.setAttribute("aria-label",S)}else{var M=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=M,this._geolocateButton.setAttribute("aria-label",M)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=p.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Pd(this._dotElement),this._circleElement=p.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Pd({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(R){R.geolocateSource||g._watchState!=="ACTIVE_LOCK"||R.originalEvent&&R.originalEvent.type==="resize"||(g._watchState="BACKGROUND",g._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),g._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),g.fire(new o.Event("trackuserlocationend")))})},f.prototype.trigger=function(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Du--,eu=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var h;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Du>1?(h={maximumAge:6e5,timeout:0},eu=!0):(h=this.options.positionOptions,eu=!1),this._geolocationWatchID=o.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,h)}}else o.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},f.prototype._clearWatch=function(){o.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},f}(o.Evented),lc={maxWidth:100,unit:"metric"},cc=function(u){this.options=o.extend({},lc,u),o.bindAll(["_onMove","setUnit"],this)};function na(u,f,h){var g=h&&h.maxWidth||100,S=u._container.clientHeight/2,M=u.unproject([0,S]),R=u.unproject([g,S]),N=M.distanceTo(R);if(h&&h.unit==="imperial"){var H=3.2808*N;H>5280?uc(f,g,H/5280,u._getUIString("ScaleControl.Miles")):uc(f,g,H,u._getUIString("ScaleControl.Feet"))}else h&&h.unit==="nautical"?uc(f,g,N/1852,u._getUIString("ScaleControl.NauticalMiles")):N>=1e3?uc(f,g,N/1e3,u._getUIString("ScaleControl.Kilometers")):uc(f,g,N,u._getUIString("ScaleControl.Meters"))}function uc(u,f,h,g){var S,M,R,N=(S=h,(M=Math.pow(10,(""+Math.floor(S)).length-1))*(R=(R=S/M)>=10?10:R>=5?5:R>=3?3:R>=2?2:R>=1?1:function(H){var se=Math.pow(10,Math.ceil(-Math.log(H)/Math.LN10));return Math.round(H*se)/se}(R)));u.style.width=f*(N/h)+"px",u.innerHTML=N+"&nbsp;"+g}cc.prototype.getDefaultPosition=function(){return"bottom-left"},cc.prototype._onMove=function(){na(this._map,this._container,this.options)},cc.prototype.onAdd=function(u){return this._map=u,this._container=p.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",u.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},cc.prototype.onRemove=function(){p.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},cc.prototype.setUnit=function(u){this.options.unit=u,na(this._map,this._container,this.options)};var ra=function(u){this._fullscreen=!1,u&&u.container&&(u.container instanceof o.window.HTMLElement?this._container=u.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in o.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in o.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in o.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in o.window.document&&(this._fullscreenchange="MSFullscreenChange")};ra.prototype.onAdd=function(u){return this._map=u,this._container||(this._container=this._map.getContainer()),this._controlContainer=p.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},ra.prototype.onRemove=function(){p.remove(this._controlContainer),this._map=null,o.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},ra.prototype._checkFullscreenSupport=function(){return!!(o.window.document.fullscreenEnabled||o.window.document.mozFullScreenEnabled||o.window.document.msFullscreenEnabled||o.window.document.webkitFullscreenEnabled)},ra.prototype._setupUI=function(){var u=this._fullscreenButton=p.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);p.create("span","mapboxgl-ctrl-icon",u).setAttribute("aria-hidden",!0),u.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),o.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},ra.prototype._updateTitle=function(){var u=this._getTitle();this._fullscreenButton.setAttribute("aria-label",u),this._fullscreenButton.title=u},ra.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},ra.prototype._isFullscreen=function(){return this._fullscreen},ra.prototype._changeIcon=function(){(o.window.document.fullscreenElement||o.window.document.mozFullScreenElement||o.window.document.webkitFullscreenElement||o.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},ra.prototype._onClickFullscreen=function(){this._isFullscreen()?o.window.document.exitFullscreen?o.window.document.exitFullscreen():o.window.document.mozCancelFullScreen?o.window.document.mozCancelFullScreen():o.window.document.msExitFullscreen?o.window.document.msExitFullscreen():o.window.document.webkitCancelFullScreen&&o.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var bf={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Rd=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),xf=function(u){function f(h){u.call(this),this.options=o.extend(Object.create(bf),h),o.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return u&&(f.__proto__=u),(f.prototype=Object.create(u&&u.prototype)).constructor=f,f.prototype.addTo=function(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new o.Event("open")),this},f.prototype.isOpen=function(){return!!this._map},f.prototype.remove=function(){return this._content&&p.remove(this._content),this._container&&(p.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new o.Event("close")),this},f.prototype.getLngLat=function(){return this._lngLat},f.prototype.setLngLat=function(h){return this._lngLat=o.LngLat.convert(h),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},f.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},f.prototype.getElement=function(){return this._container},f.prototype.setText=function(h){return this.setDOMContent(o.window.document.createTextNode(h))},f.prototype.setHTML=function(h){var g,S=o.window.document.createDocumentFragment(),M=o.window.document.createElement("body");for(M.innerHTML=h;g=M.firstChild;)S.appendChild(g);return this.setDOMContent(S)},f.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},f.prototype.setMaxWidth=function(h){return this.options.maxWidth=h,this._update(),this},f.prototype.setDOMContent=function(h){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=p.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(h),this._createCloseButton(),this._update(),this._focusFirstElement(),this},f.prototype.addClassName=function(h){this._container&&this._container.classList.add(h)},f.prototype.removeClassName=function(h){this._container&&this._container.classList.remove(h)},f.prototype.setOffset=function(h){return this.options.offset=h,this._update(),this},f.prototype.toggleClassName=function(h){if(this._container)return this._container.classList.toggle(h)},f.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=p.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},f.prototype._onMouseUp=function(h){this._update(h.point)},f.prototype._onMouseMove=function(h){this._update(h.point)},f.prototype._onDrag=function(h){this._update(h.point)},f.prototype._update=function(h){var g=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=p.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=p.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(we){return g._container.classList.add(we)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ji(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||h)){var S=this._pos=this._trackPointer&&h?h:this._map.project(this._lngLat),M=this.options.anchor,R=function we(Te){if(Te){if(typeof Te=="number"){var ze=Math.round(Math.sqrt(.5*Math.pow(Te,2)));return{center:new o.Point(0,0),top:new o.Point(0,Te),"top-left":new o.Point(ze,ze),"top-right":new o.Point(-ze,ze),bottom:new o.Point(0,-Te),"bottom-left":new o.Point(ze,-ze),"bottom-right":new o.Point(-ze,-ze),left:new o.Point(Te,0),right:new o.Point(-Te,0)}}if(Te instanceof o.Point||Array.isArray(Te)){var De=o.Point.convert(Te);return{center:De,top:De,"top-left":De,"top-right":De,bottom:De,"bottom-left":De,"bottom-right":De,left:De,right:De}}return{center:o.Point.convert(Te.center||[0,0]),top:o.Point.convert(Te.top||[0,0]),"top-left":o.Point.convert(Te["top-left"]||[0,0]),"top-right":o.Point.convert(Te["top-right"]||[0,0]),bottom:o.Point.convert(Te.bottom||[0,0]),"bottom-left":o.Point.convert(Te["bottom-left"]||[0,0]),"bottom-right":o.Point.convert(Te["bottom-right"]||[0,0]),left:o.Point.convert(Te.left||[0,0]),right:o.Point.convert(Te.right||[0,0])}}return we(new o.Point(0,0))}(this.options.offset);if(!M){var N,H=this._container.offsetWidth,se=this._container.offsetHeight;N=S.y+R.bottom.y<se?["top"]:S.y>this._map.transform.height-se?["bottom"]:[],S.x<H/2?N.push("left"):S.x>this._map.transform.width-H/2&&N.push("right"),M=N.length===0?"bottom":N.join("-")}var ge=S.add(R[M]).round();p.setTransform(this._container,un[M]+" translate("+ge.x+"px,"+ge.y+"px)"),Kh(this._container,M,"popup")}},f.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var h=this._container.querySelector(Rd);h&&h.focus()}},f.prototype._onClose=function(){this.remove()},f}(o.Evented),ia={version:o.version,supported:d,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:Lu,NavigationControl:ko,GeolocateControl:vf,AttributionControl:Si,ScaleControl:cc,FullscreenControl:ra,Popup:xf,Marker:Pd,Style:Cn,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.Point,MercatorCoordinate:o.MercatorCoordinate,Evented:o.Evented,config:o.config,prewarm:function(){At().acquire(Tt)},clearPrewarmedResources:function(){var u=xs;u&&(u.isPreloaded()&&u.numActive()===1?(u.release(Tt),xs=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return o.config.ACCESS_TOKEN},set accessToken(u){o.config.ACCESS_TOKEN=u},get baseApiUrl(){return o.config.API_URL},set baseApiUrl(u){o.config.API_URL=u},get workerCount(){return Vt.workerCount},set workerCount(u){Vt.workerCount=u},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(u){o.config.MAX_PARALLEL_IMAGE_REQUESTS=u},clearStorage:function(u){o.clearTileCache(u)},workerUrl:""};return ia}),r})})(L$);const L1=L$.exports,Oie={name:"AssignmentMap",components:{Spinner:Vr,Icon:yn,ButtonIcon:vn,Button:Tn,Checkbox:za,Tab:bC,Tabs:vC,TextInput:Ko,AssignmentTable:DR,DataTable:Rm,MapControls:$ie},emits:["show-rules","show-assignment","select-assignment"],data(){return{render:!1,loadingMsg:"Loading...",nonReactive:{},tableLoadingMsg:"",record:{columns:[],rows:[]},filteredRows:[],searchTerm:"",selectionSummary:{},activeTab:"nodes",useBoundaries:!!this.$store.boundaryObjects.length,tableVisible:!1,targetId:null,distance:"",showScrollButtons:!1,interval:null,scrollDirection:null}},computed:{tableIcon(){return this.tableVisible?"chevrondown":"chevronup"},mappableObjectTabs(){return this.useBoundaries?this.$store.boundaryObjects:this.$store.assignmentObjects.filter(e=>e.latitude&&e.longitude)},selectedObject(){return this.activeTab.startsWith("object_")?this.$store.allObjects.find(e=>e.id===this.activeTab.replace("object_","")):null},hasSelection(){var e,t,s,n;return this.useBoundaries?!!((t=(e=this.selectionSummary)==null?void 0:e.boundaries)!=null&&t.length):!!((n=(s=this.selectionSummary)==null?void 0:s.assignments)!=null&&n.length)},assignmentPanelVisible(){return SPM.Components.Assignment.sidePanel==="AssignmentPanel"}},watch:{useBoundaries:{async handler(e){e||(this.showScrollButtons=!1),await this.reset(),this.getSummaryWidth()}},"record.rows":{handler(){this.sync({target:"map"}),this.updateSelectionSummary()},deep:!0},searchTerm:{handler(){this.debounceSearchRowsByTerm()}},"$store.rootNode":{async handler(){!this.checkAssignmentBehavior()||(this.$store.boundaryObjects.length||(this.useBoundaries=!1),await this.reset())}},"$store.boundaryObjects":{async handler(){this.useBoundaries&&await this.reset()}}},async mounted(){if(SPM.Components.AssignmentMap=this,!this.checkAssignmentBehavior())return;this.render=!0,L1.accessToken="pk.eyJ1IjoiYmJyYW50bHkiLCJhIjoiY2p5OTdsd3RxMDBuZzNtcXo2OWdmMHFheCJ9.uhZwq-cDdmgVjKHqXFLSFg";const e="https://cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json?f=json",t="https://basemaps.arcgis.com/arcgis/rest/services/World_Basemap_GCS_v2/VectorTileServer",s="https://basemaps.arcgis.com/arcgis/rest/services/World_Basemap_v2/VectorTileServer/";await Promise.all([fetch(e),fetch(t)]).then(async([n,r])=>{const a=await n.json(),o=await r.json();a.sources.esri={type:"vector",scheme:"xyz",tilejson:o.tilejson||"2.0.0",format:o.tileInfo&&o.tileInfo.format||"pbf",maxzoom:15,tiles:[s+o.tiles[0]],description:o.description,name:o.name,url:"https://basemaps.arcgis.com/arcgis/rest/services/World_Basemap_v2/VectorTileServer"},a.sprite="https://cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/../sprites/sprite",a.glyphs="https://basemaps.arcgis.com/arcgis/rest/services/World_Basemap_v2/VectorTileServer/resources/fonts/{fontstack}/{range}.pbf",this.map=this.nonReactive.map=new L1.Map({container:"spm-map",style:a,center:[-121.85618050000001,51.82358863691664],minZoom:2,maxZoom:22,zoom:2.5548096252655945,dragRotate:!1}),this.map.addControl(new L1.ScaleControl({maxWidth:80,unit:"imperial"}),"top-right"),this.map.addControl(new L1.AttributionControl({customAttribution:o.copyrightText,compact:!0}),"bottom-left")}),await new Promise(n=>{this.map.on("load",n)}),await this.reset(),this.getSummaryWidth()},methods:{getSummaryWidth(){const e=document.querySelector(".map-tabs").clientWidth,t=document.querySelector(".summary-container").clientWidth;e>t&&this.useBoundaries&&(this.showScrollButtons=!0)},mousedown(e){this.interval=null,this.scrollDirection=e,this.scrollSummary(),this.interval=setInterval(this.scrollSummary,5)},mouseup(){this.scrollDirection=null,clearInterval(this.interval),this.interval=null},scrollSummary(){const e=document.querySelector(".summary-container");this.scrollDirection==="right"?e.scrollLeft+=1:this.interval&&(e.scrollLeft-=1)},debounceSearchRowsByTerm:FR.debounce(function(){this.searchRowsByTerm()},500),searchRowsByTerm(){const e=this.record.rows;this.searchTerm.length||(this.filteredRows=e);const t=this.searchTerm.toLowerCase();this.filteredRows=e.filter(s=>Object.values(s.data).some(r=>String(r.value||"").toLowerCase().includes(t)))},async reset(){this.loadingMsg="Loading...",this.updateTab("nodes"),await this.reloadData(),this.loadingMsg=""},async reloadData(){this.generateLayers(),this.updateBaseMapStyles(),await(this.useBoundaries?this.reloadBoundaryData:this.reloadObjectData)(),this.updateSelectionSummary()},async reloadBoundaryData(){this.loadingMsg="Loading Boundaries...",this.boundaryRecords=this.boundaryRecords||{},await SPM.Utils.Async.forEachParallel(this.$store.boundaryObjects,async e=>{const t=this.$store.filteredNodeIds.map(s=>this.$store.nodeMap[s]);t.length===0&&t.push(this.$store.rootNode),this.boundaryRecords[e.id]=await SPM.Utils.Node.getBoundaryData({boundaryObject:e,nodes:t}),this.updateBoundaryStyles({objectId:e.id})}),this.loadingMsg=""},async reloadObjectData(){await SPM.Utils.Async.forEachParallel(this.$store.assignmentObjects,async e=>{if(!e.latitude||!e.longitude)return;this.updateObjectStyles({objectId:e.id,styles:this.$store.preferences.Map.layers.find(o=>o.type==="object"&&o.id===e.id).styles});const t=this.$store.filteredNodeIds.map(o=>this.$store.nodeMap[o]);t.length===0&&t.push(this.$store.rootNode);const s=await SPM.Utils.Node.getAssignmentData({assignmentObject:e,nodes:t,filters:this.$store.filters,filterLogic:this.$store.filterLogic,type:"records",isBurndown:this.$store.filteredNodeIds.includes(this.$store.rootNode.id)}),n=`${e.id}__${e.latitude.name}`,r=`${e.id}__${e.longitude.name}`,a=[];s.forEach(o=>{const d=o[n],p=o[r];!d||!p||a.push({type:"Feature",geometry:{type:"Point",coordinates:[p,d]},properties:{...o,id:o[`${e.id}__Id`],nodeId:o.NodeId,color:this.$store.nodeMap[o.NodeId].color,selected:!1}})}),this.map.getSource(`${e.id}-object`).setData({type:"FeatureCollection",features:a})})},loadBoundaryTable({boundaryObject:e}){const t=this.$store.assignmentObjects.filter(s=>{var n,r;return(r=(n=s.recordsDataset)==null?void 0:n.dimensions)==null?void 0:r.find(a=>a.id===e.name)});this.record.columns=[{id:"id",name:e.label,type:"",summaryType:"Unique",summaryValue:new Set},{id:"AssignedTo",name:"Assigned To",type:"Special",summaryType:"Unique",summaryValue:new Set},...t.map(s=>({id:s.id,name:s.label,summaryType:"Sum",summaryValue:0}))],this.record.rows=this.boundaryRecords[e.id].map(s=>({id:s.id,selected:s.selected,data:this.record.columns.map(n=>(n.summaryType==="Unique"&&n.summaryValue.add(s[n.id]),n.summaryType==="Sum"&&(n.summaryValue+=s[n.id]||0),{type:"custom",value:n.summaryType==="Sum"?this.$F("Numeric",s[n.id]):s[n.id]}))})),this.record.columns.forEach(s=>{if(s.summaryType==="Unique"){const n=s.summaryValue.size;s.summaryValue=`${this.$F("Numeric",n)} ${n===1?"value":"values"}`}}),this.searchRowsByTerm()},async loadRecordsTable({assignmentObject:e}){this.tableLoadingMsg="Loading...",await SPM.Utils.Async.wait(20),this.record.columns=[...e.recordsDataset.dimensions.map(n=>({id:`${e.id}__${n.id}`,name:n.title,summaryType:"Unique",summaryValue:new Set})),...e.recordsDataset.measures.map(n=>({id:`${e.id}__${n.id}`,name:n.title,summaryType:"Sum",summaryValue:0})),{id:"AssignedTo",name:"Assigned To",type:"Special",summaryType:"Assignment"},{id:"AssignmentType",name:"Assignment Type",type:"Special",summaryType:"Assignment"}];const t=this.map.getSource(`${e.id}-object`),s=[];await SPM.Utils.Async.forEachBulk(t._data.features,async n=>s.push({id:n.properties.id,selected:n.properties.selected,data:this.record.columns.map(r=>(r.summaryType==="Unique"&&r.summaryValue.add(n.properties[r.id]),r.summaryType==="Sum"&&(r.summaryValue+=n.properties[r.id]||0),{type:"custom",value:r.summaryType==="Sum"?this.$F("Numeric",n.properties[r.id]):n.properties[r.id]}))}),10),this.record.rows=s,this.record.columns.forEach(n=>{if(n.summaryType==="Unique"){const r=n.summaryValue.size;n.summaryValue=`${this.$F("Numeric",r)} ${r===1?"value":"values"}`}}),this.searchRowsByTerm(),this.tableLoadingMsg=""},updateSelectionSummary(){if(this.useBoundaries){const e=this.record.columns.reduce((n,r)=>(n[r.id]=r.summaryType==="Sum"?0:new Set,n),{}),t=[],s={records:0,boundaries:0};this.$store.boundaryLayers.forEach(n=>{this.boundaryRecords[n.id].forEach(r=>{!r.selected||(t.push({id:r.id,nodeId:r.nodeId,objectId:n.id}),s[n.id]=(s[n.id]||0)+1,s.boundaries++,this.record.columns.forEach(a=>{var o,d;switch(a.summaryType){case"Sum":n.id===((o=this.selectedObject)==null?void 0:o.id)&&(e[a.id]+=r[a.id]||0);break;case"Unique":case"Assignment":n.id===((d=this.selectedObject)==null?void 0:d.id)&&e[a.id].add(r[a.id]);break}}),SPM.$store.assignmentObjects.forEach(a=>{r[a.id]&&(s[a.id]=(s[a.id]||0)+r[a.id],s.records+=r[a.id])}))})}),this.selectionSummary={type:"Boundaries",boundaries:t,aggregates:e,counts:s}}else{const e=this.record.columns.reduce((r,a)=>(r[a.id]=a.summaryType==="Sum"?0:new Set,r),{}),t=[],s=[],n={records:0,boundaries:0};this.$store.preferences.Map.layers.filter(r=>r.type==="object").forEach(r=>{this.map.getSource(`${r.id}-object`)._data.features.forEach(o=>{!o.properties.selected||(s.push({...o.properties}),n[r.id]=(n[r.id]||0)+1,n.records++,t.push({sobjectType:"sfsp__SalesNodeAssignment__c",sfsp__SalesAssignmentObject__c:r.id,sfsp__RecordId__c:o.properties.id,sfsp__Status__c:"Active"}),this.record.columns.forEach(d=>{var p,y;switch(d.summaryType){case"Sum":r.id===((p=this.selectedObject)==null?void 0:p.id)&&(e[d.id]+=o.properties[d.id]||0);break;case"Unique":case"Assignment":r.id===((y=this.selectedObject)==null?void 0:y.id)&&e[d.id].add(o.properties[d.id]);break}}))})}),this.selectionSummary={type:"Assignments",records:s,assignments:t,aggregates:e,counts:n}}},formatSummaryColumn(e){switch(e.summaryType){case"Sum":return this.$F("Numeric",this.selectionSummary.aggregates[e.id]);case"Unique":case"Assignment":const t=this.selectionSummary.aggregates[e.id].size;return`${this.$F("Numeric",t)} ${t===1?"value":"values"}`}},applySelection({selection:e=[],reset:t,redraw:s}={}){const n=e.reduce((r,a)=>(r[a.properties.id]=a,r),{});this.useBoundaries?this.$store.boundaryLayers.forEach(r=>{const a=this.$store.boundaryObjects.find(d=>d.id===r.id),o=this.boundaryRecords[r.id].reduce((d,p)=>(d[p.id]=p,d),{});t&&Object.values(o).forEach(d=>d.selected=!1),e.forEach(d=>{if(d.source===`${r.id}-vector`){const p=o[d.properties.id];p.selected=t?!0:!p.selected}}),this.updateBoundaryStyles({objectId:a.id})}):this.$store.preferences.Map.layers.filter(r=>r.type==="object").forEach(r=>{var y;const a=this.map.getSource(`${r.id}-object`),o=a._data.features.reduce((v,C)=>(v[C.properties.id]=C,v),{}),d=[];t&&a._data.features.forEach(v=>{v.properties.selected&&!n[v.properties.id]&&(v.properties.selected=!1,d.push(v))}),e.forEach(v=>{const C=o[v.properties.id];if(C){const I=t?!0:!C.properties.selected;C.properties.selected!==I&&(C.properties.selected=I,d.push(C))}});const p=(y=this.$store.nodeMap[SPM.Components.AssignmentMap.targetId])==null?void 0:y.color;(s?a._data.features:d).forEach(v=>this.map.setFeatureState({source:`${r.id}-object`,id:v.properties.id},{selected:v.properties.selected,color:v.properties.selected?p||"#FFFF00":v.properties.color}))}),this.sync({target:"table"}),(e.length>0||t)&&this.updateSelectionSummary()},async reassignSelection({targetId:e}){if(!this.$store.isEditor)return SPM.Components.MapControls.clearSelection();this.loadingMsg="Reassigning...";const t=this.$store.nodeMap[e],s=[];this.useBoundaries?this.$store.boundaryLayers.forEach(n=>{const r=[];this.boundaryRecords[n.id].forEach(a=>{a.selected&&a.nodeId!==e&&(a.selected=!1,a.nodeId=e,a.AssignedTo=t.name,r.push({boundary:a.id,targetId:e}))}),s.push(SPM.Utils.AssignmentObject.reassignBoundaries({objectId:n.id,reassignments:r})),this.updateBoundaryStyles({objectId:n.id})}):this.$store.preferences.Map.layers.filter(n=>n.type==="object").forEach(n=>{const r=this.map.getSource(`${n.id}-object`),a=[];r._data.features.forEach(o=>{o.properties.selected&&(o.properties.selected=!1,o.properties.nodeId!==e&&(o.properties.nodeId=e,o.properties.AssignedTo=t.name,o.properties.AssignmentType="Manual",o.properties.color=t.color),a.push(o))}),s.push(SPM.Utils.AssignmentObject.reassign({objectId:n.id,reassignments:a.map(o=>({recordId:o.properties.id,targetId:e}))})),a.forEach(o=>this.map.setFeatureState({source:`${n.id}-object`,id:o.properties.id},{selected:o.properties.selected,nodeId:o.properties.nodeId,color:o.properties.color}))}),this.sync({target:"table"}),this.updateSelectionSummary(),await Promise.all(s),this.$refs.assignmentTable.updateTable(),this.loadingMsg=""},zoomTo({selectedOnly:e}={}){let t=[],s=[];this.useBoundaries?this.$store.boundaryLayers.forEach(d=>{const p=this.$store.boundaryObjects.find(v=>v.id===d.id),y=this.$store.containerMap[p.containerSetId];this.boundaryRecords[p.id].forEach(v=>{if(!e||v.selected){const{minx:C,maxx:I,miny:O,maxy:A}=y[v.id];t.push(C,I),s.push(O,A)}})}):this.$store.preferences.Map.layers.filter(d=>d.type==="object").forEach(d=>{this.map.getSource(`${d.id}-object`)._data.features.forEach(y=>{(!e||y.properties.selected)&&(t.push(y.geometry.coordinates[0]),s.push(y.geometry.coordinates[1]))})}),t=t.sort((d,p)=>d-p),s=s.sort((d,p)=>d-p);let n=t[0],r=t[t.length-1];const a=s[0],o=s[s.length-1];if(n<0&&r>=0){let d=180,p=-180;t.forEach(C=>{C>=0&&C<d?d=C:C<0&&C>p&&(p=C)});const y=r-n,v=p-d+360;y>v&&(n=d,r=p+360)}this.map.fitBounds([[n,a],[r,o]],{linear:!0,padding:50,maxZoom:17})},generateLayers({skipCleanup:e}={}){e||([...this.map.getContainer().getElementsByClassName("mapboxgl-marker")].forEach(t=>t.parentNode.removeChild(t)),this.map.getStyle().layers.filter(t=>["-container","-straddle","-outline","-placeholder","-selection","-label","-object","-heatmap","-choropleth","-boundary","-alignment"].some(s=>t.id.endsWith(s))).forEach(t=>this.map.removeLayer(t.id)),Object.keys(this.map.getStyle().sources).filter(t=>["-vector","-object","nodes"].some(s=>t.endsWith(s))).forEach(t=>this.map.removeSource(t))),this.$store.boundaryObjects.forEach(t=>{this.map.addSource(`${t.id}-vector`,{type:"vector",tiles:[`${SPM.maioUrl}/territories/tile/v1?containersetid=${t.containerSetId}&zoom={z}&col={x}&row={y}`],minzoom:2,maxzoom:15}),this.map.addLayer({id:`${t.id}-boundary`,source:`${t.id}-vector`,type:"fill","source-layer":"layer",filter:["in",""]},"Building")}),this.$store.assignmentObjects.forEach(t=>{!t.latitude||!t.longitude||(this.map.addSource(`${t.id}-object`,{type:"geojson",promoteId:"id",data:{type:"FeatureCollection",features:[]}}),this.map.addLayer({id:`${t.id}-object`,source:`${t.id}-object`,type:"symbol",layout:{"text-font":["Arial Unicode MS Bold"],"text-offset":[0,0],"text-anchor":"center","text-allow-overlap":!0,"text-ignore-placement":!0,"icon-allow-overlap":!0,"icon-ignore-placement":!0},paint:{"text-color":["string",["feature-state","color"],["get","color"]],"text-opacity":1,"text-halo-color":"#000000","text-halo-width":1}},"Disputed label point/Admin0"))})},updateBaseMapStyles(){this.map.style.stylesheet.layers.filter(e=>e.id.includes("label")||e.id.includes("City")).forEach(e=>this.map.setLayoutProperty(e.id,"visibility",this.$store.preferences.Map.layers.find(t=>t.id==="labels").styles.visible?"visible":"none")),this.map.style.stylesheet.layers.filter(e=>e.id.includes("Road")||e.id.includes("Trail")||e.id.includes("Ferry")||e.id.includes("Rail")).filter(e=>!e.id.includes("label")).forEach(e=>this.map.setLayoutProperty(e.id,"visibility",this.$store.preferences.Map.layers.find(t=>t.id==="roads").styles.visible?"visible":"none")),this.map.style.stylesheet.layers.filter(e=>!e.id.includes("Road")&&!e.id.includes("Trail")&&!e.id.includes("Ferry")&&!e.id.includes("Rail")&&!e.id.includes("label")&&!e.id.includes("City")).forEach(e=>this.map.setLayoutProperty(e.id,"visibility",this.$store.preferences.Map.layers.find(t=>t.id==="background").styles.visible?"visible":"none")),this.map.style.stylesheet.layers.forEach(e=>{try{this.map.setLayoutProperty(e.id,"icon-allow-overlap",!0),this.map.setLayoutProperty(e.id,"text-allow-overlap",!0)}catch{}})},updateBoundaryStyles({objectId:e,styles:t}){var p;const s=this.$store.boundaryObjects.find(y=>y.id===e),n=this.$store.containerSets[s.containerSetId];t=t||this.$store.preferences.Map.layers.find(y=>y.id===e).styles;const r=[],a=[],o=[],d=(p=this.$store.nodeMap[SPM.Components.AssignmentMap.targetId])==null?void 0:p.color;this.boundaryRecords[e].forEach(y=>{var v;r.push(y.id),a.push([y.id,y.selected?((v=this.$store.nodeMap[y.previewNodeId])==null?void 0:v.color)||d||"#FFFF00":this.$store.nodeMap[y.nodeId].color]),o.push([y.id,y.selected?1:t.opacity])}),this.map.setLayoutProperty(`${e}-boundary`,"visibility",t.visible?"visible":"none"),this.map.setPaintProperty(`${e}-boundary`,"fill-color",a.length===0?"#000000":{property:n.namecol,type:"categorical",stops:a}),this.map.setPaintProperty(`${e}-boundary`,"fill-opacity",o.length===0?t.opacity:{property:n.namecol,type:"categorical",stops:o}),this.map.setFilter(`${e}-boundary`,["in",n.namecol,...r])},updateObjectStyles({objectId:e,styles:t}){this.map.setLayoutProperty(`${e}-object`,"visibility",t.visible?"visible":"none"),this.map.setLayoutProperty(`${e}-object`,"text-size",t.markerSize),this.map.setLayoutProperty(`${e}-object`,"text-field",["format",["get","id"],{"font-scale":.001},SPM.Utils.Map.Symbols[t.markerSymbol].marker,["get","id"],{"font-scale":.001}])},sync({target:e}){if(!this.selectedObject)return;const t=this.selectedObject.id,s=this.record.rows.reduce((n,r)=>(n[r.id]=r,n),{});if(this.useBoundaries){const n=this.boundaryRecords[t].reduce((r,a)=>(r[a.id]=a,r),{});e==="table"&&(Object.values(s).forEach(r=>{const a=n[r.id];r.selected=a.selected,r.data[1].value=a.AssignedTo}),this.$refs.recordTable.updateSelectAllState()),e==="map"&&(Object.values(n).forEach(r=>{const a=s[r.id];r.selected=a.selected}),this.updateBoundaryStyles({objectId:t}))}else{const r=this.map.getSource(`${t}-object`)._data.features.reduce((a,o)=>(a[o.properties.id]=o,a),{});e==="table"&&(Object.values(s).forEach(a=>{const o=r[a.id];a.selected=o.properties.selected,a.data[a.data.length-2].value=o.properties.AssignedTo,a.data[a.data.length-1].value=o.properties.AssignmentType}),this.$refs.recordTable.updateSelectAllState()),e==="map"&&Object.values(r).forEach(a=>{const o=s[a.properties.id];a.properties.selected!==o.selected&&(a.properties.selected=o.selected,this.map.setFeatureState({source:`${t}-object`,id:a.properties.id},{selected:a.properties.selected,color:a.properties.selected?"#FFFF00":a.properties.color}))})}},nodeUpdated({node:e}){var t;if(this.useBoundaries)this.$store.boundaryLayers.forEach(s=>{this.updateBoundaryStyles({objectId:s.id})});else{const s=(t=this.$store.nodeMap[this.targetId])==null?void 0:t.color;this.$store.preferences.Map.layers.filter(n=>n.type==="object").forEach(n=>{this.map.getSource(`${n.id}-object`)._data.features.forEach(a=>{a.properties.nodeId===e.id&&a.properties.color!==e.color&&(a.properties.color=e.color,this.map.setFeatureState({source:`${n.id}-object`,id:a.properties.id},{color:a.properties.selected?s||"#FFFF00":a.properties.color}))})})}},checkAssignmentBehavior(e){return SPM.Utils.Node.isExclusiveBranch({node:this.$store.rootNode})?!0:(this.$store.preferences.AssignmentExplorer.mode="Grid",e||this.$store.toast({message:"Map view is not supported for a non-exclusive hierarchy.  Switching back to grid view.",state:"warning"}),!1)},updateTab(e){if(e.startsWith("object_")){const t=this.$store.allObjects.find(s=>`object_${s.id}`===e);this.useBoundaries?this.loadBoundaryTable({boundaryObject:t}):this.loadRecordsTable({assignmentObject:t}),this.$emit("select-assignment",t)}this.activeTab=e},showAssignmentPanel(){SPM.Components.Assignment.sidePanel="AssignmentPanel"}}},N$=e=>(Nr("data-v-0328c1b1"),e=e(),Dr(),e),Lie={key:0,class:"slds-grow slds-scrollable_none slds-is-relative"},Nie={class:"spm-map-container"},Die=N$(()=>k("div",{id:"spm-map",class:"spm-map"},null,-1)),Bie={key:1,class:"spm-map-distance"},Fie={class:"slds-col slds-grid slds-grid_vertical-align-end slds-is-relative slds-col"},zie={class:"slds-col slds-size_6-of-12 slds-grid summary-container"},Uie={class:"slds-col slds-grid slds-grid_align-end slds-grid_vertical-align-center slds-align-middle"},Vie={key:0,class:"slds-m-left_small slds-align-middle",style:{"font-weight":"700",padding:"4px 16px",background:"#ffffff78","border-radius":"8px"}},jie={key:0,id:"spm-map-selection-summary",class:"slds-grid slds-grid_vertical-align-center slds-m-left_small"},qie={class:"slds-m-right_medium"},Hie={class:"spm-map-selection-summary-badge"},Gie={class:"slds-m-right_medium"},Wie={class:"spm-map-selection-summary-badge"},Yie={key:1,class:"slds-m-right_medium"},Zie={class:"slds-col slds-grid slds-grid_vertical slds-is-relative map-table slds-col"},Xie={key:0,class:"slds-grow slds-grid slds-grid_vertical"},Kie={class:"slds-grid slds-grid_vertical-align-center"},Jie={class:"slds-grid slds-grid_vertical-align-center slds-p-around_small slds-col slds-size_1-of-3"},Qie={class:"slds-grid slds-grid_vertical"},eoe=N$(()=>k("span",null,"Object",-1)),toe={class:"slds-text-color_default slds-page-header__title"},soe={class:"slds-col slds-size_1-of-3"},noe={key:0,class:"slds-grid slds-grid_vertical-align-center slds-p-around_x-small"},roe={style:{"border-radius":"23px",background:"#EEF1F6",padding:"2px 8px"}},ioe={key:1},ooe={key:0},aoe={key:1};function loe(e,t,s,n,r,a){const o=pe("Spinner"),d=pe("MapControls"),p=pe("ButtonIcon"),y=pe("Tab"),v=pe("Tabs"),C=pe("Checkbox"),I=pe("Button"),O=pe("AssignmentTable"),A=pe("Icon"),P=pe("TextInput"),q=pe("DataTable");return r.render?(L(),X("div",Lie,[r.loadingMsg?(L(),Ge(o,{key:0},{description:je(()=>[es(Pe(r.loadingMsg),1)]),_:1})):$e("",!0),k("div",Nie,[r.nonReactive.map?(L(),Ge(d,{key:0,map:r.nonReactive.map},null,8,["map"])):$e("",!0),Die,r.distance?(L(),X("div",Bie,Pe(r.distance),1)):$e("",!0)]),k("div",{class:$t(["map-table-wrapper slds-m-horizontal_small slds-grid slds-grid_vertical",{in:r.tableVisible}])},[k("div",Fie,[de(p,{iconCategory:"utility",iconName:a.tableIcon,variant:"container",iconSize:"small",title:"Settings",assistiveText:"Settings",class:"map-table-visible-btn slds-col slds-size_1-of-12",onClick:t[0]||(t[0]=ce=>r.tableVisible=!r.tableVisible)},null,8,["iconName"]),k("div",zie,[(L(),Ge(v,{key:a.mappableObjectTabs.map(ce=>ce.id).join("-"),scoped:"",class:"map-tabs slds-col slds-size_10-of-12",modelValue:r.activeTab,onChanged:a.updateTab},{default:je(()=>[de(y,{id:"nodes",key:"nodes",title:"Summary",style:{padding:"0"}}),(L(!0),X(Lt,null,As(a.mappableObjectTabs,ce=>(L(),Ge(y,{id:`object_${ce.id}`,key:ce.id,title:ce.label,style:{padding:"0"}},null,8,["id","title"]))),128))]),_:1},8,["modelValue","onChanged"]))]),r.showScrollButtons?(L(),Ge(p,{key:0,iconCategory:"utility",iconName:"back",variant:"container",iconSize:"small",title:"Scroll Summary Tabs Left",assistiveText:"Scroll Summary Tabs Left",class:"map-table-visible-btn slds-col slds-size_1-of-12",onMousedown:t[1]||(t[1]=Os(ce=>a.mousedown("left"),["left"])),onMouseup:a.mouseup},null,8,["onMouseup"])):$e("",!0),r.showScrollButtons?(L(),Ge(p,{key:1,iconCategory:"utility",iconName:"forward",variant:"container",iconSize:"small",title:"Scroll Summary Tabs Right",assistiveText:"Scroll Summary Tabs Right",class:"map-table-visible-btn slds-col slds-size_1-of-12",onMousedown:t[2]||(t[2]=Os(ce=>a.mousedown("right"),["left"])),onMouseup:a.mouseup},null,8,["onMouseup"])):$e("",!0),k("div",Uie,[e.$store.boundaryObjects.length?(L(),X("div",Vie,[de(C,{modelValue:r.useBoundaries,"onUpdate:modelValue":t[3]||(t[3]=ce=>r.useBoundaries=ce),labels:{name:"Use Boundaries"},slide:""},null,8,["modelValue"])])):$e("",!0),de(Pp,null,{default:je(()=>[a.assignmentPanelVisible?$e("",!0):(L(),X("div",jie,[a.hasSelection?(L(),X(Lt,{key:0},[k("span",qie,[k("span",Hie,Pe(e.$F("NumericCompact",r.selectionSummary.counts.boundaries)),1),es(" Boundaries ")]),k("span",Gie,[k("span",Wie,Pe(e.$F("NumericCompact",r.selectionSummary.counts.records)),1),es(" Records ")]),de(p,{iconCategory:"utility",iconName:"zoomin",title:"Zoom To",assistiveText:"Zoom To",class:"slds-m-right_medium",onClick:t[4]||(t[4]=ce=>a.zoomTo({selectedOnly:!0}))})],64)):(L(),X("span",Yie,"Select assignment items...")),e.$store.isEditor?(L(),Ge(I,{key:2,variant:"brand",label:"Assign",disabled:!a.hasSelection,onClick:t[5]||(t[5]=ce=>e.$emit("show-assignment"))},null,8,["disabled"])):$e("",!0)]))]),_:1})])]),k("div",Zie,[Mn(de(O,{ref:"assignmentTable",style:{height:"100%"},selectedObject:a.selectedObject||e.$store.assignmentObjects[0],onShowRules:t[6]||(t[6]=ce=>e.$emit("show-rules",ce)),onNodeUpdated:a.nodeUpdated},null,8,["selectedObject","onNodeUpdated"]),[[Ai,r.activeTab==="nodes"]]),a.selectedObject?(L(),X("div",Xie,[r.tableLoadingMsg?(L(),Ge(o,{key:0},{description:je(()=>[es(Pe(r.tableLoadingMsg),1)]),_:1})):$e("",!0),k("div",Kie,[k("div",Jie,[de(A,{category:a.selectedObject.icon.category,name:a.selectedObject.icon.name,size:"large",class:"slds-m-right_small"},null,8,["category","name"]),k("div",Qie,[eoe,k("span",toe,[k("strong",null,Pe(a.selectedObject.label),1)])])]),k("div",soe,[de(P,{modelValue:r.searchTerm,"onUpdate:modelValue":t[8]||(t[8]=ce=>r.searchTerm=ce),class:"slds-input-has-icon slds-input-has-icon_left-right slds-grow",labels:{placeholder:"Search..."}},{extend:je(()=>[de(A,{category:"utility",name:"search",iconClass:["slds-input__icon","slds-input__icon_left"]}),de(p,{iconCategory:"utility",iconName:"clear",assistiveText:"Clear",iconClass:["slds-button__icon","slds-icon-text-light"],class:"slds-button slds-button_icon slds-input__icon slds-input__icon_right",title:"Clear",onClick:t[7]||(t[7]=ce=>r.searchTerm="")})]),_:1},8,["modelValue","labels"])])]),r.tableLoadingMsg?$e("",!0):(L(),Ge(q,{key:1,ref:"recordTable",columns:r.record.columns,rows:r.filteredRows,bordered:"",columnsBordered:"",multiselectable:"",summaryHeader:"",summaryFooter:"",virtual:""},{summaryHeader:je(({column:ce})=>[es(Pe(a.formatSummaryColumn(ce)),1)]),cell:je(ce=>[ce.column.type==="Special"?(L(),X("div",noe,[k("div",roe,Pe(ce.data.value),1)])):(L(),X("div",ioe,Pe(ce.data.value),1))]),summaryFooter:je(ce=>[ce.column.summaryType==="Unique"?(L(),X("span",ooe,Pe(ce.column.summaryValue),1)):ce.column.summaryType==="Sum"?(L(),X("span",aoe,Pe(e.$F("Numeric",ce.column.summaryValue)),1)):$e("",!0)]),_:1},8,["columns","rows"]))])):$e("",!0)])],2)])):$e("",!0)}const coe=os(Oie,[["render",loe],["__scopeId","data-v-0328c1b1"]]),uoe={name:"AssignmentRoot",components:{NodePanel:SJ,AssignmentPanel:kQ,FilterPanel:eee,LayersPanel:Aee,AssignmentTable:DR,RecordExplorer:zK,Spinner:Vr,AssignmentMap:coe},data(){return{loadingMsg:"Loading Assignment Objects...",sidePanel:"",selectedObject:null}},computed:{assignmentTable(){return this.$store.preferences.AssignmentExplorer.mode==="Map"?SPM.Components.AssignmentMap.$refs.assignmentTable:this.$refs.assignmentTable},availableAssignmentObjects(){return this.$store.assignmentObjects.filter(e=>{var t;return(t=e.recordsDataset)==null?void 0:t.dimensions}).length>0}},async mounted(){SPM.Components.Assignment=this,SPM.Utils.Splunk.sendLog({logName:"spmEPT",logPayload:{pageName:`${this.$store.preferences.AssignmentExplorer.mode} Assignment`}}),setTimeout(()=>{var e;(e=this.selectedObject)!=null&&e.recordsDataset||(this.loadingMsg="")},1e3)},methods:{showRules({nodeId:e}){this.sidePanel="NodePanel",this.$nextTick(()=>this.$refs.nodePanel.assignmentNode=this.$store.nodeMap[e])},async runRules({assignmentObjectIds:e,boundaryObjectIds:t}={}){var s,n,r;(s=this.assignmentTable)==null||s.updateAssignmentCells({assignmentObjectIds:e}),(n=this.assignmentTable)==null||n.updateBoundaryCells({boundaryObjectIds:t}),(r=this.assignmentTable)==null||r.updateMetricCells(),this.$store.preferences.AssignmentExplorer.mode==="Map"&&SPM.Components.AssignmentMap.useBoundaries&&(t||this.$store.boundaryObjects.map(a=>a.id)).forEach(a=>SPM.Components.AssignmentMap.updateBoundaryStyles({objectId:a}))}}},doe={class:"slds-grid",style:{position:"relative",overflow:"hidden"}},hoe={key:1,class:"slds-grid slds-grid_vertical slds-align_absolute-center slds-text-heading_small"};function poe(e,t,s,n,r,a){const o=pe("Spinner"),d=pe("AssignmentTable"),p=pe("RecordExplorer"),y=pe("AssignmentMap"),v=pe("NodePanel"),C=pe("AssignmentPanel"),I=pe("FilterPanel"),O=pe("LayersPanel");return L(),X("div",doe,[r.loadingMsg?(L(),Ge(o,{key:0},{description:je(()=>[es(Pe(r.loadingMsg),1)]),_:1})):a.availableAssignmentObjects?e.$store.preferences.AssignmentExplorer.mode=="Grid"?(L(),X("div",{key:2,class:$t(["slds-grid slds-grid_vertical slds-grow slds-p-around_small slds-scrollable_none spm-transition-all",{"side-panel-in":!!r.sidePanel}]),style:{width:"100%",flex:"none"}},[de(d,{ref:"assignmentTable",style:{flex:"0 0 50%"},selectedObject:r.selectedObject,onSelectAssignment:t[0]||(t[0]=A=>r.selectedObject=A),onShowRules:a.showRules},null,8,["selectedObject","onShowRules"]),de(p,{class:"slds-grow",selectedObject:r.selectedObject,virtual:!0,onSelectAssignment:t[1]||(t[1]=A=>r.selectedObject=A),onShowAssignment:t[2]||(t[2]=A=>r.sidePanel="AssignmentPanel"),onRulesUpdated:a.runRules},null,8,["selectedObject","onRulesUpdated"])],2)):e.$store.preferences.AssignmentExplorer.mode=="Map"?(L(),Ge(y,{key:3,class:$t(["spm-transition-all",{"side-panel-in":!!r.sidePanel}]),style:{width:"100%",flex:"none"},selectedObject:r.selectedObject,onSelectAssignment:t[3]||(t[3]=A=>r.selectedObject=A),onShowRules:a.showRules,onShowAssignment:t[4]||(t[4]=A=>r.sidePanel="AssignmentPanel")},null,8,["class","selectedObject","onShowRules"])):$e("",!0):(L(),X("div",hoe," No Assignment Objects Found ")),de(Pp,{name:"slide"},{default:je(()=>[r.sidePanel==="NodePanel"?(L(),Ge(v,{key:0,ref:"nodePanel",onRulesPreviewed:a.runRules,onRulesUpdated:a.runRules},null,8,["onRulesPreviewed","onRulesUpdated"])):$e("",!0)]),_:1}),de(Pp,{name:"slide"},{default:je(()=>[r.sidePanel==="AssignmentPanel"?(L(),Ge(C,{key:0,selectedObject:r.selectedObject,onRulesPreviewed:a.runRules,onRulesUpdated:a.runRules},null,8,["selectedObject","onRulesPreviewed","onRulesUpdated"])):$e("",!0)]),_:1}),de(Pp,{name:"slide"},{default:je(()=>[r.sidePanel==="FilterPanel"?(L(),Ge(I,{key:0})):$e("",!0)]),_:1}),de(Pp,{name:"slide"},{default:je(()=>[r.sidePanel==="LayersPanel"?(L(),Ge(O,{key:0})):$e("",!0)]),_:1})])}const foe=os(uoe,[["render",poe],["__scopeId","data-v-8f1d62ae"]]),moe={name:"Hierarchy",components:{ActionMenu:wa,ActionMenuItem:Sa,Button:Tn,ButtonIcon:vn,Icon:yn,Card:Xp,TextInput:Ko,Tooltip:Fo,Spinner:Vr,DataTable:Rm,AddNodes:uI,EditNode:OR},props:[],data(){return{loadingMsg:"Loading...",showAddNodesPopup:!1,showEditNodePopup:!1,editNodeError:"",contextRow:{},contextNode:{},targetBindTo:null,rows:[],columns:[]}},computed:{showSharedWith(){return this.$store.hasSalesPlanningTemplateApp&&this.$store.isEditor}},watch:{"$store.rootNode":{async handler(){this.loadTable()}}},async mounted(){SPM.Components.Hierarchy=this,SPM.Utils.Splunk.sendLog({logName:"spmEPT",logPayload:{pageName:"Hierarchy"}}),setTimeout(()=>{this.$store.assignmentObjects.filter(e=>e.recordsDataset.dimensions).length===0&&this.loadTable()},1e3)},methods:{getBoundaryLocationTooltip(e){var t;return((t=e.data)==null?void 0:t.node.boundaries.map(s=>s.sfsp__SalesBoundary__c?s.sfsp__SalesBoundary__r.Name:s.sfsp__IncludePoints__c?`${s.Name} (with point ZIPs)`:s.Name).join("\\n"))||"No boundaries found"},async loadRootNode(e){SPM.Components.Root.loadRootNode(e)},async loadRow(e){e.loading=!0;const t=this.$store.nodeMap[e.id];await this.$store.loadScope({parentNodeIds:[t.id]}),SPM.Utils.Node.buildRows({parentRow:e,childNodes:t.children,lazy:!0}),e.loading=!1,SPM.Utils.Node.calculateValues(this.rows)},loadTable(){if(!this.$store.rootNode)return this.rows=[];this.columns=[{id:"name",name:"Name"},...this.$store.assignmentObjects.filter(t=>t.recordsDataset.dimensions).map(t=>({id:t.id,name:t.label,icon:t.icon})),...this.$store.boundaryObjects.map(t=>({id:t.id,name:t.label,icon:t.icon})),...this.$store.plan.sfsp__SalesMetrics__r.map(t=>({id:t.Id,name:t.Name}))],this.rows=[{id:this.$store.rootNode.id,name:this.$store.rootNode.name,data:[{id:"Name",format:"Name",type:"custom",node:this.$store.rootNode},...this.$store.assignmentObjects.filter(t=>t.recordsDataset.dimensions).map(t=>({id:t.id,format:"Assignment",type:"custom",state:"loading",value:t.totalCount,columnName:t.name})),...this.$store.boundaryObjects.map(t=>({id:t.id,format:"Boundary",type:"custom",state:"loading",value:t.totalCount})),...this.$store.rootNode.metrics.map(t=>{const s=this.$store.plan.sfsp__SalesMetrics__r.find(a=>a.Id===t.sfsp__SalesMetric__c),n=[...Object.keys(t)].filter(a=>a.startsWith("sfsp__Target_Month")),r={id:t.Id,format:"Allocation",type:"custom",dataType:s.sfsp__Type__c,value:n.reduce((a,o)=>a+t[o],0),columnName:s.Name};return r.overrideAmount=s.sfsp__TargetOverrideEnabled__c?t.sfsp__TargetOverrideType__c==="Percentage"?r.value!==0?t.sfsp__TargetOverrideAmount__c/100*r.value:t.sfsp__TargetOverrideAmount__c/100:t.sfsp__TargetOverrideAmount__c:0,r})],parent:null,children:[],expanded:!0,loaded:!1}],this.showSharedWith&&(this.columns.splice(1,0,{id:"sharedWith",name:"Shared With"}),this.rows[0].data.splice(1,0,{id:"SharedWith",format:"Shared with",type:"custom",node:this.$store.rootNode}));const e=t=>{const s=[];t.forEach(n=>{const r=this.$store.nodeMap[n.id];if(!r.children)return;const a=SPM.Utils.Node.buildRows({parentRow:n,childNodes:r.children,lazy:!0});s.push(...a)}),s.length>0&&e(s)};e(this.rows),SPM.Utils.Node.calculateValues(this.rows),this.loadingMsg=""},async addNodes({levels:e}){const t=this.contextNode.id;this.closePopover(),this.loadingMsg="Adding Nodes...",await this.$store.addNodes({parentId:t,levels:e});const s=n=>{const r=[];n.forEach(a=>{const o=this.$store.nodeMap[a.id];if(!o.children)return;const d=a.children.reduce((y,v)=>(y[v.id]=v,y),{}),p=SPM.Utils.Node.buildRows({parentRow:a,childNodes:o.children.filter(y=>!d[y.id]),lazy:!0});r.push(...p)}),r.length>0&&s(r)};s([this.contextRow]),SPM.Utils.Node.calculateValues(this.rows),await this.$nextTick(),this.$store.toast({message:"Nodes Added"}),this.contextRow={},this.contextNode={},this.loadingMsg=""},async editNode({id:e,name:t,parentId:s,nodeHasNewParent:n}){this.editNodeError="";const r=this.$store.nodeMap[e],a=[];if(n){await this.$store.loadAncestors({nodeId:s});let o=this.$store.nodeMap[s],d=!1,p=!1;const y=r.boundaries.map(I=>I.sfsp__ContainerSet__c);for(a.unshift(s);o.parentId&&!d&&!p;)o.parentId===e?d=!0:y.length&&o.boundaries.length&&(p=y.some(I=>o.boundaries.map(O=>O.sfsp__ContainerSet__c).includes(I))),a.unshift(o.parentId),o=this.$store.nodeMap[o.parentId];if(d){this.editNodeError="Unable to reparent this node to its descendant.";return}if(p){this.editNodeError="Unable to reparent this node to a node that shares the same country for assigned boundaries.";return}this.$store.removeNodeFromParent({nodeId:e}),r.parentId=s;const v=this.contextRow.parent;if(v){const I=v.children.findIndex(P=>P.data[0].node.id===e);for(v.children.splice(I,1),v.children.forEach(P=>{P.data.forEach(q=>{["Assignment","Boundary"].includes(q.format)&&(q.state="loading")})});a[0]!==this.rows[0].id&&a.length>0;)a.splice(0,1);let O=this.rows[0],A=0;for(;A<a.length&&O;)a[A]===r.parentId?this.$store.nodeMap[O.id].children&&(SPM.Utils.Node.buildRows({parentRow:O,childNodes:[r],lazy:!0}),O=null):O=O.children.find(P=>P.id===a[A+1]),A++}const C=this.$store.nodeMap[s];C.childCount+=1,C.children&&(C.children.push(r),C.children.forEach(I=>{I.siblingIds=C.children.filter(O=>O.id!==I.id).map(O=>O.id),I.olderSiblingIds=C.children.slice(0,C.children.indexOf(I)).map(O=>O.id)})),SPM.Utils.Node.calculateValues(this.rows)}this.loadingMsg="Saving Node...",this.closePopover(),await SPM.Utils.Apex.invoke("UpdateSObjects",[[{Id:e,Name:t,sfsp__Parent__c:s!=="All Org"?s:""}],!0]),r.name=t,this.contextRow.name=t,this.contextRow.data[0].node=r,await this.$nextTick(),this.$store.toast({message:"Node Saved"}),this.contextRow={},this.contextNode={},this.loadingMsg=""},async deleteNode({id:e}){this.loadingMsg="Deleting Nodes...";const t=await SPM.Utils.Apex.invoke("Query",[`SELECT Id, sfsp__SalesPlan__c, sfsp__SalesNode__r.Name, sfsp__AccessLevel__c FROM sfsp__SalesUserAccess__c WHERE sfsp__SalesPlan__c = '${this.$store.plan.Id}'`])||[],s=[e,...await SPM.Utils.Node.getDescendantIds({planId:this.$store.plan.Id,nodeIds:[e]})],n=t.filter(o=>s.includes(o.sfsp__SalesNode__c));await SPM.Utils.CRM.delete({records:n.map(o=>({Id:o.Id}))}),await this.$store.deleteNode({nodeId:e});const r=this.contextRow.parent,a=r.children.findIndex(o=>o.data[0].node.id===e);r.children.splice(a,1),r.children.forEach(o=>{o.data.forEach(d=>{["Assignment","Boundary"].includes(d.format)&&(d.state="loading")})}),SPM.Utils.Node.calculateValues(this.rows),await this.$nextTick(),this.$store.toast({message:"Node Deleted"}),this.contextRow={},this.contextNode={},this.loadingMsg=""},openImportHierarchyModal(e){SPM.Components.Root.openModal("importHierarchy",{node:e.data.node})},openShareModal(e){!this.$store.hasSalesPlanningTemplateApp||SPM.Components.Root.openShareModal(e.data.node)},async openDeleteNodeModal(e,t){this.closePopover(),await this.$nextTick(),this.contextRow=e.row,this.contextNode=e.data.node,SPM.Components.Root.openModal("confirm",{title:`Delete ${this.contextNode.name}`,description:"Deleting this node also deletes its assignments, allocations, and descendants.",confirmButton:{label:"Delete",type:"brand"},cancelButton:{label:"Cancel",type:"neutral"},callback:()=>{this.deleteNode({id:this.contextNode.id})}})},async openEditNodePopup(e,t){this.closePopover(),await this.$nextTick(),this.contextRow=e.row,this.contextNode=e.data.node,this.targetBindTo=t.target,this.showEditNodePopup=!0},async openAddNodesPopup(e,t){this.closePopover(),await this.$nextTick(),this.contextRow=e.row,this.contextNode=e.data.node,this.targetBindTo=t.target,this.showAddNodesPopup=!0},closePopover(){this.targetBindTo=null,this.showAddNodesPopup=!1,this.editNodeError="",this.showEditNodePopup=!1}}},_oe=e=>(Nr("data-v-e3605019"),e=e(),Dr(),e),goe={class:"slds-grid slds-grid_vertical slds-grow slds-p-around_small"},yoe={class:"slds-grid slds-grow slds-grid_vertical",style:{height:"100%"}},voe={class:"slds-p-left_small slds-card__header-title slds-p-vertical_medium"},boe={key:0,class:"slds-grid slds-grid_align-spread",style:{width:"100%"}},xoe={class:"slds-col slds-grid slds-grid_vertical-align-center"},woe={class:"slds-col_bump-right"},Soe=["name","onClick"],Coe=["name"],Ioe=["name"],Toe=["name"],Aoe=["name"],Moe={key:0,class:"slds-grid slds-grid_vertical-align-center slds-p-around_x-small slds-col_bump-left"},Eoe=["name"],koe=["id"],Poe=["id"],Roe={class:"editShareIcon"},$oe={key:2},Ooe={key:0,class:"slds-grid slds-grid_align-spread slds-grid_vertical-align-center slds-p-around_x-small"},Loe=_oe(()=>k("b",null,"Target",-1)),Noe=["name"],Doe={key:1,class:"slds-grid slds-grid_align-end slds-grid_vertical-align-center slds-p-around_x-small"},Boe=["name"],Foe={key:3,class:"slds-grid slds-grid_align-end slds-grid_vertical-align-center slds-p-around_x-small"},zoe=["name"],Uoe={key:4,class:"slds-grid slds-grid_align-end slds-grid_vertical-align-center slds-p-around_x-small"},Voe={key:1};function joe(e,t,s,n,r,a){const o=pe("Spinner"),d=pe("ButtonIcon"),p=pe("Tooltip"),y=pe("ActionMenuItem"),v=pe("ActionMenu"),C=pe("DataTable"),I=pe("AddNodes"),O=pe("EditNode"),A=pe("Card");return L(),X("div",goe,[de(A,{id:"hierarchyCard",style:{width:"100%",height:"100%",overflow:"hidden"}},{body:je(()=>[r.loadingMsg?(L(),Ge(o,{key:0},{description:je(()=>[es(Pe(r.loadingMsg),1)]),_:1})):$e("",!0),k("div",yoe,[de(C,{columns:r.columns,rows:r.rows,contentHeader:"",bordered:"",columnsBordered:"",tree:"",virtual:"",onLoadRow:a.loadRow},{"header-content-left":je(()=>{var P;return[k("div",voe,Pe((P=e.$store.rootNode)==null?void 0:P.name),1)]}),cell:je(P=>{var q;return[P.data.format==="Name"?(L(),X("div",boe,[k("div",xoe,[k("div",woe,[k("a",{name:`${P.data.node.name.replaceAll(" ","-").toLowerCase()}-hierarchy-node-name`,style:{color:"#0250D9"},href:"#",onClick:ce=>a.loadRootNode(P.data.node.id)},Pe(P.data.node.name),9,Soe),P.data.node.childCount===1?(L(),X("div",{key:0,name:`${P.data.node.name.replaceAll(" ","-").toLowerCase()}-hierarchy-child-node-count`,class:"slds-text-title"},[es(Pe(P.data.node.childCount)+" child node \u2022 ",1),k("span",{name:`${P.data.node.name.replaceAll(" ","-").toLowerCase()}-hierarchy-level`},"Level "+Pe(P.data.node.level),9,Ioe)],8,Coe)):(L(),X("div",{key:1,name:`${P.data.node.name.replaceAll(" ","-").toLowerCase()}-hierarchy-child-node-count`,class:"slds-text-title"},[es(Pe(P.data.node.childCount)+" child nodes \u2022 ",1),k("span",{name:`${P.data.node.name.replaceAll(" ","-").toLowerCase()}-hierarchy-level`},"Level "+Pe(P.data.node.level),9,Aoe)],8,Toe))])]),((q=P.data)==null?void 0:q.node.boundaries.length)>0?(L(),X("div",Moe,[de(p,{text:a.getBoundaryLocationTooltip(P),alignment:"top"},{source:je(()=>[de(d,{id:`${P.data.node.name}.boundary-icon`,iconCategory:"utility",iconName:"location",variant:"bare",size:"small",assistiveText:`${P.row.name} Boundaries`,title:`${P.row.name} Boundaries`},null,8,["id","assistiveText","title"])]),_:2},1032,["text"])])):$e("",!0),e.$store.isEditor?(L(),X("div",{key:1,name:`${P.row.name.replaceAll(" ","-").toLowerCase()}-hierarchy-node-actions`,class:"slds-col slds-button-group",role:"group"},[de(d,{name:`${P.row.name.replaceAll(" ","-").toLowerCase()}-hierarchy-add-node`,class:$t(P.row.id),iconCategory:"utility",iconName:"add",variant:"border-filled",size:"small",disabled:P.row.parent&&!P.row.parent.loaded,assistiveText:`Add nodes to ${P.row.name}`,title:`Add nodes to ${P.row.name}`,onClick:ce=>a.openAddNodesPopup(P,ce)},null,8,["name","class","disabled","assistiveText","title","onClick"]),de(d,{name:`${P.row.name.replaceAll(" ","-").toLowerCase()}-hierarchy-edit-node`,iconCategory:"utility",iconName:"edit",variant:"border-filled",size:"small",assistiveText:`Edit ${P.row.name}`,title:`Edit ${P.row.name}`,disabled:P.row.id==="All Org"||P.row.parent&&!P.row.parent.loaded,onClick:ce=>a.openEditNodePopup(P,ce)},null,8,["name","assistiveText","title","disabled","onClick"]),de(v,{name:`${P.row.name.replaceAll(" ","-").toLowerCase()}-hierarchy-node-overflow-actions`,class:"slds-button overflowMenu",iconCategory:"utility",iconName:"threedots_vertical",iconSize:"small",buttonIconSize:"small",variant:"border-filled",disabled:P.row.parent&&!P.row.parent.loaded,assistiveText:`${P.row.name} Overflow Actions`,title:`${P.row.name} Overflow Actions`},{default:je(()=>[de(y,{name:`${P.row.name.replaceAll(" ","-").toLowerCase()}-hierarchy-import`,label:"Import Hierarchy",onClick:ce=>a.openImportHierarchyModal(P)},null,8,["name","onClick"]),e.$store.isEditor?(L(),Ge(y,{key:0,name:`${P.row.name.replaceAll(" ","-").toLowerCase()}-share`,label:"Share",disabled:!e.$store.hasSalesPlanningTemplateApp,onClick:ce=>a.openShareModal(P)},null,8,["name","disabled","onClick"])):$e("",!0),(e.$store.isAdmin||e.$store.isManager)&&P.row.id!==e.$store.rootNode.id?(L(),Ge(y,{key:1,name:`${P.row.name.replaceAll(" ","-").toLowerCase()}-hierarchy-remove-node`,label:"Remove Node",onClick:ce=>a.openDeleteNodeModal(P,ce)},null,8,["name","onClick"])):$e("",!0)]),_:2},1032,["name","disabled","assistiveText","title"])],8,Eoe)):$e("",!0)])):P.data.format==="Shared with"?(L(),X("div",{key:1,id:`hierarchy-tab-${P.data.node.name}`,class:"slds-grid slds-grid_align-spread slds-grid_vertical-align-center"},[k("div",{id:`hierarchy-tab-share-with-${P.data.node.name}`},Pe(P.data.node.accessRecords.length>1?`${P.data.node.accessRecords.length} users`:P.data.node.accessRecords.length===1?`${P.data.node.accessRecords[0].name}`:"-"),9,Poe),k("div",Roe,[de(d,{id:`hierarchy-tab-edit-share-${P.data.node.name}`,iconCategory:"utility",iconName:"edit",d:"",size:"x-small",assistiveText:`${P.row.name} Edit Shared With`,title:`${P.row.name} Edit Shared With`,onClick:ce=>a.openShareModal(P)},null,8,["id","assistiveText","title","onClick"])])],8,koe)):P.data.format==="Allocation"?(L(),X("div",$oe,[P.data.overrideAmount?(L(),X("div",Ooe,[de(p,{id:"targetOverrideTooltip",alignment:"left"},{default:je(()=>[k("div",null,[Loe,k("div",null,"Original: "+Pe(e.$F(P.data.dataType,P.data.value)),1),k("div",null,"Override: "+Pe(e.$F(P.data.dataType,P.data.value+P.data.overrideAmount)),1)])]),_:2},1024),k("div",{name:`${P.data.columnName.replaceAll(" ","-").toLowerCase()}-value-${P.row.name.replaceAll(" ","-").toLowerCase()}`},Pe(e.$F(P.data.dataType,P.data.value)),9,Noe)])):(L(),X("div",Doe,[k("div",{name:`${P.data.columnName.replaceAll(" ","-").toLowerCase()}-value-${P.row.name.replaceAll(" ","-").toLowerCase()}`},Pe(e.$F(P.data.dataType,P.data.value)),9,Boe)]))])):P.data.format==="Assignment"?(L(),X("div",Foe,[P.data.state==="loading"?(L(),Ge(o,{key:0,size:"x-small",style:{"z-index":"1"}})):(L(),X("div",{key:1,name:`${P.data.columnName.replaceAll(" ","-").toLowerCase()}-value-${P.row.name.replaceAll(" ","-").toLowerCase()}`},Pe(e.$F("Numeric",P.data.value)),9,zoe))])):P.data.format==="Boundary"?(L(),X("div",Uoe,[P.data.state==="loading"?(L(),Ge(o,{key:0,size:"x-small",style:{"z-index":"1"}})):(L(),X("div",Voe,Pe(e.$F("Numeric",P.data.value)),1))])):$e("",!0)]}),_:1},8,["columns","rows","onLoadRow"])]),r.showAddNodesPopup?(L(),Ge(I,{key:1,contextNode:r.contextNode,targetBindTo:r.targetBindTo,onClose:a.closePopover,onSave:a.addNodes},null,8,["contextNode","targetBindTo","onClose","onSave"])):r.showEditNodePopup?(L(),Ge(O,{key:2,allowReparent:"true",contextNode:r.contextNode,targetBindTo:r.targetBindTo,error:r.editNodeError,onClose:a.closePopover,onSave:a.editNode},null,8,["contextNode","targetBindTo","error","onClose","onSave"])):$e("",!0)]),_:1})])}const qoe=os(moe,[["render",joe],["__scopeId","data-v-e3605019"]]),Hoe={name:"ContainerSetSelector",components:{Checkbox:za},props:["containerSets","nodeContainersToDelete","usedIsoPrefixes","nodeBoundaries","node"],data(){return{countries:[],filterTerm:"",isSharingEditor:!this.$store.isAdmin&&!this.$store.isManager&&this.$store.branch.accessLevel==="Editor"}},watch:{filterTerm(){this.countries.forEach(e=>{e.visible=this.filterTerm.length===0||e.id.toLowerCase().includes(this.filterTerm.toLowerCase())})}},async created(){await SPM.Utils.Async.wait(250),this.countries=[...[...new Set(Object.values(this.$store.activeContainerSets).filter(e=>this.$store.salesBoundaries.find(t=>e.id===t.sfsp__ContainerSet__c)||this.nodeBoundaries.find(t=>e.id===t.containerSetId)).map(e=>e.country))].sort().map(e=>({id:e,label:e,visible:!0,selected:!1,disabled:!1,canFilter:!1,filter:[],boundaries:[],selectedBoundary:""}))],this.countries.forEach(e=>{var n;e.boundaries=Object.values(this.$store.activeContainerSets).filter(r=>r.country===e.id).flatMap(r=>{const a={value:r.id,label:r.boundary,size:r.size,hasPointBoundaries:!1,country:r.country},o=this.$store.salesBoundaries.find(p=>r.id===p.sfsp__ContainerSet__c&&p.sfsp__IncludePoints__c)||this.nodeBoundaries.find(p=>r.id===p.containerSetId&&p.includesPoints),d=this.$store.salesBoundaries.find(p=>r.id===p.sfsp__ContainerSet__c&&!p.sfsp__IncludePoints__c)||this.nodeBoundaries.find(p=>r.id===p.containerSetId&&!p.includesPoints);if(r.id.startsWith("USA_PCB")){const p={value:`${r.id}|Points`,label:`${r.boundary} (with point ZIP codes)`,size:`${r.size} + Points`,hasPointBoundaries:!0,country:r.country};if(o&&d)return[a,p];if(o)return[p]}return[a]}).sort((r,a)=>{const o={a:r,b:a};return["a","b"].forEach(d=>{const p=o[d].value.split("_")[1]||"";let y=4;p==="PCB"?y=0:p.startsWith("P")?y=1:p.startsWith("A")&&(y=2),o[`${d}Rank`]=y}),o.aRank-o.bRank});const t=this.nodeBoundaries.filter(r=>e.boundaries.find(a=>a.value.replace("|Points","")===r.containerSetId&&a.hasPointBoundaries===r.includesPoints))||[];e.isNodeContainer=t.some(r=>r.rootNodeId===this.node.id),e.selected=t.some(r=>!!r.id),e.selectedBoundary=((n=t[0])==null?void 0:n.containerSetId)||e.boundaries[0].value,e.disabled=this.usedIsoPrefixes.includes(e.selectedBoundary.split("_")[0]),e.hasExisitingContainer=this.usedIsoPrefixes.includes(e.selectedBoundary.split("_")[0]);const s={};if(t.length>0){if(!e.isNodeContainer&&e.selected){const r=Object.values(this.$store.nodeMap).filter(o=>t.find(d=>d.rootNodeId===o.id)),a=SPM.Utils.Node.getDescendants({nodes:[this.node]});r.reduce((o,d)=>{let p="";const y=SPM.Utils.Node.isAncestor({node:this.node,ancestor:d,nodeMap:this.$store.nodeMap});y&&(p=` - inherited from ancestor, "${d.name}"`);const v=a.some(C=>C.id===d.id);return v&&!y&&(p=` - enabled on descendant, "${d.name}"`),o[d.id]={label:p,isAncestor:y,isDescendant:v},o},s)}e.boundaries.forEach(r=>{const a=t.find(d=>d.containerSetId===r.value.replace("|Points","")&&d.includesPoints===r.hasPointBoundaries),o=s[a==null?void 0:a.rootNodeId]||{};a?(r.selected=o.isAncestor||o.isDescendant?o.isAncestor||!o.isDescendant:!0,r.disabled=!e.isNodeContainer||this.isSharingEditor,r.label+=o.label||(r.selected?` - currently enabled${this.isSharingEditor?", ask admin or manager to remove boundaries.":""}`:""),e.filter=a.filter||[]):r.disabled=e.disabled})}}),this.$emit("loaded")},methods:{onBoundaryChanged(e){const t=this.countries.find(n=>n.id===e.country);t.selected=e.selected,t.disabled=e.selected,t.selectedBoundary=e.value,t.boundaries.filter(n=>n.value!==e.value).forEach(n=>n.disabled=e.selected);const s=this.node.boundaries.find(n=>n.sfsp__SalesBoundary__r?n.sfsp__SalesBoundary__r.sfsp__ContainerSet__c===e.value.replace("|Points","")&&n.sfsp__SalesBoundary__r.sfsp__IncludePoints__c===e.hasPointBoundaries:n.sfsp__ContainerSet__c===e.value.replace("|Points","")&&n.sfsp__IncludePoints__c===e.hasPointBoundaries);if(s&&!e.selected)this.nodeContainersToDelete.push(s),t.hasExisitingContainer=e.selected;else if(s&&e.selected){const n=this.nodeContainersToDelete.findIndex(r=>r.sfsp__SalesBoundary__r?r.sfsp__SalesBoundary__r.sfsp__ContainerSet__c===e.value.replace("|Points","")&&r.sfsp__SalesBoundary__r.sfsp__IncludePoints__c===e.hasPointBoundaries:r.sfsp__ContainerSet__c===e.value.replace("|Points","")&&r.sfsp__IncludePoints__c===e.hasPointBoundaries);this.nodeContainersToDelete.splice(n,1),t.hasExisitingContainer=e.selected}this.containerSets.splice(0,this.containerSets.length,...this.countries.filter(n=>n.selected&&!n.hasExisitingContainer).map(n=>({id:n.selectedBoundary,filter:n.filter,hasPointBoundaries:n.boundaries.find(r=>r.selected).hasPointBoundaries,boundary:n.boundaries.find(r=>r.selected)})))}}},Goe={ref:"popupAnchor",class:"slds-grid slds-grid_vertical slds-theme_default slds-m-left_small",style:{"max-height":"400px","overflow-y":"auto"}},Woe=["id"];function Yoe(e,t,s,n,r,a){const o=pe("Checkbox");return L(),X("div",null,[k("div",Goe,[(L(!0),X(Lt,null,As(r.countries,(d,p)=>(L(),X("div",{id:d.id,key:d.id,class:$t(["slds-text-heading_small slds-m-left_medium",{"slds-p-top_medium":p===0,"slds-p-bottom_medium":p===r.countries.length-1,"slds-p-top_x-small":p!==0,"slds-p-bottom_x-small":p!==r.countries.length-1}]),title:"Country"},[es(Pe(d.label)+" ",1),(L(!0),X(Lt,null,As(d.boundaries,(y,v)=>(L(),Ge(o,{id:y.label.replaceAll(" ","-"),key:v,modelValue:y.selected,"onUpdate:modelValue":C=>y.selected=C,labels:{name:y.label},disabled:y.disabled,onChange:C=>a.onBoundaryChanged(y)},null,8,["id","modelValue","onUpdate:modelValue","labels","disabled","onChange"]))),128))],10,Woe))),128))],512)])}const Zoe=os(Hoe,[["render",Yoe],["__scopeId","data-v-e602b473"]]),Xoe={name:"ManageGeoBoundariesModal",components:{ContainerSetSelector:Zoe,Button:Tn,Icon:yn,Modal:zc,Spinner:Vr},props:["config"],emits:["close"],data(){return{loadingMsg:"Loading Boundaries...",confirmDeletion:!1,containerSets:[],nodeBoundaries:[],nodeContainersToDelete:[]}},computed:{usedIsoPrefixes(){return this.nodeBoundaries.map(e=>e.containerSetId.split("_")[0])}},async mounted(){SPM.Components.ManageGeoBoundariesModal=this,this.init()},methods:{async init(){if(this.nodeBoundaries=SPM.Utils.Node.getBoundaryObjects({node:this.config.node,nodeMap:this.$store.nodeMap,includeDescendants:!0}),!this.$store.allManagedContainerSetsLoaded){const e=[...new Set(this.$store.salesBoundaries.map(t=>t.sfsp__ContainerSet__c)),...new Set(this.nodeBoundaries.map(t=>t.containerSetId))];await this.$store.loadContainerSets(e),this.$store.$patch({allManagedContainerSetsLoaded:!0})}this.loadingMsg=""},previousApply(){this.confirmDeletion=!1},confirmApply(){this.confirmDeletion=!0},async save(){if(this.loadingMsg="Saving Node Boundaries...",this.nodeContainersToDelete.length){const t=[],s=this.nodeContainersToDelete.map(r=>({Id:r.Id}));t.push(...s);const n=this.nodeContainersToDelete.length?await SPM.Utils.Rest.invoke("Query",{query:`SELECT Id FROM sfsp__SalesNodeRule__c WHERE sfsp__SalesNodeBoundary__c IN (${this.nodeContainersToDelete.map(r=>`'${r.Id}'`).join(", ")})`}):[];n.length&&t.push(...n),await SPM.Utils.CRM.delete({records:t})}const e=this.containerSets.map(t=>{const s=t.id.replace("|Points",""),n=this.$store.containerSets[s],r=this.$store.salesBoundaries.find(o=>o.sfsp__ContainerSet__c===s&&o.sfsp__IncludePoints__c===t.hasPointBoundaries),a=this.config.node.boundaries.find(o=>o.sfsp__ContainerSet__c===s&&o.sfsp__IncludePoints__c===t.hasPointBoundaries)||this.nodeBoundaries.find(o=>o.containerSetId===s&&o.includesPoints===t.hasPointBoundaries);if(!r)throw this.$store.toast({message:`Could not find a matching SalesBoundary__c for ${t.boundary.label}. Check your plan config.`,duration:null,state:"error"}),new Error("Could not find a matching SalesBoundary__c. Check your plan config.");return a?{Id:a.Id||a.id,Name:n.label,sfsp__SalesPlan__c:this.config.plan.Id,sfsp__SalesNode__c:this.config.node.id==="All Org"?"":this.config.node.id,sfsp__SalesBoundary__c:r.Id,sfsp__ContainerSet__c:n.id,sfsp__IncludePoints__c:t.hasPointBoundaries,sfsp__Filter__c:JSON.stringify(t.filter)}:{sobjectType:"sfsp__SalesNodeBoundary__c",Name:n.label,sfsp__SalesPlan__c:this.config.plan.Id,sfsp__SalesNode__c:this.config.node.id==="All Org"?"":this.config.node.id,sfsp__SalesBoundary__c:r.Id,sfsp__ContainerSet__c:n.id,sfsp__IncludePoints__c:t.hasPointBoundaries,sfsp__Filter__c:JSON.stringify(t.filter)}});await SPM.Utils.CRM.upsert({records:e,onProgress:t=>this.loadingMsg=`Saving Boundaries...${t}%`}),this.config.callback(e,this.nodeContainersToDelete),await this.$nextTick(),this.loadingMsg="",this.$emit("close")}}},Dx=e=>(Nr("data-v-25f71d52"),e=e(),Dr(),e),Koe=Dx(()=>k("div",{class:"slds-m-top_small"},"Enable boundaries for use on this hierarchy item and its descendants.",-1)),Joe={key:0,style:{"min-height":"15rem"}},Qoe={key:1,class:"slds-grid slds-grid_vertical",style:{"min-height":"15rem"}},eae={id:"limit-information-text",class:"slds-scoped-notification slds-media slds-media_center slds-scoped-notification_light",role:"status"},tae=Dx(()=>k("div",{class:"slds-media__body slds-p-left_small"},[k("p",null,"Limit of one boundary per country per hierarchy branch.")],-1)),sae={class:"slds-col"},nae=Dx(()=>k("div",{class:"slds-col slds-p-top_small"},[k("p",null,"Removing boundaries from nodes will delete any assoicated boundary rules and assignments.")],-1)),rae=Dx(()=>k("div",{class:"slds-col slds-size_2-of-3 slds-text-align_center"},[k("p",null,"This cannot be undone.")],-1)),iae={class:"slds-grid"},oae={key:0,class:"slds-col_bump-left"},aae={key:1,class:"slds-col_bump-left"};function lae(e,t,s,n,r,a){const o=pe("Spinner"),d=pe("Icon"),p=pe("ContainerSetSelector"),y=pe("Button"),v=pe("Modal");return L(),Ge(v,{id:"manage-geo-boundaries",ref:"modal",title:`Manage Boundaries for '${s.config.node.name}'`,size:"small",detach:"",onClose:t[2]||(t[2]=C=>e.$emit("close"))},{tagline:je(()=>[Koe]),content:je(()=>[r.loadingMsg?(L(),X("div",Joe,[de(o,null,{description:je(()=>[es(Pe(r.loadingMsg),1)]),_:1})])):r.confirmDeletion?(L(),X("div",{key:2,class:"slds-grid slds-grid_vertical slds-grid_vertical-align-center slds-grid_align-center",style:br({"min-height":r.loadingMsg?"15rem":"10rem"})},[k("div",sae,[de(d,{category:"utility",name:"warning",size:"large",assistiveText:"Boundary Info"})]),nae,rae],4)):(L(),X("div",Qoe,[k("div",eae,[de(d,{category:"utility",name:"info",class:"slds-button_icon-container slds-button__icon",assistiveText:"Boundary Info"}),tae]),e.$store.allManagedContainerSetsLoaded?(L(),Ge(p,{key:0,id:"boundaries-selector",class:"slds-col",containerSets:r.containerSets,nodeContainersToDelete:r.nodeContainersToDelete,usedIsoPrefixes:a.usedIsoPrefixes,nodeBoundaries:r.nodeBoundaries,node:s.config.node,onLoaded:t[0]||(t[0]=C=>r.loadingMsg="")},null,8,["containerSets","nodeContainersToDelete","usedIsoPrefixes","nodeBoundaries","node"])):$e("",!0)]))]),footer:je(()=>[k("div",iae,[r.confirmDeletion?(L(),X("div",aae,[de(y,{class:"slds-button slds-button_neutral",disabled:r.loadingMsg.length>0,onClick:a.previousApply},{default:je(()=>[es("Previous")]),_:1},8,["disabled","onClick"]),r.nodeContainersToDelete.length>0?(L(),Ge(y,{key:0,class:"slds-button slds-button_brand",disabled:r.nodeContainersToDelete.length===0||r.loadingMsg.length>0,onClick:a.save},{default:je(()=>[es("Confirm")]),_:1},8,["disabled","onClick"])):$e("",!0)])):(L(),X("div",oae,[de(y,{class:"slds-button slds-button_neutral",disabled:r.loadingMsg.length>0,onClick:t[1]||(t[1]=C=>e.$emit("close"))},{default:je(()=>[es("Cancel")]),_:1},8,["disabled"]),r.nodeContainersToDelete.length>0?(L(),Ge(y,{key:0,class:"slds-button slds-button_brand",disabled:r.nodeContainersToDelete.length===0||r.loadingMsg.length>0,onClick:a.confirmApply},{default:je(()=>[es("Apply")]),_:1},8,["disabled","onClick"])):(L(),Ge(y,{key:1,class:"slds-button slds-button_brand",disabled:r.containerSets.length===0||r.loadingMsg.length>0,onClick:a.save},{default:je(()=>[es("Add")]),_:1},8,["disabled","onClick"]))]))])]),_:1},8,["title"])}const cae=os(Xoe,[["render",lae],["__scopeId","data-v-25f71d52"]]),uae={name:"Listbox",components:{ButtonIcon:vn},props:["labels","options"],methods:{moveUp(){for(let e=1;e<this.options.length;e++)if(this.options[e].active&&!this.options[e-1].active){const[t,s]=this.options.slice(e-1,e+1);this.options.splice(e-1,2,s,t)}},moveDown(){for(let e=this.options.length-2;e>=0;e--)if(this.options[e].active&&!this.options[e+1].active){const[t,s]=this.options.slice(e,e+2);this.options.splice(e,2,s,t)}},moveToTop(){this.options.splice(0,this.options.length,...this.options.filter(e=>e.active),...this.options.filter(e=>!e.active))},moveToBottom(){this.options.splice(0,this.options.length,...this.options.filter(e=>!e.active),...this.options.filter(e=>e.active))}}},dae={key:0},hae={class:"slds-form-element__label"},pae={class:"slds-dueling-list"},fae={class:"slds-dueling-list__column",style:{flex:"1 0 0"}},mae={class:"slds-dueling-list__options",style:{width:"auto",height:"12rem"}},_ae={"aria-multiselectable":"true",class:"slds-listbox slds-listbox_vertical",role:"listbox"},gae=["onClick"],yae=["aria-selected"],vae={class:"slds-media__body"},bae=["title"],xae={class:"slds-m-left_small spm-listbox-order-controls"};function wae(e,t,s,n,r,a){var d;const o=pe("ButtonIcon");return L(),X("div",null,[(d=s.labels)!=null&&d.name?(L(),X("div",dae,[k("label",hae,[k("strong",null,Pe(s.labels.name),1)])])):$e("",!0),k("div",pae,[k("div",fae,[k("div",mae,[k("ul",_ae,[(L(!0),X(Lt,null,As(s.options,(p,y)=>(L(),X("li",{key:y,role:"presentation",class:"slds-listbox__item",onClick:v=>p.active=!p.active},[k("div",{class:$t(["slds-listbox__option slds-listbox__option_plain slds-media slds-media_small slds-media_inline",{active:p.active}]),"aria-selected":p.active,draggable:"true",role:"option"},[k("span",vae,[k("span",{class:"slds-truncate",title:p.label},Pe(p.label),9,bae)])],10,yae)],8,gae))),128))])])]),k("div",xae,[k("div",null,[de(o,{variant:"border-filled",iconCategory:"utility",iconName:"arrow_top",title:"Move Selection Up",assistiveText:"Move Selection To Top",onClick:a.moveToTop},null,8,["onClick"])]),k("div",null,[de(o,{variant:"border-filled",iconCategory:"utility",iconName:"arrowup",title:"Move Selection Down",assistiveText:"Move Selection Up",onClick:a.moveUp},null,8,["onClick"])]),k("div",null,[de(o,{variant:"border-filled",iconCategory:"utility",iconName:"arrowdown",title:"Move Selection Down",assistiveText:"Move Selection Down",onClick:a.moveDown},null,8,["onClick"])]),k("div",null,[de(o,{variant:"border-filled",iconCategory:"utility",iconName:"arrow_bottom",title:"Move Selection Down",assistiveText:"Move Selection To Bottom",onClick:a.moveToBottom},null,8,["onClick"])])])])])}const Sae=os(uae,[["render",wae],["__scopeId","data-v-d1cb60ee"]]),Cae={name:"EditNodeModal",components:{SLDSButton:Tn,ButtonIcon:vn,TextInput:Ko,Picklist:Qi,ColorPicker:ZB,Modal:zc,Spinner:Vr,Listbox:Sae,Selectlist:UR},props:["config"],emits:["close"],data(){return{loadingMsg:"Loading...",name:"",color:"#2C7ED0",assignmentBehavior:"Exclusive",assignmentBehaviorOptions:[{id:"Exclusive",label:"One-to-one",description:"Assign each record to one node"},{id:"Non-Exclusive",label:"One-to-many",description:"Assign each record to one or more nodes"}],nodePriorities:[],ownerId:"",ownerOptions:[{options:async e=>this.getUsers(e,"owner")}],users:[],userOptions:[{options:async e=>this.getUsers(e)}],roleOptions:[]}},async mounted(){SPM.Components.EditNodeModal=this,this.name=this.config.node.name,this.color=this.config.node.color,this.ownerId=this.config.node.ownerId,this.assignmentBehavior=this.config.node.assignmentBehavior,this.users=JSON.parse(JSON.stringify(this.config.node.users)),await Promise.all([(async()=>{if(SPM.etmEnabled){const e=(await SPM.Utils.Rest.invoke("SObject",{sObject:"UserTerritory2Association"})).fields.find(t=>t.name==="RoleInTerritory2").picklistValues.filter(t=>t.active).map(t=>t.label);this.roleOptions.push(...e)}})(),(async()=>{await this.$store.loadScope({parentNodeIds:[this.config.node.id]}),this.nodePriorities=this.config.node.children.map(e=>({active:!1,label:e.name,node:e}))})()]),this.$refs.owner.input=this.config.node.ownerName,this.loadingMsg=""},methods:{async getUsers(e,t){e=e.replace(/'/g,"\\'");const s=await SPM.Utils.Rest.invoke("Query",{query:`SELECT Id, Name, FirstName, LastName, Title FROM User WHERE Name LIKE '%${e}%' LIMIT 10`});return t==="owner"?s:s.filter(n=>!this.users.find(r=>r.sfsp__User__c===n.Id))},addUser(e){this.config.node.id!=="All Org"?this.users.push({sobjectType:"sfsp__SalesNodeUser__c",sfsp__SalesNode__c:this.config.node.id,sfsp__Role__c:"",sfsp__User__c:e.Id,sfsp__User__r:e}):this.users.push({sobjectType:"sfsp__SalesPlanUser__c",sfsp__SalesPlan__c:this.$store.plan.Id,sfsp__Role__c:"",sfsp__User__c:e.Id,sfsp__User__r:e})},async save(){var s,n;this.loadingMsg="Saving...";const e=[];this.config.node.id!=="All Org"?e.push({Id:this.config.node.id,Name:this.name,sfsp__Color__c:this.color,sfsp__Owner__c:this.ownerId,sfsp__AssignmentBehavior__c:this.assignmentBehavior}):e.push({Id:this.$store.plan.Id,sfsp__AssignmentBehavior__c:this.assignmentBehavior,sfsp__Owner__c:this.ownerId}),this.nodePriorities.forEach((r,a)=>{r.node.id!==this.config.node.children[a].id&&e.push({Id:r.node.id,sfsp__Priority__c:a+1})}),await SPM.Utils.CRM.upsert({records:e});const t=[];this.users.forEach(r=>{const a=this.config.node.users.findIndex(o=>o.sfsp__User__c===r.sfsp__User__c&&o.sfsp__Role__c===r.sfsp__Role__c);a!==-1?this.config.node.users.splice(a,1):(delete r.Id,t.push(r))}),await Promise.all([SPM.Utils.CRM.upsert({records:t}),SPM.Utils.Rest.invoke("Delete",{ids:this.config.node.users.map(r=>r.Id)})]),Object.assign(this.config.node,{name:this.name,color:this.color,ownerId:this.ownerId,ownerName:(n=(s=this.$refs)==null?void 0:s.owner)==null?void 0:n.input,assignmentBehavior:this.assignmentBehavior,users:this.users}),this.config.node.children.splice(0,this.config.node.children.length,...this.nodePriorities.map(r=>this.$store.nodeMap[r.node.id])),this.config.node.children.forEach(r=>{r.siblingIds=this.config.node.children.filter(a=>a.id!==r.id).map(a=>a.id),r.olderSiblingIds=this.config.node.children.slice(0,this.config.node.children.indexOf(r)).map(a=>a.id)}),this.config.callback(),this.$emit("close")}}},Iae={class:"slds-grid slds-gutters_medium slds-m-bottom_medium"},Tae={class:"slds-col slds-size_1-of-2"},Aae=k("label",{class:"slds-form-element__label slds-m-top_medium"},[k("strong",null,"Record Assignment to Children")],-1),Mae={class:"slds-col slds-size_1-of-2"},Eae={style:{width:"30%"}},kae={style:{"font-size":"12px","line-height":"20px","font-weight":"500",color:"#000"}},Pae={style:{"font-size":"10px","line-height":"20px","font-weight":"400",color:"#444"}},Rae={class:"spm-box slds-p-around_medium slds-m-vertical_medium"},$ae=k("div",{class:"slds-m-bottom_small",style:{"font-size":"16px","line-height":"24px"}},"Assigned Users",-1),Oae={style:{width:"30%"}},Lae={style:{"font-size":"12px","line-height":"20px","font-weight":"500",color:"#000"}},Nae={style:{"font-size":"10px","line-height":"20px","font-weight":"400",color:"#444"}},Dae={class:"spm-box"},Bae={class:"slds-table slds-table_bordered slds-table_fixed-layout"},Fae=k("thead",null,[k("tr",null,[k("th",{style:{width:"15rem",background:"#EEF1F6"}},"User"),k("th",{style:{background:"#EEF1F6"}},"Role"),k("th",{style:{width:"2.5rem",background:"#EEF1F6"}})])],-1),zae={class:"slds-truncate slds-p-vertical_small"},Uae={class:"slds-grid"},Vae={class:"slds-col_bump-left"};function jae(e,t,s,n,r,a){const o=pe("Spinner"),d=pe("TextInput"),p=pe("Selectlist"),y=pe("ColorPicker"),v=pe("Listbox"),C=pe("Picklist"),I=pe("ButtonIcon"),O=pe("SLDSButton"),A=pe("Modal");return L(),Ge(A,{ref:"modal",title:`Edit ${s.config.node.name}`,size:"small",detach:"",onClose:t[5]||(t[5]=P=>e.$emit("close"))},{content:je(()=>[r.loadingMsg?(L(),Ge(o,{key:0},{description:je(()=>[k("div",null,Pe(r.loadingMsg),1)]),_:1})):$e("",!0),k("div",Iae,[k("div",Tae,[de(d,{modelValue:r.name,"onUpdate:modelValue":t[0]||(t[0]=P=>r.name=P),labels:{name:"Name"},class:"slds-grow",disabled:s.config.node.id==="All Org"},null,8,["modelValue","disabled"]),Aae,de(p,{modelValue:r.assignmentBehavior,"onUpdate:modelValue":t[1]||(t[1]=P=>r.assignmentBehavior=P),options:r.assignmentBehaviorOptions,class:"slds-m-bottom_medium",small:""},null,8,["modelValue","options"])]),k("div",Mae,[de(y,{modelValue:r.color,"onUpdate:modelValue":t[2]||(t[2]=P=>r.color=P),labels:{chooseColor:"Map Color"},disabled:s.config.node.id==="All Org"},null,8,["modelValue","disabled"]),de(v,{options:r.nodePriorities,labels:{name:"Child Assignment Priority"},class:"slds-m-top_medium"},null,8,["options"])])]),k("div",null,[k("div",Eae,[de(C,{ref:"owner",modelValue:r.ownerId,"onUpdate:modelValue":t[3]||(t[3]=P=>r.ownerId=P),labels:{name:"Owner",search:"Search users..."},options:r.ownerOptions,idKey:"Id",titleKey:"Name",filterable:""},{option:je(({option:{Name:P,Title:q}})=>[k("div",null,[k("div",kae,Pe(P),1),k("div",Pae,Pe(q),1)])]),_:1},8,["modelValue","labels","options"])]),k("div",Rae,[$ae,k("div",Oae,[de(C,{labels:{search:"Search users..."},labelForId:"User Search",options:r.userOptions,idKey:"Id",titleKey:"Name",filterable:"",class:"slds-m-vertical_small",onSelectedOption:a.addUser},{option:je(({option:{Name:P,Title:q}})=>[k("div",null,[k("div",Lae,Pe(P),1),k("div",Nae,Pe(q),1)])]),_:1},8,["labels","options","onSelectedOption"])]),k("div",Dae,[k("table",Bae,[Fae,k("tbody",null,[(L(!0),X(Lt,null,As(r.users,(P,q)=>(L(),X("tr",{key:q},[k("td",null,[k("div",zae,Pe(P.sfsp__User__r.Name),1)]),k("td",null,[de(C,{modelValue:P.sfsp__Role__c,"onUpdate:modelValue":ce=>P.sfsp__Role__c=ce,labels:{search:"Search roles..."},labelForId:"Role Search",options:r.roleOptions,filterable:"",combobox:"",style:{width:"250px"}},null,8,["modelValue","onUpdate:modelValue","labels","options"])]),k("td",null,[de(I,{iconCategory:"utility",iconName:"close",class:"close-button",assistiveText:"Remove User",title:"Remove User",onClick:ce=>r.users.splice(q,1)},null,8,["onClick"])])]))),128))])])])])])]),footer:je(()=>[k("div",null,[k("div",Uae,[k("div",Vae,[de(O,{class:"slds-button slds-button_neutral",onClick:t[4]||(t[4]=P=>e.$emit("close"))},{default:je(()=>[es("Cancel")]),_:1}),de(O,{class:"slds-button slds-button_brand",onClick:a.save},{default:je(()=>[es("Save")]),_:1},8,["onClick"])])])])]),_:1},8,["title"])}const qae=os(Cae,[["render",jae]]),Hae={name:"ConfirmModal",components:{Button:Tn,Checkbox:za,Icon:yn,Modal:zc},props:["config"],computed:{confirmButtonClass(){var e,t;return(t=(e=this.config)==null?void 0:e.confirmButton)!=null&&t.type?`slds-button slds-button_${this.config.confirmButton.type}`:"slds-button slds-button_brand"},confirmButtonText(){var e,t;return(t=(e=this.config)==null?void 0:e.confirmButton)!=null&&t.label?this.config.confirmButton.label:"Confirm"},cancelButtonClass(){var e,t;return(t=(e=this.config)==null?void 0:e.cancelButton)!=null&&t.type?`slds-button slds-button_${this.config.cancelButton.type}`:"slds-button slds-button_neutral"},cancelButtonText(){var e,t;return(t=(e=this.config)==null?void 0:e.cancelButton)!=null&&t.label?this.config.cancelButton.label:"Cancel"}},methods:{confirm(){this.config.callback({options:this.config.options}),this.$emit("close")}}},Gae={class:"slds-grid slds-grid_vertical slds-grid_vertical-align-center slds-grid_align-center"},Wae={key:0},Yae={class:"slds-text-color_weak slds-text-heading_small",style:{"text-align":"center"}},Zae={style:{"white-space":"pre-wrap"}},Xae={class:"slds-grid"},Kae={class:"slds-col_bump-left"};function Jae(e,t,s,n,r,a){const o=pe("Icon"),d=pe("Checkbox"),p=pe("Button"),y=pe("Modal");return L(),Ge(y,{ref:"modal",title:s.config.title,size:"small",detach:"",onClose:t[1]||(t[1]=v=>e.$emit("close"))},{content:je(()=>[k("div",Gae,[s.config.icon?(L(),X("div",Wae,[de(o,{category:s.config.icon.category,name:s.config.icon.name,iconClass:"slds-button__icon",assistiveText:s.config.icon.text,size:s.config.icon.size},null,8,["category","name","assistiveText","size"])])):$e("",!0),k("div",null,[k("div",Yae,[k("span",Zae,Pe(s.config.description),1)]),(L(!0),X(Lt,null,As(s.config.options,v=>(L(),X("div",{key:v.id,class:"slds-m-top_small"},[de(d,{modelValue:v.selected,"onUpdate:modelValue":C=>v.selected=C,labels:{name:v.label}},null,8,["modelValue","onUpdate:modelValue","labels"])]))),128))])])]),footer:je(()=>[k("div",null,[k("div",Xae,[k("div",Kae,[de(p,{class:$t(a.cancelButtonClass),onClick:t[0]||(t[0]=v=>e.$emit("close"))},{default:je(()=>[es(Pe(a.cancelButtonText),1)]),_:1},8,["class"]),de(p,{class:$t(a.confirmButtonClass),onClick:a.confirm},{default:je(()=>[es(Pe(a.confirmButtonText),1)]),_:1},8,["class","onClick"])])])])]),_:1},8,["title"])}const Qae=os(Hae,[["render",Jae]]),ele={name:"FileImport",components:{Icon:yn,ButtonIcon:vn},data(){return{id:Vn(),file:null}},methods:{async onFileChange(e,t=!1){var n;const s=t?e.dataTransfer:e.target;this.file=(n=s==null?void 0:s.files)==null?void 0:n[0],this.$emit("file-change",{file:this.file})}}},tle=["id"],sle=k("abbr",{class:"slds-required",title:"required"},"* ",-1),nle={class:"slds-file-selector slds-file-selector_files",style:{display:"block"}},rle=["id","aria-labelledby"],ile=["id","for"],ole={class:"slds-file-selector__button slds-button slds-button_neutral",style:{width:"100%"}},ale=k("span",{class:"slds-file-selector__text slds-text-color_weak slds-text-align_center slds-m-top_small",style:{display:"block"}},"Or drop file",-1),lle={key:1,class:"slds-input slds-p-horizontal_xx-small slds-file-selector__body slds-grid_align-spread"},cle={class:"slds-file-selector__input slds-truncate"},ule={class:"slds-p-left_xx-small"};function dle(e,t,s,n,r,a){const o=pe("Icon"),d=pe("ButtonIcon");return L(),X("div",null,[k("label",{class:"slds-form-element__label",id:`${r.id}-file-selector-primary-label`},[sle,es("CSV File")],8,tle),k("div",nle,[r.file?(L(),X("label",lle,[k("div",cle,[de(o,{category:"doctype",name:"csv",size:"small",inheritFillFromParent:!1,iconClass:["slds-input__icon","slds-input__icon_left","slds-p-bottom_xx-small"]}),k("span",ule,Pe(r.file.name),1)]),de(d,{iconCategory:"utility",iconName:"clear",variant:"container",size:"small",title:"Remove CSV",assistiveText:"Remove CSV",onClick:t[5]||(t[5]=p=>e.$emit("file-change",{file:r.file=null}))})])):(L(),X("div",{key:0,class:"slds-file-selector__dropzone slds-theme_default",onDragenter:t[1]||(t[1]=Os(()=>{},["prevent","stop"])),onDragover:t[2]||(t[2]=Os(()=>{},["prevent","stop"])),onDragleave:t[3]||(t[3]=Os(()=>{},["prevent","stop"])),onDrop:t[4]||(t[4]=Os(p=>a.onFileChange(p,!0),["prevent","stop"]))},[k("input",{id:`${r.id}-csvFileInput`,type:"file",class:"slds-file-selector__input slds-assistive-text","aria-labelledby":`${r.id}-file-selector-primary-label ${r.id}-file-selector-secondary-label`,onChange:t[0]||(t[0]=(...p)=>a.onFileChange&&a.onFileChange(...p))},null,40,rle),k("label",{id:`${r.id}-file-selector-secondary-label`,class:"slds-file-selector__body slds-p-around_small",style:{display:"block"},for:`${r.id}-csvFileInput`},[k("span",ole,[de(o,{category:"utility",name:"upload",size:"xx-small",class:"slds-current-color",iconClass:["slds-button__icon","slds-button__icon_left"]}),es(" Upload File ")]),ale],8,ile)],32))])])}const hle=os(ele,[["render",dle]]),ple={name:"Tree",components:{ButtonIcon:vn,Checkbox:za},props:{model:Object,root:Object,isChild:Boolean,customNodeTest:Function,marginLines:Boolean,lazy:Boolean,selectable:Boolean,singleSelect:Boolean},emits:["node-click","node-expand-click"],data(){return{isCustomNode:!1}},computed:{rootModel(){return this.root||this.model}},created(){typeof this.customNodeTest=="function"&&(this.isCustomNode=this.customNodeTest(this.model))},methods:{onNodeClick(e){if(this.singleSelect){const t=s=>{s.selected=!1,s.children.forEach(n=>t(n))};t(this.rootModel),e.selected=!0}this.$emit("node-click",e)},onNodeExpandClick(e){this.lazy||(e.expanded=!e.expanded),this.$emit("node-expand-click",e)},async onCheckChange(){await SPM.Utils.Async.wait(1),this.model.selected=this.model.selected==="none"?"all":"none";let e=[...this.model.children];for(;e.length;){const s=[];e.forEach(n=>{n.selected=this.model.selected==="all"?"parent":"none",s.push(...n.children||[])}),e=s}let t=this.model.parent;for(;t;)t.selected=t.children.find(s=>["all","some"].includes(s.selected))?"some":"none",t=t.parent}}},fle=["title"],mle={class:"treeItem"},_le={key:0,class:"treeName slds-grid slds-grid_vertical-align-center"};function gle(e,t,s,n,r,a){const o=pe("ButtonIcon"),d=pe("Checkbox"),p=pe("Tree",!0);return L(),X("div",null,[k("div",{title:s.model.name,class:$t(["treeEntry",{selectable:s.singleSelect,selected:s.model.selected}]),onClick:t[1]||(t[1]=y=>a.onNodeClick(s.model))},[k("div",{class:$t({treeParent:s.isChild,treeTitle:!s.isChild,marginLines:s.marginLines})},[k("div",mle,[r.isCustomNode?$e("",!0):(L(),X("div",_le,[de(o,{iconCategory:"utility",iconName:s.model.loading?"spinner":s.model.expanded?"chevrondown":"chevronright",variant:"container",size:"small",title:s.model.loading?"Loading":s.model.expanded?"Collapse":"Expand",assistiveText:s.model.loading?"Loading":s.model.expanded?"Collapse":"Expand",onClick:t[0]||(t[0]=Os(y=>a.onNodeExpandClick(s.model),["stop"]))},null,8,["iconName","title","assistiveText"]),s.selectable?(L(),Ge(d,{key:0,class:"slds-m-right_x-small",checked:["all","parent"].includes(s.model.selected),indeterminate:s.model.selected==="some",disabled:s.model.selected==="parent",onClick:Os(a.onCheckChange,["prevent"])},null,8,["checked","indeterminate","disabled","onClick"])):$e("",!0),k("label",null,Pe(s.model.name),1)])),r.isCustomNode?js(e.$slots,"customNodeContent",{key:1,model:s.model},()=>[es(" Missing definition for customNodeContent slot ")],!0):$e("",!0)])],2)],10,fle),s.model.expanded?(L(),X("div",{key:0,class:$t(["treeMargin",{marginLines:s.marginLines}])},[(L(!0),X(Lt,null,As(s.model.children,y=>(L(),Ge(p,{key:y.id,model:y,root:a.rootModel,isChild:!0,marginLines:s.marginLines,singleSelect:s.singleSelect,customNodeTest:s.customNodeTest},{customNodeContent:je(v=>[js(e.$slots,"customNodeContent",{model:v.model},void 0,!0)]),_:2},1032,["model","root","marginLines","singleSelect","customNodeTest"]))),128))],2)):$e("",!0)])}const yle=os(ple,[["render",gle],["__scopeId","data-v-02f9aca2"]]);var D$={exports:{}};/* @license
Papa Parse
v5.4.0
https://github.com/mholt/PapaParse
License: MIT
*/(function(e,t){(function(s,n){e.exports=n()})(Qu,function s(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},r=!n.document&&!!n.postMessage,a=n.IS_PAPA_WORKER||!1,o={},d=0,p={parse:function(ee,ne){var Se=(ne=ne||{}).dynamicTyping||!1;if(ve(Se)&&(ne.dynamicTypingFunction=Se,Se={}),ne.dynamicTyping=Se,ne.transform=!!ve(ne.transform)&&ne.transform,ne.worker&&p.WORKERS_SUPPORTED){var Ue=function(){if(!p.WORKERS_SUPPORTED)return!1;var Me=(Ut=n.URL||n.webkitURL||null,Rt=s.toString(),p.BLOB_URL||(p.BLOB_URL=Ut.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",Rt,")();"],{type:"text/javascript"})))),vt=new n.Worker(Me),Ut,Rt;return vt.onmessage=re,vt.id=d++,o[vt.id]=vt}();return Ue.userStep=ne.step,Ue.userChunk=ne.chunk,Ue.userComplete=ne.complete,Ue.userError=ne.error,ne.step=ve(ne.step),ne.chunk=ve(ne.chunk),ne.complete=ve(ne.complete),ne.error=ve(ne.error),delete ne.worker,void Ue.postMessage({input:ee,config:ne,workerId:Ue.id})}var Qe=null;return p.NODE_STREAM_INPUT,typeof ee=="string"?(ee=function(Me){return Me.charCodeAt(0)===65279?Me.slice(1):Me}(ee),Qe=ne.download?new C(ne):new O(ne)):ee.readable===!0&&ve(ee.read)&&ve(ee.on)?Qe=new A(ne):(n.File&&ee instanceof File||ee instanceof Object)&&(Qe=new I(ne)),Qe.stream(ee)},unparse:function(ee,ne){var Se=!1,Ue=!0,Qe=",",Me=`\r
`,vt='"',Ut=vt+vt,Rt=!1,_t=null,F=!1;(function(){if(typeof ne=="object"){if(typeof ne.delimiter!="string"||p.BAD_DELIMITERS.filter(function(J){return ne.delimiter.indexOf(J)!==-1}).length||(Qe=ne.delimiter),(typeof ne.quotes=="boolean"||typeof ne.quotes=="function"||Array.isArray(ne.quotes))&&(Se=ne.quotes),typeof ne.skipEmptyLines!="boolean"&&typeof ne.skipEmptyLines!="string"||(Rt=ne.skipEmptyLines),typeof ne.newline=="string"&&(Me=ne.newline),typeof ne.quoteChar=="string"&&(vt=ne.quoteChar),typeof ne.header=="boolean"&&(Ue=ne.header),Array.isArray(ne.columns)){if(ne.columns.length===0)throw new Error("Option columns is empty");_t=ne.columns}ne.escapeChar!==void 0&&(Ut=ne.escapeChar+vt),(typeof ne.escapeFormulae=="boolean"||ne.escapeFormulae instanceof RegExp)&&(F=ne.escapeFormulae instanceof RegExp?ne.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var j=new RegExp(q(vt),"g");if(typeof ee=="string"&&(ee=JSON.parse(ee)),Array.isArray(ee)){if(!ee.length||Array.isArray(ee[0]))return G(null,ee,Rt);if(typeof ee[0]=="object")return G(_t||Object.keys(ee[0]),ee,Rt)}else if(typeof ee=="object")return typeof ee.data=="string"&&(ee.data=JSON.parse(ee.data)),Array.isArray(ee.data)&&(ee.fields||(ee.fields=ee.meta&&ee.meta.fields||_t),ee.fields||(ee.fields=Array.isArray(ee.data[0])?ee.fields:typeof ee.data[0]=="object"?Object.keys(ee.data[0]):[]),Array.isArray(ee.data[0])||typeof ee.data[0]=="object"||(ee.data=[ee.data])),G(ee.fields||[],ee.data||[],Rt);throw new Error("Unable to serialize unrecognized input");function G(J,he,be){var Ne="";typeof J=="string"&&(J=JSON.parse(J)),typeof he=="string"&&(he=JSON.parse(he));var ke=Array.isArray(J)&&0<J.length,qe=!Array.isArray(he[0]);if(ke&&Ue){for(var ct=0;ct<J.length;ct++)0<ct&&(Ne+=Qe),Ne+=Y(J[ct],ct);0<he.length&&(Ne+=Me)}for(var We=0;We<he.length;We++){var ht=ke?J.length:he[We].length,rt=!1,fe=ke?Object.keys(he[We]).length===0:he[We].length===0;if(be&&!ke&&(rt=be==="greedy"?he[We].join("").trim()==="":he[We].length===1&&he[We][0].length===0),be==="greedy"&&ke){for(var ye=[],Je=0;Je<ht;Je++){var at=qe?J[Je]:Je;ye.push(he[We][at])}rt=ye.join("").trim()===""}if(!rt){for(var it=0;it<ht;it++){0<it&&!fe&&(Ne+=Qe);var Et=ke&&qe?J[it]:it;Ne+=Y(he[We][Et],it)}We<he.length-1&&(!be||0<ht&&!fe)&&(Ne+=Me)}}return Ne}function Y(J,he){if(J==null)return"";if(J.constructor===Date)return JSON.stringify(J).slice(1,25);var be=!1;F&&typeof J=="string"&&F.test(J)&&(J="'"+J,be=!0);var Ne=J.toString().replace(j,Ut);return(be=be||Se===!0||typeof Se=="function"&&Se(J,he)||Array.isArray(Se)&&Se[he]||function(ke,qe){for(var ct=0;ct<qe.length;ct++)if(-1<ke.indexOf(qe[ct]))return!0;return!1}(Ne,p.BAD_DELIMITERS)||-1<Ne.indexOf(Qe)||Ne.charAt(0)===" "||Ne.charAt(Ne.length-1)===" ")?vt+Ne+vt:Ne}}};if(p.RECORD_SEP=String.fromCharCode(30),p.UNIT_SEP=String.fromCharCode(31),p.BYTE_ORDER_MARK="\uFEFF",p.BAD_DELIMITERS=["\r",`
`,'"',p.BYTE_ORDER_MARK],p.WORKERS_SUPPORTED=!r&&!!n.Worker,p.NODE_STREAM_INPUT=1,p.LocalChunkSize=10485760,p.RemoteChunkSize=5242880,p.DefaultDelimiter=",",p.Parser=ce,p.ParserHandle=P,p.NetworkStreamer=C,p.FileStreamer=I,p.StringStreamer=O,p.ReadableStreamStreamer=A,n.jQuery){var y=n.jQuery;y.fn.parse=function(ee){var ne=ee.config||{},Se=[];return this.each(function(Me){if(!(y(this).prop("tagName").toUpperCase()==="INPUT"&&y(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var vt=0;vt<this.files.length;vt++)Se.push({file:this.files[vt],inputElem:this,instanceConfig:y.extend({},ne)})}),Ue(),this;function Ue(){if(Se.length!==0){var Me,vt,Ut,Rt,_t=Se[0];if(ve(ee.before)){var F=ee.before(_t.file,_t.inputElem);if(typeof F=="object"){if(F.action==="abort")return Me="AbortError",vt=_t.file,Ut=_t.inputElem,Rt=F.reason,void(ve(ee.error)&&ee.error({name:Me},vt,Ut,Rt));if(F.action==="skip")return void Qe();typeof F.config=="object"&&(_t.instanceConfig=y.extend(_t.instanceConfig,F.config))}else if(F==="skip")return void Qe()}var j=_t.instanceConfig.complete;_t.instanceConfig.complete=function(G){ve(j)&&j(G,_t.file,_t.inputElem),Qe()},p.parse(_t.file,_t.instanceConfig)}else ve(ee.complete)&&ee.complete()}function Qe(){Se.splice(0,1),Ue()}}}function v(ee){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(ne){var Se=te(ne);Se.chunkSize=parseInt(Se.chunkSize),ne.step||ne.chunk||(Se.chunkSize=null),this._handle=new P(Se),(this._handle.streamer=this)._config=Se}.call(this,ee),this.parseChunk=function(ne,Se){if(this.isFirstChunk&&ve(this._config.beforeFirstChunk)){var Ue=this._config.beforeFirstChunk(ne);Ue!==void 0&&(ne=Ue)}this.isFirstChunk=!1,this._halted=!1;var Qe=this._partialLine+ne;this._partialLine="";var Me=this._handle.parse(Qe,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var vt=Me.meta.cursor;this._finished||(this._partialLine=Qe.substring(vt-this._baseIndex),this._baseIndex=vt),Me&&Me.data&&(this._rowCount+=Me.data.length);var Ut=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(a)n.postMessage({results:Me,workerId:p.WORKER_ID,finished:Ut});else if(ve(this._config.chunk)&&!Se){if(this._config.chunk(Me,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);Me=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(Me.data),this._completeResults.errors=this._completeResults.errors.concat(Me.errors),this._completeResults.meta=Me.meta),this._completed||!Ut||!ve(this._config.complete)||Me&&Me.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),Ut||Me&&Me.meta.paused||this._nextChunk(),Me}this._halted=!0},this._sendError=function(ne){ve(this._config.error)?this._config.error(ne):a&&this._config.error&&n.postMessage({workerId:p.WORKER_ID,error:ne,finished:!1})}}function C(ee){var ne;(ee=ee||{}).chunkSize||(ee.chunkSize=p.RemoteChunkSize),v.call(this,ee),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(Se){this._input=Se,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(ne=new XMLHttpRequest,this._config.withCredentials&&(ne.withCredentials=this._config.withCredentials),r||(ne.onload=oe(this._chunkLoaded,this),ne.onerror=oe(this._chunkError,this)),ne.open(this._config.downloadRequestBody?"POST":"GET",this._input,!r),this._config.downloadRequestHeaders){var Se=this._config.downloadRequestHeaders;for(var Ue in Se)ne.setRequestHeader(Ue,Se[Ue])}if(this._config.chunkSize){var Qe=this._start+this._config.chunkSize-1;ne.setRequestHeader("Range","bytes="+this._start+"-"+Qe)}try{ne.send(this._config.downloadRequestBody)}catch(Me){this._chunkError(Me.message)}r&&ne.status===0&&this._chunkError()}},this._chunkLoaded=function(){ne.readyState===4&&(ne.status<200||400<=ne.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:ne.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(Se){var Ue=Se.getResponseHeader("Content-Range");return Ue===null?-1:parseInt(Ue.substring(Ue.lastIndexOf("/")+1))}(ne),this.parseChunk(ne.responseText)))},this._chunkError=function(Se){var Ue=ne.statusText||Se;this._sendError(new Error(Ue))}}function I(ee){var ne,Se;(ee=ee||{}).chunkSize||(ee.chunkSize=p.LocalChunkSize),v.call(this,ee);var Ue=typeof FileReader<"u";this.stream=function(Qe){this._input=Qe,Se=Qe.slice||Qe.webkitSlice||Qe.mozSlice,Ue?((ne=new FileReader).onload=oe(this._chunkLoaded,this),ne.onerror=oe(this._chunkError,this)):ne=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var Qe=this._input;if(this._config.chunkSize){var Me=Math.min(this._start+this._config.chunkSize,this._input.size);Qe=Se.call(Qe,this._start,Me)}var vt=ne.readAsText(Qe,this._config.encoding);Ue||this._chunkLoaded({target:{result:vt}})},this._chunkLoaded=function(Qe){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(Qe.target.result)},this._chunkError=function(){this._sendError(ne.error)}}function O(ee){var ne;v.call(this,ee=ee||{}),this.stream=function(Se){return ne=Se,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var Se,Ue=this._config.chunkSize;return Ue?(Se=ne.substring(0,Ue),ne=ne.substring(Ue)):(Se=ne,ne=""),this._finished=!ne,this.parseChunk(Se)}}}function A(ee){v.call(this,ee=ee||{});var ne=[],Se=!0,Ue=!1;this.pause=function(){v.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){v.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(Qe){this._input=Qe,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){Ue&&ne.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),ne.length?this.parseChunk(ne.shift()):Se=!0},this._streamData=oe(function(Qe){try{ne.push(typeof Qe=="string"?Qe:Qe.toString(this._config.encoding)),Se&&(Se=!1,this._checkIsFinished(),this.parseChunk(ne.shift()))}catch(Me){this._streamError(Me)}},this),this._streamError=oe(function(Qe){this._streamCleanUp(),this._sendError(Qe)},this),this._streamEnd=oe(function(){this._streamCleanUp(),Ue=!0,this._streamData("")},this),this._streamCleanUp=oe(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function P(ee){var ne,Se,Ue,Qe=Math.pow(2,53),Me=-Qe,vt=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,Ut=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,Rt=this,_t=0,F=0,j=!1,G=!1,Y=[],J={data:[],errors:[],meta:{}};if(ve(ee.step)){var he=ee.step;ee.step=function(We){if(J=We,ke())Ne();else{if(Ne(),J.data.length===0)return;_t+=We.data.length,ee.preview&&_t>ee.preview?Se.abort():(J.data=J.data[0],he(J,Rt))}}}function be(We){return ee.skipEmptyLines==="greedy"?We.join("").trim()==="":We.length===1&&We[0].length===0}function Ne(){return J&&Ue&&(ct("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+p.DefaultDelimiter+"'"),Ue=!1),ee.skipEmptyLines&&(J.data=J.data.filter(function(We){return!be(We)})),ke()&&function(){if(!J)return;function We(rt,fe){ve(ee.transformHeader)&&(rt=ee.transformHeader(rt,fe)),Y.push(rt)}if(Array.isArray(J.data[0])){for(var ht=0;ke()&&ht<J.data.length;ht++)J.data[ht].forEach(We);J.data.splice(0,1)}else J.data.forEach(We)}(),function(){if(!J||!ee.header&&!ee.dynamicTyping&&!ee.transform)return J;function We(rt,fe){var ye,Je=ee.header?{}:[];for(ye=0;ye<rt.length;ye++){var at=ye,it=rt[ye];ee.header&&(at=ye>=Y.length?"__parsed_extra":Y[ye]),ee.transform&&(it=ee.transform(it,at)),it=qe(at,it),at==="__parsed_extra"?(Je[at]=Je[at]||[],Je[at].push(it)):Je[at]=it}return ee.header&&(ye>Y.length?ct("FieldMismatch","TooManyFields","Too many fields: expected "+Y.length+" fields but parsed "+ye,F+fe):ye<Y.length&&ct("FieldMismatch","TooFewFields","Too few fields: expected "+Y.length+" fields but parsed "+ye,F+fe)),Je}var ht=1;return!J.data.length||Array.isArray(J.data[0])?(J.data=J.data.map(We),ht=J.data.length):J.data=We(J.data,0),ee.header&&J.meta&&(J.meta.fields=Y),F+=ht,J}()}function ke(){return ee.header&&Y.length===0}function qe(We,ht){return rt=We,ee.dynamicTypingFunction&&ee.dynamicTyping[rt]===void 0&&(ee.dynamicTyping[rt]=ee.dynamicTypingFunction(rt)),(ee.dynamicTyping[rt]||ee.dynamicTyping)===!0?ht==="true"||ht==="TRUE"||ht!=="false"&&ht!=="FALSE"&&(function(fe){if(vt.test(fe)){var ye=parseFloat(fe);if(Me<ye&&ye<Qe)return!0}return!1}(ht)?parseFloat(ht):Ut.test(ht)?new Date(ht):ht===""?null:ht):ht;var rt}function ct(We,ht,rt,fe){var ye={type:We,code:ht,message:rt};fe!==void 0&&(ye.row=fe),J.errors.push(ye)}this.parse=function(We,ht,rt){var fe=ee.quoteChar||'"';if(ee.newline||(ee.newline=function(at,it){at=at.substring(0,1048576);var Et=new RegExp(q(it)+"([^]*?)"+q(it),"gm"),jt=(at=at.replace(Et,"")).split("\r"),Nt=at.split(`
`),St=1<Nt.length&&Nt[0].length<jt[0].length;if(jt.length===1||St)return`
`;for(var Ct=0,Bt=0;Bt<jt.length;Bt++)jt[Bt][0]===`
`&&Ct++;return Ct>=jt.length/2?`\r
`:"\r"}(We,fe)),Ue=!1,ee.delimiter)ve(ee.delimiter)&&(ee.delimiter=ee.delimiter(We),J.meta.delimiter=ee.delimiter);else{var ye=function(at,it,Et,jt,Nt){var St,Ct,Bt,Kt;Nt=Nt||[",","	","|",";",p.RECORD_SEP,p.UNIT_SEP];for(var ys=0;ys<Nt.length;ys++){var ts=Nt[ys],Us=0,ue=0,B=0;Bt=void 0;for(var U=new ce({comments:jt,delimiter:ts,newline:it,preview:10}).parse(at),Re=0;Re<U.data.length;Re++)if(Et&&be(U.data[Re]))B++;else{var nt=U.data[Re].length;ue+=nt,Bt!==void 0?0<nt&&(Us+=Math.abs(nt-Bt),Bt=nt):Bt=nt}0<U.data.length&&(ue/=U.data.length-B),(Ct===void 0||Us<=Ct)&&(Kt===void 0||Kt<ue)&&1.99<ue&&(Ct=Us,St=ts,Kt=ue)}return{successful:!!(ee.delimiter=St),bestDelimiter:St}}(We,ee.newline,ee.skipEmptyLines,ee.comments,ee.delimitersToGuess);ye.successful?ee.delimiter=ye.bestDelimiter:(Ue=!0,ee.delimiter=p.DefaultDelimiter),J.meta.delimiter=ee.delimiter}var Je=te(ee);return ee.preview&&ee.header&&Je.preview++,ne=We,Se=new ce(Je),J=Se.parse(ne,ht,rt),Ne(),j?{meta:{paused:!0}}:J||{meta:{paused:!1}}},this.paused=function(){return j},this.pause=function(){j=!0,Se.abort(),ne=ve(ee.chunk)?"":ne.substring(Se.getCharIndex())},this.resume=function(){Rt.streamer._halted?(j=!1,Rt.streamer.parseChunk(ne,!0)):setTimeout(Rt.resume,3)},this.aborted=function(){return G},this.abort=function(){G=!0,Se.abort(),J.meta.aborted=!0,ve(ee.complete)&&ee.complete(J),ne=""}}function q(ee){return ee.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ce(ee){var ne,Se=(ee=ee||{}).delimiter,Ue=ee.newline,Qe=ee.comments,Me=ee.step,vt=ee.preview,Ut=ee.fastMode,Rt=ne=ee.quoteChar===void 0||ee.quoteChar===null?'"':ee.quoteChar;if(ee.escapeChar!==void 0&&(Rt=ee.escapeChar),(typeof Se!="string"||-1<p.BAD_DELIMITERS.indexOf(Se))&&(Se=","),Qe===Se)throw new Error("Comment character same as delimiter");Qe===!0?Qe="#":(typeof Qe!="string"||-1<p.BAD_DELIMITERS.indexOf(Qe))&&(Qe=!1),Ue!==`
`&&Ue!=="\r"&&Ue!==`\r
`&&(Ue=`
`);var _t=0,F=!1;this.parse=function(j,G,Y){if(typeof j!="string")throw new Error("Input must be a string");var J=j.length,he=Se.length,be=Ue.length,Ne=Qe.length,ke=ve(Me),qe=[],ct=[],We=[],ht=_t=0;if(!j)return gt();if(ee.header){var rt=j.split(Ue)[0].split(Se),fe=[],ye={},Je=!1;for(var at in rt){var it=rt[at];ve(ee.transformHeader)&&(it=ee.transformHeader(it,at));var Et=it,jt=ye[it]||0;0<jt&&(Je=!0,Et=it+"_"+jt),ye[it]=jt+1,fe.push(Et)}if(Je){var Nt=j.split(Ue);Nt[0]=fe.join(Se),j=Nt.join(Ue)}}if(Ut||Ut!==!1&&j.indexOf(ne)===-1){for(var St=j.split(Ue),Ct=0;Ct<St.length;Ct++){if(We=St[Ct],_t+=We.length,Ct!==St.length-1)_t+=Ue.length;else if(Y)return gt();if(!Qe||We.substring(0,Ne)!==Qe){if(ke){if(qe=[],B(We.split(Se)),kt(),F)return gt()}else B(We.split(Se));if(vt&&vt<=Ct)return qe=qe.slice(0,vt),gt(!0)}}return gt()}for(var Bt=j.indexOf(Se,_t),Kt=j.indexOf(Ue,_t),ys=new RegExp(q(Rt)+q(ne),"g"),ts=j.indexOf(ne,_t);;)if(j[_t]!==ne)if(Qe&&We.length===0&&j.substring(_t,_t+Ne)===Qe){if(Kt===-1)return gt();_t=Kt+be,Kt=j.indexOf(Ue,_t),Bt=j.indexOf(Se,_t)}else if(Bt!==-1&&(Bt<Kt||Kt===-1))We.push(j.substring(_t,Bt)),_t=Bt+he,Bt=j.indexOf(Se,_t);else{if(Kt===-1)break;if(We.push(j.substring(_t,Kt)),nt(Kt+be),ke&&(kt(),F))return gt();if(vt&&qe.length>=vt)return gt(!0)}else for(ts=_t,_t++;;){if((ts=j.indexOf(ne,ts+1))===-1)return Y||ct.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:qe.length,index:_t}),Re();if(ts===J-1)return Re(j.substring(_t,ts).replace(ys,ne));if(ne!==Rt||j[ts+1]!==Rt){if(ne===Rt||ts===0||j[ts-1]!==Rt){Bt!==-1&&Bt<ts+1&&(Bt=j.indexOf(Se,ts+1)),Kt!==-1&&Kt<ts+1&&(Kt=j.indexOf(Ue,ts+1));var Us=U(Kt===-1?Bt:Math.min(Bt,Kt));if(j.substr(ts+1+Us,he)===Se){We.push(j.substring(_t,ts).replace(ys,ne)),j[_t=ts+1+Us+he]!==ne&&(ts=j.indexOf(ne,_t)),Bt=j.indexOf(Se,_t),Kt=j.indexOf(Ue,_t);break}var ue=U(Kt);if(j.substring(ts+1+ue,ts+1+ue+be)===Ue){if(We.push(j.substring(_t,ts).replace(ys,ne)),nt(ts+1+ue+be),Bt=j.indexOf(Se,_t),ts=j.indexOf(ne,_t),ke&&(kt(),F))return gt();if(vt&&qe.length>=vt)return gt(!0);break}ct.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:qe.length,index:_t}),ts++}}else ts++}return Re();function B(Ds){qe.push(Ds),ht=_t}function U(Ds){var tn=0;if(Ds!==-1){var nn=j.substring(ts+1,Ds);nn&&nn.trim()===""&&(tn=nn.length)}return tn}function Re(Ds){return Y||(Ds===void 0&&(Ds=j.substring(_t)),We.push(Ds),_t=J,B(We),ke&&kt()),gt()}function nt(Ds){_t=Ds,B(We),We=[],Kt=j.indexOf(Ue,_t)}function gt(Ds){return{data:qe,errors:ct,meta:{delimiter:Se,linebreak:Ue,aborted:F,truncated:!!Ds,cursor:ht+(G||0)}}}function kt(){Me(gt()),qe=[],ct=[]}},this.abort=function(){F=!0},this.getCharIndex=function(){return _t}}function re(ee){var ne=ee.data,Se=o[ne.workerId],Ue=!1;if(ne.error)Se.userError(ne.error,ne.file);else if(ne.results&&ne.results.data){var Qe={abort:function(){Ue=!0,W(ne.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:Ce,resume:Ce};if(ve(Se.userStep)){for(var Me=0;Me<ne.results.data.length&&(Se.userStep({data:ne.results.data[Me],errors:ne.results.errors,meta:ne.results.meta},Qe),!Ue);Me++);delete ne.results}else ve(Se.userChunk)&&(Se.userChunk(ne.results,Qe,ne.file),delete ne.results)}ne.finished&&!Ue&&W(ne.workerId,ne.results)}function W(ee,ne){var Se=o[ee];ve(Se.userComplete)&&Se.userComplete(ne),Se.terminate(),delete o[ee]}function Ce(){throw new Error("Not implemented.")}function te(ee){if(typeof ee!="object"||ee===null)return ee;var ne=Array.isArray(ee)?[]:{};for(var Se in ee)ne[Se]=te(ee[Se]);return ne}function oe(ee,ne){return function(){ee.apply(ne,arguments)}}function ve(ee){return typeof ee=="function"}return a&&(n.onmessage=function(ee){var ne=ee.data;if(p.WORKER_ID===void 0&&ne&&(p.WORKER_ID=ne.workerId),typeof ne.input=="string")n.postMessage({workerId:p.WORKER_ID,results:p.parse(ne.input,ne.config),finished:!0});else if(n.File&&ne.input instanceof File||ne.input instanceof Object){var Se=p.parse(ne.input,ne.config);Se&&n.postMessage({workerId:p.WORKER_ID,results:Se,finished:!0})}}),(C.prototype=Object.create(v.prototype)).constructor=C,(I.prototype=Object.create(v.prototype)).constructor=I,(O.prototype=Object.create(O.prototype)).constructor=O,(A.prototype=Object.create(v.prototype)).constructor=A,p})})(D$);const vle=D$.exports,ble={name:"ImportHierarchyModal",components:{Icon:yn,SLDSButton:Tn,Picklist:Qi,Modal:zc,Spinner:Vr,FileImport:hle,Tree:yle},props:["config"],emits:["close"],data(){return{rows:[],columns:[],nodeColumn:null,parentColumn:null,rootNodeId:this.config.node.id,previewHierarchy:null,previewMsg:"",loading:!1}},watch:{nodeColumn(){this.generatePreview()},parentColumn(){this.generatePreview()},"config.node":{handler(){this.generatePreview()}}},mounted(){SPM.Components.ImportHierarchyModal=this},methods:{onFileChange({file:e}){if(!e){this.columns=[],this.rows=[],this.nodeColumn=null,this.parentColumn=null;return}vle.parse(e,{header:!0,skipEmptyLines:!0,complete:t=>{this.columns=t.meta.fields,this.rows=t.data,this.nodeColumn=this.columns.find(s=>s.toLowerCase().includes("name"))||null,this.parentColumn=this.columns.find(s=>s.toLowerCase().includes("parent"))||null}})},generatePreview(){var s,n,r,a;if(!this.rows.length||!this.nodeColumn||!this.parentColumn||!this.config.node){this.previewHierarchy=null,this.previewMsg="";return}const e={};this.rows.forEach(o=>{const d=o[this.nodeColumn],p=o[this.parentColumn]||"";e[d]=e[d]||{id:d,name:d,expanded:!1,children:[]},e[p]=e[p]||{id:p,name:p,expanded:!1,children:[]},e[p].children.push(e[d])});const t=this.$store.allNodes.find(o=>o.id===this.rootNodeId);if(!((n=(s=e==null?void 0:e[t.name])==null?void 0:s.children)!=null&&n.length))return this.previewMsg=`Please add at least one item with a parent of ${t.name} representing the root node of the hierarchy.`;(r=t.children)==null||r.forEach(o=>{var d;o.expanded=!0,(d=o.children)==null||d.forEach(p=>p.expanded=!0)}),this.previewHierarchy={id:this.config.node.id,name:this.config.node.name,expanded:!0,children:((a=e[t.name])==null?void 0:a.children)||[]}},async importHierarchy(){try{this.loading=!0,await SPM.Utils.Node.importHierarchy({hierarchy:this.previewHierarchy}),this.$store.toast({message:"Hierarchy was imported.",duration:2500,state:"success"})}catch{this.$store.toast({message:`Can't import hierarchy. Try again."`,duration:null,state:"error"})}finally{this.loading=!1,this.$emit("close")}}}},EI=e=>(Nr("data-v-49825281"),e=e(),Dr(),e),xle={class:"slds-scoped-notification slds-media slds-media_center slds-p-vertical_large",style:{background:"#E5E5E5"},role:"status"},wle=EI(()=>k("p",null,"New hierarchy nodes appear empty.",-1)),Sle={class:"slds-grid",style:{height:"25rem"}},Cle={class:"slds-col slds-size_1-of-2 slds-p-around_medium slds-is-relative"},Ile=EI(()=>k("div",{id:"preview-arrow"},null,-1)),Tle={class:"slds-col slds-size_1-of-2 slds-theme_shade slds-p-around_medium slds-border_left",style:{"border-width":"2px"}},Ale=EI(()=>k("div",{class:"slds-text-body_regular slds-m-bottom_x-small"},[k("b",null,"Preview")],-1)),Mle={class:"spm-box",style:{"max-height":"20rem",overflow:"auto"}},Ele={key:1,class:"slds-grid slds-grid_vertical slds-align_absolute-center slds-text-heading_small slds-p-around_large"},kle={class:"slds-grid"},Ple={class:"slds-col_bump-left"};function Rle(e,t,s,n,r,a){const o=pe("Spinner"),d=pe("Icon"),p=pe("FileImport"),y=pe("Picklist"),v=pe("Tree"),C=pe("SLDSButton"),I=pe("Modal");return L(),Ge(I,{id:"import-hierarchy-modal",ref:"modal",title:"Import Hierarchy",size:"small",detach:"",onClose:t[6]||(t[6]=O=>e.$emit("close"))},{content:je(()=>[r.loading?(L(),Ge(o,{key:0},{description:je(()=>[es("Importing Hierarchy...")]),_:1})):$e("",!0),k("div",xle,[de(d,{category:"utility",name:"info",iconClass:["slds-icon","slds-icon--small","slds-m-right--small","slds-col","slds-no-flex","slds-icon-text-default"]}),wle]),k("div",Sle,[k("div",Cle,[Ile,de(p,{onFileChange:a.onFileChange},null,8,["onFileChange"]),r.columns.length?(L(),X(Lt,{key:0},[de(y,{modelValue:r.nodeColumn,"onUpdate:modelValue":t[0]||(t[0]=O=>r.nodeColumn=O),class:"slds-m-bottom_x-small",labels:{name:"Node Column"},options:r.columns},null,8,["modelValue","options"]),de(y,{modelValue:r.parentColumn,"onUpdate:modelValue":t[1]||(t[1]=O=>r.parentColumn=O),class:"slds-m-bottom_x-small",labels:{name:"Parent Column"},options:r.columns},null,8,["modelValue","options"]),de(y,{modelValue:r.rootNodeId,"onUpdate:modelValue":t[2]||(t[2]=O=>r.rootNodeId=O),class:"slds-m-bottom_x-small",filterable:"",labels:{name:"Select root node to attach to"},idKey:"id",titleKey:"name",options:e.$store.allNodes,onSelectedOption:t[3]||(t[3]=O=>s.config.node=O),onClear:t[4]||(t[4]=O=>s.config.node=null)},null,8,["modelValue","options"])],64)):$e("",!0)]),k("div",Tle,[Ale,k("div",Mle,[r.previewHierarchy?(L(),Ge(v,{key:0,model:r.previewHierarchy},null,8,["model"])):(L(),X("div",Ele,Pe(r.previewMsg||"Please complete the import form"),1))])])])]),footer:je(()=>[k("div",null,[k("div",kle,[k("div",Ple,[de(C,{class:"slds-button slds-button_neutral",onClick:t[5]||(t[5]=O=>e.$emit("close"))},{default:je(()=>[es("Cancel")]),_:1}),de(C,{class:"slds-button slds-button_brand",disabled:!r.previewHierarchy||r.loading,onClick:a.importHierarchy},{default:je(()=>[es("Import")]),_:1},8,["disabled","onClick"])])])])]),_:1},512)}const $le=os(ble,[["render",Rle],["__scopeId","data-v-49825281"]]),Ole={name:"Overview",components:{SLDSButton:Tn,Card:Xp,Icon:yn},props:["users","availableAdminIds","availableManagerIds","availableStandardIds"],emits:["change-page"],computed:{numAdmin(){return this.availableAdminIds.size},numManager(){return this.users.filter(e=>this.availableManagerIds.has(e.id)&&!this.availableAdminIds.has(e.id)).length},numStandard(){return this.users.filter(e=>this.availableStandardIds.has(e.id)&&!this.availableManagerIds.has(e.id)&&!this.availableAdminIds.has(e.id)).length}}},Lle=e=>(Nr("data-v-8e90a63b"),e=e(),Dr(),e),Nle={id:"share-plan-overview",class:"slds-grid slds-grid_vertical"},Dle={class:"slds-p-horizontal_medium slds-p-vertical_large"},Ble=Lle(()=>k("div",null,"Shared With",-1)),Fle={id:"adminUsers",class:"slds-grid slds-grid_vertical slds-border_bottom"},zle={class:"slds-col slds-grid slds-grid_vertical-align-center slds-p-around_small"},Ule={class:"avatar slds-grid slds-grid_vertical-align-center slds-grid_align-center slds-m-right_medium"},Vle={class:"slds-grid slds-grid_vertical"},jle={id:"managerUsers",class:"slds-grid slds-grid_vertical slds-border_bottom"},qle={class:"slds-col slds-grid slds-grid_vertical-align-center slds-p-around_small"},Hle={class:"avatar slds-grid slds-grid_vertical-align-center slds-grid_align-center slds-m-right_medium"},Gle={class:"slds-grid slds-grid_vertical"},Wle={id:"standardUsers",class:"slds-grid slds-grid_vertical"},Yle={class:"slds-col slds-grid slds-grid_vertical-align-center slds-p-around_small"},Zle={class:"avatar slds-grid slds-grid_vertical-align-center slds-grid_align-center slds-m-right_medium"},Xle={class:"slds-grid slds-grid_vertical"};function Kle(e,t,s,n,r,a){const o=pe("Icon"),d=pe("SLDSButton"),p=pe("Card");return L(),X("div",Nle,[k("div",Dle,[Ble,de(p,null,{body:je(()=>[k("div",Fle,[k("div",zle,[k("div",Ule,[de(o,{category:"standard",name:"user_role",assistiveText:"User Role Icon"})]),k("div",Vle,"Sales Planning Admins ("+Pe(a.numAdmin)+")",1)])]),k("div",jle,[k("div",qle,[k("div",Hle,[de(o,{category:"standard",name:"omni_supervisor",assistiveText:"Omni Supervisor Icon"})]),k("div",Gle,"Sales Plan Managers ("+Pe(a.numManager)+")",1),de(d,{id:"share-plan-overview-navigate-manager",class:"slds-col_bump-left",variant:"base",label:"Manage",onClick:t[0]||(t[0]=y=>e.$emit("change-page","ManagerUsers"))})])]),k("div",Wle,[k("div",Yle,[k("div",Zle,[de(o,{category:"standard",name:"user",assistiveText:"User Icon"})]),k("div",Xle,"Sales Plan Contributors ("+Pe(a.numStandard)+")",1),de(d,{id:"share-plan-overview-navigate-standard",class:"slds-col_bump-left",variant:"base",label:"Manage",onClick:t[1]||(t[1]=y=>e.$emit("change-page","StandardUsers"))})])])]),_:1})])])}const Jle=os(Ole,[["render",Kle],["__scopeId","data-v-8e90a63b"]]),Qle={name:"ConfirmSelfRemoval",components:{Button:Tn,Popover:Uc},emits:["close","confirm"],props:["bindTo"],methods:{onConfirm(){this.$emit("confirm"),this.$emit("close")}}},ece=k("div",{class:"slds-grid slds-p-vertical_large"},[k("span",{id:"share-plan-confirm-removal-text"},"Removing yourself from this plan prevents you from accessing any of its details.")],-1),tce={class:"slds-grid slds-grid_vertical-align-center"};function sce(e,t,s,n,r,a){const o=pe("Button"),d=pe("Popover");return L(),Ge(d,{id:"share-plan-confirm-removal-popover",width:"x-large",bindTo:e.$props.bindTo,alignment:"left",position:"fixed",closeOnClickOutside:"",onClose:t[1]||(t[1]=p=>e.$emit("close"))},{header:je(()=>[es("Remove Yourself?")]),content:je(()=>[ece]),footer:je(()=>[k("div",tce,[de(o,{class:"slds-col_bump-left",variant:"neutral",label:"Cancel",onClick:t[0]||(t[0]=p=>e.$emit("close"))}),de(o,{id:"share-plan-confirm-removal-accept",class:"slds-col_bump-left",variant:"brand",label:"Remove",onClick:a.onConfirm},null,8,["onClick"])])]),_:1},8,["bindTo"])}const B$=os(Qle,[["render",sce]]),nce={name:"ShareEmptyState"},rce={class:"slds-illustration__svg",viewBox:"0 0 468 194","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg"},ice=ex('<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g transform="translate(-67.000000, -112.000000)"><g><g transform="translate(245.000000, 200.000000)" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3"><path vector-effect="non-scaling-stroke" d="M44,17.5 L63,17.5 C62.2789714,12.0723971 64.081543,7.53186978 68.4077148,3.87841797 C73.3754883,-0.195556641 79.2734375,0.717773438 82.440918,2.12353516 C85.6083984,3.52929687 87.9606934,5.46069336 89.5913086,9.10524041 C90.2822266,10.6397351 90.7517904,11.9379883 91,13"></path><path vector-effect="non-scaling-stroke" d="M83,20.5 C84.0558268,16.8461914 86.2227376,14.4572754 89.5007324,13.333252 C94.4177246,11.6472168 99.0800781,13.8925781 100.942383,16.1518555 C102.804687,18.4111328 103.39502,20.2260742 103.746582,22.1201172 C103.980957,23.3828125 104.06543,24.8427734 104,26.5 C108.141764,26.3313802 110.918945,27.1647135 112.331543,29 C114.040039,31.1936035 114.215332,33.817627 113.593018,35.75 C112.970703,37.682373 110.894531,40.5 107,40.5 L28,40.5"></path><path vector-effect="non-scaling-stroke" d="M18,27.5 L83.0004985,27.5"></path><path vector-effect="non-scaling-stroke" d="M0,27.5 L8,27.5"></path></g><g transform="translate(135.000000, 152.000000)" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3"><path vector-effect="non-scaling-stroke" d="M44,17.5 L63,17.5 C62.2789714,12.0723971 64.081543,7.53186978 68.4077148,3.87841797 C73.3754883,-0.195556641 79.2734375,0.717773438 82.440918,2.12353516 C85.6083984,3.52929687 87.9606934,5.46069336 89.5913086,9.10524041 C90.2822266,10.6397351 90.7517904,11.9379883 91,13"></path><path vector-effect="non-scaling-stroke" d="M83,20.5 C84.0558268,16.8461914 86.2227376,14.4572754 89.5007324,13.333252 C94.4177246,11.6472168 99.0800781,13.8925781 100.942383,16.1518555 C102.804687,18.4111328 103.39502,20.2260742 103.746582,22.1201172 C103.980957,23.3828125 104.06543,24.8427734 104,26.5 C108.141764,26.3313802 110.918945,27.1647135 112.331543,29 C114.040039,31.1936035 114.215332,33.817627 113.593018,35.75 C112.970703,37.682373 110.894531,40.5 107,40.5 L28,40.5"></path><path vector-effect="non-scaling-stroke" d="M18,27.5 L83.0004985,27.5"></path><path vector-effect="non-scaling-stroke" d="M0,27.5 L8,27.5"></path></g><g transform="translate(69.000000, 256.000000)" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3"><path vector-effect="non-scaling-stroke" d="M14,36.5 L464,36.5"></path><path vector-effect="non-scaling-stroke" d="M0,36.5 L6,36.5"></path><polyline vector-effect="non-scaling-stroke" stroke-linejoin="round" points="234.5 36 279.5 0 313.5 26"></polyline><path vector-effect="non-scaling-stroke" d="M279.5,1 L279.5,35" stroke-linejoin="round"></path><path vector-effect="non-scaling-stroke" d="M313.5,11 C313.5,20.7437888 313.5,25.7437888 313.5,26 C313.5,25.7437888 313.5,20.7437888 313.5,11 Z" stroke-linejoin="round"></path><polyline vector-effect="non-scaling-stroke" stroke-linejoin="round" points="303.5 17 313.5 9 347.5 36"></polyline></g><g transform="translate(113.000000, 178.000000)"><g transform="translate(30.000000, 8.000000)" class="slds-illustration__fill-secondary"><path vector-effect="non-scaling-stroke" d="M29.5,60.5 L29.5,12 C29.5,5.372583 34.872583,0 41.5,0 C48.127417,0 53.5,5.372583 53.5,12 L53.5,40.5 L70.5,40.5 L70.5,27 C70.5,23.1340068 73.6340068,20 77.5,20 C81.3659932,20 84.5,23.1340068 84.5,27 L84.5,48.5 C84.5,51.8137085 81.8137085,54.5 78.5,54.5 L53.5,54.5 L53.5,118.5 L29.5,118.5 L29.5,74.5 L6.5,74.5 C3.1862915,74.5 0.5,71.8137085 0.5,68.5 L0.5,39 C0.5,35.1340068 3.63400675,32 7.5,32 C11.3659932,32 14.5,35.1340068 14.5,39 L14.5,60.5 L29.5,60.5 Z"></path></g><g transform="translate(59.000000, 7.000000)" fill="#FFFFFF"><path vector-effect="non-scaling-stroke" d="M2,11 C3.65332031,8.49145508 5.65181478,6.77364095 7.9954834,5.84655762 C11.5109863,4.45593262 15.2684326,4.95605469 17.8156738,6.2824707 C20.362915,7.60888672 22.3626709,9.64978027 23.2602539,11.81604 C23.8586426,13.2602132 23.8586426,11.7547201 23.2602539,7.29956055 L19.612793,3.56494141 L13.7923584,0.564331055 L8.765625,1.42663574 L4.67321777,3.19787598 C2.69893392,5.13902708 1.69559733,6.16722532 1.66320801,6.2824707 C1.61462402,6.45533878 0.856079102,9.49145508 0.813964844,9.66003418 C0.785888672,9.77242025 1.18123372,10.2190755 2,11 Z"></path></g><g class="slds-illustration__stroke-primary" stroke-width="3"><path vector-effect="non-scaling-stroke" d="M0,126.5 L356,126.5" stroke-linecap="round"></path><path vector-effect="non-scaling-stroke" d="M362.5,126.5 L372.013149,126.5" stroke-linecap="round"></path><path vector-effect="non-scaling-stroke" d="M107.5,20 L107.5,28" stroke-linecap="round"></path><path vector-effect="non-scaling-stroke" d="M113,30.6568542 L118.656854,25" stroke-linecap="round"></path><path vector-effect="non-scaling-stroke" d="M37.5,32 L37.5,40" stroke-linecap="round"></path><path vector-effect="non-scaling-stroke" d="M44,42.6568542 L49.6568542,37" stroke-linecap="round"></path><path vector-effect="non-scaling-stroke" d="M25,42.6568542 L30.6568542,37" stroke-linecap="round" transform="translate(27.828427, 39.828427) scale(-1, 1) translate(-27.828427, -39.828427) "></path><path vector-effect="non-scaling-stroke" d="M71.5,0 L71.5,8" stroke-linecap="round"></path><path vector-effect="non-scaling-stroke" d="M79,10.6568542 L84.6568542,5" stroke-linecap="round"></path><path vector-effect="non-scaling-stroke" d="M58,10.6568542 L63.6568542,5" stroke-linecap="round" transform="translate(60.828427, 7.828427) scale(-1, 1) translate(-60.828427, -7.828427) "></path><path vector-effect="non-scaling-stroke" d="M59.5,68.5 L59.5,20 C59.5,13.372583 64.872583,8 71.5,8 C78.127417,8 83.5,13.372583 83.5,20 L83.5,48.5 L100.5,48.5 L100.5,35 C100.5,31.1340068 103.634007,28 107.5,28 C111.365993,28 114.5,31.1340068 114.5,35 L114.5,56.5 C114.5,59.8137085 111.813708,62.5 108.5,62.5 L83.5,62.5 L83.5,126.5 L59.5,126.5 L59.5,82.5 L36.5,82.5 C33.1862915,82.5 30.5,79.8137085 30.5,76.5 L30.5,47 C30.5,43.1340068 33.6340068,40 37.5,40 C41.3659932,40 44.5,43.1340068 44.5,47 L44.5,68.5 L59.5,68.5 Z"></path><path vector-effect="non-scaling-stroke" d="M77,88.5 L92.5,88.5 L92.5,81 C92.5,77.1340068 95.6340068,74 99.5,74 L99.5,74 C103.365993,74 106.5,77.1340068 106.5,81 L106.5,96.5 C106.5,99.8137085 103.813708,102.5 100.5,102.5 L77,102.5" class="slds-illustration__fill-secondary" stroke-linecap="round" stroke-linejoin="round"></path></g></g><g transform="translate(429.000000, 242.000000)" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3"><g><path vector-effect="non-scaling-stroke" d="M12.5,4 L12.5,50"></path><polyline vector-effect="non-scaling-stroke" stroke-linejoin="round" points="11 18.5 0.5 18.5 0.5 0"></polyline><polyline vector-effect="non-scaling-stroke" stroke-linejoin="round" points="14 25.5 24.5 25.5 24.5 8"></polyline><polyline vector-effect="non-scaling-stroke" stroke-linejoin="round" points="2.5 31 2.5 38.5 11 38.5"></polyline></g></g><g transform="translate(327.000000, 95.000000)"><g><circle vector-effect="non-scaling-stroke" class="slds-illustration__fill-secondary" cx="64" cy="64" r="23"></circle><circle vector-effect="non-scaling-stroke" class="slds-illustration__stroke-secondary" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" stroke-dasharray="135,1,1,18" transform="translate(64.000000, 64.000000) rotate(230.000000) translate(-64.000000, -64.000000) " cx="64" cy="64" r="45"></circle><circle vector-effect="non-scaling-stroke" class="slds-illustration__stroke-secondary" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" stroke-dasharray="107,10" transform="translate(64.000000, 64.000000) rotate(150.000000) translate(-64.000000, -64.000000) " cx="64" cy="64" r="33"></circle></g><g transform="translate(41.000000, 41.000000)" class="slds-illustration__stroke-primary" stroke-width="3"><circle vector-effect="non-scaling-stroke" cx="23" cy="23" r="23"></circle></g></g></g></g></g>',1),oce=[ice];function ace(e,t,s,n,r,a){return L(),X("svg",rce,oce)}const F$=os(nce,[["render",ace]]),lce={name:"ManagerUsers",components:{SLDSButton:Tn,Card:Xp,Picklist:Qi,Tooltip:Fo,ButtonIcon:vn,ConfirmSelfRemoval:B$,ShareEmptyState:F$},props:["users","availableAdminIds","availableManagerIds"],emits:["cancel-and-back","add-user","remove-user"],data(){return{removalContext:null,selectedUser:null,userOptions:[{options:async e=>(e=e.replace(/'/g,"\\'"),(await SPM.Utils.Rest.invoke("Query",{query:`
                            SELECT Id, Name, FirstName, LastName, UserRole.Name, SmallPhotoUrl
                            FROM User
                            WHERE Name LIKE '%${e}%'
                            AND Id IN ('${[...this.availableManagerIds].join("','")}')
                            AND Id NOT IN ('${[...this.availableAdminIds].join("','")}')
                            LIMIT 10
                        `})).filter(s=>!this.users.find(n=>n.id===s.Id)))}]}},computed:{currentUserId(){return SPM.currentUser.Id},managerUsers(){return this.users.filter(e=>this.availableManagerIds.has(e.id)&&!this.availableAdminIds.has(e.id))}},mounted(){this.$refs.userLookup.focus()},methods:{onAdd(){this.$emit("add-user",this.selectedUser),this.selectedUser=null}}},jg=e=>(Nr("data-v-aaf6e02b"),e=e(),Dr(),e),cce={id:"share-plan-manager",class:"slds-grid slds-grid_vertical"},uce={id:"share-plan-manager-breadcrumbs",class:"slds-theme_shade slds-p-horizontal_medium slds-p-vertical_small slds-border_bottom"},dce={class:"slds-grid"},hce=jg(()=>k("span",null,"\xA0>",-1)),pce=jg(()=>k("span",null,"\xA0Sales Plan Managers",-1)),fce={class:"slds-grid slds-grid_align-spread slds-grid_vertical-align-end"},mce={class:"slds-col slds-size_11-of-12 slds-p-right_small"},_ce=jg(()=>k("label",{for:"userLookup",class:"slds-assistive-text"},"Add a sales plan manager",-1)),gce={class:"slds-media slds-listbox__option slds-listbox__option_plain slds-media_small slds-listbox__option_has-meta",role:"option"},yce={class:"slds-media__body"},vce=["title"],bce={key:0,class:"slds-listbox__option-meta"},xce={key:0,id:"noUsersWithAccess",class:"slds-p-vertical_large slds-illustration slds-illustration_small"},wce=jg(()=>k("div",{class:"slds-text-longform"},[k("h3",{class:"slds-illustration__header slds-text-heading_medium"},"Any managers out there?"),k("p",{class:"slds-text-body_regular"},"Add sales plan managers who can build your plan.")],-1)),Sce={key:1,id:"usersWithAccess",class:"slds-table slds-table_cell-buffer slds-table_bordered slds-no-row-hover","aria-label":"Users with access"},Cce=jg(()=>k("thead",null,[k("tr",{class:"slds-line-height_reset"},[k("th",{class:"",scope:"col"},[k("div",{class:"slds-truncate",title:"Sales Plan Manager"},"Sales Plan Manager")]),k("th",{class:"",scope:"col"},[k("div",{class:"slds-truncate",title:"Role"},"Permission Set")]),k("th",{class:"",scope:"col"})])],-1)),Ice=["id"],Tce={"data-label":"User",scope:"row",class:"slds-align-top"},Ace={class:"slds-col slds-grid slds-grid_vertical-align-center"},Mce={class:"avatar slds-grid slds-grid_vertical-align-center slds-grid_align-center slds-m-right_medium"},Ece=["src"],kce={class:"slds-grid slds-grid_vertical"},Pce=["id"],Rce=jg(()=>k("td",{"data-label":"Permission Set"},[k("div",{class:"slds-truncate",title:"Sales Planning Ops Manager"},"Sales Planning Ops Manager")],-1)),$ce={"data-label":"Remove",style:{"text-align":"right"}};function Oce(e,t,s,n,r,a){var I;const o=pe("Picklist"),d=pe("SLDSButton"),p=pe("ShareEmptyState"),y=pe("ButtonIcon"),v=pe("ConfirmSelfRemoval"),C=pe("Card");return L(),X("div",cce,[k("div",uce,[k("div",dce,[k("a",{href:"#",onClick:t[0]||(t[0]=O=>e.$emit("cancel-and-back"))},"Share Sales Plan"),hce,pce])]),k("div",{class:"slds-p-vertical_large slds-p-horizontal_medium",style:br({"min-height":a.managerUsers.length>0?"30rem":"initial"})},[k("div",fce,[k("div",mce,[_ce,de(o,{modelValue:(I=r.selectedUser)==null?void 0:I.Name,id:"userLookup",ref:"userLookup",options:r.userOptions,labelForId:"userLookup",labels:{name:"Add a sales plan manager",search:"Search..."},titleKey:"Name",idKey:"Id",filterable:"",onSelectedOption:t[1]||(t[1]=O=>r.selectedUser=O),onClear:t[2]||(t[2]=()=>r.selectedUser=null)},{option:je(O=>[k("div",gce,[k("span",yce,[k("span",{class:"slds-truncate",title:O.option.Name},Pe(O.option.Name),9,vce),O.option.UserRole?(L(),X("span",bce,Pe(O.option.UserRole.Name),1)):$e("",!0)])])]),_:1},8,["modelValue","options","labels"])]),de(d,{id:"share-plan-manager-add",class:"slds-col slds-size_1-of-12 slds-col_bump-left",style:{height:"fit-content"},label:"Add",variant:"neutral",disabled:!r.selectedUser,onClick:a.onAdd},null,8,["disabled","onClick"])]),de(C,{class:"slds-m-top_medium"},{body:je(()=>[a.managerUsers.length===0?(L(),X("div",xce,[de(p),wce])):(L(),X("table",Sce,[Cce,k("tbody",null,[(L(!0),X(Lt,null,As(a.managerUsers,O=>(L(),X("tr",{id:O.dirty?`sharedWithManager-preview-${O.name}`:`sharedWithManager-${O.name}`,key:O.dirty?`sharedWithManager-preview-${O.name}`:`sharedWithManager-${O.name}`,class:$t(["slds-hint-parent",{"slds-is-edited":O.dirty}])},[k("th",Tce,[k("div",Ace,[k("div",Mce,[O.smallPhotoUrl?(L(),X("img",{key:0,class:"avatar",src:O.smallPhotoUrl},null,8,Ece)):(L(),X(Lt,{key:1},[es(Pe(O.initials),1)],64))]),k("div",kce,[k("span",null,[k("b",null,Pe(O.name),1)]),k("span",{id:`sharedWithManager-role-${O.name}`},Pe(O.role),9,Pce)])])]),Rce,k("td",$ce,[de(y,{id:`sharedWithManager-${O.name}-remove`,class:"slds-button_icon-container",assistiveText:"Remove",iconCategory:"utility",iconName:"close",title:"Remove",onClick:A=>O.id===a.currentUserId?r.removalContext=A.target:e.$emit("remove-user",O.id)},null,8,["id","onClick"])])],10,Ice))),128)),r.removalContext?(L(),Ge(v,{key:0,bindTo:r.removalContext,onConfirm:t[3]||(t[3]=O=>e.$emit("remove-user",a.currentUserId)),onClose:t[4]||(t[4]=()=>r.removalContext=null)},null,8,["bindTo"])):$e("",!0)])]))]),_:1})],4)])}const Lce=os(lce,[["render",Oce],["__scopeId","data-v-aaf6e02b"]]),Nce={name:"TreeNode",components:{ButtonIcon:vn,Icon:yn,Checkbox:za},props:{branchIds:{type:Array,default:()=>[]},node:{type:Object,required:!0},expandButtonAlignment:{type:String,default:"left"},inheritSelection:Boolean},data(){return{localNode:this.node,hasFocus:!1}},watch:{localNode:{immediate:!0,deep:!0,handler(e){this.$nextTick(()=>{this.$emit("update:node",e)})}},node:{immediate:!0,deep:!0,handler(e){Object.keys(this.localNode).length===0&&Object.keys(e).length&&(this.localNode=e)}}},methods:{toggleChildren(){this.localNode.expanded=!this.localNode.expanded},toggleSelect(){this.localNode.indeterminate=!1,this.localNode.selected=!this.localNode.selected,this.localNode.children&&this.localNode.children.length&&(this.inheritSelection?this.toggleSelectionForChildren(this.localNode,this.localNode.selected):this.localNode.selected&&this.toggleSelectionForChildren(this.localNode,!1)),this.$emit("childSelectionMade"),this.$emit("selectionChanged")},toggleSelectionForChildren(e=this.localNode,t){(e.children||[]).forEach(s=>{s.selected=t,s.disabled=t,s.indeterminate=!1,s.children&&this.toggleSelectionForChildren(s,t)}),this.$emit("selectionChanged")},handleChildSelection(){this.inheritSelection&&this.localNode.children.some(e=>e.selected||e.indeterminate)?(this.localNode.selected=!1,this.localNode.indeterminate=!0):(this.localNode.selected=!1,this.localNode.indeterminate=!1),this.localNode.level>1&&this.$emit("childSelectionMade"),this.$emit("selectionChanged")},right(){this.hasFocus&&this.localNode.children&&this.localNode.children.length&&(this.localNode.expanded=!0)},left(){this.hasFocus&&(this.localNode.children&&this.localNode.children.length&&this.localNode.expanded?this.localNode.expanded=!1:this.localNode.level!==1&&this.$el.parentElement.closest('li[aria-expanded = "true"]').focus())}}},Dce=["aria-expanded","aria-label","aria-level","aria-selected","aria-disabled","tabindex"],Bce={class:"slds-has-flexi-truncate"},Fce=["title"],zce={key:0,role:"group"};function Uce(e,t,s,n,r,a){const o=pe("ButtonIcon"),d=pe("Checkbox"),p=pe("TreeNode",!0);return s.node.isHidden?$e("",!0):(L(),X("li",{key:0,"aria-expanded":s.node.expanded,"aria-label":s.node.label,"aria-level":s.node.level,"aria-selected":s.node.selected,"aria-disabled":s.node.disabled,role:"treeitem",tabindex:r.hasFocus?0:-1,onFocus:t[1]||(t[1]=y=>r.hasFocus=!0),onBlur:t[2]||(t[2]=y=>r.hasFocus=!1),onKeydown:[t[3]||(t[3]=Zs((...y)=>a.right&&a.right(...y),["right"])),t[4]||(t[4]=Zs((...y)=>a.left&&a.left(...y),["left"]))]},[k("div",{class:"slds-tree__item",onClick:t[0]||(t[0]=Os(()=>s.node.disabled?()=>{}:a.toggleSelect(),["prevent"]))},[s.expandButtonAlignment==="left"&&s.node.children&&s.node.children.length?(L(),Ge(o,{key:0,variant:"bare",iconCategory:"utility",iconName:"chevronright",class:"slds-m-right_x-small slds-button_icon","aria-hidden":"true",tabindex:"-1",title:`Expand ${s.node.label}`,assistiveText:`Expand ${s.node.label}`,onClick:Os(a.toggleChildren,["stop"])},null,8,["title","assistiveText","onClick"])):$e("",!0),k("span",Bce,[k("span",{class:"slds-tree__item-label slds-truncate",title:s.node.label},[de(d,{id:`share-plan-hierarchy-popover-checkbox-${s.node.label}`,modelValue:s.node.selected,disabled:s.node.disabled,labels:{name:s.node.label}},null,8,["id","modelValue","disabled","labels"])],8,Fce)]),s.expandButtonAlignment==="right"&&s.node.children&&s.node.children.length?(L(),Ge(o,{key:1,variant:"bare",iconCategory:"utility",iconName:"chevronright",class:"slds-m-right_x-small slds-button_icon","aria-hidden":"true",tabindex:"-1",title:`Expand ${s.node.label}`,assistiveText:`Expand ${s.node.label}`,onClick:Os(a.toggleChildren,["stop"])},null,8,["title","assistiveText","onClick"])):$e("",!0)]),s.node.children&&s.node.children.length&&s.node.expanded?(L(),X("ul",zce,[(L(!0),X(Lt,null,As(s.node.children,(y,v)=>(L(),Ge(p,{key:y.id,node:s.node.children[v],branchIds:s.branchIds,expandButtonAlignment:s.expandButtonAlignment,inheritSelection:s.inheritSelection,onChildSelectionMade:a.handleChildSelection},null,8,["node","branchIds","expandButtonAlignment","inheritSelection","onChildSelectionMade"]))),128))])):$e("",!0)],40,Dce))}const Vce=os(Nce,[["render",Uce],["__scopeId","data-v-b6704967"]]),jce={name:"Tree",components:{TreeNode:Vce,ButtonIcon:vn,Icon:yn},props:{treeData:{type:Object,default:()=>{}},branchIds:{type:Array,default:()=>[]},heading:{type:String,required:!0},showHeading:{type:Boolean,default:!0},expandButtonAlignment:{type:String,default:"left",validator:e=>{const t=["left","right"],s=!e||t.includes(e);return s||console.error(`Valid alignment prop values are ${t.join(", ")}`),s}},useCheckIconForSelect:Boolean,inheritSelection:Boolean,filterable:Boolean,filterInputId:{type:String,default:"filter-id"},filterLabel:{type:String,default:"Filter"},showFilterLabel:Boolean,required:Boolean,showCount:Boolean,treeId:{type:String,default:"tree-id"}},data(){return{focusableTreeItems:[],focusedTreeItemIndex:0,searchTerm:"",numberSelected:0}},computed:{lowerCaseSearchTerm(){return this.searchTerm.toLowerCase()}},watch:{treeData:{deep:!0,handler(){this.getFocusableTreeItems(),this.getSelectedItemsCount()}}},mounted(){this.getFocusableTreeItems()},methods:{selectionChanged(){this.$emit("selectionChanged")},getFocusableTreeItems(){const e=this.$refs.treeRoot.querySelectorAll("li");this.focusableTreeItems.length!==e.length&&(this.focusableTreeItems=e),this.focusableTreeItems.length&&!this.checkForFocusedItem()&&document.activeElement!==this.$refs.filterInput&&(this.focusedTreeItemIndex>this.focusableTreeItems.length-1&&(this.focusedTreeItemIndex=0),this.focusedTreeItem=this.focusableTreeItems[this.focusedTreeItemIndex],this.focusedTreeItem.focus())},checkForFocusedItem(){let e=!1;return this.focusableTreeItems.forEach((t,s)=>{t===document.activeElement&&(e=!0,this.focusedTreeItemIndex=s)}),e},getBranchNodes(){const e=[],t=s=>{const n=[];s.forEach(r=>{r.selected?e.push(r):n.push(...r.children||[])}),n.length>0&&t(n)};return t([this.treeData]),e},getSelectedItemsCount(){this.numberSelected=0;const e=t=>{(t.children||[]).forEach(s=>{s.selected&&this.numberSelected++,e(s)})};e(this.treeData)},getSelectedItems(){return this.treeData},down(){this.focusedTreeItemIndex<this.focusableTreeItems.length-1&&this.focusedTreeItemIndex++,this.focusableTreeItems[this.focusedTreeItemIndex].focus()},up(){this.focusedTreeItemIndex>0&&this.focusedTreeItemIndex--,this.focusableTreeItems[this.focusedTreeItemIndex].focus()},filterNodes(){this.treeData.expanded||(this.treeData.expanded=!0),this.filterByTerm(this.treeData)},filterByTerm(e){(e.children||[]).forEach(t=>{const s=t.label.toLowerCase();let n=!1;const r=a=>{(a.children||[]).forEach(o=>{o.label.toLowerCase().includes(this.lowerCaseSearchTerm)?(n=!0,o.expanded=!0):o.expanded=!1,r(o)})};if(r(t),s.includes(this.lowerCaseSearchTerm)){if(t.isHidden=!1,t.children){t.expanded=!0;const a=o=>{(o.children||[]).forEach(d=>{d.isHidden=!1,d.expanded=!0,a(d)})};a(t)}}else n?(t.isHidden=!1,t.expanded=!0,this.filterByTerm(t)):(t.isHidden=!0,t.expanded=!1)})},clearSearchTerm(){this.searchTerm="",this.filterNodes()}}},qce={key:0,class:"slds-m-bottom_small"},Hce={class:"slds-form-element"},Gce=["for"],Wce={key:0,class:"slds-required",title:"Required"},Yce={key:0},Zce={class:"slds-form-element__control slds-input-has-icon slds-input-has-icon_left-right"},Xce=["id","aria-controls"],Kce={class:"slds-tree_container"},Jce=["id"];function Qce(e,t,s,n,r,a){const o=pe("Icon"),d=pe("ButtonIcon"),p=pe("TreeNode");return L(),X("div",null,[s.filterable?(L(),X("div",qce,[k("div",Hce,[k("label",{class:$t(["slds-form-element__label slds-grid slds-grid_align-spread",{"slds-assistive-text":!s.showFilterLabel}]),for:s.filterInputId},[k("span",null,[s.required?(L(),X("abbr",Wce,"*")):$e("",!0),es(" "+Pe(s.filterLabel),1)]),s.showCount?(L(),X("span",Yce," Selected ("+Pe(r.numberSelected)+") ",1)):$e("",!0)],10,Gce),k("div",Zce,[de(o,{category:"utility",name:"search",class:"slds-icon_container slds-icon-utility-search",iconClass:["slds-icon","slds-icon","slds-input__icon","slds-input__icon_left","slds-icon-text-default"]}),Mn(k("input",{id:s.filterInputId,ref:"filterInput","onUpdate:modelValue":t[0]||(t[0]=y=>r.searchTerm=y),type:"search","aria-controls":s.treeId,placeholder:"Search...",class:"slds-input",onInput:t[1]||(t[1]=(...y)=>a.filterNodes&&a.filterNodes(...y))},null,40,Xce),[[Tp,r.searchTerm]]),de(d,{iconCategory:"utility",iconName:"clear",variant:"bare",class:"slds-input__icon slds-input__icon_right",title:"Clear search terms",assistiveText:"Clear search terms",onClick:a.clearSearchTerm},null,8,["onClick"])])])])):$e("",!0),k("div",Kce,[k("h4",{id:"treeheading",class:$t(["slds-tree__group-header",{"slds-assistive-text":!s.showHeading}])},Pe(s.heading),3),k("ul",{id:s.treeId,ref:"treeRoot","aria-labelledby":"treeheading",class:$t(["slds-tree",{"select-check-icon":s.useCheckIconForSelect}]),role:"tree",onKeydown:[t[2]||(t[2]=Zs((...y)=>a.down&&a.down(...y),["down"])),t[3]||(t[3]=Zs((...y)=>a.up&&a.up(...y),["up"]))]},[de(p,{node:s.treeData,branchIds:s.branchIds,expandButtonAlignment:s.expandButtonAlignment,inheritSelection:s.inheritSelection,onSelectionChanged:a.selectionChanged},null,8,["node","branchIds","expandButtonAlignment","inheritSelection","onSelectionChanged"])],42,Jce)])])}const eue=os(jce,[["render",Qce],["__scopeId","data-v-06c2e8cd"]]),tue={name:"HierarchySelector",components:{Button:Tn,Popover:Uc,Tree:eue},emits:["close","confirm"],props:["bindTo","user"],data(){return{treeData:null,branchIds:[]}},mounted(){this.treeData=JSON.parse(JSON.stringify(this.user.hierarchy)),this.branchIds=this.user.accessRecords.map(e=>e.sfsp__SalesNode__c||"All Org")},methods:{onConfirm(){const e=this.$refs.hierarchyTree.getBranchNodes();if(e.length===0)return SPM.$store.toast({message:"Please select at least one branch",duration:2500,state:"error"});const t=e.map(s=>{const n=this.user.accessRecords.find(r=>s.id===(r.sfsp__SalesNode__c||"All Org"));return n?(n.sfsp__AccessLevel__c=s.accessLevel,n):{sfsp__AccessLevel__c:s.accessLevel||"Editor",sfsp__SalesNode__c:s.id==="All Org"?null:s.id,sfsp__SalesPlan__c:this.$store.plan.Id,sfsp__User__c:this.user.id,sfsp__SalesNode__r:{Name:s.id==="All Org"?null:s.label}}});this.user.accessRecords=t,this.$emit("confirm")}}},sue={class:"slds-scrollable",style:{"max-height":"20rem"}},nue={class:"slds-grid slds-grid_vertical-align-center"};function rue(e,t,s,n,r,a){const o=pe("Tree"),d=pe("Button"),p=pe("Popover");return L(),Ge(p,{id:"share-plan-hierarchy-popover",width:"x-large",bindTo:e.$props.bindTo,alignment:"right",position:"fixed",closeOnClickOutside:"",onClose:t[1]||(t[1]=y=>e.$emit("close"))},{header:je(()=>[es("Hierarchy Nodes")]),content:je(()=>[k("div",sue,[r.treeData?(L(),Ge(o,{key:0,ref:"hierarchyTree",class:"slds-is-relative",treeData:r.treeData,branchIds:r.branchIds,showFilterLabel:"",heading:"Hierarchy Access Tree",showHeading:!1,expandButtonAlignment:"left",filterLabel:"",useCheckIconForSelect:"",inheritSelection:"",filterable:""},null,8,["treeData","branchIds"])):$e("",!0)])]),footer:je(()=>[k("div",nue,[de(d,{class:"slds-col_bump-left",variant:"neutral",label:"Cancel",onClick:t[0]||(t[0]=y=>e.$emit("close"))}),de(d,{class:"slds-col_bump-left",variant:"brand",label:"Apply",onClick:a.onConfirm},null,8,["onClick"])])]),_:1},8,["bindTo"])}const iue=os(tue,[["render",rue]]),oue={name:"StandardUsers",components:{SLDSButton:Tn,Card:Xp,Picklist:Qi,Tooltip:Fo,ButtonIcon:vn,HierarchySelector:iue,ConfirmSelfRemoval:B$,ShareEmptyState:F$},props:["users","availableAdminIds","availableManagerIds","availableStandardIds","nodeMap"],emits:["cancel-and-back","add-user","remove-user","edit-user"],data(){return{userContext:null,hierarchyContext:null,removalContext:null,selectedUser:null,branchValue:"All Org",branchOptions:[{id:"All Org",name:"All Org"},...Object.values(this.nodeMap).flat().map(e=>({id:e.id,name:e.name}))],accessValue:"Editor",accessOptions:["Editor","Viewer"],userOptions:[{options:async e=>(e=e.replace(/'/g,"\\'"),(await SPM.Utils.Rest.invoke("Query",{query:`
                            SELECT Id, Name, FirstName, LastName, UserRole.Name, SmallPhotoUrl
                            FROM User
                            WHERE Name LIKE '%${e}%'
                            AND Id IN ('${[...this.availableStandardIds].join("','")}')
                            AND Id NOT IN ('${[...this.availableAdminIds,...this.availableManagerIds].join("','")}')
                            LIMIT 10
                        `})).filter(s=>!this.users.find(n=>n.id===s.Id)))}]}},computed:{currentUserId(){return SPM.currentUser.Id},standardUsers(){return this.users.filter(e=>this.availableStandardIds.has(e.id)&&!this.availableManagerIds.has(e.id)&&!this.availableAdminIds.has(e.id))}},mounted(){this.$refs.userLookup.focus()},methods:{onAdd(){this.$emit("add-user",this.selectedUser,this.accessValue,this.branchValue),this.selectedUser=null}}},Om=e=>(Nr("data-v-93b57e2c"),e=e(),Dr(),e),aue={id:"share-plan-standard",class:"slds-grid slds-grid_vertical"},lue={id:"share-plan-standard-breadcrumbs",class:"slds-theme_shade slds-p-horizontal_medium slds-p-vertical_small slds-border_bottom"},cue={class:"slds-grid"},uue=Om(()=>k("span",null,"\xA0>",-1)),due=Om(()=>k("span",null,"\xA0Sales Plan Contributors",-1)),hue={class:"slds-grid slds-grid_align-spread slds-grid_vertical-align-end"},pue={class:"slds-col slds-size_4-of-12 slds-p-right_small"},fue=Om(()=>k("label",{for:"share-plan-standard-user-lookup",class:"slds-assistive-text"},"Add a user",-1)),mue={class:"slds-media slds-listbox__option slds-listbox__option_plain slds-media_small slds-listbox__option_has-meta",role:"option"},_ue={class:"slds-media__body"},gue=["title"],yue={key:0,class:"slds-listbox__option-meta"},vue={id:"share-plan-standard-branch-picklist",class:"slds-col slds-size_4-of-12 slds-p-right_small"},bue=Om(()=>k("label",{for:"branchPicklist",class:"slds-assistive-text"},"Node",-1)),xue={class:"slds-col slds-size_3-of-12 slds-p-right_small"},wue=Om(()=>k("label",{for:"share-plan-standard-access-picklist",class:"slds-assistive-text"},"Access",-1)),Sue={key:0,id:"noUsersWithAccess",class:"slds-p-vertical_large slds-illustration slds-illustration_small"},Cue=Om(()=>k("div",{class:"slds-text-longform"},[k("h3",{class:"slds-illustration__header slds-text-heading_medium"},"Nobody helping yet?"),k("p",{class:"slds-text-body_regular"},"Get great sales results when you invite the key contributors to your sales plan.")],-1)),Iue={key:1,id:"usersWithAccess",class:"slds-table slds-table_cell-buffer slds-table_bordered slds-no-row-hover","aria-label":"Users with access"},Tue=Om(()=>k("thead",null,[k("tr",{class:"slds-line-height_reset"},[k("th",{class:"slds-col slds-size_4-of-12 slds-p-right_small",scope:"col"},[k("div",{class:"slds-truncate",title:"User"},"User")]),k("th",{class:"slds-col slds-size_3-of-12",scope:"col"},[k("div",{class:"slds-truncate",title:"Node"},"Node")]),k("th",{class:"slds-col slds-size_1-of-12 slds-p-right_small",scope:"col"}),k("th",{class:"slds-col slds-size_3-of-12",scope:"col"},[k("div",{class:"slds-truncate",title:"Access"},"Access")]),k("th",{class:"slds-col slds-size_1-of-12",scope:"col"})])],-1)),Aue=["id"],Mue={"data-label":"User",scope:"row",class:"slds-col slds-size_4-of-12 slds-align-top"},Eue={class:"slds-col slds-grid slds-grid_vertical-align-center slds-p-right_small"},kue={class:"avatar slds-grid slds-grid_vertical-align-center slds-grid_align-center slds-m-right_medium"},Pue=["src"],Rue={class:"slds-grid slds-grid_vertical"},$ue=["id"],Oue={"data-label":"Hierarchy Branch",class:"slds-col slds-size_3-of-12"},Lue=["id"],Nue={"data-label":"Edit",class:"slds-col slds-size_1-of-12",style:{"text-align":"end"}},Due={class:"slds-col"},Bue={"data-label":"Access",class:"slds-col slds-size_3-of-12"},Fue={"data-label":"Remove",class:"slds-col slds-size_1-of-12"};function zue(e,t,s,n,r,a){var O;const o=pe("Picklist"),d=pe("SLDSButton"),p=pe("ShareEmptyState"),y=pe("ButtonIcon"),v=pe("HierarchySelector"),C=pe("ConfirmSelfRemoval"),I=pe("Card");return L(),X("div",aue,[k("div",lue,[k("div",cue,[k("a",{href:"#",onClick:t[0]||(t[0]=A=>e.$emit("cancel-and-back"))},"Share Sales Plan"),uue,due])]),k("div",{class:"slds-p-vertical_large slds-p-horizontal_medium",style:br({"min-height":a.standardUsers.length>0?"30rem":"initial"})},[k("div",hue,[k("div",pue,[fue,de(o,{modelValue:(O=r.selectedUser)==null?void 0:O.Name,id:"share-plan-standard-user-lookup",style:{width:"100%"},ref:"userLookup",options:r.userOptions,labelForId:"share-plan-standard-user-lookup",labels:{name:"Add a user",search:"Search users..."},titleKey:"Name",idKey:"Id",filterable:"",onSelectedOption:t[1]||(t[1]=A=>r.selectedUser=A),onClear:t[2]||(t[2]=()=>r.selectedUser=null)},{option:je(A=>[k("div",mue,[k("span",_ue,[k("span",{class:"slds-truncate",title:A.option.Name},Pe(A.option.Name),9,gue),A.option.UserRole?(L(),X("span",yue,Pe(A.option.UserRole.Name),1)):$e("",!0)])])]),_:1},8,["modelValue","options","labels"])]),k("div",vue,[bue,de(o,{modelValue:r.branchValue,"onUpdate:modelValue":t[3]||(t[3]=A=>r.branchValue=A),id:"branchPicklist",style:{width:"100%"},labelForId:"branchPicklist",titleKey:"name",idKey:"id",filterable:"",options:r.branchOptions,labels:{name:"Node"}},null,8,["modelValue","options"])]),k("div",xue,[wue,de(o,{modelValue:r.accessValue,"onUpdate:modelValue":t[4]||(t[4]=A=>r.accessValue=A),id:"share-plan-standard-access-picklist",style:{width:"100%"},labelForId:"share-plan-standard-access-picklist",options:r.accessOptions,labels:{name:"Access"}},null,8,["modelValue","options"])]),de(d,{id:"share-plan-standard-add",class:"slds-col slds-size_1-of-12 slds-col_bump-left",style:{height:"fit-content"},label:"Add",variant:"neutral",disabled:!r.selectedUser||!r.branchValue,onClick:a.onAdd},null,8,["disabled","onClick"])]),de(I,{class:"slds-m-top_medium"},{body:je(()=>[a.standardUsers.length===0?(L(),X("div",Sue,[de(p),Cue])):(L(),X("table",Iue,[Tue,k("tbody",null,[(L(!0),X(Lt,null,As(a.standardUsers,A=>(L(),X("tr",{id:A.dirty?`sharedWithStandard-preview-${A.name}`:`sharedWithStandard-${A.name}`,key:A.dirty?`sharedWithStandard-preview-${A.name}`:`sharedWithStandard-${A.name}`,class:$t(["slds-hint-parent",{"slds-is-edited":A.dirty}])},[k("th",Mue,[k("div",Eue,[k("div",kue,[A.smallPhotoUrl?(L(),X("img",{key:0,class:"avatar",src:A.smallPhotoUrl},null,8,Pue)):(L(),X(Lt,{key:1},[es(Pe(A.initials),1)],64))]),k("div",Rue,[k("span",null,[k("b",null,Pe(A.name),1)]),k("span",{id:`sharedWithStandard-role-${A.name}`},Pe(A.role),9,$ue)])])]),k("td",Oue,[(L(!0),X(Lt,null,As(A.accessRecords,P=>{var q,ce;return L(),X("div",{key:`${P.Id}-hierarchy`,class:"slds-grid slds-grid_vertical-align-center slds-m-vertical_small slds-p-right_small",style:{height:"2rem"}},[k("span",{id:`sharedWithStandard-${A.name}-branch-${((q=s.nodeMap[P.sfsp__SalesNode__c])==null?void 0:q.name)||"All Org"}`,class:"slds-truncate slds-col"},Pe(((ce=s.nodeMap[P.sfsp__SalesNode__c])==null?void 0:ce.name)||"All Org"),9,Lue)])}),128))]),k("td",Nue,[(L(!0),X(Lt,null,As(A.accessRecords,P=>{var q;return L(),X("div",{key:`${P.Id}-edit`,class:"slds-grid slds-grid_vertical-align-center slds-m-vertical_small slds-p-right_small",style:{height:"2rem"}},[k("div",Due,[de(y,{id:`sharedWithStandard-${A.name}-edit-${((q=s.nodeMap[P.sfsp__SalesNode__c])==null?void 0:q.name)||"All Org"}`,class:"slds-button_icon-container",assistiveText:"Edit",iconCategory:"utility",iconName:"edit",title:"Edit",onClick:ce=>{r.hierarchyContext=ce.target,r.userContext=A}},null,8,["id","onClick"])])])}),128))]),k("td",Bue,[(L(!0),X(Lt,null,As(A.accessRecords,P=>{var q;return L(),X("div",{key:`${P.Id}-access`,class:"slds-grid slds-grid_vertical-align-center slds-m-vertical_small slds-p-right_small",style:{height:"2rem"}},[de(o,{modelValue:P.sfsp__AccessLevel__c,"onUpdate:modelValue":ce=>P.sfsp__AccessLevel__c=ce,id:`sharedWithStandard-${A.name}-access-${((q=s.nodeMap[P.sfsp__SalesNode__c])==null?void 0:q.name)||"All Org"}`,style:{width:"100%"},options:r.accessOptions,onSelectedOption:ce=>e.$emit("edit-user",A.id)},null,8,["modelValue","onUpdate:modelValue","id","options","onSelectedOption"])])}),128))]),k("td",Fue,[(L(!0),X(Lt,null,As(A.accessRecords,P=>{var q;return L(),X("div",{key:`${P.Id}-remove`,class:"slds-grid slds-grid_vertical-align-center slds-grid_align-end slds-m-vertical_small",style:{height:"2rem"}},[de(y,{id:`sharedWithStandard-${A.name}-remove-${((q=s.nodeMap[P.sfsp__SalesNode__c])==null?void 0:q.name)||"All Org"}`,class:"slds-button_icon-container",assistiveText:"Remove",iconCategory:"utility",iconName:"close",title:"Remove",onClick:ce=>A.id===a.currentUserId&&A.accessRecords.length===1?r.removalContext=ce.target:e.$emit("remove-user",A.id,P)},null,8,["id","onClick"])])}),128))])],10,Aue))),128)),r.hierarchyContext&&r.userContext?(L(),Ge(v,{key:0,bindTo:r.hierarchyContext,user:r.userContext,onConfirm:t[5]||(t[5]=()=>{e.$emit("edit-user",r.userContext.id),r.hierarchyContext=null,r.userContext=null}),onClose:t[6]||(t[6]=()=>{r.hierarchyContext=null,r.userContext=null})},null,8,["bindTo","user"])):$e("",!0),r.removalContext?(L(),Ge(C,{key:1,bindTo:r.removalContext,onConfirm:t[7]||(t[7]=A=>e.$emit("remove-user",a.currentUserId)),onClose:t[8]||(t[8]=()=>r.removalContext=null)},null,8,["bindTo"])):$e("",!0)])]))]),_:1})],4)])}const Uue=os(oue,[["render",zue],["__scopeId","data-v-93b57e2c"]]),Vue={name:"PlanShareModal",components:{SLDSButton:Tn,ButtonIcon:vn,Modal:zc,Spinner:Vr,Overview:Jle,ManagerUsers:Lce,StandardUsers:Uue},props:["config"],emits:["close"],data(){return{loading:!0,page:"Overview",nodeMap:{},treeMap:{},availableAdminIds:this.$store.availableAdminIds,availableManagerIds:this.$store.availableManagerIds,availableStandardIds:new Set,users:[],usersCopy:[]}},computed:{modalTitle(){let e="";return this.page==="Overview"?e="Share Sales Plan":this.page==="ManagerUsers"?e="Sales Plan Managers":this.page==="StandardUsers"&&(e="Sales Plan Contributors"),e},changesMade(){return this.users.some(e=>e.dirty)||this.users.length!==this.usersCopy.length}},async mounted(){SPM.Components.PlanShareModal=this,await this.init(),this.loading=!1},methods:{async init(){await Promise.allSettled([this.availableStandardIds=new Set((await SPM.Utils.Apex.invoke("GetUsersWithPermissionSet",["SalesPlanning"])||[]).map(s=>s.Id)),this.treeMap=(await SPM.Utils.Apex.invoke("Query",[`SELECT Id, Name, sfsp__Parent__r.Id, sfsp__SalesPlan__c FROM sfsp__SalesNode__c WHERE sfsp__SalesPlan__c = '${this.$store.plan.Id}'`])).reduce((s,n)=>{var a;this.nodeMap[n.Id]={id:n.Id,name:n.Name};const r=((a=n.sfsp__Parent__r)==null?void 0:a.Id)||"All Org";return s[r]=s[r]||[],s[r].push({id:n.Id,name:n.Name,parentId:r}),s},{"All Org":[]})]);const e={};(await SPM.Utils.Apex.invoke("Query",[`SELECT Id, sfsp__User__r.Name, sfsp__User__r.UserRole.Name, sfsp__User__r.FirstName, sfsp__User__r.LastName, sfsp__User__r.SmallPhotoUrl, sfsp__AccessLevel__c, sfsp__SalesNode__r.Name FROM sfsp__SalesUserAccess__c WHERE sfsp__SalesPlan__c = '${SPM.$store.plan.Id}'`])||[]).forEach(s=>{var n,r,a,o,d;e[s.sfsp__User__c]=e[s.sfsp__User__c]||{id:s.sfsp__User__c,name:s.sfsp__User__r.Name,initials:`${((r=(n=s.sfsp__User__r)==null?void 0:n.FirstName)==null?void 0:r[0])||""}${((o=(a=s.sfsp__User__r)==null?void 0:a.LastName)==null?void 0:o[0])||""}`,role:((d=s.sfsp__User__r.UserRole)==null?void 0:d.Name)||"",smallPhotoUrl:s.sfsp__User__r.SmallPhotoUrl,accessRecords:[],hierarchy:[],dirty:!1},e[s.sfsp__User__c].accessRecords.push(s)}),this.users=Object.values(e).map(s=>({...s,hierarchy:this.prepareHierarchyTree(s.accessRecords)})),this.usersCopy=JSON.parse(JSON.stringify(this.users))},prepareHierarchyTree(e=[]){const t={label:"All Org",level:1,id:"All Org",expanded:!0,selected:e.some(n=>(n.sfsp__SalesNode__c||"All Org")==="All Org"),disabled:!1,isHidden:!1,children:[]},s=(n,r,a,o)=>{n.forEach(d=>{var y,v;const p={label:d.name,level:a+1,id:d.id,expanded:!0,selected:o||e.some(C=>C.sfsp__SalesNode__c===d.id),accessLevel:((y=e.find(C=>C.sfsp__SalesNode__c===d.id))==null?void 0:y.sfsp__AccessLevel__c)||"Editor",disabled:o,isHidden:!1};((v=this.treeMap[d.id])==null?void 0:v.length)>0&&(p.children=[],s(this.treeMap[d.id],p.children,a+1,p.selected)),r.push(p)})};return s([...this.treeMap["All Org"]],t.children,t.level,t.selected),t},addUser(e,t="Editor",s="All Org"){var a,o,d;if(!e.Id)return;const n={sfsp__AccessLevel__c:t,sfsp__SalesPlan__c:this.$store.plan.Id,sfsp__User__c:e.Id,sfsp__SalesNode__c:s==="All Org"?null:s,sfsp__SalesNode__r:{Name:s==="All Org"?null:this.nodeMap[s].name}},r={id:e.Id,name:e.Name,initials:`${((a=e==null?void 0:e.FirstName)==null?void 0:a[0])||""}${((o=e==null?void 0:e.LastName)==null?void 0:o[0])||""}`,role:((d=e.UserRole)==null?void 0:d.Name)||"",smallPhotoUrl:e.SmallPhotoUrl,accessRecords:[n],hierarchy:this.prepareHierarchyTree([n]),dirty:!0};this.users.unshift(r)},editUser(e){var a;const t=this.users.findIndex(o=>o.id===e),s=this.usersCopy.findIndex(o=>o.id===e),n=this.users[t].accessRecords,r=((a=this.usersCopy[s])==null?void 0:a.accessRecords)||[];r.length!==0&&(this.users[t].dirty=!r.every(o=>n.find(d=>d.Id===o.Id&&d.sfsp__AccessLevel__c===o.sfsp__AccessLevel__c&&d.sfsp__SalesNode__c===o.sfsp__SalesNode__c)),n.some(o=>!o.Id)&&(this.users[t].dirty=!0),n.length!==r.length&&(this.users[t].dirty=!0),this.users[t].dirty&&(this.users[t].hierarchy=this.prepareHierarchyTree(n)))},removeUser(e,t){const s=this.users.findIndex(r=>r.id===e),n=this.usersCopy.findIndex(r=>r.id===e);t&&(this.users[s].accessRecords.splice(this.users[s].accessRecords.findIndex(r=>(r.sfsp__SalesNode__c||"All Org")===(t.sfsp__SalesNode__c||"All Org")),1),n>-1&&(this.users[s].dirty=!this.usersCopy[n].accessRecords.every(r=>this.users[s].accessRecords.find(a=>a.Id===r.Id&&a.sfsp__AccessLevel__c===r.sfsp__AccessLevel__c&&a.sfsp__SalesNode__c===r.sfsp__SalesNode__c)),this.users[s].accessRecords.length!==this.usersCopy[n].accessRecords.length&&(this.users[s].dirty=!0)),this.users[s].accessRecords.some(r=>!r.Id)&&(this.users[s].dirty=!0),this.users[s].accessRecords.length>0)||this.users.splice(s,1)},cancelAndBack(){this.page==="Overview"?this.$emit("close"):(this.users=JSON.parse(JSON.stringify(this.usersCopy)),this.page="Overview")},async postChatter(e,t,s="All Org"){if(!SPM.chatterEnabled)return;let n="";switch(e){case"remove":n=`You have been removed from sales plan ${this.$store.plan.Name}.`;break;case"invite":n=`${SPM.currentUser.Name} granted you access to ${s} in sales plan {record:${this.$store.plan.Id}}.`;break;case"update":n=`${SPM.currentUser.Name} changed your access to sales plan {record:${this.$store.plan.Id}}.`;break}await SPM.Utils.Apex.invoke("PostFeedItem",[t,n])},async save(){this.loading=!0;const e=this.users.reduce((v,C)=>(v[C.name]=C,v),{}),t=this.usersCopy.reduce((v,C)=>(v[C.name]=C,v),{}),s=new Set,n=new Set,r={invite:{},remove:{},edit:{}};this.usersCopy.forEach(v=>{var I;const C=(I=e[v.name])==null?void 0:I.accessRecords;C?v.accessRecords.forEach(O=>{C.every(A=>A.Id!==O.Id)&&s.add(O)}):(r.remove[v.name]=v.accessRecords,v.accessRecords.forEach(O=>s.add(O)))}),this.users.forEach(v=>{var I;const C=((I=t[v.name])==null?void 0:I.accessRecords)||[];C.length===0?(r.invite[v.name]=v.accessRecords,v.accessRecords.forEach(O=>n.add({sobjectType:"sfsp__SalesUserAccess__c",...O}))):v.accessRecords.forEach(A=>{let P=!0;C.forEach(q=>{q.sfsp__AccessLevel__c===A.sfsp__AccessLevel__c&&q.sfsp__SalesNode__c===A.sfsp__SalesNode__c&&(P=!1)}),P&&(r.edit[v.name]=r.edit[v.name]||[],r.edit[v.name].push(A),n.add({sobjectType:"sfsp__SalesUserAccess__c",...A}))})}),await Promise.all([SPM.Utils.CRM.upsert({records:n}),SPM.Utils.Rest.invoke("Delete",{ids:Array.from(s).map(v=>v.Id)})]);const a={invitedToastMsg:"",updatedToastMsg:"",removedToastMsg:""},o=Object.keys(r.invite);if(o.length>0){o.length===1?a.invitedToastMsg=`"${o[0]}" was invited to the plan.`:a.invitedToastMsg=`(${o.length}) users were invited to the plan.`;for(const v of o){const C=r.invite[v];await SPM.Utils.Async.forEachParallel(C,async A=>{var P;await this.postChatter("invite",A.sfsp__User__c,((P=A.sfsp__SalesNode__r)==null?void 0:P.Name)||"All Org")},5);const O=C.map(A=>{var P;return`Added ${v} as ${A.sfsp__AccessLevel__c} to ${((P=A.sfsp__SalesNode__r)==null?void 0:P.Name)||"All Org"}`}).map(A=>({description:A,name:this.$store.plan.Name,parentId:this.$store.plan.Id,recordType:og.PLAN,subtype:ma.CREATE,type:mh.SHARING}));await pm(O)}await SPM.Utils.Async.forEachParallel(Object.values(o),async v=>{await this.$store.savePreferences(v.id)},5)}const d=Object.keys(r.edit);d.length>0&&(d.length===1?a.updatedToastMsg=`Access for "${d[0]}" was updated.`:a.updatedToastMsg=`Access was updated for (${d.length}) users.`,await SPM.Utils.Async.forEachParallel(d,async v=>{await this.postChatter("update",r.edit[v][0].sfsp__User__c);const O=r.edit[v].map(A=>{var P;return`Changed ${v}'s access to ${((P=A.sfsp__SalesNode__r)==null?void 0:P.Name)||"All Org"}`}).map(A=>({description:A,name:this.$store.plan.Name,parentId:this.$store.plan.Id,recordType:og.PLAN,subtype:ma.UPDATE,type:mh.SHARING}));await pm(O)},5),await SPM.Utils.Async.forEachParallel(Object.values(d),async v=>{await this.$store.savePreferences(v.id)},5));const p=Object.keys(r.remove);p.length>0&&(p.length===1?a.removedToastMsg=`"${p[0]}" was removed from the plan.`:a.removedToastMsg=`(${p.length}) users were removed from the plan.`,await SPM.Utils.Async.forEachParallel(p,async v=>{await this.postChatter("remove",r.remove[v][0].sfsp__User__c);const O=r.remove[v].map(A=>{var P;return`Removed ${A.sfsp__User__r.Name}'s access to ${((P=A.sfsp__SalesNode__r)==null?void 0:P.Name)||"All Org"}`}).map(A=>({description:A,name:this.$store.plan.Name,parentId:this.$store.plan.Id,recordType:og.PLAN,subtype:ma.DELETE,type:mh.SHARING}));await pm(O)},5));const y=[];if(Object.keys(e).length)for(const v in e){const C=e[v];for(const I of C.accessRecords)!this.availableAdminIds.has(C.id)&&!this.availableManagerIds.has(C.id)&&y.push({name:C.name,userId:I.sfsp__User__c,nodeId:I.sfsp__SalesNode__c||"All Org"})}this.config.callback({...a,sharedWithRecords:y}),r.remove[SPM.currentUser.Name]?window.location.reload():(this.$emit("close"),this.loading=!1)}}},jue={class:"slds-grid"},que={class:"slds-col_bump-left"};function Hue(e,t,s,n,r,a){const o=pe("ButtonIcon"),d=pe("Spinner"),p=pe("Overview"),y=pe("ManagerUsers"),v=pe("StandardUsers"),C=pe("SLDSButton"),I=pe("Modal");return L(),Ge(I,{id:"share-plan",ref:"modal",title:a.modalTitle,detach:"",onClose:t[1]||(t[1]=O=>r.loading?()=>{}:e.$emit("close"))},{tagline:je(()=>[r.page!=="Overview"?(L(),Ge(o,{key:0,id:"share-plan-navigate-back",iconCategory:"utility",iconName:"chevronleft",iconSize:"large",assistiveText:"Back",iconClass:["slds-button__icon"],class:"slds-button slds-button_icon slds-input__icon slds-input__icon_left",style:{position:"absolute",left:"1rem",top:"1rem"},title:"Back",disabled:r.loading,onClick:a.cancelAndBack},null,8,["disabled","onClick"])):$e("",!0)]),content:je(()=>[r.loading?(L(),Ge(d,{key:0})):$e("",!0),r.page==="Overview"?(L(),Ge(p,{key:1,users:r.users,availableAdminIds:r.availableAdminIds,availableManagerIds:r.availableManagerIds,availableStandardIds:r.availableStandardIds,onChangePage:t[0]||(t[0]=O=>r.page=O)},null,8,["users","availableAdminIds","availableManagerIds","availableStandardIds"])):r.page==="ManagerUsers"?(L(),Ge(y,{key:2,users:r.users,availableAdminIds:r.availableAdminIds,availableManagerIds:r.availableManagerIds,onAddUser:a.addUser,onRemoveUser:a.removeUser,onCancelAndBack:a.cancelAndBack},null,8,["users","availableAdminIds","availableManagerIds","onAddUser","onRemoveUser","onCancelAndBack"])):r.page==="StandardUsers"?(L(),Ge(v,{key:3,users:r.users,availableAdminIds:r.availableAdminIds,availableManagerIds:r.availableManagerIds,availableStandardIds:r.availableStandardIds,nodeMap:r.nodeMap,onAddUser:a.addUser,onRemoveUser:a.removeUser,onEditUser:a.editUser,onCancelAndBack:a.cancelAndBack},null,8,["users","availableAdminIds","availableManagerIds","availableStandardIds","nodeMap","onAddUser","onRemoveUser","onEditUser","onCancelAndBack"])):$e("",!0)]),footer:je(()=>[k("div",null,[k("div",jue,[k("div",que,[de(C,{class:"slds-button slds-button_neutral",disabled:r.loading,onClick:a.cancelAndBack},{default:je(()=>[es(Pe(r.page==="Overview"?"Close":"Cancel & Back"),1)]),_:1},8,["disabled","onClick"]),r.page!=="Overview"?(L(),Ge(C,{key:0,class:"slds-button slds-button_brand",disabled:!a.changesMade||r.loading,onClick:a.save},{default:je(()=>[es("Save")]),_:1},8,["disabled","onClick"])):$e("",!0)])])])]),_:1},8,["title"])}const Gue=os(Vue,[["render",Hue],["__scopeId","data-v-be335579"]]),Wue={name:"ConfirmSelfRemoval",components:{Button:Tn,Popover:Uc},emits:["close","confirm"],props:["bindTo"],methods:{onConfirm(){this.$emit("confirm"),this.$emit("close")}}},Yue=k("div",{class:"slds-grid slds-p-vertical_large"},[k("span",{id:"share-branch-confirm-removal-text"},"Removing yourself from this plan prevents you from accessing any of its details.")],-1),Zue={class:"slds-grid slds-grid_vertical-align-center"};function Xue(e,t,s,n,r,a){const o=pe("Button"),d=pe("Popover");return L(),Ge(d,{id:"share-branch-confirm-removal-popover",width:"x-large",bindTo:e.$props.bindTo,alignment:"left",position:"fixed",closeOnClickOutside:"",onClose:t[1]||(t[1]=p=>e.$emit("close"))},{header:je(()=>[es("Remove Yourself?")]),content:je(()=>[Yue]),footer:je(()=>[k("div",Zue,[de(o,{class:"slds-col_bump-left",variant:"neutral",label:"Cancel",onClick:t[0]||(t[0]=p=>e.$emit("close"))}),de(o,{id:"share-branch-confirm-removal-accept",class:"slds-col_bump-left",variant:"brand",label:"Remove",onClick:a.onConfirm},null,8,["onClick"])])]),_:1},8,["bindTo"])}const z$=os(Wue,[["render",Xue]]),Kue={name:"ShareEmptyState"},Jue={class:"slds-illustration__svg",viewBox:"0 0 468 194","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg"},Que=ex('<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g transform="translate(-67.000000, -112.000000)"><g><g transform="translate(245.000000, 200.000000)" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3"><path vector-effect="non-scaling-stroke" d="M44,17.5 L63,17.5 C62.2789714,12.0723971 64.081543,7.53186978 68.4077148,3.87841797 C73.3754883,-0.195556641 79.2734375,0.717773438 82.440918,2.12353516 C85.6083984,3.52929687 87.9606934,5.46069336 89.5913086,9.10524041 C90.2822266,10.6397351 90.7517904,11.9379883 91,13"></path><path vector-effect="non-scaling-stroke" d="M83,20.5 C84.0558268,16.8461914 86.2227376,14.4572754 89.5007324,13.333252 C94.4177246,11.6472168 99.0800781,13.8925781 100.942383,16.1518555 C102.804687,18.4111328 103.39502,20.2260742 103.746582,22.1201172 C103.980957,23.3828125 104.06543,24.8427734 104,26.5 C108.141764,26.3313802 110.918945,27.1647135 112.331543,29 C114.040039,31.1936035 114.215332,33.817627 113.593018,35.75 C112.970703,37.682373 110.894531,40.5 107,40.5 L28,40.5"></path><path vector-effect="non-scaling-stroke" d="M18,27.5 L83.0004985,27.5"></path><path vector-effect="non-scaling-stroke" d="M0,27.5 L8,27.5"></path></g><g transform="translate(135.000000, 152.000000)" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3"><path vector-effect="non-scaling-stroke" d="M44,17.5 L63,17.5 C62.2789714,12.0723971 64.081543,7.53186978 68.4077148,3.87841797 C73.3754883,-0.195556641 79.2734375,0.717773438 82.440918,2.12353516 C85.6083984,3.52929687 87.9606934,5.46069336 89.5913086,9.10524041 C90.2822266,10.6397351 90.7517904,11.9379883 91,13"></path><path vector-effect="non-scaling-stroke" d="M83,20.5 C84.0558268,16.8461914 86.2227376,14.4572754 89.5007324,13.333252 C94.4177246,11.6472168 99.0800781,13.8925781 100.942383,16.1518555 C102.804687,18.4111328 103.39502,20.2260742 103.746582,22.1201172 C103.980957,23.3828125 104.06543,24.8427734 104,26.5 C108.141764,26.3313802 110.918945,27.1647135 112.331543,29 C114.040039,31.1936035 114.215332,33.817627 113.593018,35.75 C112.970703,37.682373 110.894531,40.5 107,40.5 L28,40.5"></path><path vector-effect="non-scaling-stroke" d="M18,27.5 L83.0004985,27.5"></path><path vector-effect="non-scaling-stroke" d="M0,27.5 L8,27.5"></path></g><g transform="translate(69.000000, 256.000000)" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3"><path vector-effect="non-scaling-stroke" d="M14,36.5 L464,36.5"></path><path vector-effect="non-scaling-stroke" d="M0,36.5 L6,36.5"></path><polyline vector-effect="non-scaling-stroke" stroke-linejoin="round" points="234.5 36 279.5 0 313.5 26"></polyline><path vector-effect="non-scaling-stroke" d="M279.5,1 L279.5,35" stroke-linejoin="round"></path><path vector-effect="non-scaling-stroke" d="M313.5,11 C313.5,20.7437888 313.5,25.7437888 313.5,26 C313.5,25.7437888 313.5,20.7437888 313.5,11 Z" stroke-linejoin="round"></path><polyline vector-effect="non-scaling-stroke" stroke-linejoin="round" points="303.5 17 313.5 9 347.5 36"></polyline></g><g transform="translate(113.000000, 178.000000)"><g transform="translate(30.000000, 8.000000)" class="slds-illustration__fill-secondary"><path vector-effect="non-scaling-stroke" d="M29.5,60.5 L29.5,12 C29.5,5.372583 34.872583,0 41.5,0 C48.127417,0 53.5,5.372583 53.5,12 L53.5,40.5 L70.5,40.5 L70.5,27 C70.5,23.1340068 73.6340068,20 77.5,20 C81.3659932,20 84.5,23.1340068 84.5,27 L84.5,48.5 C84.5,51.8137085 81.8137085,54.5 78.5,54.5 L53.5,54.5 L53.5,118.5 L29.5,118.5 L29.5,74.5 L6.5,74.5 C3.1862915,74.5 0.5,71.8137085 0.5,68.5 L0.5,39 C0.5,35.1340068 3.63400675,32 7.5,32 C11.3659932,32 14.5,35.1340068 14.5,39 L14.5,60.5 L29.5,60.5 Z"></path></g><g transform="translate(59.000000, 7.000000)" fill="#FFFFFF"><path vector-effect="non-scaling-stroke" d="M2,11 C3.65332031,8.49145508 5.65181478,6.77364095 7.9954834,5.84655762 C11.5109863,4.45593262 15.2684326,4.95605469 17.8156738,6.2824707 C20.362915,7.60888672 22.3626709,9.64978027 23.2602539,11.81604 C23.8586426,13.2602132 23.8586426,11.7547201 23.2602539,7.29956055 L19.612793,3.56494141 L13.7923584,0.564331055 L8.765625,1.42663574 L4.67321777,3.19787598 C2.69893392,5.13902708 1.69559733,6.16722532 1.66320801,6.2824707 C1.61462402,6.45533878 0.856079102,9.49145508 0.813964844,9.66003418 C0.785888672,9.77242025 1.18123372,10.2190755 2,11 Z"></path></g><g class="slds-illustration__stroke-primary" stroke-width="3"><path vector-effect="non-scaling-stroke" d="M0,126.5 L356,126.5" stroke-linecap="round"></path><path vector-effect="non-scaling-stroke" d="M362.5,126.5 L372.013149,126.5" stroke-linecap="round"></path><path vector-effect="non-scaling-stroke" d="M107.5,20 L107.5,28" stroke-linecap="round"></path><path vector-effect="non-scaling-stroke" d="M113,30.6568542 L118.656854,25" stroke-linecap="round"></path><path vector-effect="non-scaling-stroke" d="M37.5,32 L37.5,40" stroke-linecap="round"></path><path vector-effect="non-scaling-stroke" d="M44,42.6568542 L49.6568542,37" stroke-linecap="round"></path><path vector-effect="non-scaling-stroke" d="M25,42.6568542 L30.6568542,37" stroke-linecap="round" transform="translate(27.828427, 39.828427) scale(-1, 1) translate(-27.828427, -39.828427) "></path><path vector-effect="non-scaling-stroke" d="M71.5,0 L71.5,8" stroke-linecap="round"></path><path vector-effect="non-scaling-stroke" d="M79,10.6568542 L84.6568542,5" stroke-linecap="round"></path><path vector-effect="non-scaling-stroke" d="M58,10.6568542 L63.6568542,5" stroke-linecap="round" transform="translate(60.828427, 7.828427) scale(-1, 1) translate(-60.828427, -7.828427) "></path><path vector-effect="non-scaling-stroke" d="M59.5,68.5 L59.5,20 C59.5,13.372583 64.872583,8 71.5,8 C78.127417,8 83.5,13.372583 83.5,20 L83.5,48.5 L100.5,48.5 L100.5,35 C100.5,31.1340068 103.634007,28 107.5,28 C111.365993,28 114.5,31.1340068 114.5,35 L114.5,56.5 C114.5,59.8137085 111.813708,62.5 108.5,62.5 L83.5,62.5 L83.5,126.5 L59.5,126.5 L59.5,82.5 L36.5,82.5 C33.1862915,82.5 30.5,79.8137085 30.5,76.5 L30.5,47 C30.5,43.1340068 33.6340068,40 37.5,40 C41.3659932,40 44.5,43.1340068 44.5,47 L44.5,68.5 L59.5,68.5 Z"></path><path vector-effect="non-scaling-stroke" d="M77,88.5 L92.5,88.5 L92.5,81 C92.5,77.1340068 95.6340068,74 99.5,74 L99.5,74 C103.365993,74 106.5,77.1340068 106.5,81 L106.5,96.5 C106.5,99.8137085 103.813708,102.5 100.5,102.5 L77,102.5" class="slds-illustration__fill-secondary" stroke-linecap="round" stroke-linejoin="round"></path></g></g><g transform="translate(429.000000, 242.000000)" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3"><g><path vector-effect="non-scaling-stroke" d="M12.5,4 L12.5,50"></path><polyline vector-effect="non-scaling-stroke" stroke-linejoin="round" points="11 18.5 0.5 18.5 0.5 0"></polyline><polyline vector-effect="non-scaling-stroke" stroke-linejoin="round" points="14 25.5 24.5 25.5 24.5 8"></polyline><polyline vector-effect="non-scaling-stroke" stroke-linejoin="round" points="2.5 31 2.5 38.5 11 38.5"></polyline></g></g><g transform="translate(327.000000, 95.000000)"><g><circle vector-effect="non-scaling-stroke" class="slds-illustration__fill-secondary" cx="64" cy="64" r="23"></circle><circle vector-effect="non-scaling-stroke" class="slds-illustration__stroke-secondary" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" stroke-dasharray="135,1,1,18" transform="translate(64.000000, 64.000000) rotate(230.000000) translate(-64.000000, -64.000000) " cx="64" cy="64" r="45"></circle><circle vector-effect="non-scaling-stroke" class="slds-illustration__stroke-secondary" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" stroke-dasharray="107,10" transform="translate(64.000000, 64.000000) rotate(150.000000) translate(-64.000000, -64.000000) " cx="64" cy="64" r="33"></circle></g><g transform="translate(41.000000, 41.000000)" class="slds-illustration__stroke-primary" stroke-width="3"><circle vector-effect="non-scaling-stroke" cx="23" cy="23" r="23"></circle></g></g></g></g></g>',1),ede=[Que];function tde(e,t,s,n,r,a){return L(),X("svg",Jue,ede)}const U$=os(Kue,[["render",tde]]),sde={name:"Overview",components:{SLDSButton:Tn,Card:Xp,Icon:yn},props:["users","availableAdminIds","availableManagerIds","availableStandardIds"],emits:["change-page"],computed:{numAdmin(){return this.availableAdminIds.size},numManager(){return this.users.filter(e=>this.availableManagerIds.has(e.id)&&!this.availableAdminIds.has(e.id)).length},numStandard(){return this.users.filter(e=>this.availableStandardIds.has(e.id)&&!this.availableManagerIds.has(e.id)&&!this.availableAdminIds.has(e.id)).length}}},V$=e=>(Nr("data-v-34277cb2"),e=e(),Dr(),e),nde={id:"share-branch-overview",class:"slds-grid slds-grid_vertical"},rde={class:"slds-p-horizontal_medium slds-p-vertical_large"},ide=V$(()=>k("div",null,"Contributors with Access",-1)),ode={id:"adminUsers",class:"slds-grid slds-grid_vertical slds-border_bottom"},ade={class:"slds-col slds-grid slds-grid_vertical-align-center slds-p-around_small"},lde={class:"avatar slds-grid slds-grid_vertical-align-center slds-grid_align-center slds-m-right_medium"},cde={class:"slds-grid slds-grid_vertical"},ude={id:"managerUsers",class:"slds-grid slds-grid_vertical slds-border_bottom"},dde={class:"slds-col slds-grid slds-grid_vertical-align-center slds-p-around_small"},hde={class:"avatar slds-grid slds-grid_vertical-align-center slds-grid_align-center slds-m-right_medium"},pde={class:"slds-grid slds-grid_vertical"},fde={id:"upstreamUsers",class:"slds-grid slds-grid_vertical"},mde={class:"slds-col slds-grid slds-grid_vertical-align-center slds-p-around_small"},_de={class:"avatar slds-grid slds-grid_vertical-align-center slds-grid_align-center slds-m-right_medium"},gde=V$(()=>k("div",{class:"slds-grid slds-grid_vertical"},"Contributors with Access to This Node's Ancestors",-1));function yde(e,t,s,n,r,a){const o=pe("Icon"),d=pe("SLDSButton"),p=pe("Card");return L(),X("div",nde,[k("div",rde,[ide,de(p,null,{body:je(()=>[k("div",ode,[k("div",ade,[k("div",lde,[de(o,{category:"standard",name:"user_role",assistiveText:"User Role Icon"})]),k("div",cde,"Sales Planning Admins ("+Pe(a.numAdmin)+")",1)])]),k("div",ude,[k("div",dde,[k("div",hde,[de(o,{category:"standard",name:"omni_supervisor",assistiveText:"Omni Supervisor Icon"})]),k("div",pde,"Sales Plan Managers ("+Pe(a.numManager)+")",1),e.$store.isAdmin||e.$store.isManager?(L(),Ge(d,{key:0,id:"share-branch-overview-navigate-manager",class:"slds-col_bump-left",variant:"base",label:"Manage",onClick:t[0]||(t[0]=y=>e.$emit("change-page","managerUsers"))})):$e("",!0)])]),k("div",fde,[k("div",mde,[k("div",_de,[de(o,{category:"standard",name:"user",assistiveText:"User Icon"})]),gde])])]),_:1})])])}const vde=os(sde,[["render",yde],["__scopeId","data-v-34277cb2"]]),bde={name:"BranchUsers",components:{SLDSButton:Tn,Card:Xp,Picklist:Qi,Tooltip:Fo,ButtonIcon:vn,Overview:vde,ConfirmSelfRemoval:z$,ShareEmptyState:U$},props:["users","availableAdminIds","availableManagerIds","availableStandardIds","ancestorIds","branchContext"],emits:["change-page","add-user","remove-user","edit-user"],data(){return{userContext:null,hierarchyContext:null,removalContext:null,selectedUser:null,accessValue:"Editor",accessOptions:["Editor","Viewer"],userOptions:[{options:async e=>(e=e.replace(/'/g,"\\'"),(await SPM.Utils.Rest.invoke("Query",{query:`
                            SELECT Id, Name, FirstName, LastName, UserRole.Name, SmallPhotoUrl
                            FROM User
                            WHERE Name LIKE '%${e}%'
                            AND Id IN ('${[...this.availableStandardIds].join("','")}')
                            AND Id NOT IN ('${[...this.availableAdminIds,...this.availableManagerIds].join("','")}')
                            LIMIT 10
                        `})).filter(s=>!this.users.find(n=>n.id===s.Id&&n.accessRecords.find(r=>[this.branchContext.Id,...this.ancestorIds].includes(r.sfsp__SalesNode__c||"All Org")))))}]}},computed:{currentUserId(){return SPM.currentUser.Id},standardUsers(){return this.users.filter(e=>e.accessRecords.find(t=>this.branchContext.Id===(t.sfsp__SalesNode__c||"All Org"))&&this.availableStandardIds.has(e.id)&&!this.availableManagerIds.has(e.id)&&!this.availableAdminIds.has(e.id))}},mounted(){this.$refs.userLookup.focus()},methods:{onAdd(){this.$emit("add-user",this.selectedUser,this.accessValue,this.branchContext.Id),this.selectedUser=null}}},Bx=e=>(Nr("data-v-741da070"),e=e(),Dr(),e),xde={class:"slds-theme_shade slds-p-horizontal_medium slds-p-vertical_small slds-border_bottom"},wde={class:"slds-grid slds-grid_align-spread slds-grid_vertical-align-end"},Sde={class:"slds-col slds-size_6-of-12 slds-p-right_small"},Cde=Bx(()=>k("label",{for:"userLookup",class:"slds-assistive-text"},"Add a user",-1)),Ide={class:"slds-media slds-listbox__option slds-listbox__option_plain slds-media_small slds-listbox__option_has-meta",role:"option"},Tde={class:"slds-media__body"},Ade=["title"],Mde={key:0,class:"slds-listbox__option-meta"},Ede={class:"slds-col slds-size_5-of-12 slds-p-right_small"},kde=Bx(()=>k("label",{for:"accessPicklist",class:"slds-assistive-text"},"Access",-1)),Pde={class:"slds-grid slds-grid_vertical slds-p-horizontal_medium slds-m-bottom_large"},Rde={key:0,id:"noUsersWithAccess",class:"slds-p-vertical_large slds-illustration slds-illustration_small"},$de=Bx(()=>k("div",{class:"slds-text-longform"},[k("h3",{class:"slds-illustration__header slds-text-heading_medium"},"Nobody helping yet?"),k("p",{class:"slds-text-body_regular"},"Get great sales results when you invite the key contributors to your sales plan.")],-1)),Ode={key:1,id:"usersWithAccess",class:"slds-table slds-table_cell-buffer slds-table_bordered slds-no-row-hover","aria-label":"Users with access"},Lde=Bx(()=>k("thead",null,[k("tr",{class:"slds-line-height_reset"},[k("th",{class:"slds-col slds-size_6-of-12 slds-p-right_small",scope:"col"},[k("div",{class:"slds-truncate",title:"User"},"User")]),k("th",{class:"slds-col slds-size_5-of-12 slds-p-right_small",scope:"col"},[k("div",{class:"slds-truncate",title:"Access"},"Access")]),k("th",{class:"slds-col slds-size_1-of-12",scope:"col"})])],-1)),Nde=["id"],Dde={"data-label":"User",scope:"row",class:"slds-col slds-size_6-of-12 slds-align-top"},Bde={class:"slds-col slds-grid slds-grid_vertical-align-center slds-p-right_small"},Fde={class:"avatar slds-grid slds-grid_vertical-align-center slds-grid_align-center slds-m-right_medium"},zde=["src"],Ude={class:"slds-grid slds-grid_vertical"},Vde=["id"],jde={"data-label":"Access",class:"slds-col slds-size_5-of-12"},qde={"data-label":"Remove",class:"slds-col slds-size_1-of-12"};function Hde(e,t,s,n,r,a){var O;const o=pe("Picklist"),d=pe("SLDSButton"),p=pe("Overview"),y=pe("ShareEmptyState"),v=pe("ButtonIcon"),C=pe("ConfirmSelfRemoval"),I=pe("Card");return L(),X("div",null,[k("div",xde,[k("div",wde,[k("div",Sde,[Cde,de(o,{modelValue:(O=r.selectedUser)==null?void 0:O.Name,id:"userLookup",ref:"userLookup",style:{width:"100%"},options:r.userOptions,labelForId:"userLookup",labels:{name:"Add a user",search:"Search users..."},titleKey:"Name",idKey:"Id",filterable:"",onSelectedOption:t[0]||(t[0]=A=>r.selectedUser=A),onClear:t[1]||(t[1]=()=>r.selectedUser=null)},{option:je(A=>[k("div",Ide,[k("span",Tde,[k("span",{class:"slds-truncate",title:A.option.Name},Pe(A.option.Name),9,Ade),A.option.UserRole?(L(),X("span",Mde,Pe(A.option.UserRole.Name),1)):$e("",!0)])])]),_:1},8,["modelValue","options","labels"])]),k("div",Ede,[kde,de(o,{modelValue:r.accessValue,"onUpdate:modelValue":t[2]||(t[2]=A=>r.accessValue=A),id:"accessPicklist",style:{width:"100%"},labelForId:"accessPicklist",options:r.accessOptions,labels:{name:"Access"}},null,8,["modelValue","options"])]),de(d,{id:"share-branch-standard-add",class:"slds-col slds-size_1-of-12 slds-col_bump-left",style:{height:"fit-content"},label:"Add",variant:"neutral",disabled:!r.selectedUser,onClick:a.onAdd},null,8,["disabled","onClick"])])]),de(p,{users:s.users,availableAdminIds:s.availableAdminIds,availableManagerIds:s.availableManagerIds,availableStandardIds:s.availableStandardIds,onChangePage:t[3]||(t[3]=A=>e.$emit("change-page",A))},null,8,["users","availableAdminIds","availableManagerIds","availableStandardIds"]),k("div",Pde,[es(" Shared with "),de(I,null,{body:je(()=>[a.standardUsers.length===0?(L(),X("div",Rde,[de(y),$de])):(L(),X("table",Ode,[Lde,k("tbody",null,[(L(!0),X(Lt,null,As(a.standardUsers,A=>(L(),X("tr",{id:A.dirty?`sharedWithStandard-preview-${A.name}`:`sharedWithStandard-${A.name}`,key:A.dirty?`sharedWithStandard-preview-${A.name}`:`sharedWithStandard-${A.name}`,class:$t(["slds-hint-parent",{"slds-is-edited":A.dirty}])},[k("th",Dde,[k("div",Bde,[k("div",Fde,[A.smallPhotoUrl?(L(),X("img",{key:0,class:"avatar",src:A.smallPhotoUrl},null,8,zde)):(L(),X(Lt,{key:1},[es(Pe(A.initials),1)],64))]),k("div",Ude,[k("span",null,[k("b",null,Pe(A.name),1)]),k("span",{id:`sharedWithStandard-role-${A.name}`},Pe(A.role),9,Vde)])])]),k("td",jde,[(L(!0),X(Lt,null,As(A.accessRecords.filter(P=>s.branchContext.Id===(P.sfsp__SalesNode__c||"All Org")),P=>(L(),X("div",{key:`${P.Id}-access`,class:"slds-grid slds-grid_vertical-align-center slds-m-vertical_small slds-p-right_small",style:{height:"2rem"}},[de(o,{modelValue:P.sfsp__AccessLevel__c,"onUpdate:modelValue":q=>P.sfsp__AccessLevel__c=q,id:`sharedWithStandard-${A.name}-access`,style:{width:"100%"},options:r.accessOptions,disabled:!A.dirty&&!e.$store.isAdmin&&!e.$store.isManager,onSelectedOption:q=>e.$emit("edit-user",A.id)},null,8,["modelValue","onUpdate:modelValue","id","options","disabled","onSelectedOption"])]))),128))]),k("td",qde,[(L(!0),X(Lt,null,As(A.accessRecords.filter(P=>s.branchContext.Id===(P.sfsp__SalesNode__c||"All Org")),P=>(L(),X("div",{key:`${P.Id}-remove`,class:"slds-grid slds-grid_vertical-align-center slds-grid_align-end slds-m-vertical_small",style:{height:"2rem"}},[de(v,{id:`sharedWithStandard-${A.name}-remove`,class:"slds-button_icon-container",disabled:!A.dirty&&!e.$store.isAdmin&&!e.$store.isManager,assistiveText:"Remove",iconCategory:"utility",iconName:"close",title:"Remove",onClick:q=>A.id===a.currentUserId&&A.accessRecords.length===1?r.removalContext=q.target:e.$emit("remove-user",A.id,P)},null,8,["id","disabled","onClick"])]))),128))])],10,Nde))),128)),r.removalContext?(L(),Ge(C,{key:0,bindTo:r.removalContext,onConfirm:t[4]||(t[4]=A=>e.$emit("remove-user",a.currentUserId)),onClose:t[5]||(t[5]=()=>r.removalContext=null)},null,8,["bindTo"])):$e("",!0)])]))]),_:1})])])}const Gde=os(bde,[["render",Hde],["__scopeId","data-v-741da070"]]),Wde={name:"ManagerUsers",components:{SLDSButton:Tn,Card:Xp,Picklist:Qi,Tooltip:Fo,ButtonIcon:vn,ConfirmSelfRemoval:z$,ShareEmptyState:U$},props:["users","availableAdminIds","availableManagerIds","availableStandardIds"],emits:["cancel-and-back","add-user","remove-user"],data(){return{removalContext:null,selectedUser:null,userOptions:[{options:async e=>(e=e.replace(/'/g,"\\'"),(await SPM.Utils.Rest.invoke("Query",{query:`
                            SELECT Id, Name, FirstName, LastName, UserRole.Name, SmallPhotoUrl
                            FROM User
                            WHERE Name LIKE '%${e}%'
                            AND Id IN ('${[...this.availableManagerIds].join("','")}')
                            AND Id NOT IN ('${[...this.availableAdminIds].join("','")}')
                            LIMIT 10
                        `})).filter(s=>!this.users.find(n=>n.id===s.Id)))}]}},computed:{currentUserId(){return SPM.currentUser.Id},managerUsers(){return this.users.filter(e=>this.availableManagerIds.has(e.id)&&!this.availableAdminIds.has(e.id))}},mounted(){this.$refs.userLookup.focus()},methods:{onAdd(){this.$emit("add-user",this.selectedUser),this.selectedUser=null}}},qg=e=>(Nr("data-v-658c16f8"),e=e(),Dr(),e),Yde={id:"share-branch-manager",class:"slds-grid slds-grid_vertical"},Zde={class:"slds-theme_shade slds-p-horizontal_medium slds-p-vertical_small slds-border_bottom"},Xde={class:"slds-grid"},Kde=qg(()=>k("span",null,"\xA0>",-1)),Jde=qg(()=>k("span",null,"\xA0Sales Plan Managers",-1)),Qde={class:"slds-grid slds-grid_align-spread slds-grid_vertical-align-end"},ehe={class:"slds-col slds-size_11-of-12 slds-p-right_small"},the=qg(()=>k("label",{for:"userLookup",class:"slds-assistive-text"},"Add a sales plan manager",-1)),she={class:"slds-media slds-listbox__option slds-listbox__option_plain slds-media_small slds-listbox__option_has-meta",role:"option"},nhe={class:"slds-media__body"},rhe=["title"],ihe={key:0,class:"slds-listbox__option-meta"},ohe={key:0,id:"noUsersWithAccess",class:"slds-p-vertical_large slds-illustration slds-illustration_small"},ahe=qg(()=>k("div",{class:"slds-text-longform"},[k("h3",{class:"slds-illustration__header slds-text-heading_medium"},"Any managers out there?"),k("p",{class:"slds-text-body_regular"},"Add sales plan managers who can build out your plan.")],-1)),lhe={key:1,id:"usersWithAccess",class:"slds-table slds-table_cell-buffer slds-table_bordered slds-no-row-hover","aria-label":"Users with access"},che=qg(()=>k("thead",null,[k("tr",{class:"slds-line-height_reset"},[k("th",{class:"",scope:"col"},[k("div",{class:"slds-truncate",title:"Sales Plan Manager"},"Sales Plan Manager")]),k("th",{class:"",scope:"col"},[k("div",{class:"slds-truncate",title:"Role"},"Permission Set")]),k("th",{class:"",scope:"col"})])],-1)),uhe=["id"],dhe={"data-label":"User",scope:"row",class:"slds-align-top"},hhe={class:"slds-col slds-grid slds-grid_vertical-align-center"},phe={class:"avatar slds-grid slds-grid_vertical-align-center slds-grid_align-center slds-m-right_medium"},fhe=["src"],mhe={class:"slds-grid slds-grid_vertical"},_he=["id"],ghe=qg(()=>k("td",{"data-label":"Permission Set"},[k("div",{class:"slds-truncate",title:"Sales Planning Ops Manager"},"Sales Planning Ops Manager")],-1)),yhe={"data-label":"Remove",style:{"text-align":"right"}};function vhe(e,t,s,n,r,a){var I;const o=pe("Picklist"),d=pe("SLDSButton"),p=pe("ShareEmptyState"),y=pe("ButtonIcon"),v=pe("ConfirmSelfRemoval"),C=pe("Card");return L(),X("div",Yde,[k("div",Zde,[k("div",Xde,[k("a",{href:"#",onClick:t[0]||(t[0]=O=>e.$emit("cancel-and-back"))},"Share Branch"),Kde,Jde])]),k("div",{class:"slds-p-vertical_large slds-p-horizontal_medium",style:br({"min-height":a.managerUsers.length>0?"30rem":"initial"})},[k("div",Qde,[k("div",ehe,[the,de(o,{modelValue:(I=r.selectedUser)==null?void 0:I.Name,id:"userLookup",ref:"userLookup",options:r.userOptions,labelForId:"userLookup",labels:{name:"Add a sales plan manager",search:"Search..."},titleKey:"Name",idKey:"Id",filterable:"",onSelectedOption:t[1]||(t[1]=O=>r.selectedUser=O),onClear:t[2]||(t[2]=()=>r.selectedUser=null)},{option:je(O=>[k("div",she,[k("span",nhe,[k("span",{class:"slds-truncate",title:O.option.Name},Pe(O.option.Name),9,rhe),O.option.UserRole?(L(),X("span",ihe,Pe(O.option.UserRole.Name),1)):$e("",!0)])])]),_:1},8,["modelValue","options","labels"])]),de(d,{id:"share-branch-manager-add",class:"slds-col slds-size_1-of-12 slds-col_bump-left",style:{height:"fit-content"},label:"Add",variant:"neutral",disabled:!r.selectedUser,onClick:a.onAdd},null,8,["disabled","onClick"])]),de(C,{class:"slds-m-top_medium"},{body:je(()=>[a.managerUsers.length===0?(L(),X("div",ohe,[de(p),ahe])):(L(),X("table",lhe,[che,k("tbody",null,[(L(!0),X(Lt,null,As(a.managerUsers,O=>(L(),X("tr",{id:O.dirty?`sharedWithManager-preview-${O.name}`:`sharedWithManager-${O.name}`,key:O.dirty?`sharedWithManager-preview-${O.name}`:`sharedWithManager-${O.name}`,class:$t(["slds-hint-parent",{"slds-is-edited":O.dirty}])},[k("th",dhe,[k("div",hhe,[k("div",phe,[O.smallPhotoUrl?(L(),X("img",{key:0,class:"avatar",src:O.smallPhotoUrl},null,8,fhe)):(L(),X(Lt,{key:1},[es(Pe(O.initials),1)],64))]),k("div",mhe,[k("span",null,[k("b",null,Pe(O.name),1)]),k("span",{id:`sharedWithManager-role-${O.name}`},Pe(O.role),9,_he)])])]),ghe,k("td",yhe,[de(y,{id:`sharedWithManager-${O.name}-remove`,class:"slds-button_icon-container",assistiveText:"Remove",iconCategory:"utility",iconName:"close",title:"Remove",onClick:A=>O.id===a.currentUserId?r.removalContext=A.target:e.$emit("remove-user",O.id)},null,8,["id","onClick"])])],10,uhe))),128)),r.removalContext?(L(),Ge(v,{key:0,bindTo:r.removalContext,onConfirm:t[3]||(t[3]=O=>e.$emit("remove-user",a.currentUserId)),onClose:t[4]||(t[4]=()=>r.removalContext=null)},null,8,["bindTo"])):$e("",!0)])]))]),_:1})],4)])}const bhe=os(Wde,[["render",vhe],["__scopeId","data-v-658c16f8"]]),xhe={name:"BranchShareModal",components:{SLDSButton:Tn,ButtonIcon:vn,Picklist:Qi,Modal:zc,Spinner:Vr,BranchUsers:Gde,ManagerUsers:bhe},props:["config"],emits:["close"],data(){return{loading:!0,branchContext:null,ancestorIds:[],page:"branchUsers",nodeMap:{},availableAdminIds:this.$store.availableAdminIds,availableManagerIds:this.$store.availableManagerIds,availableStandardIds:new Set,users:[],usersCopy:[]}},computed:{modalTitle(){return this.page==="branchUsers"?`Share ${this.branchContext.Name}`:"Share Sales Plan"},changesMade(){return this.users.some(e=>e.dirty)||this.users.length!==this.usersCopy.length}},beforeMount(){this.branchContext=this.config.node},async mounted(){SPM.Components.BranchShareModal=this,await this.init(),this.loading=!1},methods:{async init(){await Promise.allSettled([this.availableStandardIds=new Set((await SPM.Utils.Apex.invoke("GetUsersWithPermissionSet",["SalesPlanning"])||[]).map(s=>s.Id)),this.nodeMap=(await SPM.Utils.Apex.invoke("Query",[`SELECT Id, Name, sfsp__Parent__r.Id, sfsp__SalesPlan__c FROM sfsp__SalesNode__c WHERE sfsp__SalesPlan__c = '${this.$store.plan.Id}'`])).reduce((s,n)=>{var r;return s[n.Id]={id:n.Id,name:n.Name,parentId:((r=n.sfsp__Parent__r)==null?void 0:r.Id)||"All Org"},s},{"All Org":{id:"All Org",name:"All Org",parentId:null}}),this.ancestorIds=await SPM.Utils.Node.getAncestorIds({nodeId:this.branchContext.Id})]);const e={};(await SPM.Utils.Apex.invoke("Query",[`SELECT Id, sfsp__User__r.Name, sfsp__User__r.UserRole.Name, sfsp__User__r.FirstName, sfsp__User__r.LastName, sfsp__User__r.SmallPhotoUrl, sfsp__AccessLevel__c, sfsp__SalesNode__r.Name FROM sfsp__SalesUserAccess__c WHERE sfsp__SalesPlan__c = '${SPM.$store.plan.Id}'`])||[]).forEach(s=>{var n,r,a,o,d;e[s.sfsp__User__c]=e[s.sfsp__User__c]||{id:s.sfsp__User__c,name:s.sfsp__User__r.Name,initials:`${((r=(n=s.sfsp__User__r)==null?void 0:n.FirstName)==null?void 0:r[0])||""}${((o=(a=s.sfsp__User__r)==null?void 0:a.LastName)==null?void 0:o[0])||""}`,role:((d=s.sfsp__User__r.UserRole)==null?void 0:d.Name)||"",smallPhotoUrl:s.sfsp__User__r.SmallPhotoUrl,accessRecords:[],dirty:!1},e[s.sfsp__User__c].accessRecords.push(s)}),this.users=Object.values(e),this.usersCopy=JSON.parse(JSON.stringify(this.users))},cancelAndBack(){this.page==="branchUsers"?this.$emit("close"):(this.users=JSON.parse(JSON.stringify(this.usersCopy)),this.page="branchUsers")},async addUser(e,t="Editor",s="All Org"){var a,o,d;if(!e.Id)return;this.loading=!0;const n={sfsp__AccessLevel__c:t,sfsp__SalesPlan__c:this.$store.plan.Id,sfsp__User__c:e.Id,sfsp__SalesNode__c:s==="All Org"?null:s,sfsp__SalesNode__r:{Name:s==="All Org"?null:this.nodeMap[s].name}},r=this.users.find(p=>p.id===e.Id);if(r){const p=await SPM.Utils.Node.getDescendantIds({planId:this.$store.plan.Id,nodeIds:[s==="All Org"?"":s]});r.accessRecords=r.accessRecords.reduce((y,v)=>(p.includes(v.sfsp__SalesNode__c||"All Org")||y.push(v),y),[n]),r.dirty=!0}else{const p={id:e.Id,name:e.Name,initials:`${((a=e==null?void 0:e.FirstName)==null?void 0:a[0])||""}${((o=e==null?void 0:e.LastName)==null?void 0:o[0])||""}`,role:((d=e.UserRole)==null?void 0:d.Name)||"",smallPhotoUrl:e.SmallPhotoUrl,accessRecords:[n],dirty:!0};this.users.unshift(p)}this.loading=!1},editUser(e){var a;const t=this.users.findIndex(o=>o.id===e),s=this.usersCopy.findIndex(o=>o.id===e),n=this.users[t].accessRecords,r=((a=this.usersCopy[s])==null?void 0:a.accessRecords)||[];r.length!==0&&(this.users[t].dirty=!r.every(o=>n.find(d=>d.Id===o.Id&&d.sfsp__AccessLevel__c===o.sfsp__AccessLevel__c&&d.sfsp__SalesNode__c===o.sfsp__SalesNode__c)),n.some(o=>!o.Id)&&(this.users[t].dirty=!0),n.length!==r.length&&(this.users[t].dirty=!0))},removeUser(e,t){const s=this.users.findIndex(r=>r.id===e),n=this.usersCopy.findIndex(r=>r.id===e);t&&(this.users[s].accessRecords.splice(this.users[s].accessRecords.findIndex(r=>(r.sfsp__SalesNode__c||"All Org")===(t.sfsp__SalesNode__c||"All Org")),1),n>-1&&(this.users[s].dirty=!this.usersCopy[n].accessRecords.every(r=>this.users[s].accessRecords.find(a=>a.Id===r.Id&&a.sfsp__AccessLevel__c===r.sfsp__AccessLevel__c&&a.sfsp__SalesNode__c===r.sfsp__SalesNode__c)),this.users[s].accessRecords.length!==this.usersCopy[n].accessRecords.length&&(this.users[s].dirty=!0)),this.users[s].accessRecords.some(r=>!r.Id)&&(this.users[s].dirty=!0),this.users[s].accessRecords.length>0)||this.users.splice(s,1)},async postChatter(e,t,s="All Org"){if(!SPM.chatterEnabled)return;let n="";switch(e){case"remove":n=`You have been removed from sales plan ${this.$store.plan.Name}.`;break;case"invite":n=`${SPM.currentUser.Name} granted you access to ${s} in sales plan {record:${this.$store.plan.Id}}.`;break;case"update":n=`${SPM.currentUser.Name} changed your access to sales plan {record:${this.$store.plan.Id}}.`;break}await SPM.Utils.Apex.invoke("PostFeedItem",[t,n])},async save(){this.loading=!0;const e=this.users.reduce((v,C)=>(v[C.name]=C,v),{}),t=this.usersCopy.reduce((v,C)=>(v[C.name]=C,v),{}),s=new Set,n=new Set,r={invite:{},remove:{},edit:{}};this.usersCopy.forEach(v=>{var I;const C=(I=e[v.name])==null?void 0:I.accessRecords;C?v.accessRecords.forEach(O=>{C.every(A=>A.Id!==O.Id)&&s.add(O)}):(r.remove[v.name]=v.accessRecords,v.accessRecords.forEach(O=>s.add(O)))}),this.users.forEach(v=>{var I;const C=((I=t[v.name])==null?void 0:I.accessRecords)||[];C.length===0?(r.invite[v.name]=v.accessRecords,v.accessRecords.forEach(O=>n.add({sobjectType:"sfsp__SalesUserAccess__c",...O}))):v.accessRecords.forEach(A=>{let P=!0;C.forEach(q=>{q.sfsp__AccessLevel__c===A.sfsp__AccessLevel__c&&q.sfsp__SalesNode__c===A.sfsp__SalesNode__c&&(P=!1)}),P&&(r.edit[v.name]=r.edit[v.name]||[],r.edit[v.name].push(A),n.add({sobjectType:"sfsp__SalesUserAccess__c",...A}))})}),await Promise.all([SPM.Utils.CRM.upsert({records:n}),SPM.Utils.Rest.invoke("Delete",{ids:Array.from(s).map(v=>v.Id)})]);const a={invitedToastMsg:"",updatedToastMsg:"",removedToastMsg:""},o=Object.keys(r.invite);if(o.length>0){o.length===1?a.invitedToastMsg=`"${o[0]}" was invited to the plan.`:a.invitedToastMsg=`(${o.length}) users were invited to the plan.`;for(const v of o){const C=r.invite[v];await SPM.Utils.Async.forEachParallel(C,async A=>{var P;await this.postChatter("invite",A.sfsp__User__c,((P=A.sfsp__SalesNode__r)==null?void 0:P.Name)||"All Org")},5);const O=C.map(A=>{var P;return`Added ${v} as ${A.sfsp__AccessLevel__c} to ${((P=A.sfsp__SalesNode__r)==null?void 0:P.Name)||"All Org"}`}).map(A=>({description:A,name:this.$store.plan.Name,parentId:this.$store.plan.Id,recordType:og.PLAN,subtype:ma.CREATE,type:mh.SHARING}));await pm(O)}await SPM.Utils.Async.forEachParallel(Object.values(o),async v=>{await this.$store.savePreferences(v.id)},5)}const d=Object.keys(r.edit);d.length>0&&(d.length===1?a.updatedToastMsg=`Access for "${d[0]}" was updated.`:a.updatedToastMsg=`Access was updated for (${d.length}) users.`,await SPM.Utils.Async.forEachParallel(d,async v=>{await this.postChatter("update",r.edit[v][0].sfsp__User__c);const O=r.edit[v].map(A=>{var P;return`Changed ${v}'s access to ${((P=A.sfsp__SalesNode__r)==null?void 0:P.Name)||"All Org"}`}).map(A=>({description:A,name:this.$store.plan.Name,parentId:this.$store.plan.Id,recordType:og.PLAN,subtype:ma.UPDATE,type:mh.SHARING}));await pm(O)},5),await SPM.Utils.Async.forEachParallel(Object.values(d),async v=>{await this.$store.savePreferences(v.id)},5));const p=Object.keys(r.remove);p.length>0&&(p.length===1?a.removedToastMsg=`"${p[0]}" was removed from the plan.`:a.removedToastMsg=`(${p.length}) users were removed from the plan.`,await SPM.Utils.Async.forEachParallel(p,async v=>{await this.postChatter("remove",r.remove[v][0].sfsp__User__c);const O=r.remove[v].map(A=>{var P;return`Removed ${A.sfsp__User__r.Name}'s access to ${((P=A.sfsp__SalesNode__r)==null?void 0:P.Name)||"All Org"}`}).map(A=>({description:A,name:this.$store.plan.Name,parentId:this.$store.plan.Id,recordType:og.PLAN,subtype:ma.DELETE,type:mh.SHARING}));await pm(O)},5));const y=[];if(Object.keys(e).length)for(const v in e){const C=e[v];for(const I of C.accessRecords)!this.availableAdminIds.has(C.id)&&!this.availableManagerIds.has(C.id)&&y.push({name:C.name,userId:I.sfsp__User__c,nodeId:I.sfsp__SalesNode__c||"All Org"})}this.config.callback({...a,sharedWithRecords:y}),r.remove[SPM.currentUser.Name]?window.location.reload():(this.$emit("close"),this.loading=!1)}}},whe={class:"slds-grid"},She={class:"slds-col_bump-left"};function Che(e,t,s,n,r,a){const o=pe("Spinner"),d=pe("ManagerUsers"),p=pe("BranchUsers"),y=pe("SLDSButton"),v=pe("Modal");return L(),Ge(v,{id:"share-branch",ref:"modal",title:a.modalTitle,size:"medium",detach:"",onClose:t[1]||(t[1]=C=>r.loading?()=>{}:e.$emit("close"))},{content:je(()=>[r.loading?(L(),Ge(o,{key:0})):$e("",!0),r.page==="managerUsers"?(L(),Ge(d,{key:1,users:r.users,availableAdminIds:r.availableAdminIds,availableManagerIds:r.availableManagerIds,onAddUser:a.addUser,onRemoveUser:a.removeUser,onCancelAndBack:a.cancelAndBack},null,8,["users","availableAdminIds","availableManagerIds","onAddUser","onRemoveUser","onCancelAndBack"])):r.page==="branchUsers"?(L(),Ge(p,{key:2,users:r.users,availableAdminIds:r.availableAdminIds,availableManagerIds:r.availableManagerIds,availableStandardIds:r.availableStandardIds,ancestorIds:r.ancestorIds,branchContext:r.branchContext,onAddUser:a.addUser,onRemoveUser:a.removeUser,onEditUser:a.editUser,onChangePage:t[0]||(t[0]=C=>r.page=C)},null,8,["users","availableAdminIds","availableManagerIds","availableStandardIds","ancestorIds","branchContext","onAddUser","onRemoveUser","onEditUser"])):$e("",!0)]),footer:je(()=>[k("div",null,[k("div",whe,[k("div",She,[de(y,{class:"slds-button slds-button_neutral",disabled:r.loading,onClick:a.cancelAndBack},{default:je(()=>[es(Pe(r.page==="branchUsers"?"Cancel":"Cancel & Back"),1)]),_:1},8,["disabled","onClick"]),de(y,{class:"slds-button slds-button_brand",disabled:!a.changesMade||r.loading,onClick:a.save},{default:je(()=>[es("Save")]),_:1},8,["disabled","onClick"])])])])]),_:1},8,["title"])}const Ihe=os(xhe,[["render",Che],["__scopeId","data-v-fb75cafb"]]);function Ub(e){return typeof e=="function"}function M2(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}function Fx(e){return Ub(e.$validator)?Object.assign({},e):{$validator:e}}function j$(e){return typeof e=="object"?e.$valid:e}function q$(e){return e.$validator||e}function The(e,t){if(!M2(e))throw new Error(`[@vuelidate/validators]: First parameter to "withParams" should be an object, provided ${typeof e}`);if(!M2(t)&&!Ub(t))throw new Error("[@vuelidate/validators]: Validator must be a function or object with $validator parameter");const s=Fx(t);return s.$params=Object.assign({},s.$params||{},e),s}function Ahe(e,t){if(!Ub(e)&&typeof ir(e)!="string")throw new Error(`[@vuelidate/validators]: First parameter to "withMessage" should be string or a function returning a string, provided ${typeof e}`);if(!M2(t)&&!Ub(t))throw new Error("[@vuelidate/validators]: Validator must be a function or object with $validator parameter");const s=Fx(t);return s.$message=e,s}function Mhe(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const s=Fx(e);return Object.assign({},s,{$async:!0,$watchTargets:t})}function Ehe(e){return{$validator(t){for(var s=arguments.length,n=new Array(s>1?s-1:0),r=1;r<s;r++)n[r-1]=arguments[r];return ir(t).reduce((a,o,d)=>{const p=Object.entries(o).reduce((y,v)=>{let[C,I]=v;const O=e[C]||{},A=Object.entries(O).reduce((P,q)=>{let[ce,re]=q;const Ce=q$(re).call(this,I,o,d,...n),te=j$(Ce);if(P.$data[ce]=Ce,P.$data.$invalid=!te||!!P.$data.$invalid,P.$data.$error=P.$data.$invalid,!te){let oe=re.$message||"";const ve=re.$params||{};typeof oe=="function"&&(oe=oe({$pending:!1,$invalid:!te,$params:ve,$model:I,$response:Ce})),P.$errors.push({$property:C,$message:oe,$params:ve,$response:Ce,$model:I,$pending:!1,$validator:ce})}return{$valid:P.$valid&&te,$data:P.$data,$errors:P.$errors}},{$valid:!0,$data:{},$errors:[]});return y.$data[C]=A.$data,y.$errors[C]=A.$errors,{$valid:y.$valid&&A.$valid,$data:y.$data,$errors:y.$errors}},{$valid:!0,$data:{},$errors:{}});return{$valid:a.$valid&&p.$valid,$data:a.$data.concat(p.$data),$errors:a.$errors.concat(p.$errors)}},{$valid:!0,$data:[],$errors:[]})},$message:t=>{let{$response:s}=t;return s?s.$errors.map(n=>Object.values(n).map(r=>r.map(a=>a.$message)).reduce((r,a)=>r.concat(a),[])):[]}}}const kI=e=>{if(e=ir(e),Array.isArray(e))return!!e.length;if(e==null)return!1;if(e===!1)return!0;if(e instanceof Date)return!isNaN(e.getTime());if(typeof e=="object"){for(let t in e)return!0;return!1}return!!String(e).length},khe=e=>(e=ir(e),Array.isArray(e)?e.length:typeof e=="object"?Object.keys(e).length:String(e).length);function sf(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return n=>(n=ir(n),!kI(n)||t.every(r=>r.test(n)))}var Y_=Object.freeze({__proto__:null,withParams:The,withMessage:Ahe,withAsync:Mhe,forEach:Ehe,req:kI,len:khe,regex:sf,unwrap:ir,unwrapNormalizedValidator:q$,unwrapValidatorResponse:j$,normalizeValidatorObject:Fx});sf(/^[a-zA-Z]*$/);sf(/^[a-zA-Z0-9]*$/);sf(/^\d*(\.\d+)?$/);const Phe=/^(?:[A-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[A-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9]{2,}(?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i;sf(Phe);function Rhe(e){return typeof e=="string"&&(e=e.trim()),kI(e)}var xM={$validator:Rhe,$message:"Value is required",$params:{type:"required"}};const $he=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u00a1-\uffff][a-z0-9\u00a1-\uffff_-]{0,62})?[a-z0-9\u00a1-\uffff]\.)+(?:[a-z\u00a1-\uffff]{2,}\.?))(?::\d{2,5})?(?:[/?#]\S*)?$/i;sf($he);sf(/(^[0-9]*$)|(^-[0-9]+$)/);sf(/^[-]?\d*(\.\d+)?$/);function wM(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Object.keys(e).reduce((s,n)=>(t.includes(n)||(s[n]=ir(e[n])),s),{})}function Vb(e){return typeof e=="function"}function Ohe(e){return hh(e)||Sm(e)}function H$(e,t,s){let n=e;const r=t.split(".");for(let a=0;a<r.length;a++){if(!n[r[a]])return s;n=n[r[a]]}return n}function fS(e,t,s){return ri(()=>e.some(n=>H$(t,n,{[s]:!1})[s]))}function SM(e,t,s){return ri(()=>e.reduce((n,r)=>{const a=H$(t,r,{[s]:!1})[s]||[];return n.concat(a)},[]))}function G$(e,t,s,n){return e.call(n,ir(t),ir(s),n)}function W$(e){return e.$valid!==void 0?!e.$valid:!e}function Lhe(e,t,s,n,r,a,o){let{$lazy:d,$rewardEarly:p}=r,y=arguments.length>7&&arguments[7]!==void 0?arguments[7]:[],v=arguments.length>8?arguments[8]:void 0,C=arguments.length>9?arguments[9]:void 0,I=arguments.length>10?arguments[10]:void 0;const O=Nl(!!n.value),A=Nl(0);s.value=!1;const P=ph([t,n].concat(y,I),()=>{if(d&&!n.value||p&&!C.value&&!s.value)return;let q;try{q=G$(e,t,v,o)}catch(ce){q=Promise.reject(ce)}A.value++,s.value=!!A.value,O.value=!1,Promise.resolve(q).then(ce=>{A.value--,s.value=!!A.value,a.value=ce,O.value=W$(ce)}).catch(ce=>{A.value--,s.value=!!A.value,a.value=ce,O.value=!0})},{immediate:!0,deep:typeof t=="object"});return{$invalid:O,$unwatch:P}}function Nhe(e,t,s,n,r,a,o,d){let{$lazy:p,$rewardEarly:y}=n;const v=()=>({}),C=ri(()=>{if(p&&!s.value||y&&!d.value)return!1;let I=!0;try{const O=G$(e,t,o,a);r.value=O,I=W$(O)}catch(O){r.value=O}return I});return{$unwatch:v,$invalid:C}}function Dhe(e,t,s,n,r,a,o,d,p,y,v){const C=Nl(!1),I=e.$params||{},O=Nl(null);let A,P;e.$async?{$invalid:A,$unwatch:P}=Lhe(e.$validator,t,C,s,n,O,r,e.$watchTargets,p,y,v):{$invalid:A,$unwatch:P}=Nhe(e.$validator,t,s,n,O,r,p,y);const q=e.$message;return{$message:Vb(q)?ri(()=>q(wM({$pending:C,$invalid:A,$params:wM(I),$model:t,$response:O,$validator:a,$propertyPath:d,$property:o}))):q||"",$params:I,$pending:C,$invalid:A,$response:O,$unwatch:P}}function Bhe(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=ir(e),s=Object.keys(t),n={},r={},a={};let o=null;return s.forEach(d=>{const p=t[d];switch(!0){case Vb(p.$validator):n[d]=p;break;case Vb(p):n[d]={$validator:p};break;case d==="$validationGroups":o=p;break;case d.startsWith("$"):a[d]=p;break;default:r[d]=p}}),{rules:n,nestedValidators:r,config:a,validationGroups:o}}function Fhe(){}const zhe="__root";function Y$(e,t,s){if(s)return t?t(e()):e();try{var n=Promise.resolve(e());return t?n.then(t):n}catch(r){return Promise.reject(r)}}function Uhe(e,t){return Y$(e,Fhe,t)}function Vhe(e,t){var s=e();return s&&s.then?s.then(t):t(s)}function jhe(e){return function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];try{return Promise.resolve(e.apply(this,t))}catch(n){return Promise.reject(n)}}}function qhe(e,t,s,n,r,a,o,d,p){const y=Object.keys(e),v=n.get(r,e),C=Nl(!1),I=Nl(!1),O=Nl(0);if(v){if(!v.$partial)return v;v.$unwatch(),C.value=v.$dirty.value}const A={$dirty:C,$path:r,$touch:()=>{C.value||(C.value=!0)},$reset:()=>{C.value&&(C.value=!1)},$commit:()=>{}};return y.length?(y.forEach(P=>{A[P]=Dhe(e[P],t,A.$dirty,a,o,P,s,r,p,I,O)}),A.$externalResults=ri(()=>d.value?[].concat(d.value).map((P,q)=>({$propertyPath:r,$property:s,$validator:"$externalResults",$uid:`${r}-externalResult-${q}`,$message:P,$params:{},$response:null,$pending:!1})):[]),A.$invalid=ri(()=>{const P=y.some(q=>ir(A[q].$invalid));return I.value=P,!!A.$externalResults.value.length||P}),A.$pending=ri(()=>y.some(P=>ir(A[P].$pending))),A.$error=ri(()=>A.$dirty.value?A.$pending.value||A.$invalid.value:!1),A.$silentErrors=ri(()=>y.filter(P=>ir(A[P].$invalid)).map(P=>{const q=A[P];return Em({$propertyPath:r,$property:s,$validator:P,$uid:`${r}-${P}`,$message:q.$message,$params:q.$params,$response:q.$response,$pending:q.$pending})}).concat(A.$externalResults.value)),A.$errors=ri(()=>A.$dirty.value?A.$silentErrors.value:[]),A.$unwatch=()=>y.forEach(P=>{A[P].$unwatch()}),A.$commit=()=>{I.value=!0,O.value=Date.now()},n.set(r,e,A),A):(v&&n.set(r,e,A),A)}function Hhe(e,t,s,n,r,a,o){const d=Object.keys(e);return d.length?d.reduce((p,y)=>(p[y]=E2({validations:e[y],state:t,key:y,parentKey:s,resultsCache:n,globalConfig:r,instance:a,externalResults:o}),p),{}):{}}function Ghe(e,t,s){const n=ri(()=>[t,s].filter(A=>A).reduce((A,P)=>A.concat(Object.values(ir(P))),[])),r=ri({get(){return e.$dirty.value||(n.value.length?n.value.every(A=>A.$dirty):!1)},set(A){e.$dirty.value=A}}),a=ri(()=>{const A=ir(e.$silentErrors)||[],P=n.value.filter(q=>(ir(q).$silentErrors||[]).length).reduce((q,ce)=>q.concat(...ce.$silentErrors),[]);return A.concat(P)}),o=ri(()=>{const A=ir(e.$errors)||[],P=n.value.filter(q=>(ir(q).$errors||[]).length).reduce((q,ce)=>q.concat(...ce.$errors),[]);return A.concat(P)}),d=ri(()=>n.value.some(A=>A.$invalid)||ir(e.$invalid)||!1),p=ri(()=>n.value.some(A=>ir(A.$pending))||ir(e.$pending)||!1),y=ri(()=>n.value.some(A=>A.$dirty)||n.value.some(A=>A.$anyDirty)||r.value),v=ri(()=>r.value?p.value||d.value:!1),C=()=>{e.$touch(),n.value.forEach(A=>{A.$touch()})},I=()=>{e.$commit(),n.value.forEach(A=>{A.$commit()})},O=()=>{e.$reset(),n.value.forEach(A=>{A.$reset()})};return n.value.length&&n.value.every(A=>A.$dirty)&&C(),{$dirty:r,$errors:o,$invalid:d,$anyDirty:y,$error:v,$pending:p,$touch:C,$reset:O,$silentErrors:a,$commit:I}}function E2(e){const t=jhe(function(){return Me(),Vhe(function(){if(q.$rewardEarly)return Rt(),Uhe(cb)},function(){return Y$(cb,function(){return new Promise(G=>{if(!Qe.value)return G(!ne.value);const Y=ph(Qe,()=>{G(!ne.value),Y()})})})})});let{validations:s,state:n,key:r,parentKey:a,childResults:o,resultsCache:d,globalConfig:p={},instance:y,externalResults:v}=e;const C=a?`${a}.${r}`:r,{rules:I,nestedValidators:O,config:A,validationGroups:P}=Bhe(s),q=Object.assign({},p,A),ce=r?ri(()=>{const G=ir(n);return G?ir(G[r]):void 0}):n,re=Object.assign({},ir(v)||{}),W=ri(()=>{const G=ir(v);return r?G?ir(G[r]):void 0:G}),Ce=qhe(I,ce,r,d,C,q,y,W,n),te=Hhe(O,ce,C,d,q,y,W),oe={};P&&Object.entries(P).forEach(G=>{let[Y,J]=G;oe[Y]={$invalid:fS(J,te,"$invalid"),$error:fS(J,te,"$error"),$pending:fS(J,te,"$pending"),$errors:SM(J,te,"$errors"),$silentErrors:SM(J,te,"$silentErrors")}});const{$dirty:ve,$errors:ee,$invalid:ne,$anyDirty:Se,$error:Ue,$pending:Qe,$touch:Me,$reset:vt,$silentErrors:Ut,$commit:Rt}=Ghe(Ce,te,o),_t=r?ri({get:()=>ir(ce),set:G=>{ve.value=!0;const Y=ir(n),J=ir(v);J&&(J[r]=re[r]),yi(Y[r])?Y[r].value=G:Y[r]=G}}):null;r&&q.$autoDirty&&ph(ce,()=>{ve.value||Me();const G=ir(v);G&&(G[r]=re[r])},{flush:"sync"});function F(G){return(o.value||{})[G]}function j(){yi(v)?v.value=re:Object.keys(re).length===0?Object.keys(v).forEach(G=>{delete v[G]}):Object.assign(v,re)}return Em(Object.assign({},Ce,{$model:_t,$dirty:ve,$error:Ue,$errors:ee,$invalid:ne,$anyDirty:Se,$pending:Qe,$touch:Me,$reset:vt,$path:C||zhe,$silentErrors:Ut,$validate:t,$commit:Rt},o&&{$getResultsForChild:F,$clearExternalResults:j,$validationGroups:oe},te))}class Whe{constructor(){this.storage=new Map}set(t,s,n){this.storage.set(t,{rules:s,result:n})}checkRulesValidity(t,s,n){const r=Object.keys(n),a=Object.keys(s);return a.length!==r.length||!a.every(d=>r.includes(d))?!1:a.every(d=>s[d].$params?Object.keys(s[d].$params).every(p=>ir(n[d].$params[p])===ir(s[d].$params[p])):!0)}get(t,s){const n=this.storage.get(t);if(!n)return;const{rules:r,result:a}=n,o=this.checkRulesValidity(t,s,r),d=a.$unwatch?a.$unwatch:()=>({});return o?a:{$dirty:a.$dirty,$partial:!0,$unwatch:d}}}const nb={COLLECT_ALL:!0,COLLECT_NONE:!1},CM=Symbol("vuelidate#injectChildResults"),IM=Symbol("vuelidate#removeChildResults");function Yhe(e){let{$scope:t,instance:s}=e;const n={},r=Nl([]),a=ri(()=>r.value.reduce((v,C)=>(v[C]=ir(n[C]),v),{}));function o(v,C){let{$registerAs:I,$scope:O,$stopPropagation:A}=C;A||t===nb.COLLECT_NONE||O===nb.COLLECT_NONE||t!==nb.COLLECT_ALL&&t!==O||(n[I]=v,r.value.push(I))}s.__vuelidateInjectInstances=[].concat(s.__vuelidateInjectInstances||[],o);function d(v){r.value=r.value.filter(C=>C!==v),delete n[v]}s.__vuelidateRemoveInstances=[].concat(s.__vuelidateRemoveInstances||[],d);const p=dm(CM,[]);bS(CM,s.__vuelidateInjectInstances);const y=dm(IM,[]);return bS(IM,s.__vuelidateRemoveInstances),{childResults:a,sendValidationResultsToParent:p,removeValidationResultsFromParent:y}}function Z$(e){return new Proxy(e,{get(t,s){return typeof t[s]=="object"?Z$(t[s]):ri(()=>t[s])}})}let TM=0;function Zhe(e,t){var s;let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};arguments.length===1&&(n=e,e=void 0,t=void 0);let{$registerAs:r,$scope:a=nb.COLLECT_ALL,$stopPropagation:o,$externalResults:d,currentVueInstance:p}=n;const y=p||((s=qv())===null||s===void 0?void 0:s.proxy),v=y?y.$options:{};r||(TM+=1,r=`_vuelidate_${TM}`);const C=Nl({}),I=new Whe,{childResults:O,sendValidationResultsToParent:A,removeValidationResultsFromParent:P}=y?Yhe({$scope:a,instance:y}):{childResults:Nl({})};if(!e&&v.validations){const q=v.validations;t=Nl({}),uE(()=>{t.value=y,ph(()=>Vb(q)?q.call(t.value,new Z$(t.value)):q,ce=>{C.value=E2({validations:ce,state:t,childResults:O,resultsCache:I,globalConfig:n,instance:y,externalResults:d||y.vuelidateExternalResults})},{immediate:!0})}),n=v.validationsConfig||n}else{const q=yi(e)||Ohe(e)?e:Em(e||{});ph(q,ce=>{C.value=E2({validations:ce,state:t,childResults:O,resultsCache:I,globalConfig:n,instance:y!=null?y:{},externalResults:d})},{immediate:!0})}return y&&(A.forEach(q=>q(C,{$registerAs:r,$scope:a,$stopPropagation:o})),G2(()=>P.forEach(q=>q(r)))),ri(()=>Object.assign({},ir(C.value),O.value))}const AM=e=>{const t=Number(e);return Number.isNaN(t)||t<0?!1:t-Math.floor(t)!==0?t.toString().split(".")[1].length===1:!0},Xhe={name:"EditPeriodDistributionModal",components:{Button:Tn,RadioGroup:pj,TextInput:Ko,Icon:yn,Modal:zc,Spinner:Vr,Toasts:MP},props:["config"],data(){return{v$:Zhe(),loadingMsg:"",period:"quarter",periodOptions:[{label:"Quarter",value:"quarter"},{label:"Month",value:"month"}],distribution:[{months:[],percent:25,label:"Qaurter 1"},{months:[],percent:25,label:"Qaurter 2"},{months:[],percent:25,label:"Qaurter 3"},{months:[],percent:25,label:"Qaurter 4"}],debounceTimeout:null,errorToast:[]}},validations(){return{distribution:{$each:Y_.forEach({previewPercent:{required:Y_.withMessage("Percentage is required",xM),integer:Y_.withMessage("Percent must be a positive number with max 1 decimal",AM)},months:{$each:Y_.forEach({previewPercent:{required:Y_.withMessage("Percentage is required",xM),integer:Y_.withMessage("Percent must be a positive number with max 1 decimal",AM)}})}})}}},computed:{totalPercent(){let e=0;return this.distribution.forEach(t=>{e+=Number(t.previewPercent)}),Math.round(e*10)/10},periodModalIsInvalid(){return this.v$.$invalid||this.totalPercent!==100}},created(){this.config.distribution?this.distribution=JSON.parse(JSON.stringify(this.config.distribution)):this.distribution=SPM.Utils.Allocation.generateAllocationDistributionTable(),this.distribution.forEach(e=>{e.previewPercent=e.percent;const{months:t}=e;t.forEach(s=>{s.previewPercent=s.percent})})},methods:{getVuelidateErrorFromCollection(e){const t=[];return Array.isArray(e)&&e.length>0&&e.forEach(s=>{t.push(s.$message)}),t},async calculateMonths(e){const{months:t}=e;if(this.period==="quarter"){const s=e.previewPercent,n=Math.round(s/3*10)/10;for(let r=0;r<t.length-1;r++)e.months[r].previewPercent=Number(n);e.months[t.length-1].previewPercent=Number(Math.round((n+(s-n*3))*10)/10)}else{let s=0;for(let n=0;n<t.length;n++)s+=Number(e.months[n].previewPercent);e.previewPercent=Number(Math.round(s*10)/10)}},debouncePeriodCalculations(e,t){this.debounceTimeout!==null&&clearTimeout(this.debounceTimeout),this.debounceTimeout=setTimeout(()=>{this.debounceTimeout=null,this.calculateMonths(e,t)},250)},async save(){if(this.v$.$invalid){this.v$.$touch();return}this.config.callback(this.distribution),await this.$nextTick(),this.loadingMsg="",this.$emit("close")}}},Khe=e=>(Nr("data-v-beffb1b6"),e=e(),Dr(),e),Jhe={class:"slds-grid slds-grid_vertical box-group"},Qhe=Khe(()=>k("div",{style:{background:"#F3F3F3"},class:"slds-grid slds-border_bottom"},[k("div",{class:"slds-col slds-size_1-of-2 slds-border_right slds-p-vertical_xx-small slds-p-horizontal_small slds-text-title_bold"},"Quarter"),k("div",{class:"slds-col slds-size_1-of-2 slds-p-vertical_xx-small slds-p-horizontal_small slds-text-title_bold"},"Month")],-1)),epe={class:"slds-grid"},tpe={class:"slds-col slds-size_1-of-2 slds-grid slds-p-horizontal_small slds-grid_vertical-align-center slds-border_right slds-border_bottom",style:{"margin-bottom":"-1px"}},spe={class:"slds-col"},npe={class:"slds-col slds-size_1-of-2 slds-border_bottom slds-p-horizontal_small",style:{"margin-bottom":"-1px"}},rpe={class:"slds-col"},ipe={key:0},ope={class:"slds-col slds-col_bump-left slds-grid slds-grid_vertical-align-center"},ape={class:"slds-col slds-p-right_large slds-text-title_bold"},lpe={class:"slds-grid"},cpe={class:"slds-col_bump-left"};function upe(e,t,s,n,r,a){const o=pe("Spinner"),d=pe("RadioGroup"),p=pe("TextInput"),y=pe("Icon"),v=pe("Button"),C=pe("Modal");return L(),Ge(C,{id:"update-time-period",ref:"modal",title:"Update Distributions",size:"small",detach:"",onClose:t[2]||(t[2]=I=>e.$emit("close"))},{content:je(()=>[r.loadingMsg?(L(),Ge(o,{key:0},{description:je(()=>[k("div",null,Pe(r.loadingMsg),1)]),_:1})):$e("",!0),de(d,{id:"time-period-options",modelValue:r.period,"onUpdate:modelValue":t[0]||(t[0]=I=>r.period=I),options:r.periodOptions,labels:{name:"Time Period"},class:"slds-grid slds-grid_align-end distribution-radio-group slds-m-bottom_small"},null,8,["modelValue","options"]),k("div",Jhe,[Qhe,(L(!0),X(Lt,null,As(r.distribution,(I,O)=>(L(),X("div",{key:`quarter__${O}`,class:"slds-col"},[k("div",epe,[k("div",tpe,[k("div",spe,Pe(I.label),1),de(p,{id:`${I.label.replaceAll(" ","-").toLowerCase()}-input`,modelValue:I.previewPercent,"onUpdate:modelValue":A=>I.previewPercent=A,labels:{name:""},readonly:r.period!=="quarter",class:$t(["slds-col_bump-right",{disabled:r.period!=="quarter","percent-preview":Number(I.percent)!==Number(I.previewPercent)}]),style:{width:"110px"},fixedTextRight:"%",type:r.period==="quarter"?"number":"",errors:a.getVuelidateErrorFromCollection(r.v$.distribution.$each.$response.$errors[O].previewPercent),onInput:A=>a.debouncePeriodCalculations(I)},null,8,["id","modelValue","onUpdate:modelValue","readonly","class","type","errors","onInput"])]),k("div",npe,[(L(!0),X(Lt,null,As(I.months,(A,P)=>(L(),X("div",{key:A.id,class:$t(["slds-grid slds-grid_vertical-align-center slds-p-vertical_xx-small",{"slds-border_bottom":P!==2}])},[k("div",rpe,Pe(A.label),1),de(p,{id:`${A.label.replaceAll(" ","-").toLowerCase()}-input`,modelValue:A.previewPercent,"onUpdate:modelValue":q=>A.previewPercent=q,labels:{name:""},readonly:r.period!=="month",class:$t(["slds-col_bump-right",{disabled:r.period!=="month","percent-preview":Number(A.percent)!==Number(A.previewPercent)}]),type:r.period==="month"?"number":"",fixedTextRight:"%",style:{width:"110px"},errors:a.getVuelidateErrorFromCollection(r.v$.distribution.$each.$response.$data[O].months.$each.$errors[P].previewPercent),onInput:q=>a.debouncePeriodCalculations(I)},null,8,["id","modelValue","onUpdate:modelValue","readonly","class","type","errors","onInput"])],2))),128))])])]))),128))]),k("div",{class:$t(["slds-grid slds-grid_align-end slds-grid_vertical-align-center slds-p-top_medium",{"slds-text-color_error":a.totalPercent!=100}])},[a.totalPercent!=100?(L(),X("div",ipe,"Adjust amounts to total 100%.")):$e("",!0),k("div",ope,[a.totalPercent!=100?(L(),Ge(y,{key:0,category:"utility",name:"error",class:"slds-col slds-m-right_x-small",size:"small",variant:"error"})):$e("",!0),k("div",ape,"Total "+Pe(a.totalPercent)+"%",1)])],2)]),footer:je(()=>[k("div",null,[k("div",lpe,[k("div",cpe,[de(v,{class:"slds-button slds-button_neutral",onClick:t[1]||(t[1]=I=>e.$emit("close"))},{default:je(()=>[es("Cancel")]),_:1}),de(v,{class:"slds-button slds-button_brand",disabled:a.periodModalIsInvalid,onClick:a.save},{default:je(()=>[es("Save")]),_:1},8,["disabled","onClick"])])])])]),_:1},512)}const dpe=os(Xhe,[["render",upe],["__scopeId","data-v-beffb1b6"]]),hpe={name:"Alert",components:{SLDSButton:Tn,ButtonIcon:vn,Spinner:Vr,Icon:yn},props:{assistiveText:{type:String,required:!0,validator:e=>{const t=["info","warning","error","offline"],s=!e||t.includes(e);return s||console.error(`Valid variant prop values are ${t.join(", ")}`),s}},alertText:{type:String,required:!0},alertLink:{type:String,default:"Tell me more."},title:{type:String,default:"User Notification"}},emits:["close"],data(){return{classes:["slds-notify","slds-notify_alert"],showSpinner:!0}},computed:{alertSymbol(){return this.$props.assistiveText==="info"?"user":this.$props.assistiveText},alertClasses(){return this.$props.assistiveText!=="info"&&this.classes.push(`slds-alert_${this.$props.assistiveText}`),this.classes.push("slds-is-relative"),this.classes},alertTitle(){const e=this.$props.assistiveText;return`User ${e.charAt(0).toUpperCase()+e.slice(1)} Notification`}},methods:{loadPlanUpdateModal(){SPM.Components.Root.openModal("planningElementsUpdate",{title:"Updates to Sales Plan",planId:this.$store.plan.Id})}}},ppe={class:"slds-assistive-text"},fpe=["title"];function mpe(e,t,s,n,r,a){const o=pe("Spinner"),d=pe("Icon");return L(),X("div",{class:$t(a.alertClasses),role:"alert"},[k("span",ppe,Pe(e.$props.assistiveText),1),k("span",{class:"slds-icon_container slds-icon-utility-user slds-m-right_medium",title:a.alertTitle},[r.showSpinner?(L(),Ge(o,{key:0,size:"x-small",theme:"inverse",withoutContainer:"",class:"slds-is-relative"})):(L(),Ge(d,{key:1,name:"user",category:"utility",size:"x-small",iconClass:"slds-icon",assistiveText:e.$props.assistiveText,variant:"inverse"},null,8,["assistiveText"]))],8,fpe),k("h2",null,[es(Pe(e.$props.alertText)+" ",1),s.alertLink?(L(),X("a",{key:0,onClick:t[0]||(t[0]=(...p)=>a.loadPlanUpdateModal&&a.loadPlanUpdateModal(...p))},Pe(s.alertLink),1)):$e("",!0)])],2)}const _pe=os(hpe,[["render",mpe]]),gpe={name:"PlanningElementsUpdate",components:{SLDSButton:Tn,DataTable:Rm,Spinner:Vr,Modal:zc},props:["config"],emits:["close"],data(){return{columns:[{name:"Element Name",id:"name"},{name:"Type",id:"type"},{name:"Status",id:"status"},{name:"Details",id:"details"}],rows:[],loadingMsg:""}},watch:{"$store.salesAsyncJobs":{async handler(){this.refreshTable()},deep:!0},"$store.assignmentObjects":{async handler(){this.refreshTable()},deep:!0}},async mounted(){this.refreshTable()},methods:{refreshTable(){this.loadingMsg="Checking for Planning Element Updates...",this.rows=[],this.$store.assignmentObjects.forEach(e=>{var t;if(e.asyncJob.status!=="Success"||!((t=e.recordsDataset)!=null&&t.dimensions)||e.assignmentsDataset.dataflowStatus!==""&&e.recordsDataset.dataflowStatus!==""){const s=this.rows.find(o=>o.id===e.id&&o.format==="status"),n=this.rows.find(o=>o.id===e.id&&o.format==="details"),r=e.assignmentsDataset.dataflowStatus&&e.recordsDataset.dataflowStatus?e.recordsDataset.dataflowStatus:e.asyncJob.status,a=e.assignmentsDataset.dataflowStatus&&e.recordsDataset.dataflowStatus?`${e.recordsDataset.dataflowStatus} Dataflow Job...`:e.asyncJob.details;s&&n?(s.state="loading",n.state="loading",s.value=r,n.value=a,s.state="loaded",n.state="loaded"):this.rows.push({data:[{id:e.id,value:e.label,type:"custom",state:"loaded",format:"name",loaded:!0},{id:e.id,value:e.asyncJob.type,type:"custom",state:"loaded",format:"type",loaded:!0},{id:e.id,value:r,type:"custom",state:"loaded",format:"status",loaded:!0},{id:e.id,value:a,type:"custom",state:"loaded",format:"details",loaded:!0}]})}else{const s=this.rows.filter(n=>n.id===e.id);if(s.length>0){const n=this.rows.findIndex(r=>r.id===e.id);this.rows=this.rows.toSpliced(s.length,n)}this.$store.salesAsyncJobs.length>0&&this.$store.salesAsyncJobs.some(n=>n.sfsp__SalesAssignmentObject__c===e.id)&&this.$store.salesAsyncJobs.filter(n=>n.sfsp__SalesAssignmentObject__c===e.id).forEach(n=>{this.rows.push({data:[{id:n.Id,value:e.label,type:"custom",state:"loaded",format:"name",loaded:!0},{id:n.Id,value:n.sfsp__Type__c,type:"custom",state:"loaded",format:"type",loaded:!0},{id:n.Id,value:n.sfsp__Status__c,type:"custom",state:"loaded",format:"status",loaded:!0},{id:n.Id,value:`${n.Name}-${n.Id}`,type:"custom",state:"loaded",format:"details",loaded:!0}]})})}}),this.loadingMsg=""}}},ype=e=>(Nr("data-v-f5cc7f87"),e=e(),Dr(),e),vpe={key:0},bpe={class:"slds-grid slds-grid_vertical slds-align_absolute-center slds-m-vertical_large",style:{"min-height":"6.5rem"}},xpe={key:1,style:{"min-height":"6.5rem"}},wpe={key:0,class:"slds-grid slds-grid_vertical-align-center"},Spe={key:1},Cpe={key:1,class:"slds-grid slds-grid_vertical-align-center"},Ipe={key:1},Tpe={key:2,class:"slds-grid slds-grid_vertical-align-center"},Ape={key:1},Mpe={key:3,class:"slds-grid slds-grid_vertical-align-center"},Epe={key:1},kpe={key:1,class:"slds-grid slds-grid_vertical slds-align_absolute-center slds-m-vertical_medium",style:{"min-height":"6.5rem"}},Ppe=ype(()=>k("div",{class:"slds-text-heading_small slds-m-bottom_xx-small"},"No planning element updates.",-1)),Rpe=[Ppe],$pe={class:"slds-grid"},Ope={class:"slds-col_bump-left"};function Lpe(e,t,s,n,r,a){const o=pe("Spinner"),d=pe("DataTable"),p=pe("SLDSButton"),y=pe("Modal");return L(),Ge(y,{title:e.$props.config.title,size:"small",class:$t({"no-padding":!0}),onClose:t[1]||(t[1]=v=>e.$emit("close"))},{content:je(()=>[r.loadingMsg?(L(),X("div",vpe,[k("div",bpe,[r.loadingMsg?(L(),Ge(o,{key:0},{description:je(()=>[es(Pe(r.loadingMsg),1)]),_:1})):$e("",!0)])])):(L(),X("div",xpe,[r.rows.length>0?(L(),Ge(d,{key:0,columns:r.columns,rows:r.rows,bordered:""},{cell:je(v=>[v.data.format==="name"?(L(),X("div",wpe,[v.data.state==="loading"?(L(),Ge(o,{key:0,size:"x-small",style:{"z-index":"1","background-color":"unset"}})):(L(),X("div",Spe,Pe(v.data.value),1))])):v.data.format==="type"?(L(),X("div",Cpe,[v.data.state==="loading"?(L(),Ge(o,{key:0,size:"x-small",style:{"z-index":"1","background-color":"unset"}})):(L(),X("div",Ipe,Pe(v.data.value),1))])):v.data.format==="status"?(L(),X("div",Tpe,[v.data.state==="loading"?(L(),Ge(o,{key:0,size:"x-small",style:{"z-index":"1","background-color":"unset"}})):(L(),X("div",Ape,Pe(v.data.value),1))])):v.data.format==="details"?(L(),X("div",Mpe,[v.data.state==="loading"?(L(),Ge(o,{key:0,size:"x-small",style:{"z-index":"1","background-color":"unset"}})):(L(),X("div",Epe,Pe(v.data.value),1))])):$e("",!0)]),_:1},8,["columns","rows"])):(L(),X("div",kpe,Rpe))]))]),footer:je(()=>[k("div",$pe,[k("div",Ope,[de(p,{class:$t(["slds-button",{"slds-button_brand":r.rows.length===0}]),variant:"neutral",onClick:t[0]||(t[0]=v=>e.$emit("close"))},{default:je(()=>[es("Close")]),_:1},8,["class"])])])]),_:1},8,["title"])}const Npe=os(gpe,[["render",Lpe],["__scopeId","data-v-f5cc7f87"]]),Dpe={name:"OverrideTargetModal",components:{Checkbox:za,Modal:zc,TextInput:Ko,RadioButtonGroup:tj,ButtonIcon:vn},props:["config"],emits:["close","update:modelValue"],data(){return{overrideAmount:this.config.metric.target-this.config.metric.originalTarget,overrideMethod:this.config.metric.targetOverrideType||"Amount",overrideMethodOptions:[{label:"Amount",value:"Amount"},{label:"Percentage",value:"Percentage"}]}},computed:{originalTarget(){return this.config.metric.originalTarget},updatedTarget(){return this.originalTarget+this.overrideAmount||0},overridePercent(){return this.originalTarget>0?this.overrideAmount/this.originalTarget*100:this.overrideAmount*100},formattedAmount(){return Math.round(this.overrideAmount)},formattedReadOnlyPercent(){return this.overrideAmount>0?`+${this.overridePercent.toFixed(1)}%`:`${this.overridePercent.toFixed(1)}%`},displayPercent:{get(){return Math.round(this.overridePercent*10)/10},set(e){this.updatePercent(e),this.$emit("update:modelValue",e)}}},watch:{overrideMethod:{handler(){this.overrideMethod==="Amount"&&(this.overrideAmount=Math.round(this.overrideAmount))}}},mounted(){this.$refs.percentageInput.$refs.input.classList.add("slds-input_counter")},methods:{decreasePercent(){const e=Math.round((this.overridePercent-1)*10)/10;this.updateOverrideAmountByPercent(e)},increasePercent(){const e=Math.round((this.overridePercent+1)*10)/10;this.updateOverrideAmountByPercent(e)},updatePercent(e){const t=parseFloat(e);this.updateOverrideAmountByPercent(t)},updateOverrideAmountByPercent(e){this.overrideAmount=this.originalTarget>0?this.originalTarget*e/100:this.originalTarget+e/100},save(){this.config.metric.targetOverrideType=this.overrideMethod,this.config.metric.targetOverrideAmount=this.overrideMethod==="Percentage"?this.overridePercent:this.overrideAmount,this.config.callback({updatedMetric:this.config.metric}),this.$emit("close")}}},PI=e=>(Nr("data-v-7cb3a656"),e=e(),Dr(),e),Bpe={class:"slds-grid slds-grid_vertical"},Fpe={class:"slds-p-around_small"},zpe=PI(()=>k("div",{class:"slds-p-bottom_xx-small slds-text-color_weak"},"Override Method",-1)),Upe={class:"slds-p-around_small"},Vpe={key:0,class:"slds-p-bottom_xx-small slds-text-color_weak"},jpe={key:1,class:"slds-p-bottom_xx-small slds-text-color_weak"},qpe={class:"slds-grid"},Hpe={class:"slds-p-around_small"},Gpe=PI(()=>k("div",{class:"slds-p-bottom_xx-small slds-text-color_weak"},"Overridden Target",-1)),Wpe={class:"slds-p-around_small"},Ype=PI(()=>k("div",{class:"slds-p-bottom_xx-small slds-text-color_weak"},"Original Target",-1)),Zpe={class:"slds-grid"},Xpe={class:"slds-col_bump-left"};function Kpe(e,t,s,n,r,a){const o=pe("RadioButtonGroup"),d=pe("TextInput"),p=pe("ButtonIcon"),y=pe("Button"),v=pe("Modal");return L(),Ge(v,{ref:"modal",title:"Override Target",size:"small",detach:"",onClose:t[4]||(t[4]=C=>e.$emit("close"))},{content:je(()=>[k("div",Bpe,[k("div",Fpe,[zpe,de(o,{modelValue:r.overrideMethod,"onUpdate:modelValue":t[0]||(t[0]=C=>r.overrideMethod=C),class:"slds-text-body_regular",options:r.overrideMethodOptions},null,8,["modelValue","options"])]),k("div",Upe,[r.overrideMethod==="Amount"?(L(),X("div",Vpe,"Override Amount")):(L(),X("div",jpe,"Override Percentage")),Mn(k("div",null,[de(d,{modelValue:r.overrideAmount,"onUpdate:modelValue":t[1]||(t[1]=C=>r.overrideAmount=C),modelModifiers:{number:!0},style:{width:"220px"},type:"number"},null,8,["modelValue"])],512),[[Ai,r.overrideMethod==="Amount"]]),Mn(k("div",null,[de(d,{id:"percentageInput",ref:"percentageInput",modelValue:a.displayPercent,"onUpdate:modelValue":t[2]||(t[2]=C=>a.displayPercent=C),modelModifiers:{number:!0},class:"slds-input-has-icon slds-input-has-icon_left-right",type:"Number",fixedTextRight:"%",style:{width:"220px"}},{extend:je(()=>[de(p,{iconCategory:"utility",iconName:"ban",assistiveText:"Decrease percentage",iconClass:["slds-input__icon"],class:"slds-button slds-button_icon slds-input__icon slds-input__icon_left",title:"Decrease percentage",onClick:a.decreasePercent},null,8,["onClick"]),de(p,{iconCategory:"utility",iconName:"new",assistiveText:"Increase percentage",iconClass:["slds-button__icon","slds-icon-text-light"],class:"slds-button slds-button_icon slds-input__icon slds-input__icon_right",title:"Increase percentage",onClick:a.increasePercent},null,8,["onClick"])]),_:1},8,["modelValue"])],512),[[Ai,r.overrideMethod==="Percentage"]])]),k("div",qpe,[k("div",Hpe,[Gpe,de(d,{readonly:"",labels:{name:"",placeholder:`${e.$F(s.config.metric.type,a.updatedTarget)} (${a.formattedReadOnlyPercent})`}},null,8,["labels"])]),k("div",Wpe,[Ype,de(d,{readonly:"",labels:{name:"",placeholder:`${e.$F(s.config.metric.type,a.originalTarget)}`}},null,8,["labels"])])])])]),footer:je(()=>[k("div",null,[k("div",Zpe,[k("div",Xpe,[de(y,{class:"slds-button slds-button_neutral",onClick:t[3]||(t[3]=C=>e.$emit("close"))},{default:je(()=>[es("Cancel")]),_:1}),de(y,{class:"slds-button slds-button_brand",onClick:a.save},{default:je(()=>[es("Save")]),_:1},8,["onClick"])])])])]),_:1},512)}const Jpe=os(Dpe,[["render",Kpe],["__scopeId","data-v-7cb3a656"]]),Qpe={name:"DiscreteBranchSelector",components:{SLDSButton:Tn,Modal:zc,Spinner:Vr,Icon:yn},props:["config"],emits:["close"],data(){return{loading:!0,hideCancel:!0,selectedBranch:null,branches:[]}},async mounted(){SPM.Components.FocusModal=this,this.hideCancel=this.config.requireSelection,this.branches=(this.config.userAccessRecords||[]).map(e=>({id:e.sfsp__SalesNode__c,name:e.sfsp__SalesNode__r.Name,accessLevel:e.sfsp__AccessLevel__c,descendantIds:[]})),this.selectedBranch=this.config.currentBranch||this.branches[0].id,this.loading=!1},methods:{async setFocus(){this.loading=!0;const e=this.branches.find(t=>t.id===this.selectedBranch);e.descendantIds=await SPM.Utils.Node.getDescendantIds({planId:this.config.planId,nodeIds:[e.id==="All Org"?"":e.id]}),this.config.callback(e),this.$emit("close"),this.loading=!1}}},efe={class:"slds-grid slds-grid_vertical slds-grid_vertical-align-center slds-grid_align-center"},tfe={class:"slds-p-vertical_medium"},sfe=k("div",{class:"slds-p-bottom_medium",style:{"font-size":"1rem","text-align":"center",margin:"0 9rem"}},"Specify the node that you want to focus on.",-1),nfe={class:"slds-p-vertical_medium"},rfe={class:"slds-form-element"},ife={class:"slds-form-element__control"},ofe=["id","value","name","onKeydown","onClick"],afe=["for"],lfe={class:"slds-visual-picker__figure slds-visual-picker__text",style:{height:"auto"}},cfe={class:"slds-text-heading_medium slds-m-bottom_x-small"},ufe=["id"],dfe={class:"slds-grid"},hfe={class:"slds-col_bump-left"};function pfe(e,t,s,n,r,a){const o=pe("Spinner"),d=pe("Icon"),p=pe("SLDSButton"),y=pe("Modal");return L(),Ge(y,{id:"discrete-branch-selector",ref:"modal",title:"Select a Hierarchy Node",size:"base",detach:"",hideCloseButton:r.hideCancel,onClose:t[2]||(t[2]=v=>r.loading?()=>{}:e.$emit("close")),onClick:t[3]||(t[3]=Os(()=>{},["stop"]))},{content:je(()=>[r.loading?(L(),Ge(o,{key:0})):$e("",!0),k("div",efe,[k("div",tfe,[de(d,{category:"utility",name:"hierarchy",size:"large",assistiveText:"Hierarchy Icon"})]),sfe,k("div",nfe,[k("fieldset",rfe,[k("div",ife,[(L(!0),X(Lt,null,As(r.branches,v=>(L(),X("div",{key:r.selectedBranch===v.id?`visual-picker-selected-${v.name}`:`visual-picker-${v.name}`,class:"slds-visual-picker slds-visual-picker_vertical"},[Mn(k("input",{type:"radio","onUpdate:modelValue":t[0]||(t[0]=C=>r.selectedBranch=C),id:r.selectedBranch===v.id?`visual-picker-selected-${v.name}`:`visual-picker-${v.name}`,value:v.id,name:v.id,onKeydown:Zs(C=>r.selectedBranch=v.id,["enter"]),onClick:C=>r.selectedBranch=v.id},null,40,ofe),[[Ng,r.selectedBranch]]),k("label",{for:r.selectedBranch===v.id?`visual-picker-selected-${v.name}`:`visual-picker-${v.name}`},[k("span",lfe,[k("span",null,[k("span",cfe,Pe(v.name),1),k("span",{id:`visual-picker-access-${v.name}`,class:"slds-text-title"},Pe(v.accessLevel),9,ufe)])]),de(d,{category:"utility",name:"check",size:"x-small",variant:"none",class:"slds-visual-picker__text-check",iconClass:"slds-icon-text-check"})],8,afe)]))),128))])])])])]),footer:je(()=>[k("div",null,[k("div",dfe,[k("div",hfe,[r.hideCancel?$e("",!0):(L(),Ge(p,{key:0,class:"slds-button slds-button_neutral",disabled:r.loading,onClick:t[1]||(t[1]=v=>e.$emit("close"))},{default:je(()=>[es("Cancel")]),_:1},8,["disabled"])),de(p,{class:"slds-button slds-button_brand",onClick:a.setFocus,disabled:!r.selectedBranch||s.config.currentBranch&&r.selectedBranch===s.config.currentBranch||r.loading},{default:je(()=>[es("Apply")]),_:1},8,["onClick","disabled"])])])])]),_:1},8,["hideCloseButton"])}const ffe=os(Qpe,[["render",pfe]]),mfe={name:"NodeSwitcher",components:{Button:Tn,ButtonIcon:vn,Icon:yn,Picklist:Qi,Popover:Uc,Spinner:Vr},props:["contextNode","targetBindTo"],emits:["change-root-node","close"],data(){return{searchTerm:"",navigateToNodeId:"",isLoading:!1,searchOptions:[{options:this.getSearchOptions}],nodeMap:{},selectedNode:this.$props.contextNode,levelNode:null,lastFocusedOptionIndex:0}},computed:{currentLevelNodes(){return this.nodeMap[this.levelNode.id]},topOfHierarchyNode(){return this.$store.rootNodeAncestors[0]||this.$store.rootNode},isRootNodeSelected(){return this.selectedNode?this.$store.rootNodeAncestors.length?this.selectedNode.id===this.$store.rootNodeAncestors[0].id:this.selectedNode.id===this.topOfHierarchyNode.id:!1},currentNodeMap(){return this.currentLevelNodes.reduce((e,t)=>(e[t.id]=t,e),{})},accessibleNodeIds(){return[this.$store.branch.id,...this.$store.branch.descendantIds]}},watch:{selectedNode:{handler(){this.$nextTick(()=>this.moveSelectedNodeInView())}}},async created(){this.levelNode=this.$props.contextNode.childCount===0&&this.accessibleNodeIds.includes(this.$props.contextNode.parentId)?this.$store.nodeMap[this.$props.contextNode.parentId]:this.$store.rootNode;const e=[{...this.levelNode,parentId:this.levelNode.parentId||"All Org"}];this.nodeMap[this.levelNode.id]=e.concat(this.levelNode.children)},mounted(){this.$refs.popover.getFocusableElements(),this.moveSelectedNodeInView()},methods:{async getNode({nodeId:e}){var s;this.isLoading=!0;const t=(await SPM.Utils.Apex.invoke("Query",[`
                    SELECT
                        Id,
                        Name,
                        sfsp__Parent__c,
                        (
                            SELECT Id
                            FROM sfsp__SalesNodes__r
                        )
                    FROM sfsp__SalesNode__c
                    WHERE sfsp__SalesPlan__c = '${SPM.$store.plan.Id}' AND Id = '${e}'
                `]))[0];return this.isLoading=!1,{id:t.Id,name:t.Name,parentId:t.sfsp__Parent__c||"All Org",childCount:((s=t.sfsp__SalesNodes__r)==null?void 0:s.length)||0}},async searchHierarchy(e){const t=[];return(await SPM.Utils.Apex.invoke("Query",[`
                    SELECT
                        Id,
                        Name,
                        sfsp__Parent__r.Name,
                        sfsp__Parent__r.sfsp__Parent__r.Name
                    FROM sfsp__SalesNode__c
                    WHERE sfsp__SalesPlan__c = '${SPM.$store.plan.Id}' AND Name LIKE '%${e}%'
                `])).forEach(n=>{var r,a,o;if(this.accessibleNodeIds.includes(n.sfsp__Parent__c||"All Org")){const d=(r=n.sfsp__Parent__r)!=null&&r.sfsp__Parent__c?this.accessibleNodeIds.includes(n.sfsp__Parent__r.sfsp__Parent__c):!1;t.push({id:n.Id,name:n.Name,parentName:((a=n.sfsp__Parent__r)==null?void 0:a.Name)||"All Org",grandparentName:d?((o=n.sfsp__Parent__r.sfsp__Parent__r)==null?void 0:o.Name)||"All Org":""})}}),t},async getSearchOptions(e){const t=[];this.searchTerm=e.replace(/'/g,"\\'");const s=r=>`<b>${r}</b>`,n=await this.searchHierarchy(this.searchTerm.toLowerCase());return this.$store.branch.id==="All Org"&&"all org".includes(e.toLowerCase())&&n.push({id:"All Org",name:"All Org"}),n.forEach(r=>{const a=r.grandparentName?[r.grandparentName,r.parentName,r.name].join(" / "):r.parentName?[r.parentName,r.name].join(" / "):r.name,o=new RegExp(e,"ig");t.push({id:r.id,title:this.escapeHtml(a).replace(o,s)})}),t},escapeHtml(e){const t=document.createElement("p");return t.appendChild(document.createTextNode(e)),t.innerHTML},async selectNode(e,t=!1){if(!!this.accessibleNodeIds.includes(e))if(this.navigateToNodeId="",this.selectedNode=this.currentNodeMap[e]||this.$store.nodeMap[e]||await this.getNode({nodeId:e}),this.currentLevelNodes.includes(this.selectedNode))t&&await this.changeLevelNode(this.selectedNode);else if(!this.selectedNode.parentId)this.changeLevelNode(this.selectedNode);else{const s=this.currentNodeMap[this.selectedNode.parentId]||this.$store.nodeMap[this.selectedNode.parentId]||await this.getNode({nodeId:this.selectedNode.parentId});this.changeLevelNode(s)}},async changeLevelNode(e){this.isLoading=!0;const t=e.children||await SPM.Utils.Node.getChildren({node:e});e.childNodes=t,this.updateNodeMap(e),this.levelNode=e,this.lastFocusedOptionIndex=0,this.isLoading=!1},updateNodeMap(e){const t=[{...e,parentId:e.parentId||"All Org"}];this.nodeMap[e.id]=t.concat(e.childNodes),e.parentId&&(this.nodeMap[e.parentId]=this.$store.nodeMap[e.parentId])},async goToParentLevel(e){this.nodeMap[e.parentId]||(this.nodeMap[e.parentId]=this.$store.nodeMap[e.parentId]),this.selectedNode=this.nodeMap[e.parentId],this.changeLevelNode(this.nodeMap[e.parentId])},navigateToNode(){this.$emit("change-root-node",this.selectedNode.id),this.$emit("close")},moveSelectedNodeInView(){const e=document.getElementById(this.selectedNode.id);e&&((e==null?void 0:e.getBoundingClientRect().bottom)>(e==null?void 0:e.parentElement.getBoundingClientRect().bottom)||(e==null?void 0:e.getBoundingClientRect().top)<(e==null?void 0:e.parentElement.getBoundingClientRect().top))&&e.scrollIntoView(!0)},changeBranch(){SPM.Components.Root.openModal("discreteBranch",{planId:this.$store.plan.Id,userAccessRecords:this.$store.userAccessRecords,currentBranch:this.$store.branch.id,callback:async e=>{this.$store.$patch({branch:e}),SPM.Components.Root.loadRootNode(e.id),this.$emit("close")}})},onFocus(e,t){this.lastFocusedOptionIndex=e},focusLastFocusedOption(){const e=this.$refs[`option-${this.lastFocusedOptionIndex}`][0];e&&e.focus()},up(){this.lastFocusedOptionIndex>0?this.lastFocusedOptionIndex--:this.lastFocusedOptionIndex=this.currentLevelNodes.slice(1).length-1,this.focusLastFocusedOption()},down(){this.lastFocusedOptionIndex<this.currentLevelNodes.slice(1).length-1?this.lastFocusedOptionIndex++:this.lastFocusedOptionIndex=0,this.focusLastFocusedOption()}}},zx=e=>(Nr("data-v-867382a5"),e=e(),Dr(),e),_fe=zx(()=>k("b",null,"Hierarchy Focus",-1)),gfe=zx(()=>k("hr",{class:"border"},null,-1)),yfe={class:"slds-p-around_small slds-grid slds-grid_vertical"},vfe=zx(()=>k("label",{id:"nodePicklistLabel",class:"slds-assistive-text"},"Quick find...",-1)),bfe=["innerHTML"],xfe={key:0,class:"slds-grid slds-grid_vertical slds-grid_vertical-align-center slds-p-vertical_xx-large"},wfe={key:1},Sfe={class:"slds-listbox slds-listbox_vertical spm-custom-listbox"},Cfe=["id","name"],Ife=["id"],Tfe={class:"slds-media__figure slds-listbox__option-icon"},Afe={class:"slds-media__body"},Mfe=["title"],Efe={key:0},kfe={key:1},Pfe={class:"slds-listbox__option-icon"},Rfe=zx(()=>k("hr",{class:"border"},null,-1)),$fe={class:"child-nodes-list slds-scrollable_y"},Ofe=["id","name","tabindex","onKeydown","onFocus"],Lfe=["id","onClick"],Nfe={class:"slds-media__figure slds-listbox__option-icon"},Dfe={class:"slds-media__body"},Bfe=["title"],Ffe={key:0},zfe={key:1};function Ufe(e,t,s,n,r,a){const o=pe("Icon"),d=pe("ButtonIcon"),p=pe("Picklist"),y=pe("Spinner"),v=pe("Button"),C=pe("Popover");return L(),Ge(C,{id:"node-switcher-container",ref:"popover",bindTo:s.targetBindTo,alignment:"bottom right",position:"absolute",width:"large",closeOnClickOutside:"",onClose:t[8]||(t[8]=I=>e.$emit("close"))},{header:je(()=>[_fe]),content:je(()=>[gfe,k("div",yfe,[vfe,de(p,{ref:"nodePicklist",modelValue:r.navigateToNodeId,"onUpdate:modelValue":t[1]||(t[1]=I=>r.navigateToNodeId=I),class:"slds-input-has-icon_left-right",labelForId:"nodePicklistLabel",labels:{search:"Quick find..."},minSearchLength:"2",filterable:"",options:r.searchOptions,onSelectedOption:t[2]||(t[2]=I=>a.selectNode(r.navigateToNodeId))},{icon:je(()=>[de(o,{category:"utility",name:"search",iconClass:["slds-input__icon","slds-input__icon_left"]}),r.searchTerm?(L(),Ge(d,{key:0,iconCategory:"utility",iconName:"clear",iconClass:["slds-button__icon","slds-icon-text-light"],class:"slds-button slds-button_icon slds-input__icon slds-input__icon_right",onClick:t[0]||(t[0]=Os(I=>r.searchTerm="",["stop"]))})):$e("",!0)]),option:je(({option:I})=>[k("span",{innerHTML:I.title},null,8,bfe)]),_:1},8,["modelValue","labels","options"])]),r.isLoading?(L(),X("div",xfe,[de(y,{size:"small",isInline:"",withoutContainer:""})])):(L(),X("div",wfe,[k("ul",Sfe,[k("div",null,[k("li",{id:r.levelNode.id,name:`${r.levelNode.name.replaceAll(" ","-").toLowerCase()}-selected-nodeswitcher-node`,class:"slds-listbox__item",tabindex:"0",onKeydown:t[5]||(t[5]=Zs(I=>a.selectNode(r.levelNode.id),["enter"]))},[k("div",{id:r.levelNode.id,"aria-checked":"true",class:"slds-media slds-listbox__option slds-listbox__option_plain slds-media_small slds-is-selected",role:"option",onClick:t[4]||(t[4]=I=>{I.stopImmediatePropagation(),a.selectNode(r.levelNode.id)})},[k("span",Tfe,[r.levelNode.id!==a.topOfHierarchyNode.id&&a.accessibleNodeIds.includes(r.levelNode.parentId)?(L(),Ge(d,{key:0,id:"node-back-to-parent",iconClass:["slds-input__icon"],iconCategory:"utility",iconName:"back",onClick:t[3]||(t[3]=I=>{I.stopImmediatePropagation(),a.goToParentLevel(r.levelNode)})})):$e("",!0),Mn(de(o,{iconClass:["slds-input__icon"],category:"utility",name:"check",size:"x-small"},null,512),[[Ai,a.isRootNodeSelected]])]),k("div",Afe,[k("span",{class:"slds-truncate",title:r.levelNode.name},[r.levelNode.id===r.selectedNode.id?(L(),X("b",Efe,Pe(r.levelNode.name),1)):(L(),X("p",kfe,Pe(r.levelNode.name),1))],8,Mfe)]),k("span",Pfe,[Mn(de(o,{iconClass:["slds-input__icon"],category:"utility",name:"check",size:"x-small"},null,512),[[Ai,r.levelNode.id===r.selectedNode.id&&r.levelNode.id!==a.topOfHierarchyNode.id]])])],8,Ife),Rfe],40,Cfe)]),k("div",$fe,[(L(!0),X(Lt,null,As(a.currentLevelNodes.slice(1),(I,O)=>(L(),X("li",{id:I.id,name:`${I.name.replaceAll(" ","-").toLowerCase()}-selected-nodeswitcher-node`,ref_for:!0,ref:`option-${O}`,key:O,class:"slds-listbox__item",tabindex:r.lastFocusedOptionIndex===O?0:-1,onKeydown:[t[6]||(t[6]=Zs(Os((...A)=>a.up&&a.up(...A),["prevent"]),["up"])),t[7]||(t[7]=Zs(Os((...A)=>a.down&&a.down(...A),["prevent"]),["down"])),Zs(A=>a.selectNode(I.id),["enter"])],onFocus:A=>a.onFocus(O,A)},[k("div",{id:`${I.id}_${O}`,"aria-checked":"true",class:"slds-media slds-listbox__option slds-listbox__option_plain slds-media_small slds-is-selected",role:"option",onClick:A=>{A.stopImmediatePropagation(),a.selectNode(I.id)}},[k("span",Nfe,[Mn(de(o,{class:"slds-input__icon",category:"utility",name:"check",size:"x-small"},null,512),[[Ai,I.id===r.selectedNode.id]])]),k("div",Dfe,[k("span",{class:"slds-truncate",title:I.name},[I.id===r.selectedNode.id?(L(),X("b",Ffe,Pe(I.name),1)):(L(),X("p",zfe,Pe(I.name),1))],8,Bfe)]),I.childCount>0?(L(),Ge(d,{key:0,name:`${I.name.replaceAll(" ","-").toLowerCase()}-node-switcher-open-child`,iconClass:["slds-input__icon"],iconCategory:"utility",iconName:"right",onClick:A=>{A.stopImmediatePropagation(),a.selectNode(I.id,!0)}},null,8,["name","onClick"])):$e("",!0)],8,Lfe)],40,Ofe))),128))])])]))]),footer:je(()=>[k("div",{class:$t(["slds-grid slds-grid_vertical-align-center",{"slds-grid_align-spread":e.$store.userAccessRecords.length>1,"slds-grid_align-end":e.$store.userAccessRecords.length<=1}])},[e.$store.userAccessRecords.length>1?(L(),Ge(v,{key:0,id:"node-switcher-change-branch",variant:"neutral",onClick:a.changeBranch},{default:je(()=>[es("Change Root")]),_:1},8,["onClick"])):$e("",!0),de(v,{id:"node-switcher-apply",variant:"brand",disabled:r.selectedNode.id===e.$store.rootNode.id,onClick:a.navigateToNode},{default:je(()=>[es("Apply")]),_:1},8,["disabled","onClick"])],2)]),_:1},8,["bindTo"])}const Vfe=os(mfe,[["render",Ufe],["__scopeId","data-v-867382a5"]]),jfe={name:"AppRoot",components:{ActionMenu:wa,ActionMenuItem:Sa,Button:Tn,ButtonIcon:vn,Icon:yn,Spinner:Vr,Tab:bC,Tabs:vC,Toasts:MP,Alert:_pe,NoAccess:Nj,Allocation:iZ,Assignment:foe,Hierarchy:qoe,ManageGeoBoundariesModal:cae,EditNodeModal:qae,ConfirmModal:Qae,ImportHierarchyModal:$le,PlanShareModal:Gue,BranchShareModal:Ihe,EditPeriodDistributions:dpe,PlanningElementsUpdateModal:Npe,OverrideTargetModal:Jpe,DiscreteBranchSelector:ffe,NodeSwitcher:Vfe},data(){return{params:new URLSearchParams(window.location.search),loadingMsg:"Loading Plan...",noAccess:!1,activeTab:null,showNodeSwitcher:!1,targetBindTo:null,modalConfig:{},modals:{manageGeoBoundaries:!1,editNode:!1,confirm:!1,importHierarchy:!1,sharePlan:!1,shareBranch:!1,planningElementsUpdate:!1,overrideTarget:!1,discreteBranch:!1}}},computed:{showExitMapButton(){return this.activeTab==="Assignment"&&this.$store.preferences.AssignmentExplorer.mode==="Map"}},async created(){await SPM.Utils.Version244.checkAsyncJobWaitingStatus()},async mounted(){var p,y;SPM.Components.Root=this;const e=this.params.get("nodeId")==="root"?"All Org":this.params.get("nodeId");let t=!0,s=` Id = '${this.params.get("planId")}'`;if(this.$store.isAdmin)this.$store.$patch({branch:{...this.$store.branch,descendantIds:await SPM.Utils.Node.getDescendantIds({planId:this.params.get("planId"),nodeIds:[""]})}});else{const v=await SPM.Utils.Apex.invoke("Query",[`SELECT Id, sfsp__SalesPlan__c, sfsp__SalesNode__r.Name, sfsp__AccessLevel__c FROM sfsp__SalesUserAccess__c WHERE sfsp__User__c = '${SPM.currentUser.Id}' AND sfsp__SalesPlan__c = '${this.params.get("planId")}'`])||[],C=v.map(O=>`'${O.sfsp__SalesPlan__c}'`);let I=!1;await SPM.Utils.Async.forEachParallel(v,async O=>{var P;const A=await SPM.Utils.Node.getDescendantIds({planId:this.params.get("planId"),nodeIds:[O.sfsp__SalesNode__c||""]});if((O.sfsp__SalesNode__c||"All Org")===e||[O.sfsp__SalesNode__c,...A].includes(e)){const q={id:O.sfsp__SalesNode__c||"All Org",name:((P=O.sfsp__SalesNode__r)==null?void 0:P.Name)||"All Org",accessLevel:O.sfsp__AccessLevel__c,descendantIds:A};this.$store.$patch({branch:q}),I=!0}},5),t=I&&C.length>0,s=` Id IN (${t?C.join(","):null})`,this.$store.$patch({userAccessRecords:v})}if(!t){this.loadingMsg="",this.noAccess=!0;return}this.$store.hasSalesPlanningTemplateApp=!!(await SPM.Utils.Apex.invoke("Query",["SELECT Id FROM Folder where Type = 'Insights' AND DeveloperName = 'Sales_Planning'"]))[0];const n={...SPM.Utils.Plan.defaults(),...(await SPM.Utils.Apex.invoke("Query",[`
                SELECT
                    Name,
                    sfsp__Period__c,
                    sfsp__AssignmentBehavior__c,
                    sfsp__Owner__c,
                    sfsp__Owner__r.Name,
                    sfsp__HierarchyReference__c,
                    (
                        SELECT
                            Name,
                            sfsp__Type__c,
                            sfsp__TargetOverrideEnabled__c
                        FROM sfsp__SalesMetrics__r
                    ),
                    (
                        SELECT
                            Name,
                            sfsp__Label__c,
                            sfsp__ReferenceFields__c
                        FROM sfsp__SalesAssignmentObjects__r
                    ),
                    (
                        SELECT Id,
                            sfsp__SalesPlan__c,
                            sfsp__User__c,
                            sfsp__User__r.Name,
                            sfsp__Role__c
                        FROM sfsp__SalesPlanUsers__r
                    ),
                    (
                        SELECT
                            sfsp__Preferences__c
                        FROM sfsp__SalesUserPreferences__r
                        WHERE User__c = '${SPM.currentUser.Id}'
                    ),
                    (
                        SELECT Id, sfsp__User__r.Name, sfsp__AccessLevel__c, sfsp__SalesNode__r.Name FROM sfsp__SalesUserAccess__r 
                    )
                FROM sfsp__SalesPlan__c
                WHERE${s}
            `]))[0]};n.sfsp__HierarchyReference__c=JSON.parse((n==null?void 0:n.sfsp__HierarchyReference__c)||"[]");let r=[],a=[],o=[];if(n.sfsp__Period__c){const[v]=await SPM.Utils.Apex.invoke("Query",[`SELECT Id, FullyQualifiedLabel, StartDate, EndDate FROM Period WHERE Id = '${n.sfsp__Period__c}'`]);n.fiscalPeriodLabel=v.FullyQualifiedLabel;const C=new Date(v.StartDate).toISOString().substring(0,10),I=new Date(v.EndDate).toISOString().substring(0,10),O=await SPM.Utils.Apex.invoke("Query",[`SELECT StartDate, EndDate, Type from Period Where Type IN ('Quarter', 'Month') AND StartDate >= ${C} AND EndDate <= ${I} ORDER BY StartDate`]);SPM.FiscalLabels={Month:{}},O.forEach(A=>{const P=new Date(A.StartDate),q=new Date(A.EndDate);if(A.Type==="Quarter"){const ce=[];for(;P<=q;){const re=P.getUTCMonth()+1;ce.push(re),a.push(re),o.push([re]),P.setUTCMonth(re)}r.push(ce)}else{const ce=P.getUTCMonth();SPM.FiscalLabels.Month[ce+1]=this.$F("DateTime",q,{month:"long",year:"numeric"})}})}else{const v=[[1,2,3],[4,5,6],[7,8,9],[10,11,12]];r=v,a=v.flat(),o=v.flat().map(C=>[C]),SPM.FiscalLabels={Month:{}},a.forEach(C=>SPM.FiscalLabels.Month[C]=`Month ${C}`)}SPM.FiscalPeriod={Year:[a],Quarter:r,Month:o},await this.$store.$patch({plan:n}),this.$store.assignmentObjects=this.$store.plan.sfsp__SalesAssignmentObjects__r.map(v=>{const C={id:v.Id,name:v.Name,label:v.sfsp__Label__c,assignmentCount:"-",totalCount:"-",progress:null,assignmentsDataset:{dataflowStatus:""},recordsDataset:{dataflowStatus:""},asyncJob:{id:"",status:"loading",details:"",type:""},icon:SPM.Utils.AssignmentObject.getIcon(v.Name),referenceFields:[]};return JSON.parse(v.sfsp__ReferenceFields__c).forEach(I=>{I.type==="Latitude"?C.latitude=I:I.type==="Longitude"?C.longitude=I:C.referenceFields.push({...I,id:I.name})}),C}),this.$store.preferences.Map.layers.push(...this.$store.assignmentObjects.filter(v=>v.latitude&&v.longitude).map(v=>({type:"object",id:v.id,label:v.name,styles:{visible:!0,markerSymbol:"Circle",markerSize:20}}))),this.$store.loadPreferences(JSON.parse(((y=(p=n==null?void 0:n.sfsp__SalesUserPreferences__r)==null?void 0:p[0])==null?void 0:y.sfsp__Preferences__c)||"{}")),await Promise.allSettled([this.$store.availableAdminIds=new Set((await SPM.Utils.Apex.invoke("GetUsersWithPermissionSet",["SalesPlanningAdmin"])||[]).map(v=>v.Id)),this.$store.availableManagerIds=new Set((await SPM.Utils.Apex.invoke("GetUsersWithPermissionSet",["SalesPlanningOpsManager"])||[]).map(v=>v.Id))]);const d=await SPM.Utils.AssignmentObject.getSalesAsyncJobs({statuses:["Queued","Running","Waiting","Failure"]})||[];this.$store.$patch({salesAsyncJobs:d}),await this.loadRootNode(e),this.loadingMsg="Analyzing Hierarchy...",this.$store.maxLevel=await SPM.Utils.Node.getMaxLevel({planId:this.$store.plan.Id,nodeIds:(this.$store.rootNode.children||[]).map(v=>v.id),currentLevel:this.$store.rootNode.level+1}),this.activeTab=this.params.get("tabId")||"Hierarchy",this.loadingMsg=""},methods:{onTabChange(e){SPM.Utils.Browser.setSearchParams({tabId:e}),this.activeTab=e,SPM.Utils.Async.forEachParallel(this.$store.plan.sfsp__SalesAssignmentObjects__r,async t=>{const s={type:"load",assignmentObject:t,tab:this.activeTab};SPM.Utils.CRMA.checkDatasets(t,s,()=>this.$store.updateAsyncJobCallback(s))},5)},openNodeSwitcher({bindTo:e}){this.targetBindTo=e,this.showNodeSwitcher=!0},closeNodeSwitcher(){this.targetBindTo=null,this.showNodeSwitcher=!1},async loadRootNode(e){var a;if(this.loadingMsg="Loading Hierarchy...",e==="All Org"){if(!this.$store.nodeMap["All Org"]){const o=await SPM.Utils.Apex.invoke("Query",[`SELECT Id, sfsp__TargetOverrideAmount__c, sfsp__TargetOverrideType__c, ${Array(12).fill().map((p,y)=>`sfsp__Target_Month${y+1}__c`).join(", ")}, sfsp__SalesMetric__c FROM sfsp__SalesNodeMetric__c WHERE sfsp__SalesPlan__c = '${this.$store.plan.Id}' AND sfsp__SalesNode__c = ''`]),d=await SPM.Utils.Rest.invoke("Query",{query:`SELECT Id, Name, sfsp__SalesNode__c, sfsp__ContainerSet__c, sfsp__Filter__c, sfsp__IncludePoints__c, sfsp__SalesBoundary__c, sfsp__SalesBoundary__r.Name, sfsp__SalesBoundary__r.sfsp__ContainerSet__c, sfsp__SalesBoundary__r.sfsp__IncludePoints__c, sfsp__SalesBoundary__r.sfsp__SalesPlan__c FROM sfsp__SalesNodeBoundary__c WHERE sfsp__SalesPlan__c = '${this.$store.plan.Id}' AND sfsp__SalesNode__c = ''`});this.$store.nodeMap["All Org"]={id:"All Org",name:"All Org",color:"#2C7ED0",assignmentBehavior:this.$store.plan.sfsp__AssignmentBehavior__c||"Exclusive",ownerId:this.$store.plan.sfsp__Owner__c||"",ownerName:((a=this.$store.plan.sfsp__Owner__r)==null?void 0:a.Name)||"",level:0,metrics:this.$store.plan.sfsp__SalesMetrics__r.map(p=>{const y=o.find(v=>v.sfsp__SalesMetric__c===p.Id);return{...SPM.Utils.NodeMetric.Defaults,sfsp__SalesMetric__c:p.Id,...y||{}}}),users:this.$store.plan.sfsp__SalesPlanUsers__r||[],accessRecords:this.$store.plan.sfsp__SalesUserAccess__r.filter(p=>!p.sfsp__SalesNode__c&&!this.$store.availableAdminIds.has(p.sfsp__User__c)&&!this.$store.availableManagerIds.has(p.sfsp__User__c)).map(({sfsp__User__r:p,sfsp__User__c:y})=>({name:p.Name,userId:y,nodeId:"All Org"}))||[],rules:[],ruleLogics:{},previewRuleLogics:{},assignments:[],boundaries:d,siblingIds:[],olderSiblingIds:[]}}await this.$store.loadScope({parentNodeIds:[""]})}else await this.$store.loadScope({rootNodeId:e}),await this.$store.loadAncestors({nodeId:e});this.loadingMsg="Loading Boundaries...";const t=await SPM.Utils.Rest.invoke("Query",{query:`SELECT Id, Name, sfsp__ContainerSet__c, sfsp__IncludePoints__c, sfsp__SalesPlan__c FROM sfsp__SalesBoundary__c WHERE sfsp__SalesPlan__c = '${this.$store.plan.Id}'`});this.$store.$patch({salesBoundaries:t});const s=await SPM.Utils.Rest.invoke("Query",{query:`SELECT Id, sfsp__ContainerSet__c FROM sfsp__SalesNodeBoundary__c WHERE sfsp__SalesPlan__c = '${this.$store.plan.Id}' AND sfsp__SalesBoundary__c = ''`}),n=[...new Set(s.map(o=>({sfsp__ContainerSet__c:o.sfsp__ContainerSet__c}))),...new Set(t.map(o=>({sfsp__ContainerSet__c:o.sfsp__ContainerSet__c})))];await SPM.Utils.Async.forEachParallel(n,async o=>this.$store.loadContainers({containerSetId:o.sfsp__ContainerSet__c}),5),SPM.Utils.Node.getBoundaryObjects({node:this.$store.nodeMap[e],nodeMap:this.$store.nodeMap}).forEach(o=>{const d={...JSON.parse(JSON.stringify(SPM.Utils.BoundaryObject.Defaults)),id:o.id,label:this.$store.containerSets[o.containerSetId].label},p=this.$store.preferences.Map.layers.find(y=>y.id===o.id);p?Object.assign(p,{...d,...p}):this.$store.preferences.Map.layers.push(d)}),this.$store.rootNode=this.$store.nodeMap[e],this.$store.scope=this.$store.rootNode.level+1,SPM.Utils.Browser.setSearchParams({nodeId:e}),this.loadingMsg=""},openShareModal(e){this.openModal("shareBranch",{node:{Id:e.id,Name:e.name},callback:({invitedToastMsg:t,updatedToastMsg:s,removedToastMsg:n,sharedWithRecords:r})=>{t&&this.$store.toast({message:t,duration:2500}),s&&this.$store.toast({message:s,duration:2500}),n&&this.$store.toast({message:n,duration:2500}),this.$store.$patch(a=>{Object.values(a.nodeMap).forEach(o=>o.accessRecords=[]),r.length>0&&r.forEach(o=>{var d;(d=a.nodeMap[o.nodeId])==null||d.accessRecords.push(o)})})}})},openModal(e,t){this.modalConfig={callback:()=>{},...t||{}},this.modals[e]=!0},exitMapView(){SPM.Components.AssignmentTable.viewMode="Grid"}}},qfe=e=>(Nr("data-v-d345a76b"),e=e(),Dr(),e),Hfe={class:"slds-grid slds-grid_vertical",style:{height:"100%"}},Gfe={key:2,class:"slds-builder-header_container",style:{position:"relative"}},Wfe={class:"slds-builder-header"},Yfe={class:"slds-col slds-grid slds-size_1-of-3"},Zfe={class:"slds-builder-header__item"},Xfe=["href"],Kfe={class:"slds-builder-header__item"},Jfe={class:"slds-builder-header__item-label slds-media slds-grid slds-grid--vertical slds-grid--align-center"},Qfe={class:"slds-text-color_inverse logoLight"},eme={class:"slds-builder-header__item"},tme={class:"slds-builder-header__item-label slds-media slds-grid slds-grid--vertical slds-grid--align-center"},sme=["title"],nme={class:"slds-builder-header__item"},rme=["title"],ime={class:"slds-media__body"},ome={class:"slds-grid slds-grid_vertical-align-center"},ame=["title"],lme={class:"slds-icon_container slds-icon-utility-chevrondown slds-current-color slds-m-left_small"},cme={key:1,class:"slds-builder-header__item-label slds-media slds-grid slds-grid--vertical slds-grid--align-center"},ume=["title"],dme={class:"slds-col slds-size--1-of-3 slds-grid slds-grid_align-center"},hme={class:"slds-builder-header__item slds-builder-header__utilities"},pme={key:0,class:"slds-builder-header__utilities-item"},fme={class:"slds-builder-header__utilities-item"},mme={key:3,class:"slds-notify slds-notify_alert slds-alert_warning",role:"alert",style:{"min-height":"40px"}},_me=qfe(()=>k("div",{class:"slds-text-title_bold slds-m-left_x-small"},"Preview",-1));function gme(e,t,s,n,r,a){var Qe,Me,vt,Ut,Rt;const o=pe("Toasts"),d=pe("Alert"),p=pe("Spinner"),y=pe("Icon"),v=pe("Tab"),C=pe("Tabs"),I=pe("Button"),O=pe("NoAccess"),A=pe("Hierarchy"),P=pe("Allocation"),q=pe("Assignment"),ce=pe("ManageGeoBoundariesModal"),re=pe("EditNodeModal"),W=pe("ConfirmModal"),Ce=pe("ImportHierarchyModal"),te=pe("PlanShareModal"),oe=pe("BranchShareModal"),ve=pe("EditPeriodDistributions"),ee=pe("PlanningElementsUpdateModal"),ne=pe("OverrideTargetModal"),Se=pe("DiscreteBranchSelector"),Ue=pe("NodeSwitcher");return L(),X("div",Hfe,[de(o,{toasts:e.$store.toasts},null,8,["toasts"]),e.$store.salesAsyncJobs.length>0?(L(),Ge(d,{key:0,id:"updating-alert",assistiveText:"info",alertText:"Updating sales plan."})):$e("",!0),r.loadingMsg?(L(),Ge(p,{key:1},{description:je(()=>[es(Pe(r.loadingMsg),1)]),_:1})):$e("",!0),r.noAccess?$e("",!0):(L(),X("div",Gfe,[k("header",Wfe,[k("div",Yfe,[k("div",Zfe,[k("a",{id:"back-button",href:`/${e.$store.plan.Id}`,class:"slds-builder-header__item-action",title:"Back"},[de(y,{category:"utility",name:"back",class:"slds-current-color",size:"x-small",assistiveText:e.$L("Header.BackButton")},null,8,["assistiveText"])],8,Xfe)]),k("div",Kfe,[k("div",Jfe,[k("div",Qfe,Pe(e.$L("Header.Title")),1)])]),k("div",eme,[k("div",tme,[k("div",{id:"plan-name",class:"slds-text-color_inverse logoLight",title:e.$store.plan.Name},Pe(e.$store.plan.Name),9,sme)])]),k("div",nme,[((Qe=e.$store.rootNode)==null?void 0:Qe.childCount)||e.$store.rootNodeAncestors.length?(L(),X("button",{key:0,id:"node-switcher-toggle",class:"slds-button slds-builder-header__item-action slds-media slds-media_center","aria-haspopup":"true",title:e.$L("Header.FocusButton"),onClick:t[0]||(t[0]=(..._t)=>a.openNodeSwitcher&&a.openNodeSwitcher(..._t))},[k("span",ime,[k("div",ome,[k("div",{title:(Me=e.$store.rootNode)==null?void 0:Me.name},Pe((vt=e.$store.rootNode)==null?void 0:vt.name),9,ame),k("span",lme,[de(y,{category:"utility",name:"chevrondown",size:"x-small"})])])])],8,rme)):(L(),X("div",cme,[k("div",{title:(Ut=e.$store.rootNode)==null?void 0:Ut.name},Pe((Rt=e.$store.rootNode)==null?void 0:Rt.name),9,ume)]))])]),Mn(k("div",dme,[r.activeTab?(L(),Ge(C,{key:0,modelValue:r.activeTab,class:"slds-col slds-align_absolute-center spm-full-height slds-theme_alt-inverse spm-header-tabs",style:{width:"inherit"},onChanged:a.onTabChange},{default:je(()=>[de(v,{id:"Hierarchy",key:"Hierarchy",title:"Hierarchy"}),de(v,{id:"Assignment",key:"Assignment",title:"Assignment"}),de(v,{id:"Allocation",key:"Allocation",title:"Allocation"})]),_:1},8,["modelValue","onChanged"])):$e("",!0)],512),[[Ai,!e.$store.showPreview]]),k("div",hme,[e.$store.isEditor?(L(),X("div",pme,[de(I,{class:"slds-builder-header__item-action slds-media slds-media_center",iconSize:"medium",iconCategory:"utility",iconName:"share",title:"Share",variant:"base",assistiveText:"Share",disabled:!e.$store.hasSalesPlanningTemplateApp,onClick:t[1]||(t[1]=_t=>a.openShareModal(e.$store.rootNode))},{default:je(()=>[es(" Share ")]),_:1},8,["disabled"])])):$e("",!0),k("div",fme,[a.showExitMapButton?(L(),Ge(I,{key:0,class:"slds-builder-header__item-action slds-media slds-media_center",variant:"base",label:"Exit Map View",onClick:a.exitMapView},null,8,["onClick"])):$e("",!0)])])])])),e.$store.showPreview?(L(),X("div",mme,[de(y,{category:"utility",name:"preview",class:"slds-current-color",size:"x-small",assistiveText:"Preview"}),_me])):$e("",!0),r.noAccess?(L(),Ge(O,{key:4,id:"noAccess"})):r.activeTab==="Hierarchy"?(L(),Ge(A,{key:5,class:"slds-grid",style:{height:"100%"}})):r.activeTab==="Allocation"?(L(),Ge(P,{key:6,class:"slds-grid",style:{height:"100%"}})):r.activeTab==="Assignment"?(L(),Ge(q,{key:7,class:"slds-grid",style:{height:"100%"}})):$e("",!0),r.modals.manageGeoBoundaries?(L(),Ge(ce,{key:8,config:r.modalConfig,onClose:t[2]||(t[2]=_t=>r.modals.manageGeoBoundaries=!1)},null,8,["config"])):r.modals.editNode?(L(),Ge(re,{key:9,config:r.modalConfig,onClose:t[3]||(t[3]=_t=>r.modals.editNode=!1)},null,8,["config"])):r.modals.confirm?(L(),Ge(W,{key:10,config:r.modalConfig,onClose:t[4]||(t[4]=_t=>r.modals.confirm=!1)},null,8,["config"])):r.modals.importHierarchy?(L(),Ge(Ce,{key:11,config:r.modalConfig,onClose:t[5]||(t[5]=_t=>r.modals.importHierarchy=!1)},null,8,["config"])):r.modals.sharePlan?(L(),Ge(te,{key:12,config:r.modalConfig,onClose:t[6]||(t[6]=_t=>r.modals.sharePlan=!1)},null,8,["config"])):r.modals.shareBranch?(L(),Ge(oe,{key:13,config:r.modalConfig,onClose:t[7]||(t[7]=_t=>r.modals.shareBranch=!1)},null,8,["config"])):r.modals.editperioddistributions?(L(),Ge(ve,{key:14,config:r.modalConfig,onClose:t[8]||(t[8]=_t=>r.modals.editperioddistributions=!1)},null,8,["config"])):r.modals.planningElementsUpdate?(L(),Ge(ee,{key:15,config:r.modalConfig,onClose:t[9]||(t[9]=_t=>r.modals.planningElementsUpdate=!1)},null,8,["config"])):r.modals.overrideTarget?(L(),Ge(ne,{key:16,config:r.modalConfig,onClose:t[10]||(t[10]=_t=>r.modals.overrideTarget=!1)},null,8,["config"])):r.modals.discreteBranch?(L(),Ge(Se,{key:17,config:r.modalConfig,onClose:t[11]||(t[11]=_t=>r.modals.discreteBranch=!1)},null,8,["config"])):$e("",!0),r.showNodeSwitcher?(L(),Ge(Ue,{key:18,contextNode:e.$store.rootNode,targetBindTo:r.targetBindTo,onClose:a.closeNodeSwitcher,onChangeRootNode:a.loadRootNode},null,8,["contextNode","targetBindTo","onClose","onChangeRootNode"])):$e("",!0)])}const yme=os(jfe,[["render",gme],["__scopeId","data-v-d345a76b"]]);SPM.Utils=dk({Buffer:FE.Buffer,randomLocation:ZN});SPM.Components={};SPM.app=TN({components:{IconSettings:yT},render(){return An(yT,{iconPath:`/resource/${new Date().getTime()}/sfsp__SLDSAssets/icons`},()=>[An(yme)])}});const vme=EN();SPM.app.use(vme);SPM.app.config.globalProperties.$store=SPM.$store=km();const N1=SPM.currentUser.Locale.replace("sh_ME_USD","sh-ME").replace("_","-").slice(0,5),MM={Currency:new Intl.NumberFormat(N1,{style:"currency",currency:SPM.currentUser.CurrencyIsoCode,maximumFractionDigits:0}),Numeric:new Intl.NumberFormat(N1,{style:"decimal",maximumFractionDigits:0}),NumericCompact:new Intl.NumberFormat(N1,{notation:"compact"}),DateTime:(e={})=>new Intl.DateTimeFormat(N1,e)};SPM.app.config.globalProperties.$F=(e,t,s)=>e==="DateTime"?MM[e](s).format(t):MM[e].format(t);(async()=>{const e=await b4(SPM.currentUser.LanguageLocaleKey),t=(s,n={})=>{let r=SPM.Utils.Obj.get(e,s,"");return Object.keys(n).forEach(a=>r=r.replace(new RegExp(`\\{${a}\\}`,"g"),n[a])),r};SPM.app.use(LN,{picklist:t("SLDS.Picklist")}),SPM.app.config.globalProperties.$L=t,SPM.version=246,SPM.app.mount("#vue-root")})();SPM.app.config.errorHandler=(e,t,s)=>{if((e==null?void 0:e.type)==="RemoteActionException"){const{error:n}=e;km().toast({message:n.type,subMessage:n.message,state:"error"})}console.log("Vue Error",e,t,s)}});export default bme();
