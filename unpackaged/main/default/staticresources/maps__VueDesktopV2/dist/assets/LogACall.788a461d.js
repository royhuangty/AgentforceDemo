import{_ as v,S as C,O as L,l as F,f as y,Q as M,bz as $,bA as k,r as n,o as c,b as A,w as i,s as w,v as T,i as o,c as b,h as t,t as r,F as j,j as m,p as D,k as I}from"../bundle.js";import{M as V}from"./Modal.76578f76.js";import{c as _,r as S}from"./index.0172543b.js";import{u as O}from"./index.d251dbc7.js";import{c as B,b as q}from"./click-2-create-mixin.44f9d4c1.js";import"./DatePicker.899772b4.js";import"./TimePicker.bfa4e2f9.js";const N={components:{Spinner:C,Modal:V,TextInput:L,SLDSButton:F},mixins:[B],props:{modalOptions:{type:Object,required:!0}},emits:["close-modal"],setup(){return{mainStore:y()}},validations(){const e={subject:{},comments:{}};return this.hasFieldSet||(e.subject={required:_.withMessage(this.$Labels.MA_Field_Req,S)},e.comments={required:_.withMessage(this.$Labels.MA_Field_Req,S)}),e},data(){return{v$:O(),hasFieldSet:!1,isLoading:!1,subject:"Call",comments:"",hasError:!1,errors:0,errorMessages:[],success:0,finalMessage:""}},async created(){const{fieldSet:e,totalFeatures:s}=this.modalOptions;this.isSingleRecord=s===1,e&&(this.hasFieldSet=!0),this.hasFieldSet&&await this.initFieldSetForm({fieldSet:e})},methods:{formatLabel:M,async initFieldSetForm({fieldSet:e}){this.isLoading=!0;const s="logacallform";await this.base_buildFieldSetHTML({fieldSet:e,sObject:"Task",htmlElementId:s,visualForcePage:"maps__ClickToCreateForm"}),await this.$nextTick(),this.base_attachCssIcons({htmlElementId:s}),this.isLoading=!1},openClassicLogACall(){const{layerMap:e}=this.modalOptions;$(e),this.close()},close(){this.$emit("close-modal")},convertFieldSetDataToSaveData(){let e="";if(this.hasFieldSet){const{fields:s}=q("logacallform");s.TaskSubtype="Call",s.Status=s.Status?s.Status:"Completed",e=JSON.stringify(s)}else e=JSON.stringify({TaskSubtype:"Call",Status:"Completed",Subject:this.subject,Description:this.comments});return e},async saveForm(){const{layerMap:e}=this.modalOptions,s=this.convertFieldSetDataToSaveData();k({serializedDetails:s,layerMap:e}),this.close()}}},f=e=>(D("data-v-8b68f551"),e=e(),I(),e),E={key:0,class:"logacallform"},x={class:"slds-text-body_regular slds-m-bottom_medium"},R=f(()=>t("div",{id:"logacallform",class:"fieldSetHTML"},null,-1)),z=f(()=>t("ul",{class:"logacallform-fieldset-errors"},null,-1)),H={class:"slds-grid slds-grid_align-spread"},J={class:"slds-col"},P={class:"slds-col"};function U(e,s,Q,G,l,u){const h=n("Spinner"),p=n("TextInput"),d=n("SLDSButton"),g=n("Modal");return c(),A(g,{id:"LogACallModal",title:e.$Labels.ActionFramework_Log_a_Call,labels:{close:e.$Labels.MA_Close},class:"slds-modal-fullscreen-phone js-search-modal-wrapper",onClose:s[3]||(s[3]=a=>e.$emit("close-modal"))},{content:i(()=>[w(o(h,null,null,512),[[T,l.isLoading]]),l.hasFieldSet?(c(),b("div",E,[t("div",null,[t("div",x,r(e.$Labels.Log_A_Call_Fill_Fields),1),R,z])])):(c(),b(j,{key:1},[o(p,{modelValue:l.v$.subject.$model,"onUpdate:modelValue":s[0]||(s[0]=a=>l.v$.subject.$model=a),required:"",labels:{name:e.$Labels.MA_Subject},errors:e.$getErrorsByField(l.v$.subject),class:"slds-form-element",type:"text"},null,8,["modelValue","labels","errors"]),o(p,{modelValue:l.v$.comments.$model,"onUpdate:modelValue":s[1]||(s[1]=a=>l.v$.comments.$model=a),required:"",useTextArea:"",errors:e.$getErrorsByField(l.v$.comments),labels:{name:e.$Labels.MA_Comments},class:"slds-form-element",type:"text"},null,8,["modelValue","errors","labels"])],64))]),footer:i(()=>[t("div",H,[t("div",J,[o(d,{disabled:l.isLoading,class:"slds-button slds-button_neutral",title:"Open in Salesforce",iconCategory:"utility",iconName:"new_window",iconPosition:"right",onClick:u.openClassicLogACall},{default:i(()=>[m(r(e.$Labels.MA_ViewInSalesforce),1)]),_:1},8,["disabled","onClick"])]),t("div",P,[o(d,{disabled:l.isLoading,class:"slds-button slds-button_neutral",onClick:s[2]||(s[2]=a=>e.$emit("close-modal"))},{default:i(()=>[m(r(e.$Labels.MA_Cancel),1)]),_:1},8,["disabled"]),o(d,{disabled:l.isLoading,class:"slds-button slds-button_brand",onClick:u.saveForm},{default:i(()=>[m(r(e.$Labels.MA_Finish),1)]),_:1},8,["disabled","onClick"])])])]),_:1},8,["title","labels"])}const le=v(N,[["render",U],["__scopeId","data-v-8b68f551"]]);export{le as default};
