import{_ as f,l as y,S as b,O as L,f as $,g as S,L as v,r as a,o as d,b as m,w as r,e as A,i as n,j as u,t as c}from"../bundle.js";import{M as g}from"./Modal.76578f76.js";import{c as C,r as F}from"./index.0172543b.js";import{u as w}from"./index.d251dbc7.js";const R={name:"CreateRenameFolder",components:{Modal:g,SLDSButton:y,Spinner:b,TextInput:L},props:{modalOptions:{type:Object,required:!0}},emits:["close-modal"],setup(){const e=$(),s=S();return{mainStore:e,layersStore:s}},data(){return{name:"",id:"",isLoading:!1,nodeType:"",isNew:!1,v$:w()}},validations(){return{name:{required:C.withMessage(this.$Labels.MA_Field_Req,F)}}},computed:{title(){return this.isNew?this.$Labels.Layers_Personal_Folder_Modal_Create_Folder:this.$Labels.MA_Rename}},async created(){const{layer:e={},isNew:s=!1}=this.modalOptions;s||(this.name=e.name||""),this.id=e.id||"",this.nodeType=this.layersStore.currentFolder.nodeType,this.isNew=s},methods:{save(){if(this.v$.$touch(),this.v$.$invalid){this.showError(this.$Labels.Routes_Settings_Fix_Validation_Issues);return}let e={};this.isNew?e={ajaxResource:"TreeAJAXResources",action:"new_folder",pid:this.id,pos:"0",name:this.name,NodeType:this.nodeType,personUser:"user"}:e={ajaxResource:"TreeAJAXResources",action:"rename_folder",id:this.id,name:this.name},this.createOrUpdateFolder(e)},async createOrUpdateFolder(e){this.isLoading=!0;try{const{success:s}=await MAPS.Utils.Apex.invoke("maps.RemoteFunctions.processAJAXRequest",[e]);if(!s){this.showError(this.$Labels.Common_Refresh_And_Try_Again_Contact_Admin);return}this.isNew&&v.trackFeature({logPayload:{featureName:"folder_created"}}),this.$emit("close-modal"),this.layersStore.updateFolderData({folderId:this.layersStore.currentFolder.id})}catch(s){console.warn(s),this.showError(this.$Labels.Common_Refresh_And_Try_Again_Contact_Admin)}finally{this.isLoading=!1}},showError(e){this.mainStore.toast({message:e,state:"error"})}}};function M(e,s,T,N,t,i){const p=a("Spinner"),_=a("TextInput"),l=a("SLDSButton"),h=a("Modal");return d(),m(h,{id:"CreateRenameFolderModal",title:i.title,labels:{close:e.$Labels.MA_Close},onClose:s[3]||(s[3]=o=>e.$emit("close-modal"))},{content:r(()=>[t.isLoading?(d(),m(p,{key:0})):A("",!0),n(_,{modelValue:t.v$.name.$model,"onUpdate:modelValue":s[0]||(s[0]=o=>t.v$.name.$model=o),inputAttrs:{id:"nameInput"},labels:{name:e.$Labels.Layers_Personal_Folder_Modal_Create_Folder_Name},errors:e.$getErrorsByField(t.v$.name),required:""},null,8,["modelValue","labels","errors"])]),footer:r(()=>[n(l,{id:"flCancelBtnResource",variant:"neutral",class:"slds-text-body_small",disabled:t.isLoading,onClick:s[1]||(s[1]=o=>e.$emit("close-modal"))},{default:r(()=>[u(c(e.$Labels.MA_Cancel),1)]),_:1},8,["disabled"]),n(l,{id:"saveFolder",variant:"brand",class:"slds-text-body_small",disabled:t.isLoading,onClick:s[2]||(s[2]=o=>i.save())},{default:r(()=>[u(c(e.$Labels.MA_Save),1)]),_:1},8,["disabled"])]),_:1},8,["title","labels"])}const B=f(R,[["render",M]]);export{B as default};
