import{_ as u,S as f,l as y,P as O,f as S,r as p,o as j,b as T,w as m,s as A,v as g,i as n,h as M,j as _,t as h}from"../bundle.js";import{M as N}from"./Modal.76578f76.js";const C={components:{Spinner:f,Modal:N,SLDSButton:y,Picklist:O},props:{modalOptions:{type:Object,required:!0}},emits:["open-modal","close-modal"],setup(){return{mainStore:S()}},data(){return{selectedObjectApiName:"",selectedRecordType:"",isLoading:!1,objects:[],recordTypeMap:new Map,isMassAction:!1}},computed:{recordTypes(){let e=[];return this.recordTypeMap.has(this.selectedObjectApiName)&&(e=this.recordTypeMap.get(this.selectedObjectApiName)),e}},created(){const{objectFieldSetMap:e}=this.$props.modalOptions;e.forEach((s,d)=>{const{sfObject:c,recordTypes:t}=s;this.objects.push(c),this.selectedObjectApiName||(this.selectedObjectApiName=c.id),this.recordTypeMap.set(d,t);const[i={}]=t;this.selectedRecordType||(this.selectedRecordType=i.id)})},methods:{updateSelectedRecordType(){const e=this.recordTypes,[s={}]=e;this.selectedRecordType=s.id},showErrrorMsg(e){this.$emit("close-modal"),this.mainStore.toast({message:e,state:"warning"})},async nextStep(){const e=this.recordTypes.find(c=>c.id===this.selectedRecordType),{type:s}=this.$props.modalOptions;let d={...this.$props.modalOptions};if(s==="dataLayerMarkers"){const{data:c={}}=this.$props.modalOptions;try{const t=JSON.parse(c.maps__Settings__c),{C2C:i={}}=t,l=i[this.selectedObjectApiName]||{},a=e?.fieldSet||"";if(!a){this.showErrrorMsg(this.$Labels.Click2Create_ArcGIS_InvalidFieldSet);return}d={...d,fieldsetName:a,sObjectApiName:this.selectedObjectApiName,recordtypeid:this.selectedRecordType,selectedObjOptions:l}}catch(t){console.warn(t),this.showErrrorMsg(this.$Labels.MA_Something_Went_Wrong);return}}else{const{settings:c={}}=this.$props.modalOptions,{record:t={}}=c[this.selectedObjectApiName],i=e?.fieldSet||"";let l,a;const r={},b=Object.keys(t);switch(s){case"myPosition":l="maps__MyPosition";break;case"poi":l="maps__POI";break;case"mapClick":l="maps__MapClick";break}if(!l||!i){this.showErrrorMsg(this.$Labels.MA_Something_Went_Wrong);return}b.filter(o=>!["Id","Name","attributes",`${l}Enabled__c`,"maps__FieldSetOptions__c","maps__ObjectAPIName__c"].includes(o)).forEach(o=>{(o.indexOf(l)!==-1||o==="maps__DefaultField__c")&&(r[o]=t[o])}),d={...d,fieldsetName:i,selectedObjOptions:a,fields:r,sObjectApiName:this.selectedObjectApiName,recordtypeid:this.selectedRecordType}}this.modalOptions.callback(d)}}},R={class:"slds-grid slds-grid_align-end"};function k(e,s,d,c,t,i){const l=p("Spinner"),a=p("Picklist"),r=p("SLDSButton"),b=p("Modal");return j(),T(b,{id:"objectConfigSelection",title:e.$Labels.Click2Create_CreateARecord,labels:{close:e.$Labels.MA_Close},class:"slds-modal-fullscreen-phone js-search-modal-wrapper",onClose:s[3]||(s[3]=o=>e.$emit("close-modal"))},{content:m(()=>[A(n(l,null,null,512),[[g,t.isLoading]]),n(a,{modelValue:t.selectedObjectApiName,"onUpdate:modelValue":s[0]||(s[0]=o=>t.selectedObjectApiName=o),inputAttrs:{"data-q3-id":"c2c-object-config-object-selection"},options:t.objects,labels:{name:e.$Labels.Click2Create_RecordToCreate},titleKey:"label",filterable:"",onSelectedOption:i.updateSelectedRecordType},null,8,["modelValue","options","labels","onSelectedOption"]),n(a,{modelValue:t.selectedRecordType,"onUpdate:modelValue":s[1]||(s[1]=o=>t.selectedRecordType=o),inputAttrs:{"data-q3-id":"c2c-object-record-type"},disabled:!t.selectedObjectApiName,options:i.recordTypes,labels:{name:e.$Labels.MA_Record_Type},titleKey:"label"},null,8,["modelValue","disabled","options","labels"])]),footer:m(()=>[M("div",R,[n(r,{"data-q3-id":"c2c-modal-close-button",disabled:t.isLoading,class:"slds-button slds-button_neutral",onClick:s[2]||(s[2]=o=>e.$emit("close-modal"))},{default:m(()=>[_(h(e.$Labels.MA_Cancel),1)]),_:1},8,["disabled"]),n(r,{"data-q3-id":"c2c-modal-next-button",disabled:t.isLoading||!t.selectedObjectApiName||!t.selectedRecordType,class:"slds-button slds-button_brand",onClick:i.nextStep},{default:m(()=>[_(h(e.$Labels.MA_Next),1)]),_:1},8,["disabled","onClick"])])]),_:1},8,["title","labels"])}const $=u(C,[["render",k]]);export{$ as default};
