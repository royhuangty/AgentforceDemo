import{_ as A,P as B,O as D,B as C,r as c,o as p,c as n,i as d,a0 as w,T as x,l as P,ac as M,h as o,F as v,q as y,b as g,w as T,j as L,t as R,n as E,p as O,k as V}from"../bundle.js";import{u as k}from"./index.d251dbc7.js";import{c as f,r as I}from"./index.0172543b.js";const N={name:"DataLayerPopupRow",components:{Picklist:B,TextInput:D,ButtonIcon:C},props:{row:{type:Object,required:!0},sourceLabel:{type:String,required:!0},fields:{type:Array,required:!0}},emits:["remove-row"],data(){return{v$:k({$registerAs:"dataLayerRow"}),source:this.sourceLabel}},validations(){return{row:{topic_id:{required:f.withMessage(this.$Labels.MA_Field_Req,I)}}}},methods:{close(){this.$emit("remove-row")}}},z={class:"slds-grid slds-p-bottom_x-small slds-grid_vertical-align-end"};function q(e,t,i,$,a,s){const m=c("TextInput"),u=c("Picklist"),h=c("ButtonIcon");return p(),n("div",z,[d(m,{modelValue:a.source,"onUpdate:modelValue":t[0]||(t[0]=_=>a.source=_),inputAttrs:{id:"dataLayerPopupSourceIdResource"},readonly:"",labels:{name:e.$Labels.MA_DATA_SOURCE},class:"slds-col slds-size_5-of-12 slds-p-right_small"},null,8,["modelValue","labels"]),d(u,{modelValue:a.v$.row.topic_id.$model,"onUpdate:modelValue":t[1]||(t[1]=_=>a.v$.row.topic_id.$model=_),inputAttrs:{id:"dataLayerPopupTopicPicklistResource"},filterable:"",titleKey:"label",idKey:"id",options:i.fields,labels:{name:e.$Labels.MA_TOPIC},errors:e.$getErrorsByField(a.v$.row.topic_id),class:w({"slds-has-error":a.v$.row.topic_id.$error,"slds-col slds-size_5-of-12":!0})},null,8,["modelValue","options","labels","errors","class"]),d(h,{id:"dataLayerPopupCloseBtnResource",iconCategory:"utility",iconName:"close",size:"small",title:"Close",assistiveText:"Close",class:"slds-col_bump-left slds-m-bottom_xx-small",onClick:s.close},null,8,["onClick"])])}const U=A(N,[["render",q]]);const F={name:"DataLayerPopup",components:{Tooltip:x,SLDSButton:P,ButtonIcon:C,DataLayerPopupRow:U,TextInput:D},inject:["fields","sourceDetails","layerOptions"],data(){return{v$:k({$registerAs:"dataLayerTooltip"}),header:[],tabs:[{tab_id:"defaultTab",tab_label:this.$Labels.MA_Info,data:[]}],selectedTab:"defaultTab",tooltipMapBGStyle:{"background-image":`url(${this.resourceURL}/maps__MapsStyles/dataLayerBuilder/img/mapSample.png)`}}},computed:{popup(){return this.layerOptions.popup},activeTab(){return this.popup.tabs.find(e=>e.tab_id===this.selectedTab)},tabRows(){return this.activeTab?.data||[]}},validations(){return{popup:{tabs:{$each:f.forEach({tab_label:{required:f.withMessage(this.$Labels.MA_Field_Req,I)}})}}}},watch:{"popup.tabs":{handler(e){if(!e.find(i=>i.tab_id===this.selectedTab)&&e.length>0){const i=this.popup.tabs[e.length-1]||{};this.selectedTab=i.tab_id||""}},deep:!0}},created(){if(Array.isArray(this.popup.tabs)&&this.popup.tabs.length>0){const[e]=this.popup.tabs;this.selectedTab=e.tab_id}},methods:{addTabRow(){this.tabRows.push({file_id:this.sourceDetails.source.id,topic_id:""})},addHeaderRow(){this.popup.header.push({file_id:this.sourceDetails.source.id,topic_id:""})},createTooltipTab(){const e=M();this.popup.tabs.push({tab_id:e,tab_label:this.$Labels.MA_New,data:[]}),this.selectedTab=e},handleTooltipClick(e){this.selectedTab=e},async removeTooltipTab(e){this.popup.tabs=this.popup.tabs.filter(i=>i.tab_id!==e),await this.$nextTick();const t=this.popup.tabs.length;if(t===0)this.selectedTab="";else{const i=this.popup.tabs[t-1]||{};this.selectedTab=i.tab_id||""}},removeRow(e,t){e==="header"?this.popup.header.splice(t,1):this.tabRows.splice(t,1)},getErrors(e){return this.v$.popup.tabs.$each.$message[e]}}},G=e=>(O("data-v-32727c15"),e=e(),V(),e),H={style:{"min-width":"900px"}},K={id:"dl-tooltip-setup",class:"tooltipWrap"},j={class:"slds-p-vertical_medium slds-p-horizontal_large",style:{position:"relative"}},Y={class:"hearers-wrap"},W={class:"slds-m-top_x-small"},J={class:"slds-p-horizontal_small slds-p-vertical_medium"},Q={class:"tabs-wrap slds-grid slds-border_bottom"},X=["uid","tab-index"],Z={class:"transparent input slds-col slds-size_9-of-12"},ee={class:"slds-col_bump-left slds-shrink-none"},se={id:"dl-details-wrapper",class:"slds-p-horizontal_large slds-p-bottom_medium",style:{position:"relative"}},te={class:"details-wrap slds-p-bottom_x-small"},ae=G(()=>o("div",{class:"tooltip-arrow"},null,-1));function oe(e,t,i,$,a,s){const m=c("DataLayerPopupRow"),u=c("SLDSButton"),h=c("Tooltip"),_=c("TextInput"),S=c("ButtonIcon");return p(),n("div",H,[o("div",{class:"inline tooltipMapBG",style:E(a.tooltipMapBGStyle)},[o("div",K,[o("div",j,[o("div",Y,[(p(!0),n(v,null,y(s.popup.header,(r,l)=>(p(),g(m,{key:`key_${l}`,row:r,fields:s.fields,sourceLabel:s.sourceDetails.source.label,onRemoveRow:b=>s.removeRow("header",l)},null,8,["row","fields","sourceLabel","onRemoveRow"]))),128))]),o("div",W,[d(h,{text:e.$Labels.MA_ADD_THE_PRIMARY_SET_OF_DATA_YOUD_LIKE_TO_SEE},{source:T(()=>[d(u,{id:"dataLayerPopupAddRowBtnResource",variant:"neutral",iconCategory:"utility",iconName:"add",label:e.$Labels.MA_Add_Row,disabled:s.popup.header.length>=3,onClick:s.addHeaderRow},null,8,["label","disabled","onClick"])]),_:1},8,["text"])])]),o("div",J,[o("div",Q,[(p(!0),n(v,null,y(s.popup.tabs,(r,l)=>(p(),n("div",{id:"dataLayerPopupTabIdResource",key:r.tab_id,class:w(["dl-tab slds-col slds-grid slds-m-right_xx-small",{active:a.selectedTab===r.tab_id}]),uid:r.tab_id,"tab-index":l},[o("div",Z,[d(_,{modelValue:a.v$.popup.tabs.$model[l].tab_label,"onUpdate:modelValue":b=>a.v$.popup.tabs.$model[l].tab_label=b,class:w(["tab-name",{"slds-has-error":a.v$.popup.tabs.$each.$response.$data[l].tab_label.$error}]),type:"text",errors:s.getErrors(l),onChanged:b=>s.handleTooltipClick(r.tab_id)},null,8,["modelValue","onUpdate:modelValue","errors","class","onChanged"])]),d(S,{id:"remove-dl-tab",iconCategory:"utility",iconName:"close",size:"x-small",title:"Close",assistiveText:"Close",class:"slds-col slds-col_bump-left slds-grow-none slds-p-right_x-small",onClick:b=>s.removeTooltipTab(r.tab_id)},null,8,["onClick"])],10,X))),128)),o("div",ee,[d(u,{id:"add-dl-tab",iconName:"add",class:"slds-m-left_xx-small",disabled:s.popup.tabs.length>=6,onClick:s.createTooltipTab},{default:T(()=>[L(R(e.$Labels.MA_ADD_TAB),1)]),_:1},8,["disabled","onClick"])])])]),o("div",se,[o("div",te,[(p(!0),n(v,null,y(s.tabRows,(r,l)=>(p(),g(m,{key:`key_${l}`,row:r,fields:s.fields,sourceLabel:s.sourceDetails.source.label,onRemoveRow:b=>s.removeRow("tab",l)},null,8,["row","fields","sourceLabel","onRemoveRow"]))),128))]),d(h,{text:e.$Labels.MA_ADD_ADDITIONAL_SETS_OF_DATA_YOU_D_LIKE_TO_SEE_ON_THE_TOOLTIP},{source:T(()=>[d(u,{id:"dataLayerPopupAddRowFromTabBtnResource",variant:"neutral",iconCategory:"utility",iconName:"add",disabled:s.tabRows.length>=10||!s.popup.tabs.length,onClick:s.addTabRow},{default:T(()=>[L(R(e.$Labels.MA_Add_Row),1)]),_:1},8,["disabled","onClick"])]),_:1},8,["text"])]),ae])],4)])}const re=A(F,[["render",oe],["__scopeId","data-v-32727c15"]]);export{re as default};
