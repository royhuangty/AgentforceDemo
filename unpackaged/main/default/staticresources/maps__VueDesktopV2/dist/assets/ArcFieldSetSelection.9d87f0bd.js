import{_ as y,S as h,l as L,P as g,f as T,Q as C,r as c,o as S,c as A,b as V,w as p,s as _,v as k,i as a,h as I,j as f,t as b,e as v}from"../bundle.js";import{M as O}from"./Modal.76578f76.js";const M={components:{Spinner:h,Modal:O,SLDSButton:L,Picklist:g},props:{modalOptions:{type:Object,required:!0}},emits:["open-modal","close-modal"],setup(){return{mainStore:T(),formatLabel:C}},data(){return{layerId:"",selectedDataLayer:null,isLoading:!1,dataLayerOptions:[],showMassActionVerification:!1,recordsToCreate:[],recordTypes:[],fieldSets:[],record:"",recordType:"",fieldSet:""}},computed:{modalIsValid(){return this.record&&this.fieldSet&&this.recordType}},async created(){const{availableObjects:e}=this.$props.modalOptions;this.recordsToCreate=e;const[t]=e;t&&(this.record=t.path,await this.getFieldSetData())},methods:{async getFieldSetData(){this.isLoading=!0;try{const e={ajaxResource:"ArcGISAPI",action:"getFieldSet",objectName:this.record},{success:t,fieldSetInfo:m}=await MAPS.Utils.Apex.invoke("maps.RemoteFunctions.processAJAXRequest",[e]);if(t){const{recordTypeInfo:u={},fieldSetInfo:s={}}=m,l=[];Object.values(u).forEach(r=>{l.push(r)}),this.recordTypes=l;const[n]=this.recordTypes;n&&(this.recordType=n.getId);const i=[];Object.values(s).forEach(r=>{i.push(r)}),this.fieldSets=i;const[d]=this.fieldSets;d&&(this.fieldSet=d.getName)}}catch(e){console.warn(e)}finally{this.isLoading=!1}},nextStep(){if(!this.modalIsValid)return;const e=this.fieldSets.find(t=>t.getName===this.fieldSet)??{};this.modalOptions.callback({selectedFieldSet:e,selectedObject:this.record,selectedRecordType:this.recordType}),this.$emit("close-modal")}}},j={class:"slds-grid slds-grid_align-end"};function w(e,t,m,u,s,l){const n=c("Spinner"),i=c("Picklist"),d=c("SLDSButton"),r=c("Modal");return S(),A("div",null,[s.showMassActionVerification?v("",!0):(S(),V(r,{key:0,id:"dataLayerSelection",title:e.$Labels.Click2Create_CreateARecord,labels:{close:e.$Labels.MA_Close},class:"slds-modal-fullscreen-phone js-search-modal-wrapper",onClose:t[4]||(t[4]=o=>e.$emit("close-modal"))},{content:p(()=>[_(a(n,null,null,512),[[k,s.isLoading]]),a(i,{modelValue:s.record,"onUpdate:modelValue":t[0]||(t[0]=o=>s.record=o),inputAttrs:{"data-q3-id":"c2c-select-data-layer"},options:s.recordsToCreate,labels:{name:e.$Labels.Click2Create_RecordToCreate},titleKey:"label",idKey:"path",onSelectedOption:l.getFieldSetData},null,8,["modelValue","options","labels","onSelectedOption"]),a(i,{modelValue:s.recordType,"onUpdate:modelValue":t[1]||(t[1]=o=>s.recordType=o),inputAttrs:{"data-q3-id":"c2c-select-data-layer"},options:s.recordTypes,disabled:s.isLoading,labels:{name:e.$Labels.AGISLB_Modal_Col_Label_Record_Type},titleKey:"getName",idKey:"getId"},null,8,["modelValue","options","disabled","labels"]),a(i,{modelValue:s.fieldSet,"onUpdate:modelValue":t[2]||(t[2]=o=>s.fieldSet=o),inputAttrs:{"data-q3-id":"c2c-select-data-layer"},options:s.fieldSets,disabled:s.isLoading,labels:{name:e.$Labels.Click2Create_ArcGIS_SelectAFieldSet},titleKey:"getLabel",idKey:"getName"},null,8,["modelValue","options","disabled","labels"])]),footer:p(()=>[I("div",j,[a(d,{"data-q3-id":"c2c-close-modal-button",disabled:s.isLoading,class:"slds-button slds-button_neutral",onClick:t[3]||(t[3]=o=>e.$emit("close-modal"))},{default:p(()=>[f(b(e.$Labels.MA_Cancel),1)]),_:1},8,["disabled"]),a(d,{"data-q3-id":"c2c-next-step-modal-button",disabled:s.isLoading||!l.modalIsValid,class:"slds-button slds-button_brand",onClick:l.nextStep},{default:p(()=>[f(b(e.$Labels.MA_Next),1)]),_:1},8,["disabled","onClick"])])]),_:1},8,["title","labels"]))])}const F=y(M,[["render",w]]);export{F as default};
