import{_ as S,B as R,I as f,P as k,S as W,aB as C,L as B,aG as u,r as _,aD as U,s as p,o as i,c as n,b as x,e as M,h as e,t as c,i as m,F as v,q as y,a0 as N,aE as $,v as D,a6 as A,n as P,p as V,k as z}from"../bundle.js";const H={components:{ButtonIcon:R,Icon:f,Picklist:k,Spinner:W},directives:{"click-outside":C},props:{numberOfTilesInRow:{type:Number,default:3},visible:{type:String,required:!0}},emits:["update:visible"],data(){return{tiles:[[{testId:"Radar",name:"radar",label:this.$Labels.NavBar_Weather_Types_Radar,imageURL:`${this.resourceURL}/maps__MapsStyles/OverlaySectionImages/Radar.png`},{testId:"SatVisHires",name:"sat_vis_hires",label:this.$Labels.NavBar_Weather_Types_Clouds,imageURL:`${this.resourceURL}/maps__MapsStyles/OverlaySectionImages/Visible_Satellite.png`},{testId:"Temps",name:"current_temps",label:this.$Labels.NavBar_Weather_Types_Temps,imageURL:`${this.resourceURL}/maps__MapsStyles/OverlaySectionImages/Current_Temperatures.png`}],[{testId:"Alerts",name:"alerts",label:this.$Labels.NavBar_Weather_Types_Alerts,imageURL:`${this.resourceURL}/maps__MapsStyles/OverlaySectionImages/Advisories.png`},{testId:"Winds",name:"current_winds",label:this.$Labels.NavBar_Weather_Types_Winds,imageURL:`${this.resourceURL}/maps__MapsStyles/OverlaySectionImages/Current_Winds.png`},{testId:"Dp",name:"current_dp",label:this.$Labels.NavBar_Weather_Types_Dew_Point,imageURL:`${this.resourceURL}/maps__MapsStyles/OverlaySectionImages/Current_Dew_Points.png`}],[{testId:"Rh",name:"current_rh",label:this.$Labels.NavBar_Weather_Types_Humidity,imageURL:`${this.resourceURL}/maps__MapsStyles/OverlaySectionImages/Current_Humidity.png`},{testId:"WindChill",name:"current_windchill",label:this.$Labels.NavBar_Weather_Types_Wind_Chill,imageURL:`${this.resourceURL}/maps__MapsStyles/OverlaySectionImages/current_windchill.png`},{testId:"HeatIndex",name:"current_heat_index",label:this.$Labels.NavBar_Weather_Types_Heat_Index,imageURL:`${this.resourceURL}/maps__MapsStyles/OverlaySectionImages/current_heat_index.png`}]],activeOverlay:"",overlayObject:null,selectedTime:null,timeOptions:[],opacity:.5,location:{right:"0px"},loading:!1,debounce:null}},computed:{clickOutsideOptions(){return{active:!0,handler:this.close}}},watch:{selectedTime(s){!s||(this.debounce&&clearTimeout(this.debounce),this.debounce=setTimeout(()=>{this.removeOverlay(),this.renderWeatherOverlay()},300))},opacity(s){!s||(this.debounce&&clearTimeout(this.debounce),this.debounce=setTimeout(()=>{this.removeOverlay(),this.renderWeatherOverlay()},300))}},created(){const s=document.querySelector(".weather"),a=document.getElementById("mapcontainer"),l=s.getBoundingClientRect(),{right:d}=l,t=a.clientWidth-d;this.location.right=`${t}px`},methods:{async weatherTileClick(s){this.activeOverlay===s.name?(this.activeOverlay="",this.removeOverlay()):(this.loading=!0,this.activeOverlay=s.name,await this.updateOverlayTimes(),this.renderWeatherOverlay(),this.loading=!1,B.trackFeature({logPayload:{featureName:"weather_overlay",subType:String(this.activeOverlay).toLowerCase().replaceAll(" ","_")}}))},async removeOverlay(){await u.removeTileLayer({id:"weather_tile"})},async renderWeatherOverlay(){await this.removeOverlay();const s=`https://maps.aerisapi.com/aMmtNIJO93b1YWgxPPzjw_N4Bbg4p2hMMhXgO7NgNwGxTjHxbG0DbMeq9YZhPo/${this.activeOverlay}/{z}/{x}/{y}/${this.selectedTime}.png`;u.addWebTileLayer({id:"weather_tile",qid:"weather_tile",urlTemplate:s,opacity:this.opacity})},async updateOverlayTimes(){this.timeOptions=[];const s={ajaxResource:"WeatherAJAXResource",type:this.activeOverlay};try{const{files:a}=await MAPS.Utils.Apex.invoke("maps.RemoteFunctions.processAJAXRequest",[s]);a.forEach(l=>{const d=new Date(l.timestamp*1e3);this.timeOptions.push({id:l.time,title:this.$F("DateTime",d,{"12hour":!0,timeStyle:"short",dateStyle:"short"})})}),this.timeOptions.length>0&&(this.selectedTime=this.timeOptions[0].id)}catch(a){console.warn(a),this.activeOverlay=""}},close(){this.$emit("update:visible","")}}},q=s=>(V("data-v-32897715"),s=s(),z(),s),F={id:"mapTileDropdownWeatherWrap",class:"map-tile-group slds-grid slds-grid_vertical"},j={class:"weather-header slds-grid slds-grid_vertical-align-center"},E={class:"slds-col"},G={class:"slds-align-middle slds-text-heading_small"},J={class:"weather-body slds-col"},X=["onClick"],Y={class:"map-tile-image-wrap"},Z=["src"],K={class:"map-tile-label"},Q=q(()=>e("div",{class:"active-check"},null,-1)),ee={class:"weather-footer"},se={class:"slds-grid"},te={class:"slds-size_1-of-2"},ae={class:"slds-form-element"},ie={class:"slds-form-element__label slds-p-bottom_x-small",for:"weather-slider"},le={class:"slds-slider-label"},re={class:"slds-slider-label__label"},oe={class:"slds-form-element__control"},ne={class:"slds-slider"},ce={class:"slds-slider__value","aria-hidden":"true"},de={class:"slds-size_1-of-2"},_e={class:"slds-form-element__label"};function he(s,a,l,d,t,h){const g=_("Spinner"),b=_("ButtonIcon"),O=_("Icon"),T=_("Picklist"),w=U("click-outside");return p((i(),n("section",{id:"weatherTileDropdown",class:"slds-dropdown",style:P(t.location)},[t.loading?(i(),x(g,{key:0})):M("",!0),e("div",{id:"weatherTileDropdownInner",class:"slds-popover__body",onClick:a[2]||(a[2]=A(()=>{},["stop"]))},[e("div",F,[e("div",j,[e("div",E,[e("h2",G,c(s.$Labels.NavBar_Weather_Types_Header),1)]),e("div",null,[m(b,{id:"weatherDisplayedBtnResource",iconCategory:"utility",iconName:"close",size:"small",title:"Close",assistiveText:"Close",onClick:h.close},null,8,["onClick"])])]),e("div",J,[(i(!0),n(v,null,y(t.tiles,(r,L)=>(i(),n("div",{key:L,class:"slds-grid"},[(i(!0),n(v,null,y(r,(o,I)=>(i(),n("div",{key:I,class:N(["map-tile-weather",{active:t.activeOverlay===o.name}]),onClick:pe=>h.weatherTileClick(o)},[e("div",Y,[e("img",{src:o.imageURL},null,8,Z)]),e("div",K,c(o.label),1),Q,m(O,{id:`weather-${o.testId}-TypesResource`,category:"utility",name:"check",size:"xx-small",class:"active-check-icon",variant:"inverse"},null,8,["id"])],10,X))),128))]))),128))]),p(e("div",ee,[e("div",se,[e("div",te,[e("div",ae,[e("label",ie,[e("span",le,[e("span",re,c(s.$Labels.MA_OPACITY),1)])]),e("div",oe,[e("div",ne,[p(e("input",{id:"weather-slider","onUpdate:modelValue":a[0]||(a[0]=r=>t.opacity=r),min:"0",max:"1",step:"0.1",type:"range",class:"slds-slider__range"},null,512),[[$,t.opacity]]),e("span",ce,c(Math.floor(t.opacity*100))+"%",1)])])])]),e("div",de,[e("label",_e,c(s.$Labels.MAWeather_Time),1),m(T,{modelValue:t.selectedTime,"onUpdate:modelValue":a[1]||(a[1]=r=>t.selectedTime=r),inputAttrs:{id:"weatherDateTimeSelector"},class:"slds-text-color_default",options:t.timeOptions},null,8,["modelValue","options"])])])],512),[[D,t.activeOverlay!==""]])])])],4)),[[w,void 0,h.clickOutsideOptions]])}const ue=S(H,[["render",he],["__scopeId","data-v-32897715"]]);export{ue as default};
