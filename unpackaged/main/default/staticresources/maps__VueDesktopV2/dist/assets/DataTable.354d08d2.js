import{a3 as J,_ as U,J as O,K as q,a4 as Y,B as Q,a5 as N,I as W,r as c,o as r,c as n,i as y,a6 as R,e as d,F as C,q as k,b as h,w as m,a0 as _,a7 as w,Y as x,t as B,h as i,a8 as z,a9 as X,aa as Z,ab as ee,S as se,ac as te,ad as le,U as oe,n as H,ae as re,af as D,ag as L,ah as ae,p as ne,k as ie}from"../bundle.js";const K={name:"ConditionalWrapper",functional:!0,inheritAttrs:!1,props:{element:{type:String,required:!0},active:Boolean},render(){const e=this.$slots.default?this.$slots.default():null;return this.$props.active?J(this.$props.element,{...this.$attrs},e):e}},de={name:"DataTableRow",components:{ActionMenu:O,ActionMenuItem:q,Badge:Y,ButtonIcon:Q,Checkbox:N,ConditionalWrapper:K,Icon:W},inject:["rootProps","rootEmit"],props:["childIndex","depth","parentRef","row"],data(){return{indexOfColumnBeingEdited:null}},methods:{handleCellEdit(e,t){this.indexOfColumnBeingEdited=t;const p=e.path.find($=>["td","th"].includes($.localName)&&$.className.includes("slds-cell-edit"));this.$nextTick(()=>p.querySelector("input").focus())},handleRowAction(e){this.rootEmit("row-action",{action:e,...this.$props})},updateCellValue(e){const t=e.path[0].value;this.$props.row.data[this.indexOfColumnBeingEdited].value=t,this.rootEmit("update-cell",{value:t,row:this.$props.row,columnIndex:this.indexOfColumnBeingEdited}),this.$nextTick(()=>{this.$props.row.data[this.indexOfColumnBeingEdited].error||(this.indexOfColumnBeingEdited=null)})},resetEditMode(){this.indexOfColumnBeingEdited=null}}},ce=["aria-selected","aria-level"],pe={key:0,class:"slds-text-align_center slds-cell_action-mode",role:"gridcell"},ue=["title"],he={key:0,"aria-describedby":"dialog-body-id-1",class:"slds-popover slds-popover slds-popover_edit",role:"dialog",style:{position:"absolute",top:"0px",left:"0.0625rem"}},me={id:"dialog-body-id-1",class:"slds-popover__body"},be={class:"slds-media"},_e={class:"slds-media__body"},fe=["for"],ge={class:"slds-assistive-text"},we={class:"slds-form-element__control slds-grow"},ye=["id","value"],$e={key:0,class:"slds-form-element__help"},ve={key:1,class:"slds-cell_action-mode",role:"gridcell"};function Ce(e,t,p,$,u,s){const f=c("Checkbox"),I=c("Badge"),S=c("ConditionalWrapper"),A=c("ButtonIcon"),P=c("ActionMenuItem"),T=c("ActionMenu");return p.row.hidden?d("",!0):(r(),n("tr",{ref:"row",key:e.$props.row.id,"aria-selected":s.rootProps.multiselectable?e.$props.row.selected||"false":null,"aria-level":e.$props.depth?e.$props.depth:null,class:_([{"slds-is-selected":e.$props.row.selected,"slds-is-edited":e.$props.row.dirty,...(p.row.class||[]).reduce((o,a)=>(o[a]=!0,o),{})},"slds-hint-parent"])},[s.rootProps.multiselectable?(r(),n("td",pe,[y(f,{modelValue:e.$props.row.selected,"onUpdate:modelValue":t[0]||(t[0]=o=>e.$props.row.selected=o),labels:{name:`Select item ${e.$props.childIndex+1}`},hideLabel:"",onClick:t[1]||(t[1]=R(o=>e.$emit("select-row",{e:o,row:p.row}),["prevent","stop"]))},null,8,["modelValue","labels"])])):d("",!0),(r(!0),n(C,null,k(e.$props.row.data,(o,a)=>(r(),h(X(a===0&&!s.rootProps?.multiselectable?"th":"td"),{key:`'Root' + ${a}`,"data-label":s.rootProps.columns[a]?.name,class:_({"slds-cell-edit":s.rootProps?.editableColumnIndices.includes(a),"slds-is-edited":o?.dirty,"slds-has-error":o?.error,"slds-text-align_center":s.rootProps.columns[a]?.alignment==="center","slds-text-align_left":s.rootProps.columns[a]?.alignment==="left"||s.rootProps.columns[a]?.alignment===void 0,"slds-text-align_right":s.rootProps.columns[a]?.alignment==="right"}),scope:a===0?"row":null},{default:m(()=>[y(S,{class:_(["slds-grid slds-grid_align-spread",{"slds-grow":a===0}]),element:"span",style:{width:"100%"},active:s.rootProps?.editableColumnIndices.includes(a)},{default:m(()=>[y(S,{element:"span",class:"slds-grid slds-truncate",active:a===0&&s.rootProps?.editableColumnIndices.includes(a)},{default:m(()=>[o?.type==="custom"?w(e.$slots,"cell",x({key:0,column:s.rootProps.columns[a],columnIndex:a,data:o},{...e.$props,$row:this})):(r(),n(C,{key:1},[o?.type==="badge"?(r(),h(I,{key:0,theme:o.theme,content:o.value},null,8,["theme","content"])):(r(),n("div",{key:1,title:o,class:"slds-truncate"},B(o),9,ue))],64))]),_:2},1032,["active"]),s.rootProps?.editableColumnIndices.includes(a)?(r(),h(A,{key:0,variant:"bare",iconCategory:"utility",iconClass:"slds-button__icon_hint slds-button__icon_edit",iconName:o.locked?"lock":"edit",size:"x-small",class:"slds-cell-edit__button slds-m-left_x-small",title:`Edit ${s.rootProps.columns[a].name} of ${o?.type==="anchor"?o.value:o}`,assistiveText:`Edit ${s.rootProps.columns[a].name} of ${o?.type==="anchor"?o.value:o}`,disabled:o.locked,onClick:b=>s.handleCellEdit(b,a)},null,8,["iconName","title","assistiveText","disabled","onClick"])):d("",!0)]),_:2},1032,["class","active"]),a===u.indexOfColumnBeingEdited?(r(),n("section",he,[i("div",me,[i("div",be,[i("div",_e,[i("div",{class:_(["slds-form-element slds-grid slds-wrap",{"slds-has-error":o.error}])},[i("label",{class:"slds-form-element__label slds-form-element__label_edit slds-no-flex",for:`${s.rootProps.columns[a].name}-${a}`},[i("span",ge,B(s.rootProps.columns[a].name),1)],8,fe),i("div",we,[i("input",{id:`${s.rootProps.columns[a].name}-${a}`,class:"slds-input",type:"text",value:o.value,onBlur:t[2]||(t[2]=(...b)=>s.resetEditMode&&s.resetEditMode(...b)),onKeydown:[t[3]||(t[3]=z(R((...b)=>s.resetEditMode&&s.resetEditMode(...b),["stop"]),["esc"])),t[4]||(t[4]=z(R(b=>s.updateCellValue(b),["stop"]),["enter"]))]},null,40,ye)]),o.error?(r(),n("div",$e,B(o.error),1)):d("",!0)],2)])])])])):d("",!0)]),_:2},1032,["data-label","class","scope"]))),128)),e.$props.row.actions?.length?(r(),n("td",ve,[y(T,{buttonIconSize:"x-small"},{default:m(()=>[(r(!0),n(C,null,k(e.$props.row.actions,(o,a)=>(r(),h(P,{key:a,label:o.label,onClick:b=>s.handleRowAction(o)},null,8,["label","onClick"]))),128))]),_:1})])):d("",!0)],10,ce))}const Se=U(de,[["render",Ce]]);const E={name:"DataTable",components:{ActionMenu:O,ActionMenuItem:q,Checkbox:N,ConditionalWrapper:K,Icon:W,Layout:Z,LayoutItem:ee,Row:Se,Spinner:se},provide(){return{rootProps:this.$props,rootEmit:(...e)=>{this.$emit(e[0],...e.slice(1))}}},props:{actions:Boolean,ariaLabel:{type:String,default:""},bordered:Boolean,bufferCells:Boolean,columns:{type:Array,required:!0},columnsBordered:Boolean,editableColumnIndices:{type:Array,default:()=>[]},fixed:Boolean,hideHeader:Boolean,multiselectable:Boolean,resizable:Boolean,rows:{type:Array,required:!0,default:()=>[]},noRowHover:Boolean,selectAll:Boolean,fullHeader:Boolean,contentHeader:Boolean,sortDesc:Boolean,summaryFooter:Boolean,summaryHeader:Boolean,virtual:Boolean},emits:["column-action","column-sort","row-action","select-all","select-row","load-row","update-cell"],data(){return{lastSelectedRow:null,selectAllState:"none",selectAllId:te(),columnResizer:{},rowHeight:30,containerHeight:0,visibleRowsStartIndex:0,rendering:!1}},computed:{computedRole(){return this.$props.multiselectable?"grid":null},visibleRows(){return this.$props.virtual?this.$props.rows.slice(this.visibleRowsStartIndex,this.visibleRowsStartIndex+200):this.$props.rows},tableContainerPaddingTop(){return this.visibleRowsStartIndex*this.rowHeight},tableContainerPaddingBottom(){return(this.$props.rows.length-this.visibleRows.length)*this.rowHeight-this.tableContainerPaddingTop},hasSelectableColumns(){return this.$props.columns.some(e=>e.selectable)},verticalHeaderCellPadding(){return this.$props.summaryHeader&&this.hasSelectableColumns?"0.75rem":"0.5rem"},selectedPseudoElementTop(){return!this.hasSelectableColumns||!this.$props.summaryHeader?"-4px":0},selectedBorderRadius(){return this.$props.summaryHeader?0:"2px"},selectedColumnBackgroundColor(){return this.$props.columns.find(e=>e.selected)?.icon?.color||"blue"}},watch:{"$props.rows":{handler(e){this.reset(),e.length&&(this.initColumnResizer(),this.$props.virtual&&this.$nextTick(()=>{this.$refs.tableContainer.scrollTop=0,this.containerHeight=this.$refs.tableContainer.offsetHeight})),this.updateSelectAllState()},immediate:!0}},async activated(){this.onActivate()},methods:{async onActivate(){this.$refs.tableContainer.scrollTop=this.currentScrollTop||0},reset(){this.lastScrollTop=0,this.visibleRowsStartIndex=0},async initColumnResizer(){!this.$props.resizable||(await this.$nextTick(),this.columnResizer=new le(this.$refs.table,{disable:!this.$props.resizable,innerGripHtml:"<div class='rangeGrip'></div>",removePadding:!1,minWidth:48}))},async onSelectRow({e,row:t}){const p=[t];if(e.shiftKey&&this.lastSelectedRow){document.getSelection().removeAllRanges();const u=this.$props.rows.findIndex(f=>f===t);let s=this.$props.rows.findIndex(f=>f.id===this.lastSelectedRow.id);for(;s!==-1&&s!==u;)p.push(this.$props.rows[s]),s+=s>u?-1:1}this.lastSelectedRow=t;const $=!t.selected;p.forEach(u=>{u.selected=$}),this.$forceUpdate(),this.updateSelectAllState(),this.$emit("select-row",{e,row:t})},onSelectAll(){const e=this.selectAllState==="none";this.$props.rows.forEach(t=>{t.selected=e}),this.updateSelectAllState(),this.$emit("select-all",e)},updateSelectAllState(){let e=!1,t=!1;this.$props.rows.some(p=>(p.selected&&(e=!0),p.selected||(t=!0),!!(e&&t))),this.selectAllState=e?t?"some":"all":"none"},onScroll(){!this.$props.virtual||(this.currentScrollTop=this.$refs.tableContainer.scrollTop,!(Math.abs((this.$refs.tableContainer?.scrollTop||0)-(this.lastScrollTop||0))>this.rowHeight*20))||(this.rendering=!0,this.lastScrollTop=this.$refs.tableContainer.scrollTop,this.visibleRowsStartIndex=Math.max(0,Math.floor(this.$refs.tableContainer.scrollTop/this.rowHeight)-100),this.debouncedShowRowLoader())},debouncedShowRowLoader:oe.debounce(function(){this.showRowLoader()},250),showRowLoader(){setTimeout(async()=>{await this.$nextTick(),this.rendering=!1},250)},getListeners(e){const t={...e.listeners||{}};return e.selectable&&(t.click=[t.click]),t},getSortDir(e){switch(e.sortDir?.toUpperCase()){case"ASC":return"ascending";case"DESC":return"descending";default:return null}}}},M=()=>{ae(e=>({"3388eda9":e.selectedPseudoElementTop,"22467d20":e.selectedBorderRadius,"25ca634d":e.selectedColumnBackgroundColor,"644e55b5":e.verticalHeaderCellPadding}))},V=E.setup;E.setup=V?(e,t)=>(M(),V(e,t)):M;const ke=E,F=e=>(ne("data-v-febe9547"),e=e(),ie(),e),Be=F(()=>i("div",{class:"slds-text-title_caps",style:{"font-size":".85rem"}}," Loading Rows ",-1)),Re=["aria-multiselectable","aria-label","role"],Ie={key:0},Ae=["colspan"],Pe={key:1},Te=["colspan"],xe={class:"slds-line-height_reset"},Ee={key:0,class:"slds-text-align_center slds-cell_action-mode",scope:"col",style:{padding:"0"}},ze=["id"],He={class:"slds-th__action slds-th__action_form"},De=["data-q3-id","aria-label","aria-sort"],Le={key:0,class:"slds-assistive-text"},Me=["title"],Ve={key:2,class:"slds-assistive-text","aria-live":"polite","aria-atomic":"true"},Ue={key:1,class:"slds-cell_action-mode",scope:"col"},Oe=F(()=>i("div",{class:"slds-truncate slds-assistive-text",title:"Actions"}," Actions ",-1)),qe=[Oe];function Ne(e,t,p,$,u,s){const f=c("Spinner"),I=c("Checkbox"),S=c("Icon"),A=c("ActionMenuItem"),P=c("ActionMenu"),T=c("LayoutItem"),o=c("Layout"),a=c("ConditionalWrapper"),b=c("Row");return r(),n("div",{ref:"tableContainer",class:_(["slds-scrollable slds-grow",{virtual:e.$props.virtual}]),onScroll:t[0]||(t[0]=(...l)=>s.onScroll&&s.onScroll(...l))},[e.$props.virtual?(r(),n("div",{key:0,style:H({height:`${s.tableContainerPaddingTop}px`})},null,4)):d("",!0),u.rendering?(r(),h(f,{key:1,immediate:"",size:"large"},{description:m(()=>[Be]),_:1})):d("",!0),i("table",{ref:"table","aria-multiselectable":e.$props.multiselectable,class:_(["spm-table slds-table",{"slds-table_edit":e.$props.editableColumnIndices.length,"slds-table_bordered":e.$props.bordered,"slds-table_col-bordered":e.$props.columnsBordered,"slds-table_header-hidden":e.$props.hideHeader,"slds-table_cell-buffer":e.$props.bufferCells,"slds-table_resizable-cols slds-table_fixed-layout":e.$props.resizable,"slds-no-row-hover":e.$props.noRowHover,"slds-table_fixed-layout":e.$props.fixed}]),"aria-label":e.$props.ariaLabel,role:s.computedRole},[i("thead",{class:_({"slds-assistive-text":e.$props.hideHeader})},[e.$props.fullHeader?(r(),n("tr",Ie,[i("th",{class:_([{"slds-is-resizable":e.$props.resizable},"slds-line-height_reset"]),scope:"col",style:{padding:"0","background-color":"#fff","font-weight":"400"},colspan:e.$props.columns.length},[w(e.$slots,"header-content-full",{},void 0,!0)],10,Ae)])):d("",!0),e.$props.contentHeader?(r(),n("tr",Pe,[i("th",{class:_([{"slds-is-resizable":e.$props.resizable},"slds-line-height_reset"]),scope:"col",style:{padding:"0","background-color":"#fff"},colspan:"1"},[w(e.$slots,"header-content-left",{},void 0,!0)],2),i("th",{class:_([{"slds-is-resizable":e.$props.resizable},"slds-line-height_reset"]),scope:"col",style:{padding:"0","background-color":"#fff"},colspan:e.$props.columns.length-1},[w(e.$slots,"header-content-right",{},void 0,!0)],10,Te)])):d("",!0),i("tr",xe,[e.$props.multiselectable?(r(),n("th",Ee,[i("span",{id:u.selectAllId,class:"slds-assistive-text"},"Choose a row",8,ze),i("div",He,[y(I,{modelValue:u.selectAllState==="all",indeterminate:u.selectAllState==="some",ariaLabeledBy:u.selectAllId,labels:{name:"Select All"},hideLabel:"",onClick:R(s.onSelectAll,["prevent"])},null,8,["modelValue","indeterminate","ariaLabeledBy","onClick"])])])):d("",!0),(r(!0),n(C,null,k(e.$props.columns,(l,v)=>(r(),n("th",x({key:l.id,"data-q3-id":`lvHeader-${v}`,"aria-label":l.name,"aria-sort":s.getSortDir(l),class:{"slds-is-resizable":e.$props.resizable,"selected-column":l.selected,"selectable-column":l.selectable,"slds-is-sortable":l.sortable,"slds-cell_action-mode":l.sortable,"slds-is-sorted":l.sortDir,"slds-is-sorted_asc":l.sortDir?.toUpperCase()==="ASC","slds-is-sorted_desc":l.sortDir?.toUpperCase()==="DESC","table-header":!l.sortable},style:l.sortable?"padding: 0":null,scope:"col"},re(s.getListeners(l,v),!0)),[l?.type==="custom"?w(e.$slots,"header",{key:0,column:l,columnIndex:v},void 0,!0):(r(),h(a,{key:1,element:"a",active:l.sortable,class:"slds-th__action slds-text-link_reset",href:"#",role:"button",tabindex:"0",onClick:g=>e.$emit("column-sort",l)},{default:m(()=>[l.sortable?(r(),n("span",Le,"Sort by: ")):d("",!0),y(o,{verticalAlign:"center",class:"slds-has-flexi-truncate"},{default:m(()=>[l.icon?(r(),h(S,x({key:0},{size:"x-small",...l.icon},{class:"slds-m-right_x-small"}),null,16)):d("",!0),i("span",{class:"slds-truncate",title:l.name},B(l.name),9,Me),l.sortable?(r(),h(S,{key:1,category:"utility",name:l.sortDir||e.$props.sortDesc?"arrowdown":"arrowup",iconClass:"slds-is-sortable__icon","aria-hidden":"true"},null,8,["name"])):d("",!0),l.actions?(r(),h(T,{key:2,alignmentBump:"left",flexibility:"no-flex",class:"slds-p-left_x-small"},{default:m(()=>[y(P,{buttonIconSize:"xx-small"},{default:m(()=>[(r(!0),n(C,null,k(l.actions,(g,G)=>(r(),h(A,{key:G,label:g.label,onClick:j=>e.$emit("column-action",{action:g,column:l,columnIndex:v},j)},null,8,["label","onClick"]))),128))]),_:2},1024)]),_:2},1024)):d("",!0)]),_:2},1024)]),_:2},1032,["active","onClick"])),l.sortable&&l.sortDir?(r(),n("span",Ve,"Sorted "+B(s.getSortDir(l)),1)):d("",!0)],16,De))),128)),e.$props.actions?(r(),n("th",Ue,qe)):d("",!0)])],2),i("tbody",null,[(r(!0),n(C,null,k(s.visibleRows,(l,v)=>(r(),h(b,{key:`${l.id}-${l.lid}`,row:l,index:v,onSelectRow:s.onSelectRow},{"text-data":m(g=>[w(e.$slots,"text-data",D(L(g)),void 0,!0)]),cell:m(g=>[w(e.$slots,"cell",D(L({...g})),void 0,!0)]),_:2},1032,["row","index","onSelectRow"]))),128))])],10,Re),e.$props.virtual?(r(),n("div",{key:2,style:H({height:`${s.tableContainerPaddingBottom}px`})},null,4)):d("",!0)],34)}const Ke=U(ke,[["render",Ne],["__scopeId","data-v-febe9547"]]);export{Ke as D};
