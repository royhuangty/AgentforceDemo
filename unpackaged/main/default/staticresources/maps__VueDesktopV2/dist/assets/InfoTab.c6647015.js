import{_ as C,S as M,N as L,x as B,aj as F,I as A,B as N,f as O,g as D,m as z,D as g,b1 as P,b2 as U,r as p,o as a,c as u,b as n,e as y,h as r,i as _,w as f,t as E,F as I,q as V,n as j,a6 as T}from"../bundle.js";import{C as q}from"./ConditionValue.f4982441.js";import"./Group.7e0cb254.js";import"./Radio.2202254f.js";import"./index.d251dbc7.js";import"./DatePicker.899772b4.js";import"./TimePicker.bfa4e2f9.js";import"./index.0172543b.js";const H={name:"MarkerPopupInfo",components:{Spinner:M,ConditionValue:q,FieldRenderer:L,ScopedNotification:B,IconSettings:F,Icon:A,ButtonIcon:N},props:{tooltipRows:{type:Array,default:()=>[]},recordId:{type:String,default:""},mapsLayerId:{type:String,default:""}},setup(){const e=O(),s=D();return{mainStore:e,layersStore:s}},data(){return{hasEditing:!1,isLoading:!1,localResourceURL:MAPS.app.config.globalProperties.resourceURL}},computed:{tooltipRowsComp(){return[...this.tooltipRows]},canEditTooltips(){return this.mainStore.settings.infoBubble.editableTooltips&&!this.hasEditing},labels(){return MAPS.app.config.globalProperties.$Labels}},methods:{startEditing(e){if(this.canEditTooltips&&e.updateable){if(e.displayType==="time"){const s=new Date(e.raw);e.updatedRaw={hours:s.getUTCHours(),minutes:s.getUTCMinutes()}}this.hasEditing=!0,e.showEditIcon=!1,e.editing=!0,e.showEditingIcons=!0,e.originalUpdatedRaw=e.updatedRaw,this.$nextTick(()=>{const s=document.getElementById("tooltip-info-wrapper").getElementsByClassName("editField")[0];[...s.getElementsByTagName("button"),...s.getElementsByClassName("slds-radio__label"),...s.getElementsByTagName("input")][0].focus()})}},cancelEditing(e){this.hasEditing=!1,e.editing=!1,e.showEditingIcons=!1,e.updatedRaw=e.originalUpdatedRaw},saveTooltip(e){if(e.editing&&e.previousRaw!==e.updatedRaw){this.isLoading=!0;let s=e.updatedRaw;const d=z(e.displayType);if(d===g.DATE)s=e.updatedRaw.date?`${e.updatedRaw.date.getFullYear()}-${e.updatedRaw.date.getMonth()+1}-${e.updatedRaw.date.getDate()}`:"";else if(d===g.DATETIME){const{date:l,time:o={}}=e.updatedRaw;s="",l&&(s=P({dateObject:l,timeObject:o}))}else if(d===g.TIME){const l=e.updatedRaw.minutes,o=e.updatedRaw.hours;s=Number(o)*3600+Number(l)*60}else d===g.MULTIPICKLIST&&(s=s&&s.join(";"));U.SaveRecord(this.recordId,s,e.useTypeAhead?e.updateField:e.ActualFieldName,this.mapsLayerId).then(()=>{e.editing=!1,e.showEditingIcons=!1,this.hasEditing=!1,this.isLoading=!1}).catch(l=>{this.isLoading=!1,console.warn(l),this.mainStore.toast({message:l,state:"error"})})}else this.cancelEditing(e)}}},K={style:{"min-height":"50px"}},Y={id:"tooltip-info-wrapper",class:"slds-grid slds-grid_vertical"},G={key:0},J=["onMouseenter","onMouseleave","onClick"],Q={style:{width:"30px","text-align":"center"}},W={class:"slds-col slds-size_4-of-12",style:{"font-size":"12px"}},X={class:"slds-col slds-size_5-of-12",style:{"font-size":"12px"}},Z={key:0,class:"editField"};function $(e,s,d,l,o,i){const v=p("Spinner"),x=p("ScopedNotification"),b=p("IconSettings"),m=p("Icon"),R=p("ConditionValue"),S=p("FieldRenderer"),h=p("ButtonIcon");return a(),u("div",K,[o.isLoading?(a(),n(v,{key:0})):y("",!0),r("div",Y,[i.tooltipRowsComp.length?(a(),n(b,{key:1,iconPath:`${o.localResourceURL}/maps__MapsIcons/icons`},{default:f(()=>[(a(!0),u(I,null,V(i.tooltipRowsComp,(t,k)=>(a(),u("div",{key:`tooltipRow_${k}`,style:j([{background:t.showEditIcon?"aliceblue":"unset"},{"min-height":"23px",padding:"0.5rem 0"}]),class:"slds-col slds-grid slds-grid_vertical-align-center slds-border_bottom",onMouseenter:c=>t.showEditIcon=i.canEditTooltips&&t.updateable,onMouseleave:c=>t.showEditIcon=!1,onClick:c=>i.startEditing(t)},[r("div",Q,[t.isColorField?(a(),n(m,{key:0,category:"utility",name:"palette",title:i.labels.modal_MLB_DO_Two_Field_Varied_Color_Section,size:"xx-small"},null,8,["title"])):t.isShapeField?(a(),n(m,{key:1,category:"utility",name:"all",title:i.labels.modal_MLB_DO_Two_Field_Varied_Shape_Section,size:"xx-small"},null,8,["title"])):t.isLabelField?(a(),n(m,{key:2,category:"utility",name:"text",title:i.labels.modal_MLB_DO_Labeled_Pins_Label_Field_Text,size:"xx-small"},null,8,["title"])):t.isOrderField?(a(),n(m,{key:3,category:"utility",name:"filter",title:i.labels.MA_Order_by,size:"xx-small"},null,8,["title"])):y("",!0)]),r("div",W,E(t.fieldLabel),1),r("div",X,[t.editing?(a(),u("div",Z,[_(R,{value:t.updatedRaw,"onUpdate:value":c=>t.updatedRaw=c,displayType:t.displayTypeEnum,multiselectDialog:t.multiselect,picklistOptions:t.PicklistOptions,useTextArea:t.extraTypeInfo&&t.extraTypeInfo.indexOf("textarea")>-1,useTypeAhead:t.useTypeAhead,plottedObject:t.plottedObject,updateField:t.updateField,labels:i.labels,dateOnly:t.dateOnly,range:!1,class:"slds-col"},null,8,["value","onUpdate:value","displayType","multiselectDialog","picklistOptions","useTextArea","useTypeAhead","plottedObject","updateField","labels","dateOnly"])])):(a(),n(S,{key:1,field:t,recordId:d.recordId},null,8,["field","recordId"]))]),t.showEditIcon?(a(),n(h,{key:0,class:"slds-col slds-size_2-of-12 editibleTooltipButton",assistiveText:i.labels.MA_Edit,iconCategory:"utility",iconName:"edit",title:i.labels.MA_Edit,variant:"bare",onClick:T(c=>i.startEditing(t),["stop"])},null,8,["assistiveText","title","onClick"])):y("",!0),t.showEditingIcons?(a(),u(I,{key:1},[_(h,{class:"slds-col slds-grid_align-end slds-size_1-of-12 editibleTooltipButton",assistiveText:i.labels.MA_Save,iconCategory:"utility",iconName:"check",title:i.labels.MA_Save,variant:"bare",onClick:T(c=>i.saveTooltip(t),["stop"])},null,8,["assistiveText","title","onClick"]),_(h,{class:"slds-col slds-grid_align-middle slds-size_1-of-12 editibleTooltipButton",assistiveText:i.labels.MA_Cancel,iconCategory:"utility",iconName:"clear",title:i.labels.MA_Cancel,variant:"bare",onClick:T(c=>i.cancelEditing(t),["stop"])},null,8,["assistiveText","title","onClick"])],64)):y("",!0)],44,J))),128))]),_:1},8,["iconPath"])):(a(),u("div",G,[_(b,{iconPath:`${o.localResourceURL}/maps__MapsIcons/icons`},{default:f(()=>[_(x,null,{content:f(()=>[r("p",null,E(i.labels.Layers_No_Data_To_Show),1)]),_:1})]),_:1},8,["iconPath"])]))])])}const de=C(H,[["render",$]]);export{de as default};
