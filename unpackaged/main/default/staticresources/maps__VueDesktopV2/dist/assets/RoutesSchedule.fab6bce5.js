import{_ as y,P as L,a5 as M,I as A,S as V,r as m,o as b,c as g,b as w,e as k,h as a,t as _,i as o,s as p,v,F as T,q as D,p as O,k as U}from"../bundle.js";import{T as B}from"./TimePicker.bfa4e2f9.js";const R={components:{Picklist:L,Checkbox:M,TimePicker:B,Icon:A,Spinner:V},props:{workingHours:{type:Object,required:!0},routeSettings:{type:Object,required:!0},floatingBreak:{type:Object,required:!0}},emits:["update:workingHours","update:floatingBreak","update:routeSettings"],data(){return{userLocale:MAPS.currentUser.Locale.replace("sh_ME_USD","sh-ME").replace("_","-").slice(0,5),favoriteOptions:[{options:s=>new Promise(async t=>{const e=await this.getFavorites(s);t(e)})}],timeOptions:[],durationOptions:[],transportationModes:[{value:"driving",label:this.$Labels.MA_DRIVING},{value:"walking",label:this.$Labels.MA_WALKING},{value:"bicycling",label:this.$Labels.MA_Bicycle}],optimizationTypes:[{value:"fastest shift completion",label:this.$Labels.MA_Fastest_Shift_Completion},{value:"least windshield time",label:this.$Labels.MA_Least_Windshield_Time}],routeTypes:[{value:"Standard",label:this.$Labels.MA_Standard},{value:"TimeBased",label:this.$Labels.MA_Time_Based_Route}],hasOverNightWorkingHours:!1,startLocation:{id:"",label:""},endLocation:{id:"",label:""},isLoading:!0,invalidBreak:!1}},computed:{settings(){return this.mainStore.settings},daysOfTheWeek(){const s=[{id:"monday",label:this.$Labels.MA_Monday},{id:"tuesday",label:this.$Labels.MA_Tuesday},{id:"wednesday",label:this.$Labels.MA_Wednesday},{id:"thursday",label:this.$Labels.MA_Thursday},{id:"friday",label:this.$Labels.MA_Friday},{id:"saturday",label:this.$Labels.MA_Saturday},{id:"sunday",label:this.$Labels.MA_Sunday}],t=MAPS?.currentUser?.StartOfWeek||"sunday",e=s.findIndex(i=>i.id===t);let n=s.splice(e,s.length-e);return n=[...n,...s],n}},async created(){this.buildDurationOptions(),await this.buildDriveProfiles(),this.checkOverNightStatus(),this.isLoading=!1},methods:{async getFavorites(s){const t={ajaxResource:"WaypointAJAXResources",action:"getDefaultLocationOptions",term:s};try{const{success:e,data:n}=await MAPS.Utils.Apex.invoke("maps.RemoteFunctions.processAJAXRequest",[t]);return e?n:[]}catch(e){return console.error("fav serach error",e),[]}},buildDurationOptions(){let s=5;for(;s<360;)this.durationOptions.push({label:`${Math.floor(s/60)} ${this.$Labels.MA_Hr_Singular}, ${s%60} ${this.$Labels.MA_Min_Singular}`,value:`${Math.floor(s/60)} hr, ${s%60} min`}),s+=5},async buildDriveProfiles(){const s={ajaxResource:"RouteCalendarAJAXResources",action:"getDriveProfiles"};try{const{success:t,data:e}=await MAPS.Utils.Apex.invoke("maps.RemoteFunctions.processAJAXRequest",[s]);if(!t){console.error("Unable to get drive profiles");return}const{driveProfiles:n=[]}=e;n.forEach(r=>{this.transportationModes.push({label:r.Name,value:r.Id})});let i=this.routeSettings.mode;this.transportationModes.filter(r=>r.value===i).length===0&&(i="driving"),this.transportationMode=i}catch(t){console.error("Unable to get drive profiles",t)}},selectTime(s,t){const e=this.workingHours[t.id],{start:n,end:i}=e,d=new Date(`1/1/2013 ${n.hours}:${n.minutes}`),r=new Date(`1/1/2013 ${i.hours}:${i.minutes}`);d>r?e.overnight=!0:e.overnight=!1,this.checkOverNightStatus()},checkOverNightStatus(){const s=Object.keys(this.workingHours);let t=!1;for(let e=0;e<s.length;e++){const n=s[e];if(this.workingHours[n].overnight){t=!0;break}}this.hasOverNightWorkingHours=t},setLabel(s,t){this.routeSettings[t].label=s.Name,this.routeSettings[t].id=s.Id}}},I=s=>(O("data-v-6b5ee620"),s=s(),U(),s),N={id:"Routing-Settings"},P={class:"slds-section slds-is-open"},H={class:"slds-section__title slds-theme_shade"},q={class:"slds-truncate slds-p-horizontal_small"},z={class:"slds-grid slds-wrap slds-grid--vertical slds-p-left_small slds-p-top_small"},F={class:"slds-size_1-of-1 slds-medium-size_3-of-4 slds-large-size_7-of-12"},K={class:"slds-col slds-is-relative route-picklist-icon-adjust"},W={class:"slds-is-absolute route-picklist-icon-wrapper"},E={class:"slds-col slds-is-relative route-picklist-icon-adjust"},x=I(()=>a("div",{class:"slds-is-absolute route-picklist-icon-wrapper",style:{bottom:"15px"}},[a("span",{class:"ma-icon ma-icon-goal",style:{"font-size":"15px"}})],-1)),j={class:"slds-section slds-is-open"},C={class:"slds-section__title slds-theme_shade"},J={class:"slds-truncate slds-p-horizontal_small"},X={class:"slds-notify slds-notify_alert slds-m-vertical_small",role:"alert"},G={class:"slds-p-left_small"},$={class:"slds-grid slds-wrap slds-grid--vertical slds-p-left_small slds-p-top_small"},Q={class:"slds-col"},Y={class:"slds-form-element"},Z={class:"slds-form-element__control",style:{width:"130px"}},ee=["data-q3-id"],se=["for"],te={class:"slds-checkbox_faux"},le={class:"slds-form-element__label",style:{"text-transform":"capitalize","line-height":"30px"}},ae={class:"slds-col"},ie={class:"slds-form-element inline slds-p-right_small time-based-start-select-wrap"},oe={class:"slds-col"},ne={class:"slds-form-element inline slds-p-right_small time-based-start-select-wrap"},de={key:0,class:"slds-col",style:{"line-height":"24px"}},re={class:"slds-section slds-is-open"},ue={class:"slds-section__title slds-theme_shade"},ce={class:"slds-truncate slds-p-horizontal_small"},_e={class:"slds-p-left_small slds-p-top_small"},me={class:"slds-grid slds-wrap slds-grid--vertical slds-p-left_small slds-p-top_small"},be={class:"slds-grid"},he={class:"slds-col"},ge={class:"slds-form-element inline slds-p-right_small time-based-start-select-wrap"},pe={class:"slds-col"},ve={class:"slds-form-element inline slds-p-right_small time-based-start-select-wrap"};function fe(s,t,e,n,i,d){const r=m("Spinner"),c=m("Picklist"),f=m("Icon"),S=m("Checkbox"),h=m("TimePicker");return b(),g("div",N,[i.isLoading?(b(),w(r,{key:0})):k("",!0),a("div",P,[a("h3",H,[a("span",q,_(s.$Labels.MapsSetting_General),1)]),a("div",z,[a("div",F,[o(c,{id:"RouteMode",modelValue:e.routeSettings.mode.value,"onUpdate:modelValue":t[0]||(t[0]=l=>e.routeSettings.mode.value=l),options:i.transportationModes,class:"slds-p-bottom_small",titleKey:"label",idKey:"value",labels:{name:s.$Labels.MA_Default_Transportation_Mode},readonly:!e.routeSettings.mode.unlocked},null,8,["modelValue","options","labels","readonly"]),o(c,{id:"RouteMode",modelValue:e.routeSettings.optimizationType.value,"onUpdate:modelValue":t[1]||(t[1]=l=>e.routeSettings.optimizationType.value=l),options:i.optimizationTypes,class:"slds-p-bottom_small",helpText:`${s.$Labels.MA_Fastest_Shift_Completion}: ${s.$Labels.routes_Settings_Earliest_Text}

${s.$Labels.MA_Least_Windshield_Time}: ${s.$Labels.routes_Settings_Shortest_Text}`,titleKey:"label",idKey:"value",labels:{name:s.$Labels.routes_Settings_OptimizeBy},readonly:!e.routeSettings.optimizationType.unlocked},null,8,["modelValue","options","helpText","labels","readonly"]),a("div",K,[a("div",W,[o(f,{category:"utility",name:"priority",size:"x-small"})]),o(c,{modelValue:e.routeSettings.startLocation.label,"onUpdate:modelValue":t[2]||(t[2]=l=>e.routeSettings.startLocation.label=l),inputAttrs:{"data-q3-id":"userSettingsStartLocation"},filterable:"",titleKey:"Name",class:"slds-p-bottom_small",idKey:"Id",labels:{name:s.$Labels.MA_Default_Start_Location,search:s.$Labels.MA_Search_Fav_Loc,noSearchResults:s.$Labels.MA_NO_RESULTS_FOUND},options:i.favoriteOptions,disabled:!e.routeSettings.startLocation.unlocked,onSelectedOption:t[3]||(t[3]=l=>d.setLabel(l,"startLocation"))},null,8,["modelValue","labels","options","disabled"])]),a("div",E,[x,o(c,{modelValue:e.routeSettings.endLocation.label,"onUpdate:modelValue":t[4]||(t[4]=l=>e.routeSettings.endLocation.label=l),inputAttrs:{"data-q3-id":"userSettingsEndLocation"},filterable:"",titleKey:"Name",idKey:"Id",class:"slds-p-bottom_small",labels:{name:s.$Labels.MA_Default_End_Location,search:s.$Labels.MA_Search_Fav_Loc,noSearchResults:s.$Labels.MA_NO_RESULTS_FOUND},options:i.favoriteOptions,disabled:!e.routeSettings.endLocation.unlocked,onSelectedOption:t[5]||(t[5]=l=>d.setLabel(l,"endLocation"))},null,8,["modelValue","labels","options","disabled"])]),o(c,{id:"RouteMode",modelValue:e.routeSettings.type.value,"onUpdate:modelValue":t[6]||(t[6]=l=>e.routeSettings.type.value=l),options:i.routeTypes,class:"slds-p-bottom_small",titleKey:"label",idKey:"value",labels:{name:s.$Labels.MA_Label_Default_Route_Type},readonly:!e.routeSettings.type.unlocked},null,8,["modelValue","options","labels","readonly"]),o(c,{id:"RouteMode",modelValue:e.routeSettings.duration.value,"onUpdate:modelValue":t[7]||(t[7]=l=>e.routeSettings.duration.value=l),options:i.durationOptions,class:"slds-p-bottom_small",titleKey:"label",idKey:"value",labels:{name:s.$Labels.MA_Default_Event_Duration},readonly:!e.routeSettings.duration.unlocked},null,8,["modelValue","options","labels","readonly"]),o(S,{modelValue:e.routeSettings.enabledDuplicateStops.value,"onUpdate:modelValue":t[8]||(t[8]=l=>e.routeSettings.enabledDuplicateStops.value=l),inputAttrs:{"data-q3-id":"userSettingsDuplicateStops"},class:"slds-p-bottom_small",labels:{name:s.$Labels.routes_Settings_Enable_Duplicate_Stops},readonly:!e.routeSettings.enabledDuplicateStops.unlocked},null,8,["modelValue","labels","readonly"])])])]),a("div",j,[a("h3",C,[a("span",J,_(s.$Labels.MA_Shift_Times),1)]),p(a("div",X,[o(f,{category:"utility",name:"info",size:"small",variant:"inverse"}),a("span",G,_(s.$Labels.routes_Settings_Time_Validation),1)],512),[[v,i.hasOverNightWorkingHours]]),a("div",$,[(b(!0),g(T,null,D(d.daysOfTheWeek,l=>(b(),g("div",{key:l.id,class:"slds-grid slds-p-vertical_xx-small"},[a("div",Q,[a("div",Y,[a("div",Z,[a("div",{class:"slds-checkbox","data-q3-id":`userSettingsWorkingDay-${l.id}`},[a("label",{for:`${l.id}_workingDay`,class:"slds-checkbox__label"},[p(a("span",te,null,512),[[v,!1]]),a("span",le,_(l.label),1)],8,se)],8,ee)])])]),a("div",ae,[a("div",ie,[o(h,{modelValue:e.workingHours[l.id].start,"onUpdate:modelValue":[u=>e.workingHours[l.id].start=u,u=>d.selectTime(u,l,"start")],modelModifiers:{value:!0},inputAttrs:{"data-q3-id":`userSettingsWorkingDay-${l.id}-start`},start:e.workingHours[l.id].startTime,locale:i.userLocale,disabled:!e.workingHours[l.id].unlocked,interval:{hours:0,minutes:15}},null,8,["modelValue","onUpdate:modelValue","inputAttrs","start","locale","disabled"])])]),a("div",oe,[a("div",ne,[o(h,{modelValue:e.workingHours[l.id].end,"onUpdate:modelValue":[u=>e.workingHours[l.id].end=u,u=>d.selectTime(u,l,"end")],modelModifiers:{value:!0},inputAttrs:{"data-q3-id":`userSettingsWorkingDay-${l.id}-end`},start:e.workingHours[l.id].endTime,locale:i.userLocale,disabled:!e.workingHours[l.id].unlocked,interval:{hours:0,minutes:15}},null,8,["modelValue","onUpdate:modelValue","inputAttrs","start","locale","disabled"])])]),e.workingHours[l.id].overnight?(b(),g("div",de," * "+_(s.$Labels.routes_Settings_Time_Notification),1)):k("",!0)]))),128))])]),a("div",re,[a("h3",ue,[a("span",ce,_(s.$Labels.MA_Break_Information),1)]),a("div",_e,[o(S,{modelValue:e.floatingBreak.enabled.value,"onUpdate:modelValue":t[9]||(t[9]=l=>e.floatingBreak.enabled.value=l),inputAttrs:{"data-q3-id":"userSettingsFloatingBreak"},disabled:!e.floatingBreak.enabled.unlocked,labels:{name:s.$Labels.MA_Include_Break}},null,8,["modelValue","disabled","labels"])]),p(a("div",me,[a("div",be,[a("div",he,[a("div",ge,[o(h,{modelValue:e.floatingBreak.start,"onUpdate:modelValue":t[10]||(t[10]=l=>e.floatingBreak.start=l),modelModifiers:{value:!0},disabled:!e.floatingBreak.enabled.unlocked,locale:i.userLocale,interval:{hours:0,minutes:15}},null,8,["modelValue","disabled","locale"])])]),a("div",pe,[a("div",ve,[o(h,{modelValue:e.floatingBreak.end,"onUpdate:modelValue":t[11]||(t[11]=l=>e.floatingBreak.end=l),modelModifiers:{value:!0},locale:i.userLocale,disabled:!e.floatingBreak.enabled.unlocked,interval:{hours:0,minutes:15}},null,8,["modelValue","locale","disabled"])])])])],512),[[v,e.floatingBreak.enabled.value]])])])}const ye=y(R,[["render",fe],["__scopeId","data-v-6b5ee620"]]);export{ye as default};
