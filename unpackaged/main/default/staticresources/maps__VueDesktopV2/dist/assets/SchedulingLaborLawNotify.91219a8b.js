import{ag as De,X as ve,ah as Ee}from"./index.2826ab44.js";import{aP as S,_ as x,o as b,c as v,h as m,t as g,e as N,T as z,r as D,b as w,w as E,p as K,k as X,I as ee,i as T,c5 as Le,aT as J,f as te,c2 as A,L as Ie,bR as Q,bQ as Z,aQ as k,ac as C,aU as W,Q as Me,P as ke,J as _e,K as he,B as me,l as fe,F as G,q as j,j as pe,u as Ce,s as ue,c6 as we,v as xe,a9 as Oe}from"../bundle.js";import{R as Ne}from"./routing.d6c1f97a.js";import{D as Pe}from"./DatePicker.899772b4.js";function $e(e){return[e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond]}function H(e,t,s){return S.fromObject({year:e[0],month:e[1]+1,day:e[2],hour:e[3],minute:e[4],second:e[5],millisecond:e[6]},{locale:s,zone:t})}class Re extends De{offsetForArray(t){return H(t,this.timeZoneName).offset}timestampToArray(t){return $e(S.fromMillis(t,{zone:this.timeZoneName}))}}function Ue(e,t){let s=Se(e);if(t.end){let a=H(t.start.array,t.timeZone,t.localeCodes[0]),o=H(t.end.array,t.timeZone,t.localeCodes[0]);return Y(s,a.toFormat.bind(a),o.toFormat.bind(o),t.defaultSeparator)}return H(t.date.array,t.timeZone,t.localeCodes[0]).toFormat(s.whole)}function Se(e){let t=e.match(/^(.*?)\{(.*)\}(.*)$/);if(t){let s=Se(t[2]);return{head:t[1],middle:s,tail:t[3],whole:t[1]+s.whole+t[3]}}return{head:null,middle:null,tail:null,whole:e}}function Y(e,t,s,a){if(e.middle){let l=t(e.head),d=Y(e.middle,t,s,a),_=t(e.tail),u=s(e.head),c=Y(e.middle,t,s,a),r=s(e.tail);if(l===u&&_===r)return l+(d===c?d:d+a+c)+_}let o=t(e.whole),i=s(e.whole);return o===i?o:o+a+i}var Ts=ve({name:"@fullcalendar/luxon3",cmdFormatter:Ue,namedTimeZonedImpl:Re});const We={props:{event:{type:Object,default:()=>{}}}},Fe={class:"waypoint-error slds-grid slds-grid_vertical"},He={class:"slds-p-bottom_xx-small"},ze={key:0};function Je(e,t,s,a,o,i){return b(),v("div",Fe,[m("p",He,g(s.event.errorMessage),1),s.event.errorTimeString?(b(),v("p",ze,"Additional time needed: "+g(s.event.errorTimeString),1)):N("",!0)])}const Ds=x(We,[["render",Je]]),Be=""+MAPS.getURLPath({base:"/resource/1730379547462/maps__VueDesktopV2/dist/",path:"assets/einstein_tooltip_figure.72622fce.svg"});const qe={components:{Tooltip:z},props:{value:{type:[Number,String],required:!0},fieldLabel:{type:String,required:!0},priorityIndex:{type:[Number,String],required:!0}},methods:{async source(){return await this.$nextTick(),this.$el.parentNode}}},be=e=>(K("data-v-825a624b"),e=e(),X(),e),Ve={class:"slds-grid slds-grid_vertical-align-center"},Qe=be(()=>m("div",{class:"slds-p-right_small"},null,-1)),Ze={class:"slds-col"},Ge={class:"einstein-field-name"},je={class:"einstein-tooltip_field"},Ye=be(()=>m("div",{class:"einstein-figure"},[m("img",{src:Be,alt:"Einstein"})],-1));function Ke(e,t,s,a,o,i){const l=D("Tooltip");return b(),w(l,{assistiveText:e.$Labels.MA_HELP,source:i.source,class:"slds-popover_tooltip_einstein"},{default:E(()=>[m("div",Ve,[Qe,m("div",Ze,[m("div",Ge,g(s.fieldLabel),1),m("div",je,"Priority "+g(s.priorityIndex),1)]),Ye])]),_:1},8,["assistiveText","source"])}const Xe=x(qe,[["render",Ke],["__scopeId","data-v-825a624b"]]),et="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKgAAABCCAMAAAD0Sm1iAAACHFBMVEUAAAAAN1ACLWEDLWECLmEAnN8DLmECLmADLWAAoeEAouIALWAAJl4DLmEAouICLWEAoeEAoOAALGADLmICLWAAnt4AoeECLmEBLWEApOUAoeEAo+IDLmICLmEAouADLWEAouECLWEAoeADLmEALGIAKmACLWEAouEAouIAoeEDLWACLmECLWECLWEAoeEDLWAAoOAAoeIDL2MCLmIAouIDLmEAouIAouEALWEAn98Ao+MApOUAo+MDLmIDLmEAouICLmAELWEDLWAALmAALV8AoOAAKl4DLmIAoeAAouMAoeADLWEAoeECLWAAoeEAoeECLWEAoeIDLGACLWEAoOAAouAAouIAouICLmEAoeEAn+AALGEAo+MDLmIAouEAouIAoOAAoeIAoeAALWEAod8CLGEALGAAoeAAnd////8AoOAAn98AqOoDMWcAo+MApOUAp+gDMWkApucAnN4ApeYHouAAmd7W7/oDMGUDLmEOpOEDoeADL2Pe8vs7tOY0seUoreQLo+EFoOD9/v/5/f7h8/xgw+xdwutYv+pHueg3subn9vyT1fJSvepDt+cequMZp+JMu+kcqeMDMWaK0vCEz/B4y+5AtucwsOUhq+QVpuLz+v7c8frN7PmM0/F9ze96y+5nxewtr+Xt+P3J6vi24vat3/Wh2/Px+f3S7fnC5/io3fSb2PNxyO33+/6l3PRtx+10ye30+/4AldzwZdx6AAAAZ3RSTlMABJlh0wStl2QJ5SwI8dZoTUIU9osWENcw/fTv7du+po6CVEYPDOTaxaGdf3duY1U7NvvQysSxmxwa+/XRv7mne0RANyUjGerPubazk5N7dXJvXEwrH/rqoWkxIN7Kq5eBXEc1hTkoimq2EwAACIVJREFUaN7Nmndf2kAYgA+rVBCoe2+tWmfd3bbV7r33HsllkDBFpAIuwL23dbRq9/yCvYRhqnSoIDx/GO4Ofj7c+753RwB440TkeUVySsHFqP0giDlxqSBZq1ZiGMMqb9U8iQfByY3zKZRWiblQsur8KxLBsOTuk4uZmY9L9wbav1RKIUshDFu11z16N1Nxk6UQrFJaFxkGAoakVs1g61AfvMOPXq+7STGrc80URIIAEX+Wwryh1D5Go1dS1oyqk2oDkwCS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";const tt={components:{Tooltip:z},props:{value:{type:[Number,String],required:!0},fieldLabel:{type:String,required:!0},sfdcFieldType:{type:String,default:"number"},priorityIndex:{type:[Number,String],required:!0}},computed:{formattedValue(){const e=Number(this.value);return Number.isNaN(e)?"":this.sfdcFieldType==="currency"?this.$F("Currency",e):this.$F("Numeric",e)}},methods:{async source(){return await this.$nextTick(),this.$el.parentNode}}},st=e=>(K("data-v-a8b18f46"),e=e(),X(),e),at={class:"slds-grid"},it={class:"slds-col slds-p-right_x-large"},ot={class:"pardot-tooltip_value"},rt={class:"pardot-tooltip_field"},nt={class:"pardot-tooltip_priority-field slds-p-bottom_small"},lt=st(()=>m("div",{class:"pardot-figure"},[m("img",{src:et,alt:"Pardot"})],-1));function dt(e,t,s,a,o,i){const l=D("Tooltip");return b(),w(l,{assistiveText:e.$Labels.MA_HELP,source:i.source,class:"slds-popover_tooltip_pardot"},{default:E(()=>[m("div",at,[m("div",it,[m("div",ot,g(i.formattedValue),1),m("div",rt,g(s.fieldLabel),1),m("div",nt,"Priority "+g(s.priorityIndex),1)]),lt])]),_:1},8,["assistiveText","source"])}const ct=x(tt,[["render",dt],["__scopeId","data-v-a8b18f46"]]);const ut={components:{Tooltip:z,Icon:ee},props:{value:{type:[Number,String],required:!0},fieldLabel:{type:String,required:!0},sfdcFieldType:{type:String,default:"number"},priorityIndex:{type:[Number,String],required:!0},alignment:{type:String,default:"top"}},computed:{formattedValue(){const e=Number(this.value);return Number.isNaN(e)?"":this.sfdcFieldType==="currency"?this.$F("Currency",e):this.$F("Numeric",e)}},methods:{async source(){return await this.$nextTick(),this.$el.parentNode}}},_t={class:"slds-popover__body slds-grid slds-grid_vertical-align-center"},ht={class:"slds-p-right_small"},mt={class:"priority-tooltip_icon"},ft={class:"slds-col"},pt={class:"priority-tooltip_value slds-p-bottom_x-small"},St={class:"priority-tooltip_field slds-p-bottom_x-small"},bt={class:"priority-tooltip_priority-field"};function gt(e,t,s,a,o,i){const l=D("Icon"),d=D("Tooltip");return b(),w(d,{assistiveText:e.$Labels.MA_HELP,source:i.source,alignment:s.alignment,class:"slds-popover_tooltip_priority"},{default:E(()=>[m("div",_t,[m("div",ht,[m("div",mt,[T(l,{category:"utility",name:"arrowup",style:{"margin-top":"2px"},variant:"inverse",size:"x-small"})])]),m("div",ft,[m("div",pt,g(i.formattedValue),1),m("div",St,g(s.fieldLabel),1),m("div",bt,"Priority "+g(s.priorityIndex),1)])])]),_:1},8,["assistiveText","source","alignment"])}const yt=x(ut,[["render",gt],["__scopeId","data-v-9a5e69b7"]]),At=Le.getDefaultSettingsGroup(),vs={props:{base__showFullScreenToggleControl:{type:Boolean,required:!0}},emits:["error","update:base__storedIsLoading"],setup(){const e=J(),t=te();return{scheduleStore:e,mainStore:t}},data(){return{base__calendar:null,base__calendarId:MAPS.currentUser.Id,locationCache:new Map,base__searchTerm:MAPS.currentUser.Name,base__isLoading:this.base__storedIsLoading,base__performedScrollToLogic:!1,base__configErrors:{},base__saveWarnings:{},base__events:[],base__callouts:0,base__eventIdsForDelete:[],base__locationIdsForDelete:[],base__showPendingChangeModal:!1,base__updatedEventsSet:new Set,base__columnIdToDayInstance:{},base__hasModifiedEvents:!1,base__storedNavigationAction:null,base__skipTimeAxisCheck:!1,queueUnwatch:null,resourceProfileId:"",isResourceView:!1,sortQueueDebounce:null}},computed:{base__laborLawNotify(){return this.mainStore?.settings?.routes?.showLaborLawNotification||!1},base__doDisableSaveBtn(){return!this.scheduleStore.eventIdsForDelete.length&&!this.scheduleStore.hasModifiedEvents&&!this.scheduleStore.locationIdsForDelete.length&&!this.scheduleStore.hasModifiedShifts},base__showControls(){return!this.scheduleStore.isMonth},base__showSaveErrorModal(){return Object.keys(this.base__configErrors).length||Object.keys(this.base__saveWarnings).length},base__hasPendingChanges(){return this.scheduleStore.hasModifiedEvents||this.scheduleStore.hasModifiedShifts||this.scheduleStore.locationIdsForDelete.length},queueLength(){return this.scheduleStore.queue.length}},watch:{base__showSaveErrorModal(e){if(e){let t={};Object.keys(this.base__configErrors).length&&(t=this.base__configErrors),Object.keys(this.base__saveWarnings).length&&(t=this.base__saveWarnings),this.base__configErrors={},this.base__saveWarnings={},this.$bus.emit("open-modal",{name:"schedule-save-error",config:{errors:t,callback:({action:s,eventIds:a,configId:o})=>{s==="hide"||(s==="ignore"?this.saveIgnore():s==="save"&&this.setConfigId({eventIds:a,configId:o}))}}})}},queueLength(e,t){e!==t&&this.base__calculateEventPriorityIndex()},"scheduleStore.events":{handler(e,t){if(e.length!==t.length)this.base__calculateEventPriorityIndex();else for(let s=0;s<e.length;s++)if(e[s].start!==t[s].start||e[s].priority===0){this.base__calculateEventPriorityIndex();return}}}},methods:{base__getDayNamesShort(){return[this.$Labels.MA_Sunday_Short,this.$Labels.MA_Monday_Short,this.$Labels.MA_Tuesday_Short,this.$Labels.MA_Wednesday_Short,this.$Labels.MA_Thursday_Short,this.$Labels.MA_Friday_Short,this.$Labels.MA_Saturday_Short]},base__getDayNames(){return[this.$Labels.MA_Sunday,this.$Labels.MA_Monday,this.$Labels.MA_Tuesday,this.$Labels.MA_Wednesday,this.$Labels.MA_Thursday,this.$Labels.MA_Friday,this.$Labels.MA_Saturday]},base__getMonthNames(){return[this.$Labels.MA_January,this.$Labels.MA_February,this.$Labels.MA_March,this.$Labels.MA_April,this.$Labels.MA_May,this.$Labels.MA_June,this.$Labels.MA_July,this.$Labels.MA_August,this.$Labels.MA_September,this.$Labels.MA_October,this.$Labels.MA_November,this.$Labels.MA_December]},base__getMonthNamesShort(){return[this.$Labels.MA_January_Short,this.$Labels.MA_February_Short,this.$Labels.MA_March_Short,this.$Labels.MA_April_Short,this.$Labels.MA_May_Short,this.$Labels.MA_June_Short,this.$Labels.MA_July_Short,this.$Labels.MA_August_Short,this.$Labels.MA_September_Short,this.$Labels.MA_October_Short,this.$Labels.MA_November_Short,this.$Labels.MA_December_Short]},async base__calculateEventPriorityIndex(){this.sortQueueDebounce!==null&&clearTimeout(this.sortQueueDebounce),this.sortQueueDebounce=setTimeout(async()=>{const e=this.scheduleStore.events.concat(this.scheduleStore.queue).filter(t=>t.spatial);this.scheduleStore.scheduleWorker.addListener("sortedPriority",async({sortedArray:t})=>{let s=t.length;t.forEach((a,o)=>{const i=e.find(l=>l.id===a.id);i.priority=o+1,i.priorityIndex=s--}),await this.scheduleStore.sortQueue(),this.scheduleStore.scheduleWorker.removeListener("sortedPriority")}),this.scheduleStore.scheduleWorker.sendQuery("sortPriority",{combinedPriorityArray:JSON.parse(JSON.stringify(e))})},500)},async base__changeCalendarView(e){this.base__clearRoutes(),this.scheduleStore.setView(e),await this.$nextTick(),e!==A.TIMELINE_DAY&&!this.isResourceView&&(this.base__calendar.changeView(e,this.scheduleStore.calendarDate),this.base__resizeCalendarDelayed()),this.base__emitViewModeChangeEvent(e)},base__changeCalendarDate(e){this.base__clearRoutes(),this.base__calendar.gotoDate(e),this.scheduleStore.setDate(this.base__getCalendarDate())},async base__today(){this.base__clearRoutes(),await this.$nextTick(),this.base__calendar.today(),this.scheduleStore.setDate(this.base__getCalendarDate())},async base__previous(){this.base__clearRoutes(),await this.$nextTick(),this.base__calendar.prev(),this.scheduleStore.setDate(this.base__getCalendarDate())},async base__next(){this.base__clearRoutes(),await this.$nextTick(),this.base__calendar.next(),this.scheduleStore.setDate(this.base__getCalendarDate())},base__clearRoutes(){this.scheduleStore.calendarView===A.TIMELINE_DAY?this.unrenderRoutesFromMap():Object.keys(this.scheduleStore.columnIdToDayInstance).forEach(e=>{const t=this.scheduleStore.columnIdToDayInstance[e],{shifts:s=[]}=t;s.forEach(a=>{this.resetRouteDataByShiftId(a.id)})})},base__navigationAction(e,t){const s=()=>{this.$nextTick(()=>{this.resetComponentState(),e(t)})};if(this.base__hasPendingChanges){this.base__storedNavigationAction=s,this.$bus.emit("open-modal",{name:"generic-confirm",config:{title:this.$Labels.MA_SCHEDULE_SAVE_SCHEDULE_CHANGES_PROMPT,yesLabel:this.$Labels.MA_Close_Discard,noLabel:this.$Labels.MA_Cancel,callback:({action:a})=>{a==="yes"&&this.base__storedNavigationAction()}}});return}s()},base__setConfigId(e){e.eventIds.forEach(t=>{const s=this.scheduleStore.events.find(a=>a.id===t);!s||(s.configId=e.configId)})},base__completeNavigationRequest(){this.base__storedNavigationAction()},base__saveAndCompleteNavigationRequest(){this.base__save().then(()=>{this.$parent.base__showSaveErrorModal||this.base__storedNavigationAction()})},base__save({doClone:e=!1,cloneSourceDate:t=null,cloneTargetDate:s=null,doCloneStartEndLocations:a=!1,ignoreSaveChecks:o=!1}={}){return new Promise((i,l)=>{this.base__checkScheduleQueue().then(async()=>{try{let d=0;this.scheduleStore.callouts+=1;const _=[];if(e){const r=S.fromJSDate(s),n=S.fromJSDate(t),{days:h}=r.startOf("day").diff(n.startOf("day"),"days");d=h*864e5}const u=this.mainStore?.licensing?.guide||!1;this.base__calendar.getEvents().forEach(r=>{const{extendedProps:n}=r;if(n.renderType==="non-working-hours"||n.isBreak||n.renderType==="location")return;const h=S.fromJSDate(r.start).plus({milliseconds:d}).toJSDate(),f=S.fromJSDate(r.end).plus({milliseconds:d}).toJSDate(),p=this.scheduleStore.events.find(L=>L.id===r.id),y=this.base__adjustToUserTimezone(h),M=this.base__adjustToUserTimezone(f),I={startTime:y.getTime(),endTime:M.getTime(),recordId:p.recordId,doClone:e,relationshipId:p.relationshipId,subject:p.title,layerId:p.maps__MarkerLayer__c,baseObjectId:p.baseObjectId,configId:p.configId,ownerId:p.resourceId||this.base__calendarId,uid:p.id,location:{latLng:{lat:p.lat,lng:p.lng},address:p.maps__Address__c||p.address,city:p.city||"",state:p.state||"",postalCode:p.postalCode||"",street:p.street||"",country:p.country||""},isMALocation:p.isMALocation||!1};if(u){const{guideWaypoint:L={}}=p;L.hasWaypoint&&(I.guideWaypoint=L)}(e||this.scheduleStore.updatedEventsSet.has(I.uid))&&_.push(I)}),this.scheduleStore.queue.forEach(r=>{r.recordId&&(this.scheduleStore.eventIdsForDelete.push(r.recordId),r.recordId=null)});const c={events:_,eventIdsForDelete:this.scheduleStore.eventIdsForDelete,shiftsForUpsert:this.scheduleStore.isTimelineDay?[]:this.prepareShiftRecordsForUpsert(d,a),calendarId:this.base__calendarId,ignoreSaveChecks:o};Ie.trackFeature({logPayload:{featureName:"save_schedule"}});try{const r=await MAPS.Utils.Apex.invoke("maps.RemoteFunctions.saveCalendarEvents",[JSON.stringify(c)]);if(r.success)r.configMissing&&r.multipleConfigs?(Object.keys(r.multipleConfigs).length!==0?this.base__configErrors={...r.multipleConfigs}:this.base__configErrors={...r.configMissing},await this.$nextTick(),l()):r.saveWarnings?(this.base__saveWarnings=r.saveWarnings,await this.$nextTick(),l()):(this.scheduleStore.hasModifiedEvents=!1,this.scheduleStore.updatedEventsSet.clear(),i());else{let n=r.message;n.includes("FIELD_INTEGRITY_EXCEPTION")&&(n=this.$Labels.Schedule_Error_Field_Integrity_Exception),r.dmlException===!0?this.$emit("error",{message:this.$Labels.Schedule_Not_Saved,subMessage:r.message}):this.$emit("error",this.$Labels.Schedule_Error_Schedule_Not_Saved),l()}this.scheduleStore.callouts-=1}catch(r){this.base__handleRemoteActionError(r),l()}}catch(d){console.error(d),this.scheduleStore.callouts-=1,this.$emit("error",d.stack),l()}}).catch(()=>{})})},base__checkScheduleQueue(){return new Promise((e,t)=>{let s=!1;this.scheduleStore.queue.forEach(o=>{o.recordId&&(s=!0)}),!(this.mainStore?.settings?.routes?.hideQueueWarningModal||!1)&&s?this.$bus.emit("open-modal",{name:"schedule-queue-confirm",config:{callback:o=>{o.confirm?e():t()}}}):e()})},prepareShiftRecordsForUpsert(e=0,t=!1){const s=(a,o)=>{const{shifts:i=[],calendarDate:l}=this.scheduleStore.columnIdToDayInstance[o];return i.forEach(d=>{t&&(d.record.Id=null,d.record.maps__ResourceId__c=this.base__calendarId),(d.doUpsert||t)&&(d.record.maps__Date__c=S.fromJSDate(l).plus({milliseconds:e}).toISODate(),a.push(d.record))}),a};return this.columnIds.reduce(s,[]).map(a=>Object.assign({},...Object.keys(a).map(o=>({[o]:a[o]}))))},base__processResponseErrors(e,t){const s=Q.getWaypointErrorMessage(e.maioCode,Z.SCHEDULE);if(e.details)Array.isArray(e.details)||(e.details=[e.details]);else return;const{startLocation:a,endLocation:o}=t,i=this;function l(_){const u=parseInt(_/3600,10);_-=u*3600;const c=parseInt(_/60,10);return _-=c*60,Me(i.$Labels.Schedule_Time_Late_By,[u,c,_])}let d;e.details.forEach(_=>{if(!_.erroramount&&!_.errormessage)return;let u=this.scheduleStore.events.find(r=>r.id===_.id);if(!(u!=null))if(a.id===_.id)u=a;else if(o.id===_.id)u=o;else return;u.hasError=!0,u.errorMessage=s,_.erroramount&&(d=l(_.erroramount),u.errorTimeString=d)}),Q.showErrorMessage(e.maioCode,Z.SCHEDULE,d)},base__fetchCalendarShifts({startLocationId:e,endLocationId:t,resource:{id:s=this.base__calendarId}}){return new Promise(async(a,o)=>{this.scheduleStore.callouts+=1;const{currentStart:i,currentEnd:l}=this.base__calendar.view,d=S.fromJSDate(i),_=S.fromJSDate(l),c=_.diff(d,"days").days===1,r=c?d.toUTC().toISODate():d.minus({days:1}).toUTC().toISODate(),n=c?r:_.toUTC().toISODate(),h={resourceId:s,startDate:r,endDate:n,defaultStartLocationId:e,defaultEndLocationId:t};try{const f=await MAPS.Utils.Apex.invoke("maps.RemoteFunctions.getCalendarShifts",[JSON.stringify(h)]);this.scheduleStore.callouts-=1,f.success?a(f.data||[]):o(new Error(f.message))}catch(f){this.base__handleRemoteActionError(f),o()}})},base__getResourceProfileId(e){return new Promise(async(t,s)=>{const a={ajaxResource:"UserAJAXResources",action:"get_resource_user_profile_id",resourceId:e};try{const o=await MAPS.Utils.Apex.invoke("maps.RemoteFunctions.processAJAXRequest",[a]);t(o)}catch(o){this.base__handleRemoteActionError(o),s()}})},base__fetchRouteDefaultsByResource(e){return this.base__getResourceProfileId(e.id).then(t=>{t.success&&t.profileId?this.resourceProfileId=t.profileId:t.error&&console.error("Profile Retrieval Error: ",t.error)}),new Promise(async(t,s)=>{const o={ajaxResource:"UserAJAXResources",action:"get_user_prefs",userId:e.id,profileId:this.resourceProfileId?this.resourceProfileId:MAPS.currentUser.Profile};try{const i=await MAPS.Utils.Apex.invoke("maps.RemoteFunctions.processAJAXRequest",[o]),l=this;if(i&&i.success){let d={},_={};if(i.record&&!i.settings){try{_=JSON.parse(i.record.maps__MapsSetting__c)}catch{_={RouteDefaults:k.actualRouteDefaults},t({...l.formatRouteDefaults(_,i),resource:e})}d={..._.RouteDefaults||k.actualRouteDefaults,workingHours:_.workingHours||{},name:i.record.Name,timezone:i.record.TimeZoneSidKey}}else if(i.settings){let u,c;try{const r=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],n=S.fromJSDate(this.scheduleStore.calendarDate).weekday-1;u=i.settings.maps__DefaultValues__c?JSON.parse(i.settings.maps__DefaultValues__c):JSON.parse(At),c=i.record.maps__MapsSetting__c?JSON.parse(i.record.maps__MapsSetting__c):k.actualRouteDefaults;const{defaultEndLocation:h,defaultStartLocation:f,stopEventDuration:p,defaultTransportationMode:y,enableTraffic:M,currentTimeAndLoc:I,enableDuplicateStops:L,routeType:P,units:O}=u;let{RouteDefaults:$}=c;$||($=k.actualRouteDefaults);const{workingHours:F}=c;let{startLocationId:R,startLocationLabel:B,endLocationId:U,endLocationLabel:se,duration:q,driveProfile:V,displayTrafficTime:ae,enableCurrentLocationTime:ie,enableDuplicateStops:oe,mode:re,optimizationType:ne,type:le,unit:de}=$;h&&(!h.overridable||!U)&&(U=h.value.id,se=h.value.label),f&&(!f.overridable||!R)&&(R=f.value.id,B=f.value.label),y.overridable||(re=y.value,ne=y.value),p&&p.value&&(!p.overridable||!q)&&(q=p.value),y&&y.value&&(!y.overridable||!V)&&(V=y.value),M&&M.value&&!M.overridable&&(ae=M.value),I&&I.value&&!I.overridable&&(ie=I.value),L&&L.value&&!L.overridable&&(oe=L.value),P&&P.value&&!P.overridable&&(le=P.value),O&&O.value&&!O.overridable&&(de=O.value);const ye={...u.schedule},ce=this.formatWorkingHours(ye,F),{startTime:Ae,endTime:Te}=ce[r[n]];d={duration:q,driveProfile:V,displayTrafficTime:ae,enableCurrentLocationTime:ie,enableDuplicateStops:oe,endLocationId:U,endLocationLabel:se,mode:re,optimizationType:ne,startLocationId:R,startLocationLabel:B,type:le,unit:de,start:Ae,end:Te},_={RouteDefaults:d,workingHours:ce}}catch{_={RouteDefaults:k.actualRouteDefaults},t({...l.formatRouteDefaults(_,i),resource:e})}}typeof d.displayTrafficTime=="string"&&(d.displayTrafficTime=!0),t({...this.formatRouteDefaults(_,i),resource:e})}else t({...k.routeDefaults,resource:e})}catch(i){this.base__handleRemoteActionError(i),s(i)}})},formatWorkingHours(e={},t={}){e||(e={}),t||(t={});const s={};let a=Object.keys(e);return!a.length>0&&(a=Object.keys(t).length>0?Object.keys(t):["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"]),a=a.filter(o=>o!=="errorMsg"),e&&a.length>0&&a.forEach(o=>{if(e&&e[o].overridable&&t&&t[o]){s[o]=t[o];return}const i=e[o].value.startTime?e[o].value.startTime.split(" "):[],l=i.length>1?i[0].split(":"):[];let d;i[1]&&l[0]?(d=i[1].toLowerCase()==="pm"&&parseInt(l[0],10)!==12?String(parseInt(l[0],10)+12):l[0],i[1].toLowerCase()==="am"&&parseInt(l[0],10)===12&&(d="0")):d="";const _=l[1]?l[1]:"",u=e[o].value.endTime.split(" "),c=u[0]?u[0].split(":"):[];let r;const n=!0;u[1]&&c[0]?(r=u[1].toLowerCase()==="pm"&&parseInt(c[0],10)!==12?String(parseInt(c[0],10)+12):c[0],u[1].toLowerCase()==="am"&&parseInt(c[0],10)===12&&(r="0")):r="";const h=c[1]?c[1]:"",f=S.fromJSDate(this.scheduleStore.calendarDate).startOf("day").setZone(this.base__getCorrectTimezone()),p=f.plus({hours:l[0],minutes:l[1]}),y=f.plus({hours:c[0],minutes:c[1]});s[o]={workingDay:n,startHour:d,startMinute:_,endMinute:h,endHour:r,overnight:!!p>y,startTime:p,endTime:y}}),s},formatRouteDefaults(e,t){const s={...e.RouteDefaults||k.actualRouteDefaults,workingHours:e.workingHours||{},name:t.record.Name,timezone:t.record.TimeZoneSidKey};return typeof s.displayTrafficTime=="string"&&(s.displayTrafficTime=!0),s},base__setShiftIdOnEvents(e){e.forEach(t=>{const s=t.start,a=t.end;let o=!1;const i=this.scheduleStore.events.findIndex(_=>_.id===t.id),l=this.scheduleStore.events[i];this.scheduleStore.isTimelineDay?this.scheduleStore.resourceShifts.forEach(_=>{const u=_.startTime,c=_.endTime;_.resourceId&&t.resourceId!==_.resourceId||s<=c&&a>=u&&(l.extendedProps||(l.extendedProps={}),l.extendedProps.shiftId=t.shiftId=_.id,l.extendedProps.columnId=t.columnId=_.columnId,l.extendedProps.resourceId=_.resourceId,l.shiftId=t.shiftId=_.id,l.columnId=t.columnId=_.columnId,l.resourceId=_.resourceId,o=!0)}):Object.keys(this.scheduleStore.columnIdToDayInstance).forEach(_=>{const u=this.scheduleStore.columnIdToDayInstance[_],{shifts:c=[]}=u;c.forEach(r=>{const n=r.startTime,h=r.endTime;r.resourceId&&t.resourceId!==r.resourceId||s<=h&&a>=n&&(l.shiftId=t.shiftId=r.id,l.columnId=t.columnId=r.columnId,l.resourceId=r.resourceId,o=!0)})});const d=this.base__calendar.getEventById(t.id);o?d&&(d.setExtendedProp("shiftId",t.shiftId),d.setExtendedProp("columnId",t.columnId),d.setExtendedProp("resourceId",t.resourceId)):(l.shiftId=t.shiftId=null,d&&(d.setExtendedProp("shiftId",""),d.setExtendedProp("columnId",null),d.setExtendedProp("resourceId","")))})},base__getWorkingHours({calendarDate:e,workingHours:t}){const a=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][e.getDay()];return t?t[a]:k.getWorkingHoursByDayString(a)},base__setShiftsOnInstance(e,t={}){let s=this.base__getWorkingHours(e);e.hasOvernightShift=!1,s==null&&(s={startHour:9,startMinute:0,endHour:17,endMinute:0});const{startLocation:a={},endLocation:o={}}=t,i=S.fromJSDate(e.calendarDate).setZone(this.base__getCorrectTimezone()).startOf("day"),l={id:C(),columnId:e.columnId,resourceId:e.resourceId,startLocation:{...this.base__getDefaultLocationSettings(),isSpatial:a.maps__Latitude__c!=null&&a.maps__Longitude__c!=null},endLocation:{...this.base__getDefaultLocationSettings(),isSpatial:o.maps__Latitude__c!=null&&o.maps__Latitude__c!=null},record:{maps__Date__c:i.toISODate(),maps__ResourceId__c:this.base__calendarId,maps__StartAddress__c:a.maps__Address__c,maps__StartLocation__Latitude__s:a.maps__Latitude__c,maps__StartLocation__Longitude__s:a.maps__Longitude__c,maps__StartHour__c:s.startHour,maps__StartMinute__c:s.startMinute,maps__EndAddress__c:o.maps__Address__c,maps__EndLocation__Latitude__s:o.maps__Latitude__c,maps__EndLocation__Longitude__s:o.maps__Longitude__c,maps__EndHour__c:s.endHour,maps__EndMinute__c:s.endMinute},onMap:!1,route:{},routing:null,doUpsert:!1,isOvernight:!1,startTime:i.plus({hours:Number(s.startHour),minutes:Number(s.startMinute)}).toJSDate(),endTime:i.plus({hours:Number(s.endHour),minutes:Number(s.endMinute)}).toJSDate()};e.earliestShiftTime=l.startTime,e.latestShiftTime=l.endTime,l.startTime>l.endTime&&(l.endTime=S.fromJSDate(l.endTime).setZone(this.base__getCorrectTimezone()).plus({days:1}).toJSDate(),l.isOvernight=e.hasOvernightShift=!0),e.shifts=[l];const d=i.toISODate(),_=t.shiftMap[d];if(!_||!_.length)return;e.shifts=[];let u,c;_.forEach(r=>{const n={id:C(),startLocation:Object.assign(l.startLocation,{isSpatial:r.maps__StartLocation__Latitude__s!=null}),endLocation:Object.assign(l.endLocation,{isSpatial:r.maps__EndLocation__Latitude__s!=null}),record:{Id:r.Id,maps__StartAddress__c:r.maps__StartAddress__c,maps__StartLocation__Latitude__s:r.maps__StartLocation__Latitude__s,maps__StartLocation__Longitude__s:r.maps__StartLocation__Longitude__s,maps__EndAddress__c:r.maps__EndAddress__c,maps__EndLocation__Latitude__s:r.maps__EndLocation__Latitude__s,maps__EndLocation__Longitude__s:r.maps__EndLocation__Longitude__s,maps__ResourceId__c:this.base__calendarId}};let{maps__StartHour__c:h,maps__StartMinute__c:f,maps__EndHour__c:p,maps__EndMinute__c:y}=r;h=Number(h),f=Number(f),p=Number(p),y=Number(y),h>=0&&f>=0?(n.record.maps__StartHour__c=Number(h),n.record.maps__StartMinute__c=Number(f),n.startTime=i.setZone(this.base__getCorrectTimezone()).plus({hours:Number(h),minutes:Number(f)}).toJSDate()):n.startTime=l.startTime,p>=0&&y>=0?(n.record.maps__EndHour__c=p,n.record.maps__EndMinute__c=y,n.endTime=i.setZone(this.base__getCorrectTimezone()).plus({hours:p,minutes:y}).toJSDate()):n.endTime=l.endTime,n.startTime>n.endTime&&(n.endTime=S.fromJSDate(n.endTime).setZone(this.base__getCorrectTimezone()).plus({days:1}).toJSDate(),n.isOvernight=e.hasOvernightShift=!0),(!n.earliestShiftTime||n.startTime<e.earliestShiftTime)&&(e.earliestShiftTime=n.startTime),(!n.latestShiftTime||n.endTime>e.latestShiftTime)&&(e.latestShiftTime=n.endTime),u==null?u=n.startTime:u=n.startTime<u?n.startTime:u,c==null?c=n.endTime:c=n.endTime<c?n.endTime:c,e.shifts.push({...l,...n})}),e.hasOvernightShift&&u<e.earliestShiftTime&&(e.earliestShiftTime=u),e.hasOvernightShift&&c<e.latestShiftTime&&(e.latestShiftTime=c)},base__adjustToUserTimezone(e,t){let s=MAPS.currentUser.TimeZone;return t?s=t:this.routeDefaults&&this.routeDefaults.timezone&&(s=this.routeDefaults.timezone),e=S.fromJSDate(e).setZone(s).toJSDate(),e},base__getCorrectTimezone(){let e=MAPS.currentUser.TimeZone;return this.routeDefaults&&this.routeDefaults.timezone&&(e=this.routeDefaults.timezone),e},base__forceMapResize(){window.setTimeout(()=>{window.google.maps.event.trigger(window.MA.map,"resize")},200)},base__resizeCalendar(){this.base__calendar.updateSize()},base__resizeCalendarDelayed(){setTimeout(()=>{this.base__resizeCalendar()},10)},base__getExcludeIncludeActionLabel(e){return e.excludeFromRoute?this.$Labels.MA_INCLUDE_IN_OPTIMIZATION:this.$Labels.MA_EXCLUDE_FROM_OPTIMIZATION},base__eventHasRecord(e){return e.recordId!==void 0&&e.recordId!==null},base__hasGuideWaypoint(e){const{guideWaypoint:t={}}=e;return t.hasWaypoint?t.hasWaypoint:!1},base__getGuideWaypointLockIcon(e){const{guideWaypoint:t={}}=e;return t.isLocked?"ma-icon-lock-closed":"ma-icon-lock-open"},base__setDefaultDuration(e){this.base__calendar.setOption("defaultTimedEventDuration",{minutes:e})},base__setTimeAxisRange(e,t){this.base__calendar.setOption("slotMinTime",e),this.base__calendar.setOption("slotMaxTime",t)},base__buildTimeAxisString(e,t){return`${e.getHours()+t}:00:00`},base__convertStringToMinutes(e){let t=0;try{const a=(e||"0 hr, 0 min").split(",");let o=a[0]||"0 hr",i=a[1]||"0 min";o=parseInt(o.replace(/\D/g,""),10),i=parseInt(i.replace(/\D/g,""),10),t=o*60+i}catch{t=0}return t||15},base__emitViewModeChangeEvent(e){switch(e){case A.AGENDA_WEEK:case A.TIMELINE_DAY:this.$bus.emit("set-calendar-view-mode",W.FULLWIDTH_HALFHEIGHT);break;case A.MONTH:this.$bus.emit("set-calendar-view-mode",W.FULLWIDTH_HALFHEIGHT);break;case A.AGENDAY_DAY:default:this.$bus.emit("set-calendar-view-mode",W.DEFAULT)}},base__getCalendarDate(){return this.base__calendar.getDate()},base__fetchEvents(e,t,s,a){return new Promise(async(o,i)=>{a||o([]),e=S.fromJSDate(e).setZone(this.base__getCorrectTimezone()).startOf("day").toMillis(),t=S.fromJSDate(t).setZone(this.base__getCorrectTimezone()).startOf("day").toMillis();const l={startTime:e,endTime:t-1e3,resourceId:a};this.scheduleStore.callouts+=1;try{const d=await MAPS.Utils.Apex.invoke("maps.RemoteFunctions.getCalendarEvents",[JSON.stringify(l)]);if(this.scheduleStore.callouts-=1,d.success){const _=this.buildFloatingBreakEvents({floatingBreaks:d.floatingBreaks,resourceId:a}),u=this.buildCalendarEvents(d.events||[],a);o(u.concat(_))}else i(new Error(d.message))}catch(d){this.base__handleRemoteActionError(d),i()}})},buildFloatingBreakEvents({floatingBreaks:e=[],resourceId:t}){const s=[],a=e.length===0?null:e[0],o=a!==null;if(!o||this.scheduleStore.isMonth)return[];if((this.mainStore?.settings?.floatingBreak||{})?.enabled?.value)if(this.scheduleStore.calendarView===A.TIMELINE_DAY){const l=S.fromJSDate(this.scheduleStore.calendarDate).startOf("day"),d=o?l.setZone(this.base__getCorrectTimezone()).plus({hours:a.startHour,minutes:a.startMinute}):null,_=o?l.setZone(this.base__getCorrectTimezone()).plus({hours:a.endHour,minutes:a.endMinute}):null,u=o?l.setZone(this.base__getCorrectTimezone()).plus({days:1,hours:a.startHour,minutes:a.startMinute}):null,c=o?l.setZone(this.base__getCorrectTimezone()).plus({days:1,hours:a.endHour,minutes:a.endMinute}):null,r=C(),n={id:r,resourceId:t,extendedProps:{id:r},title:this.$Labels.Schedule_Break,isBreak:!0,renderType:"floating-break",start:d.toJSDate(),end:_.toJSDate(),className:"non-spatial-cell",editable:!1,spatial:!1,excludeFromRoute:!0,showActionMenu:!1};s.push(n);const h=C(),f={id:h,resourceId:t,extendedProps:{id:h},title:this.$Labels.Schedule_Break,isBreak:!0,renderType:"floating-break",start:u.toJSDate(),end:c.toJSDate(),className:"non-spatial-cell",editable:!1,spatial:!1,excludeFromRoute:!0,showActionMenu:!1};s.push(f)}else Object.values(this.scheduleStore.columnIdToDayInstance).forEach(l=>{if(l.columnId!==-1){const d=S.fromJSDate(l.calendarDate).startOf("day"),_=o?d.setZone(this.base__getCorrectTimezone()).plus({hours:a.startHour,minutes:a.startMinute}):null,u=o?d.setZone(this.base__getCorrectTimezone()).plus({hours:a.endHour,minutes:a.endMinute}):null,c=o?d.setZone(this.base__getCorrectTimezone()).plus({days:1,hours:a.startHour,minutes:a.startMinute}):null,r=o?d.setZone(this.base__getCorrectTimezone()).plus({days:1,hours:a.endHour,minutes:a.endMinute}):null,n=C(),h={id:n,resourceId:t,extendedProps:{id:n},title:this.$Labels.Schedule_Break,isBreak:!0,renderType:"floating-break",start:_.toJSDate(),end:u.toJSDate(),className:"non-spatial-cell",editable:!1,spatial:!1,excludeFromRoute:!0,showActionMenu:!1};if(s.push(h),this.scheduleStore.isDayView){const f=C(),p={id:f,resourceId:t,title:this.$Labels.Schedule_Break,isBreak:!0,extendedProps:{id:f},renderType:"floating-break",start:c.toJSDate(),end:r.toJSDate(),className:"non-spatial-cell",editable:!1,spatial:!1,excludeFromRoute:!0,showActionMenu:!1};s.push(p)}}});return s},buildCalendarEvents(e,t){const s=[];function a(i){const{street:l,city:d,state:_,postalCode:u,country:c}=i.location;let r="";return l&&(r+=`${l}, `),d&&(r+=d),_&&(r+=`, ${_}`),u&&(r+=` ${u}`),c&&(r+=` ${c}`),r}let o=!1;return e.forEach(i=>{const{value:l=0,type:d="",label:_="",sfdcFieldType:u="number",sfdcFieldValue:c=0}=i.priority||{},{GuideWaypoint:r={}}=i,n=C();let h={id:n,resourceId:t,title:i.Subject,start:new Date(i.StartDateTime),end:new Date(i.EndDateTime),className:["non-spatial-cell"],renderType:"calendar-event",extendedProps:{id:n,title:i.Subject},editable:!this.scheduleStore.isMonth,spatial:!1,excludeFromRoute:!0,showActionMenu:!1,recordId:i.RecordId,relationshipId:i.RelationshipId,maps__LinkId__c:i.maps__LinkId__c||i.RelationshipId,maps__MarkerLayer__c:i.LayerId,baseObjectId:i.BaseObjectId,configId:i.ConfigId,priority:l,priorityType:d,priorityLabel:_,priorityValue:c,priorityFieldType:u,guideWaypoint:{hasWaypoint:r.hasWaypoint||!1,isLocked:r.isLocked||!1,id:r.id||""}};if(i.location){const{geocodeError:f,geocodeErrorMessage:p,street:y="",city:M="",postalCode:I="",state:L="",country:P="",lat:O,lng:$,verifiedLat:F,verifiedLng:R}=i.location;if(O&&$||F&&R){const U={className:"eventCell",spatial:!0,excludeFromRoute:!1,verifiedLat:F,verifiedLng:R,lat:O,lng:$,address:a(i),street:y,city:M,postalCode:I,state:L,country:P,editable:!this.scheduleStore.isMonth};h={...h,...U}}f&&p&&(o=!0,h.hasError=!0,h.errorMessage=p)}o&&this.base__showMapToastError(this.$Labels.Schedule_Error_Geocoding,this.$Labels.Schedule_Error_Geocoding_Title),h.start===h.end&&h.end.setSeconds(h.end.getSeconds()+1),s.push(h)}),s},base__instantiateRoute(e,t=[],s=!1){const{routeDepartureTime:a,routeEndTime:o,routeStartTime:i}=this.base__getRouteTimes(e),l=!0,d=new Ne().setRouteStart(S.fromJSDate(i).toUnixInteger()).setRouteEnd(S.fromJSDate(o).toUnixInteger()).setWaypoints(t.spatial,l).setHardBreaks(t.hardBreaks).setSoftBreaks(t.softBreaks).setOptimized(s).setTimeBased(!0).setDirections(!1),{startLocation:_,endLocation:u}=e;return _.isSpatial&&d.setFirst({id:_.id,lat:e.record.maps__StartLocation__Latitude__s,lng:e.record.maps__StartLocation__Longitude__s,flexible:!1,Name:e.record.maps__StartAddress__c,maps__Address__c:e.record.maps__StartAddress__c,duration:0,start:S.fromJSDate(a).toUnixInteger()}),u.isSpatial&&d.setLast({id:u.id,lat:e.record.maps__EndLocation__Latitude__s,lng:e.record.maps__EndLocation__Longitude__s,flexible:!1,Name:e.record.maps__EndAddress__c,maps__Address__c:e.record.maps__EndAddress__c,duration:0,start:S.fromJSDate(o).toUnixInteger()}),d},base__getRouteTimes(e){const t=this.base__adjustToUserTimezone(e.startTime),s=this.base__adjustToUserTimezone(e.endTime);let a=t;if(S.fromJSDate(e.startTime).hasSame(S.local(),"day")&&this.scheduleStore.addToScheduleExecuted){const l=this.base__adjustToUserTimezone(new Date);l>a&&(a=l)}return{routeDepartureTime:t,routeEndTime:s,routeStartTime:a}},base__eventSorter(e,t){const s=e.start.getTime(),a=t.start.getTime();return s-a},base__buildWaypointsFromEvents(e,t){const s={spatial:[],softBreaks:[],hardBreaks:[]},a=[],o=[],i=[],l=this.scheduleStore;t.forEach(u=>{const c=S.fromJSDate(u.startTime).toUnixInteger(),r=S.fromJSDate(u.endTime).toUnixInteger();i.push({start:c,end:r})}),e.forEach(u=>{if(u.flexible){s.spatial.push({...u,priority:u.priorityIndex});return}const c=l.events.find(r=>r.id===u.id);if(c){const r=S.fromJSDate(u.start).setZone(this.base__getCorrectTimezone()).toUnixInteger(),n=S.fromJSDate(u.end).setZone(this.base__getCorrectTimezone()).toUnixInteger();let h=!1;i.forEach(f=>{r<=f.end&&n>=f.start&&!h&&(h=!0,c.excludeFromRoute?c.isBreak?o.push({start:r,end:n}):a.push({start:r,end:n}):(c.verifiedLat||c.lat)&&(c.verifiedLng||c.lng)&&s.spatial.push({id:c.id,Name:c.title,maps__LinkId__c:c.maps__LinkId__c||c.relationshipId,maps__Address__c:c.address,maps__MarkerLayer__c:c.maps__MarkerLayer__c,baseObjectId:c.baseObjectId,lat:c.verifiedLat||c.lat,lng:c.verifiedLng||c.lng,start:r,priority:c.priorityIndex,duration:Math.floor(n-r)}))})}}),a.sort((u,c)=>u.start-c.start),o.sort((u,c)=>u.start-c.start),i.sort((u,c)=>u.start-c.start);function d(u){const c=[];return u.forEach(r=>{i.forEach(n=>{if(r.start<=n.end&&r.end>=n.start){if(r.start<=n.start&&(r.start=n.start+1),r.end>=n.end){const h={start:r.start,end:n.end-1};h.start<h.end&&c.push(h),r.start=n.end}r.start>n.start&&r.end<n.end&&r.start<r.end&&c.push(r)}})}),c}function _(u){const c=[],r=[];let n;return u.forEach(h=>{o.forEach(f=>{if(h.start<f.start&&h.end>f.end){const p={start:h.start,end:f.start-1};p.start<p.end&&r.push(p),h.start=f.end+1}else h.start>=f.start&&h.start<=f.end&&(h.start=f.end+1),h.end<=f.end&&h.end>=f.start&&(h.end=f.start-1)}),h.start<h.end&&r.push(h)}),r.sort((h,f)=>h.start-f.start),r.forEach(h=>{!n||h.start>n.end?c.push(n=h):h.end>n.end&&(n.end=h.end)}),d(c)}return s.softBreaks=_(a),s.hardBreaks=d(o),s.spatial.sort((u,c)=>u.start-c.start),s},base__handleRemoteActionError(e){let t=this.$Labels.Common_Refresh_And_Try_Again;this.scheduleStore.callouts&&(this.scheduleStore.callouts-=1);const{error:s}=e;if(s){const{message:a}=s;t=a||this.$Labels.Common_Refresh_And_Try_Again}this.$emit("error",t)},getTranslatedErrorMessage(e){switch(e.maioCode){case 82004:case 82011:return this.$Labels.Schedule_Error_Not_Enough_Time_Today;default:return e.message||this.$Labels.Common_Refresh_And_Try_Again}},base__genericPromiseErrorHandler(e){this.scheduleStore.callouts&&(this.scheduleStore.callouts-=1),typeof e=="object"?(console.warn(e),this.$emit("error",this.getTranslatedErrorMessage(e))):typeof e=="string"&&this.$emit("error",e)},base__genericPromiseFinallyHandler(){this.scheduleStore.callouts&&(this.scheduleStore.callouts-=1)},base__showMapToastError(e=this.$Labels.Common_Refresh_And_Try_Again){this.mainStore.toast({message:e,state:"error"})},base__showEventOnMap(e,t){if(!e.spatial||!t)return;const s=t.getWaypointById(e.id),a=t.getWaypointMarker(s);a&&window.google.maps.event.trigger(a,"click")},base__deleteEvent(e){this.base__calendar.getEventById(e.id).remove(),e.recordId?(this.scheduleStore.eventIdsForDelete.push(e.recordId),this.scheduleStore.updatedEventsSet.delete(e.id),this.scheduleStore.hasModifiedEvents=!0):this.scheduleStore.numEventsReceived--,this.scheduleStore.events=this.scheduleStore.events.filter(s=>s.id!==e.id),!this.scheduleStore.numEventsReceived&&!this.scheduleStore.eventIdsForDelete.length&&(this.scheduleStore.hasModifiedEvents=!1,this.scheduleStore.updatedEventsSet.clear())},base__eventMouseoutHandler(e,t){if(!Object.keys(t).length||this.scheduleStore.isMonth)return;const s=t.toElement||t.relatedTarget;if(s&&s.classList.contains("slds-dropdown_actions"))return;const a=this.scheduleStore.events.findIndex(o=>o.id===e.id);a!==-1&&(this.scheduleStore.events[a].showActionMenu=!1)},base__returnAllEventsToQueue(){const e=this.mainStore?.licensing?.guide||!1;this.base__calendar.getEvents().forEach(t=>{const{extendedProps:s}=t,{id:a,guideWaypoint:o={},spatial:i,shiftId:l,recordId:d,renderType:_}=s;if(_==="calendar-event"){const{isLocked:u=!1}=o;i&&!(e&&u)&&this.returnEventToQueue({eventId:a,shiftId:l,sfRecordId:d})}})},base__resetComponentState(e=!1){if(this.base__calendar.removeAllEvents(),this.base__storedNavigationAction=null,this.base__performedScrollToLogic=!1,this.scheduleStore.events=[],this.scheduleStore.eventIdsForDelete=[],this.scheduleStore.locationIdsForDelete=[],this.scheduleStore.numEventsReceived=0,this.scheduleStore.hasModifiedEvents=!1,this.scheduleStore.hasModifiedShifts=!1,this.scheduleStore.updatedEventsSet.clear(),!e){const t=Object.values(this.scheduleStore.columnIdToDayInstance);for(let s=0;s<t.length;s++){const a=t[s];a.shifts=[]}}},base__getBaseDefaultLocationSettings(){return{distance:0,totaltraveltime:0,skipWatcherLogic:!1,hasError:!1,errorMessage:null,errorTimeString:null}},base__getDefaultLocationSettings(){return{doShow:!1,isSpatial:!1,id:C(),dragStartFn:null,...this.base__getBaseDefaultLocationSettings()}},resetComponentState(){console.warn("resetComponentState not implemented in subcomponent")},save(){console.warn("save not implemented in subcomponent")},returnEventToQueue(){console.warn("returnEventToQueue not implemented in subcomponent")},setExcludeInclude(){console.warn("setExcludeInclude not implemented in subcomponent")}}},Tt={components:{Picklist:ke},props:{storedSearchTerm:{type:String,default:""}},emits:["clear","selected"],setup(){return{scheduleStore:J()}},data(){return{searchTerm:this.storedSearchTerm,searches:[{options:this.getSchedulingResources}]}},watch:{storedSearchTerm(){this.searchTerm!==this.storedSearchTerm&&(this.searchTerm=this.storedSearchTerm)}},methods:{getSchedulingResources(e){return new Promise(async(t,s)=>{try{const a=await MAPS.Utils.Apex.invoke("maps.RemoteFunctions.getSchedulingResourcesBySearchTerm",[e,JSON.stringify(this.scheduleStore.subRoleIdsList)]);if(a.success){const{data:o}=a;t(o)}else console.warn(a),s(new Error(a.error))}catch(a){s(new Error(a.message))}})},selected(e){this.$emit("selected",e)}}},Dt={id:"scheduleUserSelectWrap",class:"slds-form-element__control slds-input-has-icon slds-input-has-icon_right"},vt={class:"slds-form-element"},Et={class:"slds-form-element__control"},Lt={class:"slds-combobox_container"},It={id:"scheduleUserSelectInputWrap",class:"slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click has-option-selected","aria-expanded":"true","aria-haspopup":"listbox",role:"combobox"},Mt={class:"slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right"},kt={id:"listbox-option-unique-id-01",class:"slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_has-meta",role:"option"},Ct={class:"slds-media__body"},wt={class:"slds-listbox__option-text slds-listbox__option-text_entity"},xt={class:"slds-listbox__option-meta slds-listbox__option-meta_entity"};function Ot(e,t,s,a,o,i){const l=D("Picklist");return b(),v("div",null,[m("div",Dt,[m("div",vt,[m("div",Et,[m("div",Lt,[m("div",It,[m("div",Mt,[T(l,{modelValue:o.searchTerm,"onUpdate:modelValue":t[0]||(t[0]=d=>o.searchTerm=d),inputAttrs:{id:"scheduleResourceSearchPicklistResource"},options:o.searches,filterable:"",titleKey:"name",labelForId:"resourceSearch",labels:{search:e.$Labels.Schedule_Search_Resources_Text},onClear:t[1]||(t[1]=d=>e.$emit("clear")),onSelectedOption:i.selected},{option:E(({option:d})=>[m("span",kt,[m("span",Ct,[m("span",wt,g(d.name),1),m("span",xt,g(d.type||""),1)])])]),_:1},8,["modelValue","options","labels","onSelectedOption"])])])])])])])])}const Es=x(Tt,[["render",Ot]]);const Nt={components:{DatePicker:Pe,ActionMenu:_e,ActionMenuItem:he,ButtonIcon:me,SLDSButton:fe,Icon:ee},emits:["date-change","view-change","next","previous","today"],setup(){const e=J(),t=te();return{scheduleStore:e,mainStore:t}},data(){return{doShowDatetimePicker:!1,CalendarViews:A,firstDayOfWeek:MAPS.currentUser.StartOfWeekIndex,dateFormat:MAPS.currentUser.dateFormat.toUpperCase(),userLocale:MAPS.currentUser.Locale.replace("sh_ME_USD","sh-ME").replace("_","-").slice(0,5),viewTypes:[{label:this.$Labels.MA_Day,icon:"dayview",id:A.AGENDA_DAY},{label:this.$Labels.MA_WEEK,icon:"weeklyview",id:A.AGENDA_WEEK},{label:this.$Labels.MA_MONTH,icon:"monthlyview",id:A.MONTH},{label:this.$Labels.MA_RESOURCE,icon:"kanban",id:A.TIMELINE_DAY}]}},computed:{guideLicense(){return this.mainStore?.licensing?.guide||!1},iconClass(){switch(this.scheduleStore.calendarView){case A.AGENDA_DAY:return"dayview";case A.AGENDA_WEEK:return"weeklyview";case A.MONTH:return"monthlyview";case A.TIMELINE_DAY:return"kanban";default:return"event"}},currentFormattedFCDate(){return this.getCurrentFormattedFCDate()}},methods:{getCurrentFormattedFCDate(){let e;if(this.scheduleStore.isDayView)e=this.$F("DateTime",this.scheduleStore.calendarDate,{year:"numeric",month:"numeric",day:"numeric"});else if(this.scheduleStore.isMonth)e=this.$F("DateTime",this.scheduleStore.calendarDate,{year:"numeric",month:"long"});else if(this.scheduleStore.isAgendaWeek){const t=new Date(this.scheduleStore.calendarDate),s=S.fromJSDate(t).weekday;let a;const o=MAPS.currentUser.StartOfWeekIndex===0?7:MAPS.currentUser.StartOfWeekIndex;s===o?a=S.fromJSDate(t).startOf("day"):o===6?a=S.fromJSDate(t).startOf("week").set({weekday:MAPS.currentUser.StartOfWeekIndex}).minus({week:1}):a=S.fromJSDate(t).startOf("week").set({weekday:MAPS.currentUser.StartOfWeekIndex});const i=a.plus({days:6}),l=this.$F("DateTime",a.toJSDate(),{year:"numeric",month:"numeric",day:"numeric"}),d=this.$F("DateTime",i.toJSDate(),{year:"numeric",month:"numeric",day:"numeric"});e=`${l} - ${d}`}return e},showDatetimePicker(){this.doShowDatetimePicker=!0},today(){this.$emit("today")},previous(){this.$emit("previous")},next(){this.$emit("next")},changeCalendarView(e){this.$emit("view-change",e)}}},Pt={id:"scheduleHeaderTimeControls",class:"slds-grid slds-grid_vertical-align-center slds-col"},$t={class:"slds-p-right_xx-small"},Rt={style:{float:"right"},class:"slds-grid slds-grid_vertical-align-center"},Ut={class:"slds-col_bump-left",style:{width:"100px"}},Wt={class:"slds-p-right_xx-small"},Ft={class:"slds-button-group slds-p-right_xx-small prev-next-button-group"};function Ht(e,t,s,a,o,i){const l=D("ButtonIcon"),d=D("Icon"),_=D("ActionMenuItem"),u=D("ActionMenu"),c=D("SLDSButton"),r=D("DatePicker");return b(),v("div",Pt,[m("div",$t,[T(u,{isActionMenu:!1},{button:E(()=>[T(l,{id:"scheduleTypesBtnResource",iconCategory:"utility",iconName:i.iconClass,size:"small",more:"",title:"Display Types",assistiveText:"Display Types"},null,8,["iconName"])]),default:E(()=>[(b(!0),v(G,null,j(o.viewTypes,(n,h)=>(b(),w(_,{id:`schedule-${n.id}-BtnResource`,key:`item__${h}`,role:"menuitemradio",styls:"width: 100%;",label:n.label,selected:n.id===a.scheduleStore.calendarView,onClick:f=>i.changeCalendarView(n.id)},{default:E(()=>[m("div",Rt,[m("div",Ut,g(n.label),1),T(d,{category:"utility",name:n.icon,size:"x-small",iconClass:"slds-m-left_x-small"},null,8,["name"])])]),_:2},1032,["id","label","selected","onClick"]))),128))]),_:1})]),m("div",Wt,[T(c,{id:"scheduleTodayBtnResource",label:e.$Labels.MA_TODAY,onClick:i.today},null,8,["label","onClick"])]),m("div",Ft,[T(l,{id:"scheduleMoveForwardSelectorResource",iconCategory:"utility",iconName:"chevronleft",size:"small",title:"Previous",assistiveText:"Previous",onClick:i.previous},null,8,["onClick"]),T(l,{id:"scheduleMoveBackwardSelectorResource",iconCategory:"utility",iconName:"chevronright",size:"small",title:"Next",assistiveText:"Next",onClick:i.next},null,8,["onClick"])]),m("div",null,[T(c,{id:"scheduleSelectBlueDateBtnResource",variant:"base",onClick:i.showDatetimePicker},{default:E(()=>[pe(g(i.currentFormattedFCDate),1)]),_:1},8,["onClick"]),T(r,{modelValue:a.scheduleStore.calendarDate,"onUpdate:modelValue":[t[0]||(t[0]=n=>a.scheduleStore.calendarDate=n),t[2]||(t[2]=n=>e.$emit("date-change",n))],showCalendarSync:o.doShowDatetimePicker,"onUpdate:showCalendarSync":t[1]||(t[1]=n=>o.doShowDatetimePicker=n),style:{height:"0"},inputAttrs:{id:"scheduleDatePickerResource"},locale:o.userLocale,firstDayOfWeek:o.firstDayOfWeek,showInputField:!1,labels:{previousMonth:e.$Labels.MA_Previous_Month,nextMonth:e.$Labels.MA_Next_Month,selectDate:e.$Labels.MA_Select_A_Date,pickYear:e.$Labels.MA_Pick_A_Year,today:e.$Labels.MA_TODAY}},null,8,["modelValue","showCalendarSync","locale","firstDayOfWeek","labels"])])])}const Ls=x(Nt,[["render",Ht],["__scopeId","data-v-17b9a96b"]]),zt=""+MAPS.getURLPath({base:"/resource/1730379547462/maps__VueDesktopV2/dist/",path:"assets/schedule-queue-empty-state.55e5e93d.svg"});const Jt={components:{ActionMenu:_e,ActionMenuItem:he,Einstein:Xe,Pardot:ct,Priority:yt,Tooltip:z,ButtonIcon:me,Icon:ee,SLDSButton:fe},props:{allowOptimization:{type:Boolean,required:!0},viewMode:{type:String,required:!1,default:W.DEFAULT},doDisableOptimizationDueToInvalidDuration:{type:Boolean,default:!1},eventDuration:{type:Number,default:30}},emits:["optimize","force-calendar-resize"],setup(){const e=te(),t=J(),s=Ce();return{mainStore:e,scheduleStore:t,listStore:s}},data(){return{CalendarViews:A,optimizationDays:[],workerStatus:null}},computed:{queueLength(){return this.scheduleStore.queue.length},multipleShifts(){return this.shifts.length>1},isHalfHeight(){return this.viewMode===W.FULLWIDTH_HALFHEIGHT},eventDurationString(){const e=this.$props.eventDuration||30;let t=e%60;t=t<10?`0${t}`:String(t);let s=(e-t)/60;return s=s<10?`0${s}`:String(s),`${s}:${t}`},shifts(){const e=[];return Object.keys(this.scheduleStore.columnIdToDayInstance).forEach(t=>{const s=this.scheduleStore.columnIdToDayInstance[t],{shifts:a=[]}=s;e.push(...a)}),e}},watch:{queueLength(e,t){e!==t&&this.$nextTick(this.addDraggableStateToQueueItems)},"scheduleStore.calendarView":{handler(){this.$nextTick(()=>{this.scheduleStore.isAgendaWeek&&(this.scheduleStore.clearColumnIdsForOptimization(),this.optimizationDays=this.getOptimizationDays()),this.addDraggableStateToQueueItems()})},immediate:!0},"scheduleStore.calendarDate":{handler(){this.scheduleStore.isAgendaWeek&&(this.scheduleStore.clearColumnIdsForOptimization(),this.optimizationDays=this.getOptimizationDays())}}},mounted(){this.$nextTick(this.addDraggableStateToQueueItems)},created(){this.$bus.on("add-to-schedule",this.addItemsToQueue)},unmounted(){this.$bus.off("add-to-schedule",this.addItemsToQueue)},methods:{toggleScheduleQueue(){this.scheduleStore.isQueueCollapsed=!this.scheduleStore.isQueueCollapsed,this.scheduleStore.isQueueToggling=!0,setTimeout(()=>{this.scheduleStore.isQueueToggling=!1,this.$emit("force-calendar-resize")},300)},daySelected(e,t){t.currentTarget.checked?this.scheduleStore.columnIdsForOptimization[e]=null:delete this.scheduleStore.columnIdsForOptimization[e]},getOptimizationDays(){const e=new Date(this.scheduleStore.calendarDate),t=S.fromJSDate(e).weekday;let s;const a=MAPS.currentUser.StartOfWeekIndex===0?7:MAPS.currentUser.StartOfWeekIndex;t===a?s=S.fromJSDate(e).startOf("day"):a===6?s=S.fromJSDate(e).startOf("week").set({weekday:MAPS.currentUser.StartOfWeekIndex}).minus({week:1}):s=S.fromJSDate(e).startOf("week").set({weekday:MAPS.currentUser.StartOfWeekIndex});const o=S.now().startOf("day");let i=s;const l=[0,1,2,3,4,5,6],d=[];for(let _=0;_<l.length;_++){const u=l[_];d.push({columnId:u,label:i.toFormat("EEEEE"),checked:!1,disabled:o>i}),i=i.plus({days:1})}return d},getPriorityComponent(e){switch(e){case"Einstein":return e;case"Pardot":return e;default:return"Priority"}},addDraggableStateToQueueItems(){this.scheduleStore.queue.forEach((e,t)=>{const a=this.$refs[`item${t}`][0];a&&!a.draggable&&(a.draggable=!0,new Ee(a,{eventData:{duration:this.eventDurationString,...e}}))})},optimizeRoute(e){this.scheduleStore.setAddToScheduleExecuted(!0),this.$emit("optimize",e)},addItemsToQueue(e){this.scheduleStore.callouts++,this.mainStore.activeTab!=="schedule"&&(this.mainStore.activeTab="schedule"),this.scheduleStore.calendarView===A.MONTH&&this.scheduleStore.setView(A.AGENDA_DAY),this.scheduleStore.scheduleWorker.addListener("processedFeatures",({queueItems:t,unsupportedItems:s,reachedQueueItemLimit:a})=>{this.scheduleStore.scheduleWorker.removeListener("processItems"),this.scheduleStore.addItemsToQueue(t),s.length&&this.scheduleStore.setUnsupportedItems(s),this.scheduleStore.isQueueCollapsed&&this.scheduleStore.toggleScheduleQueue(),a&&Q.showErrorMessage(82700,Z.SCHEDULE),this.scheduleStore.callouts--}),Object.keys(e).forEach(t=>{if(e[t].type==="sfMarkerLayer"&&this.listStore.listMap.has(t)){const o=this.listStore.listMap.get(t).recordMap;e[t].records=JSON.parse(JSON.stringify(Object.fromEntries(o)))}}),this.scheduleStore.scheduleWorker.sendQuery("processItems",{layerMap:e,locale:MAPS.currentUser.Locale.replace("sh_ME_USD","sh-ME").replace("_","-").slice(0,5),timeZone:MAPS.currentUser.TimeZone,currentQueue:JSON.parse(JSON.stringify(this.scheduleStore.queue))})},getShiftTitle(e){let t=`${e.startTime.format("hh:mmA")} - ${e.endTime.format("hh:mmA")}`;return e.isOvernight&&(t+=" (Next Day)"),t}}},ge=e=>(K("data-v-c2340311"),e=e(),X(),e),Bt={id:"schedulePanelQueueWrap"},qt={class:"ma-schedule-queue slds-grid slds-grid_vertical"},Vt={id:"schedulePanelQueueHeader",class:"slds-col slds-border_bottom slds-p-left_small slds-p-right_x-small slds-p-top_x-small slds-p-bottom_x-small"},Qt={class:"slds-grid slds-grid_vertical"},Zt={class:"slds-grid slds-grid_vertical-align-center"},Gt=["title"],jt={key:0,class:"schedule-week_optimize-day-checkboxes slds-grid slds-grid_align-center"},Yt=["for"],Kt=["id","onUpdate:modelValue","disabled","onClick"],Xt={class:"faux-checkbox"},es={key:1,class:"schedule-queue-header-action-wrap slds-p-horizontal_small"},ts={id:"schedulePanelQueueBody",class:"slds-grid slds-is-relative"},ss={id:"schedulePanelQueueListWrap",class:"slds-col"},as={key:0},is={class:"schedule-queue-item-text"},os={key:0},rs={class:"slds-button slds-button_icon priority-queue-item"},ns={class:"ma-icon"},ls={key:1,class:"scheduleQueueEmptyState slds-grid slds-grid_vertical-align-center"},ds={class:"slds-notify_container--inline slds-p-around--large slds-text-align--center"},cs=ge(()=>m("figure",{class:"slds-m-bottom_small"},[m("img",{src:zt})],-1)),us=ge(()=>m("br",null,null,-1)),_s={class:"slds-col slds-is-absolute slds-border_left",style:{height:"100%",right:"0"}};function hs(e,t,s,a,o,i){const l=D("ButtonIcon"),d=D("ActionMenuItem"),_=D("ActionMenu"),u=D("SLDSButton"),c=D("Icon"),r=D("Tooltip");return b(),v("div",Bt,[m("div",qt,[m("div",Vt,[m("div",Qt,[m("div",Zt,[m("div",{title:`${a.scheduleStore.queue.length} ${e.$Labels.MA_STOPS} ${e.$Labels.MA_SCHEDULE_TO_BE_SCHEDULED}`,class:"slds-col"},[m("h3",null,g(e.$Labels.MA_SCHEDULE_TO_BE_SCHEDULED),1)],8,Gt),T(_,{showMoreLabel:e.$Labels.MA_SHOW_MORE},{button:E(()=>[T(l,{id:"scheduleThreeDotUnscheduleBtnResource",iconCategory:"utility",iconName:"threedots_vertical",size:"small",title:"Queue Options",assistiveText:"Queue Options"})]),default:E(()=>[T(d,{id:"scheduleRemoveAllUnscheduleBtnResource",label:e.$Labels.MA_REMOVE_ALL,onClick:a.scheduleStore.clearQueue},null,8,["label","onClick"])]),_:1},8,["showMoreLabel"])]),a.scheduleStore.queue.length&&s.allowOptimization&&a.scheduleStore.isAgendaWeek?(b(),v("div",jt,[(b(!0),v(G,null,j(o.optimizationDays,(n,h)=>(b(),v("div",{key:h,class:"optimize-checkbox"},[m("label",{for:`checkbox${h}`},[ue(m("input",{id:`checkbox${h}`,"onUpdate:modelValue":f=>n.checked=f,disabled:n.disabled,type:"checkbox",onClick:f=>i.daySelected(h,f)},null,8,Kt),[[we,n.checked]]),m("div",Xt,g(n.label),1)],8,Yt)]))),128))])):N("",!0),a.scheduleStore.queue.length&&s.allowOptimization?(b(),v("div",es,[i.multipleShifts?(b(),w(u,{key:1,disabled:s.doDisableOptimizationDueToInvalidDuration||a.scheduleStore.hasOverlappingShifts||a.scheduleStore.isAgendaWeek&&!Object.keys(a.scheduleStore.columnIdsForOptimization).length,forceLeft:!0,variant:"brand",iconCategory:"utility",iconName:"clock","data-pendo":"schedule-queue_add-to-schedule",label:e.$Labels.MA_ADD_TO_SCHEDULE,onClick:t[1]||(t[1]=n=>i.optimizeRoute())},null,8,["disabled","label"])):(b(),w(u,{key:0,disabled:s.doDisableOptimizationDueToInvalidDuration||a.scheduleStore.hasOverlappingShifts||a.scheduleStore.isAgendaWeek&&!Object.keys(a.scheduleStore.columnIdsForOptimization).length,variant:"brand",iconCategory:"utility",iconName:"clock","data-pendo":"schedule-queue_add-to-schedule",label:e.$Labels.MA_ADD_TO_SCHEDULE,onClick:t[0]||(t[0]=n=>i.optimizeRoute(i.shifts[0].id))},null,8,["disabled","label"])),s.doDisableOptimizationDueToInvalidDuration?(b(),w(r,{key:2,text:e.$Labels.Schedule_Error_Event_Duration,alignment:"top right",assistiveText:e.$Labels.MA_HELP},{source:E(()=>[T(c,{category:"utility",name:"info",variant:"default",size:"xx-small",iconClass:"slds-icon-text-brand",class:"slds-p-right_xx-small"})]),_:1},8,["text","assistiveText"])):N("",!0)])):N("",!0)])]),m("div",ts,[m("div",ss,[a.scheduleStore.queue.length?(b(),v("ul",as,[(b(!0),v(G,null,j(a.scheduleStore.queue,(n,h)=>(b(),v("li",{ref_for:!0,ref:`item${h}`,key:n.id,class:"schedule-queue-list-item"},[m("div",null,[T(c,{category:"utility",name:"move",size:"xx-small",class:"slds-p-right_x-small"})]),m("div",is,g(n.title),1),m("div",null,[T(l,{iconCategory:"utility",iconName:"close",size:"x-small",class:"remove-queue-item",title:`Remove ${n.title} From Queue`,assistiveText:`Remove ${n.title} From Queue`,onClick:f=>a.scheduleStore.removeItemFromQueueById(n.id)},null,8,["title","assistiveText","onClick"])]),n.priorityType?ue((b(),v("div",os,[m("span",rs,[(b(),w(Oe(i.getPriorityComponent(n.priorityType)),{value:n.priorityValue,fieldLabel:n.priorityLabel||"",sfdcFieldType:n.priorityFieldType||"number",priorityIndex:n.priority},null,8,["value","fieldLabel","sfdcFieldType","priorityIndex"])),m("span",ns,g(n.priority),1)])],512)),[[xe,!a.scheduleStore.isTimelineDay]]):N("",!0)]))),128))])):N("",!0),a.scheduleStore.queue.length?N("",!0):(b(),v("div",ls,[m("div",ds,[cs,m("h4",null,g(e.$Labels.MA_SCHEDULE_NOTHING_TO_ADD_TO_YOUR_SCHEDULE),1),m("p",null,g(e.$Labels.MA_SCHEDULE_USE_ADD_TO_SCHEDULE_TO_ADD_MARKERS_TO_THIS_AREA_TEXT),1),pe(),us,m("p",null,g(e.$Labels.MA_SCHEDULE_USE_ADD_TO_SCHEDULE_TO_ADD_MARKERS_TO_THIS_AREA_SECOND_SENTENCE_TEXT),1)])]))]),m("div",_s,[T(r,{text:e.$Labels.MA_COLLAPSE_EXPAND_QUEUE,alignment:"right",style:{height:"100%"}},{source:E(()=>[T(l,{id:"scheduleLefRightCollapseBtnResource",style:{height:"100%",width:"10px"},iconCategory:"utility",iconName:a.scheduleStore.isQueueCollapsed?"right":"left",size:"xx-small",variant:"bare",title:e.$Labels.MapsSetting_Settings,assistiveText:e.$Labels.MapsSetting_Settings,onClick:i.toggleScheduleQueue},null,8,["iconName","title","assistiveText","onClick"])]),_:1},8,["text"])])])])])}const Is=x(Jt,[["render",hs],["__scopeId","data-v-c2340311"]]);const ms={name:"LaborLawBanner"},fs={class:"labor-law-notification slds-notify_container slds-notify_container--inline"},ps={class:"slds-notify slds-notify--alert slds-theme--warning slds-theme--alert-texture slds-banner"};function Ss(e,t,s,a,o,i){return b(),v("div",fs,[m("div",ps,[m("h2",null,g(e.$Labels.MA_Labor_Laws),1)])])}const Ms=x(ms,[["render",Ss],["__scopeId","data-v-9fe20218"]]);export{Ls as C,Ds as E,Ms as L,ct as P,Is as Q,Es as R,vs as _,Xe as a,yt as b,Ts as i};
