import{_ as g,S as h,l as f,P as S,f as _,Q as C,bE as D,r as o,o as p,c as k,b as M,w as i,s as w,v as A,i as l,h as $,j as u,t as L,e as v}from"../bundle.js";import{M as O}from"./Modal.76578f76.js";const V={components:{Spinner:h,Modal:O,SLDSButton:f,Picklist:S},props:{modalOptions:{type:Object,required:!0}},emits:["open-modal","close-modal"],setup(){return{mainStore:_(),formatLabel:C}},data(){return{selectedDataLayer:null,isLoading:!1,dataLayerOptions:[],showMassActionVerification:!1}},created(){const{availableDataLayers:e}=this.$props.modalOptions;this.dataLayerOptions=e?.map(({id:t,label:s})=>({id:t,label:s})),this.selectedDataLayer=this.dataLayerOptions[0]?.id??null},methods:{getDataLayerRecords(){return this.$props.modalOptions.availableDataLayers.find(({id:e})=>e===this.selectedDataLayer)?.features??[]},async nextStep(){if(!this.selectedDataLayer)return;const e=this.getDataLayerRecords();if(e?.length>5e3){this.mainStore.toast({message:this.$Labels.Click2Create_ExceededLimitMessage,subMessage:this.$Labels.Click2Create_ExceededLimitSubMessage,state:"warning"}),this.$emit("close-modal");return}this.isLoading=!0;try{const t=await D("dataLayerMarkers",this.selectedDataLayer),{success:s,message:n,data:a,settings:r,objectFieldSetMap:d}=t;if(!s&&n){this.mainStore.toast({message:n,state:"warning"}),this.$emit("close-modal");return}s&&a?(this.$emit("close-modal"),this.modalOptions.callback({contentType:"massActionConfirm",isMassAction:!0,data:a,settings:r,objectFieldSetMap:d,features:e,dataType:this.selectedDataLayer,type:"dataLayerMarkers"})):this.mainStore.toast({message:MAPS.app.config.globalProperties.$Labels.Drop_Pin_Ask_Admin_For_C2C,state:"warning"})}catch(t){console.warn(t),this.mainStore.toast({message:this.$Labels.MA_Something_Went_Wrong,state:"warning"})}finally{this.isLoading=!1}}}},B={class:"slds-grid slds-grid_align-end"};function P(e,t,s,n,a,r){const d=o("Spinner"),b=o("Picklist"),m=o("SLDSButton"),y=o("Modal");return p(),k("div",null,[a.showMassActionVerification?v("",!0):(p(),M(y,{key:0,id:"dataLayerSelection",title:e.$Labels.Click2Create_CreateARecord,labels:{close:e.$Labels.MA_Close},class:"slds-modal-fullscreen-phone js-search-modal-wrapper",onClose:t[2]||(t[2]=c=>e.$emit("close-modal"))},{content:i(()=>[w(l(d,null,null,512),[[A,a.isLoading]]),l(b,{modelValue:a.selectedDataLayer,"onUpdate:modelValue":t[0]||(t[0]=c=>a.selectedDataLayer=c),inputAttrs:{"data-q3-id":"c2c-select-data-layer"},options:a.dataLayerOptions,labels:{name:e.$Labels.Click2Create_DataLayer_DataToUse},titleKey:"label"},null,8,["modelValue","options","labels"])]),footer:i(()=>[$("div",B,[l(m,{"data-q3-id":"c2c-close-modal-button",disabled:a.isLoading,class:"slds-button slds-button_neutral",onClick:t[1]||(t[1]=c=>e.$emit("close-modal"))},{default:i(()=>[u(L(e.$Labels.MA_Cancel),1)]),_:1},8,["disabled"]),l(m,{"data-q3-id":"c2c-next-step-modal-button",disabled:a.isLoading||!a.selectedDataLayer,class:"slds-button slds-button_brand",onClick:r.nextStep},{default:i(()=>[u(L(e.$Labels.MA_Next),1)]),_:1},8,["disabled","onClick"])])]),_:1},8,["title","labels"]))])}const q=g(V,[["render",P]]);export{q as default};
