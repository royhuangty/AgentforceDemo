import{_ as I,S as R,N as x,m as S,D as u,r as b,o as s,c as t,b as v,e as C,F as c,q as p,h as f,t as y,a0 as T,i as E}from"../bundle.js";const $={name:"MarkerPopupRelatedList",components:{Spinner:R,FieldRenderer:x},props:{recordId:{type:String,required:!0},sfLayerId:{type:String,required:!0}},data(){return{isLoading:!1,relatedLists:[]}},created(){this.getRelatedLists()},methods:{async getRelatedLists(){this.isLoading=!0;const L={action:"getRelatedList",ajaxResource:"TooltipAJAXResources",parentid:this.recordId,sqid:this.sfLayerId};try{const{success:i,data:g}=await MAPS.Utils.Apex.invoke("maps.RemoteFunctions.processAJAXRequest",[L]);if(i){const m=[];g.forEach(n=>{const k=[],{column_labels:_,related_records:r}=n;r.forEach(a=>{const{columns:o,Id:l}=a;o.forEach((e,h)=>{const d=S(e.displayType);h===0?(e.needsLink=!0,e.linkId=l,e.isCheckbox=!1,e.multiselect=!1,e.isURL=!1,e.isPhone=!1,e.formatted=e.value):(e.needsLink=e.is_relationship,e.linkId=e.relationship_id,e.isCheckbox=d===u.BOOLEAN,e.multiselect=d===u.MULTIPICKLIST,e.isURL=d===u.URL,e.isPhone=d===u.PHONE,e.extraTypeInfo=e.describe.extraTypeInfo,e.formatted=e.value,e.raw=e.isCheckbox&&e.value&&String(e.value).toLowerCase()==="true"),k.push(e)})}),m.push({label:n.related_list_label,columns:_,rows:r,emptyLabel:`No ${n.object_name_plural}`})}),this.relatedLists=m}}catch(i){console.warn(i)}finally{this.isLoading=!1}}}},w={style:{"min-height":"50px"}},A={key:0,class:"slds-table slds-table_bordered"},N={class:"slds-line-height_reset"},q={key:1,class:"slds-p-left_xx-small"};function B(L,i,g,m,n,k){const _=b("Spinner"),r=b("FieldRenderer");return s(),t("div",w,[n.isLoading?(s(),v(_,{key:0})):C("",!0),(s(!0),t(c,null,p(n.relatedLists,(a,o)=>(s(),t("div",{key:`list_${o}`},[f("div",{class:T(["slds-text-heading_small",{"slds-p-top_medium":o!==0}])},y(a.label),3),a.rows.length>0?(s(),t("table",A,[f("thead",null,[f("tr",N,[(s(!0),t(c,null,p(a.columns,(l,e)=>(s(),t("th",{key:`column_${e}`},y(l),1))),128))]),(s(!0),t(c,null,p(a.rows,l=>(s(),t("tr",{key:`row_${l}_${o}`},[(s(!0),t(c,null,p(l.columns,(e,h)=>(s(),t("td",{key:`rc_${h}`},[E(r,{field:e,recordId:l.columns[0].linkId},null,8,["field","recordId"])]))),128))]))),128))])])):(s(),t("div",q,y(a.emptyLabel),1))]))),128))])}const P=I($,[["render",B]]);export{P as default};
