"use strict";(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[2109],{5264:(e,t,s)=>{s.d(t,{Z:()=>n});const i=new Map;function a(e,t,s){const a=function(i){s.context._isDestroyed?document.removeEventListener("click",a):e.contains(i.target)||e===i.target||t(i)};i.set(e,a),setTimeout((()=>document.addEventListener("click",a)),0)}function o(e){const t=i.get(e);document.removeEventListener("click",t),i.delete(e)}const n={bind(e,{arg:{active:t,handler:s}},i){if("function"!=typeof s)throw new Error("v-click-outside: missing required handler argument.");!0===t&&a(e,s,i)},update(e,{arg:{active:t,handler:s}},n){t&&!i.has(e)?a(e,s,n):!t&&i.has(e)&&o(e)},unbind(e){o(e)}}},5432:(e,t,s)=>{s.d(t,{Z:()=>n});var i=s(5264);const{$:a}=window,o={name:"ActionSheet",directives:{"click-outside":i.Z},props:{options:{type:Array,required:!0},doDetach:{type:Boolean,default:!0},labelKey:{type:String,default:"label"},buttonText:{type:String,default:""},buttonIcon:{type:String,default:""},hideOverride:{type:Boolean,default:!1},selectedItems:{type:Array,default:()=>[]},buttonType:{type:String,default:""}},data:()=>({container:null,showOptions:!1,styleObject:{},window:{height:0,width:0},uid:"action-sheet"}),computed:{isPhone(){return this.window.width<769},computedIcon(){let e="";return""!==this.buttonIcon?e=this.buttonIcon:""===this.buttonText&&(e="ma-icon-threedots-vertical"),e},actionSheetClickOutsideOptions(){return{active:this.showOptions,handler:this.hideActionSheet}}},watch:{isPhone(){this.showOptions=!1}},created(){window.addEventListener("resize",this.handleResize),this.handleResize()},destroyed(){window.removeEventListener("resize",this.handleResize),this.hideActionSheet()},methods:{handleResize(){this.window.width=window.innerWidth,this.window.height=window.innerHeight},returnItem(e){e.isHeader||(this.$emit("select",e),this.hideActionSheet())},hideActionSheet(){this.showOptions=!1,this.container&&(this.container.remove(),this.container=null)},detach(){if(!this.$refs.button)return;const e=document.querySelector(`.slds-scope.${this.uid}`);try{e.remove()}catch(e){}const t=this.$refs.button.getBoundingClientRect();this.container=document.createElement("div"),this.container.className=`slds-scope ${this.uid}`,this.container.appendChild(this.$refs.actions),document.body.appendChild(this.container),this.styleObject={top:`${t.top+this.$refs.button.clientHeight+a(window).scrollTop()}px`,left:`${t.left+a(window).scrollLeft()}px`,"max-height":"300px"}},adjustForClipping(){const e=this.$refs.actions.getBoundingClientRect();let t;if(t=document.documentElement.clientHeight-window.innerHeight<=0?document.documentElement.clientHeight:window.innerHeight-this.getScrollbarWidth(),e.x<0)this.styleObject.left=`${this.$refs.actions.offsetLeft+Math.abs(e.x)}px`;else if(e.left+e.width>document.documentElement.clientWidth){const t=e.left+e.width-document.documentElement.clientWidth-a(window).scrollLeft();this.styleObject.left=e.left-t+"px"}const s=this.$refs.actions.scrollHeight,i=a(window).scrollTop();if(this.styleObject["max-height"]="300px",e.top+s>t){const a=e.top+s-i-t;this.$bus.$emit("ma-modal-scroll-by",a),this.styleObject.top=e.top-a+"px"}},disableClick(e){e.stopPropagation(),e.preventDefault()},openActionSheet(){this.showOptions=!0,this.doDetach&&this.detach(),this.$nextTick((()=>{this.doDetach&&this.adjustForClipping(),this.options.forEach(((e,t)=>{const s=e,i=this.$refs.optionItem[t];s.isHeader&&i.addEventListener("click",this.disableClick,!0)}))}))}}},n=(0,s(1900).Z)(o,(function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"click-outside",rawName:"v-click-outside:[actionSheetClickOutsideOptions]",arg:e.actionSheetClickOutsideOptions}],staticClass:"action-sheet-wrapper slds-scope"},[t("div",{ref:"button",staticClass:"slds-grid slds-grid_vertical-align-center",on:{click:e.openActionSheet}},[t("div",{staticClass:"slds-button slds-col slds-truncate"},[e._v(e._s(e._f("decode")(e.buttonText)))]),e._v(" "),""!==e.computedIcon?t("div",[t("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container",class:[e.buttonType]},[t("span",{staticClass:"slds-button__icon ma-icon",class:[e.computedIcon]})])]):e._e()]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showOptions,expression:"showOptions"}],ref:"actions",staticClass:"ma-action-sheet-wrap in slds-grid slds-grid_vertical slds-grid_align-end",style:e.isPhone?{}:e.styleObject},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.isPhone,expression:"isPhone"}],staticClass:"action-sheet_mask",on:{click:e.hideActionSheet}}),e._v(" "),t("div",{staticClass:"action-sheet_wrap slds-grid slds-grid_vertical"},[t("div",{staticClass:"action-sheet_content slds-scrollable"},e._l(e.options,(function(s,i){return t("div",{key:i,ref:"optionItem",refInFor:!0,staticClass:"action-sheet_item slds-grid slds-p-around_medium",class:{"header slds-text-title_caps slds-section__title slds-theme--shade":s.isHeader,"slds-is-selected":e.selectedItems.includes(s.id)},on:{click:function(t){return e.returnItem(s)}}},[e._m(0,!0),e._v(" "),t("div",{staticClass:"slds-col"},[t("span",{staticStyle:{"word-break":"break-word"}},[e._v(e._s(e._f("decode")(s[e.labelKey])))])])])})),0),e._v(" "),t("div",{staticClass:"slds-button slds-button_neutral action-sheet_close-button",on:{click:e.hideActionSheet}},[e._v("\n                "+e._s(e._f("decode")(e.$Labels.MA_Close))+"\n            ")])])])])}),[function(){var e=this._self._c;return e("div",{staticClass:"action-sheet_selected-icon slds-p-right_medium"},[e("span",{staticClass:"slds-icon slds-icon_x-small ma-icon ma-icon-check"})])}],!1,null,"44c08aa9",null).exports},8562:(e,t,s)=>{s.r(t),s.d(t,{default:()=>w});var i=s(3057),a=s(5908),o=s(5511),n=s(5728),l=s(7813);const{$:r}=window,d={components:{MAModal:n.Z,MASpinner:i.Z},props:{layerType:{type:String,default:"marker"},layerQID:{type:String,required:!0},showDisplayStyles:{type:Boolean,default:!1}},data(){return{renderModes:[],currentMode:"",radioToggle:"",isLoading:!1,markerRenderModes:[{renderAs:"Markers",icon:"cluster",label:this.$Labels.MA_CLUSTERS,active:!1,uid:(0,l.x$)()},{renderAs:"Heatmap",icon:"heatmap",label:this.$Labels.MA_HEATMAP,active:!1,uid:(0,l.x$)()},{renderAs:"Scatter",icon:"scatter",label:this.$Labels.MA_SCATTER,active:!1,uid:(0,l.x$)()}]}},computed:{plottedLayer(){let e;return"marker"===this.layerType?e=r(`#PlottedQueriesTable .savedQuery[qid="${this.layerQID}"]`):"datalayer"===this.layerType&&(e=r(`#PlottedQueriesTable .DataLayer[qid="${this.layerQID}"]`)),e},isDataLayer(){return this.plottedLayer.hasClass("DataLayer")}},created(){this.buildRenderModes(),this.getPlottedMode()},methods:{buildRenderModes(){"marker"===this.layerType?this.renderModes=this.markerRenderModes:"datalayer"===this.layerType&&(this.renderModes=this.markerRenderModes.filter((e=>"Scatter"!==e.renderAs)))},close(){this.$emit("update:showDisplayStyles",!1)},toggleRenderMode(e){e!==this.currentMode&&(this.isLoading=!0,this.close(),"marker"===this.layerType?window.Plotting.unrenderQuery(this.plottedLayer,{modes:[this.currentMode]},(()=>{window.Plotting.renderQueryV2(this.plottedLayer,[e],(()=>{this.plottedLayer.find(".queryLoader").hide(),this.plottedLayer.find(".queryIcon ").show(),this.isLoading=!1}))})):"datalayer"===this.layerType&&("Markers"===e&&(e="Cluster"),window.MADemographicLayer.rerenderDataLayer(this.plottedLayer,{renderModes:[e]},(()=>{this.isLoading=!1}))))},getPlottedMode(){this.plottedLayer.find(".renderButtons .renderButtons-button").each(((e,t)=>{const s=r(t);let i=s.attr("data-renderas");s.hasClass("on")&&(this.isDataLayer&&"Cluster"===i&&(i="Markers"),this.currentMode=i,this.radioToggle=i)}))}}};var c=s(1900);const h=(0,c.Z)(d,(function(){var e=this,t=e._self._c;return t("MAModal",{staticClass:"slds-modal-fullscreen-phone",attrs:{doDetach:!0,title:e._f("decode")(e.$Labels.MA_Display_Style),closeLabel:e.$Labels.MA_Close},on:{close:e.close}},[t("div",{attrs:{slot:"content"},slot:"content"},[t("MASpinner",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"isLoading"}]}),e._v(" "),t("div",{staticClass:"pad-8-16"},e._l(e.renderModes,(function(s,i){return t("div",{key:i,staticClass:"ma-list MapViewTable ma-list-border"},[t("div",{staticClass:"ma-list-item"},[t("div",{staticClass:"full-width"},[t("div",{staticClass:"slds-form-element__control"},[t("span",{staticClass:"slds-radio"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.radioToggle,expression:"radioToggle"}],attrs:{id:s.uid,type:"radio",name:"renderMode"},domProps:{value:s.renderAs,checked:e._q(e.radioToggle,s.renderAs)},on:{change:[function(t){e.radioToggle=s.renderAs},function(t){return e.toggleRenderMode(s.renderAs)}]}}),e._v(" "),t("label",{staticClass:"slds-radio__label ma-checkbox",attrs:{for:s.uid}},[t("span",{staticClass:"slds-radio_faux"}),e._v(" "),t("span",{staticClass:"ma-checkbox-label",staticStyle:{margin:"0 15px"}},[t("div",{staticClass:"ma-render-icon inline",attrs:{type:s.icon}}),e._v(" "),t("span",{staticClass:"slds-form-element__label",staticStyle:{"vertical-align":"top","line-height":"28px","margin-left":"15px"}},[e._v(e._s(e._f("decode")(s.label)))])])])])])])])])})),0)],1),e._v(" "),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("div",{staticClass:"float-right"},[t("button",{staticClass:"slds-button slds-button_neutral",on:{click:e.close}},[e._v("\n                "+e._s(e._f("decode")(e.$Labels.MA_Cancel))+"\n            ")])])])])}),[],!1,null,null,null).exports;var y=s(5432),u=s(8927);const{$:p}=window,g={components:{LayerPlotOptions:h,ActionSheet:y.Z,MobileToggle:u.Z},props:{layerData:{type:Object,required:!0},isLoading:{type:Boolean,required:!0},doHide:{type:Boolean,default:!0}},data:()=>({showDisplayStyles:!1}),computed:{...(0,a.mapGetters)("layers",{layers__getPlottedLayerById:"getPlottedLayerById",layers__getPlotOnLoadLayerById:"getPlotOnLoadLayerById"}),isPlotted:{get(){return this.layers__getPlottedLayerById(this.layerData.id).length>0},set(){this.removeLayer()}},name(){return this.layerData.name||""},layerType(){return this.layerData.type},layerSubText(){let e="";return e="marker"===this.layerType?this.layerData.baseObjectLabel:this.layerData.subText||"",e},qid(){return this.layerData.qid||""},id(){return this.layerData.id||""},isPlotOnLoad:{get(){return this.layers__getPlotOnLoadLayerById(this.layerData.id).length>0},set(){this.updatePlotOnLoad()}},plotOnLoadDisabled(){let e=!0;switch(this.layerType){case"marker":case"favorite":case"arcgisonline":case"shape":this.layerData.id&&(e=!1);break;default:e=!0}return e},overFlowActions(){const e=[];return"marker"===this.layerType?e.push({label:this.$Labels.MA_Edit_Display_Style,action:"editDisplayStyle"}):"datalayer"===this.layerType&&((p(`#PlottedQueriesTable .DataLayer[qid="${this.qid}"]`).data()||{}).censusLayer||e.push({label:this.$Labels.MA_Edit_Display_Style,action:"editDisplayStyle"})),e}},methods:{...(0,a.mapMutations)("layers",{layers__removePlotOnLoad:"removePlotOnLoad"}),...(0,a.mapActions)("layers",{layers__getRecentLayers:"getRecentLayers"}),hideSingleView(){this.$emit("close")},removeLayer(){this.hideSingleView(),this.$bus.$emit("remove-layer",this.qid)},openPlotOptions(){this.showLayerOptions=!0},handleSelectOption(e){"editDisplayStyle"===e.action&&(this.showDisplayStyles=!0)},updatePlotOnLoad(){this.$emit("update:isLoading",!0);let e=!0;this.isPlotOnLoad&&(e=!1),o.Z.updatePlotOnLoad(this.id,e).then((()=>{this.layers__getRecentLayers().finally((()=>{this.$emit("update:isLoading",!1),e||this.layers__getPlotOnLoadLayerById(this.id).length>0&&window.MAToastMessages.showError({message:this.$Labels.Layers_Mobile_Unable_To_Update,timeOut:1e4,closeButton:!0})}))})).catch((e=>{console.warn(e),this.$emit("update:isLoading",!1)}))}}},m=(0,c.Z)(g,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"slds-border_bottom",attrs:{id:"layersIndividualTopBar"}},[t("div",{staticClass:"slds-grid"},[t("div",{staticClass:"slds-p-left_x-small slds-p-vertical_small"},[t("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container nest-to-layer-index",on:{click:e.hideSingleView}},[t("span",{staticClass:"slds-button__icon ma-icon ma-icon-back"})])]),e._v(" "),t("div",{staticClass:"layerName slds-p-around_medium slds-truncate"},[t("div",{staticClass:"slds-text-heading_medium slds-truncate"},[e._v("\n                "+e._s(e._f("decode")(e.name))+"\n            ")]),e._v(" "),t("div",{staticClass:"layer_subtext layerType"},[e._v("\n                "+e._s(e._f("decode")(e.layerSubText))+"\n            ")])]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.overFlowActions.length>0,expression:"overFlowActions.length > 0"}],staticClass:"plottedMoreOptions slds-p-right_x-small slds-p-vertical_small slds-col_bump-left"},[t("ActionSheet",{attrs:{doDetach:!0,options:e.overFlowActions},on:{select:e.handleSelectOption,hide:function(t){e.showLayerOptions=!1}}})],1)]),e._v(" "),t("div",{staticClass:"slds-grid slds-p-horizontal_medium slds-p-vertical_small"},[t("div",[t("MobileToggle",{attrs:{label:e.$Labels.MA_PLOT_ON_MAP},model:{value:e.isPlotted,callback:function(t){e.isPlotted=t},expression:"isPlotted"}})],1),e._v(" "),t("div",{staticClass:"slds-col_bump-left"},[t("MobileToggle",{attrs:{isDisabled:e.plotOnLoadDisabled,label:e.$Labels.MA_PLOT_ON_APP_STARTUP},model:{value:e.isPlotOnLoad,callback:function(t){e.isPlotOnLoad=t},expression:"isPlotOnLoad"}})],1)]),e._v(" "),e.showDisplayStyles?t("LayerPlotOptions",{attrs:{layerType:e.layerType,layerQID:e.qid,showDisplayStyles:e.showDisplayStyles},on:{"update:showDisplayStyles":function(t){e.showDisplayStyles=t},"update:show-display-styles":function(t){e.showDisplayStyles=t}}}):e._e()],1)}),[],!1,null,"659faf08",null).exports;var _=s(3589),v=s(5467);const L={components:{SFDCLayerBody:()=>({...(0,_.Z)(),component:s.e(683).then(s.bind(s,4642)),error:v.Z}),FavoriteBody:()=>({...(0,_.Z)(),component:s.e(6040).then(s.bind(s,7524)),error:v.Z}),DataLayerBody:()=>({...(0,_.Z)(),component:s.e(4236).then(s.bind(s,2927)),error:v.Z}),BoundaryLayerBody:()=>({...(0,_.Z)(),component:s.e(3929).then(s.bind(s,9036)),error:v.Z}),ShapeLayerBody:()=>({...(0,_.Z)(),component:s.e(1509).then(s.bind(s,9800)),error:v.Z}),ArcGisBody:()=>({...(0,_.Z)(),component:s.e(8212).then(s.bind(s,6278)),error:v.Z}),LiveTrackingLayerBody:()=>({...(0,_.Z)(),component:s.e(2270).then(s.bind(s,6657)),error:v.Z})},props:{layerData:{type:Object,required:!0}},computed:{layerType(){return this.layerData.type}},methods:{toggleLoading(e){this.$emit("toggleLoading",e)}}},b={components:{SingleLayerHeader:m,SingleLayerBody:(0,c.Z)(L,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"ma-view-body momentum-scrolling-y slds-scrollable",attrs:{id:"layersIndividualBody"}},["marker"===e.layerType?t("SFDCLayerBody",{attrs:{layerData:e.layerData},on:{toggleLoading:e.toggleLoading}}):"favorite"===e.layerType?t("FavoriteBody",{attrs:{layerData:e.layerData}}):"datalayer"===e.layerType?t("DataLayerBody",{attrs:{layerData:e.layerData},on:{toggleLoading:e.toggleLoading}}):"boundary"===e.layerType?t("BoundaryLayerBody",{attrs:{layerData:e.layerData},on:{toggleLoading:e.toggleLoading}}):"shape"===e.layerType?t("ShapeLayerBody",{attrs:{layerData:e.layerData},on:{toggleLoading:e.toggleLoading}}):"arcgisonline"===e.layerType?t("ArcGisBody",{attrs:{layerData:e.layerData},on:{toggleLoading:e.toggleLoading}}):"LiveTrackingLayer"===e.layerType?t("LiveTrackingLayerBody",{attrs:{layerData:e.layerData},on:{toggleLoading:e.toggleLoading}}):e._e()],1)}),[],!1,null,null,null).exports,MASpinner:i.Z},props:{layerData:{type:Object,required:!0}},data:()=>({isLoading:!1,doHide:!0}),created(){this.$bus.$on("hide-single-view",this.close)},destroyed(){this.$bus.$off("hide-single-view")},mounted(){this.$nextTick((()=>{this.doHide=!1}))},methods:{close(){this.doHide=!0,setTimeout((()=>{this.$emit("close")}),250)},toggleLoading(e){this.isLoading=e}}},w=(0,c.Z)(b,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"view-panel-flex-column",class:{"nest-out":e.doHide},attrs:{id:"layersIndividualWrap"}},[t("MASpinner",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"isLoading"}]}),e._v(" "),t("SingleLayerHeader",{attrs:{layerData:e.layerData,isLoading:e.isLoading,doHide:e.doHide},on:{"update:isLoading":function(t){e.isLoading=t},"update:is-loading":function(t){e.isLoading=t},"update:doHide":function(t){e.doHide=t},"update:do-hide":function(t){e.doHide=t},close:e.close}}),e._v(" "),t("SingleLayerBody",{attrs:{layerData:e.layerData,isLoading:e.isLoading},on:{"update:isLoading":function(t){e.isLoading=t},"update:is-loading":function(t){e.isLoading=t},toggleLoading:e.toggleLoading}})],1)}),[],!1,null,null,null).exports}}]);