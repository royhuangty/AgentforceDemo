"use strict";(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[7059],{6991:(e,s,a)=>{a.r(s),a.d(s,{default:()=>m});var t=a(5908);const{$:i,Plotting:r,MAToastMessages:l,google:o,MA:n}=window,c={props:{poiResults:{type:Array,default:()=>[]},markerResults:{type:Array,default:()=>[]},poiLoading:{type:Boolean,default:!1},markersLoading:{type:Boolean,default:!1},searchTerm:{type:String,default:""},dohidePOISection:{type:Boolean,default:!1},dohideMarkerSection:{type:Boolean,default:!1}},data:()=>({poiMarkerCount:0,localPoiResults:[]}),computed:{...(0,t.mapGetters)("mainNavBar",{layers__activeTab:"activeTab"}),hasResults(){return this.poiResults.length>0||this.markerResults.length>0},showResults(){return this.searchTerm.length>2},poiMarkers:()=>window.MA.Map.Search.markers},watch:{poiResults(e){this.localPoiResults=e}},methods:{showPoiResult(e){const s=l.showLoading({message:`${this.$Labels.MA_Loading_With_Ellipsis}`,timeOut:0,extendedTimeOut:0});if(e.place_id){const a=e.place_id;this.getPoiInfo(a).then((()=>{l.hideMessage(s)}))}else{const a=e.description;this.getPoiSuggestionInfo(a).then((()=>{l.hideMessage(s)}))}},removePOI(){try{n.Map.Search.markers.forEach((e=>{e.setMap(null)})),n.Map.Search.markers=[],this.poiMarkerCount=0}catch(e){}},showMarkerResult(e){const s=e.qid,a=e.Id,t=i(`#PlottedQueriesTable .savedQuery[qid="${s}"]`).data()||{},{records:o={}}=t,n=o[a];if(n){const{marker:e}=n;e?r.marker_Click.call(e,{markerType:"Marker"}):l.showError({message:this.$Labels.Oh_Snap,subMessage:this.$Labels.Unable_To_Find_Record})}else l.showError({message:this.$Labels.Oh_Snap,subMessage:this.$Labels.Unable_To_Find_Record})},getPoiInfo(e){return new Promise(((s,a)=>{const t=n.Map.Search.markers;this.poiMarkerCount=t.length;let i=!1;for(let s=0,a=t.length;s<a;s++){const a=t[s],{maData:l={}}=a,{place:o={}}=l;if(o.place_id===e){r.mobile.poiClick.call(a,{markerType:"POI"}),i=!0;break}}i?s():new o.maps.places.PlacesService(n.map).getDetails({placeId:e},((e,t)=>{if(t===o.maps.places.PlacesServiceStatus.OK){const a=new o.maps.Marker({map:n.map,position:e.geometry.location,title:e.name,maData:{place:e},icon:{url:e.icon,size:new o.maps.Size(71,71),origin:new o.maps.Point(0,0),anchor:new o.maps.Point(12,25),scaledSize:new o.maps.Size(25,25)},zIndex:-2});n.Map.Search.markers.push(a),this.poiMarkerCount=n.Map.Search.markers.length,o.maps.event.addListener(a,"click",(()=>{r.mobile.poiClick.call(a)})),r.mobile.poiClick.call(a,{markerType:"POI"}),s()}else a()}))}))},getPoiSuggestionInfo(e){return new Promise((s=>{window.placesSearch(e,{type:"place"}).then((e=>{i.each(n.Map.Search.markers,((e,s)=>{s.setMap(null)}));const a=[];i.each(e,((e,s)=>{if(s.geometry){const e=new o.maps.Marker({map:n.map,position:s.geometry.location,title:s.name,maData:{place:s},icon:{url:s.icon,size:new o.maps.Size(71,71),origin:new o.maps.Point(0,0),anchor:new o.maps.Point(12,25),scaledSize:new o.maps.Size(25,25)},zIndex:-2});a.push({place_id:s.place_id,structured_formatting:{main_text:s.name,secondary_text:s.formatted_address}}),o.maps.event.addListener(e,"click",(()=>{r.mobile.poiClick.call(e)})),n.Map.Search.markers.push(e)}})),this.poiMarkerCount=n.Map.Search.markers.length,this.$emit("set-results",{poi:a,markers:this.markerResults}),s()}))}))}}},m=(0,a(1900).Z)(c,(function(){var e=this,s=e._self._c;return s("div",{staticClass:"ma-search-body main-panel",class:{in:"search"===e.layers__activeTab},attrs:{id:"searchBody"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.showResults,expression:"!showResults"}],staticClass:"search-empty-state"},[e._m(0),e._v(" "),s("div",[s("p",{staticClass:"text-center"},[e._v("\n                "+e._s(e._f("decode")(e.$Labels.MA_SEARCH_FOR_MARKERS_FROM_ACTIVE_LAYERS_OR_GOOGLE_PLACES_AND))+"\n            ")])])]),e._v(" "),s("div",{staticClass:"search-result-wrap momentum-scrolling-y slds-scrollable",class:{in:e.showResults},attrs:{id:"searchResults"}},[e.dohideMarkerSection?e._e():s("ul",{staticClass:"markerResults",attrs:{id:"markerResults"}},[s("li",{staticClass:"ma-section-title"},[e._v(e._s(e._f("decode")(e.$Labels.MA_Records_ML)))]),e._v(" "),s("li",{directives:[{name:"show",rawName:"v-show",value:e.markersLoading,expression:"markersLoading"}],staticClass:"ma-section-title",staticStyle:{"padding-top":"5px"}},[e._v("\n                "+e._s(e._f("decode")(e.$Labels.MA_Loading_With_Ellipsis))+"\n            ")]),e._v(" "),s("li",{directives:[{name:"show",rawName:"v-show",value:!e.markersLoading&&0===e.markerResults.length,expression:"!markersLoading && markerResults.length === 0"}],staticClass:"search-result-item template flex-horizontal search-item-layers ui-menu-item"},[e._m(1),e._v(" "),s("div",{staticClass:"search-result-content flex-grow-1"},[s("div",{staticClass:"search-result-text"},[e._v(e._s(e._f("decode")(e.$Labels.MA_NO_RESULTS_FOUND)))])])]),e._v(" "),e._l(e.markerResults,(function(a,t){return s("li",{directives:[{name:"show",rawName:"v-show",value:!e.markersLoading,expression:"!markersLoading"}],key:t,staticClass:"search-result-item template flex-horizontal search-item-layers ui-menu-item",on:{click:function(s){return e.showMarkerResult(a)}}},[e._m(2,!0),e._v(" "),s("div",{staticClass:"search-result-content flex-grow-1"},[s("div",{staticClass:"search-result-text"},[e._v("\n                        "+e._s(e._f("decode")(a.tooltip1))+"\n                        "),s("div",{staticClass:"search-result-subtext"},[e._v("\n                            "+e._s(e._f("decode")(a.savedQueryName))+"\n                        ")])])])])}))],2),e._v(" "),e.dohidePOISection?e._e():s("ul",{staticClass:"poiResults",attrs:{id:"poiResults"}},[s("li",{staticClass:"ma-section-title",staticStyle:{position:"relative"}},[e._v("\n                "+e._s(e._f("decode")(e.$Labels.MA_Places_POI))+"\n                "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.poiMarkerCount>0,expression:"poiMarkerCount > 0"}],staticStyle:{position:"absolute",top:"2px",right:"10px"}},[s("button",{staticClass:"ma-button ma-button-sm ma-button--red icon-left",staticStyle:{padding:"0 .5rem","line-height":"1.75rem"},attrs:{id:"removePOI"},on:{click:e.removePOI}},[s("div",{staticClass:"ma-icon icon-left ma-icon-clear",staticStyle:{margin:".3rem .5rem 0 0"}}),e._v("\n                        Clear\n                    ")])])]),e._v(" "),s("li",{directives:[{name:"show",rawName:"v-show",value:e.poiLoading,expression:"poiLoading"}],staticClass:"ma-section-title",staticStyle:{"padding-top":"5px"}},[e._v("\n                "+e._s(e._f("decode")(e.$Labels.MA_Loading_With_Ellipsis))+"\n            ")]),e._v(" "),s("li",{directives:[{name:"show",rawName:"v-show",value:!e.poiLoading&&0===e.localPoiResults.length,expression:"!poiLoading && localPoiResults.length === 0"}],staticClass:"search-result-item template flex-horizontal search-item-layers ui-menu-item"},[e._m(3),e._v(" "),s("div",{staticClass:"search-result-content flex-grow-1"},[s("div",{staticClass:"search-result-text"},[e._v(e._s(e._f("decode")(e.$Labels.MA_NO_RESULTS_FOUND)))])])]),e._v(" "),e._l(e.localPoiResults,(function(a,t){return s("li",{directives:[{name:"show",rawName:"v-show",value:!e.poiLoading,expression:"!poiLoading"}],key:t,staticClass:"search-result-item template flex-horizontal search-item-layers ui-menu-item",on:{click:function(s){return e.showPoiResult(a)}}},[s("div",{staticClass:"search-result-icon"},[a.place_id?s("div",{staticClass:"ma-icon-checkin"}):s("div",{staticClass:"ma-icon-search"})]),e._v(" "),s("div",{staticClass:"search-result-content flex-grow-1"},[s("div",{staticClass:"search-result-text"},[e._v("\n                        "+e._s(e._f("decode")(a.structured_formatting.main_text))+"\n                        "),a.structured_formatting.secondary_text?s("div",{staticClass:"search-result-subtext"},[e._v("\n                            "+e._s(e._f("decode")(a.structured_formatting.secondary_text))+"\n                        ")]):e._e()])])])}))],2)])])}),[function(){var e=this._self._c;return e("div",{staticClass:"text-center"},[e("span",{staticClass:"ma-icon ma-icon-info ma-icon--large"})])},function(){var e=this._self._c;return e("div",{staticClass:"search-result-icon"},[e("div",{staticClass:"ma-icon-warning"})])},function(){var e=this._self._c;return e("div",{staticClass:"search-result-icon"},[e("div",{staticClass:"ma-icon-checkin"})])},function(){var e=this._self._c;return e("div",{staticClass:"search-result-icon"},[e("div",{staticClass:"ma-icon-warning"})])}],!1,null,null,null).exports}}]);